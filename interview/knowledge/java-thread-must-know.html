<!doctype html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.12" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.46" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://vanhung4499.github.io/interview/knowledge/java-thread-must-know.html"><meta property="og:site_name" content="VanHung4499"><meta property="og:title" content="Java Thread Must Know"><meta property="og:description" content="Java Concurrency (Phải học thuộc) Mô tả ngắn gọn về Mô hình bộ nhớ Java (JMM) Mô hình bộ nhớ Java định nghĩa các quy tắc truy cập các biến trong chương trình: Tất cả các biến đề..."><meta property="og:type" content="article"><meta property="og:locale" content="en-US"><meta property="og:updated_time" content="2024-07-05T10:10:42.000Z"><meta property="article:author" content="Hung Nguyen"><meta property="article:tag" content="interview"><meta property="article:tag" content="java"><meta property="article:modified_time" content="2024-07-05T10:10:42.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Java Thread Must Know","image":[""],"dateModified":"2024-07-05T10:10:42.000Z","author":[{"@type":"Person","name":"Hung Nguyen","url":"https://vanhung4499.github.io"}]}</script><meta name="referrer" content="no-referrer-when-downgrade"><link rel="alternate" type="application/rss+xml" href="https://vanhung4499.github.io/rss.xml" title="VanHung4499 RSS Feed"><title>Java Thread Must Know | VanHung4499</title><meta name="description" content="Java Concurrency (Phải học thuộc) Mô tả ngắn gọn về Mô hình bộ nhớ Java (JMM) Mô hình bộ nhớ Java định nghĩa các quy tắc truy cập các biến trong chương trình: Tất cả các biến đề...">
    <link rel="preload" href="/assets/style-ChamnO2s.css" as="style"><link rel="stylesheet" href="/assets/style-ChamnO2s.css">
    <link rel="modulepreload" href="/assets/app-B9pwkC50.js"><link rel="modulepreload" href="/assets/java-thread-must-know.html-A4xTBCx8.js">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">Skip to main content</a><!--]--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo" src="/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">VanHung4499</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="Home"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:home" width="1em" height="1em"></iconify-icon><!--]-->Home<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/wiki.html" aria-label="Wiki"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="carbon:wikis" width="1em" height="1em"></iconify-icon><!--]-->Wiki<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/dsa/" aria-label="Algorithms"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="hugeicons:algorithm" width="1em" height="1em"></iconify-icon><!--]-->Algorithms<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Programming"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:code" width="1em" height="1em"></iconify-icon>Programming<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/java/" aria-label="Java"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:java" width="1em" height="1em"></iconify-icon><!--]-->Java<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/golang/" aria-label="Golang"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:go" width="1em" height="1em"></iconify-icon><!--]-->Golang<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/js/" aria-label="JavaScript"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:javascript" width="1em" height="1em"></iconify-icon><!--]-->JavaScript<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/ts/" aria-label="TypeScript"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:typescript" width="1em" height="1em"></iconify-icon><!--]-->TypeScript<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/python/" aria-label="Python"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:python" width="1em" height="1em"></iconify-icon><!--]-->Python<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Database"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:database" width="1em" height="1em"></iconify-icon>Database<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/sql/" aria-label="SQL"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:sql-query" width="1em" height="1em"></iconify-icon><!--]-->SQL<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/mysql/" aria-label="MySQL"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:mysql" width="1em" height="1em"></iconify-icon><!--]-->MySQL<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/mongodb/" aria-label="MongoDB"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:mongodb" width="1em" height="1em"></iconify-icon><!--]-->MongoDB<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/redis/" aria-label="Redis"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/elasticsearch/" aria-label="Elasticsearch"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:elasticsearch" width="1em" height="1em"></iconify-icon><!--]-->Elasticsearch<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/elastic/" aria-label="Elastic Stack"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="cib:elastic-stack" width="1em" height="1em"></iconify-icon><!--]-->Elastic Stack<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Framework"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="simple-icons:framework" width="1em" height="1em"></iconify-icon>Framework<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/spring/" aria-label="Spring"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->Spring<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/spring-boot/" aria-label="Spring Boot"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->Spring Boot<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/nestjs/" aria-label="NestJS"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:nestjs" width="1em" height="1em"></iconify-icon><!--]-->NestJS<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/gin/" aria-label="Gin"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="logos:gin" width="1em" height="1em"></iconify-icon><!--]-->Gin<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="DevOps"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon-plain:azuredevops" width="1em" height="1em"></iconify-icon>DevOps<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/docker/" aria-label="Docker"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:docker" width="1em" height="1em"></iconify-icon><!--]-->Docker<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/kubernetes/" aria-label="Kubernetes"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:kubernetes" width="1em" height="1em"></iconify-icon><!--]-->Kubernetes<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/jenkins/" aria-label="Jenkins"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:jenkins" width="1em" height="1em"></iconify-icon><!--]-->Jenkins<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/git/" aria-label="Git"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:git" width="1em" height="1em"></iconify-icon><!--]-->Git<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/linux/" aria-label="Linux"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:linux" width="1em" height="1em"></iconify-icon><!--]-->Linux<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Design"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="tdesign:system-sum" width="1em" height="1em"></iconify-icon>Design<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/design/design-pattern/" aria-label="Design Pattern"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="tabler:grid-pattern" width="1em" height="1em"></iconify-icon><!--]-->Design Pattern<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/design/system-design/" aria-label="System Design"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="icon-park-outline:system" width="1em" height="1em"></iconify-icon><!--]-->System Design<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/project/" aria-label="Project"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="ant-design:project-outlined" width="1em" height="1em"></iconify-icon><!--]-->Project<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link route-link-active auto-link" href="/interview/" aria-label="Interview"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:account-tie" width="1em" height="1em"></iconify-icon><!--]-->Interview<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="About"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:about" width="1em" height="1em"></iconify-icon>About<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/about-me.html" aria-label="About me"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="cib:about-me" width="1em" height="1em"></iconify-icon><!--]-->About me<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/about.html" aria-label="About"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:about" width="1em" height="1em"></iconify-icon><!--]-->About<!----></a></li></ul></button></div></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/vanhung4499/my-wiki" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><!--[--><button type="button" class="search-pro-button" aria-label="Search"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon" name="search"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">Search</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><a class="route-link route-link-active auto-link vp-sidebar-title no-external-link-icon" href="/interview/knowledge/" aria-label="Knowledge"><!---->Knowledge<!----></a><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/interview/knowledge/mysql-qa.html" aria-label="MySQL Q&amp;A"><!---->MySQL Q&amp;A<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/interview/knowledge/mysql-index-qa.html" aria-label="MySQL Index Q&amp;A"><!---->MySQL Index Q&amp;A<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/interview/knowledge/redis-qa.html" aria-label="Redis Interview"><!---->Redis Interview<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/interview/knowledge/java-must-know.html" aria-label="Java Basic Must Know"><!---->Java Basic Must Know<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link vp-sidebar-page active" href="/interview/knowledge/java-thread-must-know.html" aria-label="Java Thread Must Know"><!---->Java Thread Must Know<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Prepare</span><span class="vp-arrow end"></span></button><!----></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->Java Thread Must Know</h1><div class="page-info"><span class="page-author-info" aria-label="Author🖊" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://vanhung4499.github.io" target="_blank" rel="noopener noreferrer">Hung Nguyen</a></span><span property="author" content="Hung Nguyen"></span></span><!----><span class="page-date-info" aria-label="Writing Date📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-07-05T10:10:42.000Z"></span><!----><span class="page-reading-time-info" aria-label="Reading Time⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 19 min</span><meta property="timeRequired" content="PT19M"></span><span class="page-category-info" aria-label="Category🌈" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color4 clickable" role="navigation">interview</span><!--]--><meta property="articleSection" content="interview"></span><span class="page-tag-info" aria-label="Tag🏷" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color4 clickable" role="navigation">interview</span><span class="page-tag-item color8 clickable" role="navigation">java</span><!--]--><meta property="keywords" content="interview,java"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">On This Page<button type="button" class="print-button" title="Print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mo-ta-ngan-gon-ve-mo-hinh-bo-nho-java-jmm">Mô tả ngắn gọn về Mô hình bộ nhớ Java (JMM)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mo-ta-ngan-gon-ve-as-if-serial">Mô tả ngắn gọn về as-if-serial</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mo-ta-ngan-gon-ve-tam-quy-tac-happens-before">Mô tả ngắn gọn về tám quy tắc happens-before</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#su-khac-biet-giua-as-if-serial-va-happens-before">Sự khác biệt giữa as-if-serial và happens-before</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mo-ta-ngan-gon-ve-thao-tac-nguyen-tu">Mô tả ngắn gọn về thao tác nguyên tử</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mo-ta-ngan-gon-ve-tinh-kha-kien-cua-luong">Mô tả ngắn gọn về tính khả kiến của luồng</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mo-ta-ngan-gon-ve-tinh-tuan-tu">Mô tả ngắn gọn về tính tuần tự</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mo-ta-ngan-gon-ve-tu-khoa-volatile-trong-java">Mô tả ngắn gọn về từ khóa volatile trong Java</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#cac-cach-trien-khai-luong-trong-java">Các cách triển khai luồng trong Java</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mo-ta-ngan-gon-ve-trang-thai-cua-luong-trong-java">Mô tả ngắn gọn về trạng thái của luồng trong Java</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mo-ta-ngan-gon-ve-cach-giao-tiep-giua-cac-luong">Mô tả ngắn gọn về cách giao tiếp giữa các luồng</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mo-ta-ngan-gon-ve-thread-pool-be-luong">Mô tả ngắn gọn về Thread Pool (Bể Luồng)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mo-ta-ngan-gon-ve-khung-executor">Mô tả ngắn gọn về khung Executor</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mo-ta-ngan-gon-ve-ke-thua-cua-executor">Mô tả ngắn gọn về kế thừa của Executor</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mo-ta-ngan-gon-ve-trang-thai-cua-thread-pool">Mô tả ngắn gọn về trạng thái của Thread Pool</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mo-ta-ngan-gon-ve-cac-loai-thread-pool">Mô tả ngắn gọn về các loại Thread Pool</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mo-ta-ngan-gon-ve-hang-đoi-chan-blocking-queue">Mô tả ngắn gọn về hàng đợi chặn (Blocking Queue)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#noi-ve-threadlocal">Nói về ThreadLocal</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#noi-ve-hieu-biet-cua-ban-ve-lop-unsafe-trong-goi-java-concurrency">Nói về hiểu biết của bạn về lớp unsafe trong gói Java concurrency</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#khoa-lac-quan-va-thuat-toan-cas-trong-java">Khóa lạc quan và thuật toán CAS trong Java</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#van-đe-aba-va-cach-giai-quyet">Vấn đề ABA và cách giải quyết</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#cac-lop-atomic-pho-bien">Các lớp Atomic phổ biến</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#nguyen-ly-co-ban-cua-lop-atomic">Nguyên lý cơ bản của lớp Atomic</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#countdownlatch">CountDownLatch</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#cyclicbarrier">CyclicBarrier</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#semaphore">Semaphore</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#exchanger">Exchanger</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#concurrenthashmap">ConcurrentHashMap</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#nguyen-ly-cua-tu-khoa-synchronized">Nguyên lý của từ khóa synchronized</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#cach-su-dung-tu-khoa-synchronized">Cách sử dụng từ khóa synchronized</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gioi-thieu-ve-khoa-thien-vi-trong-java">Giới thiệu về Khóa Thiên Vị trong Java</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gioi-thieu-ve-khoa-nhe">Giới thiệu về Khóa Nhẹ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gioi-thieu-ve-cac-chien-luoc-toi-uu-khoa">Giới thiệu về Các Chiến Lược Tối Ưu Khóa</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gioi-thieu-ve-khoa-quay-vong-trong-java">Giới thiệu về Khóa Quay Vòng trong Java</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gioi-thieu-ve-khoa-quay-vong-thich-ung">Giới thiệu về Khóa Quay Vòng Thích Ứng</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gioi-thieu-ve-tho-hoa-khoa">Giới thiệu về Thô Hóa Khóa</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gioi-thieu-ve-loai-bo-khoa">Giới thiệu về Loại Bỏ Khóa</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gioi-thieu-ve-lock-va-reentrantlock">Giới thiệu về Lock và ReentrantLock</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gioi-thieu-ve-aqs">Giới thiệu về AQS</a></li><!----><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h1 id="java-concurrency-phai-hoc-thuoc" tabindex="-1"><a class="header-anchor" href="#java-concurrency-phai-hoc-thuoc"><span>Java Concurrency (Phải học thuộc)</span></a></h1><h3 id="mo-ta-ngan-gon-ve-mo-hinh-bo-nho-java-jmm" tabindex="-1"><a class="header-anchor" href="#mo-ta-ngan-gon-ve-mo-hinh-bo-nho-java-jmm"><span>Mô tả ngắn gọn về Mô hình bộ nhớ Java (JMM)</span></a></h3><p>Mô hình bộ nhớ Java định nghĩa các quy tắc truy cập các biến trong chương trình:</p><ul><li>Tất cả các biến đều được lưu trữ trong bộ nhớ chính và mỗi luồng có bộ nhớ làm việc riêng.</li><li>Bộ nhớ làm việc chứa bản sao của các biến từ bộ nhớ chính mà luồng sử dụng. Mọi thao tác với các biến đều phải thực thi trong bộ nhớ làm việc, không thể đọc hoặc ghi trực tiếp vào bộ nhớ chính.</li><li>Sau khi hoàn thành, bộ nhớ làm việc của luồng sẽ đẩy dữ liệu đã thao tác trở lại bộ nhớ chính thông qua giao thức nhất quán bộ nhớ đệm.</li></ul><h3 id="mo-ta-ngan-gon-ve-as-if-serial" tabindex="-1"><a class="header-anchor" href="#mo-ta-ngan-gon-ve-as-if-serial"><span>Mô tả ngắn gọn về as-if-serial</span></a></h3><p>Trình biên dịch sẽ thực hiện sắp xếp lại và tối ưu hóa các lệnh trong chương trình gốc. Tuy nhiên, bất kể sắp xếp lại thế nào, kết quả phải tương ứng với kết quả đầu ra dự kiến của chương trình gốc.</p><h3 id="mo-ta-ngan-gon-ve-tam-quy-tac-happens-before" tabindex="-1"><a class="header-anchor" href="#mo-ta-ngan-gon-ve-tam-quy-tac-happens-before"><span>Mô tả ngắn gọn về tám quy tắc happens-before</span></a></h3><ul><li><strong>Quy tắc thứ tự chương trình</strong>: Trong một luồng, các thao tác viết trước sẽ xảy ra trước các thao tác viết sau theo thứ tự mã nguồn.</li><li><strong>Quy tắc khóa</strong>: Một thao tác unlock xảy ra trước một thao tác lock sau đó trên cùng một khóa.</li><li><strong>Quy tắc biến volatile</strong>: Việc ghi vào một biến xảy ra trước việc đọc biến đó sau đó.</li><li><strong>Quy tắc truyền</strong>: Nếu thao tác A xảy ra trước thao tác B và thao tác B xảy ra trước thao tác C, thì có thể suy ra thao tác A xảy ra trước thao tác C.</li><li><strong>Quy tắc khởi động luồng</strong>: Phương thức start() của đối tượng Thread xảy ra trước mọi hành động của luồng đó.</li><li><strong>Quy tắc ngắt luồng</strong>: Việc gọi phương thức interrupt() của một luồng xảy ra trước khi mã của luồng đó phát hiện sự kiện ngắt.</li><li><strong>Quy tắc kết thúc luồng</strong>: Tất cả các thao tác của một luồng xảy ra trước khi phát hiện luồng đó đã kết thúc, chúng ta có thể phát hiện qua phương thức Thread.join() hoặc Thread.isAlive().</li><li><strong>Quy tắc kết thúc đối tượng</strong>: Hoàn tất khởi tạo một đối tượng xảy ra trước khi phương thức finalize() của nó bắt đầu.</li></ul><h3 id="su-khac-biet-giua-as-if-serial-va-happens-before" tabindex="-1"><a class="header-anchor" href="#su-khac-biet-giua-as-if-serial-va-happens-before"><span>Sự khác biệt giữa as-if-serial và happens-before</span></a></h3><p>as-if-serial đảm bảo kết quả thực thi của chương trình đơn luồng không thay đổi, happens-before đảm bảo kết quả thực thi đúng của chương trình đa luồng được đồng bộ hóa.</p><h3 id="mo-ta-ngan-gon-ve-thao-tac-nguyen-tu" tabindex="-1"><a class="header-anchor" href="#mo-ta-ngan-gon-ve-thao-tac-nguyen-tu"><span>Mô tả ngắn gọn về thao tác nguyên tử</span></a></h3><p>Một thao tác hoặc một nhóm thao tác, hoặc tất cả đều được thực thi và quá trình thực thi không bị gián đoạn bởi bất kỳ yếu tố nào, hoặc tất cả đều không được thực thi. Đây là thao tác nguyên tử.</p><h3 id="mo-ta-ngan-gon-ve-tinh-kha-kien-cua-luong" tabindex="-1"><a class="header-anchor" href="#mo-ta-ngan-gon-ve-tinh-kha-kien-cua-luong"><span>Mô tả ngắn gọn về tính khả kiến của luồng</span></a></h3><p>Tính khả kiến nghĩa là khi một luồng thay đổi biến chia sẻ, các luồng khác có thể biết ngay lập tức về thay đổi này. volatile, synchronized và final đều đảm bảo tính khả kiến.</p><h3 id="mo-ta-ngan-gon-ve-tinh-tuan-tu" tabindex="-1"><a class="header-anchor" href="#mo-ta-ngan-gon-ve-tinh-tuan-tu"><span>Mô tả ngắn gọn về tính tuần tự</span></a></h3><p>Mặc dù đa luồng có sự cạnh tranh và tối ưu hóa lệnh, nhưng trong luồng hiện tại, tất cả các thao tác thực thi đều có thứ tự.</p><h3 id="mo-ta-ngan-gon-ve-tu-khoa-volatile-trong-java" tabindex="-1"><a class="header-anchor" href="#mo-ta-ngan-gon-ve-tu-khoa-volatile-trong-java"><span>Mô tả ngắn gọn về từ khóa volatile trong Java</span></a></h3><ul><li>Đảm bảo tính khả kiến của biến đối với tất cả các luồng. Khi một luồng thay đổi giá trị của biến, giá trị mới có thể được nhận biết ngay lập tức bởi các luồng khác.</li><li>Ngăn cấm sắp xếp lại lệnh. Khi sử dụng biến volatile để thực hiện thao tác ghi, trình biên dịch sẽ chèn một rào chắn bộ nhớ vào dãy lệnh để ngăn cấm các loại bộ xử lý cụ thể thực hiện sắp xếp lại.</li></ul><h3 id="cac-cach-trien-khai-luong-trong-java" tabindex="-1"><a class="header-anchor" href="#cac-cach-trien-khai-luong-trong-java"><span>Các cách triển khai luồng trong Java</span></a></h3><ul><li>Triển khai interface Runnable</li><li>Kế thừa lớp Thread</li><li>triển khai interface Callable</li></ul><h3 id="mo-ta-ngan-gon-ve-trang-thai-cua-luong-trong-java" tabindex="-1"><a class="header-anchor" href="#mo-ta-ngan-gon-ve-trang-thai-cua-luong-trong-java"><span>Mô tả ngắn gọn về trạng thái của luồng trong Java</span></a></h3><p>Trạng thái của luồng bao gồm NEW, RUNNABLE, BLOCKED, WAITING, TIMED_WAITING, TERMINATED</p><ul><li><strong>NEW</strong>: Trạng thái mới, luồng được tạo và chưa bắt đầu, chưa gọi phương thức start.</li><li><strong>RUNNABLE</strong>: Trạng thái chạy, luồng đang được thực thi trong JVM, nhưng không nhất thiết đang chạy thực sự, có thể đang chờ CPU.</li><li><strong>BLOCKED</strong>: Trạng thái bị chặn, luồng đang chờ để lấy khóa và khóa chưa được cấp.</li><li><strong>WAITING</strong>: Trạng thái chờ, phương thức run của luồng thực thi xong Object.wait()/Thread.join() và vào trạng thái này.</li><li><strong>TIMED_WAITING</strong>: Trạng thái chờ có thời hạn, sau một thời gian nhất định sẽ thoát khỏi trạng thái. Gọi Thread.sleep(long), Object.wait(long), Thread.join(long) sẽ vào trạng thái này. Các tham số này đại diện cho thời gian chờ.</li><li><strong>TERMINATED</strong>: Trạng thái kết thúc, luồng thực thi xong phương thức run và vào trạng thái này.</li></ul><h3 id="mo-ta-ngan-gon-ve-cach-giao-tiep-giua-cac-luong" tabindex="-1"><a class="header-anchor" href="#mo-ta-ngan-gon-ve-cach-giao-tiep-giua-cac-luong"><span>Mô tả ngắn gọn về cách giao tiếp giữa các luồng</span></a></h3><ul><li>Sử dụng từ khóa volatile để sửa đổi biến, đảm bảo tính khả kiến của biến đối với tất cả các luồng.</li><li>Sử dụng từ khóa synchronized, đảm bảo nhiều luồng chỉ có thể vào phương thức hoặc khối đồng bộ cùng lúc.</li><li>Sử dụng các phương thức wait/notify.</li><li>Giao tiếp qua IO.</li></ul><h3 id="mo-ta-ngan-gon-ve-thread-pool-be-luong" tabindex="-1"><a class="header-anchor" href="#mo-ta-ngan-gon-ve-thread-pool-be-luong"><span>Mô tả ngắn gọn về Thread Pool (Bể Luồng)</span></a></h3><p>Khi không có Thread Pool, việc tạo và hủy nhiều luồng tiêu tốn nhiều tài nguyên. Nếu tái sử dụng các luồng đã tạo sau khi hoàn thành nhiệm vụ hiện tại, có thể giảm thiểu chi phí và kiểm soát số lượng luồng đồng thời tối đa.</p><p>Khi Thread Pool tạo luồng, nó sẽ bao bọc luồng thành Worker. Worker sau khi hoàn thành nhiệm vụ sẽ tiếp tục lấy nhiệm vụ từ hàng đợi công việc để thực thi.</p><p>Khi phân phối nhiệm vụ cho Thread Pool, có các trường hợp sau:</p><ul><li>Nếu Thread Pool lõi chưa đầy, tạo một luồng mới để thực thi nhiệm vụ.</li><li>Nếu Thread Pool lõi đã đầy, hàng đợi công việc chưa đầy, lưu luồng vào hàng đợi công việc.</li><li>Nếu hàng đợi công việc đã đầy, số lượng luồng nhỏ hơn số luồng tối đa thì tạo một luồng mới để xử lý nhiệm vụ.</li><li>Nếu vượt quá số lượng luồng tối đa, nhiệm vụ sẽ được xử lý theo chiến lược từ chối.</li></ul><p>Các tham số của Thread Pool:</p><ul><li><strong>corePoolSize</strong>: Số lượng luồng lõi thường trực. Nếu vượt quá giá trị này và luồng không hoạt động, nó sẽ bị hủy.</li><li><strong>maximumPoolSize</strong>: Số lượng luồng tối đa mà Thread Pool có thể chứa.</li><li><strong>keepAliveTime</strong>: Thời gian giữ lại luồng không hoạt động. Khi luồng không hoạt động đến giá trị này, nó sẽ bị hủy, chỉ giữ lại các luồng lõi để tránh lãng phí tài nguyên bộ nhớ.</li><li><strong>workQueue</strong>: Hàng đợi công việc.</li><li><strong>threadFactory</strong>: Nhà máy luồng, dùng để sản xuất các luồng cho nhóm nhiệm vụ tương tự.</li><li><strong>handler</strong>: Chiến lược từ chối.</li></ul><p>Các chiến lược từ chối:</p><ul><li><strong>AbortPolicy</strong>: Bỏ qua nhiệm vụ và ném ra ngoại lệ.</li><li><strong>CallerRunsPolicy</strong>: Thử lại việc nộp nhiệm vụ.</li><li><strong>DiscardOldestPolicy</strong>: Bỏ nhiệm vụ chờ đợi lâu nhất trong hàng đợi và thêm nhiệm vụ hiện tại vào hàng đợi.</li><li><strong>DiscardPolicy</strong>: Bỏ nhiệm vụ hiện tại nhưng không ném ra ngoại lệ.</li></ul><h3 id="mo-ta-ngan-gon-ve-khung-executor" tabindex="-1"><a class="header-anchor" href="#mo-ta-ngan-gon-ve-khung-executor"><span>Mô tả ngắn gọn về khung Executor</span></a></h3><p>Khung Executor nhằm tách biệt việc nộp nhiệm vụ và cách thực thi nhiệm vụ. Người dùng không cần phải xem xét việc thiết kế nộp nhiệm vụ từ mã nguồn, chỉ cần gọi phương thức <code>execute</code> của các lớp triển khai của khung Executor để nộp nhiệm vụ.</p><h3 id="mo-ta-ngan-gon-ve-ke-thua-cua-executor" tabindex="-1"><a class="header-anchor" href="#mo-ta-ngan-gon-ve-ke-thua-cua-executor"><span>Mô tả ngắn gọn về kế thừa của Executor</span></a></h3><ul><li><strong>Executor</strong>: Một interface định nghĩa một phương thức nhận đối tượng Runnable và thực thi nhiệm vụ.</li><li><strong>ExecutorService</strong>: interface con của Executor, định nghĩa một phương thức nhận đối tượng Callable và trả về đối tượng Future, đồng thời cung cấp phương thức execute.</li><li><strong>ScheduledExecutorService</strong>: interface con của ExecutorService, hỗ trợ thực thi nhiệm vụ định kỳ.</li><li><strong>AbstractExecutorService</strong>: Lớp trừu tượng, cung cấp triển khai mặc định cho các phương thức thực thi của ExecutorService.</li><li><strong>Executors</strong>: Lớp nhà máy tĩnh, cung cấp một loạt các phương thức nhà máy để tạo Thread Pool.</li><li><strong>ThreadPoolExecutor</strong>: Kế thừa AbstractExecutorService, dùng để tạo Thread Pool.</li><li><strong>ForkJoinPool</strong>: Kế thừa AbstractExecutorService, chia nhiệm vụ lớn thành nhiều nhiệm vụ nhỏ để thực thi và tổng hợp kết quả.</li><li><strong>ScheduledThreadPoolExecutor</strong>: Kế thừa ThreadPoolExecutor, triển khai ScheduledExecutorService, dùng để tạo Thread Pool có nhiệm vụ định kỳ.</li></ul><h3 id="mo-ta-ngan-gon-ve-trang-thai-cua-thread-pool" tabindex="-1"><a class="header-anchor" href="#mo-ta-ngan-gon-ve-trang-thai-cua-thread-pool"><span>Mô tả ngắn gọn về trạng thái của Thread Pool</span></a></h3><ul><li><strong>Running</strong>: Có thể nhận nhiệm vụ mới và xử lý nhiệm vụ trong hàng đợi.</li><li><strong>Shutdown</strong>: Không nhận nhiệm vụ mới nhưng xử lý các nhiệm vụ tồn đọng, gọi phương thức <code>shutdown</code> khi đang ở trạng thái running sẽ chuyển sang trạng thái này.</li><li><strong>Stop</strong>: Không nhận nhiệm vụ mới và không xử lý các nhiệm vụ tồn đọng, gọi phương thức <code>shutdownNow</code> để chuyển sang trạng thái này.</li><li><strong>Tidying</strong>: Tất cả nhiệm vụ đã kết thúc, số luồng đang hoạt động bằng 0.</li><li><strong>Terminated</strong>: Thread Pool hoàn toàn kết thúc, gọi phương thức <code>terminated</code> ở trạng thái tidying sẽ chuyển sang trạng thái này.</li></ul><h3 id="mo-ta-ngan-gon-ve-cac-loai-thread-pool" tabindex="-1"><a class="header-anchor" href="#mo-ta-ngan-gon-ve-cac-loai-thread-pool"><span>Mô tả ngắn gọn về các loại Thread Pool</span></a></h3><ul><li><strong>newCachedThreadPool</strong>: Bể luồng có thể lưu trữ luồng, có thể thiết lập số lượng luồng tối thiểu và tối đa, luồng không hoạt động trong 1 phút sẽ bị hủy.</li><li><strong>newFixedThreadPool</strong>: Bể luồng với số lượng luồng làm việc cố định.</li><li><strong>newSingleThreadExecutor</strong>: Executor với một luồng duy nhất.</li><li><strong>newScheduledThreadPool</strong>: Bể luồng với số lượng luồng cố định hỗ trợ nhiệm vụ định kỳ.</li><li><strong>newSingleThreadScheduledExecutor</strong>: Executor với một luồng duy nhất hỗ trợ nhiệm vụ định kỳ.</li></ul><h3 id="mo-ta-ngan-gon-ve-hang-đoi-chan-blocking-queue" tabindex="-1"><a class="header-anchor" href="#mo-ta-ngan-gon-ve-hang-đoi-chan-blocking-queue"><span>Mô tả ngắn gọn về hàng đợi chặn (Blocking Queue)</span></a></h3><p>Hàng đợi chặn là một trong những thành phần cụ thể của mô hình sản xuất-tiêu thụ. Khi hàng đợi chặn rỗng, thao tác lấy phần tử từ hàng đợi sẽ bị chặn. Khi hàng đợi chặn đầy, thao tác thêm phần tử vào hàng đợi sẽ bị chặn. Các triển khai cụ thể bao gồm:</p><ul><li><strong>ArrayBlockingQueue</strong>: Hàng đợi chặn có giới hạn, được tạo thành từ mảng.</li><li><strong>LinkedBlockingQueue</strong>: Hàng đợi chặn có giới hạn, được tạo thành từ danh sách liên kết.</li><li><strong>PriorityBlockingQueue</strong>: Hàng đợi ưu tiên chặn.</li><li><strong>DelayQueue</strong>: Tạo phần tử có thể được lấy ra khỏi hàng đợi sau một khoảng thời gian nhất định.</li><li><strong>SynchronousQueue</strong>: Hàng đợi chặn không lưu trữ phần tử, mỗi lần thêm phải chờ thao tác lấy.</li><li><strong>LinkedTransferQueue</strong>: Giống LinkedBlockingQueue nhưng có thêm phương thức transfer, tức là nếu có người tiêu thụ đang chờ nhận phần tử, có thể ngay lập tức chuyển phần tử từ nhà sản xuất sang người tiêu thụ.</li><li><strong>LinkedBlockingDeque</strong>: Hàng đợi chặn hai chiều.</li></ul><h3 id="noi-ve-threadlocal" tabindex="-1"><a class="header-anchor" href="#noi-ve-threadlocal"><span>Nói về ThreadLocal</span></a></h3><p>ThreadLocal là biến chia sẻ trong luồng. ThreadLocal có một lớp nội bộ tĩnh là ThreadLocalMap, khóa là đối tượng ThreadLocal, giá trị là đối tượng Entry. ThreadLocalMap là riêng tư cho mỗi luồng.</p><ul><li><strong>set</strong>: Đặt giá trị cho ThreadLocalMap.</li><li><strong>get</strong>: Lấy giá trị từ ThreadLocalMap.</li><li><strong>remove</strong>: Xóa đối tượng kiểu ThreadLocalMap.</li></ul><p>Vấn đề: Đối với Thread Pool, vì Thread Pool tái sử dụng các đối tượng Thread, do đó các ThreadLocal gắn với Thread cũng bị tái sử dụng, gây ra một loạt vấn đề.</p><p>Ví dụ: rò rỉ bộ nhớ. Do ThreadLocal là tham chiếu yếu, nhưng giá trị của Entry là tham chiếu mạnh, do đó khi ThreadLocal bị thu gom rác, giá trị vẫn không được giải phóng, gây ra rò rỉ bộ nhớ.</p><h3 id="noi-ve-hieu-biet-cua-ban-ve-lop-unsafe-trong-goi-java-concurrency" tabindex="-1"><a class="header-anchor" href="#noi-ve-hieu-biet-cua-ban-ve-lop-unsafe-trong-goi-java-concurrency"><span>Nói về hiểu biết của bạn về lớp unsafe trong gói Java concurrency</span></a></h3><p>Trong ngôn ngữ Java, không có các thành phần con trỏ trực tiếp, và thường không thể sử dụng offset để thao tác một khối bộ nhớ. Các thao tác này tương đối an toàn (safe).</p><p>Java có một lớp gọi là Unsafe, lớp này mang lại cho Java khả năng thao tác không gian bộ nhớ giống như con trỏ trong ngôn ngữ C, đồng thời cũng mang lại các vấn đề về con trỏ. Lớp này có thể được coi là nền tảng cho việc phát triển đa luồng trong Java.</p><h3 id="khoa-lac-quan-va-thuat-toan-cas-trong-java" tabindex="-1"><a class="header-anchor" href="#khoa-lac-quan-va-thuat-toan-cas-trong-java"><span>Khóa lạc quan và thuật toán CAS trong Java</span></a></h3><p>Khóa lạc quan cho rằng xác suất xảy ra xung đột đồng thời là rất thấp, do đó không khóa trong quá trình đọc dữ liệu.</p><p>Chỉ khi thực hiện thao tác ghi, mới kiểm tra xem dữ liệu có bị thay đổi bởi các luồng khác không. Nếu có thay đổi, ghi thất bại; nếu không, tiến hành ghi và báo cáo thành công.</p><p>Khóa lạc quan thường sử dụng thuật toán Compare And Swap (CAS) để triển khai. Như tên gọi, thuật toán này bao gồm hai thao tác: so sánh (Compare) và hoán đổi (Swap).</p><h3 id="van-đe-aba-va-cach-giai-quyet" tabindex="-1"><a class="header-anchor" href="#van-đe-aba-va-cach-giai-quyet"><span>Vấn đề ABA và cách giải quyết</span></a></h3><p>Thuật toán CAS dựa vào giá trị để so sánh. Nếu có hai luồng, một luồng thay đổi giá trị từ A thành B, sau đó từ B quay lại A, khi luồng hiện tại triển khai thuật toán CAS, sẽ dễ dàng nhận định rằng giá trị không thay đổi và nghĩ rằng không có luồng nào khác đã thay đổi dữ liệu.</p><p>Gói <code>java.util.concurrent</code> cung cấp một lớp AtomicStampedReference, thêm dấu phiên bản vào giá trị để giải quyết vấn đề ABA.</p><h3 id="cac-lop-atomic-pho-bien" tabindex="-1"><a class="header-anchor" href="#cac-lop-atomic-pho-bien"><span>Các lớp Atomic phổ biến</span></a></h3><p>Trong nhiều trường hợp, chúng ta chỉ cần một giải pháp ++ hoặc -- đơn giản, hiệu quả và an toàn trong môi trường đa luồng. Sử dụng synchronized hoặc lock có thể giải quyết, nhưng chi phí lớn. Lớp Atomic tiện lợi hơn. Dưới đây là các lớp Atomic cơ bản:</p><ul><li>AtomicInteger: Cập nhật số nguyên nguyên tử.</li><li>AtomicLong: Cập nhật số nguyên dài nguyên tử.</li><li>AtomicBoolean: Cập nhật kiểu boolean nguyên tử.</li></ul><p>Các lớp mảng Atomic:</p><ul><li>AtomicIntegerArray: Cập nhật nguyên tử các phần tử trong mảng số nguyên.</li><li>AtomicLongArray: Cập nhật nguyên tử các phần tử trong mảng số nguyên dài.</li><li>AtomicReferenceArray: Cập nhật nguyên tử các phần tử trong mảng tham chiếu.</li></ul><p>Các lớp tham chiếu Atomic:</p><ul><li>AtomicReference: Cập nhật nguyên tử các tham chiếu.</li><li>AtomicMarkableReference: Cập nhật nguyên tử các tham chiếu có cờ đánh dấu.</li><li>AtomicStampedReference: Cập nhật nguyên tử các tham chiếu có phiên bản.</li></ul><p>FieldUpdater:</p><ul><li>AtomicIntegerFieldUpdater: Cập nhật nguyên tử các trường số nguyên.</li><li>AtomicLongFieldUpdater: Cập nhật nguyên tử các trường số nguyên dài.</li><li>AtomicReferenceFieldUpdater: Cập nhật nguyên tử các trường tham chiếu.</li></ul><h3 id="nguyen-ly-co-ban-cua-lop-atomic" tabindex="-1"><a class="header-anchor" href="#nguyen-ly-co-ban-cua-lop-atomic"><span>Nguyên lý cơ bản của lớp Atomic</span></a></h3><p>Lấy ví dụ lớp AtomicInteger.</p><p>Phương thức getAndIncrement tăng giá trị hiện tại lên 1 một cách nguyên tử. Cách triển khai cụ thể như sau:</p><ul><li>Trong vòng lặp for vô tận, lấy giá trị hiện tại trong AtomicInteger.</li><li>Tăng giá trị hiện tại lên 1.</li><li>Gọi phương thức compareAndSet để cập nhật nguyên tử.</li><li>Kiểm tra giá trị hiện tại có bằng với giá trị mong đợi.</li><li>Nếu bằng, nghĩa là giá trị chưa bị luồng khác thay đổi, cập nhật giá trị mới.</li><li>Nếu không bằng, vòng lặp tiếp tục so sánh lại.</li></ul><h3 id="countdownlatch" tabindex="-1"><a class="header-anchor" href="#countdownlatch"><span>CountDownLatch</span></a></h3><p>CountDownLatch cho phép một luồng chờ đợi các luồng khác hoàn thành. Được triển khai bằng một bộ đếm, khởi tạo bằng số lượng luồng. Khi một luồng hoàn thành, gọi phương thức countDown để giảm bộ đếm. Khi bộ đếm bằng 0, luồng chờ có thể tiếp tục. CountDownLatch chỉ sử dụng một lần, không reset được.</p><h3 id="cyclicbarrier" tabindex="-1"><a class="header-anchor" href="#cyclicbarrier"><span>CyclicBarrier</span></a></h3><p>CyclicBarrier có chức năng tương tự CountDownLatch, cũng sử dụng bộ đếm để cho phép một luồng chờ các luồng khác hoàn thành. Tuy nhiên, CyclicBarrier có thể tái sử dụng (reset).</p><h3 id="semaphore" tabindex="-1"><a class="header-anchor" href="#semaphore"><span>Semaphore</span></a></h3><p>Semaphore, hay còn gọi là cờ hiệu, nhận một giá trị int để đặt số lượng phép cấp phép khả dụng. Sử dụng phương thức acquire để nhận một phép cấp phép, giảm bộ đếm, và release để trả lại phép cấp phép, tăng bộ đếm. Nếu bộ đếm bằng 0, luồng sẽ vào trạng thái chờ.</p><h3 id="exchanger" tabindex="-1"><a class="header-anchor" href="#exchanger"><span>Exchanger</span></a></h3><p>Lớp Exchanger cho phép hai luồng trao đổi thông tin. Có thể hiểu Exchanger như một container chứa hai ô. Thông qua phương thức exchange, hai luồng có thể trao đổi dữ liệu. Khi hai luồng đến điểm đồng bộ, thông tin trong hai ô sẽ được hoán đổi và trả về cho các luồng.</p><h3 id="concurrenthashmap" tabindex="-1"><a class="header-anchor" href="#concurrenthashmap"><span>ConcurrentHashMap</span></a></h3><p>Trong JDK7, sử dụng kỹ thuật phân đoạn khóa. Dữ liệu được chia thành các đoạn Segment, mỗi đoạn có một khóa riêng. Khi một luồng giữ khóa của một đoạn, các đoạn khác vẫn có thể được truy cập bởi các luồng khác.</p><p>Phương thức get không cần khóa, chỉ khi đọc giá trị trống mới cần khóa. Phương thức put phải khóa, định vị đến Segment và chèn phần tử.</p><p>Trong JDK8, cải tiến bằng cách:</p><ul><li>Bỏ cơ chế phân đoạn khóa, sử dụng thuật toán CAS để cập nhật giá trị. Nếu CAS thất bại, sử dụng synchronized để khóa và chèn phần tử.</li><li>Thêm cấu trúc cây đỏ-đen. Khi một slot chứa hơn 8 phần tử và mảng Node lớn hơn 64, chuyển danh sách liên kết thành cây đỏ-đen.</li><li>Tối ưu hóa cách đếm số lượng phần tử trong tập hợp.</li></ul><h3 id="nguyen-ly-cua-tu-khoa-synchronized" tabindex="-1"><a class="header-anchor" href="#nguyen-ly-cua-tu-khoa-synchronized"><span>Nguyên lý của từ khóa synchronized</span></a></h3><p>Các đối tượng Java có một monitor liên kết. Khi sử dụng synchronized, JVM sẽ tìm monitor của đối tượng và quyết định khóa hoặc mở khóa dựa trên trạng thái của monitor. Nếu khóa thành công, monitor sẽ không bị các luồng khác lấy đến khi được giải phóng.</p><p>Synchronized sau khi biên dịch sẽ tạo ra hai lệnh bytecode monitorenter và monitorexit, để lấy và giải phóng monitor. Hai lệnh này cần một tham chiếu để xác định đối tượng khóa hoặc mở khóa. Với phương thức thông thường, khóa là đối tượng hiện tại; với phương thức tĩnh, khóa là đối tượng Class; với khối mã đồng bộ, khóa là đối tượng trong ngoặc.</p><p>Khi triển khai monitorenter, nếu đối tượng không bị khóa hoặc luồng hiện tại đã giữ khóa, tăng bộ đếm khóa lên 1. Khi triển khai monitorexit, giảm bộ đếm khóa đi 1. Khi bộ đếm bằng 0, khóa được giải phóng.</p><h3 id="cach-su-dung-tu-khoa-synchronized" tabindex="-1"><a class="header-anchor" href="#cach-su-dung-tu-khoa-synchronized"><span>Cách sử dụng từ khóa synchronized</span></a></h3><ul><li>Sử dụng để sửa đổi một phương thức thể hiện.</li><li>Sử dụng để sửa đổi một phương thức tĩnh.</li><li>Sử dụng để sửa đổi một khối mã đồng bộ.</li></ul><h3 id="gioi-thieu-ve-khoa-thien-vi-trong-java" tabindex="-1"><a class="header-anchor" href="#gioi-thieu-ve-khoa-thien-vi-trong-java"><span>Giới thiệu về Khóa Thiên Vị trong Java</span></a></h3><p>Khóa thiên vị được giới thiệu trong JDK 1.6. Khái niệm này được đưa ra do các nhà phát triển nhận thấy trong hầu hết các trường hợp, khóa không có sự cạnh tranh, và một khóa thường được giữ bởi cùng một luồng. Khóa thiên vị không tự động giải phóng, mỗi khi vào khóa thiên vị, nó sẽ kiểm tra xem tài nguyên có thiên về nó hay không, nếu có thì không cần thực hiện thêm thao tác nào và có thể vào khối đồng bộ ngay lập tức.</p><p>Quy trình xin khóa như sau:</p><ul><li>Đầu tiên, kiểm tra xem Mark Word của đối tượng có thuộc chế độ thiên vị hay không, nếu không, chuyển sang kiểm tra khóa nhẹ. Nếu có, tiếp tục bước tiếp theo;</li><li>Kiểm tra ID của luồng yêu cầu khóa hiện tại có trùng với ID của luồng ghi nhận trong khóa thiên vị hay không. Nếu trùng, tiếp tục bước tiếp theo, nếu không, chuyển đến bước 4;</li><li>Kiểm tra có cần thiên vị lại hay không. Nếu không, luồng sẽ nhận được khóa thiên vị ngay;</li><li>Sử dụng thuật toán CAS để thay đổi Mark Word của đối tượng, thay phần ID luồng thành ID của luồng hiện tại. Nếu thành công, khóa thiên vị sẽ được nhận. Nếu thất bại, tức là có sự cạnh tranh từ nhiều luồng, khóa sẽ nâng cấp thành khóa nhẹ.</li></ul><h3 id="gioi-thieu-ve-khoa-nhe" tabindex="-1"><a class="header-anchor" href="#gioi-thieu-ve-khoa-nhe"><span>Giới thiệu về Khóa Nhẹ</span></a></h3><p>Khóa nhẹ được thiết kế để giảm thiểu tiêu hao hiệu suất gây ra bởi khóa nặng khi không có sự cạnh tranh.</p><p>Quy trình xin khóa như sau:</p><ul><li>Nếu đối tượng đồng bộ chưa bị khóa, JVM sẽ tạo một không gian ghi khóa trong khung ngăn xếp của luồng hiện tại, lưu bản sao của Mark Word của đối tượng.</li><li>JVM sử dụng CAS để cố gắng cập nhật Mark Word của đối tượng thành con trỏ chỉ đến không gian ghi khóa.</li><li>Nếu cập nhật thành công, luồng hiện tại sẽ sở hữu khóa, đánh dấu trạng thái khóa là 00, biểu thị trạng thái khóa nhẹ.</li><li>Nếu cập nhật thất bại, nghĩa là ít nhất có một luồng khác cạnh tranh. JVM kiểm tra Mark Word của đối tượng có chỉ đến khung ngăn xếp của luồng hiện tại hay không.</li><li>Nếu có, luồng hiện tại đã sở hữu khóa và tiếp tục vào khối đồng bộ.</li><li>Nếu không, khóa đã bị luồng khác chiếm dụng.</li><li>Nếu có hơn hai luồng cạnh tranh cùng một khóa, khóa nhẹ sẽ không còn hiệu quả, chuyển thành khóa nặng, trạng thái khóa chuyển thành 10, và các luồng chờ khóa phải bị chặn.</li></ul><h3 id="gioi-thieu-ve-cac-chien-luoc-toi-uu-khoa" tabindex="-1"><a class="header-anchor" href="#gioi-thieu-ve-cac-chien-luoc-toi-uu-khoa"><span>Giới thiệu về Các Chiến Lược Tối Ưu Khóa</span></a></h3><p>Gồm các chiến lược như quay vòng thích ứng, loại bỏ khóa, thô hóa khóa, nâng cấp khóa.</p><h3 id="gioi-thieu-ve-khoa-quay-vong-trong-java" tabindex="-1"><a class="header-anchor" href="#gioi-thieu-ve-khoa-quay-vong-trong-java"><span>Giới thiệu về Khóa Quay Vòng trong Java</span></a></h3><p>Khi một luồng thất bại trong việc nhận khóa, có thể không từ bỏ CPU mà liên tục thử lại, gọi là khóa quay vòng.</p><h3 id="gioi-thieu-ve-khoa-quay-vong-thich-ung" tabindex="-1"><a class="header-anchor" href="#gioi-thieu-ve-khoa-quay-vong-thich-ung"><span>Giới thiệu về Khóa Quay Vòng Thích Ứng</span></a></h3><p>Khóa quay vòng thích ứng không đặt số lần quay vòng cố định mà dựa trên thời gian quay vòng trước đó và trạng thái của luồng giữ khóa để quyết định.</p><h3 id="gioi-thieu-ve-tho-hoa-khoa" tabindex="-1"><a class="header-anchor" href="#gioi-thieu-ve-tho-hoa-khoa"><span>Giới thiệu về Thô Hóa Khóa</span></a></h3><p>Thô hóa khóa là mở rộng phạm vi khóa, tránh việc liên tục khóa và mở khóa.</p><h3 id="gioi-thieu-ve-loai-bo-khoa" tabindex="-1"><a class="header-anchor" href="#gioi-thieu-ve-loai-bo-khoa"><span>Giới thiệu về Loại Bỏ Khóa</span></a></h3><p>Loại bỏ khóa là tối ưu hóa triệt để hơn, trong quá trình biên dịch, trình biên dịch Java quét ngữ cảnh thực thi để loại bỏ những khóa không có khả năng xảy ra cạnh tranh tài nguyên chia sẻ.</p><h3 id="gioi-thieu-ve-lock-va-reentrantlock" tabindex="-1"><a class="header-anchor" href="#gioi-thieu-ve-lock-va-reentrantlock"><span>Giới thiệu về Lock và ReentrantLock</span></a></h3><p>interface Lock là interface chính trong gói đồng bộ của Java.</p><p>Khóa tái nhập ReentrantLock là triển khai phổ biến nhất của Lock, tương tự synchronized. ReentrantLock mặc định là không công bằng, nhưng có thể chỉ định khóa công bằng qua hàm tạo. Khi sử dụng khóa công bằng, hiệu suất sẽ giảm.</p><h3 id="gioi-thieu-ve-aqs" tabindex="-1"><a class="header-anchor" href="#gioi-thieu-ve-aqs"><span>Giới thiệu về AQS</span></a></h3><p>AQS (AbstractQueuedSynchronizer) là bộ đồng bộ hóa kiểu hàng đợi trừu tượng. AQS đóng gói mỗi luồng yêu cầu tài nguyên chia sẻ thành một nút trong hàng đợi khóa, để quản lý phân phối khóa. AQS là nền tảng xây dựng khóa và các thành phần đồng bộ khác, sử dụng biến <code>volatile int state</code> làm tài nguyên chia sẻ. Nếu luồng không nhận được tài nguyên, nó sẽ vào hàng đợi đồng bộ; nếu nhận được, nó sẽ thực thi mã vùng tới hạn và giải phóng tài nguyên khi hoàn tất, thông báo cho các luồng chờ trong hàng đợi đồng bộ.</p><p>Lớp con kế thừa đồng bộ hóa và thực hiện các phương thức trừu tượng <code>getState</code>, <code>setState</code> và <code>compareAndSetState</code> để thay đổi trạng thái đồng bộ.</p><p>Nguyên lý nhận và giải phóng khóa độc quyền của AQS:</p><p>Nhận khóa (acquire):</p><ul><li>Gọi phương thức <code>tryAcquire</code> để nhận trạng thái đồng bộ một cách an toàn, nếu thất bại, tạo nút đồng bộ và thêm vào cuối hàng đợi qua phương thức <code>addWaiter</code>, sau đó quay vòng.</li><li>Gọi phương thức <code>acquireQueued</code> để nút quay vòng nhận trạng thái đồng bộ, nếu không được, luồng sẽ bị chặn.</li></ul><p>Giải phóng khóa (release):</p><ul><li>Gọi phương thức <code>tryRelease</code> để giải phóng trạng thái đồng bộ.</li><li>Gọi phương thức <code>unparkSuccessor</code> để đánh thức nút kế tiếp của nút đầu, cho nút này thử nhận trạng thái đồng bộ.</li></ul><p>Nguyên lý nhận và giải phóng khóa chia sẻ của AQS:</p><p>Nhận khóa (acquireShared):</p><ul><li>Gọi phương thức <code>tryAcquireShared</code> để thử nhận trạng thái đồng bộ, nếu trả về giá trị &gt;= 0, trạng thái đồng bộ sẽ được nhận.</li><li>Giải phóng (releaseShared), và đánh thức các nút chờ tiếp theo.</li></ul></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/vanhung4499/my-wiki/edit/main/src/interview/knowledge/java-thread-must-know.md" aria-label="Edit this page on GitHub" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page on GitHub<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">Last update: </span><!----></div><div class="contributors"><span class="vp-meta-label">Contributors: </span><!--[--><!--[--><span class="vp-meta-info" title="email: vanhung4499@gmail.com">Hung Nguyen</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/interview/knowledge/java-must-know.html" aria-label="Java Basic Must Know"><div class="hint"><span class="arrow start"></span>Prev</div><div class="link"><!---->Java Basic Must Know</div></a><!----></nav><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper" style="display:none;--1ea755b8:;"><div class="footer-content"><div class="footer">Made with ❤️ by Hung Nguyen</div><div class="copyright">Copyright © 2016-2024 Hung Nguyen</div></div><span id="runtime_span"></span></footer></div><!--]--><!--[--><!----><!----><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-B9pwkC50.js" defer></script>
  </body>
</html>
