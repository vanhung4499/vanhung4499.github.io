<!doctype html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.15" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.52" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://vanhung4499.github.io/interview/knowledge/java/jvm-qa.html"><meta property="og:site_name" content="VanHung4499"><meta property="og:title" content="JVM Questions"><meta property="og:description" content="Phá»ng váº¥n JVM cáº¥p tá»‘c Báº¡n cÃ³ thá»ƒ giáº£i thÃ­ch JVM lÃ  gÃ¬ khÃ´ng? NÃ³ hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o? ChÃºng ta Ä‘á»u biáº¿t ráº±ng trong há»‡ thá»‘ng Windows, má»™t gÃ³i cÃ i Ä‘áº·t pháº§n má»m lÃ  tá»‡p exe, Ä‘Ãºng k..."><meta property="og:type" content="article"><meta property="og:image" content="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240926130739.png"><meta property="og:locale" content="en-US"><meta property="og:updated_time" content="2024-10-02T17:20:50.000Z"><meta property="article:author" content="Hung Nguyen"><meta property="article:tag" content="java"><meta property="article:tag" content="interview"><meta property="article:tag" content="jvm"><meta property="article:modified_time" content="2024-10-02T17:20:50.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"JVM Questions","image":["https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240926130739.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240926130750.png","https://cdn.nlark.com/yuque/0/2023/png/8380143/1676273586231-499379c4-3560-4068-85e7-d493e2348a55.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240926130801.png","https://cdn.nlark.com/yuque/0/2023/png/8380143/1676275530469-eb977793-c45f-4b96-abf3-89f640b40978.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240926130828.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240926130835.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240926130904.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240926130801.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240926130917.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240926135002.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240926135026.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240926135059.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240926143251.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240926143327.png","https://cdn.nlark.com/yuque/0/2023/png/8380143/1676384465582-a78d9deb-02bd-48ff-acef-1b793ad8fc14.png","https://cdn.nlark.com/yuque/0/2023/png/8380143/1676428403161-5343ed7a-03c1-4615-958a-5437567f8bc7.png","https://cdn.nlark.com/yuque/0/2023/png/8380143/1676428420180-92b5abf8-95dc-41a1-a892-2293b467c0f6.png","https://cdn.nlark.com/yuque/0/2023/png/8380143/1676428559138-e2f84021-9997-4e17-aedd-135315bae9cd.png"],"dateModified":"2024-10-02T17:20:50.000Z","author":[{"@type":"Person","name":"Hung Nguyen","url":"https://vanhung4499.github.io"}]}</script><meta name="referrer" content="no-referrer-when-downgrade"><link rel="alternate" type="application/rss+xml" href="https://vanhung4499.github.io/rss.xml" title="VanHung4499 RSS Feed"><title>JVM Questions | VanHung4499</title><meta name="description" content="Phá»ng váº¥n JVM cáº¥p tá»‘c Báº¡n cÃ³ thá»ƒ giáº£i thÃ­ch JVM lÃ  gÃ¬ khÃ´ng? NÃ³ hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o? ChÃºng ta Ä‘á»u biáº¿t ráº±ng trong há»‡ thá»‘ng Windows, má»™t gÃ³i cÃ i Ä‘áº·t pháº§n má»m lÃ  tá»‡p exe, Ä‘Ãºng k...">
    <link rel="preload" href="/assets/style-DFXXOFfS.css" as="style"><link rel="stylesheet" href="/assets/style-DFXXOFfS.css">
    <link rel="modulepreload" href="/assets/app-CIGQMwlz.js"><link rel="modulepreload" href="/assets/jvm-qa.html-LGWqIMsr.js">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">Skip to main content</a><!--]--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo" src="/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">VanHung4499</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="Home"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:home" width="1em" height="1em"></iconify-icon><!--]-->Home<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/wiki.html" aria-label="Wiki"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="carbon:wikis" width="1em" height="1em"></iconify-icon><!--]-->Wiki<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/dsa/" aria-label="Algorithms"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="hugeicons:algorithm" width="1em" height="1em"></iconify-icon><!--]-->Algorithms<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Programming"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:code" width="1em" height="1em"></iconify-icon>Programming<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/java/" aria-label="Java"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:java" width="1em" height="1em"></iconify-icon><!--]-->Java<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/golang/" aria-label="Golang"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:go" width="1em" height="1em"></iconify-icon><!--]-->Golang<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/js/" aria-label="JavaScript"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:javascript" width="1em" height="1em"></iconify-icon><!--]-->JavaScript<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/ts/" aria-label="TypeScript"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:typescript" width="1em" height="1em"></iconify-icon><!--]-->TypeScript<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/python/" aria-label="Python"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:python" width="1em" height="1em"></iconify-icon><!--]-->Python<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Database"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:database" width="1em" height="1em"></iconify-icon>Database<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/sql/" aria-label="SQL"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:sql-query" width="1em" height="1em"></iconify-icon><!--]-->SQL<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/mysql/" aria-label="MySQL"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:mysql" width="1em" height="1em"></iconify-icon><!--]-->MySQL<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/mongodb/" aria-label="MongoDB"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:mongodb" width="1em" height="1em"></iconify-icon><!--]-->MongoDB<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/redis/" aria-label="Redis"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/elasticsearch/" aria-label="Elasticsearch"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:elasticsearch" width="1em" height="1em"></iconify-icon><!--]-->Elasticsearch<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/elastic/" aria-label="Elastic Stack"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="cib:elastic-stack" width="1em" height="1em"></iconify-icon><!--]-->Elastic Stack<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Framework"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="simple-icons:framework" width="1em" height="1em"></iconify-icon>Framework<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/spring/" aria-label="Spring"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->Spring<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/spring-boot/" aria-label="Spring Boot"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->Spring Boot<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/nestjs/" aria-label="NestJS"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:nestjs" width="1em" height="1em"></iconify-icon><!--]-->NestJS<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/gin/" aria-label="Gin"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="logos:gin" width="1em" height="1em"></iconify-icon><!--]-->Gin<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="DevOps"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon-plain:azuredevops" width="1em" height="1em"></iconify-icon>DevOps<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/docker/" aria-label="Docker"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:docker" width="1em" height="1em"></iconify-icon><!--]-->Docker<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/kubernetes/" aria-label="Kubernetes"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:kubernetes" width="1em" height="1em"></iconify-icon><!--]-->Kubernetes<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/jenkins/" aria-label="Jenkins"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:jenkins" width="1em" height="1em"></iconify-icon><!--]-->Jenkins<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/git/" aria-label="Git"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:git" width="1em" height="1em"></iconify-icon><!--]-->Git<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/linux/" aria-label="Linux"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:linux" width="1em" height="1em"></iconify-icon><!--]-->Linux<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Design"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="tdesign:system-sum" width="1em" height="1em"></iconify-icon>Design<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/design/design-pattern/" aria-label="Design Pattern"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="tabler:grid-pattern" width="1em" height="1em"></iconify-icon><!--]-->Design Pattern<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/design/system-design/" aria-label="System Design"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="icon-park-outline:system" width="1em" height="1em"></iconify-icon><!--]-->System Design<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Project"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="ant-design:project-outlined" width="1em" height="1em"></iconify-icon>Project<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/project/rouyi-vue-pro/" aria-label="Rouyi Vue Pro"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->Rouyi Vue Pro<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/project/yudao-cloud/" aria-label="Yudao Cloud"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->Yudao Cloud<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="route-link route-link-active auto-link" href="/interview/" aria-label="Interview"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:account-tie" width="1em" height="1em"></iconify-icon><!--]-->Interview<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="About"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:about" width="1em" height="1em"></iconify-icon>About<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/about-me.html" aria-label="About me"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="cib:about-me" width="1em" height="1em"></iconify-icon><!--]-->About me<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/about.html" aria-label="About"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:about" width="1em" height="1em"></iconify-icon><!--]-->About<!----></a></li></ul></button></div></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/vanhung4499/my-wiki" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><!--[--><button type="button" class="search-pro-button" aria-label="Search"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon" name="search"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">Search</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><a class="route-link route-link-active auto-link vp-sidebar-title no-external-link-icon" href="/interview/knowledge/" aria-label="Knowledge"><!---->Knowledge<!----></a><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Combine</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">Java</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/interview/knowledge/java/jvm-qa.html" aria-label="JVM Questions"><!---->JVM Questions<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/interview/knowledge/java/java-must-know.html" aria-label="Java Basic Must Know"><!---->Java Basic Must Know<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/interview/knowledge/java/java-thread-must-know.html" aria-label="Java Thread Must Know"><!---->Java Thread Must Know<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">My</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Mysql</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Redis</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Prepare</span><span class="vp-arrow end"></span></button><!----></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->JVM Questions</h1><div class="page-info"><span class="page-author-info" aria-label="AuthorğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://vanhung4499.github.io" target="_blank" rel="noopener noreferrer">Hung Nguyen</a></span><span property="author" content="Hung Nguyen"></span></span><!----><span class="page-date-info" aria-label="Writing DateğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-10-02T17:20:50.000Z"></span><!----><span class="page-reading-time-info" aria-label="Reading TimeâŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 54 min</span><meta property="timeRequired" content="PT54M"></span><span class="page-category-info" aria-label="CategoryğŸŒˆ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color4 clickable" role="navigation">interview</span><!--]--><meta property="articleSection" content="interview"></span><span class="page-tag-info" aria-label="TagğŸ·" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color8 clickable" role="navigation">java</span><span class="page-tag-item color4 clickable" role="navigation">interview</span><span class="page-tag-item color5 clickable" role="navigation">jvm</span><!--]--><meta property="keywords" content="java,interview,jvm"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">On This Page<button type="button" class="print-button" title="Print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ban-co-the-giai-thich-jvm-la-gi-khong-no-hoat-Ä‘ong-nhu-the-nao">Báº¡n cÃ³ thá»ƒ giáº£i thÃ­ch JVM lÃ  gÃ¬ khÃ´ng? NÃ³ hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ban-co-the-noi-ve-cac-thanh-phan-chinh-cua-jvm-khong">Báº¡n cÃ³ thá»ƒ nÃ³i vá» cÃ¡c thÃ nh pháº§n chÃ­nh cá»§a JVM khÃ´ng?</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#trinh-tai-lop-classloader">TrÃ¬nh táº£i lá»›p (ClassLoader)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#runtime-data-area">Runtime Data Area</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#execution-engine">Execution Engine</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ban-co-the-giai-thich-ve-vai-tro-cua-trinh-nap-lop-classloader-trong-jvm-khong">Báº¡n cÃ³ thá»ƒ giáº£i thÃ­ch vá» vai trÃ² cá»§a trÃ¬nh náº¡p lá»›p (ClassLoader) trong JVM khÃ´ng?</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#nap">Náº¡p</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#xac-minh">XÃ¡c minh</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#chuan-bi">Chuáº©n bá»‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#phan-tich">PhÃ¢n tÃ­ch</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#khoi-tao">Khá»Ÿi táº¡o</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#su-dung">Sá»­ dá»¥ng</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#do-bo">Dá»¡ bá»</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ban-co-biet-cac-bo-tai-lop-cua-jvm-la-gi-khong-co-che-uy-quyen-cua-cha-me-la-gi">Báº¡n cÃ³ biáº¿t cÃ¡c bá»™ táº£i lá»›p cá»§a JVM lÃ  gÃ¬ khÃ´ng? CÆ¡ cháº¿ á»§y quyá»n cá»§a cha máº¹ lÃ  gÃ¬?</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#lop-va-bo-tai-lop">Lá»›p vÃ  bá»™ táº£i lá»›p</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mo-hinh-uy-quyen-cua-cha-me">MÃ´ hÃ¬nh á»§y quyá»n cá»§a cha máº¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#bo-tai-lop-tu-Ä‘inh-nghia">Bá»™ táº£i lá»›p tá»± Ä‘á»‹nh nghÄ©a</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ban-hieu-gi-ve-jvm-memory-model">Báº¡n hiá»ƒu gÃ¬ vá» JVM Memory Model?</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#phan-bo-nho-chia-se-java-heap-method-area-va-constant-pool">Pháº§n bá»™ nhá»› chia sáº»: Java Heap, Method Area, vÃ  Constant Pool</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#phan-bo-nho-rieng-pc-register-jvm-stack-va-native-method-stack">Pháº§n bá»™ nhá»› riÃªng: PC Register, JVM Stack, vÃ  Native Method Stack</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#noi-ve-nhung-thuat-toan-thu-gom-rac-cua-jvm-ma-ban-biet">NÃ³i vá» nhá»¯ng thuáº­t toÃ¡n thu gom rÃ¡c cá»§a JVM mÃ  báº¡n biáº¿t?</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#the-nao-Ä‘uoc-xem-la-rac">Tháº¿ nÃ o Ä‘Æ°á»£c xem lÃ  rÃ¡c?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#lam-the-nao-Ä‘e-thu-gom-rac">LÃ m tháº¿ nÃ o Ä‘á»ƒ thu gom rÃ¡c?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#tu-tuong-phan-the-he">TÆ° tÆ°á»Ÿng phÃ¢n tháº¿ há»‡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#tu-tuong-phan-vung">TÆ° tÆ°á»Ÿng phÃ¢n vÃ¹ng</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ban-co-biet-co-nhung-bo-thu-gom-rac-nao-trong-jvm-khong">Báº¡n cÃ³ biáº¿t cÃ³ nhá»¯ng bá»™ thu gom rÃ¡c nÃ o trong JVM khÃ´ng?</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#bo-thu-gom-rac-tuan-tu">Bá»™ thu gom rÃ¡c tuáº§n tá»±</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#bo-thu-gom-rac-song-song">Bá»™ thu gom rÃ¡c song song</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#bo-thu-gom-rac-cms">Bá»™ Thu Gom RÃ¡c CMS</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#bo-thu-gom-rac-g1">Bá»™ Thu Gom RÃ¡c G1</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mot-so-loai-thu-gom-rac">Má»™t Sá»‘ Loáº¡i Thu Gom RÃ¡c</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ban-Ä‘a-tung-toi-uu-hoa-jvm-chua-hay-chia-se-y-tuong-toi-uu-cua-ban">Báº¡n Ä‘Ã£ tá»«ng tá»‘i Æ°u hÃ³a JVM chÆ°a, hÃ£y chia sáº» Ã½ tÆ°á»Ÿng tá»‘i Æ°u cá»§a báº¡n?</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#cac-buoc-toi-uu-hoa-jvm-chung-la">CÃ¡c bÆ°á»›c tá»‘i Æ°u hÃ³a JVM chung lÃ :</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#phan-tich-nhat-ky-gc-va-cac-tep-dump-xac-Ä‘inh-xem-co-can-toi-uu-hoa-hay-khong-xac-Ä‘inh-Ä‘iem-nghen-van-Ä‘e">PhÃ¢n tÃ­ch nháº­t kÃ½ GC vÃ  cÃ¡c tá»‡p dump, xÃ¡c Ä‘á»‹nh xem cÃ³ cáº§n tá»‘i Æ°u hÃ³a hay khÃ´ng, xÃ¡c Ä‘á»‹nh Ä‘iá»ƒm ngháº½n váº¥n Ä‘á»</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h1 id="phong-van-jvm-cap-toc" tabindex="-1"><a class="header-anchor" href="#phong-van-jvm-cap-toc"><span>Phá»ng váº¥n JVM cáº¥p tá»‘c</span></a></h1><h2 id="ban-co-the-giai-thich-jvm-la-gi-khong-no-hoat-Ä‘ong-nhu-the-nao" tabindex="-1"><a class="header-anchor" href="#ban-co-the-giai-thich-jvm-la-gi-khong-no-hoat-Ä‘ong-nhu-the-nao"><span>Báº¡n cÃ³ thá»ƒ giáº£i thÃ­ch JVM lÃ  gÃ¬ khÃ´ng? NÃ³ hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o?</span></a></h2><p>ChÃºng ta Ä‘á»u biáº¿t ráº±ng trong há»‡ thá»‘ng Windows, má»™t gÃ³i cÃ i Ä‘áº·t pháº§n má»m lÃ  tá»‡p exe, Ä‘Ãºng khÃ´ng? NhÆ°ng trong MacOS, tá»‡p exe khÃ´ng thá»ƒ cÃ i Ä‘áº·t Ä‘Æ°á»£c, chá»‰ cÃ³ thá»ƒ cÃ i Ä‘áº·t cÃ¡c gÃ³i cÃ³ Ä‘uÃ´i dmg. TÆ°Æ¡ng tá»± nhÆ° váº­y, gÃ³i cÃ i Ä‘áº·t trong há»‡ thá»‘ng Mac khÃ´ng thá»ƒ cÃ i Ä‘áº·t trÃªn Windows.</p><p>Váº­y táº¡i sao pháº§n má»m khÃ´ng thá»ƒ sá»­ dá»¥ng chung giá»¯a cÃ¡c há»‡ Ä‘iá»u hÃ nh khÃ¡c nhau? Äiá»u nÃ y lÃ  do cÃ¡ch triá»ƒn khai cÆ¡ báº£n cá»§a há»‡ Ä‘iá»u hÃ nh lÃ  khÃ¡c nhau, vÃ  machine code Ä‘Æ°á»£c táº¡o ra khÃ´ng thá»ƒ sá»­ dá»¥ng chung. Tuy nhiÃªn, nhá»¯ng ai Ä‘Ã£ há»c Java Ä‘á»u biáº¿t ráº±ng sau khi Ä‘Ã³ng gÃ³i thÃ nh tá»‡p Jar, khÃ´ng quan trá»ng lÃ  á»Ÿ Windows, MacOS hay Linux, Java váº«n cÃ³ thá»ƒ cháº¡y Ä‘Æ°á»£c, Ä‘Ãºng khÃ´ng?</p><p>Váº­y Java lÃ m cÃ¡ch nÃ o Ä‘á»ƒ thá»±c hiá»‡n Ä‘iá»u nÃ y? &quot;Anh hÃ¹ng&quot; Ä‘á»©ng sau Ä‘Ã³ chÃ­nh lÃ  JVM cá»§a chÃºng ta. KhÃ¡c vá»›i cÃ¡c ngÃ´n ngá»¯ khÃ¡c, mÃ£ Java sau khi biÃªn dá»‹ch khÃ´ng pháº£i lÃ  machine code trá»±c tiáº¿p, mÃ  lÃ  bytecode chá»‰ JVM má»›i cÃ³ thá»ƒ nháº­n diá»‡n. KhÃ´ng quan trá»ng Java cháº¡y trÃªn mÃ´i trÆ°á»ng nÃ o, chá»‰ cáº§n JVM cÃ³ thá»ƒ cÃ i Ä‘áº·t, chÆ°Æ¡ng trÃ¬nh Java cÃ³ thá»ƒ cháº¡y trá»±c tiáº¿p.</p><p>JVM Ä‘Ã³ng vai trÃ² nhÆ° má»™t trÃ¬nh thÃ´ng dá»‹ch, biÃªn dá»‹ch Ä‘á»™ng mÃ£ Java thÃ nh machine code mÃ  há»‡ Ä‘iá»u hÃ nh cÃ³ thá»ƒ nháº­n diá»‡n. Äiá»u nÃ y giÃºp Java thá»±c hiá»‡n Ä‘Æ°á»£c táº§m nhÃ¬n &quot;Write Once, Run Anywhere&quot; (Viáº¿t má»™t láº§n, cháº¡y á»Ÿ má»i nÆ¡i).</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240926130739.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>Viáº¿t má»™t láº§n, cháº¡y á»Ÿ má»i nÆ¡i (&quot;Write Once, Run Anywhere&quot;)</p><p>Nhiá»u báº¡n cÃ³ thá»ƒ tháº¯c máº¯c, cÅ©ng giá»‘ng nhÆ° ngÃ´n ngá»¯ C trÆ°á»›c Ä‘Ã¢y hay ngÃ´n ngá»¯ Go hiá»‡n nay, viá»‡c Ä‘Ã³ng gÃ³i pháº§n má»m cho cÃ¡c ná»n táº£ng khÃ¡c nhau khÃ´ng pháº£i lÃ  má»™t viá»‡c quÃ¡ khÃ³ khÄƒn. KhÃ´ng láº½ chá»‰ vÃ¬ tÃ­nh nÄƒng nÃ y mÃ  chÃºng ta pháº£i chuyá»ƒn sang dÃ¹ng Java? Thá»±c ra cÃ¢u nÃ³i nÃ y chá»‰ lÃ  má»™t kháº©u hiá»‡u, cho Ä‘áº¿n bÃ¢y giá», khi cháº¡y Java trÃªn cÃ¡c ná»n táº£ng khÃ¡c nhau váº«n gáº·p má»™t sá»‘ váº¥n Ä‘á». Java ná»•i lÃªn thá»±c sá»± nhá» nhiá»u yáº¿u tá»‘ khÃ¡c nhau, nhÆ° cÃº phÃ¡p Ä‘Æ¡n giáº£n dá»… há»c, há»‡ sinh thÃ¡i má»Ÿ, kháº£ nÄƒng má»Ÿ rá»™ng cá»§a ngÃ´n ngá»¯, tÃ­nh á»•n Ä‘á»‹nh vÃ  má»™t pháº§n lÃ  do may máº¯n. Viá»‡c cháº¡y trÃªn nhiá»u ná»n táº£ng chá»‰ lÃ  má»™t pháº§n nhá» trong nhá»¯ng yáº¿u tá»‘ Ä‘Ã³.</p><p>Nhiá»u ngÆ°á»i má»›i báº¯t Ä‘áº§u há»c Java cÅ©ng cÃ³ má»™t hiá»ƒu láº§m ráº±ng chá»‰ cÃ³ ngÃ´n ngá»¯ Java má»›i cÃ³ thá»ƒ cháº¡y trÃªn JVM. NhÆ°ng thá»±c táº¿ lÃ  JVM cháº¡y bytecode, khÃ´ng phá»¥ thuá»™c vÃ o ngÃ´n ngá»¯ cá»¥ thá»ƒ. NÃ³i cÃ¡ch khÃ¡c, náº¿u báº¡n viáº¿t mÃ£ JavaScript vÃ  biÃªn dá»‹ch thÃ nh bytecode, JVM váº«n cÃ³ thá»ƒ cháº¡y Ä‘Æ°á»£c. Thá»±c táº¿ hiá»‡n nay JVM Ä‘Ã£ cÃ³ thá»ƒ cháº¡y mÃ£ JavaScript. Máº·c dÃ¹ tÃªn gá»i lÃ  Java Virtual Machine, nhÆ°ng nÃ³ khÃ´ng cÃ³ sá»± rÃ ng buá»™c Ä‘áº·c biá»‡t vá»›i ngÃ´n ngá»¯ Java, mÃ  chá»‰ Ä‘Æ¡n giáº£n lÃ  Ä‘á»c vÃ  thá»±c thi cÃ¡c tá»‡p Class theo Ä‘Ãºng tiÃªu chuáº©n JVM.</p><p>Náº¿u báº¡n hiá»ƒu sÃ¢u vá» JVM, báº¡n hoÃ n toÃ n cÃ³ thá»ƒ tá»± viáº¿t má»™t ngÃ´n ngá»¯ riÃªng, miá»…n lÃ  ngÃ´n ngá»¯ Ä‘Ã³ cÃ³ thá»ƒ biÃªn dá»‹ch thÃ nh bytecode chuáº©n thÃ¬ nÃ³ cÃ³ thá»ƒ cháº¡y trÃªn JVM. CÃ³ ráº¥t nhiá»u ngÃ´n ngá»¯ Ä‘Ã£ lÃ m Ä‘iá»u nÃ y, nhÆ° Scala, Kotlin, Ä‘á»u theo cÃ¹ng má»™t hÆ°á»›ng Ä‘i.</p><p>ChÃºng ta sáº½ dá»«ng láº¡i pháº§n giá»›i thiá»‡u vá» JVM táº¡i Ä‘Ã¢y. Táº­p tiáº¿p theo, tÃ´i sáº½ dáº«n cÃ¡c báº¡n khÃ¡m phÃ¡ sÃ¢u hÆ¡n vá» tháº¿ giá»›i cá»§a JVM!</p><h2 id="ban-co-the-noi-ve-cac-thanh-phan-chinh-cua-jvm-khong" tabindex="-1"><a class="header-anchor" href="#ban-co-the-noi-ve-cac-thanh-phan-chinh-cua-jvm-khong"><span>Báº¡n cÃ³ thá»ƒ nÃ³i vá» cÃ¡c thÃ nh pháº§n chÃ­nh cá»§a JVM khÃ´ng?</span></a></h2><p>Sá»± khÃ¡c biá»‡t giá»¯a JDK vÃ  JRE lÃ  Ä‘iá»u mÃ  báº¥t ká»³ láº­p trÃ¬nh viÃªn Java nÃ o cÅ©ng biáº¿t. NhÆ°ng nhiá»u ngÆ°á»i khÃ´ng biáº¿t ráº±ng JRE chÃ­nh lÃ  triá»ƒn khai cá»§a Java Virtual Machine (JVM). NÃ³ cÃ³ thá»ƒ phÃ¢n tÃ­ch bytecode, thÃ´ng dá»‹ch mÃ£ vÃ  sau Ä‘Ã³ thá»±c thi nÃ³. Vá»›i tÆ° cÃ¡ch lÃ  láº­p trÃ¬nh viÃªn, viá»‡c hiá»ƒu vá» cáº¥u trÃºc cá»§a JVM lÃ  ráº¥t quan trá»ng. NÃ³ giÃºp chÃºng ta viáº¿t mÃ£ tá»‘i Æ°u hÆ¡n vÃ  phÃ¢n tÃ­ch cÃ¡c váº¥n Ä‘á» vá» hiá»‡u suáº¥t. Tiáº¿p theo, chÃºng ta sáº½ tÃ¬m hiá»ƒu vá» cáº¥u trÃºc vÃ  cÃ¡c thÃ nh pháº§n cá»§a JVM.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240926130750.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>NhÃ¬n vÃ o biá»ƒu Ä‘á»“ trÃªn, máº·c dÃ¹ cÃ³ ráº¥t nhiá»u thÃ nh pháº§n trÃ´ng khÃ¡ phá»©c táº¡p, nhÆ°ng trÆ°á»›c háº¿t chÃºng ta sáº½ khÃ´ng Ä‘i sÃ¢u vÃ o chi tiáº¿t mÃ  chá»‰ táº­p trung vÃ o ba pháº§n chÃ­nh bÃªn ngoÃ i:</p><ul><li>ClassLoader SubSystem</li><li>Runtime Data Area</li><li>Execution Engine</li></ul><h3 id="trinh-tai-lop-classloader" tabindex="-1"><a class="header-anchor" href="#trinh-tai-lop-classloader"><span>TrÃ¬nh táº£i lá»›p (ClassLoader)</span></a></h3><p>Sau khi Java Virtual Machine biÃªn dá»‹ch mÃ£ nguá»“n Java thÃ nh bytecode, nÃ³ cÃ³ thá»ƒ Ä‘á»c bytecode nÃ y vÃ o bá»™ nhá»› Ä‘á»ƒ phÃ¢n tÃ­ch cÃº phÃ¡p vÃ  thá»±c thi. QuÃ¡ trÃ¬nh nÃ y Ä‘Æ°á»£c gá»i lÃ  &quot;cÆ¡ cháº¿ táº£i lá»›p&quot; (classloader) cá»§a Java Virtual Machine. Viá»‡c thá»±c thi bytecode cá»§a JVM cÃ³ thá»ƒ Ä‘Æ°á»£c chia thÃ nh báº£y giai Ä‘oáº¡n: <strong>Táº£i (Loading), xÃ¡c minh (Verify), chuáº©n bá»‹ (Prepare), phÃ¢n tÃ­ch (Resolve), khá»Ÿi táº¡o (Initialization), sá»­ dá»¥ng (Use) vÃ  há»§y (Unload)</strong>.</p><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/8380143/1676273586231-499379c4-3560-4068-85e7-d493e2348a55.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="runtime-data-area" tabindex="-1"><a class="header-anchor" href="#runtime-data-area"><span>Runtime Data Area</span></a></h3><p><strong>Runtime Data Area</strong> cÃ²n Ä‘Æ°á»£c gá»i lÃ  &quot;JVM Memory Model (JMM - Java Memory Model)&quot;. NÃ³ chá»‰ ra ráº±ng JVM chia bá»™ nhá»› mÃ  nÃ³ quáº£n lÃ½ thÃ nh cÃ¡c vÃ¹ng dá»¯ liá»‡u khÃ¡c nhau khi chÆ°Æ¡ng trÃ¬nh Ä‘ang cháº¡y. CÃ³ nÄƒm pháº§n chÃ­nh: <strong>Method Area, Heap, JVM Stack, Program Counter, vÃ  Native Method Stack.</strong></p><p><strong>JVM Stack</strong> vÃ  <strong>Program Counter</strong> lÃ  cÃ¡c khu vá»±c riÃªng cá»§a tá»«ng luá»“ng, trong khi <strong>Heap</strong> vÃ  <strong>Method Area</strong> lÃ  cÃ¡c khu vá»±c Ä‘Æ°á»£c chia sáº» giá»¯a cÃ¡c luá»“ng.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240926130801.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><h3 id="execution-engine" tabindex="-1"><a class="header-anchor" href="#execution-engine"><span>Execution Engine</span></a></h3><p>MÃ£ cuá»‘i cÃ¹ng cáº§n Ä‘Æ°á»£c cháº¡y, vÃ  cÃ´ng viá»‡c nÃ y Ä‘Æ°á»£c thá»±c hiá»‡n bá»Ÿi Execution Engine. NÃ³ sáº½ Ä‘á»c bytecode vÃ  tá»«ng Ä‘oáº¡n bytecode sáº½ Ä‘Æ°á»£c thá»±c thi bá»Ÿi Execution Engine.</p><p>Java lÃ  má»™t ngÃ´n ngá»¯ vá»«a thÃ´ng dá»‹ch vá»«a biÃªn dá»‹ch, vÃ¬ váº­y Execution Engine Ä‘Æ°á»£c chia thÃ nh <strong>trÃ¬nh thÃ´ng dá»‹ch (Interpreter)</strong> vÃ  <strong>trÃ¬nh biÃªn dá»‹ch JIT (Just-In-Time Compiler)</strong>. TrÃ¬nh thÃ´ng dá»‹ch sáº½ dá»‹ch tá»«ng dÃ²ng bytecode thÃ nh machine code Ä‘á»ƒ thá»±c thi, trong khi JIT sáº½ biÃªn dá»‹ch trá»±c tiáº¿p mÃ£ nguá»“n thÃ nh machine code.</p><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/8380143/1676275530469-eb977793-c45f-4b96-abf3-89f640b40978.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="ban-co-the-giai-thich-ve-vai-tro-cua-trinh-nap-lop-classloader-trong-jvm-khong" tabindex="-1"><a class="header-anchor" href="#ban-co-the-giai-thich-ve-vai-tro-cua-trinh-nap-lop-classloader-trong-jvm-khong"><span>Báº¡n cÃ³ thá»ƒ giáº£i thÃ­ch vá» vai trÃ² cá»§a trÃ¬nh náº¡p lá»›p (ClassLoader) trong JVM khÃ´ng?</span></a></h2><p>TrÆ°á»›c Ä‘Ã¢y, chÃºng ta Ä‘Ã£ nÃ³i qua vá» trÃ¬nh náº¡p lá»›p. NÃ³ lÃ  má»™t thÃ nh pháº§n Ä‘á»c bytecode vÃ  chuyá»ƒn Ä‘á»•i thÃ nh má»™t Ä‘á»‘i tÆ°á»£ng cá»§a lá»›p <code>java.lang.Class</code>. ThÃ´ng qua phÆ°Æ¡ng thá»©c <code>newInstance()</code> cÃ³ thá»ƒ táº¡o ra má»™t thá»ƒ hiá»‡n cá»§a lá»›p. NÃ³i thÃ¬ cÃ³ váº» Ä‘Æ¡n giáº£n, nhÆ°ng thá»±c táº¿ cÃ³ thá»ƒ phá»©c táº¡p hÆ¡n nhiá»u, cháº³ng háº¡n nhÆ° bytecode cá»§a Java cÃ³ thá»ƒ Ä‘Æ°á»£c táº¡o Ä‘á»™ng thÃ´ng qua cÃ¡c cÃ´ng cá»¥, hoáº·c Ä‘Æ°á»£c táº£i xuá»‘ng qua máº¡ng. Trong pháº§n nÃ y, chÃºng ta sáº½ tháº£o luáº­n chi tiáº¿t vá» trÃ¬nh náº¡p lá»›p ~</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240926130828.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p><strong>Trong ngÃ´n ngá»¯ Java, viá»‡c náº¡p, liÃªn káº¿t vÃ  khá»Ÿi táº¡o cÃ¡c loáº¡i (type) Ä‘á»u Ä‘Æ°á»£c thá»±c hiá»‡n trong Runtime</strong>. Chiáº¿n lÆ°á»£c nÃ y tuy cÃ³ thá»ƒ lÃ m tÄƒng nháº¹ chi phÃ­ hiá»‡u suáº¥t khi náº¡p lá»›p, nhÆ°ng mang láº¡i cho á»©ng dá»¥ng Java tÃ­nh linh hoáº¡t cao. Äáº·c tÃ­nh má»Ÿ rá»™ng Ä‘á»™ng cá»§a Java dá»±a trÃªn viá»‡c náº¡p Ä‘á»™ng (dynamic loading) vÃ  liÃªn káº¿t Ä‘á»™ng (dynamic linking) trong Runtime.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240926130835.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>HÃ¬nh trÃªn lÃ  vÃ²ng Ä‘á»i cá»§a má»™t lá»›p. Tá»« hÃ¬nh cÃ³ thá»ƒ tháº¥y, vÃ²ng Ä‘á»i cá»§a má»™t lá»›p tá»« khi Ä‘Æ°á»£c náº¡p vÃ o bá»™ nhá»› cá»§a mÃ¡y áº£o Ä‘áº¿n khi Ä‘Æ°á»£c dá»¡ bá», bao gá»“m 7 giai Ä‘oáº¡n: <strong>Náº¡p (Loading), XÃ¡c minh (Verification), Chuáº©n bá»‹ (Preparation), phÃ¢n tÃ­ch (Resolution), Khá»Ÿi táº¡o (Initialization), Sá»­ dá»¥ng (Using), Dá»¡ bá» (Unloading)</strong>. Trong Ä‘Ã³, ba pháº§n xÃ¡c minh, chuáº©n bá»‹ vÃ  phÃ¢n tÃ­ch Ä‘Æ°á»£c gá»i chung lÃ  liÃªn káº¿t. NÄƒm giai Ä‘oáº¡n náº¡p, xÃ¡c minh, chuáº©n bá»‹, khá»Ÿi táº¡o vÃ  dá»¡ bá» cÃ³ thá»© tá»± xÃ¡c Ä‘á»‹nh vÃ  pháº£i tuÃ¢n theo tuáº§n tá»±. Giai Ä‘oáº¡n phÃ¢n tÃ­ch cÃ³ thá»ƒ diá»…n ra sau giai Ä‘oáº¡n khá»Ÿi táº¡o Ä‘á»ƒ há»— trá»£ Ä‘áº·c tÃ­nh liÃªn káº¿t muá»™n cá»§a Java (dynamic binding hoáº·c late binding).</p><h3 id="nap" tabindex="-1"><a class="header-anchor" href="#nap"><span>Náº¡p</span></a></h3><p>Giai Ä‘oáº¡n â€œNáº¡pâ€ (Loading) lÃ  má»™t pháº§n cá»§a quÃ¡ trÃ¬nh â€œNáº¡p lá»›pâ€ (Class Loading). Trong giai Ä‘oáº¡n nÃ y, JVM cáº§n thá»±c hiá»‡n ba viá»‡c sau:</p><ul><li>Nháº­n bytecode cá»§a lá»›p tá»« tÃªn Ä‘áº§y Ä‘á»§ cá»§a nÃ³.</li><li>Chuyá»ƒn Ä‘á»•i cáº¥u trÃºc lÆ°u trá»¯ bytecode thÃ nh cáº¥u trÃºc dá»¯ liá»‡u táº¡i Runtime trong Method Area.</li><li>Táº¡o ra má»™t Ä‘á»‘i tÆ°á»£ng <code>java.lang.Class</code> trong bá»™ nhá»›, Ä‘áº¡i diá»‡n cho lá»›p vÃ  lÃ m cá»•ng truy cáº­p cÃ¡c dá»¯ liá»‡u cá»§a lá»›p trong Method Area.</li></ul><p>TiÃªu chuáº©n cá»§a <strong>Java Virtual Machine Specification</strong> khÃ´ng quy Ä‘á»‹nh quÃ¡ chi tiáº¿t vá» ba yÃªu cáº§u nÃ y, Ä‘á»ƒ láº¡i sá»± linh hoáº¡t cho JVM vÃ  á»©ng dá»¥ng Java. VÃ­ dá»¥: â€œNháº­n bytecode tá»« tÃªn Ä‘áº§y Ä‘á»§ cá»§a lá»›pâ€ khÃ´ng chá»‰ ra ráº±ng bytecode pháº£i Ä‘áº¿n tá»« tá»‡p <code>Class</code>, hay tá»« Ä‘Ã¢u vÃ  cÃ¡ch láº¥y bytecode.</p><p>ChÃ­nh sá»± linh hoáº¡t nÃ y Ä‘Ã£ táº¡o Ä‘iá»u kiá»‡n cho cÃ¡c láº­p trÃ¬nh viÃªn sÃ¡ng táº¡o nhiá»u phÆ°Æ¡ng phÃ¡p náº¡p lá»›p khÃ¡c nhau, xÃ¢y dá»±ng ná»n táº£ng cho nhiá»u cÃ´ng nghá»‡ Java quan trá»ng, cháº³ng háº¡n nhÆ°:</p><ul><li>Láº¥y bytecode tá»« tá»‡p ZIP, Ä‘iá»u nÃ y ráº¥t phá»• biáº¿n vÃ  sau nÃ y trá»Ÿ thÃ nh cÆ¡ sá»Ÿ cho Ä‘á»‹nh dáº¡ng JAR, EAR, WAR.</li><li>Táº£i tá»« máº¡ng, á»©ng dá»¥ng phá»• biáº¿n nháº¥t lÃ  Web Applet.</li><li>Táº¡o bytecode Ä‘á»™ng, thÆ°á»ng tháº¥y trong ká»¹ thuáº­t proxy Ä‘á»™ng, nhÆ° trong <code>java.lang.reflect.Proxy</code>, nÆ¡i sá»­ dá»¥ng <code>ProxyGenerator.generateProxyClass()</code> Ä‘á»ƒ táº¡o lá»›p proxy.</li><li>Láº¥y tá»« tá»‡p mÃ£ hÃ³a, Ä‘Ã¢y lÃ  má»™t biá»‡n phÃ¡p báº£o vá»‡ chá»‘ng láº¡i viá»‡c bá»‹ giáº£i mÃ£ tá»‡p Class.</li></ul><p>So vá»›i cÃ¡c giai Ä‘oáº¡n khÃ¡c cá»§a quÃ¡ trÃ¬nh náº¡p lá»›p, giai Ä‘oáº¡n náº¡p lÃ  giai Ä‘oáº¡n cÃ³ tÃ­nh linh hoáº¡t cao nháº¥t, Ä‘áº·c biá»‡t lÃ  trong viá»‡c láº¥y bytecode. Giai Ä‘oáº¡n náº¡p cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng trÃ¬nh náº¡p lá»›p tÃ­ch há»£p sáºµn hoáº·c báº±ng cÃ¡c trÃ¬nh náº¡p lá»›p tÃ¹y chá»‰nh. Láº­p trÃ¬nh viÃªn cÃ³ thá»ƒ kiá»ƒm soÃ¡t cÃ¡ch láº¥y bytecode báº±ng cÃ¡ch ghi Ä‘Ã¨ phÆ°Æ¡ng thá»©c <code>findClass()</code> hoáº·c <code>loadClass()</code>.</p><p>Khi hoÃ n táº¥t giai Ä‘oáº¡n náº¡p, bytecode bÃªn ngoÃ i sáº½ Ä‘Æ°á»£c lÆ°u trá»¯ theo Ä‘á»‹nh dáº¡ng mÃ  JVM yÃªu cáº§u trong Method Area, vÃ  má»™t Ä‘á»‘i tÆ°á»£ng <code>java.lang.Class</code> sáº½ Ä‘Æ°á»£c táº¡o trong bá»™ nhá»› heap Ä‘á»ƒ truy cáº­p dá»¯ liá»‡u nÃ y.</p><h3 id="xac-minh" tabindex="-1"><a class="header-anchor" href="#xac-minh"><span>XÃ¡c minh</span></a></h3><p>XÃ¡c minh lÃ  bÆ°á»›c Ä‘áº§u tiÃªn trong quÃ¡ trÃ¬nh liÃªn káº¿t. Má»¥c tiÃªu cá»§a giai Ä‘oáº¡n nÃ y lÃ  Ä‘áº£m báº£o ráº±ng bytecode cá»§a Class tuÃ¢n theo yÃªu cáº§u cá»§a JVM vÃ  khÃ´ng gÃ¢y nguy hiá»ƒm cho há»‡ thá»‘ng. Giai Ä‘oáº¡n xÃ¡c minh bao gá»“m bá»‘n bÆ°á»›c:</p><ul><li>XÃ¡c minh Ä‘á»‹nh dáº¡ng tá»‡p: Kiá»ƒm tra bytecode cÃ³ tuÃ¢n thá»§ tiÃªu chuáº©n Class file khÃ´ng, vÃ­ dá»¥ nhÆ° bytecode cÃ³ báº¯t Ä‘áº§u báº±ng 0xCAFEBABE khÃ´ng.</li><li>XÃ¡c minh siÃªu dá»¯ liá»‡u: PhÃ¢n tÃ­ch cÃº phÃ¡p bytecode Ä‘á»ƒ Ä‘áº£m báº£o thÃ´ng tin mÃ´ táº£ phÃ¹ há»£p vá»›i tiÃªu chuáº©n ngÃ´n ngá»¯ Java.</li><li>XÃ¡c minh bytecode: PhÃ¢n tÃ­ch dÃ²ng dá»¯ liá»‡u vÃ  dÃ²ng Ä‘iá»u khiá»ƒn Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh há»£p phÃ¡p cá»§a bytecode.</li><li>XÃ¡c minh tham chiáº¿u kÃ½ hiá»‡u: Äáº£m báº£o quÃ¡ trÃ¬nh phÃ¢n tÃ­ch cÃ¡c tham chiáº¿u cÃ³ thá»ƒ thá»±c thi thÃ nh cÃ´ng.</li></ul><p>Giai Ä‘oáº¡n xÃ¡c minh ráº¥t quan trá»ng nhÆ°ng khÃ´ng báº¯t buá»™c. Äá»ƒ rÃºt ngáº¯n thá»i gian náº¡p lá»›p, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng tham sá»‘ <code>-Xverifynone</code> Ä‘á»ƒ táº¯t háº§u háº¿t cÃ¡c bÆ°á»›c xÃ¡c minh.</p><h3 id="chuan-bi" tabindex="-1"><a class="header-anchor" href="#chuan-bi"><span>Chuáº©n bá»‹</span></a></h3><p>Giai Ä‘oáº¡n chuáº©n bá»‹ lÃ  nÆ¡i phÃ¢n bá»• bá»™ nhá»› cho cÃ¡c biáº¿n tÄ©nh vÃ  gÃ¡n giÃ¡ trá»‹ máº·c Ä‘á»‹nh cho chÃºng trong Method Area.</p><p>Má»™t sá»‘ Ä‘iá»ƒm cáº§n lÆ°u Ã½:</p><ol><li>Giai Ä‘oáº¡n nÃ y chá»‰ phÃ¢n bá»• bá»™ nhá»› cho cÃ¡c biáº¿n tÄ©nh (static), khÃ´ng bao gá»“m cÃ¡c biáº¿n thá»±c thá»ƒ (instance).</li><li>CÃ¡c biáº¿n tÄ©nh Ä‘Æ°á»£c gÃ¡n giÃ¡ trá»‹ máº·c Ä‘á»‹nh (0, null, false...) chá»© khÃ´ng pháº£i giÃ¡ trá»‹ Ä‘Æ°á»£c gÃ¡n trong mÃ£ Java.</li></ol><p>VÃ­ dá»¥: <code>public static int value = 3;</code></p><p>Sau giai Ä‘oáº¡n chuáº©n bá»‹, <code>value</code> sáº½ Ä‘Æ°á»£c gÃ¡n giÃ¡ trá»‹ máº·c Ä‘á»‹nh lÃ  0. Viá»‡c gÃ¡n <code>value</code> báº±ng 3 sáº½ diá»…n ra trong giai Ä‘oáº¡n khá»Ÿi táº¡o.</p><h3 id="phan-tich" tabindex="-1"><a class="header-anchor" href="#phan-tich"><span>PhÃ¢n tÃ­ch</span></a></h3><p>Giai Ä‘oáº¡n phÃ¢n tÃ­ch chuyá»ƒn Ä‘á»•i cÃ¡c tham chiáº¿u kÃ½ hiá»‡u thÃ nh tham chiáº¿u trá»±c tiáº¿p, nhÆ° Ä‘á»‹a chá»‰ bá»™ nhá»› thá»±c táº¿ hoáº·c con trá».</p><h3 id="khoi-tao" tabindex="-1"><a class="header-anchor" href="#khoi-tao"><span>Khá»Ÿi táº¡o</span></a></h3><p>Giai Ä‘oáº¡n khá»Ÿi táº¡o thá»±c hiá»‡n viá»‡c gÃ¡n giÃ¡ trá»‹ khá»Ÿi táº¡o cho cÃ¡c biáº¿n tÄ©nh vÃ  thá»±c thi cÃ¡c khá»‘i mÃ£ tÄ©nh.</p><p>JVM sáº½ khá»Ÿi táº¡o lá»›p theo cÃ¡c bÆ°á»›c sau:</p><ol><li>Náº¿u lá»›p chÆ°a Ä‘Æ°á»£c náº¡p vÃ  liÃªn káº¿t, nÃ³ sáº½ Ä‘Æ°á»£c thá»±c hiá»‡n.</li><li>Náº¿u lá»›p cha chÆ°a Ä‘Æ°á»£c khá»Ÿi táº¡o, nÃ³ sáº½ Ä‘Æ°á»£c khá»Ÿi táº¡o trÆ°á»›c.</li><li>Thá»±c thi cÃ¡c cÃ¢u lá»‡nh khá»Ÿi táº¡o trong lá»›p.</li></ol><h3 id="su-dung" tabindex="-1"><a class="header-anchor" href="#su-dung"><span>Sá»­ dá»¥ng</span></a></h3><p>Sau khi khá»Ÿi táº¡o xong, JVM sáº½ cháº¡y mÃ£ cá»§a chÆ°Æ¡ng trÃ¬nh.</p><h3 id="do-bo" tabindex="-1"><a class="header-anchor" href="#do-bo"><span>Dá»¡ bá»</span></a></h3><p>Khi chÆ°Æ¡ng trÃ¬nh káº¿t thÃºc, JVM báº¯t Ä‘áº§u huá»· Ä‘á»‘i tÆ°á»£ng Class Ä‘Ã£ khá»Ÿi táº¡o vÃ  cuá»‘i cÃ¹ng JVM xoÃ¡ lá»›p khá»i bá»™ nhá»›.</p><h2 id="ban-co-biet-cac-bo-tai-lop-cua-jvm-la-gi-khong-co-che-uy-quyen-cua-cha-me-la-gi" tabindex="-1"><a class="header-anchor" href="#ban-co-biet-cac-bo-tai-lop-cua-jvm-la-gi-khong-co-che-uy-quyen-cua-cha-me-la-gi"><span>Báº¡n cÃ³ biáº¿t cÃ¡c bá»™ táº£i lá»›p cá»§a JVM lÃ  gÃ¬ khÃ´ng? CÆ¡ cháº¿ á»§y quyá»n cá»§a cha máº¹ lÃ  gÃ¬?</span></a></h2><p>CÃ¡c nhÃ  thiáº¿t káº¿ JVM Ä‘Ã£ Ä‘Æ°a hÃ nh Ä‘á»™ng &quot;sá»­ dá»¥ng &#39;tÃªn Ä‘áº§y Ä‘á»§ cá»§a lá»›p&#39; Ä‘á»ƒ láº¥y luá»“ng byte nhá»‹ phÃ¢n Ä‘á»‹nh nghÄ©a lá»›p nÃ y&quot; vÃ o giai Ä‘oáº¡n táº£i lá»›p ra bÃªn ngoÃ i JVM (JVM), Ä‘á»ƒ cho phÃ©p á»©ng dá»¥ng tá»± quyáº¿t Ä‘á»‹nh cÃ¡ch láº¥y cÃ¡c lá»›p cáº§n thiáº¿t. MÃ´-Ä‘un mÃ£ thá»±c hiá»‡n hÃ nh Ä‘á»™ng nÃ y Ä‘Æ°á»£c gá»i lÃ  &quot;bá»™ táº£i lá»›p&quot;.</p><h3 id="lop-va-bo-tai-lop" tabindex="-1"><a class="header-anchor" href="#lop-va-bo-tai-lop"><span>Lá»›p vÃ  bá»™ táº£i lá»›p</span></a></h3><p>Äá»‘i vá»›i báº¥t ká»³ lá»›p nÃ o, tÃ­nh duy nháº¥t cá»§a lá»›p Ä‘Ã³ trong JVM pháº£i Ä‘Æ°á»£c xÃ¡c láº­p bá»Ÿi bá»™ táº£i lá»›p vÃ  chÃ­nh lá»›p Ä‘Ã³. NÃ³i cÃ¡ch khÃ¡c, hai lá»›p Ä‘áº¿n tá»« cÃ¹ng má»™t tá»‡p Class vÃ  Ä‘Æ°á»£c náº¡p bá»Ÿi cÃ¹ng má»™t bá»™ táº£i lá»›p thÃ¬ má»›i Ä‘Æ°á»£c coi lÃ  báº±ng nhau.</p><h3 id="mo-hinh-uy-quyen-cua-cha-me" tabindex="-1"><a class="header-anchor" href="#mo-hinh-uy-quyen-cua-cha-me"><span>MÃ´ hÃ¬nh á»§y quyá»n cá»§a cha máº¹</span></a></h3><p>Tá»« gÃ³c Ä‘á»™ cá»§a mÃ¡y áº£o, chá»‰ cÃ³ hai loáº¡i bá»™ táº£i lá»›p khÃ¡c nhau: Má»™t lÃ  bá»™ táº£i lá»›p khá»Ÿi Ä‘á»™ng (Bootstrap ClassLoader), bá»™ táº£i lá»›p nÃ y Ä‘Æ°á»£c triá»ƒn khai báº±ng ngÃ´n ngá»¯ C++ vÃ  lÃ  má»™t pháº§n cá»§a chÃ­nh mÃ¡y áº£o. CÃ²n láº¡i lÃ  táº¥t cáº£ cÃ¡c bá»™ táº£i lá»›p khÃ¡c, nhá»¯ng bá»™ táº£i nÃ y Ä‘Æ°á»£c triá»ƒn khai báº±ng ngÃ´n ngá»¯ Java, Ä‘á»™c láº­p vá»›i JVM vÃ  Ä‘á»u káº¿ thá»«a tá»« lá»›p trá»«u tÆ°á»£ng <code>java.lang.ClassLoader</code>.</p><p>Tá»« gÃ³c Ä‘á»™ cá»§a nhÃ  phÃ¡t triá»ƒn Java, háº§u háº¿t cÃ¡c chÆ°Æ¡ng trÃ¬nh Java thÆ°á»ng sá»­ dá»¥ng ba bá»™ táº£i lá»›p Ä‘Æ°á»£c cung cáº¥p bá»Ÿi há»‡ thá»‘ng:</p><ul><li><strong>Bá»™ táº£i lá»›p khá»Ÿi Ä‘á»™ng (Bootstrap ClassLoader):</strong> Chá»‹u trÃ¡ch nhiá»‡m táº£i cÃ¡c thÆ° viá»‡n trong thÆ° má»¥c <code>JAVA_HOME\lib</code> mÃ  cÃ³ thá»ƒ Ä‘Æ°á»£c JVM nháº­n diá»‡n vÃ o bá»™ nhá»› JVM. Náº¿u tÃªn thÆ° viá»‡n khÃ´ng khá»›p, ngay cáº£ khi nÃ³ náº±m trong thÆ° má»¥c <code>lib</code> thÃ¬ cÅ©ng sáº½ khÃ´ng Ä‘Æ°á»£c táº£i. Bá»™ táº£i lá»›p nÃ y khÃ´ng thá»ƒ Ä‘Æ°á»£c chÆ°Æ¡ng trÃ¬nh Java tham chiáº¿u trá»±c tiáº¿p.</li><li><strong>Bá»™ táº£i lá»›p má»Ÿ rá»™ng (Extension ClassLoader):</strong> Bá»™ táº£i nÃ y chá»§ yáº¿u chá»‹u trÃ¡ch nhiá»‡m táº£i thÆ° má»¥c <code>JAVA_HOME\lib\</code> vÃ  cÃ³ thá»ƒ Ä‘Æ°á»£c nhÃ  phÃ¡t triá»ƒn sá»­ dá»¥ng trá»±c tiáº¿p.</li><li><strong>Bá»™ táº£i lá»›p á»©ng dá»¥ng (Application ClassLoader):</strong> Bá»™ táº£i nÃ y cÃ²n Ä‘Æ°á»£c gá»i lÃ  bá»™ táº£i lá»›p há»‡ thá»‘ng, chá»‹u trÃ¡ch nhiá»‡m táº£i cÃ¡c thÆ° viá»‡n Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh trÃªn Ä‘Æ°á»ng dáº«n lá»›p cá»§a ngÆ°á»i dÃ¹ng (Classpath). NhÃ  phÃ¡t triá»ƒn cÃ³ thá»ƒ sá»­ dá»¥ng trá»±c tiáº¿p bá»™ táº£i lá»›p nÃ y. Náº¿u á»©ng dá»¥ng khÃ´ng tá»± Ä‘á»‹nh nghÄ©a bá»™ táº£i lá»›p riÃªng, thÃ´ng thÆ°á»ng Ä‘Ã¢y sáº½ lÃ  bá»™ táº£i lá»›p máº·c Ä‘á»‹nh cá»§a chÆ°Æ¡ng trÃ¬nh.</li></ul><p>CÃ¡c á»©ng dá»¥ng cá»§a chÃºng ta Ä‘á»u Ä‘Æ°á»£c táº£i bá»Ÿi sá»± káº¿t há»£p cá»§a ba bá»™ táº£i lá»›p nÃ y, vÃ  chÃºng ta cÅ©ng cÃ³ thá»ƒ thÃªm bá»™ táº£i lá»›p tá»± Ä‘á»‹nh nghÄ©a cá»§a mÃ¬nh. Má»‘i quan há»‡ giá»¯a cÃ¡c bá»™ táº£i lá»›p nÃ y Ä‘Æ°á»£c hiá»ƒn thá»‹ trong hÃ¬nh sau:</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240926130904.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>Quan há»‡ phÃ¢n cáº¥p giá»¯a cÃ¡c bá»™ táº£i lá»›p nhÆ° trÃªn Ä‘Æ°á»£c gá»i lÃ  mÃ´ hÃ¬nh á»§y quyá»n cá»§a cha máº¹ (Parent Delegation Model). MÃ´ hÃ¬nh nÃ y yÃªu cáº§u ngoÃ i bá»™ táº£i lá»›p khá»Ÿi Ä‘á»™ng á»Ÿ cáº¥p cao nháº¥t, táº¥t cáº£ cÃ¡c bá»™ táº£i lá»›p khÃ¡c Ä‘á»u pháº£i cÃ³ bá»™ táº£i lá»›p cha cá»§a riÃªng mÃ¬nh. Má»‘i quan há»‡ giá»¯a bá»™ táº£i lá»›p con vÃ  bá»™ táº£i lá»›p cha khÃ´ng Ä‘Æ°á»£c triá»ƒn khai báº±ng cÃ¡ch káº¿ thá»«a mÃ  thÃ´ng qua quan há»‡ tá»• há»£p Ä‘á»ƒ tÃ¡i sá»­ dá»¥ng mÃ£ cá»§a bá»™ táº£i lá»›p cha.</p><p>Quy trÃ¬nh lÃ m viá»‡c cá»§a mÃ´ hÃ¬nh á»§y quyá»n cha máº¹ lÃ : Náº¿u má»™t bá»™ táº£i lá»›p nháº­n Ä‘Æ°á»£c yÃªu cáº§u táº£i lá»›p, nÃ³ sáº½ khÃ´ng tá»± mÃ¬nh cá»‘ gáº¯ng táº£i lá»›p Ä‘Ã³ ngay, mÃ  sáº½ chuyá»ƒn yÃªu cáº§u nÃ y cho bá»™ táº£i lá»›p cha Ä‘á»ƒ thá»±c hiá»‡n. Má»—i cáº¥p bá»™ táº£i lá»›p Ä‘á»u nhÆ° váº­y, do Ä‘Ã³ táº¥t cáº£ cÃ¡c yÃªu cáº§u táº£i lá»›p Ä‘á»u sáº½ Ä‘Æ°á»£c chuyá»ƒn Ä‘áº¿n bá»™ táº£i lá»›p khá»Ÿi Ä‘á»™ng á»Ÿ cáº¥p cao nháº¥t. Chá»‰ khi bá»™ táº£i lá»›p cha pháº£n há»“i ráº±ng khÃ´ng thá»ƒ hoÃ n thÃ nh yÃªu cáº§u táº£i (khÃ´ng tÃ¬m tháº¥y lá»›p tÆ°Æ¡ng á»©ng trong pháº¡m vi tÃ¬m kiáº¿m cá»§a bá»™ táº£i lá»›p Ä‘Ã³), bá»™ táº£i lá»›p con má»›i cá»‘ gáº¯ng tá»± mÃ¬nh táº£i lá»›p.</p><p>Viá»‡c sá»­ dá»¥ng mÃ´ hÃ¬nh nÃ y Ä‘á»ƒ tá»• chá»©c má»‘i quan há»‡ giá»¯a cÃ¡c bá»™ táº£i lá»›p cÃ³ lá»£i Ã­ch lÃ  cÃ¡c lá»›p Java cÃ¹ng vá»›i bá»™ táº£i lá»›p cá»§a nÃ³ táº¡o thÃ nh má»™t há»‡ thá»‘ng phÃ¢n cáº¥p cÃ³ Æ°u tiÃªn. VÃ­ dá»¥, lá»›p <code>java.lang.Object</code>, dÃ¹ báº¥t ká»³ bá»™ táº£i lá»›p nÃ o cá»‘ gáº¯ng táº£i lá»›p nÃ y, cuá»‘i cÃ¹ng váº«n sáº½ do bá»™ táº£i lá»›p khá»Ÿi Ä‘á»™ng táº£i, do Ä‘Ã³ lá»›p <code>Object</code> trong mÃ´i trÆ°á»ng cá»§a cÃ¡c bá»™ táº£i lá»›p khÃ¡c nhau váº«n lÃ  cÃ¹ng má»™t lá»›p.</p><p>Náº¿u khÃ´ng sá»­ dá»¥ng mÃ´ hÃ¬nh nÃ y, náº¿u ngÆ°á»i dÃ¹ng tá»± Ä‘á»‹nh nghÄ©a má»™t lá»›p <code>java.lang.Object</code> vÃ  Ä‘áº·t nÃ³ trong <code>classpath</code>, thÃ¬ sáº½ xuáº¥t hiá»‡n nhiá»u lá»›p <code>Object</code> trong há»‡ thá»‘ng vÃ  á»©ng dá»¥ng sáº½ trá»Ÿ nÃªn há»—n loáº¡n. Náº¿u chÃºng ta tá»± Ä‘á»‹nh nghÄ©a má»™t lá»›p Java trÃ¹ng tÃªn vá»›i má»™t lá»›p Ä‘Ã£ cÃ³ trong tá»‡p <code>rt.jar</code>, ta sáº½ tháº¥y JVM cÃ³ thá»ƒ biÃªn dá»‹ch bÃ¬nh thÆ°á»ng, nhÆ°ng lá»›p Ä‘Ã³ sáº½ khÃ´ng bao giá» Ä‘Æ°á»£c táº£i vÃ  cháº¡y. Trong lá»›p <code>java.lang.ClassLoader</code> cá»§a gÃ³i <code>rt.jar</code>, chÃºng ta cÃ³ thá»ƒ xem mÃ£ nguá»“n cá»§a quy trÃ¬nh triá»ƒn khai táº£i lá»›p, cá»¥ thá»ƒ mÃ£ nhÆ° sau:</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">protected</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> synchronized</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> Class</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> loadClass</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> name</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> boolean</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> resolve)  </span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">        throws ClassNotFoundException {  </span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">    // Äáº§u tiÃªn kiá»ƒm tra xem lá»›p Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh bá»Ÿi name Ä‘Ã£ Ä‘Æ°á»£c táº£i chÆ°a  </span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">    Class</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> c </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> findLoadedClass</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(name)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (c </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) {  </span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        try</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> {  </span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            if</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (parent </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">!=</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) {  </span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">                // Náº¿u parent khÃ´ng null, gá»i parent.loadClass Ä‘á»ƒ táº£i lá»›p  </span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">                c </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> parent</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">loadClass</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(name, </span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">false</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">            } </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> {  </span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">                // Náº¿u parent null, gá»i BootstrapClassLoader Ä‘á»ƒ táº£i lá»›p  </span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">                c </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> findBootstrapClass0</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(name)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">            }  </span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">        } </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">ClassNotFoundException</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> e</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) {  </span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            // Náº¿u váº«n khÃ´ng táº£i Ä‘Æ°á»£c, gá»i findClass cá»§a chÃ­nh nÃ³ Ä‘á»ƒ táº£i  </span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">            c </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> findClass</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(name)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">        }  </span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">    }  </span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (resolve) {  </span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">        resolveClass</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(c)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">    }  </span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> c</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Qua Ä‘oáº¡n mÃ£ trÃªn, cÃ³ thá»ƒ tháº¥y mÃ´ hÃ¬nh á»§y quyá»n cha máº¹ Ä‘Æ°á»£c triá»ƒn khai thÃ´ng qua phÆ°Æ¡ng thá»©c <code>loadClass()</code>. Dá»±a trÃªn mÃ£ vÃ  chÃº thÃ­ch trong mÃ£, ta cÃ³ thá»ƒ dá»… dÃ ng hiá»ƒu quy trÃ¬nh nÃ y thá»±c ra ráº¥t Ä‘Æ¡n giáº£n:</p><p>Äáº§u tiÃªn kiá»ƒm tra xem lá»›p Ä‘Ã£ Ä‘Æ°á»£c táº£i chÆ°a, náº¿u chÆ°a thÃ¬ gá»i phÆ°Æ¡ng thá»©c <code>loadClass()</code> cá»§a bá»™ táº£i lá»›p cha, náº¿u bá»™ táº£i lá»›p cha lÃ  null thÃ¬ máº·c Ä‘á»‹nh sá»­ dá»¥ng bá»™ táº£i lá»›p khá»Ÿi Ä‘á»™ng lÃ m bá»™ táº£i cha.</p><p>Náº¿u bá»™ táº£i lá»›p cha tháº¥t báº¡i trong viá»‡c táº£i, thÃ¬ sáº½ nÃ©m ra ngoáº¡i lá»‡ <code>ClassNotFoundException</code>, sau Ä‘Ã³ má»›i gá»i phÆ°Æ¡ng thá»©c <code>findClass()</code> cá»§a chÃ­nh nÃ³ Ä‘á»ƒ táº£i.</p><p>MÃ´ hÃ¬nh á»§y quyá»n cha máº¹ cá»§a bá»™ táº£i lá»›p Ä‘Æ°á»£c giá»›i thiá»‡u tá»« JDK1.2 vÃ  chá»‰ lÃ  má»™t mÃ´ hÃ¬nh khuyáº¿n nghá»‹, khÃ´ng pháº£i yÃªu cáº§u báº¯t buá»™c, vÃ¬ váº­y cÃ³ má»™t sá»‘ ngoáº¡i lá»‡ khÃ´ng tuÃ¢n theo mÃ´ hÃ¬nh nÃ y: (tÃ¬m hiá»ƒu thÃªm)</p><ul><li>TrÆ°á»›c JDK1.2, cÃ¡c bá»™ táº£i lá»›p tá»± Ä‘á»‹nh nghÄ©a Ä‘á»u pháº£i ghi Ä‘Ã¨ phÆ°Æ¡ng thá»©c <code>loadClass</code> Ä‘á»ƒ thá»±c hiá»‡n chá»©c nÄƒng táº£i lá»›p. Sau khi mÃ´ hÃ¬nh á»§y quyá»n cha máº¹ Ä‘Æ°á»£c giá»›i thiá»‡u, phÆ°Æ¡ng thá»©c <code>loadClass</code> Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ á»§y quyá»n cho bá»™ táº£i lá»›p cha thá»±c hiá»‡n táº£i lá»›p. Chá»‰ khi bá»™ táº£i lá»›p cha khÃ´ng thá»ƒ hoÃ n thÃ nh yÃªu cáº§u táº£i, phÆ°Æ¡ng thá»©c <code>findClass</code> cá»§a chÃ­nh nÃ³ má»›i Ä‘Æ°á»£c gá»i Ä‘á»ƒ táº£i lá»›p. Do Ä‘Ã³, trong cÃ¡c bá»™ táº£i lá»›p trÆ°á»›c JDK1.2, phÆ°Æ¡ng thá»©c <code>loadClass</code> khÃ´ng tuÃ¢n theo mÃ´ hÃ¬nh á»§y quyá»n cha máº¹, vÃ  sau JDK1.2, bá»™ táº£i lá»›p tá»± Ä‘á»‹nh nghÄ©a khÃ´ng nÃªn ghi Ä‘Ã¨ phÆ°Æ¡ng thá»©c <code>loadClass</code> ná»¯a, mÃ  chá»‰ cáº§n ghi Ä‘Ã¨ phÆ°Æ¡ng thá»©c <code>findClass</code>.</li><li>MÃ´ hÃ¬nh á»§y quyá»n cha máº¹ giáº£i quyáº¿t tá»‘t váº¥n Ä‘á» thá»‘ng nháº¥t lá»›p cÆ¡ báº£n cá»§a cÃ¡c bá»™ táº£i lá»›p, cÃ¡c lá»›p cÃ ng cÆ¡ báº£n cÃ ng Ä‘Æ°á»£c táº£i bá»Ÿi cÃ¡c bá»™ táº£i lá»›p á»Ÿ cáº¥p cao hÆ¡n. Tuy nhiÃªn, váº¥n Ä‘á» phÃ¡t sinh khi cÃ¡c lá»›p cÆ¡ báº£n muá»‘n gá»i ngÆ°á»£c láº¡i mÃ£ ngÆ°á»i dÃ¹ng á»Ÿ cáº¥p tháº¥p hÆ¡n thÃ¬ khÃ´ng thá»ƒ á»§y quyá»n cho bá»™ táº£i lá»›p con Ä‘á»ƒ thá»±c hiá»‡n. Äá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y, JDK Ä‘Ã£ giá»›i thiá»‡u ngá»¯ cáº£nh cá»§a luá»“ng ThreadContext thÃ´ng qua phÆ°Æ¡ng thá»©c <code>setContextClassLoader</code> Ä‘á»ƒ Ä‘áº·t bá»™ táº£i lá»›p ngá»¯ cáº£nh cá»§a luá»“ng. JavaEE chá»‰ lÃ  má»™t Ä‘áº·c táº£, Sun chá»‰ Ä‘Æ°a ra giao diá»‡n chuáº©n vÃ  viá»‡c triá»ƒn khai cá»¥ thá»ƒ lÃ  do cÃ¡c nhÃ  sáº£n xuáº¥t thá»±c hiá»‡n. Do Ä‘Ã³, cÃ¡c thÆ° viá»‡n JNDI, JDBC, JAXBâ€¦ cÃ³ thá»ƒ Ä‘Æ°á»£c cÃ¡c thÆ° viá»‡n cá»§a JDK gá»i Ä‘áº¿n. Bá»™ táº£i lá»›p ngá»¯ cáº£nh cá»§a luá»“ng cÅ©ng khÃ´ng tuÃ¢n theo mÃ´ hÃ¬nh á»§y quyá»n cha máº¹.</li><li>Trong nhá»¯ng nÄƒm gáº§n Ä‘Ã¢y, cÃ¡c á»©ng dá»¥ng yÃªu cáº§u thay Ä‘á»•i mÃ£ nÃ³ng (hot code swapping), triá»ƒn khai module nÃ³ng (module hot deployment) mÃ  khÃ´ng cáº§n khá»Ÿi Ä‘á»™ng láº¡i JVM Ä‘Ã£ thÃºc Ä‘áº©y cÃ´ng nghá»‡ OSGi. Trong OSGi, há»‡ thá»‘ng bá»™ táº£i lá»›p Ä‘Ã£ phÃ¡t triá»ƒn thÃ nh cáº¥u trÃºc dáº¡ng lÆ°á»›i vÃ  khÃ´ng hoÃ n toÃ n tuÃ¢n theo mÃ´ hÃ¬nh á»§y quyá»n cha máº¹.</li></ul><h3 id="bo-tai-lop-tu-Ä‘inh-nghia" tabindex="-1"><a class="header-anchor" href="#bo-tai-lop-tu-Ä‘inh-nghia"><span>Bá»™ táº£i lá»›p tá»± Ä‘á»‹nh nghÄ©a</span></a></h3><p>Äá»c thÃªm, khÃ´ng má»Ÿ rá»™ng quÃ¡ nhiá»u.</p><h2 id="ban-hieu-gi-ve-jvm-memory-model" tabindex="-1"><a class="header-anchor" href="#ban-hieu-gi-ve-jvm-memory-model"><span>Báº¡n hiá»ƒu gÃ¬ vá» JVM Memory Model?</span></a></h2><p>TÃ´i tin ráº±ng má»i ngÆ°á»i Ä‘Ã£ ráº¥t rÃµ vá» cÃ¡ch má»™t tá»‡p nguá»“n Java biáº¿n thÃ nh tá»‡p bytecode, cÅ©ng nhÆ° Ã½ nghÄ©a cá»§a bytecode Ä‘Ã³. Tiáº¿p theo, Java Virtual Machine (JVM) sáº½ cháº¡y tá»‡p bytecode, Ä‘á»ƒ Ä‘Æ°a ra káº¿t quáº£ cuá»‘i cÃ¹ng mÃ  chÃºng ta mong muá»‘n. Trong quÃ¡ trÃ¬nh nÃ y, JVM sáº½ táº£i bytecode vÃ o bá»™ nhá»›, sau Ä‘Ã³ thá»±c hiá»‡n má»™t loáº¡t cÃ¡c bÆ°á»›c khá»Ÿi táº¡o vÃ  cuá»‘i cÃ¹ng lÃ  cháº¡y chÆ°Æ¡ng trÃ¬nh Ä‘á»ƒ Ä‘Æ°a ra káº¿t quáº£.</p><p>Váº­y dá»¯ liá»‡u bytecode Ä‘Æ°á»£c lÆ°u trá»¯ trong bá»™ nhá»› JVM nhÆ° tháº¿ nÃ o? JVM phÃ¢n bá»• bá»™ nhá»› cho cÃ¡c biáº¿n thÃ nh viÃªn hoáº·c Ä‘á»‘i tÆ°á»£ng nhÆ° tháº¿ nÃ o? Äá»ƒ tráº£ lá»i nhá»¯ng cÃ¢u há»i nÃ y, trÆ°á»›c tiÃªn chÃºng ta cáº§n hiá»ƒu vá» JVM Memory Model.</p><p>Thá»±c táº¿, JVM Memory Model khÃ´ng pháº£i lÃ  cÃ¡ch gá»i chÃ­nh thá»©c. Trong &quot;Java Virtual Machine Specification&quot;, thuáº­t ngá»¯ Ä‘Æ°á»£c sá»­ dá»¥ng lÃ  &quot;Runtime Data Area&quot;. Tuy nhiÃªn, nhiá»u lÃºc thuáº­t ngá»¯ nÃ y khÃ´ng thá»±c sá»± trá»±c quan, vÃ  theo thÃ³i quen tÃ­ch lÅ©y lÃ¢u ngÃ y, chÃºng ta thÆ°á»ng gá»i nÃ³ lÃ  JVM Memory Model.</p><p>Theo &quot;Java Virtual Machine Specification,&quot; bá»™ nhá»› cá»§a JVM cÃ³ thá»ƒ chia thÃ nh hai pháº§n: chung vÃ  riÃªng. Pháº§n chung Ä‘Æ°á»£c chia sáº» bá»Ÿi táº¥t cáº£ cÃ¡c luá»“ng, bao gá»“m Heap, Method Area, vÃ  Constant Pool. Pháº§n riÃªng chá»‰ dÃ nh riÃªng cho tá»«ng luá»“ng, bao gá»“m: PC Register, JVM Stack, vÃ  Native Method Stack.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240926130801.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><h3 id="phan-bo-nho-chia-se-java-heap-method-area-va-constant-pool" tabindex="-1"><a class="header-anchor" href="#phan-bo-nho-chia-se-java-heap-method-area-va-constant-pool"><span>Pháº§n bá»™ nhá»› chia sáº»: Java Heap, Method Area, vÃ  Constant Pool</span></a></h3><p>Trong JVM, pháº§n chia sáº» bá»™ nhá»› bao gá»“m Java Heap, Method Area vÃ  Constant Pool.</p><p>Java Heap lÃ  má»™t vÃ¹ng bá»™ nhá»› Ä‘Æ°á»£c JVM cáº¯t ra Ä‘á»ƒ phÃ¢n bá»• cho cÃ¡c Ä‘á»‘i tÆ°á»£ng Java. Gáº§n nhÆ° táº¥t cáº£ cÃ¡c Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c táº¡o ra Ä‘á»u Ä‘Æ°á»£c phÃ¢n bá»• á»Ÿ Ä‘Ã¢y. Táº¡i sao láº¡i nÃ³i &quot;gáº§n nhÆ°&quot;? VÃ¬ cÃ³ má»™t sá»‘ trÆ°á»ng há»£p ngoáº¡i lá»‡, cháº³ng háº¡n nhÆ° khi cÃ¡c Ä‘á»‘i tÆ°á»£ng nhá» cÃ³ thá»ƒ Ä‘Æ°á»£c phÃ¢n bá»• trá»±c tiáº¿p trÃªn Stack, hiá»‡n tÆ°á»£ng nÃ y gá»i lÃ  &quot;phÃ¢n bá»• trÃªn Stack&quot;. ChÃºng ta sáº½ khÃ´ng Ä‘i sÃ¢u vÃ o váº¥n Ä‘á» nÃ y á»Ÿ Ä‘Ã¢y, mÃ  sáº½ giá»›i thiá»‡u sau.</p><p>Method Area lÃ  vÃ¹ng chá»©a cÃ¡c dá»¯ liá»‡u bytecode cá»§a cÃ¡c lá»›p Java, bao gá»“m thÃ´ng tin vá» cáº¥u trÃºc cá»§a lá»›p nhÆ° runtime constant pool, dá»¯ liá»‡u vá» cÃ¡c field vÃ  method, vÃ  cáº£ cÃ¡c constructor. CÃ³ thá»ƒ tháº¥y Constant Pool thá»±c ra Ä‘Æ°á»£c lÆ°u trá»¯ trong Method Area, nhÆ°ng &quot;Java Virtual Machine Specification&quot; Ä‘áº·t Constant Pool vÃ  Method Area ngang hÃ ng, Ä‘iá»u nÃ y chÃºng ta chá»‰ cáº§n biáº¿t lÃ  Ä‘Æ°á»£c.</p><p>TÃ¹y vÃ o tá»«ng phiÃªn báº£n JVM, Method Area cÃ³ thá»ƒ cÃ³ tÃªn khÃ¡c nhau. Cháº³ng háº¡n, trong HotSpot JVM phiÃªn báº£n 1.7, nÃ³ Ä‘Æ°á»£c gá»i lÃ  Permanent Space, cÃ²n trong JDK 1.8 thÃ¬ Ä‘Æ°á»£c gá»i lÃ  MetaSpace.</p><p>Sau khi hiá»ƒu rÃµ chá»©c nÄƒng chÃ­nh cá»§a cÃ¡c pháº§n nÃ y, chÃºng ta sáº½ Ä‘i sÃ¢u hÆ¡n vÃ o Java Heap.</p><p>Java Heap Ä‘Æ°á»£c chia thÃ nh hai khu vá»±c dá»±a trÃªn tuá»•i thá» cá»§a Ä‘á»‘i tÆ°á»£ng: Young Generation vÃ  Old Generation. Young Generation cÃ²n Ä‘Æ°á»£c chia thÃ nh ba pháº§n: Eden, From Survivor 0, vÃ  To Survivor 1.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240926130917.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>Khi cÃ³ Ä‘á»‘i tÆ°á»£ng cáº§n phÃ¢n bá»•, nÃ³ luÃ´n Ä‘Æ°á»£c phÃ¢n bá»• trong Eden cá»§a Young Generation. Khi bá»™ nhá»› cá»§a Eden khÃ´ng Ä‘á»§, JVM sáº½ kÃ­ch hoáº¡t quÃ¡ trÃ¬nh thu gom rÃ¡c (GC).</p><p>LÃºc nÃ y, bá»™ nhá»› cá»§a cÃ¡c Ä‘á»‘i tÆ°á»£ng khÃ´ng cÃ²n tham chiáº¿u trong Eden sáº½ bá»‹ thu gom, trong khi cÃ¡c Ä‘á»‘i tÆ°á»£ng cÃ³ tuá»•i thá» lÃ¢u hÆ¡n sáº½ Ä‘Æ°á»£c chuyá»ƒn vÃ o Old Generation.</p><p>Trong JVM, tham sá»‘ <code>-XX:MaxTenuringThreshold</code> dÃ¹ng Ä‘á»ƒ thiáº¿t láº­p sá»‘ láº§n GC cáº§n tráº£i qua trÆ°á»›c khi Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c chuyá»ƒn tá»« Young Generation sang Old Generation. Khi Ä‘á»‘i tÆ°á»£ng trong Young Generation vÆ°á»£t qua sá»‘ láº§n GC nÃ y, nÃ³ sáº½ chuyá»ƒn sang Old Generation trong láº§n GC tiáº¿p theo.</p><p>HÃ£y suy nghÄ© má»™t chÃºt: Táº¡i sao Java Heap láº¡i Ä‘Æ°á»£c chia khu vá»±c nhÆ° váº­y?</p><p>Dá»±a trÃªn kinh nghiá»‡m cá»§a chÃºng ta, cÃ¡c Ä‘á»‘i tÆ°á»£ng trong JVM thÆ°á»ng cÃ³ tuá»•i thá» khÃ¡c nhau, tá»« ngáº¯n Ä‘áº¿n dÃ i. Náº¿u chÃºng ta trá»™n chÃºng láº¡i vá»›i nhau, cÃ¡c Ä‘á»‘i tÆ°á»£ng cÃ³ tuá»•i thá» ngáº¯n sáº½ dáº«n Ä‘áº¿n viá»‡c thu gom rÃ¡c thÆ°á»ng xuyÃªn hÆ¡n. Trong quÃ¡ trÃ¬nh thu gom rÃ¡c, JVM pháº£i quÃ©t qua toÃ n bá»™ bá»™ nhá»›, nhÆ°ng viá»‡c quÃ©t qua nhá»¯ng Ä‘á»‘i tÆ°á»£ng cÃ³ tuá»•i thá» cao lÃ  má»™t sá»± lÃ£ng phÃ­ thá»i gian. VÃ¬ váº­y, viá»‡c phÃ¢n khu vá»±c lÃ  Ä‘á»ƒ tÄƒng hiá»‡u suáº¥t thu gom rÃ¡c.</p><p>Má»™t cÃ¢u há»i khÃ¡c lÃ : Táº¡i sao cáº¥u hÃ¬nh máº·c Ä‘á»‹nh cá»§a JVM láº¡i lÃ  <code>eden:from:to = 8:1:1</code>?</p><p>Thá»±c ra, Ä‘Ã¢y lÃ  káº¿t quáº£ nghiÃªn cá»©u cá»§a IBM dá»±a trÃªn cÃ¡c thá»‘ng kÃª. Theo IBM, 80% cÃ¡c Ä‘á»‘i tÆ°á»£ng cÃ³ tuá»•i thá» ráº¥t ngáº¯n. VÃ¬ váº­y, há» Ä‘Ã£ Ä‘áº·t Eden lÃ  80% cá»§a Young Generation, Ä‘á»ƒ giáº£m thiá»ƒu lÃ£ng phÃ­ bá»™ nhá»› vÃ  tÄƒng hiá»‡u suáº¥t sá»­ dá»¥ng bá»™ nhá»›.</p><h3 id="phan-bo-nho-rieng-pc-register-jvm-stack-va-native-method-stack" tabindex="-1"><a class="header-anchor" href="#phan-bo-nho-rieng-pc-register-jvm-stack-va-native-method-stack"><span>Pháº§n bá»™ nhá»› riÃªng: PC Register, JVM Stack, vÃ  Native Method Stack</span></a></h3><p>Java Heap vÃ  Method Area lÃ  dá»¯ liá»‡u Ä‘Æ°á»£c chia sáº», nhÆ°ng cÃ³ má»™t sá»‘ pháº§n lÃ  riÃªng tÆ° cho tá»«ng luá»“ng. Nhá»¯ng pháº§n riÃªng tÆ° nÃ y bao gá»“m: PC Register, JVM Stack, vÃ  Native Method Stack.</p><ul><li><p><strong>PC Register</strong>: lÃ  thanh ghi Program Counter, lÆ°u Ä‘á»‹a chá»‰ cá»§a phÆ°Æ¡ng thá»©c hiá»‡n táº¡i mÃ  luá»“ng Ä‘ang thá»±c thi.</p><p>Náº¿u phÆ°Æ¡ng thá»©c nÃ y khÃ´ng pháº£i lÃ  native, PC Register sáº½ lÆ°u Ä‘á»‹a chá»‰ cá»§a lá»‡nh bytecode mÃ  JVM Ä‘ang thá»±c thi. Náº¿u lÃ  native, giÃ¡ trá»‹ cá»§a PC Register lÃ  undefined.</p><p>Táº¡i báº¥t ká»³ thá»i Ä‘iá»ƒm nÃ o, má»™t luá»“ng JVM chá»‰ thá»±c thi má»™t phÆ°Æ¡ng thá»©c, vÃ  phÆ°Æ¡ng thá»©c nÃ y Ä‘Æ°á»£c gá»i lÃ  &quot;phÆ°Æ¡ng thá»©c hiá»‡n táº¡i&quot;, Ä‘á»‹a chá»‰ cá»§a nÃ³ Ä‘Æ°á»£c lÆ°u trong PC Register.</p></li><li><p><strong>JVM Stack</strong>: Ä‘Æ°á»£c táº¡o ra cÃ¹ng vá»›i luá»“ng, dÃ¹ng Ä‘á»ƒ lÆ°u trá»¯ cÃ¡c stack frame, lÃ  nÆ¡i lÆ°u trá»¯ biáº¿n cá»¥c bá»™ vÃ  cÃ¡c káº¿t quáº£ táº¡m thá»i. Dá»¯ liá»‡u trong stack frame bao gá»“m: báº£ng biáº¿n cá»¥c bá»™ vÃ  operator stack.</p></li><li><p><strong>Native Method Stack</strong>: khi JVM sá»­ dá»¥ng ngÃ´n ngá»¯ khÃ¡c (nhÆ° C) Ä‘á»ƒ thá»±c thi cÃ¡c lá»‡nh, nÃ³ sáº½ sá»­ dá»¥ng Native Method Stack. Náº¿u JVM khÃ´ng há»— trá»£ phÆ°Æ¡ng thá»©c native vÃ  khÃ´ng phá»¥ thuá»™c vÃ o stack truyá»n thá»‘ng, Native Method Stack khÃ´ng cáº§n Ä‘Æ°á»£c há»— trá»£.</p></li></ul><p>JVM Memory Model lÃ  má»™t pháº§n cáº§n pháº£i náº¯m vá»¯ng khi há»c vá» JVM, Ä‘áº·c biá»‡t lÃ  Java Heap, vÃ¬ ráº¥t nhiá»u váº¥n Ä‘á» trá»±c tuyáº¿n phÃ¡t sinh tá»« Ä‘Ã¢y. Do Ä‘Ã³, viá»‡c hiá»ƒu rÃµ phÃ¢n chia bá»™ nhá»› trong Java Heap vÃ  cÃ¡ch Ä‘iá»u chá»‰nh cÃ¡c tham sá»‘ thÃ´ng dá»¥ng lÃ  ráº¥t quan trá»ng.</p><p>NgoÃ i sÃ¡u pháº§n trÃªn, trong Java cÃ²n cÃ³ Direct Memory, cÃ¡c Stack Frame, nhÆ°ng vÃ¬ cÃ¡c cáº¥u trÃºc nÃ y Ã­t Ä‘Æ°á»£c sá»­ dá»¥ng, nÃªn chÃºng ta khÃ´ng nháº¯c Ä‘áº¿n á»Ÿ Ä‘Ã¢y Ä‘á»ƒ trÃ¡nh lÃ m cho ngÆ°á»i má»›i báº¯t Ä‘áº§u bá»‹ rá»‘i.</p><p>Äáº¿n Ä‘Ã¢y, má»™t tá»‡p Java Ä‘Ã£ Ä‘Æ°á»£c táº£i vÃ o bá»™ nhá»›, thÃ´ng tin vá» lá»›p Java Ä‘Æ°á»£c lÆ°u trong Method Area. Náº¿u táº¡o Ä‘á»‘i tÆ°á»£ng, dá»¯ liá»‡u Ä‘á»‘i tÆ°á»£ng sáº½ Ä‘Æ°á»£c lÆ°u trong Java Heap. Náº¿u gá»i phÆ°Æ¡ng thá»©c, sáº½ sá»­ dá»¥ng PC Register, JVM Stack, vÃ  Native Method Stack.</p><h2 id="noi-ve-nhung-thuat-toan-thu-gom-rac-cua-jvm-ma-ban-biet" tabindex="-1"><a class="header-anchor" href="#noi-ve-nhung-thuat-toan-thu-gom-rac-cua-jvm-ma-ban-biet"><span>NÃ³i vá» nhá»¯ng thuáº­t toÃ¡n thu gom rÃ¡c cá»§a JVM mÃ  báº¡n biáº¿t?</span></a></h2><p>Khi nÃ³i Ä‘áº¿n JVM Memory Model (JMM), chÃºng ta Ä‘Ã£ Ä‘á» cáº­p ráº±ng pháº§n nÃ y thá»±c táº¿ Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh bá»Ÿi <strong>&quot;Java Virtual Machine Specification&quot;</strong>, vÃ  má»—i JVM cÃ³ thá»ƒ cÃ³ cÃ¡c cÃ¡ch triá»ƒn khai khÃ¡c nhau. Thá»±c táº¿, khi liÃªn quan Ä‘áº¿n bá»™ nhá»› cá»§a JVM, chÃºng ta khÃ´ng thá»ƒ khÃ´ng nháº¯c Ä‘áº¿n cÆ¡ cháº¿ thu gom rÃ¡c cá»§a nÃ³. VÃ¬ bá»™ nhá»› luÃ´n cÃ³ giá»›i háº¡n, chÃºng ta cáº§n má»™t cÆ¡ cháº¿ Ä‘á»ƒ liÃªn tá»¥c thu gom nhá»¯ng bá»™ nhá»› khÃ´ng cÃ²n sá»­ dá»¥ng, nháº±m tÃ¡i sá»­ dá»¥ng láº¡i bá»™ nhá»› vÃ  giÃºp chÆ°Æ¡ng trÃ¬nh cÃ³ thá»ƒ tiáº¿p tá»¥c hoáº¡t Ä‘á»™ng bÃ¬nh thÆ°á»ng.</p><p>So vá»›i JVM Memory Model cÃ³ quy Ä‘á»‹nh cá»¥ thá»ƒ trong <strong>&quot;Java Virtual Machine Specification&quot;</strong>, cÆ¡ cháº¿ thu gom rÃ¡c khÃ´ng cÃ³ quy Ä‘á»‹nh rÃµ rÃ ng nÃ o. VÃ¬ váº­y, nhiá»u JVM khÃ¡c nhau sáº½ cÃ³ nhá»¯ng cÃ¡ch triá»ƒn khai khÃ¡c nhau. Pháº§n dÆ°á»›i Ä‘Ã¢y chÃºng ta sáº½ tháº£o luáº­n vá» cÃ¡c thuáº­t toÃ¡n thu gom rÃ¡c dá»±a trÃªn JVM HotSpot.</p><h3 id="the-nao-Ä‘uoc-xem-la-rac" tabindex="-1"><a class="header-anchor" href="#the-nao-Ä‘uoc-xem-la-rac"><span>Tháº¿ nÃ o Ä‘Æ°á»£c xem lÃ  rÃ¡c?</span></a></h3><p>Äá»ƒ thá»±c hiá»‡n thu gom rÃ¡c, cÃ¢u há»i quan trá»ng nháº¥t lÃ : LÃ m sao Ä‘á»ƒ xÃ¡c Ä‘á»‹nh Ä‘Ã¢u lÃ  rÃ¡c?</p><p>Giá»‘ng nhÆ° trong cuá»™c sá»‘ng háº±ng ngÃ y, náº¿u má»™t thá»© khÃ´ng cÃ²n Ä‘Æ°á»£c sá»­ dá»¥ng thÆ°á»ng xuyÃªn, thÃ¬ nÃ³ cÃ³ thá»ƒ Ä‘Æ°á»£c xem lÃ  rÃ¡c. Trong Java cÅ©ng tÆ°Æ¡ng tá»±, náº¿u má»™t Ä‘á»‘i tÆ°á»£ng khÃ´ng cÃ²n cÃ³ kháº£ nÄƒng Ä‘Æ°á»£c tham chiáº¿u, thÃ¬ Ä‘á»‘i tÆ°á»£ng Ä‘Ã³ Ä‘Æ°á»£c xem lÃ  rÃ¡c vÃ  cáº§n Ä‘Æ°á»£c thu gom.</p><p>Dá»±a trÃªn Ã½ tÆ°á»Ÿng nÃ y, chÃºng ta cÃ³ thá»ƒ dá»… dÃ ng nghÄ© Ä‘áº¿n phÆ°Æ¡ng phÃ¡p Ä‘áº¿m tham chiáº¿u Ä‘á»ƒ xÃ¡c Ä‘á»‹nh rÃ¡c. Khi má»™t Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c tham chiáº¿u, Ä‘áº¿m tham chiáº¿u cá»§a nÃ³ tÄƒng lÃªn má»™t Ä‘Æ¡n vá»‹, vÃ  khi tham chiáº¿u bá»‹ loáº¡i bá», Ä‘áº¿m tham chiáº¿u giáº£m Ä‘i. Báº±ng cÃ¡ch nÃ y, chÃºng ta cÃ³ thá»ƒ xÃ¡c Ä‘á»‹nh má»™t Ä‘á»‘i tÆ°á»£ng lÃ  rÃ¡c náº¿u Ä‘áº¿m tham chiáº¿u cá»§a nÃ³ báº±ng khÃ´ng. PhÆ°Æ¡ng phÃ¡p nÃ y thÆ°á»ng Ä‘Æ°á»£c gá»i lÃ  <strong>phÆ°Æ¡ng phÃ¡p Ä‘áº¿m tham chiáº¿u</strong>.</p><p>Máº·c dÃ¹ phÆ°Æ¡ng phÃ¡p nÃ y ráº¥t Ä‘Æ¡n giáº£n, nhÆ°ng nÃ³ cÃ³ má»™t váº¥n Ä‘á» cháº¿t ngÆ°á»i, Ä‘Ã³ lÃ  <strong>tham chiáº¿u vÃ²ng</strong>. VÃ­ dá»¥, Ä‘á»‘i tÆ°á»£ng A tham chiáº¿u Ä‘á»‘i tÆ°á»£ng B, Ä‘á»‘i tÆ°á»£ng B tham chiáº¿u Ä‘á»‘i tÆ°á»£ng C, vÃ  Ä‘á»‘i tÆ°á»£ng C tham chiáº¿u láº¡i Ä‘á»‘i tÆ°á»£ng A. Má»—i Ä‘á»‘i tÆ°á»£ng Ä‘á»u cÃ³ má»™t tham chiáº¿u Ä‘áº¿m lÃ  1, nhÆ°ng khÃ´ng cÃ³ Ä‘á»‘i tÆ°á»£ng nÃ o trong sá»‘ nÃ y Ä‘Æ°á»£c tham chiáº¿u tá»« bÃªn ngoÃ i. Theo khÃ¡i niá»‡m vá» rÃ¡c, cáº£ ba Ä‘á»‘i tÆ°á»£ng nÃ y Ä‘á»u khÃ´ng cÃ²n Ä‘Æ°á»£c sá»­ dá»¥ng vÃ  cáº§n pháº£i bá»‹ thu gom, nhÆ°ng do Ä‘áº¿m tham chiáº¿u cá»§a chÃºng khÃ´ng báº±ng 0, váº¥n Ä‘á» vÃ²ng tham chiáº¿u sáº½ xuáº¥t hiá»‡n.</p><p>Hiá»‡n nay, cÃ¡ch mÃ  JVM sá»­ dá»¥ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh Ä‘á»‘i tÆ°á»£ng rÃ¡c lÃ  <strong>thuáº­t toÃ¡n truy váº¿t GC Root (GC Root Tracing)</strong>. Quy trÃ¬nh cá»§a nÃ³ nhÆ° sau: Báº¯t Ä‘áº§u tá»« GC Root, táº¥t cáº£ cÃ¡c Ä‘á»‘i tÆ°á»£ng cÃ³ thá»ƒ tiáº¿p cáº­n Ä‘Æ°á»£c Ä‘á»u lÃ  Ä‘á»‘i tÆ°á»£ng cÃ²n sá»‘ng, vÃ  cÃ¡c Ä‘á»‘i tÆ°á»£ng khÃ´ng thá»ƒ tiáº¿p cáº­n Ä‘Æ°á»£c lÃ  rÃ¡c.</p><p>Äiá»u quan trá»ng nháº¥t á»Ÿ Ä‘Ã¢y lÃ  táº­p há»£p GC Root, thá»±c cháº¥t lÃ  má»™t nhÃ³m cÃ¡c tham chiáº¿u hoáº¡t Ä‘á»™ng. Tuy nhiÃªn, nhÃ³m nÃ y khÃ¡c vá»›i cÃ¡c táº­p há»£p Ä‘á»‘i tÆ°á»£ng thÃ´ng thÆ°á»ng, vÃ¬ nÃ³ Ä‘Ã£ Ä‘Æ°á»£c chá»n lá»c cáº©n tháº­n, thÆ°á»ng bao gá»“m:</p><ul><li>Táº¥t cáº£ cÃ¡c lá»›p Java hiá»‡n Ä‘ang Ä‘Æ°á»£c táº£i</li><li>CÃ¡c biáº¿n tÄ©nh kiá»ƒu tham chiáº¿u cá»§a lá»›p Java</li><li>CÃ¡c háº±ng sá»‘ kiá»ƒu tham chiáº¿u trong Constant Pool cá»§a lá»›p Java</li><li>CÃ¡c cáº¥u trÃºc dá»¯ liá»‡u tÄ©nh trong mÃ¡y áº£o trá» Ä‘áº¿n cÃ¡c Ä‘á»‘i tÆ°á»£ng trong heap cá»§a GC</li><li>...</li></ul><p>NÃ³i Ä‘Æ¡n giáº£n, GC Root lÃ  má»™t táº­p há»£p cÃ¡c tham chiáº¿u hoáº¡t Ä‘á»™ng Ä‘Ã£ Ä‘Æ°á»£c chá»n lá»c ká»¹ lÆ°á»¡ng, vÃ  cÃ¡c Ä‘á»‘i tÆ°á»£ng cÃ³ thá»ƒ tiáº¿p cáº­n Ä‘Æ°á»£c tá»« nhá»¯ng tham chiáº¿u nÃ y cÅ©ng sáº½ Ä‘Æ°á»£c xem lÃ  cÃ²n sá»‘ng.</p><h3 id="lam-the-nao-Ä‘e-thu-gom-rac" tabindex="-1"><a class="header-anchor" href="#lam-the-nao-Ä‘e-thu-gom-rac"><span>LÃ m tháº¿ nÃ o Ä‘á»ƒ thu gom rÃ¡c?</span></a></h3><p>Äáº¿n Ä‘Ã¢y, chÃºng ta Ä‘Ã£ hiá»ƒu rÃ¡c lÃ  gÃ¬ vÃ  cÃ¡ch JVM xÃ¡c Ä‘á»‹nh cÃ¡c Ä‘á»‘i tÆ°á»£ng rÃ¡c. Váº­y sau khi Ä‘Ã£ xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c cÃ¡c Ä‘á»‘i tÆ°á»£ng rÃ¡c, JVM sáº½ tiáº¿n hÃ nh thu gom chÃºng nhÆ° tháº¿ nÃ o? ÄÃ¢y lÃ  ná»™i dung mÃ  chÃºng ta sáº½ tháº£o luáº­n tiáº¿p theo: <strong>Thu gom rÃ¡c Ä‘Æ°á»£c thá»±c hiá»‡n nhÆ° tháº¿ nÃ o?</strong></p><p>CÃ³ ba thuáº­t toÃ¡n thu gom rÃ¡c Ä‘Æ¡n giáº£n: <strong>Thuáº­t toÃ¡n Ä‘Ã¡nh dáº¥u vÃ  dá»n dáº¹p (Mark-Sweep)</strong>, <strong>Thuáº­t toÃ¡n sao chÃ©p (Mark-Copy)</strong>, vÃ  <strong>Thuáº­t toÃ¡n Ä‘Ã¡nh dáº¥u vÃ  nÃ©n (Mark-Compact)</strong>.</p><ul><li><p><strong>Thuáº­t toÃ¡n Ä‘Ã¡nh dáº¥u vÃ  dá»n dáº¹p</strong>: ÄÆ°á»£c chia lÃ m hai giai Ä‘oáº¡n: Giai Ä‘oáº¡n Ä‘Ã¡nh dáº¥u vÃ  giai Ä‘oáº¡n dá»n dáº¹p. Má»™t cÃ¡ch thá»±c hiá»‡n kháº£ thi lÃ , trong giai Ä‘oáº¡n Ä‘Ã¡nh dáº¥u, JVM Ä‘Ã¡nh dáº¥u táº¥t cáº£ cÃ¡c Ä‘á»‘i tÆ°á»£ng cÃ³ thá»ƒ tiáº¿p cáº­n Ä‘Æ°á»£c tá»« GC Root. Sau Ä‘Ã³, táº¥t cáº£ cÃ¡c Ä‘á»‘i tÆ°á»£ng khÃ´ng Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u sáº½ bá»‹ xem lÃ  rÃ¡c vÃ  bá»‹ thu gom trong giai Ä‘oáº¡n dá»n dáº¹p. Váº¥n Ä‘á» lá»›n nháº¥t cá»§a thuáº­t toÃ¡n nÃ y lÃ  váº¥n Ä‘á» phÃ¢n máº£nh bá»™ nhá»›. Náº¿u cÃ³ quÃ¡ nhiá»u phÃ¢n máº£nh, bá»™ nhá»› sáº½ trá»Ÿ nÃªn khÃ´ng liÃªn tá»¥c vÃ  viá»‡c cáº¥p phÃ¡t cho cÃ¡c Ä‘á»‘i tÆ°á»£ng lá»›n sáº½ kÃ©m hiá»‡u quáº£ hÆ¡n so vá»›i bá»™ nhá»› liÃªn tá»¥c.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240926135002.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure></li><li><p><strong>Thuáº­t toÃ¡n sao chÃ©p</strong>: Ã tÆ°á»Ÿng cá»‘t lÃµi cá»§a thuáº­t toÃ¡n nÃ y lÃ  chia bá»™ nhá»› thÃ nh hai pháº§n, chá»‰ sá»­ dá»¥ng má»™t pháº§n táº¡i má»™t thá»i Ä‘iá»ƒm. Khi thá»±c hiá»‡n thu gom rÃ¡c, cÃ¡c Ä‘á»‘i tÆ°á»£ng cÃ²n sá»‘ng trong vÃ¹ng nhá»› Ä‘ang sá»­ dá»¥ng sáº½ Ä‘Æ°á»£c sao chÃ©p sang pháº§n cÃ²n láº¡i chÆ°a sá»­ dá»¥ng. Sau Ä‘Ã³, táº¥t cáº£ cÃ¡c Ä‘á»‘i tÆ°á»£ng trong vÃ¹ng nhá»› Ä‘ang sá»­ dá»¥ng sáº½ bá»‹ dá»n dáº¹p, vÃ  hai vÃ¹ng nhá»› sáº½ hoÃ¡n Ä‘á»•i vai trÃ² cho nhau Ä‘á»ƒ hoÃ n táº¥t thu gom rÃ¡c. NhÆ°á»£c Ä‘iá»ƒm cá»§a thuáº­t toÃ¡n nÃ y lÃ  pháº£i chia Ä‘Ã´i bá»™ nhá»›, gÃ¢y lÃ£ng phÃ­ khÃ´ng gian.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240926135026.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure></li><li><p><strong>Thuáº­t toÃ¡n Ä‘Ã¡nh dáº¥u vÃ  nÃ©n</strong>: ÄÃ¢y lÃ  phiÃªn báº£n cáº£i tiáº¿n cá»§a thuáº­t toÃ¡n Ä‘Ã¡nh dáº¥u vÃ  dá»n dáº¹p. Thuáº­t toÃ¡n nÃ y cÅ©ng tráº£i qua hai giai Ä‘oáº¡n: giai Ä‘oáº¡n Ä‘Ã¡nh dáº¥u vÃ  giai Ä‘oáº¡n nÃ©n. Trong giai Ä‘oáº¡n Ä‘Ã¡nh dáº¥u, táº¥t cáº£ cÃ¡c Ä‘á»‘i tÆ°á»£ng cÃ³ thá»ƒ tiáº¿p cáº­n tá»« táº­p há»£p GC Root sáº½ Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u. Trong giai Ä‘oáº¡n nÃ©n, cÃ¡c Ä‘á»‘i tÆ°á»£ng cÃ²n sá»‘ng sáº½ Ä‘Æ°á»£c nÃ©n vá» má»™t phÃ­a cá»§a bá»™ nhá»›, vÃ  khÃ´ng gian bÃªn ngoÃ i sáº½ Ä‘Æ°á»£c dá»n dáº¹p.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240926135059.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure></li></ul><p>So sÃ¡nh ba thuáº­t toÃ¡n trÃªn, chÃºng ta tháº¥y ráº±ng má»—i thuáº­t toÃ¡n Ä‘á»u cÃ³ Æ°u vÃ  nhÆ°á»£c Ä‘iá»ƒm riÃªng. <strong>Thuáº­t toÃ¡n Ä‘Ã¡nh dáº¥u vÃ  dá»n dáº¹p</strong> táº¡o ra phÃ¢n máº£nh bá»™ nhá»› nhÆ°ng khÃ´ng cáº§n di chuyá»ƒn quÃ¡ nhiá»u Ä‘á»‘i tÆ°á»£ng, phÃ¹ há»£p vá»›i tÃ¬nh huá»‘ng cÃ³ nhiá»u Ä‘á»‘i tÆ°á»£ng cÃ²n sá»‘ng. <strong>Thuáº­t toÃ¡n sao chÃ©p</strong> tuy lÃ£ng phÃ­ khÃ´ng gian vÃ  yÃªu cáº§u di chuyá»ƒn Ä‘á»‘i tÆ°á»£ng cÃ²n sá»‘ng, nhÆ°ng khÃ´ng táº¡o ra phÃ¢n máº£nh bá»™ nhá»›, phÃ¹ há»£p vá»›i trÆ°á»ng há»£p cÃ³ Ã­t Ä‘á»‘i tÆ°á»£ng cÃ²n sá»‘ng. <strong>Thuáº­t toÃ¡n Ä‘Ã¡nh dáº¥u vÃ  nÃ©n</strong> lÃ  phiÃªn báº£n tá»‘i Æ°u cá»§a thuáº­t toÃ¡n Ä‘Ã¡nh dáº¥u vÃ  dá»n dáº¹p, giáº£m thiá»ƒu phÃ¢n máº£nh bá»™ nhá»›.</p><h3 id="tu-tuong-phan-the-he" tabindex="-1"><a class="header-anchor" href="#tu-tuong-phan-the-he"><span>TÆ° tÆ°á»Ÿng phÃ¢n tháº¿ há»‡</span></a></h3><p>HÃ£y tÆ°á»Ÿng tÆ°á»£ng náº¿u chÃºng ta chá»‰ Ã¡p dá»¥ng má»™t loáº¡i thuáº­t toÃ¡n nÃ o Ä‘Ã³ thÃ¬ hiá»‡u quáº£ thu gom rÃ¡c cuá»‘i cÃ¹ng sáº½ khÃ´ng Ä‘Æ°á»£c cao. TrÃªn thá»±c táº¿, nhá»¯ng ngÆ°á»i xÃ¢y dá»±ng mÃ¡y áº£o JVM cÅ©ng nghÄ© nhÆ° váº­y, do Ä‘Ã³ trong cÃ¡c thuáº­t toÃ¡n thu gom rÃ¡c thá»±c táº¿, há» Ä‘Ã£ Ã¡p dá»¥ng tÆ° tÆ°á»Ÿng phÃ¢n tháº¿ há»‡.</p><p><strong>PhÃ¢n tháº¿ há»‡</strong> nghÄ©a lÃ  tÃ¹y theo khu vá»±c bá»™ nhá»› khÃ¡c nhau trong JVM, Ã¡p dá»¥ng cÃ¡c thuáº­t toÃ¡n thu gom rÃ¡c khÃ¡c nhau. VÃ­ dá»¥, Ä‘á»‘i vá»›i khu vá»±c Young Generation, nÆ¡i cÃ³ Ã­t Ä‘á»‘i tÆ°á»£ng sá»‘ng sÃ³t, thÃ­ch há»£p sá»­ dá»¥ng thuáº­t toÃ¡n sao chÃ©p. NhÆ° váº­y, chá»‰ cáº§n sao chÃ©p má»™t lÆ°á»£ng nhá» Ä‘á»‘i tÆ°á»£ng lÃ  cÃ³ thá»ƒ hoÃ n thÃ nh viá»‡c thu gom rÃ¡c vÃ  khÃ´ng gÃ¢y ra phÃ¢n máº£nh bá»™ nhá»›. CÃ²n Ä‘á»‘i vá»›i khu vá»±c Old Generation, nÆ¡i cÃ³ nhiá»u Ä‘á»‘i tÆ°á»£ng sá»‘ng sÃ³t, thÃ­ch há»£p sá»­ dá»¥ng thuáº­t toÃ¡n Ä‘Ã¡nh dáº¥u nÃ©n hoáº·c Ä‘Ã¡nh dáº¥u xÃ³a, giÃºp khÃ´ng pháº£i di chuyá»ƒn quÃ¡ nhiá»u Ä‘á»‘i tÆ°á»£ng trong bá»™ nhá»›.</p><p>HÃ£y tÆ°á»Ÿng tÆ°á»£ng náº¿u khÃ´ng Ã¡p dá»¥ng tÆ° tÆ°á»Ÿng phÃ¢n tháº¿ há»‡ mÃ  sá»­ dá»¥ng thuáº­t toÃ¡n sao chÃ©p trong khu vá»±c Old Generation. Trong trÆ°á»ng há»£p cá»±c Ä‘oan, tá»· lá»‡ sá»‘ng sÃ³t cá»§a cÃ¡c Ä‘á»‘i tÆ°á»£ng trong khu vá»±c Old Generation cÃ³ thá»ƒ Ä‘áº¡t 100%, khi Ä‘Ã³ chÃºng ta cáº§n sao chÃ©p toÃ n bá»™ sá»‘ Ä‘á»‘i tÆ°á»£ng nÃ y sang má»™t vÃ¹ng nhá»› khÃ¡c, khá»‘i lÆ°á»£ng cÃ´ng viá»‡c nÃ y lÃ  ráº¥t lá»›n.</p><p>Táº¡i Ä‘Ã¢y, chÃºng ta sáº½ tháº£o luáº­n sÃ¢u hÆ¡n vá» thuáº­t toÃ¡n thu gom rÃ¡c Ã¡p dá»¥ng trong Young Generation. NhÆ° Ä‘Ã£ Ä‘á» cáº­p á»Ÿ trÃªn, Ä‘áº·c Ä‘iá»ƒm cá»§a Young Generation lÃ  sá»‘ lÆ°á»£ng Ä‘á»‘i tÆ°á»£ng sá»‘ng sÃ³t Ã­t, thÃ­ch há»£p sá»­ dá»¥ng thuáº­t toÃ¡n sao chÃ©p. CÃ¡ch thá»±c hiá»‡n Ä‘Æ¡n giáº£n nháº¥t cá»§a thuáº­t toÃ¡n sao chÃ©p lÃ  sá»­ dá»¥ng má»™t ná»­a bá»™ nhá»› vÃ  giá»¯ láº¡i ná»­a cÃ²n láº¡i Ä‘á»ƒ dá»± phÃ²ng. NhÆ°ng thá»±c táº¿ chÃºng ta biáº¿t ráº±ng, trong JVM thá»±c táº¿, khu vá»±c Young Generation khÃ´ng Ä‘Æ°á»£c chia thÃ nh hai vÃ¹ng nhá»› báº±ng nhau. Thay vÃ o Ä‘Ã³, nÃ³ Ä‘Æ°á»£c chia thÃ nh ba khu vá»±c: vÃ¹ng Eden, vÃ¹ng from supervisor, vÃ  vÃ¹ng to supervisor. Váº­y táº¡i sao JVM láº¡i sá»­ dá»¥ng cÃ¡ch nÃ y thay vÃ¬ chia Ä‘Ã´i bá»™ nhá»› thÃ nh hai pháº§n báº±ng nhau?</p><p>Äá»ƒ tráº£ lá»i cÃ¢u há»i nÃ y, chÃºng ta cáº§n tÃ¬m hiá»ƒu sÃ¢u hÆ¡n vá» Ä‘áº·c Ä‘iá»ƒm cá»§a cÃ¡c Ä‘á»‘i tÆ°á»£ng trong Young Generation. Theo nghiÃªn cá»©u cá»§a IBM, 98% Ä‘á»‘i tÆ°á»£ng trong Young Generation chá»‰ tá»“n táº¡i trong thá»i gian ngáº¯n, vÃ¬ váº­y khÃ´ng cáº§n chia bá»™ nhá»› theo tá»· lá»‡ 1:1. Trong JVM cá»§a HotSpot, bá»™ nhá»› Ä‘Æ°á»£c chia thÃ nh má»™t vÃ¹ng Eden lá»›n vÃ  hai vÃ¹ng Survivor nhá», vá»›i tá»· lá»‡ kÃ­ch thÆ°á»›c lÃ  8:1:1. Khi thu gom rÃ¡c, cÃ¡c Ä‘á»‘i tÆ°á»£ng sá»‘ng sÃ³t trong Eden vÃ  Survivor sáº½ Ä‘Æ°á»£c sao chÃ©p sang vÃ¹ng Survivor cÃ²n láº¡i, sau Ä‘Ã³ dá»n dáº¹p vÃ¹ng Eden vÃ  vÃ¹ng Survivor vá»«a sá»­ dá»¥ng.</p><p>Báº±ng cÃ¡ch nÃ y, hiá»‡u suáº¥t sá»­ dá»¥ng bá»™ nhá»› Ä‘áº¡t Ä‘áº¿n 90%, chá»‰ cÃ³ 10% bá»™ nhá»› bá»‹ lÃ£ng phÃ­. Trong khi Ä‘Ã³, náº¿u chia Ä‘á»u bá»™ nhá»› thÃ nh hai pháº§n, hiá»‡u suáº¥t sá»­ dá»¥ng chá»‰ Ä‘áº¡t 50%, sá»± chÃªnh lá»‡ch giá»¯a hai cÃ¡ch tiáº¿p cáº­n lÃ  gáº§n gáº¥p Ä‘Ã´i.</p><h3 id="tu-tuong-phan-vung" tabindex="-1"><a class="header-anchor" href="#tu-tuong-phan-vung"><span>TÆ° tÆ°á»Ÿng phÃ¢n vÃ¹ng</span></a></h3><p>TÆ° tÆ°á»Ÿng phÃ¢n tháº¿ há»‡ chia cÃ¡c Ä‘á»‘i tÆ°á»£ng dá»±a trÃªn vÃ²ng Ä‘á»i cá»§a chÃºng thÃ nh hai pháº§n (Young Generation vÃ  Old Generation), nhÆ°ng trong JVM cÃ²n cÃ³ má»™t tÆ° tÆ°á»Ÿng phÃ¢n vÃ¹ng, tá»©c lÃ  chia toÃ n bá»™ khÃ´ng gian heap thÃ nh cÃ¡c vÃ¹ng liÃªn tiáº¿p nhá».</p><p>Má»—i vÃ¹ng nhá» nÃ y Ä‘Æ°á»£c sá»­ dá»¥ng vÃ  thu gom Ä‘á»™c láº­p, Æ°u Ä‘iá»ƒm cá»§a thuáº­t toÃ¡n nÃ y lÃ  cÃ³ thá»ƒ kiá»ƒm soÃ¡t sá»‘ lÆ°á»£ng vÃ¹ng Ä‘Æ°á»£c thu gom trong má»—i láº§n, tá»« Ä‘Ã³ kiá»ƒm soÃ¡t tá»‘t hÆ¡n thá»i gian cá»§a GC.</p><p>Äáº¿n Ä‘Ã¢y, chÃºng ta cÆ¡ báº£n Ä‘Ã£ giáº£i thÃ­ch Ä‘áº§y Ä‘á»§ vá» quÃ¡ trÃ¬nh thu gom rÃ¡c cá»§a JVM, tá»« viá»‡c xÃ¡c Ä‘á»‹nh tháº¿ nÃ o lÃ  rÃ¡c, cÃ¡ch JVM nháº­n diá»‡n Ä‘á»‘i tÆ°á»£ng rÃ¡c, cÃ¡ch thu gom rÃ¡c, cho Ä‘áº¿n hai tÆ° tÆ°á»Ÿng quan trá»ng trong thu gom rÃ¡c: tÆ° tÆ°á»Ÿng phÃ¢n tháº¿ há»‡ vÃ  phÃ¢n vÃ¹ng. Qua Ä‘Ã³, chÃºng ta Ä‘Ã£ cÃ³ cÃ¡i nhÃ¬n tá»•ng quan vá» toÃ n bá»™ quÃ¡ trÃ¬nh thu gom rÃ¡c.</p><h2 id="ban-co-biet-co-nhung-bo-thu-gom-rac-nao-trong-jvm-khong" tabindex="-1"><a class="header-anchor" href="#ban-co-biet-co-nhung-bo-thu-gom-rac-nao-trong-jvm-khong"><span>Báº¡n cÃ³ biáº¿t cÃ³ nhá»¯ng bá»™ thu gom rÃ¡c nÃ o trong JVM khÃ´ng?</span></a></h2><p>ChÃºng ta Ä‘Ã£ giá»›i thiá»‡u vá» JMM vÃ  cÆ¡ cháº¿ thu gom rÃ¡c cá»§a JVM, váº­y trong bÃ i viáº¿t nÃ y, chÃºng ta sáº½ nÃ³i vá» cÃ¡c bá»™ thu gom rÃ¡c cá»¥ thá»ƒ thá»±c hiá»‡n viá»‡c thu gom rÃ¡c.</p><p>NhÃ¬n chung, bá»™ thu gom rÃ¡c trong JVM cÃ³ thá»ƒ chia thÃ nh bá»‘n loáº¡i lá»›n: <strong>Bá»™ thu gom rÃ¡c tuáº§n tá»±, bá»™ thu gom rÃ¡c song song, bá»™ thu gom rÃ¡c CMS, vÃ  bá»™ thu gom rÃ¡c G1.</strong></p><h3 id="bo-thu-gom-rac-tuan-tu" tabindex="-1"><a class="header-anchor" href="#bo-thu-gom-rac-tuan-tu"><span>Bá»™ thu gom rÃ¡c tuáº§n tá»±</span></a></h3><p>Bá»™ thu gom rÃ¡c tuáº§n tá»± lÃ  bá»™ thu gom sá»­ dá»¥ng má»™t luá»“ng duy nháº¥t Ä‘á»ƒ thá»±c hiá»‡n thu gom rÃ¡c. VÃ¬ má»—i láº§n thu gom chá»‰ cÃ³ má»™t luá»“ng hoáº¡t Ä‘á»™ng, nÃªn trÃªn cÃ¡c mÃ¡y tÃ­nh cÃ³ kháº£ nÄƒng xá»­ lÃ½ Ä‘á»“ng thá»i yáº¿u, Ä‘áº·c Ä‘iá»ƒm táº­p trung vÃ  Ä‘á»™c quyá»n cá»§a nÃ³ thÆ°á»ng mang láº¡i hiá»‡u suáº¥t tá»‘t hÆ¡n.</p><p>Bá»™ thu gom rÃ¡c tuáº§n tá»± cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng cho cáº£ Young Generation vÃ  Old Generation, tÃ¹y thuá»™c vÃ o khu vá»±c heap mÃ  nÃ³ hoáº¡t Ä‘á»™ng. Dá»±a trÃªn Ä‘Ã³, cÃ³ bá»™ thu gom rÃ¡c tuáº§n tá»± cho Young Generation vÃ  bá»™ thu gom rÃ¡c tuáº§n tá»± cho Old Generation.</p><h4 id="bo-thu-gom-rac-tuan-tu-cho-young-generation" tabindex="-1"><a class="header-anchor" href="#bo-thu-gom-rac-tuan-tu-cho-young-generation"><span>Bá»™ thu gom rÃ¡c tuáº§n tá»± cho Young Generation</span></a></h4><p>Bá»™ thu gom tuáº§n tá»± lÃ  má»™t trong nhá»¯ng bá»™ thu gom rÃ¡c lÃ¢u Ä‘á»i nháº¥t vÃ  cÆ¡ báº£n nháº¥t trong JDK.</p><p>Trong bá»™ thu gom rÃ¡c tuáº§n tá»± cho Young Generation, thuáº­t toÃ¡n sá»­ dá»¥ng lÃ  <strong>thuáº­t toÃ¡n sao chÃ©p</strong>. Khi bá»™ thu gom rÃ¡c tuáº§n tá»± thá»±c hiá»‡n thu gom rÃ¡c, hiá»‡n tÆ°á»£ng Stop-The-World (dá»«ng toÃ n bá»™ cÃ¡c luá»“ng khÃ¡c) sáº½ xáº£y ra, tá»©c lÃ  cÃ¡c luá»“ng khÃ¡c sáº½ bá»‹ táº¡m dá»«ng Ä‘á»ƒ chá» cho viá»‡c thu gom rÃ¡c hoÃ n thÃ nh. Do Ä‘Ã³, trong má»™t sá»‘ trÆ°á»ng há»£p, nÃ³ cÃ³ thá»ƒ gÃ¢y ra tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng kÃ©m.</p><p>Sá»­ dá»¥ng tham sá»‘ <code>-XX:+UseSerialGC</code> cÃ³ thá»ƒ chá»‰ Ä‘á»‹nh sá»­ dá»¥ng cáº£ bá»™ thu gom rÃ¡c tuáº§n tá»± cho Young Generation vÃ  Old Generation. Khi mÃ¡y áº£o cháº¡y á»Ÿ cháº¿ Ä‘á»™ Client, nÃ³ máº·c Ä‘á»‹nh sá»­ dá»¥ng bá»™ thu gom rÃ¡c nÃ y.</p><h4 id="bo-thu-gom-rac-tuan-tu-cho-old-generation" tabindex="-1"><a class="header-anchor" href="#bo-thu-gom-rac-tuan-tu-cho-old-generation"><span>Bá»™ thu gom rÃ¡c tuáº§n tá»± cho Old Generation</span></a></h4><p>Trong bá»™ thu gom rÃ¡c tuáº§n tá»± cho Old Generation, thuáº­t toÃ¡n Ä‘Æ°á»£c sá»­ dá»¥ng lÃ  thuáº­t toÃ¡n Ä‘Ã¡nh dáº¥u nÃ©n. CÅ©ng giá»‘ng nhÆ° bá»™ thu gom rÃ¡c tuáº§n tá»± cho Young Generation, nÃ³ chá»‰ thu gom rÃ¡c theo kiá»ƒu tuáº§n tá»± vÃ  Ä‘á»™c quyá»n, vÃ¬ váº­y thá»i gian dá»«ng Stop-The-World thÆ°á»ng sáº½ kÃ©o dÃ i.</p><p>Tuy nhiÃªn, má»™t lá»£i tháº¿ cá»§a bá»™ thu gom rÃ¡c tuáº§n tá»± cho Old Generation lÃ  nÃ³ cÃ³ thá»ƒ káº¿t há»£p vá»›i nhiá»u bá»™ thu gom rÃ¡c khÃ¡c dÃ nh cho Young Generation. Äá»ƒ kÃ­ch hoáº¡t bá»™ thu gom rÃ¡c tuáº§n tá»± cho Old Generation, báº¡n cÃ³ thá»ƒ thá»­ cÃ¡c tham sá»‘ sau:</p><ul><li><code>-XX:+UseSerialGC</code>: Sá»­ dá»¥ng bá»™ thu gom rÃ¡c tuáº§n tá»± cho cáº£ Young Generation vÃ  Old Generation.</li><li><code>-XX:+UseParNewGC</code>: Young Generation sá»­ dá»¥ng bá»™ thu gom ParNew, Old Generation sá»­ dá»¥ng bá»™ thu gom tuáº§n tá»±.</li><li><code>-XX:+UseParallelGC</code>: Young Generation sá»­ dá»¥ng bá»™ thu gom ParallelGC, Old Generation sá»­ dá»¥ng bá»™ thu gom tuáº§n tá»±.</li></ul><h3 id="bo-thu-gom-rac-song-song" tabindex="-1"><a class="header-anchor" href="#bo-thu-gom-rac-song-song"><span>Bá»™ thu gom rÃ¡c song song</span></a></h3><p>Bá»™ thu gom rÃ¡c song song Ä‘Æ°á»£c cáº£i tiáº¿n tá»« bá»™ thu gom tuáº§n tá»±, sá»­ dá»¥ng nhiá»u luá»“ng Ä‘á»ƒ thá»±c hiá»‡n thu gom rÃ¡c. Äá»‘i vá»›i cÃ¡c mÃ¡y tÃ­nh cÃ³ kháº£ nÄƒng xá»­ lÃ½ Ä‘á»“ng thá»i máº¡nh, nÃ³ cÃ³ thá»ƒ rÃºt ngáº¯n thá»i gian thu gom rÃ¡c hiá»‡u quáº£.</p><p>Dá»±a trÃªn khu vá»±c bá»™ nhá»› mÃ  nÃ³ tÃ¡c Ä‘á»™ng, bá»™ thu gom rÃ¡c song song cÅ©ng cÃ³ ba loáº¡i: bá»™ thu gom ParNew cho Young Generation, bá»™ thu gom ParallelGC cho Young Generation, vÃ  bá»™ thu gom ParallelGC cho Old Generation.</p><h4 id="bo-thu-gom-parnew-cho-young-generation" tabindex="-1"><a class="header-anchor" href="#bo-thu-gom-parnew-cho-young-generation"><span>Bá»™ thu gom ParNew cho Young Generation</span></a></h4><p>Bá»™ thu gom ParNew cho Young Generation hoáº¡t Ä‘á»™ng trong khu vá»±c Young Generation vÃ  thá»±c cháº¥t chá»‰ lÃ  má»™t phiÃªn báº£n Ä‘a luá»“ng cá»§a bá»™ thu gom tuáº§n tá»±. Chiáº¿n lÆ°á»£c thu gom, thuáº­t toÃ¡n vÃ  tham sá»‘ cá»§a nÃ³ giá»‘ng vá»›i bá»™ thu gom tuáº§n tá»± cho Young Generation.</p><p>Bá»™ thu gom ParNew cho Young Generation cÅ©ng sá»­ dá»¥ng thuáº­t toÃ¡n sao chÃ©p vÃ  khi thu gom rÃ¡c, nÃ³ cÅ©ng gÃ¢y ra hiá»‡n tÆ°á»£ng Stop-The-World. Tuy nhiÃªn, vÃ¬ sá»­ dá»¥ng nhiá»u luá»“ng Ä‘á»ƒ thá»±c hiá»‡n thu gom rÃ¡c, trÃªn cÃ¡c CPU cÃ³ kháº£ nÄƒng xá»­ lÃ½ Ä‘á»“ng thá»i máº¡nh, thá»i gian dá»«ng sáº½ ngáº¯n hÆ¡n so vá»›i bá»™ thu gom tuáº§n tá»±.</p><p>Tuy nhiÃªn, trÃªn cÃ¡c há»‡ thá»‘ng cÃ³ kháº£ nÄƒng xá»­ lÃ½ yáº¿u, hiá»‡u suáº¥t cá»§a bá»™ thu gom song song cÃ³ thá»ƒ kÃ©m hÆ¡n do pháº£i chuyá»ƒn Ä‘á»•i giá»¯a cÃ¡c luá»“ng. Äá»ƒ kÃ­ch hoáº¡t bá»™ thu gom ParNew cho Young Generation, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c tham sá»‘ sau:</p><ul><li><code>-XX:+UseParNewGC</code>: Young Generation sá»­ dá»¥ng bá»™ thu gom ParNew, Old Generation sá»­ dá»¥ng bá»™ thu gom tuáº§n tá»±.</li><li><code>-XX:+UseConcMarkSweepGC</code>: Young Generation sá»­ dá»¥ng bá»™ thu gom ParNew, Old Generation sá»­ dá»¥ng CMS.</li><li><code>-XX:ParallelGCThreads</code>: Chá»‰ Ä‘á»‹nh sá»‘ lÆ°á»£ng luá»“ng lÃ m viá»‡c cho bá»™ thu gom ParNew.</li></ul><h4 id="bo-thu-gom-parallelgc-cho-young-generation" tabindex="-1"><a class="header-anchor" href="#bo-thu-gom-parallelgc-cho-young-generation"><span>Bá»™ thu gom ParallelGC cho Young Generation</span></a></h4><p>Bá»™ thu gom ParallelGC cho Young Generation ráº¥t giá»‘ng vá»›i ParNew, cÅ©ng sá»­ dá»¥ng thuáº­t toÃ¡n sao chÃ©p vÃ  lÃ  bá»™ thu gom Ä‘a luá»“ng. NÃ³ cÅ©ng gÃ¢y ra hiá»‡n tÆ°á»£ng Stop-The-World. Tuy nhiÃªn, Ä‘iá»ƒm khÃ¡c biá»‡t lá»›n cá»§a nÃ³ lÃ  ráº¥t chÃº trá»ng Ä‘áº¿n <strong>hiá»‡u suáº¥t thÃ´ng lÆ°á»£ng</strong> cá»§a há»‡ thá»‘ng.</p><p>LÃ½ do bá»™ thu gom ParallelGC chÃº trá»ng Ä‘áº¿n hiá»‡u suáº¥t thÃ´ng lÆ°á»£ng lÃ  vÃ¬ nÃ³ cÃ³ má»™t cÆ¡ cháº¿ Ä‘iá»u chá»‰nh GC tá»± Ä‘á»™ng. Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng tham sá»‘ <code>-XX:+UseAdaptiveSizePolicy</code> Ä‘á»ƒ kÃ­ch hoáº¡t cÆ¡ cháº¿ nÃ y. Khi cháº¿ Ä‘á»™ nÃ y Ä‘Æ°á»£c báº­t, kÃ­ch thÆ°á»›c cá»§a Young Generation, tá»· lá»‡ giá»¯a Eden vÃ  Survivor, vÃ  Ä‘á»™ tuá»•i cá»§a cÃ¡c Ä‘á»‘i tÆ°á»£ng thÄƒng cáº¥p lÃªn Old Generation sáº½ Ä‘Æ°á»£c tá»± Ä‘á»™ng Ä‘iá»u chá»‰nh Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c sá»± cÃ¢n báº±ng giá»¯a kÃ­ch thÆ°á»›c heap, thÃ´ng lÆ°á»£ng, vÃ  thá»i gian dá»«ng.</p><p>Bá»™ thu gom ParallelGC cung cáº¥p hai tham sá»‘ quan trá»ng Ä‘á»ƒ Ä‘iá»u chá»‰nh hiá»‡u suáº¥t thÃ´ng lÆ°á»£ng cá»§a há»‡ thá»‘ng:</p><ul><li><code>-XX:MaxGCPauseMillis</code>: Thiáº¿t láº­p thá»i gian dá»«ng tá»‘i Ä‘a cho thu gom rÃ¡c. Khi bá»™ thu gom ParallelGC hoáº¡t Ä‘á»™ng, nÃ³ sáº½ tá»± Ä‘á»™ng Ä‘iá»u chá»‰nh cÃ¡c tham sá»‘ Ä‘á»ƒ giá»¯ thá»i gian dá»«ng trong pháº¡m vi Ä‘Ã£ thiáº¿t láº­p. Äá»ƒ Ä‘áº¡t Ä‘Æ°á»£c má»¥c tiÃªu nÃ y, cÃ³ thá»ƒ kÃ­ch thÆ°á»›c heap sáº½ bá»‹ giáº£m Ä‘i, dáº«n Ä‘áº¿n viá»‡c GC xáº£y ra thÆ°á»ng xuyÃªn hÆ¡n.</li><li><code>-XX:GCTimeRatio</code>: Thiáº¿t láº­p tá»· lá»‡ thÃ´ng lÆ°á»£ng, lÃ  má»™t sá»‘ nguyÃªn tá»« 0 Ä‘áº¿n 100. Náº¿u giÃ¡ trá»‹ cá»§a GCTimeRatio lÃ  n, há»‡ thá»‘ng sáº½ khÃ´ng tiÃªu tá»‘n quÃ¡ 1/(1+n) thá»i gian Ä‘á»ƒ thu gom rÃ¡c. VÃ­ dá»¥, náº¿u GCTimeRatio cÃ³ giÃ¡ trá»‹ lÃ  19, thá»i gian dÃ nh cho viá»‡c thu gom rÃ¡c sáº½ khÃ´ng vÆ°á»£t quÃ¡ 1/(1+19) = 5%. Máº·c Ä‘á»‹nh, giÃ¡ trá»‹ nÃ y lÃ  99, nghÄ©a lÃ  khÃ´ng quÃ¡ 1% thá»i gian Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thu gom rÃ¡c.</li></ul><p>Äá»ƒ kÃ­ch hoáº¡t bá»™ thu gom ParallelGC cho Young Generation, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c tham sá»‘ sau:</p><ul><li><code>-XX:+UseParallelGC</code>: Young Generation sá»­ dá»¥ng bá»™ thu gom Parallel, Old Generation sá»­ dá»¥ng bá»™ thu gom tuáº§n tá»±.</li><li><code>-XX:+UseParallelOldGC</code>: Young Generation sá»­ dá»¥ng bá»™ thu gom ParallelGC, Old Generation sá»­ dá»¥ng bá»™ thu gom ParallelOldGC.</li></ul><h4 id="bo-thu-gom-rac-paralleloldgc-cho-old-generation" tabindex="-1"><a class="header-anchor" href="#bo-thu-gom-rac-paralleloldgc-cho-old-generation"><span>Bá»™ Thu Gom RÃ¡c ParallelOldGC cho Old Generation</span></a></h4><p>Bá»™ thu gom rÃ¡c ParallelOldGC cho Old Generation cÅ©ng lÃ  má»™t bá»™ thu gom rÃ¡c Ä‘a luá»“ng, tÆ°Æ¡ng tá»± nhÆ° bá»™ thu gom rÃ¡c ParallelGC cho Young Generation, nhÆ°ng táº­p trung vÃ o viá»‡c tá»‘i Æ°u hÃ³a hiá»‡u suáº¥t.</p><p>Bá»™ thu gom ParallelOldGC sá»­ dá»¥ng thuáº­t toÃ¡n Ä‘Ã¡nh dáº¥u vÃ  nÃ©n, vÃ  chá»‰ cÃ³ thá»ƒ sá»­ dá»¥ng trong JDK 1.6. ChÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng tham sá»‘</p><p>-XX:UseParallelOldGC Ä‘á»ƒ kÃ­ch hoáº¡t bá»™ thu gom ParallelGC cho Young Generation vÃ  bá»™ thu gom ParallelOldGC cho Old Generation.</p><p>Tham sá»‘ -XX:ParallelGCThreads cÅ©ng cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thiáº¿t láº­p sá»‘ lÆ°á»£ng luá»“ng khi thu gom rÃ¡c.</p><h3 id="bo-thu-gom-rac-cms" tabindex="-1"><a class="header-anchor" href="#bo-thu-gom-rac-cms"><span>Bá»™ Thu Gom RÃ¡c CMS</span></a></h3><p>KhÃ¡c vá»›i ParallelGC vÃ  ParallelOldGC, bá»™ thu gom rÃ¡c CMS chá»§ yáº¿u táº­p trung vÃ o thá»i gian ngá»«ng há»‡ thá»‘ng. CMS (Concurrent Mark Sweep) lÃ  thuáº­t toÃ¡n thu gom rÃ¡c sá»­ dá»¥ng nhiá»u luá»“ng song song.</p><h4 id="cac-buoc-lam-viec" tabindex="-1"><a class="header-anchor" href="#cac-buoc-lam-viec"><span>CÃ¡c BÆ°á»›c LÃ m Viá»‡c</span></a></h4><p>CÃ¡c bÆ°á»›c chÃ­nh cá»§a CMS bao gá»“m: Ä‘Ã¡nh dáº¥u ban Ä‘áº§u, Ä‘Ã¡nh dáº¥u Ä‘á»“ng thá»i, tiá»n lÃ m sáº¡ch, Ä‘Ã¡nh dáº¥u láº¡i, lÃ m sáº¡ch Ä‘á»“ng thá»i vÃ  nÃ©n Ä‘á»“ng thá»i. Trong Ä‘Ã³, Ä‘Ã¡nh dáº¥u ban Ä‘áº§u vÃ  Ä‘Ã¡nh dáº¥u láº¡i sáº½ chiáº¿m dá»¥ng tÃ i nguyÃªn há»‡ thá»‘ng, cÃ²n cÃ¡c giai Ä‘oáº¡n khÃ¡c cÃ³ thá»ƒ thá»±c thi song song vá»›i cÃ¡c luá»“ng ngÆ°á»i dÃ¹ng.</p><p>Trong suá»‘t quÃ¡ trÃ¬nh thu gom rÃ¡c cá»§a CMS, theo máº·c Ä‘á»‹nh sáº½ cÃ³ hoáº¡t Ä‘á»™ng tiá»n lÃ m sáº¡ch. ChÃºng ta cÃ³ thá»ƒ táº¯t chá»©c nÄƒng nÃ y báº±ng cÃ¡ch sá»­ dá»¥ng tham sá»‘ -XX:-CMSPrecleaningEnabled. Do Ä‘Ã¡nh dáº¥u láº¡i chiáº¿m dá»¥ng CPU, náº¿u má»™t GC Young Generation xáº£y ra ngay sau Ä‘Ã³, thá»i gian ngá»«ng sáº½ ráº¥t dÃ i. Äá»ƒ trÃ¡nh tÃ¬nh huá»‘ng nÃ y, trong quÃ¡ trÃ¬nh tiá»n lÃ m sáº¡ch, CMS sáº½ chá» má»™t láº§n GC Young Generation xáº£y ra trÆ°á»›c khi tiáº¿n hÃ nh lÃ m sáº¡ch.</p><h4 id="cac-tham-so-chinh" tabindex="-1"><a class="header-anchor" href="#cac-tham-so-chinh"><span>CÃ¡c Tham Sá»‘ ChÃ­nh</span></a></h4><p>Äá»ƒ khá»Ÿi Ä‘á»™ng bá»™ thu gom rÃ¡c CMS, chÃºng ta cáº§n sá»­ dá»¥ng tham sá»‘: -XX:+UseConcMarkSweepGC. Sá»‘ lÆ°á»£ng luá»“ng Ä‘á»“ng thá»i cÃ³ thá»ƒ Ä‘Æ°á»£c thiáº¿t láº­p thÃ´ng qua cÃ¡c tham sá»‘ -XX:ConcGCThreads hoáº·c -XX:ParallelCMSThreads.</p><p>NgoÃ i ra, chÃºng ta cÅ©ng cÃ³ thá»ƒ thiáº¿t láº­p tham sá»‘ -XX:CMSInitiatingOccupancyFraction Ä‘á»ƒ chá»‰ Ä‘á»‹nh ngÆ°á»¡ng sá»­ dá»¥ng khÃ´ng gian Old Generation. Khi tá»· lá»‡ sá»­ dá»¥ng khÃ´ng gian Old Generation Ä‘áº¡t ngÆ°á»¡ng nÃ y, má»™t láº§n thu gom CMS sáº½ Ä‘Æ°á»£c thá»±c hiá»‡n, thay vÃ¬ chá» Ä‘áº¿n khi bá»™ nhá»› khÃ´ng Ä‘á»§.</p><p>NhÆ° Ä‘Ã£ Ä‘á» cáº­p trÆ°á»›c Ä‘Ã³, nhÆ°á»£c Ä‘iá»ƒm cá»§a thuáº­t toÃ¡n Ä‘Ã¡nh dáº¥u vÃ  lÃ m sáº¡ch lÃ  gÃ¢y ra phÃ¢n máº£nh bá»™ nhá»›, do Ä‘Ã³, bá»™ thu gom CMS cÃ³ thá»ƒ táº¡o ra nhiá»u phÃ¢n máº£nh bá»™ nhá»›. ChÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng tham sá»‘ -XX:+UseCMSCompactAtFullCollection Ä‘á»ƒ yÃªu cáº§u CMS thá»±c hiá»‡n nÃ©n bá»™ nhá»› sau khi hoÃ n táº¥t thu gom rÃ¡c. Tham sá»‘ -XX:CMSFullGCsBeforeCompaction sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ chá»‰ Ä‘á»‹nh sá»‘ láº§n thu gom CMS trÆ°á»›c khi thá»±c hiá»‡n nÃ©n bá»™ nhá»›.</p><p>Náº¿u muá»‘n sá»­ dá»¥ng CMS Ä‘á»ƒ thu gom vÃ¹ng Perm, chÃºng ta cÃ³ thá»ƒ báº­t tham sá»‘ -XX:+CMSClassUnloadingEnabled. Khi má»Ÿ tham sá»‘ nÃ y, náº¿u Ä‘iá»u kiá»‡n cho phÃ©p, há»‡ thá»‘ng sáº½ sá»­ dá»¥ng cÆ¡ cháº¿ cá»§a CMS Ä‘á»ƒ thu gom dá»¯ liá»‡u Class trong vÃ¹ng Perm.</p><h3 id="bo-thu-gom-rac-g1" tabindex="-1"><a class="header-anchor" href="#bo-thu-gom-rac-g1"><span>Bá»™ Thu Gom RÃ¡c G1</span></a></h3><p>Bá»™ thu gom rÃ¡c G1 lÃ  bá»™ thu gom rÃ¡c hoÃ n toÃ n má»›i Ä‘Æ°á»£c sá»­ dá»¥ng trong JDK 1.7, vá»›i má»¥c tiÃªu dÃ i háº¡n lÃ  thay tháº¿ bá»™ thu gom CMS.</p><p>Bá»™ thu gom G1 sá»Ÿ há»¯u má»™t chiáº¿n lÆ°á»£c thu gom rÃ¡c Ä‘á»™c Ä‘Ã¡o, khÃ¡c biá»‡t vá»›i cÃ¡c bá»™ thu gom rÃ¡c trÆ°á»›c Ä‘Ã³. Vá» máº·t phÃ¢n táº§ng, G1 váº«n thuá»™c loáº¡i thu gom rÃ¡c phÃ¢n táº§ng, nhÆ°ng thay Ä‘á»•i lá»›n nháº¥t cá»§a nÃ³ lÃ  sá»­ dá»¥ng thuáº­t toÃ¡n phÃ¢n vÃ¹ng, cho phÃ©p cÃ¡c khá»‘i bá»™ nhá»› nhÆ° khu vá»±c Eden, From/To Survivor vÃ  Old Generation khÃ´ng cáº§n pháº£i liÃªn tá»¥c.</p><p>TrÆ°á»›c bá»™ thu gom G1, táº¥t cáº£ cÃ¡c bá»™ thu gom rÃ¡c Ä‘á»u yÃªu cáº§u phÃ¢n bá»• bá»™ nhá»› liÃªn tá»¥c.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240926143251.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>Tuy nhiÃªn, trong bá»™ thu gom G1, má»™t khá»‘i lá»›n bá»™ nhá»› Ä‘Æ°á»£c chia thÃ nh nhiá»u khá»‘i nhá», khÃ´ng yÃªu cáº§u bá»™ nhá»› pháº£i liÃªn tá»¥c.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240926143327.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>Má»—i Region Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u lÃ  E, S, O vÃ  H, cho tháº¥y má»—i Region cÃ³ vai trÃ² khÃ¡c nhau trong quÃ¡ trÃ¬nh hoáº¡t Ä‘á»™ng. Táº¥t cáº£ cÃ¡c Region Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u lÃ  E thuá»™c vá» khu vá»±c Eden vÃ  khÃ´ng cáº§n pháº£i liÃªn tá»¥c. TÆ°Æ¡ng tá»±, khu vá»±c Survivor vÃ  Old Generation cÅ©ng váº­y.</p><p>NgoÃ i ra, H Ä‘áº¡i diá»‡n cho Humongous, cho biáº¿t nhá»¯ng Region nÃ y lÆ°u trá»¯ cÃ¡c Ä‘á»‘i tÆ°á»£ng humongous (humongous object). Khi kÃ­ch thÆ°á»›c Ä‘á»‘i tÆ°á»£ng má»›i lá»›n hÆ¡n má»™t ná»­a kÃ­ch thÆ°á»›c cá»§a Region, nÃ³ sáº½ Ä‘Æ°á»£c phÃ¢n bá»• trá»±c tiáº¿p trong má»™t hoáº·c nhiá»u Region liÃªn tá»¥c vÃ  Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u lÃ  H.</p><p>KÃ­ch thÆ°á»›c cá»§a má»™t Region trong bá»™ nhá»› heap cÃ³ thá»ƒ Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh thÃ´ng qua tham sá»‘ -XX:G1HeapRegionSize, vá»›i cÃ¡c kÃ­ch thÆ°á»›c chá»‰ cÃ³ thá»ƒ lÃ  1M, 2M, 4M, 8M, 16M vÃ  32M.</p><h4 id="cac-buoc-lam-viec-1" tabindex="-1"><a class="header-anchor" href="#cac-buoc-lam-viec-1"><span>CÃ¡c BÆ°á»›c LÃ m Viá»‡c</span></a></h4><p>QuÃ¡ trÃ¬nh thu gom cá»§a bá»™ thu gom G1 chá»§ yáº¿u cÃ³ bá»‘n giai Ä‘oáº¡n:</p><ul><li>GC Young Generation</li><li>Chu ká»³ Ä‘Ã¡nh dáº¥u Ä‘á»“ng thá»i</li><li>Thu gom há»—n há»£p</li><li>Náº¿u cáº§n, cÃ³ thá»ƒ thá»±c hiá»‡n Full GC</li></ul><p>GC Young Generation tÆ°Æ¡ng tá»± nhÆ° cÃ¡c bá»™ thu gom khÃ¡c, lÃ  lÃ m sáº¡ch khu vá»±c Eden vÃ  di chuyá»ƒn cÃ¡c Ä‘á»‘i tÆ°á»£ng cÃ²n sá»‘ng sang khu vá»±c Survivor, má»™t sá»‘ Ä‘á»‘i tÆ°á»£ng Ä‘áº¡t tuá»•i sáº½ Ä‘Æ°á»£c di chuyá»ƒn sang Old Generation.</p><p>Chu ká»³ Ä‘Ã¡nh dáº¥u Ä‘á»“ng thá»i Ä‘Æ°á»£c chia thÃ nh cÃ¡c giai Ä‘oáº¡n: Ä‘Ã¡nh dáº¥u ban Ä‘áº§u, quÃ©t khu vá»±c gá»‘c, Ä‘Ã¡nh dáº¥u Ä‘á»“ng thá»i, Ä‘Ã¡nh dáº¥u láº¡i, lÃ m sáº¡ch Ä‘á»™c quyá»n vÃ  lÃ m sáº¡ch Ä‘á»“ng thá»i. Trong Ä‘Ã³, Ä‘Ã¡nh dáº¥u ban Ä‘áº§u, Ä‘Ã¡nh dáº¥u láº¡i vÃ  lÃ m sáº¡ch Ä‘á»™c quyá»n lÃ  Ä‘á»™c quyá»n vÃ  gÃ¢y ra sá»± ngá»«ng láº¡i. Äá»“ng thá»i, Ä‘Ã¡nh dáº¥u ban Ä‘áº§u sáº½ kÃ­ch hoáº¡t má»™t láº§n GC Young Generation.</p><p>Giai Ä‘oáº¡n thu gom há»—n há»£p sáº½ Æ°u tiÃªn thu gom bá»™ nhá»› trong Collection Set, vÃ¬ tá»· lá»‡ rÃ¡c trong Ä‘Ã³ cao hÆ¡n. TÃªn G1 (Garbage First) chÃ­nh lÃ  Ã½ nghÄ©a nÃ y, nghÄ©a lÃ  xá»­ lÃ½ rÃ¡c trÆ°á»›c tiÃªn. Trong giai Ä‘oáº¡n thu gom há»—n há»£p, cÅ©ng sáº½ thá»±c hiá»‡n nhiá»u láº§n GC Young Generation vÃ  GC há»—n há»£p Ä‘á»ƒ tiáº¿n hÃ nh thu gom bá»™ nhá»›.</p><p>Khi cáº§n thiáº¿t, bá»™ thu gom G1 sáº½ thá»±c hiá»‡n Full GC. Khi gáº·p tÃ¬nh huá»‘ng bá»™ nhá»› khÃ´ng Ä‘á»§ trong giai Ä‘oáº¡n thu gom, G1 sáº½ ngá»«ng thu gom rÃ¡c vÃ  thá»±c hiá»‡n má»™t Full GC Ä‘á»ƒ giáº£i phÃ³ng thÃªm khÃ´ng gian.</p><h4 id="tham-so-lien-quan" tabindex="-1"><a class="header-anchor" href="#tham-so-lien-quan"><span>Tham Sá»‘ LiÃªn Quan</span></a></h4><p>Äá»ƒ má»Ÿ bá»™ thu gom G1, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng tham sá»‘: <code>-XX:+UseG1GC</code>.</p><p>Äá»ƒ thiáº¿t láº­p thá»i gian ngá»«ng tá»‘i Ä‘a, cÃ³ thá»ƒ sá»­ dá»¥ng tham sá»‘: -XX:MaxGCPauseMillis.</p><p>Äá»ƒ thiáº¿t láº­p sá»‘ lÆ°á»£ng luá»“ng lÃ m viá»‡c cá»§a GC, cÃ³ thá»ƒ sá»­ dá»¥ng tham sá»‘: -XX:ParallelGCThreads.</p><p>Äá»ƒ thiáº¿t láº­p tá»· lá»‡ sá»­ dá»¥ng heap kÃ­ch hoáº¡t chu ká»³ Ä‘Ã¡nh dáº¥u Ä‘á»“ng thá»i, cÃ³ thá»ƒ sá»­ dá»¥ng tham sá»‘: -XX:InitiatingHeapOccupancyPercent.</p><p>Tá»« bá»™ thu gom rÃ¡c Ä‘Æ¡n luá»“ng ban Ä‘áº§u, Ä‘áº¿n bá»™ thu gom rÃ¡c Ä‘a luá»“ng, bá»™ thu gom rÃ¡c CMS vÃ  cuá»‘i cÃ¹ng lÃ  bá»™ thu gom rÃ¡c G1, cÃ¡c bá»™ thu gom rÃ¡c khÃ´ng ngá»«ng Ä‘Æ°á»£c cáº£i tiáº¿n, nÃ¢ng cao hiá»‡u quáº£ thu gom rÃ¡c. Äáº·c biá»‡t, sau khi tÆ° tÆ°á»Ÿng phÃ¢n vÃ¹ng ra Ä‘á»i, viá»‡c kiá»ƒm soÃ¡t thá»i gian ngá»«ng cá»§a thu gom rÃ¡c trá»Ÿ nÃªn tinh táº¿ hÆ¡n, giÃºp á»©ng dá»¥ng cÃ³ kiá»ƒm soÃ¡t Ä‘á»™ trá»… tá»‘t hÆ¡n, tá»« Ä‘Ã³ mang láº¡i tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng tá»‘t hÆ¡n.</p><h3 id="mot-so-loai-thu-gom-rac" tabindex="-1"><a class="header-anchor" href="#mot-so-loai-thu-gom-rac"><span>Má»™t Sá»‘ Loáº¡i Thu Gom RÃ¡c</span></a></h3><p>ChÃºng ta thÆ°á»ng nghe nhiá»u thuáº­t ngá»¯ liÃªn quan Ä‘áº¿n thu gom rÃ¡c, cháº³ng háº¡n nhÆ°: <strong>Minor GC, Major GC, Young GC, Old GC, Full GC, Stop-The-World</strong>, v.v. NhÆ°ng nhá»¯ng thuáº­t ngá»¯ GC nÃ y thá»±c sá»± cÃ³ Ã½ nghÄ©a gÃ¬ vÃ  sá»± khÃ¡c biá»‡t giá»¯a chÃºng lÃ  gÃ¬? HÃ´m nay chÃºng ta sáº½ cÃ¹ng tÃ¬m hiá»ƒu chi tiáº¿t.</p><h4 id="minor-gc" tabindex="-1"><a class="header-anchor" href="#minor-gc"><span>Minor GC</span></a></h4><p>Viá»‡c thu gom rÃ¡c tá»« khÃ´ng gian Young Generation Ä‘Æ°á»£c gá»i lÃ  Minor GC, Ä‘Ã´i khi cÅ©ng Ä‘Æ°á»£c gá»i lÃ  Young GC. Má»™t sá»‘ Ä‘iá»ƒm báº¡n cáº§n biáº¿t vá» Minor GC:</p><ul><li>Khi JVM khÃ´ng thá»ƒ phÃ¢n bá»• khÃ´ng gian cho má»™t Ä‘á»‘i tÆ°á»£ng má»›i, Minor GC sáº½ Ä‘Æ°á»£c kÃ­ch hoáº¡t, cháº³ng háº¡n khi khu vá»±c Eden Ä‘Ã£ Ä‘áº§y. Do Ä‘Ã³, khu vá»±c Eden cÃ ng nhá», Minor GC sáº½ cÃ ng Ä‘Æ°á»£c thá»±c hiá»‡n thÆ°á»ng xuyÃªn.</li><li>Khi khu vá»±c Eden trong Young Generation Ä‘Æ°á»£c phÃ¢n bá»• Ä‘áº§y, má»™t sá»‘ Ä‘á»‘i tÆ°á»£ng trong Young Generation sáº½ Ä‘Æ°á»£c nÃ¢ng cáº¥p lÃªn Old Generation, vÃ¬ váº­y sau Minor GC, lÆ°á»£ng bá»™ nhá»› sá»­ dá»¥ng trong Old Generation thÆ°á»ng sáº½ tÄƒng lÃªn.</li><li>Cháº¥t váº¥n nháº­n thá»©c thÃ´ng thÆ°á»ng, táº¥t cáº£ cÃ¡c Minor GC Ä‘á»u sáº½ kÃ­ch hoáº¡t Stop-The-World, táº¡m dá»«ng cÃ¡c luá»“ng cá»§a á»©ng dá»¥ng. Äá»‘i vá»›i háº§u háº¿t cÃ¡c á»©ng dá»¥ng, Ä‘á»™ trá»… do táº¡m dá»«ng gÃ¢y ra lÃ  cÃ³ thá»ƒ bá» qua, vÃ¬ pháº§n lá»›n cÃ¡c Ä‘á»‘i tÆ°á»£ng trong khu vá»±c Eden cÃ³ thá»ƒ Ä‘Æ°á»£c coi lÃ  rÃ¡c vÃ  sáº½ khÃ´ng bao giá» Ä‘Æ°á»£c sao chÃ©p sang khu vá»±c Survivor hoáº·c khÃ´ng gian Old Generation. Náº¿u ngÆ°á»£c láº¡i, tá»©c lÃ  pháº§n lá»›n cÃ¡c Ä‘á»‘i tÆ°á»£ng má»›i trong khu vá»±c Eden khÃ´ng Ä‘á»§ Ä‘iá»u kiá»‡n Ä‘á»ƒ thu gom rÃ¡c (tá»©c lÃ  chÃºng khÃ´ng bá»‹ bá»™ thu gom rÃ¡c thu gom), thá»i gian táº¡m dá»«ng khi thá»±c hiá»‡n Minor GC sáº½ lÃ¢u hÆ¡n nhiá»u (bá»Ÿi vÃ¬ JVM pháº£i sao chÃ©p chÃºng sang khu vá»±c Survivor hoáº·c Old Generation).</li></ul><h4 id="major-gc" tabindex="-1"><a class="header-anchor" href="#major-gc"><span>Major GC</span></a></h4><p>Viá»‡c thu gom rÃ¡c tá»« khÃ´ng gian Old Generation Ä‘Æ°á»£c gá»i lÃ  Major GC, Ä‘Ã´i khi cÅ©ng Ä‘Æ°á»£c gá»i lÃ  Old GC.</p><p>Nhiá»u Major GC Ä‘Æ°á»£c kÃ­ch hoáº¡t bá»Ÿi Minor GC, vÃ¬ váº­y trong nhiá»u trÆ°á»ng há»£p, viá»‡c tÃ¡ch biá»‡t hai loáº¡i GC nÃ y lÃ  khÃ´ng kháº£ thi.</p><p>Minor GC tÃ¡c Ä‘á»™ng lÃªn Young Generation, trong khi Major GC tÃ¡c Ä‘á»™ng lÃªn Old Generation. Khi phÃ¢n bá»• bá»™ nhá»› cho Ä‘á»‘i tÆ°á»£ng mÃ  phÃ¡t hiá»‡n bá»™ nhá»› khÃ´ng Ä‘á»§, Minor GC sáº½ Ä‘Æ°á»£c kÃ­ch hoáº¡t. Minor GC sáº½ di chuyá»ƒn cÃ¡c Ä‘á»‘i tÆ°á»£ng vÃ o Old Generation; náº¿u lÃºc nÃ y khÃ´ng gian trong Old Generation khÃ´ng Ä‘á»§, Major GC sáº½ Ä‘Æ°á»£c kÃ­ch hoáº¡t. VÃ¬ lÃ½ do Ä‘Ã³, nhiá»u Major GC lÃ  do Minor GC gÃ¢y ra.</p><h4 id="full-gc" tabindex="-1"><a class="header-anchor" href="#full-gc"><span>Full GC</span></a></h4><p>Full GC lÃ  quÃ¡ trÃ¬nh lÃ m sáº¡ch toÃ n bá»™ khÃ´ng gian heap â€” bao gá»“m Young Generation, Old Generation vÃ  PermGen (náº¿u cÃ³). Do Ä‘Ã³, cÃ³ thá»ƒ nÃ³i Full GC lÃ  sá»± káº¿t há»£p cá»§a Minor GC vÃ  Major GC.</p><p>Khi chuáº©n bá»‹ kÃ­ch hoáº¡t má»™t Minor GC, náº¿u phÃ¡t hiá»‡n khÃ´ng gian cÃ²n láº¡i trong Young Generation nhá» hÆ¡n khÃ´ng gian Ä‘Ã£ nÃ¢ng cáº¥p trÆ°á»›c Ä‘Ã³, thÃ¬ sáº½ khÃ´ng kÃ­ch hoáº¡t Minor GC mÃ  sáº½ chuyá»ƒn sang kÃ­ch hoáº¡t Full GC. VÃ¬ lÃºc nÃ y JVM cho ráº±ng: khi khÃ´ng gian Ä‘á»§ lá»›n, Ä‘Ã£ cÃ³ Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c nÃ¢ng cáº¥p, vÃ  bÃ¢y giá» khÃ´ng gian cÃ²n láº¡i nhá» hÆ¡n, thÃ¬ ráº¥t cÃ³ kháº£ nÄƒng sáº½ cÃ³ Ä‘á»‘i tÆ°á»£ng nÃ¢ng cáº¥p. VÃ¬ váº­y, JVM sáº½ trá»±c tiáº¿p thá»±c hiá»‡n má»™t Full GC Ä‘á»ƒ sáº¯p xáº¿p láº¡i khÃ´ng gian trong Old Generation vÃ  Young Generation.</p><p>NgoÃ i ra, náº¿u khÃ´ng gian phÃ¢n bá»• trong PermGen khÃ´ng Ä‘á»§, Full GC cÅ©ng sáº½ Ä‘Æ°á»£c kÃ­ch hoáº¡t.</p><h4 id="stop-the-world" tabindex="-1"><a class="header-anchor" href="#stop-the-world"><span>Stop-The-World</span></a></h4><p>Stop-The-World, thÆ°á»ng Ä‘Æ°á»£c dá»‹ch sang tiáº¿ng Viá»‡t lÃ  &quot;táº¥t cáº£ dá»«ng láº¡i&quot;, chá»‰ viá»‡c trong quÃ¡ trÃ¬nh thu gom rÃ¡c, vÃ¬ nhu cáº§u Ä‘Ã¡nh dáº¥u hoáº·c lÃ m sáº¡ch, táº¥t cáº£ cÃ¡c luá»“ng thá»±c thi nhiá»‡m vá»¥ pháº£i dá»«ng láº¡i Ä‘á»ƒ cho phÃ©p luá»“ng thu gom rÃ¡c thu gom rÃ¡c trong khoáº£ng thá»i gian Ä‘Ã³.</p><p>Trong thá»i gian Stop-The-World, táº¥t cáº£ cÃ¡c luá»“ng khÃ´ng thá»±c hiá»‡n thu gom rÃ¡c Ä‘á»u khÃ´ng thá»ƒ hoáº¡t Ä‘á»™ng vÃ  Ä‘á»u bá»‹ táº¡m dá»«ng. Chá»‰ khi luá»“ng thu gom rÃ¡c hoÃ n thÃ nh cÃ´ng viá»‡c cá»§a mÃ¬nh thÃ¬ cÃ¡c luá»“ng khÃ¡c má»›i cÃ³ thá»ƒ tiáº¿p tá»¥c lÃ m viá»‡c. CÃ³ thá»ƒ tháº¥y, Ä‘á»™ dÃ i thá»i gian Stop-The-World sáº½ liÃªn quan Ä‘áº¿n thá»i gian pháº£n há»“i cá»§a á»©ng dá»¥ng, vÃ¬ váº­y thá»i gian Stop-The-World trong quÃ¡ trÃ¬nh GC lÃ  má»™t chá»‰ sá»‘ ráº¥t quan trá»ng.</p><h2 id="ban-Ä‘a-tung-toi-uu-hoa-jvm-chua-hay-chia-se-y-tuong-toi-uu-cua-ban" tabindex="-1"><a class="header-anchor" href="#ban-Ä‘a-tung-toi-uu-hoa-jvm-chua-hay-chia-se-y-tuong-toi-uu-cua-ban"><span>Báº¡n Ä‘Ã£ tá»«ng tá»‘i Æ°u hÃ³a JVM chÆ°a, hÃ£y chia sáº» Ã½ tÆ°á»Ÿng tá»‘i Æ°u cá»§a báº¡n?</span></a></h2><p><strong>Táº¡i sao cáº§n tá»‘i Æ°u hÃ³a</strong></p><ul><li>NgÄƒn ngá»«a xuáº¥t hiá»‡n lá»—i OOM (Out of Memory)</li><li>Giáº£i quyáº¿t lá»—i OOM</li><li>Giáº£m táº§n suáº¥t xuáº¥t hiá»‡n cá»§a Full GC</li></ul><p>TrÆ°á»›c Ä‘Ã¢y, chÃºng ta Ä‘Ã£ Ä‘á» cáº­p Ä‘áº¿n nhiá»u kiáº¿n thá»©c cÆ¡ báº£n vá» JVM, vÃ  bÃ¢y giá» chÃºng ta Ä‘Ã£ Ä‘áº¿n vá»›i chá»§ Ä‘á» tá»‘i Æ°u hÃ³a JVM. Tá»‘i Æ°u hÃ³a JVM lÃ  má»™t phÆ°Æ¡ng tiá»‡n, nhÆ°ng khÃ´ng pháº£i táº¥t cáº£ cÃ¡c váº¥n Ä‘á» Ä‘á»u cÃ³ thá»ƒ Ä‘Æ°á»£c giáº£i quyáº¿t thÃ´ng qua viá»‡c tá»‘i Æ°u hÃ³a JVM. VÃ¬ váº­y, khi thá»±c hiá»‡n tá»‘i Æ°u hÃ³a JVM, chÃºng ta cáº§n tuÃ¢n thá»§ má»™t sá»‘ nguyÃªn táº¯c:</p><ul><li>Háº§u háº¿t cÃ¡c á»©ng dá»¥ng Java khÃ´ng cáº§n tá»‘i Æ°u hÃ³a JVM;</li><li>Háº§u háº¿t nguyÃªn nhÃ¢n gÃ¢y ra váº¥n Ä‘á» GC lÃ  do váº¥n Ä‘á» á»Ÿ mÃ£ nguá»“n (mÃ£ nguá»“n);</li><li><s>TrÆ°á»›c khi Ä‘Æ°a vÃ o sáº£n xuáº¥t, nÃªn cÃ¢n nháº¯c thiáº¿t láº­p cÃ¡c tham sá»‘ JVM cá»§a mÃ¡y Ä‘áº¿n má»©c tá»‘i Æ°u;</s></li><li>Giáº£m sá»‘ lÆ°á»£ng Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c táº¡o ra (mÃ£ nguá»“n);</li><li>Giáº£m viá»‡c sá»­ dá»¥ng biáº¿n toÃ n cá»¥c vÃ  Ä‘á»‘i tÆ°á»£ng lá»›n (mÃ£ nguá»“n);</li><li>Æ¯u tiÃªn tá»‘i Æ°u hÃ³a kiáº¿n trÃºc vÃ  mÃ£ nguá»“n, tá»‘i Æ°u hÃ³a JVM lÃ  phÆ°Æ¡ng tiá»‡n cuá»‘i cÃ¹ng (mÃ£ nguá»“n, kiáº¿n trÃºc);</li><li>PhÃ¢n tÃ­ch tÃ¬nh hÃ¬nh GC Ä‘á»ƒ tá»‘i Æ°u hÃ³a mÃ£ nguá»“n tá»‘t hÆ¡n so vá»›i tá»‘i Æ°u hÃ³a tham sá»‘ JVM (mÃ£ nguá»“n);</li></ul><p>ThÃ´ng qua cÃ¡c nguyÃªn táº¯c trÃªn, chÃºng ta nháº­n tháº¥y ráº±ng phÆ°Æ¡ng phÃ¡p tá»‘i Æ°u hÃ³a hiá»‡u quáº£ nháº¥t thá»±c sá»± lÃ  tá»‘i Æ°u hÃ³a á»Ÿ cáº¥p Ä‘á»™ kiáº¿n trÃºc vÃ  mÃ£ nguá»“n, trong khi tá»‘i Æ°u hÃ³a JVM lÃ  phÆ°Æ¡ng phÃ¡p cuá»‘i cÃ¹ng, cÃ³ thá»ƒ nÃ³i lÃ  sá»± â€œváº¯t kiá»‡tâ€ cuá»‘i cÃ¹ng cá»§a cáº¥u hÃ¬nh mÃ¡y chá»§. Tiáº¿p theo, chÃºng ta sáº½ xem cÃ¡ch thá»±c hiá»‡n tá»‘i Æ°u hÃ³a JVM. Tá»‘i Æ°u hÃ³a khÃ´ng pháº£i lÃ  hÃ nh Ä‘á»™ng mÃ¹ quÃ¡ng; má»—i khi chÃºng ta thay Ä‘á»•i má»™t tham sá»‘ JVM, Ä‘á»u cÃ³ lÃ½ do vÃ  dá»¯ liá»‡u há»— trá»£ Ä‘á»©ng sau. DÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡c bÆ°á»›c tá»‘i Æ°u hÃ³a JVM khÃ¡ chung â¬‡ï¸</p><h3 id="cac-buoc-toi-uu-hoa-jvm-chung-la" tabindex="-1"><a class="header-anchor" href="#cac-buoc-toi-uu-hoa-jvm-chung-la"><span>CÃ¡c bÆ°á»›c tá»‘i Æ°u hÃ³a JVM chung lÃ :</span></a></h3><ul><li>BÆ°á»›c 1: PhÃ¢n tÃ­ch nháº­t kÃ½ GC vÃ  cÃ¡c tá»‡p dump, xÃ¡c Ä‘á»‹nh xem cÃ³ cáº§n tá»‘i Æ°u hÃ³a hay khÃ´ng, xÃ¡c Ä‘á»‹nh Ä‘iá»ƒm ngháº½n váº¥n Ä‘á»;</li><li>BÆ°á»›c 2: XÃ¡c Ä‘á»‹nh má»¥c tiÃªu Ä‘á»‹nh lÆ°á»£ng tá»‘i Æ°u hÃ³a JVM;</li><li>BÆ°á»›c 3: XÃ¡c Ä‘á»‹nh cÃ¡c tham sá»‘ tá»‘i Æ°u hÃ³a JVM (dá»±a trÃªn cÃ¡c tham sá»‘ JVM lá»‹ch sá»­ Ä‘á»ƒ Ä‘iá»u chá»‰nh);</li><li>BÆ°á»›c 4: Tá»‘i Æ°u hÃ³a má»™t mÃ¡y chá»§, so sÃ¡nh vÃ  quan sÃ¡t sá»± khÃ¡c biá»‡t trÆ°á»›c vÃ  sau khi tá»‘i Æ°u hÃ³a;</li><li>BÆ°á»›c 5: PhÃ¢n tÃ­ch vÃ  Ä‘iá»u chá»‰nh liÃªn tá»¥c cho Ä‘áº¿n khi tÃ¬m Ä‘Æ°á»£c cáº¥u hÃ¬nh tham sá»‘ JVM phÃ¹ há»£p;</li><li>BÆ°á»›c 6: TÃ¬m tham sá»‘ phÃ¹ há»£p nháº¥t, Ã¡p dá»¥ng nhá»¯ng tham sá»‘ nÃ y cho táº¥t cáº£ cÃ¡c mÃ¡y chá»§ vÃ  tiáº¿n hÃ nh theo dÃµi sau Ä‘Ã³.</li></ul><h3 id="phan-tich-nhat-ky-gc-va-cac-tep-dump-xac-Ä‘inh-xem-co-can-toi-uu-hoa-hay-khong-xac-Ä‘inh-Ä‘iem-nghen-van-Ä‘e" tabindex="-1"><a class="header-anchor" href="#phan-tich-nhat-ky-gc-va-cac-tep-dump-xac-Ä‘inh-xem-co-can-toi-uu-hoa-hay-khong-xac-Ä‘inh-Ä‘iem-nghen-van-Ä‘e"><span>PhÃ¢n tÃ­ch nháº­t kÃ½ GC vÃ  cÃ¡c tá»‡p dump, xÃ¡c Ä‘á»‹nh xem cÃ³ cáº§n tá»‘i Æ°u hÃ³a hay khÃ´ng, xÃ¡c Ä‘á»‹nh Ä‘iá»ƒm ngháº½n váº¥n Ä‘á»</span></a></h3><p>NhÆ° Ä‘Ã£ Ä‘á» cáº­p trÆ°á»›c Ä‘Ã³, má»—i thay Ä‘á»•i tham sá»‘ Ä‘á»u cÃ³ dá»¯ liá»‡u há»— trá»£ Ä‘á»©ng sau. Váº­y dá»¯ liá»‡u Ä‘áº¿n tá»« Ä‘Ã¢u? ÄÃ³ chÃ­nh lÃ  tá»« viá»‡c phÃ¢n tÃ­ch nháº­t kÃ½ <code>GC</code> vÃ  cÃ¡c tá»‡p <code>dump</code>. Trong pháº§n nÃ y, chÃºng ta sáº½ cÃ¹ng tháº£o luáº­n chi tiáº¿t vá» cÃ¡c cÃ´ng cá»¥ Ä‘á»ƒ xem nháº­t kÃ½ GC vÃ  tá»‡p dump, cÅ©ng nhÆ° cÃ¡ch phÃ¢n tÃ­ch chÃºng Ä‘á»ƒ tÃ¬m ra nguyÃªn nhÃ¢n váº¥n Ä‘á».</p><h4 id="phan-tich-nhat-ky-gc" tabindex="-1"><a class="header-anchor" href="#phan-tich-nhat-ky-gc"><span>PhÃ¢n tÃ­ch nháº­t kÃ½ GC</span></a></h4><p>TrÆ°á»›c tiÃªn, chÃºng ta hÃ£y xem xÃ©t phÃ¢n tÃ­ch nháº­t kÃ½ GC. CÃ³ thá»ƒ nhiá»u báº¡n chÆ°a tá»«ng tháº¥y nháº­t kÃ½ GC, nhÆ°ng nháº­t kÃ½ nÃ y ghi láº¡i tÃ¬nh tráº¡ng hoáº¡t Ä‘á»™ng cá»§a bá»™ thu gom rÃ¡c (garbage collector), bao gá»“m lÃ½ do thu gom rÃ¡c, thá»i gian, luá»“ng thá»±c thi, khÃ´ng gian bá»™ nhá»› Ä‘Æ°á»£c thu há»“i, vÃ  nhiá»u thÃ´ng tin khÃ¡c. NÃ³ chá»§ yáº¿u Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ phÃ¢n tÃ­ch hiá»‡u suáº¥t cá»§a bá»™ thu gom rÃ¡c vÃ  tá»‘i Æ°u hÃ³a. á» Ä‘Ã¢y, chÃºng ta sáº½ tÃ¬m hiá»ƒu cÃ¡ch mÃ  dá»± Ã¡n cá»§a chÃºng ta cÃ³ thá»ƒ láº¥y Ä‘Æ°á»£c nháº­t kÃ½ GC, sau Ä‘Ã³ sáº½ tháº£o luáº­n vá» cÃ¡c cÃ´ng cá»¥ vÃ  phÆ°Æ¡ng phÃ¡p phÃ¢n tÃ­ch. ChÃºng ta sáº½ Ä‘á» cáº­p Ä‘áº¿n cÃ¡c chÆ°Æ¡ng trÃ¬nh Java, dá»± Ã¡n Tomcat, vÃ  dá»± Ã¡n Spring Boot.</p><p><strong>ChÆ°Æ¡ng trÃ¬nh Java</strong></p><p>ChÆ°Æ¡ng trÃ¬nh Java cÃ³ thá»ƒ kÃ­ch hoáº¡t viá»‡c ghi nháº­t kÃ½ GC báº±ng cÃ¡ch thÃªm cÃ¡c tham sá»‘ thÃ­ch há»£p vÃ o tham sá»‘ khá»Ÿi Ä‘á»™ng. Cá»¥ thá»ƒ, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c tham sá»‘ sau:</p><ul><li>-XX:+PrintGC: Báº­t ghi nháº­t kÃ½ GC;</li><li>-XX:+PrintGCDetails: Xuáº¥t thÃ´ng tin chi tiáº¿t trong nháº­t kÃ½ GC;</li><li>-XX:+PrintGCDateStamps: Xuáº¥t dáº¥u thá»i gian trong nháº­t kÃ½ GC;</li><li>-Xlog:gc+heap=trace: Xuáº¥t thÃ´ng tin chi tiáº¿t vá» heap trÆ°á»›c vÃ  sau khi GC;</li><li>-Xlog:gc:&lt;tÃªn_tá»‡p&gt;: Ghi nháº­t kÃ½ GC vÃ o tá»‡p chá»‰ Ä‘á»‹nh.</li></ul><p>Dá»±a trÃªn phiÃªn báº£n Java 17:</p><p>VÃ­ dá»¥, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng lá»‡nh sau Ä‘á»ƒ khá»Ÿi Ä‘á»™ng chÆ°Æ¡ng trÃ¬nh Java vÃ  xuáº¥t nháº­t kÃ½ GC vÃ o tá»‡p gc.log:</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">-Xms5M</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> -Xmx5M</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> -Xlog:gc:/Users/a123/IdeaProjects/java-example/logs/gc.log</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> -XX:+PrintGC</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> -Xlog:gc+heap=trace</span></span></code></pre></div><p>Trong quÃ¡ trÃ¬nh cháº¡y chÆ°Æ¡ng trÃ¬nh, nháº­t kÃ½ GC sáº½ Ä‘Æ°á»£c ghi vÃ o tá»‡p chá»‰ Ä‘á»‹nh, vÃ  báº¡n cÃ³ thá»ƒ phÃ¢n tÃ­ch nháº­t kÃ½ Ä‘á»ƒ hiá»ƒu tÃ¬nh tráº¡ng thu gom rÃ¡c, tá»« Ä‘Ã³ tiáº¿n hÃ nh tá»‘i Æ°u hÃ³a.</p><p><strong>Tomcat</strong></p><p>Äá»‘i vá»›i dá»± Ã¡n Tomcat, báº¡n cÃ³ thá»ƒ thÃªm cÃ¡c tham sá»‘ tÆ°Æ¡ng á»©ng vÃ o biáº¿n JAVA_OPTS trong táº­p lá»‡nh khá»Ÿi Ä‘á»™ng Tomcat Ä‘á»ƒ báº­t ghi nháº­t kÃ½ GC. Cá»¥ thá»ƒ, báº¡n cÃ³ thá»ƒ chá»‰nh sá»­a tá»‡p <a href="http://catalina.sh" target="_blank" rel="noopener noreferrer">catalina.sh</a> hoáº·c catalina.bat (trÃªn Windows) vÃ  thÃªm cÃ¡c tham sá»‘ sau:</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">JAVA_OPTS</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;-Xloggc:/path/to/gc.log -XX:+PrintGC -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:+PrintHeapAtGC&quot;</span></span></code></pre></div><p>Trong Ä‘Ã³, /path/to/gc.log lÃ  Ä‘Æ°á»ng dáº«n Ä‘áº¿n tá»‡p nháº­t kÃ½ xuáº¥t.</p><p><strong>Spring Boot</strong></p><p>Äá»‘i vá»›i dá»± Ã¡n Spring Boot, báº¡n cÃ³ thá»ƒ thÃªm cÃ¡c tham sá»‘ sau vÃ o tá»‡p cáº¥u hÃ¬nh application.properties hoáº·c application.yml:</p><div class="language-properties" data-highlighter="shiki" data-ext="properties" data-title="properties" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">logging.file</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">gc.log</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">logging.level.gc</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">info</span></span></code></pre></div><p>Trong Ä‘Ã³, logging.file chá»‰ Ä‘á»‹nh tÃªn tá»‡p nháº­t kÃ½, logging.level.gc chá»‰ Ä‘á»‹nh má»©c Ä‘á»™ ghi nháº­t kÃ½, á»Ÿ Ä‘Ã¢y Ä‘áº·t lÃ  info Ä‘á»ƒ xuáº¥t nháº­t kÃ½ GC.</p><p>Cáº§n lÆ°u Ã½ ráº±ng, cÃ¡c phiÃªn báº£n khÃ¡c nhau cá»§a Tomcat vÃ  Spring Boot cÃ³ thá»ƒ cÃ³ sá»± khÃ¡c biá»‡t, do Ä‘Ã³ cÃ¡ch thÃªm tham sá»‘ cá»¥ thá»ƒ cÃ³ thá»ƒ khÃ¡c nhau. Trong quÃ¡ trÃ¬nh sá»­ dá»¥ng, báº¡n nÃªn tham kháº£o tÃ i liá»‡u hoáº·c hÆ°á»›ng dáº«n cá»§a phiÃªn báº£n tÆ°Æ¡ng á»©ng Ä‘á»ƒ biáº¿t cÃ¡ch Ä‘Ãºng nháº¥t Ä‘á»ƒ kÃ­ch hoáº¡t ghi nháº­t kÃ½ GC.</p><p>ChÃºng ta cÃ¹ng xem má»™t vÃ­ dá»¥ vá» nháº­t kÃ½ GC:</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[2023-02-14T22:13:12.554+0800] -XX:+PrintGC is deprecated. Will use -Xlog:gc instead.</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[2023-02-14T22:13:12.557+0800] Using G1</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[2023-02-14T22:13:12.593+0800] GC(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">0</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) Pause Young (</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">Normal</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) (</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">G1</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> Evacuation</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> Pause</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) 3M-&gt;3M(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">8M</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) 1.720ms</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[2023-02-14T22:13:12.596+0800] GC(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) Pause Young (</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">Concurrent</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> Start</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) (</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">G1</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> Preventive</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> Collection</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) 4M-&gt;3M(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">8M</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) 1.533ms</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[2023-02-14T22:13:12.596+0800] GC(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) Concurrent Mark Cycle</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[2023-02-14T22:13:12.598+0800] GC(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">3</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) Pause Young (</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">Normal</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) (</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">G1</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> Preventive</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> Collection</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) 4M-&gt;4M(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">8M</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) 1.069ms</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[2023-02-14T22:13:12.601+0800] GC(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">4</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) To-space exhausted</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[2023-02-14T22:13:12.601+0800] GC(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">4</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) Pause Young (</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">Normal</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) (</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">G1</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> Preventive</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> Collection</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) 5M-&gt;5M(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">8M</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) 2.454ms</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[2023-02-14T22:13:12.606+0800] GC(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">5</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) To-space exhausted</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[2023-02-14T22:13:12.606+0800] GC(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">5</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) Pause Young (</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">Normal</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) (</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">G1</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> Evacuation</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> Pause</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) 6M-&gt;6M(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">8M</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) 4.494ms</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[2023-02-14T22:13:12.617+0800] GC(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">6</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) Pause Full (</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">G1</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> Compaction</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> Pause</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) 6M-&gt;6M(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">8M</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) 10.797ms</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[2023-02-14T22:13:12.627+0800] GC(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">7</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) Pause Full (</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">G1</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> Compaction</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> Pause</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) 6M-&gt;6M(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">8M</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) 10.258ms</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[2023-02-14T22:13:12.627+0800] GC(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) Concurrent Mark Cycle 31.610ms</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[2023-02-14T22:13:12.628+0800] GC(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">8</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) Pause Young (</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">Normal</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) (</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">G1</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> Evacuation</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> Pause</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) 6M-&gt;6M(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">8M</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) 0.243ms</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[2023-02-14T22:13:12.636+0800] GC(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">9</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) Pause Full (</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">G1</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> Compaction</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> Pause</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) 6M-&gt;6M(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">8M</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) 8.079ms</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[2023-02-14T22:13:12.646+0800] GC(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">10</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) Pause Full (</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">G1</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> Compaction</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> Pause</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) 6M-&gt;6M(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">8M</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) 10.570ms</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[2023-02-14T22:13:12.647+0800] GC(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">11</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) Pause Young (</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">Concurrent</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> Start</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) (</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">G1</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> Evacuation</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> Pause</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) 6M-&gt;6M(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">8M</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) 0.307ms</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[2023-02-14T22:13:12.647+0800] GC(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">13</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) Concurrent Mark Cycle</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[2023-02-14T22:13:12.648+0800] GC(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">12</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) Pause Full (</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">G1</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> Compaction</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> Pause</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) 6M-&gt;1M(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">8M</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) 1.330ms</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[2023-02-14T22:13:12.648+0800] GC(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">13</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) Concurrent Mark Cycle 1.388ms</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Nháº­t kÃ½ cÃ³ thá»ƒ nhÃ¬n khÃ´ng trá»±c quan vÃ  hÆ¡i khÃ³ khÄƒn Ä‘á»ƒ phÃ¢n tÃ­ch. Thá»±c táº¿, cÃ³ nhiá»u cÃ´ng cá»¥ trá»±c quan hÃ³a Ä‘á»ƒ phÃ¢n tÃ­ch nháº­t kÃ½ GC, dÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ cÃ´ng cá»¥ tiÃªu biá»ƒu:</p><ul><li>GCViewer: Chá»©c nÄƒng Ä‘Æ¡n giáº£n, dá»… sá»­ dá»¥ng, phÃ¹ há»£p cho ngÆ°á»i má»›i báº¯t Ä‘áº§u.</li><li>GCEasy: Tá»± Ä‘á»™ng phÃ¡t hiá»‡n nháº­t kÃ½ GC vÃ  cung cáº¥p má»™t loáº¡t bÃ¡o cÃ¡o vÃ  gá»£i Ã½, phÃ¹ há»£p Ä‘á»ƒ nhanh chÃ³ng xÃ¡c Ä‘á»‹nh vÃ  giáº£i quyáº¿t cÃ¡c váº¥n Ä‘á» vá» GC.</li><li>HPROF: CÃ´ng cá»¥ phÃ¢n tÃ­ch bá»™ nhá»› heap Ä‘i kÃ¨m vá»›i Java, cÃ³ thá»ƒ káº¿t há»£p vá»›i cÃ¡c cÃ´ng cá»¥ nhÆ° GCViewer Ä‘á»ƒ cung cáº¥p phÃ¢n tÃ­ch toÃ n diá»‡n hÆ¡n.</li><li>Java Mission Control: CÃ´ng cá»¥ giÃ¡m sÃ¡t hiá»‡u suáº¥t Ä‘i kÃ¨m vá»›i JDK, cung cáº¥p nhiá»u chá»‰ sá»‘ giÃ¡m sÃ¡t, bao gá»“m GC, vÃ  cÃ³ thá»ƒ tÃ­ch há»£p vá»›i VisualVM.</li><li>VisualVM: Chá»©c nÄƒng toÃ n diá»‡n, nhiá»u plugin, há»— trá»£ nhiá»u chá»‰ sá»‘ giÃ¡m sÃ¡t vÃ  phÆ°Æ¡ng phÃ¡p phÃ¢n tÃ­ch, phÃ¹ há»£p cho ngÆ°á»i dÃ¹ng nÃ¢ng cao vÃ  chuyÃªn gia.</li><li>GClogAnalyzer: Cung cáº¥p nhiá»u biá»ƒu Ä‘á»“ vÃ  cÃ´ng cá»¥ phÃ¢n tÃ­ch, cÃ³ kháº£ nÄƒng phÃ¢n tÃ­ch sÃ¢u vá» nhiá»u khÃ­a cáº¡nh cá»§a nháº­t kÃ½ GC.</li><li>YourKit Java Profiler: Chá»©c nÄƒng phong phÃº, dá»… sá»­ dá»¥ng, cung cáº¥p phÃ¢n tÃ­ch GC, CPU, bá»™ nhá»›, vÃ  nhiá»u chá»©c nÄƒng khÃ¡c, phÃ¹ há»£p cho chuyÃªn gia.</li><li>JProfiler: Cung cáº¥p nhiá»u cÃ´ng cá»¥ phÃ¢n tÃ­ch hiá»‡u suáº¥t vÃ  gá»¡ lá»—i, bao gá»“m phÃ¢n tÃ­ch GC, CPU, bá»™ nhá»›, phÃ¹ há»£p cho chuyÃªn gia.</li></ul><p>Báº¡n cÃ³ thá»ƒ chá»n cÃ´ng cá»¥ theo sá»Ÿ thÃ­ch vÃ  thÃ³i quen cá»§a mÃ¬nh. Äá»“ng thá»i, JDK cÅ©ng cung cáº¥p nhiá»u bá»™ cÃ´ng cá»¥ tá»‘i Æ°u hÃ³a JVM, cÃ³ thá»ƒ tÃ¬m tháº¥y trong thÆ° má»¥c bin cá»§a gÃ³i cÃ i Ä‘áº·t. DÆ°á»›i Ä‘Ã¢y lÃ  vÃ­ dá»¥ trÃªn mÃ¡y tÃ­nh cá»§a tÃ´i:</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">/Library/Java/JavaVirtualMachines/jdk-17.0.5.jdk/Contents/Home/bin</span></span></code></pre></div><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/8380143/1676384465582-a78d9deb-02bd-48ff-acef-1b793ad8fc14.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/8380143/1676428403161-5343ed7a-03c1-4615-958a-5437567f8bc7.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/8380143/1676428420180-92b5abf8-95dc-41a1-a892-2293b467c0f6.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/8380143/1676428559138-e2f84021-9997-4e17-aedd-135315bae9cd.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>PhÃ¢n tÃ­ch nháº­t kÃ½ GC</strong></p><p>CÃ¡ch tá»‘t nháº¥t Ä‘á»ƒ phÃ¢n tÃ­ch nháº­t kÃ½ GC lÃ  sá»­ dá»¥ng cÃ¡c cÃ´ng cá»¥ phÃ¢n tÃ­ch Ä‘Ã£ Ä‘á» cáº­p á»Ÿ trÃªn. ChÃºng cÃ³ thá»ƒ giÃºp báº¡n trá»±c quan hÃ³a, hiá»ƒn thá»‹ vÃ  cung cáº¥p nhiá»u thÃ´ng tin chi tiáº¿t cáº§n thiáº¿t cho viá»‡c tá»‘i Æ°u hÃ³a hiá»‡u suáº¥t. Má»™t sá»‘ thÃ´ng sá»‘ quan trá»ng mÃ  báº¡n cÃ³ thá»ƒ quan tÃ¢m bao gá»“m:</p><ul><li><strong>Time</strong>: Thá»i gian tiÃªu tá»‘n cho tá»«ng loáº¡i GC;</li><li><strong>Pause</strong>: Thá»i gian táº¡m dá»«ng cá»§a cÃ¡c luá»“ng trong quÃ¡ trÃ¬nh GC;</li><li><strong>Heap usage</strong>: Sá»­ dá»¥ng bá»™ nhá»› heap trÆ°á»›c vÃ  sau khi GC;</li><li><strong>GC Frequency</strong>: Táº§n suáº¥t gá»i GC;</li><li><strong>Survivor Space</strong>: ThÃ´ng tin vá» bá»™ nhá»› survivor.</li></ul><p>CÃ¹ng vá»›i viá»‡c phÃ¢n tÃ­ch nháº­t kÃ½ GC, báº¡n cÅ©ng cÃ³ thá»ƒ theo dÃµi chá»‰ sá»‘ hiá»‡u suáº¥t khÃ¡c nhau trong mÃ£ nguá»“n hoáº·c trong quÃ¡ trÃ¬nh sáº£n xuáº¥t Ä‘á»ƒ tá»‘i Æ°u hÃ³a á»©ng dá»¥ng vÃ  cáº£i thiá»‡n hiá»‡u suáº¥t. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ hÆ°á»›ng dáº«n tá»‘i Æ°u hÃ³a mÃ  báº¡n cÃ³ thá»ƒ tham kháº£o:</p><ol><li><p><strong>Tá»‘i Æ°u hÃ³a sá»­ dá»¥ng bá»™ nhá»›</strong>: Thay vÃ¬ táº¡o Ä‘á»‘i tÆ°á»£ng má»›i, cá»‘ gáº¯ng sá»­ dá»¥ng láº¡i Ä‘á»‘i tÆ°á»£ng cÃ³ sáºµn. Äiá»u nÃ y sáº½ giáº£m thiá»ƒu viá»‡c thu gom rÃ¡c vÃ  tÄƒng hiá»‡u suáº¥t.</p></li><li><p><strong>Giáº£m thiá»ƒu viá»‡c táº¡o cÃ¡c Ä‘á»‘i tÆ°á»£ng lá»›n</strong>: Cá»‘ gáº¯ng chia nhá» cÃ¡c Ä‘á»‘i tÆ°á»£ng lá»›n thÃ nh nhiá»u Ä‘á»‘i tÆ°á»£ng nhá», giÃºp viá»‡c thu gom rÃ¡c hiá»‡u quáº£ hÆ¡n.</p></li><li><p><strong>Chá»n GC há»£p lÃ½</strong>: Dá»±a trÃªn Ä‘áº·c Ä‘iá»ƒm á»©ng dá»¥ng, lá»±a chá»n bá»™ thu gom rÃ¡c thÃ­ch há»£p, vÃ­ dá»¥ G1 cho á»©ng dá»¥ng yÃªu cáº§u Ä‘á»™ trá»… tháº¥p.</p></li><li><p><strong>Theo dÃµi vÃ  Ä‘iá»u chá»‰nh kÃ­ch thÆ°á»›c heap</strong>: Theo dÃµi viá»‡c sá»­ dá»¥ng bá»™ nhá»› vÃ  Ä‘iá»u chá»‰nh kÃ­ch thÆ°á»›c heap phÃ¹ há»£p Ä‘á»ƒ trÃ¡nh tÃ¬nh tráº¡ng Ä‘áº§y bá»™ nhá»›.</p></li><li><p><strong>Xem xÃ©t cÃ¡c lá»±a chá»n bá»™ nhá»› cho Spring Boot</strong>: Khi sá»­ dá»¥ng Spring Boot, cáº§n xem xÃ©t cáº¥u hÃ¬nh bá»™ nhá»› cá»§a Spring Ä‘á»ƒ tá»‘i Æ°u hÃ³a hiá»‡u suáº¥t.</p></li></ol><p>Cuá»‘i cÃ¹ng, viá»‡c tá»‘i Æ°u hÃ³a hiá»‡u suáº¥t khÃ´ng chá»‰ dá»±a vÃ o viá»‡c Ä‘iá»u chá»‰nh GC mÃ  cÃ²n cáº§n xem xÃ©t tá»•ng thá»ƒ vá» cÃ¡ch thá»©c mÃ£ nguá»“n vÃ  cáº¥u hÃ¬nh pháº§n má»m hoáº¡t Ä‘á»™ng cÃ¹ng nhau Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c káº¿t quáº£ tá»‘t nháº¥t.</p></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/vanhung4499/my-wiki/edit/main/src/interview/knowledge/java/jvm-qa.md" aria-label="Edit this page on GitHub" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page on GitHub<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">Last update: </span><!----></div><div class="contributors"><span class="vp-meta-label">Contributors: </span><!--[--><!--[--><span class="vp-meta-info" title="email: vanhung4499@gmail.com">Hung Nguyen Van</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><!----><a class="route-link auto-link next" href="/interview/knowledge/java/java-must-know.html" aria-label="Java Basic Must Know"><div class="hint">Next<span class="arrow end"></span></div><div class="link">Java Basic Must Know<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper" style="display:none;--1ea755b8:;"><div class="footer-content"><div class="footer">Made with â¤ï¸ by Hung Nguyen</div><div class="copyright">Copyright Â© 2016-2024 Hung Nguyen</div></div><span id="runtime_span"></span></footer></div><!--]--><!--[--><!----><!----><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-CIGQMwlz.js" defer></script>
  </body>
</html>
