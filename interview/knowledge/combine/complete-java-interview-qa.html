<!doctype html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.15" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.52" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://vanhung4499.github.io/interview/knowledge/combine/complete-java-interview-qa.html"><meta property="og:site_name" content="VanHung4499"><meta property="og:title" content="Complete Java Interview Questions"><meta property="og:description" content="Ho√†nh th√†nh t·ªïng h·ª£p c√¢u h·ªèi ph·ªèng v·∫•n Java Info T·ªïng h·ª£p c√¢u h·ªèi c·ªßa to√†n b·ªô, kh√¥ng ph·∫£i ch·ªâ v·ªÅ JAVA! S·ª± kh√°c bi·ªát gi·ªØa JDK, JRE v√† JVM JDK (Java SE Development Kit) l√† b·ªô c√¥ng..."><meta property="og:type" content="article"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/jpeg/365147/1690204763239-0a36e926-3b2a-40d0-821b-429ac925e563.jpeg"><meta property="og:locale" content="en-US"><meta property="og:updated_time" content="2024-10-02T17:20:50.000Z"><meta property="article:author" content="Hung Nguyen"><meta property="article:tag" content="java"><meta property="article:tag" content="interview"><meta property="article:modified_time" content="2024-10-02T17:20:50.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Complete Java Interview Questions","image":["https://cdn.nlark.com/yuque/0/2023/jpeg/365147/1690204763239-0a36e926-3b2a-40d0-821b-429ac925e563.jpeg","https://cdn.nlark.com/yuque/0/2023/png/365147/1690198625500-1a5cfb9b-de48-4ce8-88ad-fc73a6897b11.png","https://cdn.nlark.com/yuque/0/2023/png/365147/1690198875882-a806955a-7613-4cb1-bc4b-c40781c2958b.png","https://cdn.nlark.com/yuque/0/2023/png/365147/1690199113277-e7b32550-e3e3-4e86-b2c1-4847b615a797.png","https://cdn.nlark.com/yuque/0/2023/png/365147/1690199450688-73573112-c70c-4e4d-9694-11dce711d9cb.png","https://cdn.nlark.com/yuque/0/2023/png/365147/1690204026748-814cb0a1-3cce-4be3-9224-0d994281976f.png","https://cdn.nlark.com/yuque/0/2023/png/365147/1690204033411-b32de53b-8bdf-462c-be63-9957ab8021a3.png","https://cdn.nlark.com/yuque/0/2023/png/365147/1690204051908-3f65da0b-5e7f-410e-80fe-f2aee29dbe2f.png","https://cdn.nlark.com/yuque/0/2023/png/8380143/1695284933934-d95c0fda-b61f-4fe2-900d-6aab251605a4.png","https://cdn.nlark.com/yuque/0/2021/png/365147/1622816824404-17d018de-eb06-41eb-9936-64e4c6cc046d.png","https://cdn.nlark.com/yuque/0/2021/png/365147/1638187280609-2738d2ba-22f1-4107-9c0f-9c7a8144dcba.png","https://cdn.nlark.com/yuque/0/2023/png/365147/1676441269905-beaa3167-d54b-459f-81b2-8511fa98d205.png","https://cdn.nlark.com/yuque/0/2023/png/365147/1676440676093-add4ff6a-d422-4f40-b3cb-b37e47649586.png","https://cdn.nlark.com/yuque/0/2023/png/365147/1676440694138-21cb9f9e-62fd-4407-8a59-35dac67b4bb0.png","https://cdn.nlark.com/yuque/0/2023/png/365147/1676441388985-dd894fe7-5e62-4963-82d0-f35527244b5a.png","https://cdn.nlark.com/yuque/0/2023/png/365147/1676441439769-58372ca6-248e-4751-8d33-516c484eb3e4.png","https://cdn.nlark.com/yuque/0/2023/png/365147/1676441454918-10d3d846-cb50-49a6-b27d-7d581e47cf6e.png","https://cdn.nlark.com/yuque/0/2023/png/365147/1676441511562-24c5629c-7592-46fc-ada6-8cb799f74565.png","https://cdn.nlark.com/yuque/0/2023/png/365147/1676441536615-677899cc-8abb-481a-85b6-61b58ea76179.png","https://cdn.nlark.com/yuque/0/2023/png/365147/1676441574914-0b982490-b3cb-45ab-a5f5-9b92380e78dc.png","https://cdn.nlark.com/yuque/0/2023/png/365147/1676441625277-08d21740-9d77-485f-9915-3f43e703cfe2.png","https://cdn.nlark.com/yuque/0/2023/png/365147/1676442107674-6566e5ed-784a-4325-9869-a9ad0b8bb6e6.png","https://cdn.nlark.com/yuque/0/2023/png/365147/1676442170113-f7ec872a-ddb1-4183-b477-131b056fb588.png","https://cdn.nlark.com/yuque/0/2023/png/365147/1676442219810-663f0bb0-5ed1-4cac-b93d-be3eaf7452e2.png","https://cdn.nlark.com/yuque/0/2023/png/365147/1676442285345-6dce4534-c3dc-4348-b712-c1ec27164afb.png","https://cdn.nlark.com/yuque/0/2023/png/365147/1676443326948-a9f418ab-1606-47ab-9ebd-618fde89d761.png","https://cdn.nlark.com/yuque/0/2022/png/365147/1668599070561-7707946a-4402-48e1-8dad-63169f07d2b0.png","https://cdn.nlark.com/yuque/0/2022/png/365147/1668599322284-46fcb513-6e94-46d0-845e-3c69378854ad.png","https://cdn.nlark.com/yuque/0/2022/png/365147/1671959484035-6355ab75-49c9-4197-92eb-48f7615c0aae.png","https://cdn.nlark.com/yuque/0/2022/png/365147/1671960159223-f31eea23-3b5a-49e0-ab1e-a44c4e7b966e.png","https://cdn.nlark.com/yuque/0/2021/jpeg/365147/1626176708107-3ad83a45-25b3-403e-beaf-02185e787ff9.jpeg","https://cdn.nlark.com/yuque/0/2021/png/365147/1627449092303-9281aa79-94f4-4eae-9ddc-22e5b53eed2e.png","https://cdn.nlark.com/yuque/0/2022/jpeg/8380143/1668513379681-00f7ed75-e093-4688-9b9a-cfd9ac16fe9c.jpeg","https://raw.githubusercontent.com/csunny/etcd-from-arch-to-souce-code/master/_asserts/images/cap.jpg","https://cdn.nlark.com/yuque/0/2022/png/8380143/1670317738162-e224abb6-ea76-479c-a861-4e762f47d2a9.png"],"dateModified":"2024-10-02T17:20:50.000Z","author":[{"@type":"Person","name":"Hung Nguyen","url":"https://vanhung4499.github.io"}]}</script><meta name="referrer" content="no-referrer-when-downgrade"><link rel="alternate" type="application/rss+xml" href="https://vanhung4499.github.io/rss.xml" title="VanHung4499 RSS Feed"><title>Complete Java Interview Questions | VanHung4499</title><meta name="description" content="Ho√†nh th√†nh t·ªïng h·ª£p c√¢u h·ªèi ph·ªèng v·∫•n Java Info T·ªïng h·ª£p c√¢u h·ªèi c·ªßa to√†n b·ªô, kh√¥ng ph·∫£i ch·ªâ v·ªÅ JAVA! S·ª± kh√°c bi·ªát gi·ªØa JDK, JRE v√† JVM JDK (Java SE Development Kit) l√† b·ªô c√¥ng...">
    <link rel="preload" href="/assets/style-DFXXOFfS.css" as="style"><link rel="stylesheet" href="/assets/style-DFXXOFfS.css">
    <link rel="modulepreload" href="/assets/app-CmlOSuIY.js"><link rel="modulepreload" href="/assets/complete-java-interview-qa.html-IUCUcBu0.js">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">Skip to main content</a><!--]--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo" src="/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">VanHung4499</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="Home"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:home" width="1em" height="1em"></iconify-icon><!--]-->Home<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/wiki.html" aria-label="Wiki"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="carbon:wikis" width="1em" height="1em"></iconify-icon><!--]-->Wiki<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/dsa/" aria-label="Algorithms"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="hugeicons:algorithm" width="1em" height="1em"></iconify-icon><!--]-->Algorithms<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Programming"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:code" width="1em" height="1em"></iconify-icon>Programming<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/java/" aria-label="Java"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:java" width="1em" height="1em"></iconify-icon><!--]-->Java<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/golang/" aria-label="Golang"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:go" width="1em" height="1em"></iconify-icon><!--]-->Golang<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/js/" aria-label="JavaScript"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:javascript" width="1em" height="1em"></iconify-icon><!--]-->JavaScript<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/ts/" aria-label="TypeScript"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:typescript" width="1em" height="1em"></iconify-icon><!--]-->TypeScript<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/python/" aria-label="Python"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:python" width="1em" height="1em"></iconify-icon><!--]-->Python<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Database"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:database" width="1em" height="1em"></iconify-icon>Database<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/sql/" aria-label="SQL"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:sql-query" width="1em" height="1em"></iconify-icon><!--]-->SQL<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/mysql/" aria-label="MySQL"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:mysql" width="1em" height="1em"></iconify-icon><!--]-->MySQL<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/mongodb/" aria-label="MongoDB"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:mongodb" width="1em" height="1em"></iconify-icon><!--]-->MongoDB<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/redis/" aria-label="Redis"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/elasticsearch/" aria-label="Elasticsearch"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:elasticsearch" width="1em" height="1em"></iconify-icon><!--]-->Elasticsearch<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/elastic/" aria-label="Elastic Stack"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="cib:elastic-stack" width="1em" height="1em"></iconify-icon><!--]-->Elastic Stack<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Framework"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="simple-icons:framework" width="1em" height="1em"></iconify-icon>Framework<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/spring/" aria-label="Spring"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->Spring<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/spring-boot/" aria-label="Spring Boot"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->Spring Boot<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/nestjs/" aria-label="NestJS"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:nestjs" width="1em" height="1em"></iconify-icon><!--]-->NestJS<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/gin/" aria-label="Gin"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="logos:gin" width="1em" height="1em"></iconify-icon><!--]-->Gin<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="DevOps"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon-plain:azuredevops" width="1em" height="1em"></iconify-icon>DevOps<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/docker/" aria-label="Docker"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:docker" width="1em" height="1em"></iconify-icon><!--]-->Docker<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/kubernetes/" aria-label="Kubernetes"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:kubernetes" width="1em" height="1em"></iconify-icon><!--]-->Kubernetes<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/jenkins/" aria-label="Jenkins"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:jenkins" width="1em" height="1em"></iconify-icon><!--]-->Jenkins<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/git/" aria-label="Git"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:git" width="1em" height="1em"></iconify-icon><!--]-->Git<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/linux/" aria-label="Linux"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:linux" width="1em" height="1em"></iconify-icon><!--]-->Linux<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Design"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="tdesign:system-sum" width="1em" height="1em"></iconify-icon>Design<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/design/design-pattern/" aria-label="Design Pattern"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="tabler:grid-pattern" width="1em" height="1em"></iconify-icon><!--]-->Design Pattern<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/design/system-design/" aria-label="System Design"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="icon-park-outline:system" width="1em" height="1em"></iconify-icon><!--]-->System Design<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Project"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="ant-design:project-outlined" width="1em" height="1em"></iconify-icon>Project<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/project/rouyi-vue-pro/" aria-label="Rouyi Vue Pro"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->Rouyi Vue Pro<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/project/yudao-cloud/" aria-label="Yudao Cloud"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->Yudao Cloud<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="route-link route-link-active auto-link" href="/interview/" aria-label="Interview"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:account-tie" width="1em" height="1em"></iconify-icon><!--]-->Interview<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="About"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:about" width="1em" height="1em"></iconify-icon>About<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/about-me.html" aria-label="About me"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="cib:about-me" width="1em" height="1em"></iconify-icon><!--]-->About me<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/about.html" aria-label="About"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:about" width="1em" height="1em"></iconify-icon><!--]-->About<!----></a></li></ul></button></div></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/vanhung4499/my-wiki" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><!--[--><button type="button" class="search-pro-button" aria-label="Search"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon" name="search"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">Search</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><a class="route-link route-link-active auto-link vp-sidebar-title no-external-link-icon" href="/interview/knowledge/" aria-label="Knowledge"><!---->Knowledge<!----></a><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">Combine</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/interview/knowledge/combine/complete-java-interview-qa.html" aria-label="Complete Java Interview Questions"><!---->Complete Java Interview Questions<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Java</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">My</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Mysql</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Redis</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Prepare</span><span class="vp-arrow end"></span></button><!----></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->Complete Java Interview Questions</h1><div class="page-info"><span class="page-author-info" aria-label="Authorüñä" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://vanhung4499.github.io" target="_blank" rel="noopener noreferrer">Hung Nguyen</a></span><span property="author" content="Hung Nguyen"></span></span><!----><span class="page-date-info" aria-label="Writing DateüìÖ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-10-02T17:20:50.000Z"></span><!----><span class="page-reading-time-info" aria-label="Reading Time‚åõ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 159 min</span><meta property="timeRequired" content="PT159M"></span><span class="page-category-info" aria-label="Categoryüåà" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color4 clickable" role="navigation">interview</span><!--]--><meta property="articleSection" content="interview"></span><span class="page-tag-info" aria-label="Tagüè∑" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color8 clickable" role="navigation">java</span><span class="page-tag-item color4 clickable" role="navigation">interview</span><!--]--><meta property="keywords" content="java,interview"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">On This Page<button type="button" class="print-button" title="Print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#su-khac-biet-giua-jdk-jre-va-jvm">S·ª± kh√°c bi·ªát gi·ªØa JDK, JRE v√† JVM</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#moi-quan-he-giua-hashcode-va-equals">M·ªëi quan h·ªá gi·ªØa hashCode() v√† equals()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#su-khac-biet-giua-string-stringbuffer-va-stringbuilder">S·ª± kh√°c bi·ªát gi·ªØa String, StringBuffer v√† StringBuilder</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#su-khac-biet-giua-extends-va-super-trong-generic">S·ª± kh√°c bi·ªát gi·ªØa extends v√† super trong generic</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#su-khac-biet-giua-va-equals">S·ª± kh√°c bi·ªát gi·ªØa == v√† equals</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#su-khac-biet-giua-overload-va-override">S·ª± kh√°c bi·ªát gi·ªØa Overload v√† Override</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#su-khac-biet-giua-list-va-set">S·ª± kh√°c bi·ªát gi·ªØa List v√† Set</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#nguyen-ly-hoat-ƒëong-cua-arraylist">Nguy√™n l√Ω ho·∫°t ƒë·ªông c·ªßa ArrayList</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#su-khac-biet-giua-arraylist-va-linkedlist">S·ª± kh√°c bi·ªát gi·ªØa ArrayList v√† LinkedList</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#co-che-mo-rong-cua-concurrenthashmap">C∆° ch·∫ø m·ªü r·ªông c·ªßa ConcurrentHashMap</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#nhung-thay-ƒëoi-tu-jdk1-7-ƒëen-jdk1-8-trong-hashmap-phan-co-ban">Nh·ªØng thay ƒë·ªïi t·ª´ JDK1.7 ƒë·∫øn JDK1.8 trong HashMap (ph·∫ßn c∆° b·∫£n)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#quy-trinh-phuong-thuc-put-cua-hashmap">Quy tr√¨nh ph∆∞∆°ng th·ª©c put c·ªßa HashMap</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#su-khac-biet-giua-sao-chep-sau-va-sao-chep-nong">S·ª± kh√°c bi·ªát gi·ªØa sao ch√©p s√¢u v√† sao ch√©p n√¥ng</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#co-che-mo-rong-cua-hashmap">C∆° ch·∫ø m·ªü r·ªông c·ªßa HashMap</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#phien-ban-jdk1-7">Phi√™n b·∫£n JDK1.7</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#phien-ban-jdk1-8">Phi√™n b·∫£n JDK1.8</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#nguyen-ly-cua-copyonwritearraylist">Nguy√™n l√Ω c·ªßa CopyOnWriteArrayList</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#bytecode-la-gi-loi-ich-cua-viec-su-dung-bytecode-la-gi">Bytecode l√† g√¨? L·ª£i √≠ch c·ªßa vi·ªác s·ª≠ d·ª•ng bytecode l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#he-thong-xu-ly-ngoai-le-trong-java">H·ªá th·ªëng x·ª≠ l√Ω ngo·∫°i l·ªá trong Java</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#trong-co-che-xu-ly-ngoai-le-cua-java-khi-nao-nen-nem-ngoai-le-va-khi-nao-nen-bat-ngoai-le">Trong c∆° ch·∫ø x·ª≠ l√Ω ngo·∫°i l·ªá c·ªßa Java, khi n√†o n√™n n√©m ngo·∫°i l·ªá v√† khi n√†o n√™n b·∫Øt ngo·∫°i l·ªá?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#generic-erasure-trong-java-la-gi">Generic Erasure trong Java l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cac-class-loader-trong-java">C√°c class loader trong Java</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#mo-hinh-uy-quyen-theo-cha-me-cua-class-loader">M√¥ h√¨nh ·ªßy quy·ªÅn theo cha m·∫π c·ªßa class loader</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#nhung-khu-vuc-nao-cua-jvm-ƒëuoc-chia-se-giua-cac-luong">Nh·ªØng khu v·ª±c n√†o c·ªßa JVM ƒë∆∞·ª£c chia s·∫ª gi·ªØa c√°c lu·ªìng?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ban-xu-ly-cac-van-ƒëe-jvm-trong-du-an-nhu-the-nao">B·∫°n x·ª≠ l√Ω c√°c v·∫•n ƒë·ªÅ JVM trong d·ª± √°n nh∆∞ th·∫ø n√†o?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#khi-jvm-gap-loi-oom-co-lam-treo-tien-trinh-khong">Khi JVM g·∫∑p l·ªói OOM c√≥ l√†m treo ti·∫øn tr√¨nh kh√¥ng?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#qua-trinh-mot-ƒëoi-tuong-tu-khi-ƒëuoc-tai-vao-jvm-ƒëen-khi-bi-gc-xoa-bo-trai-qua-nhung-giai-ƒëoan-gi">Qu√° tr√¨nh m·ªôt ƒë·ªëi t∆∞·ª£ng t·ª´ khi ƒë∆∞·ª£c t·∫£i v√†o JVM ƒë·∫øn khi b·ªã GC xo√° b·ªè tr·∫£i qua nh·ªØng giai ƒëo·∫°n g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#lam-the-nao-ƒëe-xac-ƒëinh-mot-ƒëoi-tuong-co-phai-la-rac-hay-khong">L√†m th·∫ø n√†o ƒë·ªÉ x√°c ƒë·ªãnh m·ªôt ƒë·ªëi t∆∞·ª£ng c√≥ ph·∫£i l√† r√°c hay kh√¥ng?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cac-thuat-toan-thu-gom-rac-trong-jvm">C√°c thu·∫≠t to√°n thu gom r√°c trong JVM?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#stw-la-gi">STW l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cac-tham-so-cua-jvm">C√°c tham s·ªë c·ªßa JVM?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#hieu-biet-ve-an-toan-luong-thread-safety">Hi·ªÉu bi·∫øt v·ªÅ an to√†n lu·ªìng (thread safety)?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#hieu-biet-ve-luong-daemon-luong-nen">Hi·ªÉu bi·∫øt v·ªÅ lu·ªìng daemon (lu·ªìng n·ªÅn)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#nguyen-ly-co-ban-cua-threadlocal">Nguy√™n l√Ω c∆° b·∫£n c·ªßa ThreadLocal</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#su-khac-biet-giua-ƒëong-thoi-song-song-va-tuan-tu">S·ª± kh√°c bi·ªát gi·ªØa ƒë·ªìng th·ªùi, song song v√† tu·∫ßn t·ª±</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#lam-sao-ƒëe-tranh-deadlock-trong-java">L√†m sao ƒë·ªÉ tr√°nh deadlock trong Java?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#nguyen-ly-lam-viec-cua-thread-pool">Nguy√™n l√Ω l√†m vi·ªác c·ªßa thread pool</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#tai-sao-thread-pool-them-vao-hang-ƒëoi-truoc-khi-tao-luong-toi-ƒëa">T·∫°i sao thread pool th√™m v√†o h√†ng ƒë·ª£i tr∆∞·ªõc khi t·∫°o lu·ªìng t·ªëi ƒëa?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#su-khac-biet-giua-khoa-cong-bang-va-thien-vi-trong-reentrantlock">S·ª± kh√°c bi·ªát gi·ªØa kh√≥a c√¥ng b·∫±ng v√† thi√™n v·ªã trong ReentrantLock</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#su-khac-biet-giua-trylock-va-lock-trong-reentrantlock">S·ª± kh√°c bi·ªát gi·ªØa tryLock() v√† lock() trong ReentrantLock</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#su-khac-biet-giua-countdownlatch-va-semaphore">S·ª± kh√°c bi·ªát gi·ªØa CountDownLatch v√† Semaphore</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#sychronized-khoa-thien-vi-khoa-nhe-va-khoa-nang">Sychronized: Kh√≥a thi√™n v·ªã, kh√≥a nh·∫π, v√† kh√≥a n·∫∑ng</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#su-khac-biet-giua-synchronized-va-reentrantlock">S·ª± kh√°c bi·ªát gi·ªØa Synchronized v√† ReentrantLock</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#hieu-biet-ve-aqs-va-cach-aqs-thuc-hien-khoa-tai-nhap">Hi·ªÉu bi·∫øt v·ªÅ AQS v√† c√°ch AQS th·ª±c hi·ªán kh√≥a t√°i nh·∫≠p</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#hieu-biet-ve-ioc">Hi·ªÉu bi·∫øt v·ªÅ IoC</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#single-bean-va-singleton">Single Bean v√† Singleton</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#co-che-truyen-tai-giao-dich-trong-spring">C∆° ch·∫ø truy·ªÅn t·∫£i giao d·ªãch trong Spring</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#tam-tinh-huong-lam-cho-giao-dich-trong-spring-khong-hieu-qua-va-nguyen-nhan-phan-tich">T√°m t√¨nh hu·ªëng l√†m cho giao d·ªãch trong Spring kh√¥ng hi·ªáu qu·∫£ v√† nguy√™n nh√¢n ph√¢n t√≠ch</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cac-buoc-tao-bean-trong-spring">C√°c b∆∞·ªõc t·∫°o Bean trong Spring</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#bean-trong-spring-co-an-toan-trong-moi-truong-ƒëa-luong-khong">Bean trong Spring c√≥ an to√†n trong m√¥i tr∆∞·ªùng ƒëa lu·ªìng kh√¥ng?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#su-khac-biet-giua-applicationcontext-va-beanfactory">S·ª± kh√°c bi·ªát gi·ªØa ApplicationContext v√† BeanFactory</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#spring-giao-dich-ƒëuoc-thuc-hien-nhu-the-nao">Spring giao d·ªãch ƒë∆∞·ª£c th·ª±c hi·ªán nh∆∞ th·∫ø n√†o</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#khi-nao-annotation-transactional-trong-spring-khong-co-hieu-luc">Khi n√†o annotation @Transactional trong Spring kh√¥ng c√≥ hi·ªáu l·ª±c</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#quy-trinh-khoi-ƒëong-cua-spring">Quy tr√¨nh kh·ªüi ƒë·ªông c·ªßa Spring</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cac-mau-thiet-ke-ƒëuoc-su-dung-trong-spring">C√°c m·∫´u thi·∫øt k·∫ø ƒë∆∞·ª£c s·ª≠ d·ª•ng trong Spring</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cac-annotation-thuong-dung-trong-spring-boot-va-cach-thuc-hoat-ƒëong">C√°c annotation th∆∞·ªùng d√πng trong Spring Boot v√† c√°ch th·ª©c ho·∫°t ƒë·ªông</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cach-spring-boot-khoi-ƒëong-tomcat">C√°ch Spring Boot kh·ªüi ƒë·ªông Tomcat</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#uu-ƒëiem-va-nhuoc-ƒëiem-cua-mybatis">∆Øu ƒëi·ªÉm v√† nh∆∞·ª£c ƒëi·ªÉm c·ªßa MyBatis</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#su-khac-biet-giua-va-trong-mybatis">S·ª± kh√°c bi·ªát gi·ªØa #{} v√† ${} trong MyBatis</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#nguyen-ly-co-ban-cua-chi-muc-index">Nguy√™n l√Ω c∆° b·∫£n c·ªßa ch·ªâ m·ª•c (Index)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#nguyen-tac-thiet-ke-chi-muc">Nguy√™n t·∫Øc thi·∫øt k·∫ø ch·ªâ m·ª•c</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cac-ƒëac-tinh-co-ban-cua-giao-dich-va-muc-ƒëo-cach-ly">C√°c ƒë·∫∑c t√≠nh c∆° b·∫£n c·ªßa giao d·ªãch v√† m·ª©c ƒë·ªô c√°ch ly</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#mvcc-la-gi">MVCC l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#tom-tat-su-khac-biet-giua-myisam-va-innodb">T√≥m t·∫Øt s·ª± kh√°c bi·ªát gi·ªØa MyISAM v√† InnoDB</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cac-truong-trong-ket-qua-cua-cau-lenh-explain-ƒëai-dien-cho-ƒëieu-gi">C√°c tr∆∞·ªùng trong k·∫øt qu·∫£ c·ªßa c√¢u l·ªánh Explain ƒë·∫°i di·ªán cho ƒëi·ªÅu g√¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#phan-tich-chin-tinh-huong-lam-mat-hieu-luc-cua-chi-muc-trong-mysql">Ph√¢n t√≠ch ch√≠n t√¨nh hu·ªëng l√†m m·∫•t hi·ªáu l·ª±c c·ªßa ch·ªâ m·ª•c trong MySQL</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-khong-tuan-thu-nguyen-tac-khop-trai-nhat">1. Kh√¥ng tu√¢n th·ªß nguy√™n t·∫Øc kh·ªõp tr√°i nh·∫•t</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-truy-van-like-khong-chinh-xac">2. Truy v·∫•n Like kh√¥ng ch√≠nh x√°c</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-thuc-hien-phep-tinh-tren-cot-chi-muc-hoac-su-dung-ham">3. Th·ª±c hi·ªán ph√©p t√≠nh tr√™n c·ªôt ch·ªâ m·ª•c ho·∫∑c s·ª≠ d·ª•ng h√†m</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-chuyen-ƒëoi-kieu-tren-cot-chi-muc">4. Chuy·ªÉn ƒë·ªïi ki·ªÉu tr√™n c·ªôt ch·ªâ m·ª•c</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-khong-bang-gay-mat-hieu-luc-chi-muc">5. &lt;&gt; kh√¥ng b·∫±ng g√¢y m·∫•t hi·ªáu l·ª±c ch·ªâ m·ª•c</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_6-order-by-gay-mat-hieu-luc-chi-muc">6. order by g√¢y m·∫•t hi·ªáu l·ª±c ch·ªâ m·ª•c</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-su-dung-or-gay-mat-hieu-luc-chi-muc">7. S·ª≠ d·ª•ng or g√¢y m·∫•t hi·ªáu l·ª±c ch·ªâ m·ª•c</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_8-select-gay-mat-hieu-luc-chi-muc">8. select * g√¢y m·∫•t hi·ªáu l·ª±c ch·ªâ m·ª•c</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_9-truy-van-pham-vi-voi-khoi-luong-du-lieu-qua-lon-dan-ƒëen-mat-hieu-luc-chi-muc">9. Truy v·∫•n ph·∫°m vi v·ªõi kh·ªëi l∆∞·ª£ng d·ªØ li·ªáu qu√° l·ªõn d·∫´n ƒë·∫øn m·∫•t hi·ªáu l·ª±c ch·ªâ m·ª•c</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#chi-muc-bao-phu-la-gi">Ch·ªâ m·ª•c bao ph·ªß l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#nguyen-tac-tien-to-trai-nhat-la-gi">Nguy√™n t·∫Øc ti·ªÅn t·ªë tr√°i nh·∫•t l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#innodb-thuc-hien-giao-dich-nhu-the-nao">Innodb th·ª±c hi·ªán giao d·ªãch nh∆∞ th·∫ø n√†o?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#su-khac-biet-giua-b-tree-va-b-tree-tai-sao-mysql-lai-su-dung-b-tree">S·ª± kh√°c bi·ªát gi·ªØa B-tree v√† B+ tree, t·∫°i sao MySQL l·∫°i s·ª≠ d·ª•ng B+ tree?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cac-loai-khoa-trong-mysql-va-cach-hieu">C√°c lo·∫°i kh√≥a trong MySQL v√† c√°ch hi·ªÉu</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#lam-the-nao-ƒëe-toi-uu-hoa-truy-van-cham-trong-mysql">L√†m th·∫ø n√†o ƒë·ªÉ t·ªëi ∆∞u h√≥a truy v·∫•n ch·∫≠m trong MySQL?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#trong-mysql-bang-lon-la-bang-co-kich-thuoc-bao-nhieu">Trong MySQL, b·∫£ng l·ªõn l√† b·∫£ng c√≥ k√≠ch th∆∞·ªõc bao nhi√™u?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#su-khac-biet-giua-count-va-count-1">S·ª± kh√°c bi·ªát gi·ªØa count(*) v√† count(1)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#rdb-va-aof-la-gi">RDB v√† AOF l√† g√¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#chien-luoc-xoa-khoa-het-han-trong-redis">Chi·∫øn l∆∞·ª£c x√≥a kh√≥a h·∫øt h·∫°n trong Redis</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#tom-tat-viec-thuc-hien-giao-dich-trong-redis">T√≥m t·∫Øt vi·ªác th·ª±c hi·ªán giao d·ªãch trong Redis</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#nguyen-ly-cot-loi-cua-sao-chep-master-slave-trong-redis">Nguy√™n l√Ω c·ªët l√µi c·ªßa sao ch√©p master-slave trong Redis</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cac-cau-truc-du-lieu-trong-redis-la-gi-moi-cau-truc-co-nhung-truong-hop-ung-dung-ƒëien-hinh-nao">C√°c c·∫•u tr√∫c d·ªØ li·ªáu trong Redis l√† g√¨? M·ªói c·∫•u tr√∫c c√≥ nh·ªØng tr∆∞·ªùng h·ª£p ·ª©ng d·ª•ng ƒëi·ªÉn h√¨nh n√†o?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cach-thuc-hoat-ƒëong-cua-khoa-phan-tan-trong-redis">C√°ch th·ª©c ho·∫°t ƒë·ªông c·ªßa kh√≥a ph√¢n t√°n trong Redis?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#nguyen-ly-cot-loi-cua-sao-chep-chinh-phu-trong-redis-master-slave-replication">Nguy√™n l√Ω c·ªët l√µi c·ªßa sao ch√©p ch√≠nh - ph·ª• trong Redis (master-slave replication)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#chien-luoc-redis-cluster">Chi·∫øn l∆∞·ª£c Redis cluster</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cache-xuyen-thau-cache-ƒëam-thung-va-cache-sup-ƒëo-la-gi">Cache xuy√™n th·∫•u, cache ƒë√¢m th·ªßng, v√† cache s·ª•p ƒë·ªï l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#lam-the-nao-ƒëe-ƒëam-bao-du-lieu-nhat-quan-giua-redis-va-mysql">L√†m th·∫ø n√†o ƒë·ªÉ ƒë·∫£m b·∫£o d·ªØ li·ªáu nh·∫•t qu√°n gi·ªØa Redis v√† MySQL?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#co-che-luu-tru-du-lieu-cua-redis">C∆° ch·∫ø l∆∞u tr·ªØ d·ªØ li·ªáu c·ªßa Redis</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#rdb">RDB:</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#aof">AOF:</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#so-sanh">So s√°nh:</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#redis-ƒëon-luong-tai-sao-lai-nhanh">Redis ƒë∆°n lu·ªìng t·∫°i sao l·∫°i nhanh</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ly-do-redis-ƒëon-luong-nhanh">L√Ω do Redis ƒë∆°n lu·ªìng nhanh:</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#mo-ta-ngan-gon-ve-viec-thuc-hien-giao-dich-trong-redis">M√¥ t·∫£ ng·∫Øn g·ªçn v·ªÅ vi·ªác th·ª±c hi·ªán giao d·ªãch trong Redis</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ly-thuyet-cap-la-gi">L√Ω thuy·∫øt CAP l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ly-thuyet-base-la-gi">L√Ω thuy·∫øt BASE l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#rpc-la-gi">RPC l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cac-mo-hinh-nhat-quan-du-lieu-la-gi">C√°c m√¥ h√¨nh nh·∫•t qu√°n d·ªØ li·ªáu l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#id-phan-tan-la-gi-cac-giai-phap-nao-co-the-ap-dung">ID ph√¢n t√°n l√† g√¨? C√°c gi·∫£i ph√°p n√†o c√≥ th·ªÉ √°p d·ª•ng?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cac-truong-hop-su-dung-khoa-phan-tan-la-gi-co-nhung-giai-phap-nao">C√°c tr∆∞·ªùng h·ª£p s·ª≠ d·ª•ng kh√≥a ph√¢n t√°n l√† g√¨? C√≥ nh·ªØng gi·∫£i ph√°p n√†o?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#giao-dich-phan-tan-la-gi-co-nhung-giai-phap-nao">Giao d·ªãch ph√¢n t√°n l√† g√¨? C√≥ nh·ªØng gi·∫£i ph√°p n√†o?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#giao-thuc-zab-la-gi">Giao th·ª©c ZAB l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#tai-sao-zookeeper-co-the-ƒëuoc-su-dung-lam-trung-tam-ƒëang-ky">T·∫°i sao Zookeeper c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng l√†m trung t√¢m ƒëƒÉng k√Ω?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#quy-trinh-bau-chon-lanh-ƒëao-trong-zookeeper-la-gi">Quy tr√¨nh b·∫ßu ch·ªçn l√£nh ƒë·∫°o trong Zookeeper l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#du-lieu-giua-cac-node-trong-cum-zookeeper-ƒëuoc-ƒëong-bo-hoa-nhu-the-nao">D·ªØ li·ªáu gi·ªØa c√°c node trong c·ª•m Zookeeper ƒë∆∞·ª£c ƒë·ªìng b·ªô h√≥a nh∆∞ th·∫ø n√†o?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#dubbo-ho-tro-nhung-chien-luoc-can-bang-tai-nao">Dubbo h·ªó tr·ª£ nh·ªØng chi·∫øn l∆∞·ª£c c√¢n b·∫±ng t·∫£i n√†o?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#dubbo-thuc-hien-xuat-dich-vu-nhu-the-nao">Dubbo th·ª±c hi·ªán xu·∫•t d·ªãch v·ª• nh∆∞ th·∫ø n√†o?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#dubbo-thuc-hien-nhap-dich-vu-nhu-the-nao">Dubbo th·ª±c hi·ªán nh·∫≠p d·ªãch v·ª• nh∆∞ th·∫ø n√†o?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#kien-truc-cua-dubbo-la-gi">Ki·∫øn tr√∫c c·ªßa Dubbo l√† g√¨?</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#giai-thich-cac-tang">Gi·∫£i th√≠ch c√°c t·∫ßng:</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#giai-thich-moi-quan-he">Gi·∫£i th√≠ch m·ªëi quan h·ªá</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cac-thuat-toan-can-bang-tai">C√°c thu·∫≠t to√°n c√¢n b·∫±ng t·∫£i:</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#giai-phap-chia-se-session-trong-kien-truc-phan-tan">Gi·∫£i ph√°p chia s·∫ª Session trong ki·∫øn tr√∫c ph√¢n t√°n</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cach-thuc-hien-tinh-idempotency-cho-api">C√°ch th·ª±c hi·ªán t√≠nh idempotency cho API</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#tong-quan-ve-dich-vu-ƒëat-ten-quan-ly-cau-hinh-va-quan-ly-cum-trong-zookeeper">T·ªïng quan v·ªÅ d·ªãch v·ª• ƒë·∫∑t t√™n, qu·∫£n l√Ω c·∫•u h√¨nh v√† qu·∫£n l√Ω c·ª•m trong Zookeeper</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#co-che-watch-trong-zookeeper">C∆° ch·∫ø Watch trong Zookeeper</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#su-khac-biet-giua-zookeeper-va-eureka">S·ª± kh√°c bi·ªát gi·ªØa Zookeeper v√† Eureka</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cach-giai-quyet-van-ƒëe-khoa-chinh-duy-nhat-sau-khi-tach-bang">C√°ch gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ kh√≥a ch√≠nh duy nh·∫•t sau khi t√°ch b·∫£ng</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#nguyen-ly-cua-thuat-toan-snowflake">Nguy√™n l√Ω c·ªßa thu·∫≠t to√°n Snowflake</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cach-giai-quyet-van-ƒëe-truy-van-khong-su-dung-khoa-phan-vung">C√°ch gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ truy v·∫•n kh√¥ng s·ª≠ d·ª•ng kh√≥a ph√¢n v√πng</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cac-thanh-phan-pho-bien-cua-spring-cloud-va-chuc-nang">C√°c th√†nh ph·∫ßn ph·ªï bi·∫øn c·ªßa Spring Cloud v√† ch·ª©c nƒÉng</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cach-tranh-xuyen-thung-bo-nho-ƒëem-pha-vo-bo-nho-ƒëem-va-sup-ƒëo-bo-nho-ƒëem">C√°ch tr√°nh xuy√™n th·ªßng b·ªô nh·ªõ ƒë·ªám, ph√° v·ª° b·ªô nh·ªõ ƒë·ªám, v√† s·ª•p ƒë·ªï b·ªô nh·ªõ ƒë·ªám</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cac-giai-phap-bo-nho-ƒëem-thuong-dung-trong-he-thong-phan-tan">C√°c gi·∫£i ph√°p b·ªô nh·ªõ ƒë·ªám th∆∞·ªùng d√πng trong h·ªá th·ªëng ph√¢n t√°n</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cac-chien-luoc-het-han-bo-nho-ƒëem">C√°c chi·∫øn l∆∞·ª£c h·∫øt h·∫°n b·ªô nh·ªõ ƒë·ªám</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cac-thuat-toan-loai-bo-bo-nho-ƒëem-pho-bien">C√°c thu·∫≠t to√°n lo·∫°i b·ªè b·ªô nh·ªõ ƒë·ªám ph·ªï bi·∫øn</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#nguyen-ly-va-uu-nhuoc-ƒëiem-cua-bloom-filter">Nguy√™n l√Ω v√† ∆∞u, nh∆∞·ª£c ƒëi·ªÉm c·ªßa Bloom Filter</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#thuat-toan-ƒëinh-ƒëia-chi-bo-nho-ƒëem-phan-tan">Thu·∫≠t to√°n ƒë·ªãnh ƒë·ªãa ch·ªâ b·ªô nh·ªõ ƒë·ªám ph√¢n t√°n</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#su-khac-biet-giua-spring-cloud-va-dubbo">S·ª± kh√°c bi·ªát gi·ªØa Spring Cloud v√† Dubbo?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#tuyet-lo-dich-vu-la-gi-gioi-han-luu-luong-dich-vu-la-gi">Tuy·∫øt l·ªü d·ªãch v·ª• l√† g√¨? Gi·ªõi h·∫°n l∆∞u l∆∞·ª£ng d·ªãch v·ª• l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ngat-mach-dich-vu-la-gi-ha-cap-dich-vu-la-gi-su-khac-biet-la-gi">Ng·∫Øt m·∫°ch d·ªãch v·ª• l√† g√¨? H·∫° c·∫•p d·ªãch v·ª• l√† g√¨? S·ª± kh√°c bi·ªát l√† g√¨?</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ƒëiem-chung">ƒêi·ªÉm chung:</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ƒëiem-khac-biet">ƒêi·ªÉm kh√°c bi·ªát:</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#moi-quan-he-va-su-khac-biet-giua-soa-phan-tan-va-microservices-la-gi">M·ªëi quan h·ªá v√† s·ª± kh√°c bi·ªát gi·ªØa SOA, ph√¢n t√°n v√† microservices l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#lam-the-nao-ƒëe-tach-microservices">L√†m th·∫ø n√†o ƒë·ªÉ t√°ch microservices?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#lam-the-nao-ƒëe-thiet-ke-microservices-co-ƒëo-ket-hop-noi-bo-chat-che-va-muc-ƒëo-phu-thuoc-thap">L√†m th·∫ø n√†o ƒë·ªÉ thi·∫øt k·∫ø microservices c√≥ ƒë·ªô k·∫øt h·ª£p n·ªôi b·ªô ch·∫∑t ch·∫Ω v√† m·ª©c ƒë·ªô ph·ª• thu·ªôc th·∫•p?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ban-ƒëa-tung-nghe-ve-thiet-ke-ddd-domain-driven-design">B·∫°n ƒë√£ t·ª´ng nghe v·ªÅ thi·∫øt k·∫ø DDD (Domain-Driven Design)?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#trung-tam-middle-platform-la-gi">Trung t√¢m (Middle Platform) l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#du-an-cua-ban-ƒëam-bao-phat-trien-agile-cho-microservices-nhu-the-nao">D·ª± √°n c·ªßa b·∫°n ƒë·∫£m b·∫£o ph√°t tri·ªÉn agile cho microservices nh∆∞ th·∫ø n√†o?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#lam-the-nao-ƒëe-chon-lua-hang-ƒëoi-tin-nhan">L√†m th·∫ø n√†o ƒë·ªÉ ch·ªçn l·ª±a h√†ng ƒë·ª£i tin nh·∫Øn?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#tin-nhan-giao-dich-cua-rocketmq-ƒëuoc-thuc-hien-nhu-the-nao">Tin nh·∫Øn giao d·ªãch c·ªßa RocketMQ ƒë∆∞·ª£c th·ª±c hi·ªán nh∆∞ th·∫ø n√†o?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#tai-sao-rocketmq-khong-su-dung-zookeeper-lam-trung-tam-ƒëang-ky">T·∫°i sao RocketMQ kh√¥ng s·ª≠ d·ª•ng Zookeeper l√†m trung t√¢m ƒëƒÉng k√Ω?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#nguyen-ly-thuc-hien-cua-rocketmq">Nguy√™n l√Ω th·ª±c hi·ªán c·ªßa RocketMQ?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#tai-sao-rocketmq-lai-nhanh">T·∫°i sao RocketMQ l·∫°i nhanh?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#hang-ƒëoi-tin-nhan-lam-the-nao-ƒëe-ƒëam-bao-truyen-tai-tin-nhan-ƒëang-tin-cay">H√†ng ƒë·ª£i tin nh·∫Øn l√†m th·∫ø n√†o ƒë·ªÉ ƒë·∫£m b·∫£o truy·ªÅn t·∫£i tin nh·∫Øn ƒë√°ng tin c·∫≠y?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#hang-ƒëoi-tin-nhan-co-nhung-tac-dung-gi">H√†ng ƒë·ª£i tin nh·∫Øn c√≥ nh·ªØng t√°c d·ª•ng g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#hang-ƒëoi-chet-la-gi-hang-ƒëoi-tri-hoan-la-gi">H√†ng ƒë·ª£i ch·∫øt l√† g√¨? H√†ng ƒë·ª£i tr√¨ ho√£n l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#lam-the-nao-ƒëe-ƒëam-bao-ƒëoc-va-ghi-tin-nhan-hieu-qua">L√†m th·∫ø n√†o ƒë·ªÉ ƒë·∫£m b·∫£o ƒë·ªçc v√† ghi tin nh·∫Øn hi·ªáu qu·∫£?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#su-khac-nhau-giua-epoll-va-poll">S·ª± kh√°c nhau gi·ªØa epoll v√† poll</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#bat-tay-ba-buoc-va-bon-buoc-ket-thuc-trong-tcp">B·∫Øt tay ba b∆∞·ªõc v√† b·ªën b∆∞·ªõc k·∫øt th√∫c trong TCP</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#trinh-duyet-gui-yeu-cau-va-nhan-phan-hoi-trai-qua-nhung-buoc-nao">Tr√¨nh duy·ªát g·ª≠i y√™u c·∫ßu v√† nh·∫≠n ph·∫£n h·ªìi tr·∫£i qua nh·ªØng b∆∞·ªõc n√†o?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#yeu-cau-cross-origin-la-gi-co-van-ƒëe-gi-cach-giai-quyet">Y√™u c·∫ßu cross-origin l√† g√¨? C√≥ v·∫•n ƒë·ªÅ g√¨? C√°ch gi·∫£i quy·∫øt?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#zero-copy-la-gi">Zero Copy l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#trong-mysql-co-20-trieu-du-lieu-redis-chi-luu-200-nghin-du-lieu-lam-the-nao-ƒëe-ƒëam-bao-du-lieu-trong-redis-la-du-lieu-hot">Trong MySQL c√≥ 20 tri·ªáu d·ªØ li·ªáu, Redis ch·ªâ l∆∞u 200 ngh√¨n d·ªØ li·ªáu, l√†m th·∫ø n√†o ƒë·ªÉ ƒë·∫£m b·∫£o d·ªØ li·ªáu trong Redis l√† d·ªØ li·ªáu &quot;hot&quot;?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#vu-khi-huy-diet-trong-jdk19-virtual-thread-la-gi">&quot;V≈© kh√≠ h·ªßy di·ªát&quot; trong JDK19: Virtual Thread l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#lam-the-nao-ƒëe-ƒëam-bao-tinh-idempotent-bat-bien-khi-thuc-hien-nhieu-lan-cua-api-trong-moi-truong-cao-tai">L√†m th·∫ø n√†o ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh idempotent (b·∫•t bi·∫øn khi th·ª±c hi·ªán nhi·ªÅu l·∫ßn) c·ªßa API trong m√¥i tr∆∞·ªùng cao t·∫£i?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#redis-lam-the-nao-ƒëe-ƒëam-bao-tinh-nhat-quan-kep-voi-co-so-du-lieu">Redis l√†m th·∫ø n√†o ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh nh·∫•t qu√°n k√©p v·ªõi c∆° s·ªü d·ªØ li·ªáu</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#giai-phap-ƒëam-bao-tinh-nhat-quan-kep">Gi·∫£i ph√°p ƒë·∫£m b·∫£o t√≠nh nh·∫•t qu√°n k√©p:</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#phan-biet-su-khac-nhau-giua-cache-penetration-cache-breakdown-va-cache-avalanche-cung-nhu-cach-giai-quyet">Ph√¢n bi·ªát s·ª± kh√°c nhau gi·ªØa Cache Penetration, Cache Breakdown v√† Cache Avalanche, c≈©ng nh∆∞ c√°ch gi·∫£i quy·∫øt</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#phan-tich-cau-hoi-phong-van">Ph√¢n t√≠ch c√¢u h·ªèi ph·ªèng v·∫•n</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#cache-penetration-xuyen-pha-bo-nho-ƒëem">Cache Penetration (Xuy√™n ph√° b·ªô nh·ªõ ƒë·ªám)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#cache-breakdown-sap-bo-nho-ƒëem">Cache Breakdown (S·∫≠p b·ªô nh·ªõ ƒë·ªám)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#cache-avalanche-sup-ƒëo-bo-nho-ƒëem">Cache Avalanche (S·ª•p ƒë·ªï b·ªô nh·ªõ ƒë·ªám)</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#tim-hieu-ve-phat-hanh-theo-dang-canary-trong-10-phut">T√¨m hi·ªÉu v·ªÅ ph√°t h√†nh theo d·∫°ng Canary trong 10 ph√∫t</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#redis-co-ho-tro-acid-khong">Redis c√≥ h·ªó tr·ª£ ACID kh√¥ng?</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#cac-thao-tac-co-lap-rieng-le">C√°c thao t√°c c√¥ l·∫≠p ri√™ng l·∫ª</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#khong-co-khai-niem-muc-ƒëo-co-lap">Kh√¥ng c√≥ kh√°i ni·ªám m·ª©c ƒë·ªô c√¥ l·∫≠p</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#khong-ƒëam-bao-nguyen-tu">Kh√¥ng ƒë·∫£m b·∫£o nguy√™n t·ª≠</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#redis-co-nhung-phuong-phap-nao-ƒëe-duy-tri-du-lieu-va-lam-the-nao-ƒëe-cau-hinh-tren-moi-truong-thuc-te">Redis c√≥ nh·ªØng ph∆∞∆°ng ph√°p n√†o ƒë·ªÉ duy tr√¨ d·ªØ li·ªáu, v√† l√†m th·∫ø n√†o ƒë·ªÉ c·∫•u h√¨nh tr√™n m√¥i tr∆∞·ªùng th·ª±c t·∫ø?</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#rdb-snapshot">RDB (Snapshot)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#aof-append-only-file">AOF (Append Only File)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ket-hop-rdb-va-aof">K·∫øt h·ª£p RDB v√† AOF</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#nguyen-ly-redisson-trong-viec-thuc-hien-khoa-phan-tan">Nguy√™n l√Ω Redisson trong vi·ªác th·ª±c hi·ªán kh√≥a ph√¢n t√°n</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#cac-yeu-to-can-xem-xet-khi-thuc-hien-khoa-phan-tan">C√°c y·∫øu t·ªë c·∫ßn xem x√©t khi th·ª±c hi·ªán kh√≥a ph√¢n t√°n:</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cap-ƒëinh-ly-va-ly-thuyet-base-la-gi">CAP ƒë·ªãnh l√Ω v√† L√Ω thuy·∫øt BASE l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#nguoi-phong-van-hoi-ban-biet-cach-viet-mot-ƒëoan-ma-java-tao-ra-deadlock-khong">Ng∆∞·ªùi ph·ªèng v·∫•n h·ªèi b·∫°n bi·∫øt c√°ch vi·∫øt m·ªôt ƒëo·∫°n m√£ Java t·∫°o ra deadlock kh√¥ng?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#chi-muc-an-trong-mysql-8">Ch·ªâ m·ª•c ·∫©n trong MySQL 8</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#phuong-thuc-ƒëuoc-sua-ƒëoi-boi-private-co-the-truy-cap-thong-qua-phan-chieu-vay-y-nghia-cua-private-la-gi">Ph∆∞∆°ng th·ª©c ƒë∆∞·ª£c s·ª≠a ƒë·ªïi b·ªüi private c√≥ th·ªÉ truy c·∫≠p th√¥ng qua ph·∫£n chi·∫øu, v·∫≠y √Ω nghƒ©a c·ªßa private l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#tinh-nang-moi-cua-mysql8-chi-muc-sap-xep-theo-thu-tu-giam-dan">T√≠nh nƒÉng m·ªõi c·ªßa MySQL8 - Ch·ªâ m·ª•c s·∫Øp x·∫øp theo th·ª© t·ª± gi·∫£m d·∫ßn</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#tinh-nang-moi-cua-mysql8-thay-ƒëoi-bo-ky-tu-mac-ƒëinh">T√≠nh nƒÉng m·ªõi c·ªßa MySQL8 - Thay ƒë·ªïi b·ªô k√Ω t·ª± m·∫∑c ƒë·ªãnh</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#bat-ngo-mysql8-ƒëa-loai-bo-bo-nho-ƒëem-truy-van">B·∫•t ng·ªù: MySQL8 ƒë√£ lo·∫°i b·ªè b·ªô nh·ªõ ƒë·ªám truy v·∫•n!!!</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#bo-nho-ƒëem-truy-van">B·ªô nh·ªõ ƒë·ªám truy v·∫•n</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#nguyen-ly-hoat-ƒëong">Nguy√™n l√Ω ho·∫°t ƒë·ªông</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h1 id="hoanh-thanh-tong-hop-cau-hoi-phong-van-java" tabindex="-1"><a class="header-anchor" href="#hoanh-thanh-tong-hop-cau-hoi-phong-van-java"><span>Ho√†nh th√†nh t·ªïng h·ª£p c√¢u h·ªèi ph·ªèng v·∫•n Java</span></a></h1><div class="hint-container info"><p class="hint-container-title">Info</p><p>T·ªïng h·ª£p c√¢u h·ªèi c·ªßa to√†n b·ªô, kh√¥ng ph·∫£i ch·ªâ v·ªÅ JAVA!</p></div><h2 id="su-khac-biet-giua-jdk-jre-va-jvm" tabindex="-1"><a class="header-anchor" href="#su-khac-biet-giua-jdk-jre-va-jvm"><span>S·ª± kh√°c bi·ªát gi·ªØa JDK, JRE v√† JVM</span></a></h2><ul><li><strong>JDK</strong> (Java SE Development Kit) l√† b·ªô c√¥ng c·ª• ph√°t tri·ªÉn ti√™u chu·∫©n c·ªßa Java, cung c·∫•p c√°c c√¥ng c·ª• v√† t√†i nguy√™n c·∫ßn thi·∫øt ƒë·ªÉ <strong>bi√™n d·ªãch</strong> v√† <strong>ch·∫°y</strong> ch∆∞∆°ng tr√¨nh Java, bao g·ªìm <strong>tr√¨nh bi√™n d·ªãch Java</strong>, <strong>m√¥i tr∆∞·ªùng ch·∫°y Java</strong>, v√† c√°c <strong>th∆∞ vi·ªán l·ªõp Java</strong> th√¥ng d·ª•ng.</li><li><strong>JRE</strong> (Java Runtime Environment) l√† m√¥i tr∆∞·ªùng ch·∫°y Java, ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ <strong>ch·∫°y</strong> c√°c t·ªáp bytecode c·ªßa Java. JRE bao g·ªìm JVM v√† c√°c th∆∞ vi·ªán c·∫ßn thi·∫øt ƒë·ªÉ JVM ho·∫°t ƒë·ªông. Ng∆∞·ªùi d√πng th√¥ng th∆∞·ªùng ch·ªâ c·∫ßn c√†i ƒë·∫∑t JRE ƒë·ªÉ ch·∫°y ch∆∞∆°ng tr√¨nh Java, trong khi nh√† ph√°t tri·ªÉn c·∫ßn c√†i ƒë·∫∑t JDK ƒë·ªÉ bi√™n d·ªãch v√† g·ª° l·ªói ch∆∞∆°ng tr√¨nh.</li><li><strong>JVM</strong> (Java Virtual Machine) l√† m√°y ·∫£o Java, m·ªôt ph·∫ßn c·ªßa JRE v√† l√† ph·∫ßn quan tr·ªçng nh·∫•t c·ªßa Java ƒë·ªÉ hi·ªán th·ª±c h√≥a kh·∫£ nƒÉng ƒëa n·ªÅn t·∫£ng, ch·ªãu tr√°ch nhi·ªám ch·∫°y c√°c t·ªáp bytecode.</li></ul><p>Ch√∫ng ta c√≥ th·ªÉ vi·∫øt m√£ Java b·∫±ng m·ªôt t·ªáp tin txt, nh∆∞ng m√£ Java sau khi vi·∫øt c·∫ßn ƒë∆∞·ª£c bi√™n d·ªãch th√†nh bytecode ƒë·ªÉ c√≥ th·ªÉ ch·∫°y ƒë∆∞·ª£c. ƒê·ªÉ l√†m ƒëi·ªÅu n√†y, ta c·∫ßn tr√¨nh bi√™n d·ªãch, v√† JDK bao g·ªìm tr√¨nh bi√™n d·ªãch <strong>javac</strong>. Sau khi m√£ Java ƒë∆∞·ª£c bi√™n d·ªãch th√†nh bytecode, JVM (m√°y ·∫£o Java) s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ th·ª±c thi bytecode ƒë√≥.</p><p>N·∫øu ch√∫ng ta mu·ªën ph√°t tri·ªÉn ch∆∞∆°ng tr√¨nh Java, th√¨ c·∫ßn JDK ƒë·ªÉ bi√™n d·ªãch c√°c t·ªáp ngu·ªìn Java. N·∫øu ch·ªâ mu·ªën ch·∫°y c√°c t·ªáp bytecode Java ƒë√£ ƒë∆∞·ª£c bi√™n d·ªãch s·∫µn, t·ª©c l√† c√°c t·ªáp <code>*.class</code>, th√¨ ch·ªâ c·∫ßn JRE. JDK bao g·ªìm JRE, v√† JRE bao g·ªìm JVM.</p><p>Ngo√†i ra, khi JVM th·ª±c thi bytecode Java, n√≥ c·∫ßn chuy·ªÉn bytecode th√†nh l·ªánh m√°y, m√† l·ªánh m√°y tr√™n c√°c h·ªá ƒëi·ªÅu h√†nh kh√°c nhau c√≥ th·ªÉ kh√°c nhau. Do ƒë√≥, JVM tr√™n c√°c h·ªá ƒëi·ªÅu h√†nh kh√°c nhau c≈©ng kh√¥ng gi·ªëng nhau, v√¨ v·∫≠y khi c√†i ƒë·∫∑t JDK, ta c·∫ßn ch·ªçn ƒë√∫ng h·ªá ƒëi·ªÅu h√†nh.</p><p>Th√™m v√†o ƒë√≥, JVM ch·ªâ th·ª±c thi bytecode Java, do ƒë√≥ b·∫•t k·ª≥ m√£ n√†o sau khi bi√™n d·ªãch th√†nh bytecode Java ƒë·ªÅu c√≥ th·ªÉ ch·∫°y tr√™n JVM, ch·∫≥ng h·∫°n nh∆∞ Apache Groovy, Scala, Kotlin,...</p><h2 id="moi-quan-he-giua-hashcode-va-equals" tabindex="-1"><a class="header-anchor" href="#moi-quan-he-giua-hashcode-va-equals"><span>M·ªëi quan h·ªá gi·ªØa hashCode() v√† equals()</span></a></h2><p>Trong Java, m·ªói ƒë·ªëi t∆∞·ª£ng ƒë·ªÅu c√≥ th·ªÉ g·ªçi ph∆∞∆°ng th·ª©c hashCode() c·ªßa n√≥ ƒë·ªÉ l·∫•y gi√° tr·ªã hash (hashCode), t∆∞∆°ng t·ª± nh∆∞ d·∫•u v√¢n tay c·ªßa ƒë·ªëi t∆∞·ª£ng. Th√¥ng th∆∞·ªùng, kh√¥ng c√≥ hai d·∫•u v√¢n tay n√†o gi·ªëng nhau ho√†n to√†n, nh∆∞ng trong Java, kh√¥ng th·ªÉ ƒë·∫£m b·∫£o ƒëi·ªÅu n√†y tuy·ªát ƒë·ªëi. Tuy nhi√™n, ta v·∫´n c√≥ th·ªÉ s·ª≠ d·ª•ng hashCode ƒë·ªÉ l√†m m·ªôt s·ªë ph√°n ƒëo√°n ban ƒë·∫ßu, v√≠ d·ª•:</p><ul><li>N·∫øu hashCode c·ªßa hai ƒë·ªëi t∆∞·ª£ng kh√°c nhau, th√¨ ch·∫Øc ch·∫Øn ch√∫ng l√† hai ƒë·ªëi t∆∞·ª£ng kh√°c nhau.</li><li>N·∫øu hashCode c·ªßa hai ƒë·ªëi t∆∞·ª£ng gi·ªëng nhau, kh√¥ng ƒë·∫£m b·∫£o r·∫±ng ch√∫ng l√† c√πng m·ªôt ƒë·ªëi t∆∞·ª£ng, m√† c√≥ th·ªÉ l√† hai ƒë·ªëi t∆∞·ª£ng kh√°c nhau.</li><li>N·∫øu hai ƒë·ªëi t∆∞·ª£ng b·∫±ng nhau, th√¨ hashCode c·ªßa ch√∫ng ch·∫Øc ch·∫Øn gi·ªëng nhau.</li></ul><p>Trong m·ªôt s·ªë l·ªõp Collection c·ªßa Java, khi so s√°nh hai ƒë·ªëi t∆∞·ª£ng xem ch√∫ng c√≥ b·∫±ng nhau hay kh√¥ng, s·∫Ω tu√¢n theo nguy√™n t·∫Øc tr√™n. Tr∆∞·ªõc ti√™n s·∫Ω g·ªçi ph∆∞∆°ng th·ª©c hashCode() c·ªßa ƒë·ªëi t∆∞·ª£ng ƒë·ªÉ so s√°nh. N·∫øu hashCode kh√°c nhau, c√≥ th·ªÉ tr·ª±c ti·∫øp k·∫øt lu·∫≠n r·∫±ng hai ƒë·ªëi t∆∞·ª£ng n√†y kh√°c nhau. N·∫øu hashCode gi·ªëng nhau, s·∫Ω g·ªçi ti·∫øp ph∆∞∆°ng th·ª©c equals() ƒë·ªÉ so s√°nh. Ph∆∞∆°ng th·ª©c equals() l√† ƒë·ªÉ x√°c ƒë·ªãnh cu·ªëi c√πng xem hai ƒë·ªëi t∆∞·ª£ng c√≥ b·∫±ng nhau kh√¥ng. Th∆∞·ªùng th√¨ ph∆∞∆°ng th·ª©c equals() c√≥ logic so s√°nh ph·ª©c t·∫°p h∆°n v√† n·∫∑ng h∆°n so v·ªõi hashCode(), trong khi hashCode() ch·ªâ tr·∫£ v·ªÅ m·ªôt gi√° tr·ªã s·ªë, n√™n nh·∫π h∆°n v√† nhanh h∆°n.</p><p>Do ƒë√≥, c·∫ßn l∆∞u √Ω r·∫±ng n·∫øu ch√∫ng ta ghi ƒë√® ph∆∞∆°ng th·ª©c equals(), th√¨ c≈©ng c·∫ßn ƒë·∫£m b·∫£o r·∫±ng ph∆∞∆°ng th·ª©c hashCode() tu√¢n th·ªß c√°c quy t·∫Øc tr√™n.</p><h2 id="su-khac-biet-giua-string-stringbuffer-va-stringbuilder" tabindex="-1"><a class="header-anchor" href="#su-khac-biet-giua-string-stringbuffer-va-stringbuilder"><span>S·ª± kh√°c bi·ªát gi·ªØa String, StringBuffer v√† StringBuilder</span></a></h2><ol><li><strong>String</strong> l√† b·∫•t bi·∫øn, n·∫øu c·ªë g·∫Øng thay ƒë·ªïi, s·∫Ω t·∫°o ra m·ªôt ƒë·ªëi t∆∞·ª£ng chu·ªói m·ªõi. <strong>StringBuffer</strong> v√† <strong>StringBuilder</strong> l√† c√≥ th·ªÉ thay ƒë·ªïi.</li><li><strong>StringBuffer</strong> an to√†n trong m√¥i tr∆∞·ªùng ƒëa lu·ªìng, trong khi <strong>StringBuilder</strong> kh√¥ng an to√†n, v√¨ v·∫≠y StringBuilder s·∫Ω hi·ªáu qu·∫£ h∆°n trong m√¥i tr∆∞·ªùng ƒë∆°n lu·ªìng.</li></ol><h2 id="su-khac-biet-giua-extends-va-super-trong-generic" tabindex="-1"><a class="header-anchor" href="#su-khac-biet-giua-extends-va-super-trong-generic"><span>S·ª± kh√°c bi·ªát gi·ªØa <code>extends</code> v√† <code>super</code> trong generic</span></a></h2><ol><li><code>&lt;? extends T&gt;</code> bi·ªÉu th·ªã b·∫•t k·ª≥ l·ªõp con n√†o c·ªßa T, bao g·ªìm c·∫£ T.</li><li><code>&lt;? super T&gt;</code> bi·ªÉu th·ªã b·∫•t k·ª≥ l·ªõp cha n√†o c·ªßa T, bao g·ªìm c·∫£ T.</li></ol><h2 id="su-khac-biet-giua-va-equals" tabindex="-1"><a class="header-anchor" href="#su-khac-biet-giua-va-equals"><span>S·ª± kh√°c bi·ªát gi·ªØa <code>==</code> v√† <code>equals</code></span></a></h2><ul><li><code>==</code>: N·∫øu l√† ki·ªÉu d·ªØ li·ªáu c∆° b·∫£n, so s√°nh gi√° tr·ªã; n·∫øu l√† ki·ªÉu ƒë·ªëi t∆∞·ª£ng, so s√°nh ƒë·ªãa ch·ªâ tham chi·∫øu.</li><li><code>equals</code>: T√πy thu·ªôc v√†o c√°ch m·ªói l·ªõp ghi ƒë√® ph∆∞∆°ng th·ª©c equals() sau ƒë√≥. V√≠ d·ª•, v·ªõi l·ªõp String, m·∫∑c d√π l√† ki·ªÉu ƒë·ªëi t∆∞·ª£ng, nh∆∞ng l·ªõp String ƒë√£ ghi ƒë√® ph∆∞∆°ng th·ª©c equals() ƒë·ªÉ so s√°nh n·ªôi dung c√°c k√Ω t·ª± c·ªßa chu·ªói.</li></ul><h2 id="su-khac-biet-giua-overload-va-override" tabindex="-1"><a class="header-anchor" href="#su-khac-biet-giua-overload-va-override"><span>S·ª± kh√°c bi·ªát gi·ªØa Overload v√† Override</span></a></h2><ul><li><strong>Overload</strong>: Trong m·ªôt l·ªõp, n·∫øu c√°c ph∆∞∆°ng th·ª©c c√πng t√™n c√≥ danh s√°ch tham s·ªë kh√°c nhau (nh∆∞ kh√°c ki·ªÉu d·ªØ li·ªáu ho·∫∑c s·ªë l∆∞·ª£ng tham s·ªë) th√¨ ƒë∆∞·ª£c coi l√† overload.</li><li><strong>Override</strong>: L√† khi m·ªôt l·ªõp con ghi ƒë√® l·∫°i ph∆∞∆°ng th·ª©c c·ªßa l·ªõp cha v·ªõi c√πng t√™n ph∆∞∆°ng th·ª©c, c√πng danh s√°ch tham s·ªë v√† ki·ªÉu tr·∫£ v·ªÅ (c√≥ th·ªÉ l√† ki·ªÉu con c·ªßa ki·ªÉu tr·∫£ v·ªÅ ph∆∞∆°ng th·ª©c trong l·ªõp cha). Ph∆∞∆°ng th·ª©c trong l·ªõp con s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng thay v√¨ ph∆∞∆°ng th·ª©c trong l·ªõp cha. L∆∞u √Ω r·∫±ng quy·ªÅn truy c·∫≠p c·ªßa ph∆∞∆°ng th·ª©c trong l·ªõp con kh√¥ng ƒë∆∞·ª£c nh·ªè h∆°n l·ªõp cha.</li></ul><h2 id="su-khac-biet-giua-list-va-set" tabindex="-1"><a class="header-anchor" href="#su-khac-biet-giua-list-va-set"><span>S·ª± kh√°c bi·ªát gi·ªØa List v√† Set</span></a></h2><ul><li><strong>List</strong>: C√≥ th·ª© t·ª±, l∆∞u tr·ªØ c√°c ƒë·ªëi t∆∞·ª£ng theo th·ª© t·ª± ch√®n v√†o, c√≥ th·ªÉ tr√πng l·∫∑p, cho ph√©p nhi·ªÅu ph·∫ßn t·ª≠ null, c√≥ th·ªÉ s·ª≠ d·ª•ng Iterator ƒë·ªÉ duy·ªát c√°c ph·∫ßn t·ª≠ ho·∫∑c s·ª≠ d·ª•ng get(int index) ƒë·ªÉ l·∫•y ph·∫ßn t·ª≠ theo ch·ªâ m·ª•c.</li><li><strong>Set</strong>: Kh√¥ng c√≥ th·ª© t·ª±, kh√¥ng cho ph√©p ph·∫ßn t·ª≠ tr√πng l·∫∑p, t·ªëi ƒëa ch·ªâ c√≥ m·ªôt ph·∫ßn t·ª≠ null, ch·ªâ c√≥ th·ªÉ duy·ªát qua c√°c ph·∫ßn t·ª≠ b·∫±ng Iterator.</li></ul><h2 id="nguyen-ly-hoat-ƒëong-cua-arraylist" tabindex="-1"><a class="header-anchor" href="#nguyen-ly-hoat-ƒëong-cua-arraylist"><span>Nguy√™n l√Ω ho·∫°t ƒë·ªông c·ªßa ArrayList</span></a></h2><ol><li>Khi kh·ªüi t·∫°o ArrayList, n·∫øu kh√¥ng ch·ªâ ƒë·ªãnh dung l∆∞·ª£ng, s·∫Ω t·∫°o m·ªôt m·∫£ng r·ªóng. N·∫øu ch·ªâ ƒë·ªãnh dung l∆∞·ª£ng, s·∫Ω t·∫°o m·∫£ng c√≥ k√≠ch th∆∞·ªõc t∆∞∆°ng ·ª©ng.</li><li>Khi th√™m ph·∫ßn t·ª≠, tr∆∞·ªõc ti√™n s·∫Ω ki·ªÉm tra dung l∆∞·ª£ng c·ªßa m·∫£ng c√≥ ƒë·ªß kh√¥ng, n·∫øu kh√¥ng ƒë·ªß s·∫Ω m·ªü r·ªông, theo quy t·∫Øc tƒÉng 1.5 l·∫ßn. Sau khi dung l∆∞·ª£ng ƒë·ªß, ph·∫ßn t·ª≠ s·∫Ω ƒë∆∞·ª£c th√™m v√†o m·∫£ng.</li><li>Khi th√™m ph·∫ßn t·ª≠ v√†o v·ªã tr√≠ c·ª• th·ªÉ, tr∆∞·ªõc ti√™n s·∫Ω ki·ªÉm tra ch·ªâ m·ª•c c√≥ v∆∞·ª£t qu√° gi·ªõi h·∫°n kh√¥ng, sau ƒë√≥ ki·ªÉm tra dung l∆∞·ª£ng, n·∫øu kh√¥ng ƒë·ªß s·∫Ω m·ªü r·ªông. Sau ƒë√≥, ph·∫ßn t·ª≠ m·ªõi s·∫Ω ƒë∆∞·ª£c th√™m v√†o v·ªã tr√≠ ch·ªâ ƒë·ªãnh v√† c√°c ph·∫ßn t·ª≠ ph√≠a sau s·∫Ω ƒë∆∞·ª£c d·ªãch chuy·ªÉn.</li><li>Khi l·∫•y ph·∫ßn t·ª≠ t·∫°i ch·ªâ m·ª•c, s·∫Ω ki·ªÉm tra xem ch·ªâ m·ª•c c√≥ h·ª£p l·ªá kh√¥ng r·ªìi l·∫•y ph·∫ßn t·ª≠ t∆∞∆°ng ·ª©ng t·ª´ m·∫£ng.</li></ol><h2 id="su-khac-biet-giua-arraylist-va-linkedlist" tabindex="-1"><a class="header-anchor" href="#su-khac-biet-giua-arraylist-va-linkedlist"><span>S·ª± kh√°c bi·ªát gi·ªØa ArrayList v√† LinkedList</span></a></h2><ol><li>C·∫•u tr√∫c d·ªØ li·ªáu kh√°c nhau, ArrayList d·ª±a tr√™n m·∫£ng, LinkedList d·ª±a tr√™n danh s√°ch li√™n k·∫øt.</li><li>Do kh√°c nhau v·ªÅ c·∫•u tr√∫c d·ªØ li·ªáu, ArrayList ph√π h·ª£p h∆°n cho vi·ªác truy v·∫•n ng·∫´u nhi√™n, trong khi LinkedList ph√π h·ª£p h∆°n cho vi·ªác x√≥a v√† th√™m ph·∫ßn t·ª≠. ƒê·ªô ph·ª©c t·∫°p v·ªÅ th·ªùi gian c·ªßa truy v·∫•n, th√™m v√† x√≥a c≈©ng kh√°c nhau.</li><li>C·∫£ ArrayList v√† LinkedList ƒë·ªÅu tri·ªÉn khai interface List, nh∆∞ng LinkedList c√≤n tri·ªÉn khai th√™m interface Deque, v√¨ v·∫≠y n√≥ c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng nh∆∞ m·ªôt h√†ng ƒë·ª£i.</li></ol><h2 id="co-che-mo-rong-cua-concurrenthashmap" tabindex="-1"><a class="header-anchor" href="#co-che-mo-rong-cua-concurrenthashmap"><span>C∆° ch·∫ø m·ªü r·ªông c·ªßa ConcurrentHashMap</span></a></h2><p><strong>Phi√™n b·∫£n 1.7</strong></p><ol><li>ConcurrentHashMap 1.7 ƒë∆∞·ª£c tri·ªÉn khai d·ª±a tr√™n ph√¢n ƒëo·∫°n (Segment).</li><li>M·ªói Segment t∆∞∆°ng ƒë∆∞∆°ng v·ªõi m·ªôt HashMap nh·ªè.</li><li>M·ªói Segment s·∫Ω t·ª± th·ª±c hi·ªán m·ªü r·ªông, gi·ªëng v·ªõi c√°ch HashMap m·ªü r·ªông.</li><li>ƒê·∫ßu ti√™n, t·∫°o m·ªôt m·∫£ng m·ªõi, sau ƒë√≥ chuy·ªÉn c√°c ph·∫ßn t·ª≠ v√†o m·∫£ng m·ªõi.</li><li>M·ªói Segment t·ª± x√°c ƒë·ªãnh khi n√†o c·∫ßn m·ªü r·ªông, b·∫±ng c√°ch ki·ªÉm tra xem c√≥ v∆∞·ª£t ng∆∞·ª°ng kh√¥ng.</li></ol><p><strong>Phi√™n b·∫£n 1.8</strong></p><ol><li>ConcurrentHashMap 1.8 kh√¥ng c√≤n d·ª±a tr√™n Segment.</li><li>Khi m·ªôt lu·ªìng th·ª±c hi·ªán put m√† ph√°t hi·ªán ConcurrentHashMap ƒëang m·ªü r·ªông, lu·ªìng ƒë√≥ s·∫Ω tham gia v√†o vi·ªác m·ªü r·ªông.</li><li>N·∫øu kh√¥ng c√≥ qu√° tr√¨nh m·ªü r·ªông di·ªÖn ra, lu·ªìng s·∫Ω th√™m key-value v√†o ConcurrentHashMap v√† ki·ªÉm tra xem c√≥ v∆∞·ª£t ng∆∞·ª°ng kh√¥ng, n·∫øu c√≥ s·∫Ω m·ªü r·ªông.</li><li>ConcurrentHashMap h·ªó tr·ª£ nhi·ªÅu lu·ªìng m·ªü r·ªông c√πng l√∫c.</li><li>Tr∆∞·ªõc khi m·ªü r·ªông, s·∫Ω t·∫°o m·ªôt m·∫£ng m·ªõi.</li><li>Khi chuy·ªÉn c√°c ph·∫ßn t·ª≠, s·∫Ω ph√¢n chia m·∫£ng c≈© th√†nh c√°c nh√≥m v√† m·ªói lu·ªìng s·∫Ω ch·ªãu tr√°ch nhi·ªám chuy·ªÉn m·ªôt ho·∫∑c nhi·ªÅu nh√≥m ph·∫ßn t·ª≠.</li></ol><h2 id="nhung-thay-ƒëoi-tu-jdk1-7-ƒëen-jdk1-8-trong-hashmap-phan-co-ban" tabindex="-1"><a class="header-anchor" href="#nhung-thay-ƒëoi-tu-jdk1-7-ƒëen-jdk1-8-trong-hashmap-phan-co-ban"><span>Nh·ªØng thay ƒë·ªïi t·ª´ JDK1.7 ƒë·∫øn JDK1.8 trong HashMap (ph·∫ßn c∆° b·∫£n)</span></a></h2><ol><li>Trong JDK1.7, c·∫•u tr√∫c d·ªØ li·ªáu c∆° b·∫£n l√† m·∫£ng + danh s√°ch li√™n k·∫øt, trong JDK1.8 l√† m·∫£ng + danh s√°ch li√™n k·∫øt + c√¢y ƒë·ªè ƒëen. Vi·ªác th√™m c√¢y ƒë·ªè ƒëen nh·∫±m n√¢ng cao hi·ªáu su·∫•t ch√®n v√† t√¨m ki·∫øm trong HashMap.</li><li>Trong JDK1.7, danh s√°ch li√™n k·∫øt ƒë∆∞·ª£c ch√®n b·∫±ng c√°ch <strong>ch√®n v√†o ƒë·∫ßu</strong>, trong JDK1.8, danh s√°ch li√™n k·∫øt ƒë∆∞·ª£c ch√®n b·∫±ng c√°ch <strong>ch√®n v√†o ƒëu√¥i</strong>, b·ªüi v√¨ trong JDK1.8, khi ch√®n c·∫∑p kh√≥a v√† gi√° tr·ªã c·∫ßn ph·∫£i ki·ªÉm tra s·ªë l∆∞·ª£ng ph·∫ßn t·ª≠ trong danh s√°ch, do ƒë√≥ ch√®n v√†o ƒëu√¥i l√† h·ª£p l√Ω.</li><li>Trong JDK1.7, thu·∫≠t to√°n bƒÉm kh√° ph·ª©c t·∫°p, bao g·ªìm nhi·ªÅu ph√©p d·ªãch ph·∫£i v√† XOR, c√≤n trong JDK1.8, thu·∫≠t to√°n n√†y ƒë√£ ƒë∆∞·ª£c ƒë∆°n gi·∫£n h√≥a. V√¨ m·ª•c ƒë√≠ch c·ªßa thu·∫≠t to√°n bƒÉm ph·ª©c t·∫°p l√† c·∫£i thi·ªán t√≠nh ph√¢n t√°n, nh∆∞ng v·ªõi s·ª± b·ªï sung c·ªßa c√¢y ƒë·ªè ƒëen trong JDK1.8, vi·ªác ƒë∆°n gi·∫£n h√≥a thu·∫≠t to√°n n√†y gi√∫p ti·∫øt ki·ªám t√†i nguy√™n CPU.</li></ol><h2 id="quy-trinh-phuong-thuc-put-cua-hashmap" tabindex="-1"><a class="header-anchor" href="#quy-trinh-phuong-thuc-put-cua-hashmap"><span>Quy tr√¨nh ph∆∞∆°ng th·ª©c <code>put</code> c·ªßa HashMap</span></a></h2><p>Quy tr√¨nh c∆° b·∫£n c·ªßa ph∆∞∆°ng th·ª©c <code>put</code> trong HashMap:</p><ol><li>T√≠nh ch·ªâ s·ªë m·∫£ng t·ª´ kh√≥a th√¥ng qua thu·∫≠t to√°n bƒÉm.</li><li>N·∫øu ch·ªâ s·ªë ƒë√≥ trong m·∫£ng tr·ªëng, th√¨ ƒë√≥ng g√≥i c·∫∑p kh√≥a-gi√° tr·ªã v√†o ƒë·ªëi t∆∞·ª£ng <code>Entry</code> (trong JDK1.7 l√† <code>Entry</code>, trong JDK1.8 l√† <code>Node</code>) v√† ƒë·∫∑t v√†o v·ªã tr√≠ ƒë√≥.</li><li>N·∫øu v·ªã tr√≠ ƒë√≥ kh√¥ng tr·ªëng, th√¨ x·ª≠ l√Ω t√πy theo tr∆∞·ªùng h·ª£p: <ol><li>Trong JDK1.7, ki·ªÉm tra xem c√≥ c·∫ßn m·ªü r·ªông kh√¥ng, n·∫øu c√≥ th√¨ th·ª±c hi·ªán m·ªü r·ªông, n·∫øu kh√¥ng th√¨ t·∫°o ƒë·ªëi t∆∞·ª£ng <code>Entry</code> m·ªõi v√† th√™m v√†o danh s√°ch li√™n k·∫øt b·∫±ng c√°ch <strong>ch√®n v√†o ƒë·∫ßu</strong>.</li><li>Trong JDK1.8, tr∆∞·ªõc ti√™n ki·ªÉm tra lo·∫°i n√∫t <code>Node</code> hi·ªán t·∫°i, c√≥ th·ªÉ l√† n√∫t c·ªßa c√¢y ƒë·ªè ƒëen ho·∫∑c danh s√°ch li√™n k·∫øt. <ol><li>N·∫øu l√† n√∫t c√¢y ƒë·ªè ƒëen, ƒë√≥ng g√≥i c·∫∑p kh√≥a-gi√° tr·ªã th√†nh m·ªôt n√∫t c√¢y ƒë·ªè ƒëen m·ªõi v√† th√™m v√†o c√¢y. Trong qu√° tr√¨nh n√†y, ki·ªÉm tra xem c√¢y c√≥ ch·ª©a kh√≥a hi·ªán t·∫°i kh√¥ng, n·∫øu c√≥ th√¨ c·∫≠p nh·∫≠t gi√° tr·ªã.</li><li>N·∫øu l√† n√∫t danh s√°ch li√™n k·∫øt, ƒë√≥ng g√≥i c·∫∑p kh√≥a-gi√° tr·ªã th√†nh m·ªôt n√∫t danh s√°ch li√™n k·∫øt m·ªõi v√† th√™m v√†o ƒëu√¥i danh s√°ch. Trong qu√° tr√¨nh duy·ªát danh s√°ch, n·∫øu ph√°t hi·ªán c√≥ kh√≥a tr√πng, th√¨ c·∫≠p nh·∫≠t gi√° tr·ªã. N·∫øu sau khi ch√®n m√† danh s√°ch c√≥ nhi·ªÅu h∆°n 8 ph·∫ßn t·ª≠, th√¨ chuy·ªÉn danh s√°ch li√™n k·∫øt th√†nh c√¢y ƒë·ªè ƒëen.</li></ol></li><li>Sau khi th√™m c·∫∑p kh√≥a-gi√° tr·ªã v√†o danh s√°ch li√™n k·∫øt ho·∫∑c c√¢y ƒë·ªè ƒëen, ki·ªÉm tra xem c√≥ c·∫ßn m·ªü r·ªông kh√¥ng, n·∫øu c·∫ßn th√¨ m·ªü r·ªông, n·∫øu kh√¥ng th√¨ k·∫øt th√∫c ph∆∞∆°ng th·ª©c <code>put</code>.</li></ol></li></ol><h2 id="su-khac-biet-giua-sao-chep-sau-va-sao-chep-nong" tabindex="-1"><a class="header-anchor" href="#su-khac-biet-giua-sao-chep-sau-va-sao-chep-nong"><span>S·ª± kh√°c bi·ªát gi·ªØa sao ch√©p s√¢u v√† sao ch√©p n√¥ng</span></a></h2><p>Sao ch√©p s√¢u v√† sao ch√©p n√¥ng li√™n quan ƒë·∫øn vi·ªác sao ch√©p m·ªôt ƒë·ªëi t∆∞·ª£ng, trong ƒë√≥ c√≥ hai lo·∫°i thu·ªôc t√≠nh: ki·ªÉu d·ªØ li·ªáu c∆° b·∫£n v√† tham chi·∫øu ƒë·∫øn ƒë·ªëi t∆∞·ª£ng kh√°c.</p><ol><li><strong>Sao ch√©p n√¥ng</strong> ch·ªâ sao ch√©p c√°c gi√° tr·ªã c·ªßa ki·ªÉu d·ªØ li·ªáu c∆° b·∫£n v√† ƒë·ªãa ch·ªâ tham chi·∫øu c·ªßa ƒë·ªëi t∆∞·ª£ng kh√°c, kh√¥ng sao ch√©p ƒë·ªëi t∆∞·ª£ng m√† tham chi·∫øu ƒë√≥ tr·ªè ƒë·∫øn. K·∫øt qu·∫£ l√†, c√°c ƒë·ªëi t∆∞·ª£ng sao ch√©p n√¥ng c√≥ c√πng tham chi·∫øu ƒë·∫øn m·ªôt ƒë·ªëi t∆∞·ª£ng chung.</li><li><strong>Sao ch√©p s√¢u</strong> sao ch√©p c·∫£ gi√° tr·ªã c·ªßa ki·ªÉu d·ªØ li·ªáu c∆° b·∫£n v√† sao ch√©p c·∫£ ƒë·ªëi t∆∞·ª£ng m√† tham chi·∫øu tr·ªè ƒë·∫øn. K·∫øt qu·∫£ l√†, c√°c ƒë·ªëi t∆∞·ª£ng sao ch√©p s√¢u c√≥ tham chi·∫øu ƒë·∫øn c√°c ƒë·ªëi t∆∞·ª£ng kh√°c nhau.</li></ol><h2 id="co-che-mo-rong-cua-hashmap" tabindex="-1"><a class="header-anchor" href="#co-che-mo-rong-cua-hashmap"><span>C∆° ch·∫ø m·ªü r·ªông c·ªßa HashMap</span></a></h2><h3 id="phien-ban-jdk1-7" tabindex="-1"><a class="header-anchor" href="#phien-ban-jdk1-7"><span>Phi√™n b·∫£n JDK1.7</span></a></h3><ol><li>T·∫°o m·ªôt m·∫£ng m·ªõi.</li><li>Duy·ªát qua t·ª´ng v·ªã tr√≠ c·ªßa m·∫£ng c≈© v√† c√°c ph·∫ßn t·ª≠ trong danh s√°ch li√™n k·∫øt t·∫°i v·ªã tr√≠ ƒë√≥.</li><li>T√≠nh l·∫°i ch·ªâ s·ªë m·∫£ng m·ªõi cho t·ª´ng ph·∫ßn t·ª≠ d·ª±a tr√™n chi·ªÅu d√†i m·∫£ng m·ªõi.</li><li>Th√™m ph·∫ßn t·ª≠ v√†o m·∫£ng m·ªõi.</li><li>Sau khi t·∫•t c·∫£ ph·∫ßn t·ª≠ ƒë√£ ƒë∆∞·ª£c chuy·ªÉn sang m·∫£ng m·ªõi, g√°n m·∫£ng m·ªõi cho thu·ªôc t√≠nh <code>table</code> c·ªßa ƒë·ªëi t∆∞·ª£ng HashMap.</li></ol><h3 id="phien-ban-jdk1-8" tabindex="-1"><a class="header-anchor" href="#phien-ban-jdk1-8"><span>Phi√™n b·∫£n JDK1.8</span></a></h3><ol><li>T·∫°o m·ªôt m·∫£ng m·ªõi.</li><li>Duy·ªát qua t·ª´ng v·ªã tr√≠ c·ªßa m·∫£ng c≈©, bao g·ªìm danh s√°ch li√™n k·∫øt v√† c√¢y ƒë·ªè ƒëen.</li><li>N·∫øu l√† danh s√°ch li√™n k·∫øt, t√≠nh l·∫°i ch·ªâ s·ªë v√† th√™m t·ª´ng ph·∫ßn t·ª≠ v√†o m·∫£ng m·ªõi.</li><li>N·∫øu l√† c√¢y ƒë·ªè ƒëen: <ol><li>Duy·ªát qua t·ª´ng ph·∫ßn t·ª≠ trong c√¢y v√† t√≠nh ch·ªâ s·ªë trong m·∫£ng m·ªõi.</li><li>N·∫øu s·ªë ph·∫ßn t·ª≠ t·∫°i m·ªôt ch·ªâ s·ªë l·ªõn h∆°n 8, t·∫°o m·ªôt c√¢y ƒë·ªè ƒëen m·ªõi v√† th√™m v√†o v·ªã tr√≠ ƒë√≥.</li><li>N·∫øu s·ªë ph·∫ßn t·ª≠ nh·ªè h∆°n ho·∫∑c b·∫±ng 6, t·∫°o danh s√°ch li√™n k·∫øt v√† th√™m v√†o v·ªã tr√≠ ƒë√≥.</li></ol></li><li>Sau khi t·∫•t c·∫£ ph·∫ßn t·ª≠ ƒë√£ ƒë∆∞·ª£c chuy·ªÉn sang m·∫£ng m·ªõi, g√°n m·∫£ng m·ªõi cho thu·ªôc t√≠nh <code>table</code> c·ªßa HashMap.</li></ol><h2 id="nguyen-ly-cua-copyonwritearraylist" tabindex="-1"><a class="header-anchor" href="#nguyen-ly-cua-copyonwritearraylist"><span>Nguy√™n l√Ω c·ªßa CopyOnWriteArrayList</span></a></h2><ol><li><strong>CopyOnWriteArrayList</strong> s·ª≠ d·ª•ng m·∫£ng b√™n trong ƒë·ªÉ l∆∞u tr·ªØ d·ªØ li·ªáu. Khi th√™m m·ªôt ph·∫ßn t·ª≠, n√≥ s·∫Ω sao ch√©p m·ªôt m·∫£ng m·ªõi, c√°c thao t√°c ghi s·∫Ω th·ª±c hi·ªán tr√™n m·∫£ng m·ªõi, c√≤n c√°c thao t√°c ƒë·ªçc s·∫Ω th·ª±c hi·ªán tr√™n m·∫£ng c≈©.</li><li>C√°c thao t√°c ghi ƒë∆∞·ª£c kh√≥a ƒë·ªÉ ngƒÉn ng·ª´a s·ª± c·ªë ghi d·ªØ li·ªáu ƒë·ªìng th·ªùi.</li><li>Sau khi k·∫øt th√∫c ghi, m·∫£ng c≈© s·∫Ω ƒë∆∞·ª£c thay th·∫ø b·∫±ng m·∫£ng m·ªõi.</li><li><strong>CopyOnWriteArrayList</strong> ph√π h·ª£p v·ªõi c√°c t√¨nh hu·ªëng ƒë·ªçc nhi·ªÅu ghi √≠t, v√¨ cho ph√©p ƒë·ªçc trong khi ƒëang th·ª±c hi·ªán ghi m√† kh√¥ng c·∫ßn kh√≥a ƒë·ªçc.</li></ol><h2 id="bytecode-la-gi-loi-ich-cua-viec-su-dung-bytecode-la-gi" tabindex="-1"><a class="header-anchor" href="#bytecode-la-gi-loi-ich-cua-viec-su-dung-bytecode-la-gi"><span>Bytecode l√† g√¨? L·ª£i √≠ch c·ªßa vi·ªác s·ª≠ d·ª•ng bytecode l√† g√¨?</span></a></h2><p>B·ªô bi√™n d·ªãch (<code>javac</code>) s·∫Ω bi√™n d·ªãch m√£ ngu·ªìn Java (<code>*.java</code>) th√†nh t·ªáp bytecode (<code>*.class</code>), gi√∫p m√£ Java c√≥ th·ªÉ <strong>bi√™n d·ªãch m·ªôt l·∫ßn v√† ch·∫°y ·ªü nhi·ªÅu n∆°i</strong>. C√°c t·ªáp class c√≥ th·ªÉ ch·∫°y tr√™n nhi·ªÅu h·ªá ƒëi·ªÅu h√†nh kh√°c nhau. Tuy nhi√™n, ƒë·ªÉ th·ª±c hi·ªán ƒëi·ªÅu n√†y, c√°c h·ªá ƒëi·ªÅu h√†nh c·∫ßn c√≥ c√°c phi√™n b·∫£n JDK ho·∫∑c JRE kh√°c nhau, v√¨ bytecode c·∫ßn ƒë∆∞·ª£c chuy·ªÉn th√†nh m√£ m√°y kh√°c nhau tr√™n c√°c h·ªá ƒëi·ªÅu h√†nh.</p><p>L·ª£i √≠ch c·ªßa vi·ªác s·ª≠ d·ª•ng bytecode l√† gi√∫p Java c√≥ kh·∫£ nƒÉng <strong>ƒëa n·ªÅn t·∫£ng</strong> v√† <strong>tƒÉng hi·ªáu su·∫•t</strong> th·ª±c thi. B·ªô bi√™n d·ªãch c√≥ th·ªÉ t·ªëi ∆∞u h√≥a m√£ trong qu√° tr√¨nh bi√™n d·ªãch, ch·∫≥ng h·∫°n nh∆∞ lo·∫°i b·ªè kh√≥a, thay th·∫ø ƒë·∫°i l∆∞·ª£ng, ho·∫∑c n·ªôi tuy·∫øn ph∆∞∆°ng th·ª©c.</p><h2 id="he-thong-xu-ly-ngoai-le-trong-java" tabindex="-1"><a class="header-anchor" href="#he-thong-xu-ly-ngoai-le-trong-java"><span>H·ªá th·ªëng x·ª≠ l√Ω ngo·∫°i l·ªá trong Java</span></a></h2><ul><li>T·∫•t c·∫£ c√°c ngo·∫°i l·ªá trong Java ƒë·ªÅu b·∫Øt ngu·ªìn t·ª´ l·ªõp cha cao nh·∫•t l√† <strong>Throwable</strong>.</li><li><strong>Throwable</strong> c√≥ hai l·ªõp con ch√≠nh l√† <strong>Exception</strong> v√† <strong>Error</strong>.</li><li><strong>Error</strong> ƒë·∫°i di·ªán cho c√°c l·ªói nghi√™m tr·ªçng nh∆∞ <code>java.lang.StackOverFlowError</code> v√† <code>Java.lang.OutOfMemoryError</code>, th∆∞·ªùng nh·ªØng l·ªói n√†y kh√¥ng th·ªÉ ƒë∆∞·ª£c x·ª≠ l√Ω b·ªüi ch∆∞∆°ng tr√¨nh. Ch√∫ng th∆∞·ªùng l√† v·∫•n ƒë·ªÅ ·ªü c·∫•p ƒë·ªô m√°y ·∫£o, ƒëƒ©a ho·∫∑c h·ªá ƒëi·ªÅu h√†nh, do ƒë√≥, kh√¥ng khuy·∫øn ngh·ªã x·ª≠ l√Ω ch√∫ng trong m√£ v√¨ ch∆∞∆°ng tr√¨nh c√≥ th·ªÉ ƒë√£ ng·ª´ng ho·∫°t ƒë·ªông.</li><li><strong>Exception</strong> ƒë·∫°i di·ªán cho c√°c ngo·∫°i l·ªá m√† ch∆∞∆°ng tr√¨nh c√≥ th·ªÉ x·ª≠ l√Ω, nh∆∞ <code>NullPointerException</code> ho·∫∑c <code>IllegalAccessException</code>. Ch√∫ng ta c√≥ th·ªÉ b·∫Øt c√°c ngo·∫°i l·ªá n√†y ƒë·ªÉ x·ª≠ l√Ω ƒë·∫∑c bi·ªát.</li><li>C√°c l·ªõp con c·ªßa <strong>Exception</strong> c√≥ th·ªÉ chia th√†nh hai lo·∫°i: <strong>RuntimeException</strong> v√† <strong>Non-RuntimeException</strong>. <ul><li><strong>RuntimeException</strong> l√† c√°c ngo·∫°i l·ªá ph√°t sinh khi ch∆∞∆°ng tr√¨nh ƒëang ch·∫°y, l√† ngo·∫°i l·ªá kh√¥ng c·∫ßn ki·ªÉm tra. Ch√∫ng ta c√≥ th·ªÉ ch·ªçn b·∫Øt ho·∫∑c kh√¥ng b·∫Øt nh·ªØng ngo·∫°i l·ªá n√†y, th∆∞·ªùng l√† do l·ªói logic ch∆∞∆°ng tr√¨nh, v√≠ d·ª•: <code>NullPointerException</code>, <code>IndexOutOfBoundsException</code>.</li><li><strong>Non-RuntimeException</strong> l√† ngo·∫°i l·ªá c·∫ßn ki·ªÉm tra v√† b·∫Øt bu·ªôc ph·∫£i x·ª≠ l√Ω, v√≠ d·ª•: <code>IOException</code>, <code>SQLException</code> ho·∫∑c c√°c ngo·∫°i l·ªá do ng∆∞·ªùi d√πng t·ª± ƒë·ªãnh nghƒ©a.</li></ul></li></ul><h2 id="trong-co-che-xu-ly-ngoai-le-cua-java-khi-nao-nen-nem-ngoai-le-va-khi-nao-nen-bat-ngoai-le" tabindex="-1"><a class="header-anchor" href="#trong-co-che-xu-ly-ngoai-le-cua-java-khi-nao-nen-nem-ngoai-le-va-khi-nao-nen-bat-ngoai-le"><span>Trong c∆° ch·∫ø x·ª≠ l√Ω ngo·∫°i l·ªá c·ªßa Java, khi n√†o n√™n n√©m ngo·∫°i l·ªá v√† khi n√†o n√™n b·∫Øt ngo·∫°i l·ªá?</span></a></h2><p>Ngo·∫°i l·ªá t∆∞∆°ng ƒë∆∞∆°ng v·ªõi m·ªôt th√¥ng b√°o. N·∫øu ch√∫ng ta n√©m ngo·∫°i l·ªá, ƒëi·ªÅu ƒë√≥ c√≥ nghƒ©a l√† ph∆∞∆°ng th·ª©c hi·ªán t·∫°i kh√¥ng th·ªÉ x·ª≠ l√Ω v√† y√™u c·∫ßu ph∆∞∆°ng th·ª©c ·ªü l·ªõp tr√™n x·ª≠ l√Ω. L·ªõp tr√™n c≈©ng c·∫ßn quy·∫øt ƒë·ªãnh xem c√≥ th·ªÉ x·ª≠ l√Ω hay ti·∫øp t·ª•c n√©m ngo·∫°i l·ªá cho l·ªõp tr√™n ti·∫øp theo.</p><p>Khi vi·∫øt m·ªôt ph∆∞∆°ng th·ª©c, c·∫ßn c√¢n nh·∫Øc li·ªáu ph∆∞∆°ng th·ª©c c√≥ th·ªÉ x·ª≠ l√Ω ngo·∫°i l·ªá m·ªôt c√°ch h·ª£p l√Ω hay kh√¥ng. N·∫øu kh√¥ng, th√¨ ti·∫øp t·ª•c n√©m ngo·∫°i l·ªá. N·∫øu ph∆∞∆°ng th·ª©c ph√°t hi·ªán ngo·∫°i l·ªá khi g·ªçi m·ªôt ph∆∞∆°ng th·ª©c kh√°c, v√† ngo·∫°i l·ªá n√†y n√™n ƒë∆∞·ª£c x·ª≠ l√Ω t·∫°i ƒë√¢y, th√¨ c·∫ßn b·∫Øt v√† x·ª≠ l√Ω ngo·∫°i l·ªá ƒë√≥.</p><h2 id="generic-erasure-trong-java-la-gi" tabindex="-1"><a class="header-anchor" href="#generic-erasure-trong-java-la-gi"><span>Generic Erasure trong Java l√† g√¨?</span></a></h2><p>Trong JDK 1.5 v√† c√°c phi√™n b·∫£n tr∆∞·ªõc ƒë√≥ kh√¥ng t·ªìn t·∫°i kh√°i ni·ªám v·ªÅ generic. T·ª´ JDK 1.5 tr·ªü ƒëi, kh√°i ni·ªám generic ƒë√£ ƒë∆∞·ª£c gi·ªõi thi·ªáu ƒë·ªÉ t∆∞∆°ng th√≠ch v·ªõi c√°c phi√™n b·∫£n JDK tr∆∞·ªõc ƒë√≥, t·ª´ ƒë√≥ kh√°i ni·ªám &quot;generic erasure&quot; (x√≥a b·ªè generic) ra ƒë·ªùi.</p><figure><img src="https://cdn.nlark.com/yuque/0/2023/jpeg/365147/1690204763239-0a36e926-3b2a-40d0-821b-429ac925e563.jpeg" alt="S∆° ƒë·ªì minh h·ªça" tabindex="0" loading="lazy"><figcaption>S∆° ƒë·ªì minh h·ªça</figcaption></figure><p>D∆∞·ªõi ƒë√¢y l√† hai ki·ªÉu t∆∞∆°ng ƒë∆∞∆°ng, b·ªÅ ngo√†i generic ƒë√£ b·ªã x√≥a b·ªè, t·∫•t c·∫£ ƒë·ªÅu l√† <code>ArrayList</code>:</p><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/365147/1690198625500-1a5cfb9b-de48-4ce8-88ad-fc73a6897b11.png" alt="V√≠ d·ª• v·ªÅ ArrayList" tabindex="0" loading="lazy"><figcaption>V√≠ d·ª• v·ªÅ ArrayList</figcaption></figure><p>API d∆∞·ªõi ƒë√¢y ch·ªâ c√≥ th·ªÉ l·∫•y ƒë∆∞·ª£c s·ªë l∆∞·ª£ng generic, nh∆∞ng kh√¥ng th·ªÉ l·∫•y ƒë∆∞·ª£c lo·∫°i c·ª• th·ªÉ c·ªßa generic:</p><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/365147/1690198875882-a806955a-7613-4cb1-bc4b-c40781c2958b.png" alt="V√≠ d·ª• v·ªÅ API" tabindex="0" loading="lazy"><figcaption>V√≠ d·ª• v·ªÅ API</figcaption></figure><p>Th√¥ng qua ph·∫£n chi·∫øu (reflection), ta c√≥ th·ªÉ th√™m c√°c ph·∫ßn t·ª≠ thu·ªôc ki·ªÉu kh√°c nhau v√†o danh s√°ch (List), v√¨ ki·ªÉu th·ª±c s·ª± ƒë√£ b·ªã x√≥a b·ªè, bi·∫øn th√†nh <code>Object</code>:</p><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/365147/1690199113277-e7b32550-e3e3-4e86-b2c1-4847b615a797.png" alt="V√≠ d·ª• v·ªÅ ph·∫£n chi·∫øu" tabindex="0" loading="lazy"><figcaption>V√≠ d·ª• v·ªÅ ph·∫£n chi·∫øu</figcaption></figure><p>M·∫∑c d√π generic ƒë√£ b·ªã x√≥a b·ªè, nh∆∞ng th√¥ng tin c·ª• th·ªÉ v·ªÅ generic v·∫´n ƒë∆∞·ª£c l∆∞u tr·ªØ trong bytecode:</p><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/365147/1690199450688-73573112-c70c-4e4d-9694-11dce711d9cb.png" alt="Th√¥ng tin v·ªÅ generic trong bytecode" tabindex="0" loading="lazy"><figcaption>Th√¥ng tin v·ªÅ generic trong bytecode</figcaption></figure><p>Do ƒë√≥, v·∫´n c√≥ m·ªôt s·ªë c√°ch d·ªÖ d√†ng ƒë·ªÉ l·∫•y ƒë∆∞·ª£c ki·ªÉu th·ª±c s·ª± c·ªßa generic:</p><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/365147/1690204026748-814cb0a1-3cce-4be3-9224-0d994281976f.png" alt="C√°ch l·∫•y ki·ªÉu generic" tabindex="0" loading="lazy"><figcaption>C√°ch l·∫•y ki·ªÉu generic</figcaption></figure><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/365147/1690204033411-b32de53b-8bdf-462c-be63-9957ab8021a3.png" alt="M·ªôt s·ªë v√≠ d·ª•" tabindex="0" loading="lazy"><figcaption>M·ªôt s·ªë v√≠ d·ª•</figcaption></figure><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/365147/1690204051908-3f65da0b-5e7f-410e-80fe-f2aee29dbe2f.png" alt="C√°ch ti·∫øp c·∫≠n kh√°c" tabindex="0" loading="lazy"><figcaption>C√°ch ti·∫øp c·∫≠n kh√°c</figcaption></figure><p>Ngo√†i ra, ƒë·ªëi v·ªõi JVM, n·∫øu t·∫°o m√£ m·ª•c ti√™u cho t·ª´ng lo·∫°i generic kh√°c nhau, gi·∫£ s·ª≠ c√≥ 10 danh s√°ch (List) generic kh√°c nhau, ta s·∫Ω ph·∫£i t·∫°o ra 10 bytecode ri√™ng, ƒëi·ªÅu n√†y s·∫Ω kh√¥ng ch·ªâ l√†m m√£ tƒÉng k√≠ch th∆∞·ªõc m√† c√≤n l√†m m·ªôt bytecode t∆∞∆°ng ·ª©ng v·ªõi m·ªôt ƒë·ªëi t∆∞·ª£ng Class, chi·∫øm r·∫•t nhi·ªÅu b·ªô nh·ªõ.</p><h2 id="cac-class-loader-trong-java" tabindex="-1"><a class="header-anchor" href="#cac-class-loader-trong-java"><span>C√°c class loader trong Java</span></a></h2><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/8380143/1695284933934-d95c0fda-b61f-4fe2-900d-6aab251605a4.png" alt="Class Loader" tabindex="0" loading="lazy"><figcaption>Class Loader</figcaption></figure><p>JDK t√≠ch h·ª£p s·∫µn ba class loader:</p><ul><li><strong>Bootstrap ClassLoader</strong>: Class loader cha c·ªßa ExtClassLoader, ch·ªãu tr√°ch nhi·ªám t·∫£i c√°c file jar v√† class trong th∆∞ m·ª•c <code>%JAVA_HOME%/lib</code>.</li><li><strong>ExtClassLoader</strong>: Class loader cha c·ªßa AppClassLoader, ch·ªãu tr√°ch nhi·ªám t·∫£i c√°c file jar v√† class trong th∆∞ m·ª•c <code>%JAVA_HOME%/lib/ext</code>.</li><li><strong>AppClassLoader</strong>: Class loader cha c·ªßa c√°c class loader do ng∆∞·ªùi d√πng ƒë·ªãnh nghƒ©a, ch·ªãu tr√°ch nhi·ªám t·∫£i c√°c file class trong classpath.</li></ul><h2 id="mo-hinh-uy-quyen-theo-cha-me-cua-class-loader" tabindex="-1"><a class="header-anchor" href="#mo-hinh-uy-quyen-theo-cha-me-cua-class-loader"><span>M√¥ h√¨nh ·ªßy quy·ªÅn theo cha m·∫π c·ªßa class loader</span></a></h2><p>Trong JVM c√≥ ba class loader m·∫∑c ƒë·ªãnh:</p><ol><li>BootstrapClassLoader</li><li>ExtClassLoader</li><li>AppClassLoader</li></ol><p>AppClassLoader c√≥ ExtClassLoader l√†m class loader cha, v√† ExtClassLoader c√≥ BootstrapClassLoader l√†m cha.</p><p>Khi JVM t·∫£i m·ªôt l·ªõp, n√≥ s·∫Ω g·ªçi ph∆∞∆°ng th·ª©c <code>loadClass</code> c·ªßa AppClassLoader ƒë·ªÉ t·∫£i l·ªõp ƒë√≥. Trong ph∆∞∆°ng th·ª©c n√†y, tr∆∞·ªõc ti√™n n√≥ s·∫Ω g·ªçi ph∆∞∆°ng th·ª©c <code>loadClass</code> c·ªßa ExtClassLoader ƒë·ªÉ t·∫£i l·ªõp. T∆∞∆°ng t·ª±, trong ExtClassLoader s·∫Ω g·ªçi ph∆∞∆°ng th·ª©c <code>loadClass</code> c·ªßa BootstrapClassLoader tr∆∞·ªõc. N·∫øu BootstrapClassLoader t·∫£i th√†nh c√¥ng, qu√° tr√¨nh s·∫Ω ho√†n t·∫•t. N·∫øu kh√¥ng, ExtClassLoader s·∫Ω t·ª± th·ª≠ t·∫£i l·ªõp, n·∫øu kh√¥ng th√†nh c√¥ng, AppClassLoader s·∫Ω t·∫£i l·ªõp ƒë√≥.</p><p>V√¨ v·∫≠y, m√¥ h√¨nh ·ªßy quy·ªÅn cha m·∫π ƒë·ªÅ c·∫≠p ƒë·∫øn vi·ªác JVM ·ªßy quy·ªÅn cho ExtClassLoader v√† BootstrapClassLoader t·∫£i l·ªõp tr∆∞·ªõc, n·∫øu kh√¥ng th√†nh c√¥ng th√¨ AppClassLoader m·ªõi th·ª±c hi·ªán t·∫£i l·ªõp ƒë√≥.</p><h2 id="nhung-khu-vuc-nao-cua-jvm-ƒëuoc-chia-se-giua-cac-luong" tabindex="-1"><a class="header-anchor" href="#nhung-khu-vuc-nao-cua-jvm-ƒëuoc-chia-se-giua-cac-luong"><span>Nh·ªØng khu v·ª±c n√†o c·ªßa JVM ƒë∆∞·ª£c chia s·∫ª gi·ªØa c√°c lu·ªìng?</span></a></h2><p>V√πng Heap v√† v√πng Method l√† c√°c khu v·ª±c ƒë∆∞·ª£c t·∫•t c·∫£ c√°c lu·ªìng (threads) chia s·∫ª, trong khi Stack, Native Method Stack, v√† Program Counter l√† c√°c khu v·ª±c ri√™ng bi·ªát c·ªßa m·ªói lu·ªìng.</p><figure><img src="https://cdn.nlark.com/yuque/0/2021/png/365147/1622816824404-17d018de-eb06-41eb-9936-64e4c6cc046d.png" alt="S∆° ƒë·ªì v√πng b·ªô nh·ªõ JVM" tabindex="0" loading="lazy"><figcaption>S∆° ƒë·ªì v√πng b·ªô nh·ªõ JVM</figcaption></figure><h2 id="ban-xu-ly-cac-van-ƒëe-jvm-trong-du-an-nhu-the-nao" tabindex="-1"><a class="header-anchor" href="#ban-xu-ly-cac-van-ƒëe-jvm-trong-du-an-nhu-the-nao"><span>B·∫°n x·ª≠ l√Ω c√°c v·∫•n ƒë·ªÅ JVM trong d·ª± √°n nh∆∞ th·∫ø n√†o?</span></a></h2><p>ƒê·ªëi v·ªõi h·ªá th·ªëng v·∫´n ƒëang ch·∫°y b√¨nh th∆∞·ªùng:</p><ol><li>C√≥ th·ªÉ s·ª≠ d·ª•ng <strong>jmap</strong> ƒë·ªÉ xem t√¨nh tr·∫°ng s·ª≠ d·ª•ng c√°c v√πng b·ªô nh·ªõ c·ªßa JVM.</li><li>D√πng <strong>jstack</strong> ƒë·ªÉ xem t√¨nh tr·∫°ng ho·∫°t ƒë·ªông c·ªßa c√°c lu·ªìng, v√≠ d·ª• nh∆∞ lu·ªìng n√†o b·ªã kh√≥a ho·∫∑c c√≥ x·∫£y ra deadlock kh√¥ng.</li><li>D√πng l·ªánh <strong>jstat</strong> ƒë·ªÉ ki·ªÉm tra t√¨nh tr·∫°ng thu gom r√°c (garbage collection), ƒë·∫∑c bi·ªát l√† <strong>full GC</strong>. N·∫øu th·∫•y full GC x·∫£y ra th∆∞·ªùng xuy√™n, c·∫ßn t·ªëi ∆∞u h√≥a.</li><li>Ph√¢n t√≠ch k·∫øt qu·∫£ c·ªßa c√°c l·ªánh ho·∫∑c d√πng c√¥ng c·ª• nh∆∞ <strong>jvisualvm</strong> ƒë·ªÉ xem x√©t.</li><li>ƒê·∫ßu ti√™n, h√£y ph·ªèng ƒëo√°n l√Ω do g√¢y ra full GC th∆∞·ªùng xuy√™n. N·∫øu full GC di·ªÖn ra nhi·ªÅu nh∆∞ng kh√¥ng x·∫£y ra l·ªói tr√†n b·ªô nh·ªõ (OutOfMemoryError), ƒëi·ªÅu ƒë√≥ c√≥ nghƒ©a l√† GC ƒëang thu gom r·∫•t nhi·ªÅu ƒë·ªëi t∆∞·ª£ng. C·∫ßn ƒë·∫£m b·∫£o c√°c ƒë·ªëi t∆∞·ª£ng n√†y ƒë∆∞·ª£c thu gom trong <strong>young GC</strong> tr∆∞·ªõc khi v√†o v√πng c≈© (old generation). H√£y th·ª≠ tƒÉng k√≠ch th∆∞·ªõc c·ªßa v√πng <strong>young generation</strong>. N·∫øu s·ªë l·∫ßn full GC gi·∫£m, th√¨ ch·ªânh s·ª≠a ƒë√£ c√≥ hi·ªáu qu·∫£.</li><li>C√≥ th·ªÉ t√¨m ra lu·ªìng chi·∫øm d·ª•ng CPU nhi·ªÅu nh·∫•t, sau ƒë√≥ t·ªëi ∆∞u h√≥a ph∆∞∆°ng th·ª©c n√†y ƒë·ªÉ xem c√≥ th·ªÉ tr√°nh t·∫°o ra m·ªôt s·ªë ƒë·ªëi t∆∞·ª£ng v√† ti·∫øt ki·ªám b·ªô nh·ªõ hay kh√¥ng.</li></ol><p>ƒê·ªëi v·ªõi h·ªá th·ªëng ƒë√£ x·∫£y ra l·ªói <strong>OutOfMemoryError (OOM)</strong>:</p><ol><li>Th∆∞·ªùng h·ªá th·ªëng s·∫£n xu·∫•t ƒë∆∞·ª£c c·∫•u h√¨nh ƒë·ªÉ t·∫°o file dump khi x·∫£y ra l·ªói OOM b·∫±ng c√°c tham s·ªë: <strong>-XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/usr/local/base</strong>.</li><li>C√≥ th·ªÉ d√πng c√¥ng c·ª• nh∆∞ <strong>jvisualvm</strong> ƒë·ªÉ ph√¢n t√≠ch file dump.</li><li>T√¨m c√°c ƒë·ªëi t∆∞·ª£ng v√† lu·ªìng b·∫•t th∆∞·ªùng (lu·ªìng chi·∫øm CPU cao) trong file dump ƒë·ªÉ x√°c ƒë·ªãnh m√£ g√¢y ra v·∫•n ƒë·ªÅ.</li><li>Sau ƒë√≥ ti·∫øn h√†nh ph√¢n t√≠ch v√† g·ª° l·ªói chi ti·∫øt.</li></ol><p>T√≥m l·∫°i, vi·ªác t·ªëi ∆∞u h√≥a kh√¥ng th·ªÉ th·ª±c hi·ªán ngay l·∫≠p t·ª©c m√† c·∫ßn c√≥ s·ª± ph√¢n t√≠ch, suy lu·∫≠n, th·ª≠ nghi·ªám, v√† ƒë√∫c k·∫øt ƒë·ªÉ t√¨m ra v·∫•n ƒë·ªÅ ch√≠nh.</p><h2 id="khi-jvm-gap-loi-oom-co-lam-treo-tien-trinh-khong" tabindex="-1"><a class="header-anchor" href="#khi-jvm-gap-loi-oom-co-lam-treo-tien-trinh-khong"><span>Khi JVM g·∫∑p l·ªói OOM c√≥ l√†m treo ti·∫øn tr√¨nh kh√¥ng?</span></a></h2><p>Khi m·ªôt lu·ªìng th·ª±c thi, c√≥ kh·∫£ nƒÉng c·∫ßn t·∫°o ƒë·ªëi t∆∞·ª£ng m·ªõi, v√† vi·ªác t·∫°o ƒë·ªëi t∆∞·ª£ng ƒë√≤i h·ªèi ph·∫£i ph√¢n b·ªï b·ªô nh·ªõ. N·∫øu JVM kh√¥ng ƒë·ªß b·ªô nh·ªõ, n√≥ s·∫Ω ti·∫øn h√†nh thu gom r√°c (GC). Sau khi GC m√† b·ªô nh·ªõ v·∫´n kh√¥ng ƒë·ªß, JVM s·∫Ω n√©m ra ngo·∫°i l·ªá <strong>OutOfMemoryError</strong>. N·∫øu kh√¥ng b·∫Øt ngo·∫°i l·ªá n√†y, lu·ªìng s·∫Ω d·ª´ng l·∫°i gi·ªëng nh∆∞ khi g·∫∑p b·∫•t k·ª≥ ngo·∫°i l·ªá n√†o kh√°c. N·∫øu b·∫Øt ƒë∆∞·ª£c <strong>OutOfMemoryError</strong>, lu·ªìng c√≥ th·ªÉ s·∫Ω kh√¥ng b·ªã d·ª´ng l·∫°i. Tuy nhi√™n, vi·ªác lu·ªìng d·ª´ng l·∫°i hay kh√¥ng kh√¥ng li√™n quan tr·ª±c ti·∫øp ƒë·∫øn vi·ªác ti·∫øn tr√¨nh c√≥ b·ªã d·ª´ng hay kh√¥ng. Khi t·∫•t c·∫£ c√°c lu·ªìng kh√¥ng ph·∫£i l√† daemon trong ti·∫øn tr√¨nh d·ª´ng l·∫°i, th√¨ ti·∫øn tr√¨nh s·∫Ω d·ª´ng. Ho·∫∑c n·∫øu ti·∫øn tr√¨nh chi·∫øm qu√° nhi·ªÅu b·ªô nh·ªõ c·ªßa h·ªá ƒëi·ªÅu h√†nh, n√≥ c√≥ th·ªÉ b·ªã h·ªá ƒëi·ªÅu h√†nh ƒë√≥ng.</p><h2 id="qua-trinh-mot-ƒëoi-tuong-tu-khi-ƒëuoc-tai-vao-jvm-ƒëen-khi-bi-gc-xoa-bo-trai-qua-nhung-giai-ƒëoan-gi" tabindex="-1"><a class="header-anchor" href="#qua-trinh-mot-ƒëoi-tuong-tu-khi-ƒëuoc-tai-vao-jvm-ƒëen-khi-bi-gc-xoa-bo-trai-qua-nhung-giai-ƒëoan-gi"><span>Qu√° tr√¨nh m·ªôt ƒë·ªëi t∆∞·ª£ng t·ª´ khi ƒë∆∞·ª£c t·∫£i v√†o JVM ƒë·∫øn khi b·ªã GC xo√° b·ªè tr·∫£i qua nh·ªØng giai ƒëo·∫°n g√¨?</span></a></h2><ol><li>ƒê·∫ßu ti√™n, n·ªôi dung file bytecode ƒë∆∞·ª£c t·∫£i v√†o <strong>Method Area</strong>.</li><li>Sau ƒë√≥, d·ª±a tr√™n th√¥ng tin c·ªßa l·ªõp, ƒë·ªëi t∆∞·ª£ng ƒë∆∞·ª£c t·∫°o ra trong <strong>Heap</strong>.</li><li>ƒê·ªëi t∆∞·ª£ng s·∫Ω ƒë∆∞·ª£c ph√¢n b·ªï ·ªü <strong>Eden Area</strong> c·ªßa <strong>Young Generation</strong> trong Heap. Sau m·ªôt l·∫ßn <strong>Minor GC</strong>, n·∫øu ƒë·ªëi t∆∞·ª£ng v·∫´n t·ªìn t·∫°i, n√≥ s·∫Ω ƒë∆∞·ª£c chuy·ªÉn v√†o <strong>Survivor Area</strong>. Sau m·ªói l·∫ßn Minor GC, n·∫øu ƒë·ªëi t∆∞·ª£ng v·∫´n t·ªìn t·∫°i, n√≥ s·∫Ω ƒë∆∞·ª£c sao ch√©p qua l·∫°i gi·ªØa hai Survivor Area v√† tƒÉng tu·ªïi c·ªßa ƒë·ªëi t∆∞·ª£ng l√™n 1.</li><li>Khi tu·ªïi ƒë·ªëi t∆∞·ª£ng v∆∞·ª£t qu√° 15 v√† v·∫´n t·ªìn t·∫°i, n√≥ s·∫Ω ƒë∆∞·ª£c chuy·ªÉn v√†o <strong>Old Generation</strong>.</li><li>N·∫øu sau <strong>Full GC</strong>, ƒë·ªëi t∆∞·ª£ng b·ªã ƒë√°nh d·∫•u l√† r√°c, n√≥ s·∫Ω b·ªã lu·ªìng GC thu gom.</li></ol><h2 id="lam-the-nao-ƒëe-xac-ƒëinh-mot-ƒëoi-tuong-co-phai-la-rac-hay-khong" tabindex="-1"><a class="header-anchor" href="#lam-the-nao-ƒëe-xac-ƒëinh-mot-ƒëoi-tuong-co-phai-la-rac-hay-khong"><span>L√†m th·∫ø n√†o ƒë·ªÉ x√°c ƒë·ªãnh m·ªôt ƒë·ªëi t∆∞·ª£ng c√≥ ph·∫£i l√† r√°c hay kh√¥ng?</span></a></h2><ol><li><strong>Thu·∫≠t to√°n ƒë·∫øm tham chi·∫øu</strong>: C√°ch n√†y ghi l·∫°i s·ªë l∆∞·ª£ng tham chi·∫øu t·ªõi m·ªói ƒë·ªëi t∆∞·ª£ng trong Heap. N·∫øu s·ªë l∆∞·ª£ng tham chi·∫øu b·∫±ng 0, ƒë·ªëi t∆∞·ª£ng ƒë∆∞·ª£c coi l√† r√°c. Tuy nhi√™n, thu·∫≠t to√°n n√†y kh√¥ng th·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ v√≤ng l·∫∑p tham chi·∫øu.</li><li><strong>Thu·∫≠t to√°n kh·∫£ nƒÉng ti·∫øp c·∫≠n</strong>: Thu·∫≠t to√°n n√†y ki·ªÉm tra t·ª´ c√°c ƒë·ªëi t∆∞·ª£ng g·ªëc (root) trong b·ªô nh·ªõ v√† t√¨m c√°c ƒë·ªëi t∆∞·ª£ng c√≥ li√™n k·∫øt. Nh·ªØng ƒë·ªëi t∆∞·ª£ng ƒë∆∞·ª£c t√¨m th·∫•y kh√¥ng ph·∫£i l√† r√°c, c√≤n nh·ªØng ƒë·ªëi t∆∞·ª£ng kh√¥ng ƒë∆∞·ª£c t√¨m th·∫•y s·∫Ω b·ªã coi l√† r√°c.</li></ol><h2 id="cac-thuat-toan-thu-gom-rac-trong-jvm" tabindex="-1"><a class="header-anchor" href="#cac-thuat-toan-thu-gom-rac-trong-jvm"><span>C√°c thu·∫≠t to√°n thu gom r√°c trong JVM?</span></a></h2><ol><li><p><strong>Thu·∫≠t to√°n ƒë√°nh d·∫•u v√† xo√° (Mark-and-Sweep)</strong>:</p><ul><li>Giai ƒëo·∫°n ƒë√°nh d·∫•u: ƒê√°nh d·∫•u c√°c v√πng b·ªô nh·ªõ kh√¥ng c√≤n ƒë∆∞·ª£c s·ª≠ d·ª•ng.</li><li>Giai ƒëo·∫°n xo√°: Gi·∫£i ph√≥ng b·ªô nh·ªõ ƒë∆∞·ª£c ƒë√°nh d·∫•u l√† r√°c.</li><li>Nh∆∞·ª£c ƒëi·ªÉm c·ªßa thu·∫≠t to√°n n√†y l√† g√¢y ra ph√¢n m·∫£nh b·ªô nh·ªõ.</li></ul></li><li><p><strong>Thu·∫≠t to√°n sao ch√©p (Copying Algorithm)</strong>: Chia b·ªô nh·ªõ th√†nh hai ph·∫ßn b·∫±ng nhau v√† ch·ªâ s·ª≠ d·ª•ng m·ªôt ph·∫ßn. Khi thu gom r√°c, c√°c ƒë·ªëi t∆∞·ª£ng c√≤n s·ªëng ƒë∆∞·ª£c sao ch√©p sang ph·∫ßn c√≤n l·∫°i v√† gi·∫£i ph√≥ng to√†n b·ªô b·ªô nh·ªõ c·ªßa ph·∫ßn ƒë·∫ßu ti√™n. C√°ch n√†y kh√¥ng g√¢y ph√¢n m·∫£nh nh∆∞ng l√£ng ph√≠ b·ªô nh·ªõ.</p></li><li><p><strong>Thu·∫≠t to√°n ƒë√°nh d·∫•u v√† n√©n (Mark-Compact)</strong>: Sau khi ƒë√°nh d·∫•u c√°c ƒë·ªëi t∆∞·ª£ng kh√¥ng s·ª≠ d·ª•ng, thay v√¨ gi·∫£i ph√≥ng tr·ª±c ti·∫øp, thu·∫≠t to√°n n√†y di chuy·ªÉn c√°c ƒë·ªëi t∆∞·ª£ng c√≤n s·ªëng ƒë·∫øn m·ªôt ƒë·∫ßu c·ªßa b·ªô nh·ªõ, sau ƒë√≥ gi·∫£i ph√≥ng ph·∫ßn b·ªô nh·ªõ kh√¥ng s·ª≠ d·ª•ng.</p></li></ol><h2 id="stw-la-gi" tabindex="-1"><a class="header-anchor" href="#stw-la-gi"><span>STW l√† g√¨?</span></a></h2><p>STW (Stop-The-World) l√† tr·∫°ng th√°i trong qu√° tr√¨nh thu gom r√°c, khi JVM t·∫°m d·ª´ng t·∫•t c·∫£ c√°c lu·ªìng (tr·ª´ c√°c lu·ªìng GC). Trong tr·∫°ng th√°i STW, c√°c ph∆∞∆°ng th·ª©c native c√≥ th·ªÉ ch·∫°y nh∆∞ng kh√¥ng th·ªÉ t∆∞∆°ng t√°c v·ªõi JVM. M·ª•c ti√™u c·ªßa c√°c thu·∫≠t to√°n t·ªëi ∆∞u h√≥a GC l√† gi·∫£m th·ªùi gian STW, v√† ƒë√¢y c≈©ng l√† tr·ªçng t√¢m c·ªßa vi·ªác t·ªëi ∆∞u h√≥a JVM.</p><h2 id="cac-tham-so-cua-jvm" tabindex="-1"><a class="header-anchor" href="#cac-tham-so-cua-jvm"><span>C√°c tham s·ªë c·ªßa JVM?</span></a></h2><p>Tham s·ªë JVM c√≥ th·ªÉ chia th√†nh ba lo·∫°i:</p><ol><li><strong>L·ªánh chu·∫©n</strong>: B·∫Øt ƒë·∫ßu b·∫±ng d·∫•u &quot;-&quot;. C√°c tham s·ªë n√†y ƒë∆∞·ª£c h·ªó tr·ª£ b·ªüi t·∫•t c·∫£ c√°c phi√™n b·∫£n HotSpot. S·ª≠ d·ª•ng l·ªánh <code>java -help</code> ƒë·ªÉ li·ªát k√™.</li><li><strong>L·ªánh kh√¥ng chu·∫©n</strong>: B·∫Øt ƒë·∫ßu b·∫±ng &quot;-X&quot;. Th∆∞·ªùng g·∫Øn li·ªÅn v·ªõi c√°c phi√™n b·∫£n c·ª• th·ªÉ c·ªßa HotSpot. S·ª≠ d·ª•ng l·ªánh <code>java -X</code> ƒë·ªÉ xem.</li><li><strong>Tham s·ªë kh√¥ng ·ªïn ƒë·ªãnh</strong>: B·∫Øt ƒë·∫ßu b·∫±ng &quot;-XX&quot;. Nh·ªØng tham s·ªë n√†y thay ƒë·ªïi nhi·ªÅu gi·ªØa c√°c phi√™n b·∫£n HotSpot.</li></ol><h2 id="hieu-biet-ve-an-toan-luong-thread-safety" tabindex="-1"><a class="header-anchor" href="#hieu-biet-ve-an-toan-luong-thread-safety"><span>Hi·ªÉu bi·∫øt v·ªÅ an to√†n lu·ªìng (thread safety)?</span></a></h2><p>An to√†n lu·ªìng ƒë·ªÅ c·∫≠p ƒë·∫øn vi·ªác khi m·ªôt ƒëo·∫°n m√£ ƒë∆∞·ª£c th·ª±c thi b·ªüi nhi·ªÅu lu·ªìng ƒë·ªìng th·ªùi, kh√¥ng x·∫£y ra t√¨nh tr·∫°ng xung ƒë·ªôt v√† k·∫øt qu·∫£ v·∫´n ch√≠nh x√°c. V√≠ d·ª•, khi m·ªôt bi·∫øn <code>i</code> ƒë∆∞·ª£c kh·ªüi t·∫°o l√† 0, n·∫øu hai lu·ªìng c√πng th·ª±c thi c√¢u l·ªánh <code>i++</code>, k·∫øt qu·∫£ c·ªßa m·ªôt lu·ªìng ph·∫£i l√† 1 v√† c·ªßa lu·ªìng kia ph·∫£i l√† 2. N·∫øu c·∫£ hai lu·ªìng ƒë·ªÅu cho k·∫øt qu·∫£ l√† 1, ƒëi·ªÅu ƒë√≥ cho th·∫•y ƒëo·∫°n m√£ kh√¥ng an to√†n lu·ªìng.</p><p>V√¨ v·∫≠y, <strong>an to√†n lu·ªìng</strong> c√≥ nghƒ©a l√† m·ªôt ƒëo·∫°n m√£ khi ƒë∆∞·ª£c nhi·ªÅu lu·ªìng th·ª±c thi ƒë·ªìng th·ªùi v·∫´n ƒë·∫£m b·∫£o cho k·∫øt qu·∫£ ƒë√∫ng.</p><h2 id="hieu-biet-ve-luong-daemon-luong-nen" tabindex="-1"><a class="header-anchor" href="#hieu-biet-ve-luong-daemon-luong-nen"><span>Hi·ªÉu bi·∫øt v·ªÅ lu·ªìng daemon (lu·ªìng n·ªÅn)</span></a></h2><p>Lu·ªìng trong Java ƒë∆∞·ª£c chia th√†nh hai lo·∫°i: <strong>lu·ªìng ng∆∞·ªùi d√πng</strong> v√† <strong>lu·ªìng daemon (lu·ªìng n·ªÅn)</strong>. Lu·ªìng ng∆∞·ªùi d√πng l√† c√°c lu·ªìng b√¨nh th∆∞·ªùng m√† ch√∫ng ta t·∫°o ra, c√≤n lu·ªìng daemon l√† c√°c lu·ªìng ch·∫°y ·ªü ch·∫ø ƒë·ªô n·ªÅn c·ªßa JVM, v√≠ d·ª• nh∆∞ lu·ªìng x·ª≠ l√Ω r√°c (garbage collection). Lu·ªìng daemon s·∫Ω t·ª± ƒë·ªông t·∫Øt khi t·∫•t c·∫£ c√°c lu·ªìng ng∆∞·ªùi d√πng ƒë√£ k·∫øt th√∫c. Ch√∫ng ta c√≥ th·ªÉ thi·∫øt l·∫≠p m·ªôt lu·ªìng tr·ªü th√†nh lu·ªìng daemon b·∫±ng c√°ch g·ªçi <code>thread.setDaemon(true)</code>.</p><h2 id="nguyen-ly-co-ban-cua-threadlocal" tabindex="-1"><a class="header-anchor" href="#nguyen-ly-co-ban-cua-threadlocal"><span>Nguy√™n l√Ω c∆° b·∫£n c·ªßa ThreadLocal</span></a></h2><ol><li><strong>ThreadLocal</strong> l√† m·ªôt c∆° ch·∫ø l∆∞u tr·ªØ d·ªØ li·ªáu ri√™ng cho t·ª´ng lu·ªìng trong Java, n√≥ cho ph√©p m·ªôt lu·ªìng l∆∞u tr·ªØ v√† truy c·∫≠p d·ªØ li·ªáu t·∫°i b·∫•t k·ª≥ th·ªùi ƒëi·ªÉm n√†o trong qu√° tr√¨nh th·ª±c thi, m√† kh√¥ng b·ªã chia s·∫ª b·ªüi c√°c lu·ªìng kh√°c.</li><li>·ªû t·∫ßng th·∫•p, <strong>ThreadLocal</strong> ƒë∆∞·ª£c th·ª±c hi·ªán th√¥ng qua m·ªôt c·∫•u tr√∫c d·ªØ li·ªáu g·ªçi l√† <strong>ThreadLocalMap</strong>. M·ªói ƒë·ªëi t∆∞·ª£ng <code>Thread</code> c√≥ m·ªôt b·∫£n sao ri√™ng c·ªßa <code>ThreadLocalMap</code>, trong ƒë√≥ <code>key</code> l√† ƒë·ªëi t∆∞·ª£ng <code>ThreadLocal</code> v√† <code>value</code> l√† gi√° tr·ªã c·∫ßn l∆∞u tr·ªØ.</li><li>S·ª≠ d·ª•ng <strong>ThreadLocal</strong> trong c√°c lu·ªìng c·ªßa thread pool c√≥ th·ªÉ g√¢y ra r√≤ r·ªâ b·ªô nh·ªõ n·∫øu kh√¥ng x√≥a c√°c entry sau khi s·ª≠ d·ª•ng. ƒê·ªÉ kh·∫Øc ph·ª•c, sau khi d√πng xong <code>ThreadLocal</code>, ta n√™n g·ªçi ph∆∞∆°ng th·ª©c <code>remove</code> ƒë·ªÉ gi·∫£i ph√≥ng t√†i nguy√™n.</li><li>M·ªôt v√≠ d·ª• ph·ªï bi·∫øn c·ªßa <strong>ThreadLocal</strong> l√† trong qu·∫£n l√Ω k·∫øt n·ªëi, n∆°i m·ªói lu·ªìng gi·ªØ m·ªôt k·∫øt n·ªëi ri√™ng bi·ªát.</li></ol><h2 id="su-khac-biet-giua-ƒëong-thoi-song-song-va-tuan-tu" tabindex="-1"><a class="header-anchor" href="#su-khac-biet-giua-ƒëong-thoi-song-song-va-tuan-tu"><span>S·ª± kh√°c bi·ªát gi·ªØa ƒë·ªìng th·ªùi, song song v√† tu·∫ßn t·ª±</span></a></h2><ol><li><strong>Tu·∫ßn t·ª±</strong>: C√°c t√°c v·ª• ƒë∆∞·ª£c th·ª±c thi l·∫ßn l∆∞·ª£t, t√°c v·ª• n√†y ho√†n th√†nh r·ªìi m·ªõi ƒë·∫øn t√°c v·ª• kh√°c.</li><li><strong>Song song (Parallelism)</strong>: Hai t√°c v·ª• ƒë∆∞·ª£c th·ª±c thi c√πng l√∫c, tr√™n hai lu·ªìng ho·∫∑c CPU kh√°c nhau.</li><li><strong>ƒê·ªìng th·ªùi (Concurrency)</strong>: Hai t√°c v·ª• xu·∫•t hi·ªán nh∆∞ ƒëang th·ª±c thi c√πng l√∫c, nh∆∞ng th·ª±c t·∫ø CPU chuy·ªÉn ƒë·ªïi gi·ªØa c√°c t√°c v·ª• r·∫•t nhanh.</li></ol><h2 id="lam-sao-ƒëe-tranh-deadlock-trong-java" tabindex="-1"><a class="header-anchor" href="#lam-sao-ƒëe-tranh-deadlock-trong-java"><span>L√†m sao ƒë·ªÉ tr√°nh deadlock trong Java?</span></a></h2><p>Deadlock x·∫£y ra khi b·ªën ƒëi·ªÅu ki·ªán sau ƒë·ªÅu th·ªèa m√£n:</p><ol><li>T√†i nguy√™n ch·ªâ ƒë∆∞·ª£c m·ªôt lu·ªìng s·ª≠ d·ª•ng t·∫°i m·ªôt th·ªùi ƒëi·ªÉm.</li><li>Lu·ªìng ch·ªù t√†i nguy√™n kh√¥ng nh·∫£ c√°c t√†i nguy√™n ƒë√£ chi·∫øm gi·ªØ.</li><li>T√†i nguy√™n kh√¥ng th·ªÉ b·ªã c∆∞·ª°ng ch·∫ø l·∫•y l·∫°i.</li><li>Lu·ªìng h√¨nh th√†nh m·ªëi quan h·ªá ch·ªù t√†i nguy√™n theo chu k·ª≥.</li></ol><p>ƒê·ªÉ tr√°nh deadlock, ch·ªâ c·∫ßn vi ph·∫°m m·ªôt trong b·ªën ƒëi·ªÅu ki·ªán tr√™n, v√≠ d·ª•:</p><ul><li>Thi·∫øt l·∫≠p m·ªôt th·ª© t·ª± kh√≥a c·ªë ƒë·ªãnh gi·ªØa c√°c lu·ªìng.</li><li>Thi·∫øt l·∫≠p th·ªùi gian ch·ªù khi kh√≥a.</li><li>S·ª≠ d·ª•ng c∆° ch·∫ø ki·ªÉm tra deadlock ƒë·ªÉ ph√°t hi·ªán s·ªõm.</li></ul><h2 id="nguyen-ly-lam-viec-cua-thread-pool" tabindex="-1"><a class="header-anchor" href="#nguyen-ly-lam-viec-cua-thread-pool"><span>Nguy√™n l√Ω l√†m vi·ªác c·ªßa thread pool</span></a></h2><p>Thread pool k·∫øt h·ª£p gi·ªØa h√†ng ƒë·ª£i v√† lu·ªìng. Khi th√™m m·ªôt t√°c v·ª• v√†o thread pool:</p><ol><li>N·∫øu s·ªë lu·ªìng hi·ªán t·∫°i √≠t h∆°n <code>corePoolSize</code>, t·∫°o th√™m lu·ªìng m·ªõi ƒë·ªÉ x·ª≠ l√Ω.</li><li>N·∫øu ƒë√£ ƒë·∫°t ƒë·∫øn <code>corePoolSize</code>, t√°c v·ª• ƒë∆∞·ª£c ƒë∆∞a v√†o h√†ng ƒë·ª£i.</li><li>N·∫øu h√†ng ƒë·ª£i ƒë·∫ßy v√† s·ªë lu·ªìng √≠t h∆°n <code>maximumPoolSize</code>, t·∫°o th√™m lu·ªìng m·ªõi.</li><li>N·∫øu s·ªë lu·ªìng ƒë√£ ƒë·∫°t ƒë·∫øn <code>maximumPoolSize</code>, s·ª≠ d·ª•ng chi·∫øn l∆∞·ª£c ƒë√£ ƒë·ªãnh ƒë·ªÉ x·ª≠ l√Ω t√°c v·ª• (th∆∞·ªùng l√† t·ª´ ch·ªëi t√°c v·ª•).</li><li>Khi s·ªë lu·ªìng v∆∞·ª£t qu√° <code>corePoolSize</code> v√† lu·ªìng r·∫£nh qu√° l√¢u, lu·ªìng s·∫Ω b·ªã h·ªßy.</li></ol><h2 id="tai-sao-thread-pool-them-vao-hang-ƒëoi-truoc-khi-tao-luong-toi-ƒëa" tabindex="-1"><a class="header-anchor" href="#tai-sao-thread-pool-them-vao-hang-ƒëoi-truoc-khi-tao-luong-toi-ƒëa"><span>T·∫°i sao thread pool th√™m v√†o h√†ng ƒë·ª£i tr∆∞·ªõc khi t·∫°o lu·ªìng t·ªëi ƒëa?</span></a></h2><p>Khi c√°c lu·ªìng ƒëang b·∫≠n, c√°c t√°c v·ª• s·∫Ω ƒë∆∞·ª£c ƒë∆∞a v√†o h√†ng ƒë·ª£i thay v√¨ t·∫°o th√™m lu·ªìng ngay l·∫≠p t·ª©c. N·∫øu h√†ng ƒë·ª£i ƒë·∫ßy, m·ªõi b·∫Øt ƒë·∫ßu t·∫°o th√™m lu·ªìng. ƒêi·ªÅu n√†y t∆∞∆°ng t·ª± nh∆∞ trong c√¥ng ty: n·∫øu c√≥ qu√° nhi·ªÅu c√¥ng vi·ªác, thay v√¨ thu√™ th√™m ng∆∞·ªùi ngay, c√¥ng vi·ªác s·∫Ω ƒë∆∞·ª£c ƒë∆∞a v√†o danh s√°ch ch·ªù ƒë·ªÉ nh√¢n vi√™n hi·ªán t·∫°i ho√†n th√†nh d·∫ßn.</p><h2 id="su-khac-biet-giua-khoa-cong-bang-va-thien-vi-trong-reentrantlock" tabindex="-1"><a class="header-anchor" href="#su-khac-biet-giua-khoa-cong-bang-va-thien-vi-trong-reentrantlock"><span>S·ª± kh√°c bi·ªát gi·ªØa kh√≥a c√¥ng b·∫±ng v√† thi√™n v·ªã trong ReentrantLock</span></a></h2><p>Kh√≥a c√¥ng b·∫±ng v√† thi√™n v·ªã ƒë·ªÅu s·ª≠ d·ª•ng AQS ƒë·ªÉ qu·∫£n l√Ω h√†ng ƒë·ª£i, s·ª± kh√°c bi·ªát l√† ·ªü l√∫c l·∫•y kh√≥a:</p><ul><li><strong>Kh√≥a c√¥ng b·∫±ng</strong>: Lu·ªìng s·∫Ω ki·ªÉm tra h√†ng ƒë·ª£i, n·∫øu c√≥ lu·ªìng ƒëang ch·ªù, n√≥ s·∫Ω x·∫øp h√†ng.</li><li><strong>Kh√≥a thi√™n v·ªã</strong>: Lu·ªìng s·∫Ω c·ªë g·∫Øng gi√†nh kh√≥a ngay m√† kh√¥ng ki·ªÉm tra h√†ng ƒë·ª£i.</li></ul><p>D√π kh√≥a c√¥ng b·∫±ng hay thi√™n v·ªã, khi m·ªôt lu·ªìng kh√¥ng gi√†nh ƒë∆∞·ª£c kh√≥a, n√≥ ƒë·ªÅu ph·∫£i x·∫øp h√†ng. Khi kh√≥a ƒë∆∞·ª£c gi·∫£i ph√≥ng, lu·ªìng ·ªü ƒë·∫ßu h√†ng s·∫Ω ƒë∆∞·ª£c ƒë√°nh th·ª©c.</p><h2 id="su-khac-biet-giua-trylock-va-lock-trong-reentrantlock" tabindex="-1"><a class="header-anchor" href="#su-khac-biet-giua-trylock-va-lock-trong-reentrantlock"><span>S·ª± kh√°c bi·ªát gi·ªØa tryLock() v√† lock() trong ReentrantLock</span></a></h2><ul><li><strong>tryLock()</strong>: C·ªë g·∫Øng l·∫•y kh√≥a, n·∫øu l·∫•y ƒë∆∞·ª£c s·∫Ω tr·∫£ v·ªÅ <code>true</code>, n·∫øu kh√¥ng l·∫•y ƒë∆∞·ª£c s·∫Ω tr·∫£ v·ªÅ <code>false</code> m√† kh√¥ng ch·∫∑n lu·ªìng.</li><li><strong>lock()</strong>: Ch·∫∑n lu·ªìng cho ƒë·∫øn khi l·∫•y ƒë∆∞·ª£c kh√≥a.</li></ul><h2 id="su-khac-biet-giua-countdownlatch-va-semaphore" tabindex="-1"><a class="header-anchor" href="#su-khac-biet-giua-countdownlatch-va-semaphore"><span>S·ª± kh√°c bi·ªát gi·ªØa CountDownLatch v√† Semaphore</span></a></h2><ul><li><strong>CountDownLatch</strong>: M·ªôt c∆° ch·∫ø ƒë·∫øm ng∆∞·ª£c. M·ªôt lu·ªìng ch·ªù ƒë·ª£i khi gi√° tr·ªã ƒë·∫øm v·ªÅ 0, c√°c lu·ªìng kh√°c gi·∫£m gi√° tr·ªã ƒë·∫øm xu·ªëng. Khi gi√° tr·ªã ƒë·∫°t 0, t·∫•t c·∫£ c√°c lu·ªìng ch·ªù ƒë·ª£i s·∫Ω ƒë∆∞·ª£c ƒë√°nh th·ª©c.</li><li><strong>Semaphore</strong>: M·ªôt c∆° ch·∫ø qu·∫£n l√Ω t√≠n hi·ªáu. Cho ph√©p m·ªôt s·ªë l∆∞·ª£ng lu·ªìng nh·∫•t ƒë·ªãnh ch·∫°y ƒë·ªìng th·ªùi. Khi m·ªôt lu·ªìng gi·∫£i ph√≥ng t√≠n hi·ªáu, m·ªôt lu·ªìng kh√°c trong h√†ng ƒë·ª£i s·∫Ω ƒë∆∞·ª£c ƒë√°nh th·ª©c.</li></ul><h2 id="sychronized-khoa-thien-vi-khoa-nhe-va-khoa-nang" tabindex="-1"><a class="header-anchor" href="#sychronized-khoa-thien-vi-khoa-nhe-va-khoa-nang"><span>Sychronized: Kh√≥a thi√™n v·ªã, kh√≥a nh·∫π, v√† kh√≥a n·∫∑ng</span></a></h2><ol><li><strong>Kh√≥a thi√™n v·ªã</strong>: Trong ph·∫ßn header c·ªßa ƒë·ªëi t∆∞·ª£ng kh√≥a s·∫Ω l∆∞u l·∫°i ID c·ªßa lu·ªìng hi·ªán t·∫°i ƒëang gi·ªØ kh√≥a, n·∫øu lu·ªìng ƒë√≥ y√™u c·∫ßu kh√≥a l·∫°i, n√≥ c√≥ th·ªÉ l·∫•y kh√≥a tr·ª±c ti·∫øp.</li><li><strong>Kh√≥a nh·∫π</strong>: Khi m·ªôt lu·ªìng kh√°c c·∫°nh tranh ƒë·ªÉ l·∫•y kh√≥a trong khi kh√≥a ƒëang ·ªü tr·∫°ng th√°i kh√≥a thi√™n v·ªã, kh√≥a s·∫Ω n√¢ng c·∫•p l√™n kh√≥a nh·∫π. Kh√≥a nh·∫π ƒë∆∞·ª£c th·ª±c hi·ªán b·∫±ng c√°ch quay v√≤ng (spin), do ƒë√≥ kh√¥ng l√†m ch·∫∑n lu·ªìng.</li><li>N·∫øu s·ªë l·∫ßn quay v√≤ng qu√° nhi·ªÅu m√† v·∫´n kh√¥ng l·∫•y ƒë∆∞·ª£c kh√≥a, n√≥ s·∫Ω n√¢ng c·∫•p l√™n <strong>kh√≥a n·∫∑ng</strong>, khi·∫øn lu·ªìng b·ªã ch·∫∑n.</li><li><strong>Kh√≥a quay v√≤ng (spin lock)</strong>: Kh√≥a n√†y kh√¥ng l√†m ch·∫∑n lu·ªìng, thay v√¨ ƒë√≥, lu·ªìng s·∫Ω quay v√≤ng li√™n t·ª•c ƒë·ªÉ th·ª≠ l·∫•y kh√≥a b·∫±ng c√°ch s·ª≠ d·ª•ng l·ªánh CAS (Compare-And-Swap). N·∫øu kh√≥a kh√¥ng ƒë∆∞·ª£c l·∫•y, lu·ªìng ti·∫øp t·ª•c quay v√≤ng m√† kh√¥ng b·ªã h·ªá ƒëi·ªÅu h√†nh can thi·ªáp v√†o vi·ªác ch·∫∑n ho·∫∑c ƒë√°nh th·ª©c lu·ªìng.</li></ol><h2 id="su-khac-biet-giua-synchronized-va-reentrantlock" tabindex="-1"><a class="header-anchor" href="#su-khac-biet-giua-synchronized-va-reentrantlock"><span>S·ª± kh√°c bi·ªát gi·ªØa Synchronized v√† ReentrantLock</span></a></h2><ol><li><strong>Synchronized</strong> l√† m·ªôt t·ª´ kh√≥a, c√≤n <strong>ReentrantLock</strong> l√† m·ªôt l·ªõp.</li><li><strong>Synchronized</strong> t·ª± ƒë·ªông kh√≥a v√† m·ªü kh√≥a, c√≤n <strong>ReentrantLock</strong> y√™u c·∫ßu l·∫≠p tr√¨nh vi√™n ph·∫£i kh√≥a v√† m·ªü kh√≥a th·ªß c√¥ng.</li><li><strong>Synchronized</strong> ho·∫°t ƒë·ªông ·ªü m·ª©c JVM, c√≤n <strong>ReentrantLock</strong> ho·∫°t ƒë·ªông ·ªü m·ª©c API.</li><li><strong>Synchronized</strong> l√† kh√≥a thi√™n v·ªã, c√≤n <strong>ReentrantLock</strong> c√≥ th·ªÉ l·ª±a ch·ªçn kh√≥a c√¥ng b·∫±ng ho·∫∑c thi√™n v·ªã.</li><li><strong>Synchronized</strong> kh√≥a ƒë·ªëi t∆∞·ª£ng, th√¥ng tin v·ªÅ kh√≥a ƒë∆∞·ª£c l∆∞u trong ph·∫ßn ƒë·∫ßu c·ªßa ƒë·ªëi t∆∞·ª£ng, trong khi <strong>ReentrantLock</strong> s·ª≠ d·ª•ng m·ªôt bi·∫øn <code>state</code> ki·ªÉu <code>int</code> ƒë·ªÉ x√°c ƒë·ªãnh tr·∫°ng th√°i kh√≥a.</li><li><strong>Synchronized</strong> c√≥ c∆° ch·∫ø n√¢ng c·∫•p kh√≥a trong t·∫ßng th·∫•p.</li></ol><h2 id="hieu-biet-ve-aqs-va-cach-aqs-thuc-hien-khoa-tai-nhap" tabindex="-1"><a class="header-anchor" href="#hieu-biet-ve-aqs-va-cach-aqs-thuc-hien-khoa-tai-nhap"><span>Hi·ªÉu bi·∫øt v·ªÅ AQS v√† c√°ch AQS th·ª±c hi·ªán kh√≥a t√°i nh·∫≠p</span></a></h2><ol><li><strong>AQS (AbstractQueuedSynchronizer)</strong> l√† m·ªôt khung ƒë·ªìng b·ªô h√≥a lu·ªìng trong Java, l√† ph·∫ßn c·ªët l√µi c·ªßa nhi·ªÅu c√¥ng c·ª• kh√≥a trong JDK.</li><li>AQS duy tr√¨ m·ªôt bi·∫øn t√≠n hi·ªáu <code>state</code> v√† m·ªôt h√†ng ƒë·ª£i c√°c lu·ªìng d∆∞·ªõi d·∫°ng danh s√°ch li√™n k·∫øt k√©p. H√†ng ƒë·ª£i n√†y d√πng ƒë·ªÉ x·∫øp h√†ng cho c√°c lu·ªìng, c√≤n <code>state</code> nh∆∞ m·ªôt ƒë√®n t√≠n hi·ªáu, ƒëi·ªÅu khi·ªÉn vi·ªác lu·ªìng c√≥ ƒë∆∞·ª£c ph√©p ti·∫øp t·ª•c hay kh√¥ng. T√πy v√†o t·ª´ng ng·ªØ c·∫£nh, <code>state</code> s·∫Ω mang √Ω nghƒ©a kh√°c nhau.</li><li>Trong tr∆∞·ªùng h·ª£p kh√≥a t√°i nh·∫≠p, <code>state</code> ƒë∆∞·ª£c d√πng ƒë·ªÉ bi·ªÉu th·ªã s·ªë l·∫ßn kh√≥a. Khi <code>state</code> l√† 0, nghƒ©a l√† kh√¥ng c√≥ kh√≥a n√†o, m·ªói l·∫ßn kh√≥a th√†nh c√¥ng <code>state</code> s·∫Ω tƒÉng l√™n 1, v√† khi m·ªü kh√≥a th√¨ <code>state</code> s·∫Ω gi·∫£m ƒëi 1.</li></ol><h2 id="hieu-biet-ve-ioc" tabindex="-1"><a class="header-anchor" href="#hieu-biet-ve-ioc"><span>Hi·ªÉu bi·∫øt v·ªÅ IoC</span></a></h2><p>Th√¥ng th∆∞·ªùng, ch√∫ng ta bi·∫øt r·∫±ng Spring c√≥ hai ƒë·∫∑c ƒëi·ªÉm l·ªõn l√† <strong>IoC</strong> v√† <strong>AOP</strong>. V·∫≠y l√†m th·∫ø n√†o ƒë·ªÉ hi·ªÉu ƒë∆∞·ª£c IoC (Inversion of Control - ƒê·∫£o ng∆∞·ª£c quy·ªÅn ki·ªÉm so√°t)?</p><p>ƒê·ªëi v·ªõi nhi·ªÅu ng∆∞·ªùi m·ªõi h·ªçc, kh√°i ni·ªám IoC th∆∞·ªùng khi·∫øn h·ªç c·∫£m th·∫•y &quot;m√¨nh c√≥ v·∫ª hi·ªÉu nh∆∞ng l·∫°i kh√¥ng bi·∫øt di·ªÖn ƒë·∫°t&quot;. V·∫≠y IoC th·ª±c s·ª± l√† g√¨? ƒê√¢y l√† m·ªôt v·∫•n ƒë·ªÅ l·ªõn, v√¨ v·∫≠y ch√∫ng ta h√£y chia n√≥ th√†nh nh·ªØng ph·∫ßn nh·ªè h∆°n ƒë·ªÉ tr·∫£ l·ªùi. <strong>IoC</strong> l√† s·ª± <strong>ƒë·∫£o ng∆∞·ª£c quy·ªÅn ki·ªÉm so√°t</strong>, v·∫≠y:</p><ol><li>ƒêi·ªÅu g√¨ ƒëang ƒë∆∞·ª£c ki·ªÉm so√°t?</li><li>ƒêi·ªÅu g√¨ b·ªã ƒë·∫£o ng∆∞·ª£c? Tr∆∞·ªõc khi ƒë·∫£o ng∆∞·ª£c, ai ki·ªÉm so√°t? Sau khi ƒë·∫£o ng∆∞·ª£c, ai ki·ªÉm so√°t v√† ki·ªÉm so√°t b·∫±ng c√°ch n√†o?</li><li>T·∫°i sao c·∫ßn ph·∫£i ƒë·∫£o ng∆∞·ª£c? Tr∆∞·ªõc khi ƒë·∫£o ng∆∞·ª£c c√≥ v·∫•n ƒë·ªÅ g√¨? Sau khi ƒë·∫£o ng∆∞·ª£c mang l·∫°i l·ª£i √≠ch g√¨?</li></ol><p>H√£y b·∫Øt ƒë·∫ßu v·ªõi c√¢u h·ªèi ƒë·∫ßu ti√™n: <strong>Ki·ªÉm so√°t ƒëi·ªÅu g√¨?</strong></p><p>Khi s·ª≠ d·ª•ng Spring, ch√∫ng ta c·∫ßn l√†m nh·ªØng g√¨:</p><ol><li>T·∫°o m·ªôt s·ªë l·ªõp, v√≠ d·ª• nh∆∞ <code>UserService</code>, <code>OrderService</code>.</li><li>S·ª≠ d·ª•ng m·ªôt s·ªë annotation nh∆∞ <code>@Autowired</code>.</li></ol><p>Ch√∫ng ta ƒë·ªÅu bi·∫øt r·∫±ng, khi ch∆∞∆°ng tr√¨nh ch·∫°y, n√≥ s·ª≠ d·ª•ng c√°c ƒë·ªëi t∆∞·ª£ng c·ª• th·ªÉ c·ªßa <code>UserService</code> v√† <code>OrderService</code>. Nh·ªØng ƒë·ªëi t∆∞·ª£ng n√†y ƒë∆∞·ª£c t·∫°o khi n√†o? Ai ƒë√£ t·∫°o ra ch√∫ng? C√°c thu·ªôc t√≠nh b√™n trong ƒë·ªëi t∆∞·ª£ng ƒë∆∞·ª£c g√°n gi√° tr·ªã khi n√†o? Ai ƒë√£ g√°n gi√° tr·ªã? T·∫•t c·∫£ nh·ªØng ƒëi·ªÅu n√†y kh√¥ng ph·∫£i do l·∫≠p tr√¨nh vi√™n l√†m, m√† l√† do Spring th·ª±c hi·ªán. Spring ch√≠nh l√† ng∆∞·ªùi ki·ªÉm so√°t ng·∫ßm ·ªü ph√≠a sau.</p><p><strong>Ki·ªÉm so√°t</strong> bao g·ªìm:</p><ol><li>Ki·ªÉm so√°t vi·ªác t·∫°o ƒë·ªëi t∆∞·ª£ng.</li><li>Ki·ªÉm so√°t vi·ªác g√°n gi√° tr·ªã cho c√°c thu·ªôc t√≠nh c·ªßa ƒë·ªëi t∆∞·ª£ng.</li></ol><p>N·∫øu kh√¥ng s·ª≠ d·ª•ng Spring, ch√∫ng ta s·∫Ω ph·∫£i t·ª± th·ª±c hi·ªán nh·ªØng vi·ªác n√†y. Ng∆∞·ª£c l·∫°i, khi s·ª≠ d·ª•ng Spring, ta ch·ªâ c·∫ßn ƒë·ªãnh nghƒ©a l·ªõp v√† c√°c thu·ªôc t√≠nh c·∫ßn ƒë∆∞·ª£c Spring g√°n gi√° tr·ªã (v√≠ d·ª•, s·ª≠ d·ª•ng <code>@Autowired</code>), ƒë√¢y ch√≠nh l√† s·ª± <strong>ƒë·∫£o ng∆∞·ª£c</strong> quy·ªÅn ki·ªÉm so√°t.</p><p>T·∫°i sao c·∫ßn ph·∫£i ƒë·∫£o ng∆∞·ª£c?</p><p>N·∫øu ch√∫ng ta t·ª± t·∫°o ƒë·ªëi t∆∞·ª£ng v√† t·ª± g√°n gi√° tr·ªã cho c√°c thu·ªôc t√≠nh, ƒëi·ªÅu g√¨ s·∫Ω x·∫£y ra? V√≠ d·ª•:</p><ol><li>L·ªõp A c√≥ thu·ªôc t√≠nh <code>C c</code>.</li><li>L·ªõp B c≈©ng c√≥ thu·ªôc t√≠nh <code>C c</code>.</li><li>L·ªõp C l√† m·ªôt l·ªõp b√¨nh th∆∞·ªùng.</li></ol><p>Ch√∫ng ta c·∫ßn t·∫°o ƒë·ªëi t∆∞·ª£ng cho c·∫£ ba l·ªõp v√† g√°n gi√° tr·ªã cho c√°c thu·ªôc t√≠nh:</p><ol><li><code>A a = new A();</code></li><li><code>B b = new B();</code></li><li><code>C c = new C();</code></li><li><code>a.c = c;</code></li><li><code>b.c = c;</code></li></ol><p>Nh·ªØng d√≤ng m√£ n√†y l√† nh·ªØng ph·∫ßn m√† ch√∫ng ta ph·∫£i vi·∫øt th√™m n·∫øu kh√¥ng d√πng Spring. Khi s·ªë l∆∞·ª£ng l·ªõp tƒÉng l√™n ho·∫∑c s·ªë thu·ªôc t√≠nh trong m·ªói l·ªõp nhi·ªÅu h∆°n, m√£ s·∫Ω tr·ªü n√™n ph·ª©c t·∫°p v√† r·∫Øc r·ªëi h∆°n. V√¨ v·∫≠y, khi ch√∫ng ta ƒë·ªÉ Spring ki·ªÉm so√°t, m√£ ngu·ªìn s·∫Ω gi·∫£m ƒëi v√† ƒë∆°n gi·∫£n h∆°n.</p><p>T√≥m l·∫°i, <strong>IoC</strong> l√† s·ª± ƒë·∫£o ng∆∞·ª£c quy·ªÅn ki·ªÉm so√°t. N·∫øu s·ª≠ d·ª•ng Spring, Spring s·∫Ω ch·ªãu tr√°ch nhi·ªám t·∫°o ƒë·ªëi t∆∞·ª£ng v√† g√°n gi√° tr·ªã cho c√°c thu·ªôc t√≠nh c·ªßa ƒë·ªëi t∆∞·ª£ng.</p><h2 id="single-bean-va-singleton" tabindex="-1"><a class="header-anchor" href="#single-bean-va-singleton"><span>Single Bean v√† Singleton</span></a></h2><p>Singleton c√≥ nghƒ©a l√† trong JVM ch·ªâ t·ªìn t·∫°i duy nh·∫•t m·ªôt ƒë·ªëi t∆∞·ª£ng c·ªßa m·ªôt l·ªõp n√†o ƒë√≥.</p><p>C√≤n Single Bean kh√¥ng c√≥ nghƒ©a l√† trong JVM ch·ªâ c√≥ duy nh·∫•t m·ªôt ƒë·ªëi t∆∞·ª£ng Bean c·ªßa m·ªôt l·ªõp n√†o ƒë√≥.</p><h2 id="co-che-truyen-tai-giao-dich-trong-spring" tabindex="-1"><a class="header-anchor" href="#co-che-truyen-tai-giao-dich-trong-spring"><span>C∆° ch·∫ø truy·ªÅn t·∫£i giao d·ªãch trong Spring</span></a></h2><p>Khi nhi·ªÅu ph∆∞∆°ng th·ª©c giao d·ªãch g·ªçi l·∫´n nhau, giao d·ªãch s·∫Ω ƒë∆∞·ª£c truy·ªÅn t·∫£i nh∆∞ th·∫ø n√†o gi·ªØa c√°c ph∆∞∆°ng th·ª©c n√†y? Gi·∫£ s·ª≠ ph∆∞∆°ng th·ª©c A l√† m·ªôt ph∆∞∆°ng th·ª©c giao d·ªãch v√† trong qu√° tr√¨nh th·ª±c thi, ph∆∞∆°ng th·ª©c A g·ªçi ph∆∞∆°ng th·ª©c B. Khi ƒë√≥, vi·ªác ph∆∞∆°ng th·ª©c B c√≥ s·ª≠ d·ª•ng giao d·ªãch hay kh√¥ng v√† y√™u c·∫ßu c·ªßa ph∆∞∆°ng th·ª©c B v·ªÅ giao d·ªãch s·∫Ω ·∫£nh h∆∞·ªüng ƒë·∫øn c√°ch th·ª©c giao d·ªãch c·ªßa ph∆∞∆°ng th·ª©c A ƒë∆∞·ª£c th·ª±c thi. ƒê·ªìng th·ªùi, giao d·ªãch c·ªßa ph∆∞∆°ng th·ª©c A c≈©ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°ch th·ª©c giao d·ªãch c·ªßa ph∆∞∆°ng th·ª©c B. Nh·ªØng ·∫£nh h∆∞·ªüng n√†y ƒë∆∞·ª£c quy·∫øt ƒë·ªãnh b·ªüi lo·∫°i h√¨nh truy·ªÅn t·∫£i giao d·ªãch c·ªßa hai ph∆∞∆°ng th·ª©c.</p><ol><li><strong>REQUIRED</strong> (m·∫∑c ƒë·ªãnh trong Spring): N·∫øu kh√¥ng c√≥ giao d·ªãch hi·ªán t·∫°i, t·∫°o m·ªõi m·ªôt giao d·ªãch; n·∫øu ƒëang c√≥ giao d·ªãch hi·ªán t·∫°i, tham gia v√†o giao d·ªãch ƒë√≥.</li><li><strong>SUPPORTS</strong>: N·∫øu c√≥ giao d·ªãch hi·ªán t·∫°i, tham gia v√†o giao d·ªãch ƒë√≥; n·∫øu kh√¥ng c√≥ giao d·ªãch hi·ªán t·∫°i, th·ª±c thi nh∆∞ m·ªôt ph∆∞∆°ng th·ª©c kh√¥ng c√≥ giao d·ªãch.</li><li><strong>MANDATORY</strong>: N·∫øu c√≥ giao d·ªãch hi·ªán t·∫°i, tham gia v√†o giao d·ªãch ƒë√≥; n·∫øu kh√¥ng c√≥ giao d·ªãch hi·ªán t·∫°i, n√©m ra ngo·∫°i l·ªá.</li><li><strong>REQUIRES_NEW</strong>: T·∫°o m·ªõi m·ªôt giao d·ªãch, n·∫øu ƒëang c√≥ giao d·ªãch hi·ªán t·∫°i th√¨ t·∫°m ng·ª´ng giao d·ªãch ƒë√≥.</li><li><strong>NOT_SUPPORTED</strong>: Th·ª±c thi nh∆∞ m·ªôt ph∆∞∆°ng th·ª©c kh√¥ng c√≥ giao d·ªãch, n·∫øu c√≥ giao d·ªãch hi·ªán t·∫°i th√¨ t·∫°m ng·ª´ng giao d·ªãch ƒë√≥.</li><li><strong>NEVER</strong>: Kh√¥ng s·ª≠ d·ª•ng giao d·ªãch, n·∫øu c√≥ giao d·ªãch hi·ªán t·∫°i th√¨ n√©m ra ngo·∫°i l·ªá.</li><li><strong>NESTED</strong>: N·∫øu c√≥ giao d·ªãch hi·ªán t·∫°i, th·ª±c thi trong m·ªôt giao d·ªãch l·ªìng nhau; n·∫øu kh√¥ng c√≥ giao d·ªãch hi·ªán t·∫°i, ho·∫°t ƒë·ªông gi·ªëng nh∆∞ <code>REQUIRED</code> (t·∫°o m·ªõi m·ªôt giao d·ªãch).</li></ol><h2 id="tam-tinh-huong-lam-cho-giao-dich-trong-spring-khong-hieu-qua-va-nguyen-nhan-phan-tich" tabindex="-1"><a class="header-anchor" href="#tam-tinh-huong-lam-cho-giao-dich-trong-spring-khong-hieu-qua-va-nguyen-nhan-phan-tich"><span>T√°m t√¨nh hu·ªëng l√†m cho giao d·ªãch trong Spring kh√¥ng hi·ªáu qu·∫£ v√† nguy√™n nh√¢n ph√¢n t√≠ch</span></a></h2><ol><li><strong>T·ª± g·ªçi trong ph∆∞∆°ng th·ª©c</strong>: Giao d·ªãch Spring d·ª±a tr√™n AOP. Khi m·ªôt ph∆∞∆°ng th·ª©c ƒë∆∞·ª£c g·ªçi th√¥ng qua ƒë·ªëi t∆∞·ª£ng proxy, giao d·ªãch Spring m·ªõi c√≥ hi·ªáu l·ª±c. Nh∆∞ng khi trong m·ªôt ph∆∞∆°ng th·ª©c g·ªçi <code>this.xxx()</code> ƒë·ªÉ g·ªçi ph∆∞∆°ng th·ª©c kh√°c, <code>this</code> kh√¥ng ph·∫£i l√† ƒë·ªëi t∆∞·ª£ng proxy, d·∫´n ƒë·∫øn giao d·ªãch kh√¥ng c√≥ hi·ªáu l·ª±c. <ul><li>Gi·∫£i ph√°p 1: T√°ch ph∆∞∆°ng th·ª©c g·ªçi sang m·ªôt Bean kh√°c.</li><li>Gi·∫£i ph√°p 2: T·ª± ti√™m ch√≠nh m√¨nh.</li><li>Gi·∫£i ph√°p 3: S·ª≠ d·ª•ng <code>AopContext.currentProxy()</code> c√πng v·ªõi <code>@EnableAspectJAutoProxy(exposeProxy = true)</code>.</li></ul></li><li><strong>Ph∆∞∆°ng th·ª©c l√† private</strong>: Giao d·ªãch Spring d·ª±a tr√™n CGLIB ƒë·ªÉ th·ª±c hi·ªán AOP. N·∫øu ph∆∞∆°ng th·ª©c trong l·ªõp cha l√† <code>private</code>, l·ªõp con kh√¥ng th·ªÉ ghi ƒë√®, v√† do ƒë√≥ kh√¥ng th·ªÉ b·ªï sung logic giao d·ªãch c·ªßa Spring.</li><li><strong>Ph∆∞∆°ng th·ª©c l√† final</strong>: L√Ω do t∆∞∆°ng t·ª± v·ªõi ph∆∞∆°ng th·ª©c private, v√¨ l·ªõp con kh√¥ng th·ªÉ ghi ƒë√® ph∆∞∆°ng th·ª©c final c·ªßa l·ªõp cha.</li><li><strong>Ph∆∞∆°ng th·ª©c ƒë∆∞·ª£c g·ªçi b·ªüi m·ªôt lu·ªìng ri√™ng</strong>: Khi MyBatis ho·∫∑c JdbcTemplate th·ª±c thi SQL, n√≥ l·∫•y ƒë·ªëi t∆∞·ª£ng k·∫øt n·ªëi c∆° s·ªü d·ªØ li·ªáu t·ª´ <code>ThreadLocal</code>. N·∫øu lu·ªìng kh·ªüi t·∫°o giao d·ªãch v√† lu·ªìng th·ª±c thi SQL kh√¥ng c√πng m·ªôt lu·ªìng, k·∫øt n·ªëi c∆° s·ªü d·ªØ li·ªáu s·∫Ω kh√¥ng ƒë∆∞·ª£c l·∫•y ƒë√∫ng, d·∫´n ƒë·∫øn MyBatis ho·∫∑c JdbcTemplate s·∫Ω t·ª± t·∫°o k·∫øt n·ªëi m·ªõi, khi·∫øn giao d·ªãch kh√¥ng ƒë∆∞·ª£c ki·ªÉm so√°t ƒë√∫ng c√°ch.</li><li><strong>Kh√¥ng th√™m annotation <code>@Configuration</code></strong>: N·∫øu kh√¥ng th√™m annotation n√†y trong c√°c c·∫•u h√¨nh Spring truy·ªÅn th·ªëng, c√≥ th·ªÉ d·∫´n ƒë·∫øn vi·ªác Spring kh√¥ng qu·∫£n l√Ω ƒë√∫ng c√°c Bean v√† kh√¥ng l·∫•y ƒë∆∞·ª£c k·∫øt n·ªëi c∆° s·ªü d·ªØ li·ªáu t·ª´ <code>ThreadLocal</code>.</li><li><strong>Ngo·∫°i l·ªá b·ªã nu·ªët m·∫•t</strong>: N·∫øu Spring kh√¥ng b·∫Øt ƒë∆∞·ª£c ngo·∫°i l·ªá, giao d·ªãch s·∫Ω kh√¥ng b·ªã rollback. M·∫∑c ƒë·ªãnh, Spring s·∫Ω b·∫Øt c√°c ngo·∫°i l·ªá lo·∫°i <code>RuntimeException</code> v√† <code>Error</code>.</li><li><strong>L·ªõp kh√¥ng ƒë∆∞·ª£c Spring qu·∫£n l√Ω</strong>.</li><li><strong>C∆° s·ªü d·ªØ li·ªáu kh√¥ng h·ªó tr·ª£ giao d·ªãch</strong>.</li></ol><h2 id="cac-buoc-tao-bean-trong-spring" tabindex="-1"><a class="header-anchor" href="#cac-buoc-tao-bean-trong-spring"><span>C√°c b∆∞·ªõc t·∫°o Bean trong Spring</span></a></h2><p>Qu√° tr√¨nh t·∫°o m·ªôt Bean trong Spring g·ªìm c√°c b∆∞·ªõc sau:</p><ol><li>Suy ƒëo√°n ph∆∞∆°ng th·ª©c kh·ªüi t·∫°o.</li><li>Kh·ªüi t·∫°o ƒë·ªëi t∆∞·ª£ng.</li><li>Ti√™m thu·ªôc t√≠nh, hay c√≤n g·ªçi l√† ti√™m ph·ª• thu·ªôc.</li><li>X·ª≠ l√Ω c√°c callback c·ªßa Aware.</li><li>Tr∆∞·ªõc khi kh·ªüi t·∫°o, x·ª≠ l√Ω annotation <code>@PostConstruct</code>.</li><li>Kh·ªüi t·∫°o, x·ª≠ l√Ω interface <code>InitializingBean</code>.</li><li>Sau khi kh·ªüi t·∫°o, ti·∫øn h√†nh AOP.</li></ol><h2 id="bean-trong-spring-co-an-toan-trong-moi-truong-ƒëa-luong-khong" tabindex="-1"><a class="header-anchor" href="#bean-trong-spring-co-an-toan-trong-moi-truong-ƒëa-luong-khong"><span>Bean trong Spring c√≥ an to√†n trong m√¥i tr∆∞·ªùng ƒëa lu·ªìng kh√¥ng?</span></a></h2><p>Spring kh√¥ng x·ª≠ l√Ω ri√™ng v·∫•n ƒë·ªÅ an to√†n lu·ªìng cho c√°c Bean. V√¨ v·∫≠y:</p><ol><li>N·∫øu Bean l√† kh√¥ng c√≥ tr·∫°ng th√°i, n√≥ s·∫Ω an to√†n trong m√¥i tr∆∞·ªùng ƒëa lu·ªìng.</li><li>N·∫øu Bean c√≥ tr·∫°ng th√°i, n√≥ kh√¥ng an to√†n trong m√¥i tr∆∞·ªùng ƒëa lu·ªìng.</li></ol><p>V·∫•n ƒë·ªÅ Bean c√≥ an to√†n trong m√¥i tr∆∞·ªùng ƒëa lu·ªìng hay kh√¥ng kh√¥ng li√™n quan ƒë·∫øn ph·∫°m vi c·ªßa Bean, m√† ph·ª• thu·ªôc v√†o tr·∫°ng th√°i c·ªßa ch√≠nh Bean ƒë√≥.</p><h2 id="su-khac-biet-giua-applicationcontext-va-beanfactory" tabindex="-1"><a class="header-anchor" href="#su-khac-biet-giua-applicationcontext-va-beanfactory"><span>S·ª± kh√°c bi·ªát gi·ªØa ApplicationContext v√† BeanFactory</span></a></h2><p><strong>BeanFactory</strong> l√† m·ªôt th√†nh ph·∫ßn c·ªët l√µi trong Spring, ƒë√≥ng vai tr√≤ nh∆∞ m·ªôt nh√† m√°y t·∫°o v√† qu·∫£n l√Ω c√°c Bean. <strong>ApplicationContext</strong> k·∫ø th·ª´a BeanFactory, v√¨ v·∫≠y n√≥ c√≥ t·∫•t c·∫£ c√°c ch·ª©c nƒÉng c·ªßa BeanFactory. Ngo√†i ra, ApplicationContext c√≤n cung c·∫•p c√°c ch·ª©c nƒÉng kh√°c nh∆∞ qu·∫£n l√Ω bi·∫øn m√¥i tr∆∞·ªùng h·ªá th·ªëng, qu·ªëc t·∫ø h√≥a, v√† ph√°t s·ª± ki·ªán m√† BeanFactory kh√¥ng c√≥.</p><h2 id="spring-giao-dich-ƒëuoc-thuc-hien-nhu-the-nao" tabindex="-1"><a class="header-anchor" href="#spring-giao-dich-ƒëuoc-thuc-hien-nhu-the-nao"><span>Spring giao d·ªãch ƒë∆∞·ª£c th·ª±c hi·ªán nh∆∞ th·∫ø n√†o</span></a></h2><ol><li>Giao d·ªãch trong Spring ƒë∆∞·ª£c x√¢y d·ª±ng d·ª±a tr√™n giao d·ªãch c·ªßa c∆° s·ªü d·ªØ li·ªáu v√† c∆° ch·∫ø AOP.</li><li>ƒê·ªëi v·ªõi c√°c Bean c√≥ s·ª≠ d·ª•ng annotation <code>@Transactional</code>, Spring s·∫Ω t·∫°o m·ªôt ƒë·ªëi t∆∞·ª£ng proxy cho Bean ƒë√≥.</li><li>Khi g·ªçi ph∆∞∆°ng th·ª©c c·ªßa ƒë·ªëi t∆∞·ª£ng proxy, Spring s·∫Ω ki·ªÉm tra xem ph∆∞∆°ng th·ª©c ƒë√≥ c√≥ annotation <code>@Transactional</code> hay kh√¥ng.</li><li>N·∫øu c√≥, Spring s·∫Ω s·ª≠ d·ª•ng b·ªô qu·∫£n l√Ω giao d·ªãch ƒë·ªÉ t·∫°o m·ªôt k·∫øt n·ªëi c∆° s·ªü d·ªØ li·ªáu.</li><li>ƒê·ªìng th·ªùi, thay ƒë·ªïi thu·ªôc t√≠nh <code>autocommit</code> c·ªßa k·∫øt n·ªëi th√†nh <code>false</code> ƒë·ªÉ ngƒÉn vi·ªác t·ª± ƒë·ªông commit. ƒê√¢y l√† b∆∞·ªõc r·∫•t quan tr·ªçng ƒë·ªÉ th·ª±c hi·ªán giao d·ªãch trong Spring.</li><li>Sau ƒë√≥, ph∆∞∆°ng th·ª©c hi·ªán t·∫°i s·∫Ω ƒë∆∞·ª£c th·ª±c thi, bao g·ªìm c·∫£ c√°c c√¢u l·ªánh SQL.</li><li>Sau khi ph∆∞∆°ng th·ª©c ƒë∆∞·ª£c th·ª±c thi, n·∫øu kh√¥ng x·∫£y ra ngo·∫°i l·ªá, giao d·ªãch s·∫Ω ƒë∆∞·ª£c commit.</li><li>N·∫øu c√≥ ngo·∫°i l·ªá v√† ngo·∫°i l·ªá n√†y y√™u c·∫ßu rollback, giao d·ªãch s·∫Ω ƒë∆∞·ª£c rollback. N·∫øu ngo·∫°i l·ªá kh√¥ng y√™u c·∫ßu rollback, giao d·ªãch v·∫´n s·∫Ω ƒë∆∞·ª£c commit.</li><li>M·ª©c ƒë·ªô c√°ch ly c·ªßa giao d·ªãch Spring t∆∞∆°ng ·ª©ng v·ªõi m·ª©c ƒë·ªô c√°ch ly c·ªßa c∆° s·ªü d·ªØ li·ªáu.</li><li>C∆° ch·∫ø truy·ªÅn t·∫£i giao d·ªãch l√† ph·∫ßn ph·ª©c t·∫°p nh·∫•t c·ªßa Spring v√† ƒë∆∞·ª£c th·ª±c hi·ªán d·ª±a tr√™n c√°c k·∫øt n·ªëi c∆° s·ªü d·ªØ li·ªáu. M·ªói k·∫øt n·ªëi t∆∞∆°ng ·ª©ng v·ªõi m·ªôt giao d·ªãch. N·∫øu c∆° ch·∫ø truy·ªÅn t·∫£i y√™u c·∫ßu m·ªü m·ªôt giao d·ªãch m·ªõi, Spring s·∫Ω t·∫°o m·ªôt k·∫øt n·ªëi m·ªõi v√† th·ª±c thi SQL tr√™n k·∫øt n·ªëi ƒë√≥.</li></ol><h2 id="khi-nao-annotation-transactional-trong-spring-khong-co-hieu-luc" tabindex="-1"><a class="header-anchor" href="#khi-nao-annotation-transactional-trong-spring-khong-co-hieu-luc"><span>Khi n√†o annotation @Transactional trong Spring kh√¥ng c√≥ hi·ªáu l·ª±c</span></a></h2><p>V√¨ giao d·ªãch trong Spring ƒë∆∞·ª£c th·ª±c hi·ªán d·ª±a tr√™n c√°c proxy, n√™n m·ªôt ph∆∞∆°ng th·ª©c c√≥ annotation <code>@Transactional</code> ch·ªâ c√≥ hi·ªáu l·ª±c khi n√≥ ƒë∆∞·ª£c g·ªçi th√¥ng qua ƒë·ªëi t∆∞·ª£ng proxy. N·∫øu ph∆∞∆°ng th·ª©c ƒë∆∞·ª£c g·ªçi kh√¥ng th√¥ng qua ƒë·ªëi t∆∞·ª£ng proxy, annotation <code>@Transactional</code> s·∫Ω kh√¥ng c√≥ hi·ªáu l·ª±c.</p><p>Ngo√†i ra, n·∫øu ph∆∞∆°ng th·ª©c l√† <code>private</code>, th√¨ <code>@Transactional</code> c≈©ng s·∫Ω kh√¥ng c√≥ hi·ªáu l·ª±c. ƒêi·ªÅu n√†y l√† do CGLIB, m·ªôt c√¥ng c·ª• t·∫°o proxy c·ªßa Spring, d·ª±a tr√™n m·ªëi quan h·ªá cha-con. C√°c ph∆∞∆°ng th·ª©c <code>private</code> c·ªßa l·ªõp cha kh√¥ng th·ªÉ b·ªã ghi ƒë√® b·ªüi l·ªõp con, do ƒë√≥ kh√¥ng th·ªÉ s·ª≠ d·ª•ng proxy, d·∫´n ƒë·∫øn annotation <code>@Transactional</code> kh√¥ng c√≥ hi·ªáu l·ª±c.</p><h2 id="quy-trinh-khoi-ƒëong-cua-spring" tabindex="-1"><a class="header-anchor" href="#quy-trinh-khoi-ƒëong-cua-spring"><span>Quy tr√¨nh kh·ªüi ƒë·ªông c·ªßa Spring</span></a></h2><ol><li>Khi t·∫°o Spring container (kh·ªüi ƒë·ªông Spring):</li><li>Tr∆∞·ªõc h·∫øt, Spring s·∫Ω qu√©t ƒë·ªÉ t√¨m t·∫•t c·∫£ c√°c ƒë·ªëi t∆∞·ª£ng <code>BeanDefinition</code> v√† l∆∞u tr·ªØ ch√∫ng trong m·ªôt Map.</li><li>Sau ƒë√≥, Spring s·∫Ω t·∫°o c√°c Bean ƒë∆°n nh·∫•t (non-lazy) t·ª´ c√°c <code>BeanDefinition</code>. C√°c Bean c√≥ ph·∫°m vi nhi·ªÅu h∆°n s·∫Ω kh√¥ng ƒë∆∞·ª£c t·∫°o trong qu√° tr√¨nh kh·ªüi ƒë·ªông, m√† s·∫Ω ƒë∆∞·ª£c t·∫°o m·ªói khi Bean ƒë√≥ ƒë∆∞·ª£c y√™u c·∫ßu.</li><li>Vi·ªác t·∫°o Bean t·ª´ <code>BeanDefinition</code> l√† qu√° tr√¨nh v√≤ng ƒë·ªùi c·ªßa Bean. N√≥ bao g·ªìm c√°c b∆∞·ªõc nh∆∞ h·ª£p nh·∫•t <code>BeanDefinition</code>, suy ƒëo√°n ph∆∞∆°ng th·ª©c kh·ªüi t·∫°o, kh·ªüi t·∫°o ƒë·ªëi t∆∞·ª£ng, ti√™m thu·ªôc t√≠nh, tr∆∞·ªõc khi kh·ªüi t·∫°o, kh·ªüi t·∫°o v√† sau khi kh·ªüi t·∫°o. AOP s·∫Ω x·∫£y ra ·ªü b∆∞·ªõc sau khi kh·ªüi t·∫°o.</li><li>Sau khi t·∫°o t·∫•t c·∫£ c√°c Bean ƒë∆°n nh·∫•t, Spring s·∫Ω ph√°t ra m·ªôt s·ª± ki·ªán kh·ªüi ƒë·ªông container.</li><li>K·∫øt th√∫c qu√° tr√¨nh kh·ªüi ƒë·ªông Spring.</li><li>Trong m√£ ngu·ªìn c·ªßa Spring, qu√° tr√¨nh n√†y ph·ª©c t·∫°p h∆°n, bao g·ªìm c√°c ph∆∞∆°ng th·ª©c m·∫´u cho c√°c l·ªõp con th·ª±c hi·ªán. Ngo√†i ra, m√£ ngu·ªìn c√≤n x·ª≠ l√Ω ƒëƒÉng k√Ω <code>BeanFactoryPostProcessor</code> v√† <code>BeanPostProcessor</code>. Qu√° tr√¨nh qu√©t c·ªßa Spring d·ª±a v√†o <code>BeanFactoryPostProcessor</code> v√† vi·ªác ti√™m ph·ª• thu·ªôc d·ª±a v√†o <code>BeanPostProcessor</code>.</li><li>Trong qu√° tr√¨nh kh·ªüi ƒë·ªông, Spring c≈©ng s·∫Ω x·ª≠ l√Ω c√°c annotation nh∆∞ <code>@Import</code>.</li></ol><h2 id="cac-mau-thiet-ke-ƒëuoc-su-dung-trong-spring" tabindex="-1"><a class="header-anchor" href="#cac-mau-thiet-ke-ƒëuoc-su-dung-trong-spring"><span>C√°c m·∫´u thi·∫øt k·∫ø ƒë∆∞·ª£c s·ª≠ d·ª•ng trong Spring</span></a></h2><figure><img src="https://cdn.nlark.com/yuque/0/2021/png/365147/1638187280609-2738d2ba-22f1-4107-9c0f-9c7a8144dcba.png" alt="Thi·∫øt k·∫ø trong Spring" tabindex="0" loading="lazy"><figcaption>Thi·∫øt k·∫ø trong Spring</figcaption></figure><h2 id="cac-annotation-thuong-dung-trong-spring-boot-va-cach-thuc-hoat-ƒëong" tabindex="-1"><a class="header-anchor" href="#cac-annotation-thuong-dung-trong-spring-boot-va-cach-thuc-hoat-ƒëong"><span>C√°c annotation th∆∞·ªùng d√πng trong Spring Boot v√† c√°ch th·ª©c ho·∫°t ƒë·ªông</span></a></h2><ol><li><p><strong>@SpringBootApplication</strong>: annotation n√†y ƒë√°nh d·∫•u m·ªôt ·ª©ng d·ª•ng Spring Boot, th·ª±c ch·∫•t l√† t·ªï h·ª£p c·ªßa ba annotation:</p><ol><li><strong>@SpringBootConfiguration</strong>: annotation n√†y t∆∞∆°ng ƒë∆∞∆°ng v·ªõi <code>@Configuration</code>, bi·ªÉu th·ªã r·∫±ng l·ªõp kh·ªüi ƒë·ªông c≈©ng l√† m·ªôt l·ªõp c·∫•u h√¨nh.</li><li><strong>@EnableAutoConfiguration</strong>: T·ª± ƒë·ªông t·∫£i c√°c c·∫•u h√¨nh ƒë∆∞·ª£c x√°c ƒë·ªãnh trong <code>SpringFactories</code> d∆∞·ªõi <code>ClassPath</code> v√†o Spring container d∆∞·ªõi d·∫°ng c√°c Bean c·∫•u h√¨nh.</li><li><strong>@ComponentScan</strong>: X√°c ƒë·ªãnh ƒë∆∞·ªùng d·∫´n ƒë·ªÉ qu√©t c√°c th√†nh ph·∫ßn, m·∫∑c ƒë·ªãnh qu√©t ƒë∆∞·ªùng d·∫´n c·ªßa l·ªõp kh·ªüi ƒë·ªông.</li></ol></li><li><p><strong>@Bean</strong>: D√πng ƒë·ªÉ ƒë·ªãnh nghƒ©a m·ªôt Bean, t∆∞∆°ng t·ª± nh∆∞ th·∫ª <code>&lt;bean&gt;</code> trong XML. Khi Spring kh·ªüi ƒë·ªông, n√≥ s·∫Ω ph√¢n t√≠ch c√°c ph∆∞∆°ng th·ª©c c√≥ annotation <code>@Bean</code>, s·ª≠ d·ª•ng t√™n ph∆∞∆°ng th·ª©c l√†m t√™n Bean v√† th·ª±c thi ph∆∞∆°ng th·ª©c ƒë·ªÉ t·∫°o ƒë·ªëi t∆∞·ª£ng Bean.</p></li><li><p>C√°c annotation nh∆∞ <code>@Controller</code>, <code>@Service</code>, <code>@ResponseBody</code>, <code>@Autowired</code> c≈©ng c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng.</p></li></ol><h2 id="cach-spring-boot-khoi-ƒëong-tomcat" tabindex="-1"><a class="header-anchor" href="#cach-spring-boot-khoi-ƒëong-tomcat"><span>C√°ch Spring Boot kh·ªüi ƒë·ªông Tomcat</span></a></h2><ol><li>Tr∆∞·ªõc h·∫øt, khi Spring Boot kh·ªüi ƒë·ªông, n√≥ s·∫Ω t·∫°o m·ªôt Spring container.</li><li>Trong qu√° tr√¨nh t·∫°o Spring container, Spring Boot s·∫Ω ki·ªÉm tra xem c√≥ t·ªìn t·∫°i th∆∞ vi·ªán Tomcat trong <code>classpath</code> hay kh√¥ng b·∫±ng c√°ch s·ª≠ d·ª•ng k·ªπ thu·∫≠t <code>@ConditionalOnClass</code>. N·∫øu c√≥, Spring Boot s·∫Ω t·∫°o m·ªôt Bean kh·ªüi ƒë·ªông Tomcat.</li><li>Sau khi Spring container ƒë∆∞·ª£c t·∫°o, Spring Boot s·∫Ω l·∫•y Bean kh·ªüi ƒë·ªông Tomcat, t·∫°o m·ªôt ƒë·ªëi t∆∞·ª£ng Tomcat, c·∫•u h√¨nh c√°c c·ªïng k·∫øt n·ªëi, v√† kh·ªüi ƒë·ªông Tomcat.</li></ol><h2 id="uu-ƒëiem-va-nhuoc-ƒëiem-cua-mybatis" tabindex="-1"><a class="header-anchor" href="#uu-ƒëiem-va-nhuoc-ƒëiem-cua-mybatis"><span>∆Øu ƒëi·ªÉm v√† nh∆∞·ª£c ƒëi·ªÉm c·ªßa MyBatis</span></a></h2><p><strong>∆Øu ƒëi·ªÉm:</strong></p><ol><li>D·ª±a tr√™n c√°c c√¢u l·ªánh SQL, linh ho·∫°t v√† kh√¥ng g√¢y ·∫£nh h∆∞·ªüng ƒë·∫øn thi·∫øt k·∫ø c·ªßa ·ª©ng d·ª•ng ho·∫∑c c∆° s·ªü d·ªØ li·ªáu. SQL ƒë∆∞·ª£c vi·∫øt trong XML, gi√∫p t√°ch bi·ªát gi·ªØa SQL v√† m√£ ch∆∞∆°ng tr√¨nh, d·ªÖ d√†ng qu·∫£n l√Ω. H·ªó tr·ª£ vi·∫øt SQL ƒë·ªông v√† c√≥ th·ªÉ t√°i s·ª≠ d·ª•ng.</li><li>Gi·∫£m h∆°n 50% l∆∞·ª£ng m√£ so v·ªõi JDBC, lo·∫°i b·ªè c√°c m√£ d∆∞ th·ª´a trong JDBC v√† kh√¥ng c·∫ßn t·ª± tay m·ªü/ƒë√≥ng k·∫øt n·ªëi.</li><li>T∆∞∆°ng th√≠ch t·ªët v·ªõi nhi·ªÅu c∆° s·ªü d·ªØ li·ªáu (MyBatis s·ª≠ d·ª•ng JDBC ƒë·ªÉ k·∫øt n·ªëi c∆° s·ªü d·ªØ li·ªáu, n√™n h·ªó tr·ª£ m·ªçi c∆° s·ªü d·ªØ li·ªáu m√† JDBC h·ªó tr·ª£).</li><li>T√≠ch h·ª£p t·ªët v·ªõi Spring.</li><li>Cung c·∫•p c√°c th·∫ª √°nh x·∫° h·ªó tr·ª£ ORM, √°nh x·∫° gi·ªØa c√°c tr∆∞·ªùng trong c∆° s·ªü d·ªØ li·ªáu v√† ƒë·ªëi t∆∞·ª£ng.</li></ol><p><strong>Nh∆∞·ª£c ƒëi·ªÉm:</strong></p><ol><li>L∆∞·ª£ng c√¥ng vi·ªác vi·∫øt SQL l·ªõn, ƒë·∫∑c bi·ªát l√† khi c√≥ nhi·ªÅu tr∆∞·ªùng ho·∫∑c b·∫£ng li√™n k·∫øt. Y√™u c·∫ßu l·∫≠p tr√¨nh vi√™n c√≥ k·ªπ nƒÉng vi·∫øt SQL t·ªët.</li><li>SQL ph·ª• thu·ªôc v√†o c∆° s·ªü d·ªØ li·ªáu, g√¢y kh√≥ khƒÉn trong vi·ªác di chuy·ªÉn c∆° s·ªü d·ªØ li·ªáu.</li></ol><h2 id="su-khac-biet-giua-va-trong-mybatis" tabindex="-1"><a class="header-anchor" href="#su-khac-biet-giua-va-trong-mybatis"><span>S·ª± kh√°c bi·ªát gi·ªØa #{} v√† ${} trong MyBatis</span></a></h2><ol><li><code>#{}</code> l√† x·ª≠ l√Ω tr∆∞·ªõc bi√™n d·ªãch v√† ƒë√≥ng vai tr√≤ nh∆∞ m·ªôt d·∫•u ch·ªó.</li><li><code>${}</code> l√† thay th·∫ø chu·ªói v√† ƒë√≥ng vai tr√≤ nh∆∞ m·ªôt chu·ªói k·∫øt n·ªëi.</li></ol><p>Khi MyBatis x·ª≠ l√Ω <code>#{}</code>, n√≥ s·∫Ω thay th·∫ø gi√° tr·ªã trong SQL b·∫±ng d·∫•u <code>?</code> v√† s·ª≠ d·ª•ng <code>PreparedStatement</code> ƒë·ªÉ g√°n gi√° tr·ªã.</p><p>Khi MyBatis x·ª≠ l√Ω <code>${}</code>, n√≥ s·∫Ω thay th·∫ø gi√° tr·ªã b·∫±ng chu·ªói tr·ª±c ti·∫øp trong SQL v√† s·ª≠ d·ª•ng <code>Statement</code> ƒë·ªÉ th·ª±c thi.</p><p>S·ª≠ d·ª•ng <code>#{}</code> c√≥ th·ªÉ gi√∫p ngƒÉn ng·ª´a t·∫•n c√¥ng SQL injection, n√¢ng cao ƒë·ªô b·∫£o m·∫≠t c·ªßa h·ªá th·ªëng.</p><h2 id="nguyen-ly-co-ban-cua-chi-muc-index" tabindex="-1"><a class="header-anchor" href="#nguyen-ly-co-ban-cua-chi-muc-index"><span>Nguy√™n l√Ω c∆° b·∫£n c·ªßa ch·ªâ m·ª•c (Index)</span></a></h2><p>Ch·ªâ m·ª•c ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ t√¨m ki·∫øm nhanh ch√≥ng c√°c b·∫£n ghi c√≥ gi√° tr·ªã c·ª• th·ªÉ. N·∫øu kh√¥ng c√≥ ch·ªâ m·ª•c, th√¥ng th∆∞·ªùng khi th·ª±c hi·ªán truy v·∫•n s·∫Ω ph·∫£i duy·ªát to√†n b·ªô b·∫£ng.</p><p>Nguy√™n l√Ω c·ªßa ch·ªâ m·ª•c: Bi·∫øn d·ªØ li·ªáu kh√¥ng c√≥ tr·∫≠t t·ª± th√†nh d·ªØ li·ªáu c√≥ tr·∫≠t t·ª± ƒë·ªÉ truy v·∫•n.</p><ol><li>S·∫Øp x·∫øp n·ªôi dung c·ªßa c√°c c·ªôt ƒë√£ t·∫°o ch·ªâ m·ª•c.</li><li>T·∫°o b·∫£ng ƒë·∫£o ng∆∞·ª£c t·ª´ k·∫øt qu·∫£ ƒë√£ s·∫Øp x·∫øp.</li><li>G·∫Øn k·∫øt ƒë·ªãa ch·ªâ d·ªØ li·ªáu v√†o n·ªôi dung c·ªßa b·∫£ng ƒë·∫£o ng∆∞·ª£c.</li><li>Khi truy v·∫•n, ƒë·∫ßu ti√™n l·∫•y n·ªôi dung c·ªßa b·∫£ng ƒë·∫£o ng∆∞·ª£c, sau ƒë√≥ l·∫•y ra ƒë·ªãa ch·ªâ d·ªØ li·ªáu ƒë·ªÉ l·∫•y d·ªØ li·ªáu c·ª• th·ªÉ.</li></ol><h2 id="nguyen-tac-thiet-ke-chi-muc" tabindex="-1"><a class="header-anchor" href="#nguyen-tac-thiet-ke-chi-muc"><span>Nguy√™n t·∫Øc thi·∫øt k·∫ø ch·ªâ m·ª•c</span></a></h2><p>Ch·ªâ m·ª•c c·∫ßn truy v·∫•n nhanh h∆°n v√† chi·∫øm √≠t kh√¥ng gian h∆°n.</p><ol><li>C√°c c·ªôt ph√π h·ª£p ƒë·ªÉ ch·ªâ m·ª•c th∆∞·ªùng l√† nh·ªØng c·ªôt xu·∫•t hi·ªán trong m·ªánh ƒë·ªÅ WHERE ho·∫∑c ƒë∆∞·ª£c ch·ªâ ƒë·ªãnh trong m·ªánh ƒë·ªÅ JOIN.</li><li>C√°c b·∫£ng c√≥ c∆° s·ªü d·ªØ li·ªáu nh·ªè s·∫Ω cho hi·ªáu qu·∫£ ch·ªâ m·ª•c k√©m, kh√¥ng c·∫ßn thi·∫øt ph·∫£i t·∫°o ch·ªâ m·ª•c cho c·ªôt n√†y.</li><li>S·ª≠ d·ª•ng ch·ªâ m·ª•c ng·∫Øn. N·∫øu ch·ªâ m·ª•c cho c√°c c·ªôt chu·ªói d√†i, n√™n ch·ªâ ƒë·ªãnh m·ªôt ƒë·ªô d√†i ti·ªÅn t·ªë ƒë·ªÉ ti·∫øt ki·ªám kh√¥ng gian ch·ªâ m·ª•c. N·∫øu t·ª´ t√¨m ki·∫øm v∆∞·ª£t qu√° ƒë·ªô d√†i ti·ªÅn t·ªë c·ªßa ch·ªâ m·ª•c, s·ª≠ d·ª•ng ch·ªâ m·ª•c ƒë·ªÉ lo·∫°i tr·ª´ c√°c d√≤ng kh√¥ng ph√π h·ª£p, sau ƒë√≥ ki·ªÉm tra c√°c d√≤ng c√≤n l·∫°i c√≥ th·ªÉ kh·ªõp hay kh√¥ng.</li><li>Kh√¥ng n√™n t·∫°o ch·ªâ m·ª•c qu√° m·ª©c. Ch·ªâ m·ª•c c·∫ßn th√™m kh√¥ng gian ƒëƒ©a v√† l√†m gi·∫£m hi·ªáu su·∫•t c·ªßa c√°c thao t√°c ghi. Khi s·ª≠a ƒë·ªïi n·ªôi dung b·∫£ng, ch·ªâ m·ª•c s·∫Ω ƒë∆∞·ª£c c·∫≠p nh·∫≠t ho·∫∑c th·∫≠m ch√≠ t√°i c·∫•u tr√∫c, th·ªùi gian n√†y s·∫Ω k√©o d√†i h∆°n n·∫øu c√≥ nhi·ªÅu c·ªôt ch·ªâ m·ª•c. Do ƒë√≥, ch·ªâ c·∫ßn gi·ªØ l·∫°i c√°c ch·ªâ m·ª•c c·∫ßn thi·∫øt cho vi·ªác truy v·∫•n.</li><li>C√°c c·ªôt d·ªØ li·ªáu ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a c√≥ kh√≥a ngo·∫°i nh·∫•t ƒë·ªãnh ph·∫£i t·∫°o ch·ªâ m·ª•c.</li><li>C√°c c·ªôt c√≥ t·∫ßn su·∫•t c·∫≠p nh·∫≠t cao kh√¥ng ph√π h·ª£p ƒë·ªÉ t·∫°o ch·ªâ m·ª•c.</li><li>C√°c c·ªôt kh√¥ng th·ªÉ ph√¢n bi·ªát hi·ªáu qu·∫£ d·ªØ li·ªáu kh√¥ng ph√π h·ª£p l√†m c·ªôt ch·ªâ m·ª•c (v√≠ d·ª• nh∆∞ gi·ªõi t√≠nh, c√≥ th·ªÉ ch·ªâ c√≥ ba lo·∫°i: nam, n·ªØ, ch∆∞a x√°c ƒë·ªãnh, ƒë·ªô ph√¢n bi·ªát qu√° th·∫•p).</li><li>N√™n m·ªü r·ªông ch·ªâ m·ª•c hi·ªán c√≥ thay v√¨ t·∫°o ch·ªâ m·ª•c m·ªõi. V√≠ d·ª•: n·∫øu b·∫£ng ƒë√£ c√≥ ch·ªâ m·ª•c cho a v√† gi·ªù c·∫ßn th√™m ch·ªâ m·ª•c cho (a, b), ch·ªâ c·∫ßn ch·ªânh s·ª≠a ch·ªâ m·ª•c hi·ªán t·∫°i.</li><li>ƒê·ªëi v·ªõi c√°c c·ªôt √≠t ƒë∆∞·ª£c truy v·∫•n ho·∫∑c c√≥ nhi·ªÅu gi√° tr·ªã tr√πng l·∫∑p, kh√¥ng n√™n t·∫°o ch·ªâ m·ª•c.</li><li>Kh√¥ng n√™n t·∫°o ch·ªâ m·ª•c cho c√°c c·ªôt c√≥ ki·ªÉu d·ªØ li·ªáu ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a l√† text, image v√† bit.</li></ol><h2 id="cac-ƒëac-tinh-co-ban-cua-giao-dich-va-muc-ƒëo-cach-ly" tabindex="-1"><a class="header-anchor" href="#cac-ƒëac-tinh-co-ban-cua-giao-dich-va-muc-ƒëo-cach-ly"><span>C√°c ƒë·∫∑c t√≠nh c∆° b·∫£n c·ªßa giao d·ªãch v√† m·ª©c ƒë·ªô c√°ch ly</span></a></h2><p>C√°c ƒë·∫∑c t√≠nh c∆° b·∫£n c·ªßa giao d·ªãch (ACID) bao g·ªìm:</p><p><strong>T√≠nh nguy√™n t·ª≠</strong>: Trong m·ªôt giao d·ªãch, c√°c thao t√°c ph·∫£i th√†nh c√¥ng ho√†n to√†n ho·∫∑c th·∫•t b·∫°i ho√†n to√†n.</p><p><strong>T√≠nh nh·∫•t qu√°n</strong>: C∆° s·ªü d·ªØ li·ªáu lu√¥n chuy·ªÉn t·ª´ m·ªôt tr·∫°ng th√°i nh·∫•t qu√°n sang m·ªôt tr·∫°ng th√°i nh·∫•t qu√°n kh√°c. V√≠ d·ª•, n·∫øu A chuy·ªÉn cho B 100 ƒë·ªìng v√† gi·∫£ s·ª≠ A ch·ªâ c√≥ 90 ƒë·ªìng, tr∆∞·ªõc khi thanh to√°n, d·ªØ li·ªáu trong c∆° s·ªü d·ªØ li·ªáu ph·∫£i tu√¢n theo c√°c r√†ng bu·ªôc. N·∫øu giao d·ªãch th√†nh c√¥ng, d·ªØ li·ªáu trong c∆° s·ªü d·ªØ li·ªáu s·∫Ω vi ph·∫°m c√°c r√†ng bu·ªôc, v√¨ v·∫≠y giao d·ªãch kh√¥ng th·ªÉ th√†nh c√¥ng. T·∫°i ƒë√¢y, ch√∫ng ta n√≥i r·∫±ng giao d·ªãch cung c·∫•p ƒë·∫£m b·∫£o t√≠nh nh·∫•t qu√°n.</p><p><strong>T√≠nh c√°ch ly</strong>: C√°c thay ƒë·ªïi c·ªßa m·ªôt giao d·ªãch kh√¥ng th·ªÉ nh√¨n th·∫•y b·ªüi c√°c giao d·ªãch kh√°c tr∆∞·ªõc khi n√≥ ƒë∆∞·ª£c x√°c nh·∫≠n.</p><p><strong>T√≠nh b·ªÅn v·ªØng</strong>: Khi m·ªôt giao d·ªãch ƒë√£ ƒë∆∞·ª£c x√°c nh·∫≠n, c√°c thay ƒë·ªïi s·∫Ω ƒë∆∞·ª£c l∆∞u tr·ªØ vƒ©nh vi·ªÖn trong c∆° s·ªü d·ªØ li·ªáu.</p><p>T√≠nh c√°ch ly c√≥ b·ªën m·ª©c ƒë·ªô, bao g·ªìm:</p><ul><li><p><strong>Read uncommitted (ƒê·ªçc ch∆∞a x√°c nh·∫≠n)</strong>: C√≥ th·ªÉ ƒë·ªçc d·ªØ li·ªáu ch∆∞a ƒë∆∞·ª£c x√°c nh·∫≠n t·ª´ c√°c giao d·ªãch kh√°c, c√≤n g·ªçi l√† ƒë·ªçc b·∫©n. Ng∆∞·ªùi d√πng ƒë√°ng l·∫Ω ph·∫£i ƒë·ªçc ƒë∆∞·ª£c tu·ªïi c·ªßa ng∆∞·ªùi d√πng v·ªõi id=1 l√† 10, nh∆∞ng l·∫°i ƒë·ªçc ƒë∆∞·ª£c tu·ªïi t·ª´ m·ªôt giao d·ªãch kh√°c ch∆∞a ƒë∆∞·ª£c x√°c nh·∫≠n, k·∫øt qu·∫£ l√† tu·ªïi=20, ƒë√¢y l√† tr∆∞·ªùng h·ª£p ƒë·ªçc b·∫©n.</p></li><li><p><strong>Read committed (ƒê·ªçc ƒë√£ x√°c nh·∫≠n)</strong>: Hai l·∫ßn ƒë·ªçc k·∫øt qu·∫£ kh√¥ng nh·∫•t qu√°n, g·ªçi l√† ƒë·ªçc kh√¥ng l·∫∑p l·∫°i. ƒê·ªçc ƒë√£ x√°c nh·∫≠n gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ ƒë·ªçc b·∫©n, ch·ªâ ƒë·ªçc c√°c giao d·ªãch ƒë√£ x√°c nh·∫≠n. Ng∆∞·ªùi d√πng m·ªü giao d·ªãch ƒë·ªçc ng∆∞·ªùi d√πng v·ªõi id=1, ph√°t hi·ªán tu·ªïi=10, nh∆∞ng khi ƒë·ªçc l·∫°i th·∫•y k·∫øt qu·∫£ l√† 20. Trong c√πng m·ªôt giao d·ªãch, c√πng m·ªôt truy v·∫•n ƒë·ªçc ƒë∆∞·ª£c c√°c k·∫øt qu·∫£ kh√°c nhau g·ªçi l√† ƒë·ªçc kh√¥ng l·∫∑p l·∫°i.</p></li><li><p><strong>Repeatable read (ƒê·ªçc c√≥ th·ªÉ l·∫∑p l·∫°i)</strong>: ƒê√¢y l√† m·ª©c ƒë·ªô m·∫∑c ƒë·ªãnh c·ªßa MySQL, m·ªói l·∫ßn ƒë·ªçc k·∫øt qu·∫£ ƒë·ªÅu gi·ªëng nhau, nh∆∞ng c√≥ th·ªÉ ph√°t sinh v·∫•n ƒë·ªÅ ƒë·ªçc ma.</p></li><li><p><strong>Serializable (Tu·∫ßn t·ª±)</strong>: Th∆∞·ªùng kh√¥ng ƒë∆∞·ª£c s·ª≠ d·ª•ng, v√¨ n√≥ s·∫Ω kh√≥a t·ª´ng d√≤ng d·ªØ li·ªáu ƒë∆∞·ª£c ƒë·ªçc, d·∫´n ƒë·∫øn nhi·ªÅu v·∫•n ƒë·ªÅ v·ªÅ th·ªùi gian ch·ªù v√† c·∫°nh tranh kh√≥a.</p></li></ul><h2 id="mvcc-la-gi" tabindex="-1"><a class="header-anchor" href="#mvcc-la-gi"><span>MVCC l√† g√¨?</span></a></h2><p>MVCC (Multi-Version Concurrency Control - Ki·ªÉm so√°t ƒë·ªìng th·ªùi ƒëa phi√™n b·∫£n) ƒë·ªÅ c·∫≠p ƒë·∫øn qu√° tr√¨nh truy c·∫≠p chu·ªói phi√™n b·∫£n c·ªßa c√°c b·∫£n ghi khi th·ª±c hi·ªán c√°c thao t√°c SELECT th√¥ng th∆∞·ªùng trong c√°c giao d·ªãch s·ª≠ d·ª•ng m·ª©c ƒë·ªô c√°ch ly READ COMMITTED v√† REPEATABLE READ. ƒêi·ªÅu n√†y cho ph√©p c√°c thao t√°c ƒë·ªçc-ghi v√† ghi-ƒë·ªçc c·ªßa c√°c giao d·ªãch kh√°c nhau th·ª±c hi·ªán ƒë·ªìng th·ªùi, t·ª´ ƒë√≥ n√¢ng cao hi·ªáu su·∫•t h·ªá th·ªëng. M·ªôt ƒëi·ªÉm kh√°c bi·ªát l·ªõn gi·ªØa hai m·ª©c ƒë·ªô c√°ch ly READ COMMITTED v√† REPEATABLE READ l√†: th·ªùi ƒëi·ªÉm t·∫°o ReadView kh√°c nhau. READ COMMITTED s·∫Ω t·∫°o m·ªôt ReadView tr∆∞·ªõc m·ªói l·∫ßn th·ª±c hi·ªán thao t√°c SELECT th√¥ng th∆∞·ªùng, trong khi REPEATABLE READ ch·ªâ t·∫°o m·ªôt ReadView tr∆∞·ªõc l·∫ßn th·ª±c hi·ªán SELECT ƒë·∫ßu ti√™n, v√† sau ƒë√≥ c√°c thao t√°c truy v·∫•n sau s·∫Ω t√°i s·ª≠ d·ª•ng ReadView n√†y.</p><h2 id="tom-tat-su-khac-biet-giua-myisam-va-innodb" tabindex="-1"><a class="header-anchor" href="#tom-tat-su-khac-biet-giua-myisam-va-innodb"><span>T√≥m t·∫Øt s·ª± kh√°c bi·ªát gi·ªØa MyISAM v√† InnoDB</span></a></h2><p><strong>MyISAM:</strong></p><ul><li>Kh√¥ng h·ªó tr·ª£ giao d·ªãch, nh∆∞ng m·ªói l·∫ßn truy v·∫•n ƒë·ªÅu l√† nguy√™n t·ª≠.</li><li>H·ªó tr·ª£ kh√≥a c·∫•p b·∫£ng, t·ª©c l√† m·ªói thao t√°c ƒë·ªÅu kh√≥a to√†n b·ªô b·∫£ng.</li><li>L∆∞u tr·ªØ t·ªïng s·ªë h√†ng c·ªßa b·∫£ng.</li><li>M·ªôt b·∫£ng MYISAM c√≥ ba t·ªáp: t·ªáp ch·ªâ m·ª•c, t·ªáp c·∫•u tr√∫c b·∫£ng v√† t·ªáp d·ªØ li·ªáu.</li><li>S·ª≠ d·ª•ng ch·ªâ m·ª•c kh√¥ng t·∫≠p trung, trong ƒë√≥ mi·ªÅn d·ªØ li·ªáu c·ªßa t·ªáp ch·ªâ m·ª•c l∆∞u tr·ªØ c√°c con tr·ªè ch·ªâ v√†o t·ªáp d·ªØ li·ªáu. Ch·ªâ m·ª•c ph·ª• g·∫ßn nh∆∞ gi·ªëng v·ªõi ch·ªâ m·ª•c ch√≠nh, nh∆∞ng ch·ªâ m·ª•c ph·ª• kh√¥ng c·∫ßn ƒë·∫£m b·∫£o t√≠nh duy nh·∫•t.</li></ul><p><strong>InnoDB:</strong></p><ul><li>H·ªó tr·ª£ giao d·ªãch ACID, h·ªó tr·ª£ b·ªën m·ª©c ƒë·ªô c√°ch ly c·ªßa giao d·ªãch.</li><li>H·ªó tr·ª£ kh√≥a c·∫•p h√†ng v√† r√†ng bu·ªôc kh√≥a ngo·∫°i, do ƒë√≥ c√≥ th·ªÉ h·ªó tr·ª£ ghi ƒë·ªìng th·ªùi.</li><li>Kh√¥ng l∆∞u tr·ªØ t·ªïng s·ªë h√†ng.</li><li>M·ªôt ƒë·ªông c∆° InnoDB l∆∞u tr·ªØ trong m·ªôt kh√¥ng gian t·ªáp (kh√¥ng gian b·∫£ng chia s·∫ª, k√≠ch th∆∞·ªõc b·∫£ng kh√¥ng b·ªã h·ªá ƒëi·ªÅu h√†nh ki·ªÉm so√°t, m·ªôt b·∫£ng c√≥ th·ªÉ ph√¢n b·ªë tr√™n nhi·ªÅu t·ªáp), c≈©ng c√≥ th·ªÉ l√† nhi·ªÅu kh√¥ng gian (ƒë∆∞·ª£c ƒë·∫∑t th√†nh kh√¥ng gian b·∫£ng ƒë·ªôc l·∫≠p, k√≠ch th∆∞·ªõc b·∫£ng b·ªã gi·ªõi h·∫°n b·ªüi k√≠ch th∆∞·ªõc t·ªáp c·ªßa h·ªá ƒëi·ªÅu h√†nh, th∆∞·ªùng l√† 2G), ph·ª• thu·ªôc v√†o gi·ªõi h·∫°n k√≠ch th∆∞·ªõc t·ªáp c·ªßa h·ªá ƒëi·ªÅu h√†nh.</li><li>Ch·ªâ m·ª•c kh√≥a ch√≠nh s·ª≠ d·ª•ng ch·ªâ m·ª•c t·∫≠p trung (mi·ªÅn d·ªØ li·ªáu c·ªßa ch·ªâ m·ª•c l∆∞u tr·ªØ ch√≠nh t·ªáp d·ªØ li·ªáu), mi·ªÅn d·ªØ li·ªáu c·ªßa ch·ªâ m·ª•c ph·ª• l∆∞u tr·ªØ gi√° tr·ªã kh√≥a ch√≠nh; v√¨ v·∫≠y, ƒë·ªÉ t√¨m d·ªØ li·ªáu qua ch·ªâ m·ª•c ph·ª•, c·∫ßn ph·∫£i t√¨m gi√° tr·ªã kh√≥a ch√≠nh qua ch·ªâ m·ª•c ph·ª• tr∆∞·ªõc, r·ªìi truy c·∫≠p ch·ªâ m·ª•c ph·ª•; t·ªët nh·∫•t l√† s·ª≠ d·ª•ng kh√≥a ch√≠nh t·ª± tƒÉng ƒë·ªÉ tr√°nh ph·∫£i ƒëi·ªÅu ch·ªânh l·ªõn t·ªáp khi ch√®n d·ªØ li·ªáu, nh·∫±m duy tr√¨ c·∫•u tr√∫c B+ c√¢y.</li></ul><h2 id="cac-truong-trong-ket-qua-cua-cau-lenh-explain-ƒëai-dien-cho-ƒëieu-gi" tabindex="-1"><a class="header-anchor" href="#cac-truong-trong-ket-qua-cua-cau-lenh-explain-ƒëai-dien-cho-ƒëieu-gi"><span>C√°c tr∆∞·ªùng trong k·∫øt qu·∫£ c·ªßa c√¢u l·ªánh Explain ƒë·∫°i di·ªán cho ƒëi·ªÅu g√¨</span></a></h2><table><thead><tr><th>T√™n c·ªôt</th><th>M√¥ t·∫£</th></tr></thead><tbody><tr><td>id</td><td>M·ªói khi xu·∫•t hi·ªán m·ªôt t·ª´ kh√≥a SELECT trong c√¢u truy v·∫•n, MySQL s·∫Ω g√°n m·ªôt gi√° tr·ªã id duy nh·∫•t cho n√≥. M·ªôt s·ªë truy v·∫•n con c√≥ th·ªÉ ƒë∆∞·ª£c t·ªëi ∆∞u th√†nh truy v·∫•n JOIN, do ƒë√≥ id xu·∫•t hi·ªán s·∫Ω gi·ªëng nhau.</td></tr><tr><td>select_type</td><td>Lo·∫°i truy v·∫•n t∆∞∆°ng ·ª©ng v·ªõi t·ª´ kh√≥a SELECT.</td></tr><tr><td>table</td><td>T√™n b·∫£ng.</td></tr><tr><td>partitions</td><td>Th√¥ng tin v·ªÅ c√°c ph√¢n v√πng ph√π h·ª£p.</td></tr><tr><td>type</td><td>Ph∆∞∆°ng th·ª©c truy v·∫•n ƒë·ªëi v·ªõi b·∫£ng ƒë∆°n (qu√©t to√†n b·ªô b·∫£ng, ch·ªâ m·ª•c).</td></tr><tr><td>possible_keys</td><td>C√°c ch·ªâ m·ª•c c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng.</td></tr><tr><td>key</td><td>Ch·ªâ m·ª•c th·ª±c t·∫ø ƒë√£ s·ª≠ d·ª•ng.</td></tr><tr><td>key_len</td><td>ƒê·ªô d√†i c·ªßa ch·ªâ m·ª•c th·ª±c t·∫ø ƒë√£ s·ª≠ d·ª•ng.</td></tr><tr><td>ref</td><td>Th√¥ng tin v·ªÅ ƒë·ªëi t∆∞·ª£ng ƒë∆∞·ª£c kh·ªõp v·ªõi c·ªôt ch·ªâ m·ª•c khi s·ª≠ d·ª•ng truy v·∫•n v·ªõi gi√° tr·ªã b·∫±ng.</td></tr><tr><td>rows</td><td>S·ªë l∆∞·ª£ng b·∫£n ghi d·ª± ƒëo√°n c·∫ßn ƒë·ªçc.</td></tr><tr><td>filtered</td><td>T·ª∑ l·ªá ph·∫ßn trƒÉm s·ªë b·∫£n ghi c√≤n l·∫°i sau khi b·∫£ng ƒë∆∞·ª£c l·ªçc qua ƒëi·ªÅu ki·ªán t√¨m ki·∫øm.</td></tr><tr><td>Extra</td><td>M·ªôt s·ªë th√¥ng tin b·ªï sung, ch·∫≥ng h·∫°n nh∆∞ s·∫Øp x·∫øp, v.v.</td></tr></tbody></table><h2 id="phan-tich-chin-tinh-huong-lam-mat-hieu-luc-cua-chi-muc-trong-mysql" tabindex="-1"><a class="header-anchor" href="#phan-tich-chin-tinh-huong-lam-mat-hieu-luc-cua-chi-muc-trong-mysql"><span>Ph√¢n t√≠ch ch√≠n t√¨nh hu·ªëng l√†m m·∫•t hi·ªáu l·ª±c c·ªßa ch·ªâ m·ª•c trong MySQL</span></a></h2><p>D·ªØ li·ªáu b·∫£ng:</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">CREATE</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> TABLE `t1` (</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">  a </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> primary key</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">  b </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">  c </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">  d </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">  e </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">varchar</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">20</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">)</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) ENGINE</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">InnoDB</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">insert into t1 </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">values</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&#39;d&#39;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">insert into t1 </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">values</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&#39;a&#39;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">insert into t1 </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">values</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&#39;h&#39;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">insert into t1 </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">values</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&#39;b&#39;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">insert into t1 </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">values</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&#39;e&#39;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">insert into t1 </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">values</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&#39;c&#39;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">insert into t1 </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">values</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">7</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&#39;g&#39;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">insert into t1 </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">values</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">6</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">6</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&#39;f&#39;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>T√¨nh tr·∫°ng ch·ªâ m·ª•c:</p><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/365147/1676441269905-beaa3167-d54b-459f-81b2-8511fa98d205.png" alt="Ch·ªâ m·ª•c" tabindex="0" loading="lazy"><figcaption>Ch·ªâ m·ª•c</figcaption></figure><p>Tr∆∞·ªùng a l√† kh√≥a ch√≠nh, t∆∞∆°ng ·ª©ng v·ªõi ch·ªâ m·ª•c kh√≥a ch√≠nh, ba tr∆∞·ªùng b, c, d t·∫°o th√†nh m·ªôt ch·ªâ m·ª•c k·∫øt h·ª£p, v√† tr∆∞·ªùng e c√≥ m·ªôt ch·ªâ m·ª•c.</p><h3 id="_1-khong-tuan-thu-nguyen-tac-khop-trai-nhat" tabindex="-1"><a class="header-anchor" href="#_1-khong-tuan-thu-nguyen-tac-khop-trai-nhat"><span>1. Kh√¥ng tu√¢n th·ªß nguy√™n t·∫Øc kh·ªõp tr√°i nh·∫•t</span></a></h3><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/365147/1676440676093-add4ff6a-d422-4f40-b3cb-b37e47649586.png" alt="Kh√¥ng kh·ªõp tr√°i nh·∫•t" tabindex="0" loading="lazy"><figcaption>Kh√¥ng kh·ªõp tr√°i nh·∫•t</figcaption></figure><p>Khi b·ªè ƒëi·ªÅu ki·ªán b=1, s·∫Ω kh√¥ng tu√¢n th·ªß nguy√™n t·∫Øc kh·ªõp tr√°i nh·∫•t, d·∫´n ƒë·∫øn t·∫•t c·∫£ ƒë·ªÅu b·ªã m·∫•t hi·ªáu l·ª±c.</p><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/365147/1676440694138-21cb9f9e-62fd-4407-8a59-35dac67b4bb0.png" alt="M·∫•t hi·ªáu l·ª±c" tabindex="0" loading="lazy"><figcaption>M·∫•t hi·ªáu l·ª±c</figcaption></figure><h3 id="_2-truy-van-like-khong-chinh-xac" tabindex="-1"><a class="header-anchor" href="#_2-truy-van-like-khong-chinh-xac"><span>2. Truy v·∫•n Like kh√¥ng ch√≠nh x√°c</span></a></h3><p>Kh√¥ng s·ª≠ d·ª•ng like c√≥ th·ªÉ s·ª≠ d·ª•ng ch·ªâ m·ª•c:</p><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/365147/1676441388985-dd894fe7-5e62-4963-82d0-f35527244b5a.png" alt="Truy v·∫•n kh√¥ng like" tabindex="0" loading="lazy"><figcaption>Truy v·∫•n kh√¥ng like</figcaption></figure><p>S·ª≠ d·ª•ng like ƒë√∫ng c√°ch:</p><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/365147/1676441439769-58372ca6-248e-4751-8d33-516c484eb3e4.png" alt="Truy v·∫•n like ƒë√∫ng" tabindex="0" loading="lazy"><figcaption>Truy v·∫•n like ƒë√∫ng</figcaption></figure><p>S·ª≠ d·ª•ng like kh√¥ng ƒë√∫ng c√°ch:</p><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/365147/1676441454918-10d3d846-cb50-49a6-b27d-7d581e47cf6e.png" alt="Truy v·∫•n like kh√¥ng ƒë√∫ng" tabindex="0" loading="lazy"><figcaption>Truy v·∫•n like kh√¥ng ƒë√∫ng</figcaption></figure><h3 id="_3-thuc-hien-phep-tinh-tren-cot-chi-muc-hoac-su-dung-ham" tabindex="-1"><a class="header-anchor" href="#_3-thuc-hien-phep-tinh-tren-cot-chi-muc-hoac-su-dung-ham"><span>3. Th·ª±c hi·ªán ph√©p t√≠nh tr√™n c·ªôt ch·ªâ m·ª•c ho·∫∑c s·ª≠ d·ª•ng h√†m</span></a></h3><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/365147/1676441511562-24c5629c-7592-46fc-ada6-8cb799f74565.png" alt="Ph√©p t√≠nh tr√™n ch·ªâ m·ª•c" tabindex="0" loading="lazy"><figcaption>Ph√©p t√≠nh tr√™n ch·ªâ m·ª•c</figcaption></figure><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/365147/1676441536615-677899cc-8abb-481a-85b6-61b58ea76179.png" alt="H√†m tr√™n ch·ªâ m·ª•c" tabindex="0" loading="lazy"><figcaption>H√†m tr√™n ch·ªâ m·ª•c</figcaption></figure><h3 id="_4-chuyen-ƒëoi-kieu-tren-cot-chi-muc" tabindex="-1"><a class="header-anchor" href="#_4-chuyen-ƒëoi-kieu-tren-cot-chi-muc"><span>4. Chuy·ªÉn ƒë·ªïi ki·ªÉu tr√™n c·ªôt ch·ªâ m·ª•c</span></a></h3><p>Tr∆∞·ªùng e c√≥ ki·ªÉu l√† varchar, c√¢u SQL d∆∞·ªõi ƒë√¢y c·∫ßn chuy·ªÉn ƒë·ªïi k√Ω t·ª± trong tr∆∞·ªùng e th√†nh s·ªë, ƒëi·ªÅu n√†y s·∫Ω l√†m m·∫•t hi·ªáu l·ª±c c·ªßa ch·ªâ m·ª•c.</p><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/365147/1676441574914-0b982490-b3cb-45ab-a5f5-9b92380e78dc.png" alt="Chuy·ªÉn ƒë·ªïi ki·ªÉu" tabindex="0" loading="lazy"><figcaption>Chuy·ªÉn ƒë·ªïi ki·ªÉu</figcaption></figure><h3 id="_5-khong-bang-gay-mat-hieu-luc-chi-muc" tabindex="-1"><a class="header-anchor" href="#_5-khong-bang-gay-mat-hieu-luc-chi-muc"><span>5. &lt;&gt; kh√¥ng b·∫±ng g√¢y m·∫•t hi·ªáu l·ª±c ch·ªâ m·ª•c</span></a></h3><p>b=1 c√≥ th·ªÉ s·ª≠ d·ª•ng ch·ªâ m·ª•c, nh∆∞ng b&lt;&gt;1 th√¨ kh√¥ng.</p><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/365147/1676441625277-08d21740-9d77-485f-9915-3f43e703cfe2.png" alt="Kh√¥ng b·∫±ng g√¢y m·∫•t hi·ªáu l·ª±c" tabindex="0" loading="lazy"><figcaption>Kh√¥ng b·∫±ng g√¢y m·∫•t hi·ªáu l·ª±c</figcaption></figure><h3 id="_6-order-by-gay-mat-hieu-luc-chi-muc" tabindex="-1"><a class="header-anchor" href="#_6-order-by-gay-mat-hieu-luc-chi-muc"><span>6. order by g√¢y m·∫•t hi·ªáu l·ª±c ch·ªâ m·ª•c</span></a></h3><p>D√π c√≥ s·ª≠ d·ª•ng ch·ªâ m·ª•c, nh∆∞ng do l√† select * n√™n c·∫ßn ph·∫£i truy v·∫•n l·∫°i b·∫£ng, v√† chi ph√≠ truy v·∫•n l·∫°i kh√° cao, v√¨ v·∫≠y s·∫Ω kh√¥ng s·ª≠ d·ª•ng ch·ªâ m·ª•c.</p><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/365147/1676442107674-6566e5ed-784a-4325-9869-a9ad0b8bb6e6.png" alt="order by kh√¥ng hi·ªáu l·ª±c" tabindex="0" loading="lazy"><figcaption>order by kh√¥ng hi·ªáu l·ª±c</figcaption></figure><p>N·∫øu l√† select b th√¨ c·∫ßn ph·∫£i truy v·∫•n l·∫°i b·∫£ng, v√† s·∫Ω ch·ªçn s·ª≠ d·ª•ng ch·ªâ m·ª•c.</p><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/365147/1676442170113-f7ec872a-ddb1-4183-b477-131b056fb588.png" alt="select b s·ª≠ d·ª•ng ch·ªâ m·ª•c" tabindex="0" loading="lazy"><figcaption>select b s·ª≠ d·ª•ng ch·ªâ m·ª•c</figcaption></figure><h3 id="_7-su-dung-or-gay-mat-hieu-luc-chi-muc" tabindex="-1"><a class="header-anchor" href="#_7-su-dung-or-gay-mat-hieu-luc-chi-muc"><span>7. S·ª≠ d·ª•ng or g√¢y m·∫•t hi·ªáu l·ª±c ch·ªâ m·ª•c</span></a></h3><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/365147/1676442219810-663f0bb0-5ed1-4cac-b93d-be3eaf7452e2.png" alt="or g√¢y m·∫•t hi·ªáu l·ª±c" tabindex="0" loading="lazy"><figcaption>or g√¢y m·∫•t hi·ªáu l·ª±c</figcaption></figure><h3 id="_8-select-gay-mat-hieu-luc-chi-muc" tabindex="-1"><a class="header-anchor" href="#_8-select-gay-mat-hieu-luc-chi-muc"><span>8. select * g√¢y m·∫•t hi·ªáu l·ª±c ch·ªâ m·ª•c</span></a></h3><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/365147/1676442285345-6dce4534-c3dc-4348-b712-c1ec27164afb.png" alt="select * kh√¥ng hi·ªáu l·ª±c" tabindex="0" loading="lazy"><figcaption>select * kh√¥ng hi·ªáu l·ª±c</figcaption></figure><h3 id="_9-truy-van-pham-vi-voi-khoi-luong-du-lieu-qua-lon-dan-ƒëen-mat-hieu-luc-chi-muc" tabindex="-1"><a class="header-anchor" href="#_9-truy-van-pham-vi-voi-khoi-luong-du-lieu-qua-lon-dan-ƒëen-mat-hieu-luc-chi-muc"><span>9. Truy v·∫•n ph·∫°m vi v·ªõi kh·ªëi l∆∞·ª£ng d·ªØ li·ªáu qu√° l·ªõn d·∫´n ƒë·∫øn m·∫•t hi·ªáu l·ª±c ch·ªâ m·ª•c</span></a></h3><p>Th√™m m·ªôt s·ªë d·ªØ li·ªáu m·ªõi:</p><div class="language-java" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">insert into t1 </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">values</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&#39;d&#39;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">insert into t1 </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">values</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">20</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&#39;a&#39;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">insert into t1 </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">values</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">15</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&#39;h&#39;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">insert into t1 </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">values</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">18</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&#39;b&#39;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">insert into t1 </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">values</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">14</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&#39;e&#39;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">insert into t1 </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">values</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">13</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&#39;c&#39;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">insert into t1 </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">values</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">17</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&#39;g&#39;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">insert into t1 </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">values</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">22</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">6</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&#39;f&#39;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span></code></pre></div><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/365147/1676443326948-a9f418ab-1606-47ab-9ebd-618fde89d761.png" alt="Truy v·∫•n d·ªØ li·ªáu l·ªõn" tabindex="0" loading="lazy"><figcaption>Truy v·∫•n d·ªØ li·ªáu l·ªõn</figcaption></figure><h5 id="" tabindex="-1"><a class="header-anchor" href="#"><span></span></a></h5><h2 id="chi-muc-bao-phu-la-gi" tabindex="-1"><a class="header-anchor" href="#chi-muc-bao-phu-la-gi"><span>Ch·ªâ m·ª•c bao ph·ªß l√† g√¨?</span></a></h2><p>Ch·ªâ m·ª•c bao ph·ªß l√† khi m·ªôt c√¢u SQL trong qu√° tr√¨nh th·ª±c thi c√≥ th·ªÉ s·ª≠ d·ª•ng ch·ªâ m·ª•c ƒë·ªÉ t√¨m ki·∫øm nhanh ch√≥ng, v√† c√°c tr∆∞·ªùng c·∫ßn truy v·∫•n c·ªßa c√¢u SQL n√†y ƒë·ªÅu c√≥ trong c√°c tr∆∞·ªùng t∆∞∆°ng ·ª©ng c·ªßa ch·ªâ m·ª•c hi·ªán t·∫°i. ƒêi·ªÅu n√†y c√≥ nghƒ©a l√† sau khi c√¢u SQL th·ª±c hi·ªán xong ch·ªâ m·ª•c, n√≥ kh√¥ng c·∫ßn ph·∫£i quay l·∫°i b·∫£ng n·ªØa, v√¨ c√°c tr∆∞·ªùng c·∫ßn thi·∫øt ƒë√£ c√≥ s·∫µn tr√™n c√°c n√∫t l√° c·ªßa ch·ªâ m·ª•c hi·ªán t·∫°i v√† c√≥ th·ªÉ ƒë∆∞·ª£c tr·∫£ v·ªÅ tr·ª±c ti·∫øp nh∆∞ k·∫øt qu·∫£.</p><h5 id="-1" tabindex="-1"><a class="header-anchor" href="#-1"><span></span></a></h5><h2 id="nguyen-tac-tien-to-trai-nhat-la-gi" tabindex="-1"><a class="header-anchor" href="#nguyen-tac-tien-to-trai-nhat-la-gi"><span>Nguy√™n t·∫Øc ti·ªÅn t·ªë tr√°i nh·∫•t l√† g√¨?</span></a></h2><p>Khi m·ªôt c√¢u SQL mu·ªën s·ª≠ d·ª•ng ch·ªâ m·ª•c, n√≥ nh·∫•t ƒë·ªãnh ph·∫£i cung c·∫•p tr∆∞·ªùng ·ªü b√™n tr√°i nh·∫•t trong c√°c tr∆∞·ªùng t∆∞∆°ng ·ª©ng c·ªßa ch·ªâ m·ª•c, t·ª©c l√† tr∆∞·ªùng ƒë·ª©ng ƒë·∫ßu ti√™n. V√≠ d·ª•, n·∫øu m·ªôt ch·ªâ m·ª•c k·∫øt h·ª£p ƒë∆∞·ª£c t·∫°o cho c√°c tr∆∞·ªùng a, b, c, th√¨ khi vi·∫øt m·ªôt c√¢u SQL, ƒëi·ªÅu ki·ªán cho tr∆∞·ªùng a nh·∫•t ƒë·ªãnh ph·∫£i ƒë∆∞·ª£c cung c·∫•p. ƒêi·ªÅu n√†y ƒë·∫£m b·∫£o r·∫±ng ch·ªâ m·ª•c k·∫øt h·ª£p ƒë∆∞·ª£c s·ª≠ d·ª•ng, v√¨ khi t·∫°o ch·ªâ m·ª•c k·∫øt h·ª£p cho c√°c tr∆∞·ªùng a, b, c, c√¢y B+ c∆° s·ªü s·∫Ω ƒë∆∞·ª£c s·∫Øp x·∫øp theo th·ª© t·ª± t·ª´ tr√°i sang ph·∫£i d·ª±a tr√™n a, b, c. Do ƒë√≥, n·∫øu mu·ªën s·ª≠ d·ª•ng c√¢y B+ ƒë·ªÉ t√¨m ki·∫øm nhanh ch√≥ng, ph·∫£i tu√¢n theo quy t·∫Øc n√†y.</p><h5 id="-2" tabindex="-1"><a class="header-anchor" href="#-2"><span></span></a></h5><h2 id="innodb-thuc-hien-giao-dich-nhu-the-nao" tabindex="-1"><a class="header-anchor" href="#innodb-thuc-hien-giao-dich-nhu-the-nao"><span>Innodb th·ª±c hi·ªán giao d·ªãch nh∆∞ th·∫ø n√†o?</span></a></h2><p>Innodb s·ª≠ d·ª•ng Buffer Pool, LogBuffer, Redo Log, v√† Undo Log ƒë·ªÉ th·ª±c hi·ªán giao d·ªãch. V√≠ d·ª• v·ªõi m·ªôt c√¢u l·ªánh update:</p><ol><li>Khi Innodb nh·∫≠n ƒë∆∞·ª£c m·ªôt c√¢u l·ªánh update, n√≥ s·∫Ω t√¨m trang d·ªØ li·ªáu theo ƒëi·ªÅu ki·ªán v√† l∆∞u trang ƒë√≥ v√†o Buffer Pool.</li><li>Th·ª±c hi·ªán c√¢u l·ªánh update, s·ª≠a ƒë·ªïi d·ªØ li·ªáu trong Buffer Pool, t·ª©c l√† d·ªØ li·ªáu trong b·ªô nh·ªõ.</li><li>T·∫°o m·ªôt ƒë·ªëi t∆∞·ª£ng RedoLog cho c√¢u l·ªánh update v√† l∆∞u v√†o LogBuffer.</li><li>T·∫°o m·ªôt b·∫£n ghi undolog cho c√¢u l·ªánh update, d√πng ƒë·ªÉ ho√†n t√°c giao d·ªãch.</li><li>N·∫øu giao d·ªãch ƒë∆∞·ª£c x√°c nh·∫≠n, ƒë·ªëi t∆∞·ª£ng RedoLog s·∫Ω ƒë∆∞·ª£c l∆∞u tr·ªØ vƒ©nh vi·ªÖn; sau ƒë√≥, c√≤n c√≥ c√°c c∆° ch·∫ø kh√°c ƒë·ªÉ l∆∞u c√°c trang d·ªØ li·ªáu ƒë√£ ch·ªânh s·ª≠a trong Buffer Pool v√†o ƒëƒ©a.</li><li>N·∫øu giao d·ªãch b·ªã ho√†n t√°c, s·∫Ω s·ª≠ d·ª•ng b·∫£n ghi undolog ƒë·ªÉ quay l·∫°i.</li></ol><h5 id="-3" tabindex="-1"><a class="header-anchor" href="#-3"><span></span></a></h5><h2 id="su-khac-biet-giua-b-tree-va-b-tree-tai-sao-mysql-lai-su-dung-b-tree" tabindex="-1"><a class="header-anchor" href="#su-khac-biet-giua-b-tree-va-b-tree-tai-sao-mysql-lai-su-dung-b-tree"><span>S·ª± kh√°c bi·ªát gi·ªØa B-tree v√† B+ tree, t·∫°i sao MySQL l·∫°i s·ª≠ d·ª•ng B+ tree?</span></a></h2><p>ƒê·∫∑c ƒëi·ªÉm c·ªßa B-tree:</p><ol><li>C√°c n√∫t ƒë∆∞·ª£c s·∫Øp x·∫øp.</li><li>M·ªôt n√∫t c√≥ th·ªÉ ch·ª©a nhi·ªÅu ph·∫ßn t·ª≠, v√† c√°c ph·∫ßn t·ª≠ ƒë√≥ c≈©ng ƒë∆∞·ª£c s·∫Øp x·∫øp.</li></ol><p>ƒê·∫∑c ƒëi·ªÉm c·ªßa B+ tree:</p><ol><li>C√≥ c√°c ƒë·∫∑c ƒëi·ªÉm c·ªßa B-tree.</li><li>C√°c n√∫t l√° c√≥ li√™n k·∫øt v·ªõi nhau b·∫±ng con tr·ªè.</li><li>C√°c ph·∫ßn t·ª≠ tr√™n n√∫t kh√¥ng ph·∫£i l√† n√∫t ƒë·ªÅu ƒë∆∞·ª£c l∆∞u tr·ªØ tr√™n c√°c n√∫t l√°, t·ª©c l√† t·∫•t c·∫£ c√°c ph·∫ßn t·ª≠ ƒë·ªÅu ƒë∆∞·ª£c l∆∞u tr·ªØ trong c√°c n√∫t l√° v√† ƒë∆∞·ª£c s·∫Øp x·∫øp.</li></ol><p>MySQL s·ª≠ d·ª•ng B+ tree cho ch·ªâ m·ª•c, v√¨ ch·ªâ m·ª•c ƒë∆∞·ª£c d√πng ƒë·ªÉ tƒÉng t·ªëc ƒë·ªô truy v·∫•n, v√† B+ tree c√≥ th·ªÉ tƒÉng t·ªëc ƒë·ªô truy v·∫•n b·∫±ng c√°ch s·∫Øp x·∫øp d·ªØ li·ªáu. H∆°n n·ªØa, m·ªôt n√∫t c√≥ th·ªÉ ch·ª©a nhi·ªÅu ph·∫ßn t·ª≠, gi√∫p chi·ªÅu cao c·ªßa B+ tree kh√¥ng qu√° l·ªõn. Trong MySQL, m·ªôt trang Innodb ch√≠nh l√† m·ªôt n√∫t B+ tree, v·ªõi k√≠ch th∆∞·ªõc m·∫∑c ƒë·ªãnh l√† 16KB. Do ƒë√≥, trong tr∆∞·ªùng h·ª£p th√¥ng th∆∞·ªùng, m·ªôt B+ tree c√≥ hai t·∫ßng c√≥ th·ªÉ ch·ª©a kho·∫£ng 20 tri·ªáu h√†ng d·ªØ li·ªáu. B·∫±ng c√°ch s·ª≠ d·ª•ng c√°c n√∫t l√° c·ªßa B+ tree ƒë·ªÉ l∆∞u tr·ªØ t·∫•t c·∫£ d·ªØ li·ªáu v√† s·∫Øp x·∫øp ch√∫ng, c≈©ng nh∆∞ c√≥ c√°c con tr·ªè gi·ªØa c√°c n√∫t l√°, c√≥ th·ªÉ h·ªó tr·ª£ t·ªët cho vi·ªác qu√©t to√†n b·ªô b·∫£ng v√† c√°c truy v·∫•n t√¨m ki·∫øm theo ph·∫°m vi.</p><h5 id="-4" tabindex="-1"><a class="header-anchor" href="#-4"><span></span></a></h5><h2 id="cac-loai-khoa-trong-mysql-va-cach-hieu" tabindex="-1"><a class="header-anchor" href="#cac-loai-khoa-trong-mysql-va-cach-hieu"><span>C√°c lo·∫°i kh√≥a trong MySQL v√† c√°ch hi·ªÉu</span></a></h2><p>Ph√¢n lo·∫°i theo ƒë·ªô chi ti·∫øt c·ªßa kh√≥a:</p><ol><li>Kh√≥a h√†ng: Kh√≥a m·ªôt h√†ng d·ªØ li·ªáu, c√≥ ƒë·ªô chi ti·∫øt nh·ªè nh·∫•t, cho ph√©p ƒë·ªìng th·ªùi cao.</li><li>Kh√≥a b·∫£ng: Kh√≥a to√†n b·ªô b·∫£ng, c√≥ ƒë·ªô chi ti·∫øt l·ªõn nh·∫•t, cho ph√©p ƒë·ªìng th·ªùi th·∫•p.</li><li>Kh√≥a kho·∫£ng: Kh√≥a m·ªôt kho·∫£ng d·ªØ li·ªáu.</li></ol><p>C√≥ th·ªÉ ph√¢n lo·∫°i th√™m:</p><ol><li>Kh√≥a chia s·∫ª: C√≤n g·ªçi l√† kh√≥a ƒë·ªçc, m·ªôt giao d·ªãch kh√≥a m·ªôt h√†ng d·ªØ li·ªáu cho ph√©p c√°c giao d·ªãch kh√°c c√≥ th·ªÉ ƒë·ªçc, nh∆∞ng kh√¥ng ƒë∆∞·ª£c ghi.</li><li>Kh√≥a ƒë·ªôc quy·ªÅn: C√≤n g·ªçi l√† kh√≥a ghi, m·ªôt giao d·ªãch kh√≥a m·ªôt h√†ng d·ªØ li·ªáu khi·∫øn c√°c giao d·ªãch kh√°c kh√¥ng th·ªÉ ƒë·ªçc hay ghi.</li></ol><p>C√≥ th·ªÉ ph√¢n lo·∫°i th√™m:</p><ol><li>Kh√≥a l·∫°c quan: Kh√¥ng th·ª±c s·ª± kh√≥a m·ªôt h√†ng ghi n√†o m√† th·ª±c hi·ªán qua m·ªôt s·ªë phi√™n b·∫£n.</li><li>Kh√≥a bi quan: C√°c kh√≥a h√†ng, kh√≥a b·∫£ng ƒë√£ ƒë·ªÅ c·∫≠p ·ªü tr√™n ƒë·ªÅu l√† kh√≥a bi quan.</li></ol><p>Trong vi·ªác th·ª±c hi·ªán c√°c m·ª©c ƒë·ªô c√°ch ly c·ªßa giao d·ªãch, c·∫ßn s·ª≠ d·ª•ng kh√≥a ƒë·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ ƒë·ªçc ma (phantom read).</p><h5 id="-5" tabindex="-1"><a class="header-anchor" href="#-5"><span></span></a></h5><h2 id="lam-the-nao-ƒëe-toi-uu-hoa-truy-van-cham-trong-mysql" tabindex="-1"><a class="header-anchor" href="#lam-the-nao-ƒëe-toi-uu-hoa-truy-van-cham-trong-mysql"><span>L√†m th·∫ø n√†o ƒë·ªÉ t·ªëi ∆∞u h√≥a truy v·∫•n ch·∫≠m trong MySQL?</span></a></h2><ol><li>Ki·ªÉm tra xem c√≥ s·ª≠ d·ª•ng ch·ªâ m·ª•c kh√¥ng; n·∫øu kh√¥ng, t·ªëi ∆∞u h√≥a SQL ƒë·ªÉ s·ª≠ d·ª•ng ch·ªâ m·ª•c.</li><li>Ki·ªÉm tra ch·ªâ m·ª•c ƒëang s·ª≠ d·ª•ng, xem c√≥ ph·∫£i l√† ch·ªâ m·ª•c t·ªëi ∆∞u kh√¥ng.</li><li>Ki·ªÉm tra xem c√°c tr∆∞·ªùng truy v·∫•n c√≥ ph·∫£i l√† c·∫ßn thi·∫øt kh√¥ng; c√≥ th·ªÉ ƒë√£ truy v·∫•n qu√° nhi·ªÅu tr∆∞·ªùng, d·∫´n ƒë·∫øn d·ªØ li·ªáu th·ª´a.</li><li>Ki·ªÉm tra xem d·ªØ li·ªáu trong b·∫£ng c√≥ qu√° nhi·ªÅu kh√¥ng; c√≥ th·ªÉ c·∫ßn ph√¢n t√°ch c∆° s·ªü d·ªØ li·ªáu v√† b·∫£ng.</li><li>Ki·ªÉm tra c·∫•u h√¨nh hi·ªáu su·∫•t c·ªßa m√°y ch·ªß n∆°i c√≥ c∆° s·ªü d·ªØ li·ªáu, xem c√≥ qu√° th·∫•p kh√¥ng; c√≥ th·ªÉ tƒÉng th√™m t√†i nguy√™n n·∫øu c·∫ßn.</li></ol><h2 id="trong-mysql-bang-lon-la-bang-co-kich-thuoc-bao-nhieu" tabindex="-1"><a class="header-anchor" href="#trong-mysql-bang-lon-la-bang-co-kich-thuoc-bao-nhieu"><span>Trong MySQL, b·∫£ng l·ªõn l√† b·∫£ng c√≥ k√≠ch th∆∞·ªõc bao nhi√™u?</span></a></h2><p>Ch√∫ng ta th∆∞·ªùng n√≥i r·∫±ng b·∫£ng qu√° l·ªõn, m·ªôt nghƒ©a kh√°c l√† d·ªØ li·ªáu qu√° nhi·ªÅu, d·∫´n ƒë·∫øn hi·ªáu qu·∫£ c·ªßa ch·ªâ m·ª•c kh√¥ng c√≤n r√µ r√†ng, ch·ªâ c√≥ th·ªÉ ph√¢n t√°ch b·∫£ng. V√¨ v·∫≠y, khi th·∫£o lu·∫≠n v·ªÅ b·∫£ng l·ªõn l√† g√¨, c·∫ßn ph√¢n t√≠ch t·ª´ g√≥c ƒë·ªô ch·ªâ m·ª•c MySQL ƒë·ªÉ x√°c ƒë·ªãnh khi n√†o d·ªØ li·ªáu tr·ªü th√†nh b·∫£ng l·ªõn.</p><figure><img src="https://cdn.nlark.com/yuque/0/2022/png/365147/1668599070561-7707946a-4402-48e1-8dad-63169f07d2b0.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>H√¨nh tr√™n l√† m·ªôt ch·ªâ m·ª•c kh√≥a ch√≠nh trong Innodb, t·ª©c l√† m·ªôt c√¢y B+. M·ªói n√∫t trong c√¢y l√† m·ªôt trang Innodb, k√≠ch th∆∞·ªõc m·∫∑c ƒë·ªãnh l√† 16KB, v√† m·ªói n√∫t l√° ch·ªß y·∫øu l∆∞u tr·ªØ d·ªØ li·ªáu, trong khi c√°c n√∫t kh√¥ng ph·∫£i l√° l∆∞u tr·ªØ kh√≥a ch√≠nh v√† ƒë·ªãa ch·ªâ trang.</p><p>V√¨ v·∫≠y, ch√∫ng ta c√≥ th·ªÉ t√≠nh to√°n xem n·∫øu chi·ªÅu cao c·ªßa c√¢y B+ l√† 2, n√≥ c√≥ th·ªÉ ch·ª©a bao nhi√™u b·∫£n ghi.</p><figure><img src="https://cdn.nlark.com/yuque/0/2022/png/365147/1668599322284-46fcb513-6e94-46d0-845e-3c69378854ad.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>Gi·∫£ s·ª≠ m·ªôt b·∫£n ghi l√† 1KB.</li><li>Ki·ªÉu kh√≥a ch√≠nh l√† ki·ªÉu int, t·ª©c l√† m·ªôt kh√≥a ch√≠nh chi·∫øm 4 byte.</li><li>Trong innodb, m·ªôt ƒë·ªãa ch·ªâ trang c·∫ßn chi·∫øm 6 byte.</li></ul><p>V√¨ v·∫≠y, trong m·ªôt trang, t·ª©c l√† trong m·ªôt n√∫t, c√≥ th·ªÉ ch·ª©a:</p><ol><li>16KB / 1KB = 16 b·∫£n ghi d·ªØ li·ªáu.</li><li>16KB / (4B + 6B) = 1638 b·∫£n ghi ch·ªâ m·ª•c (kh√≥a ch√≠nh + ƒë·ªãa ch·ªâ ch·ªâ m·ª•c).</li></ol><p>V√¨ v·∫≠y, n·∫øu chi·ªÅu cao c·ªßa c√¢y B+ l√† 2, th√¨ c√°c n√∫t l√° s·∫Ω c√≥ 1638 n√∫t, do ƒë√≥ s·ªë l∆∞·ª£ng b·∫£n ghi d·ªØ li·ªáu c√≥ th·ªÉ l∆∞u tr·ªØ l√†: 1638 * 16 = 26208 b·∫£n ghi.</p><p>N·∫øu chi·ªÅu cao c·ªßa c√¢y B+ l√† 3, th√¨ m·ªôt n√∫t ·ªü t·∫ßng ƒë·∫ßu ti√™n, 1638 n√∫t ·ªü t·∫ßng th·ª© hai, 1638 * 1638 n√∫t ·ªü t·∫ßng th·ª© ba, cu·ªëi c√πng s·ªë b·∫£n ghi s·∫Ω l√†: 1638 * 1638 * 16 = 42,928,704.</p><p>T·ª©c l√† kho·∫£ng 40 tri·ªáu b·∫£n ghi.</p><p>N·∫øu ki·ªÉu kh√≥a ch√≠nh l√† bigint, m·ªói kh√≥a ch√≠nh chi·∫øm 8 byte, v√¨ v·∫≠y khi chi·ªÅu cao l√† 3, c√≥ th·ªÉ l∆∞u:</p><ol><li>16KB / (8B + 6B) = 1170.</li><li>1170 * 1170 * 16 = 21,902,400.</li></ol><p>T·ª©c l√† h∆°n 20 tri·ªáu b·∫£n ghi.</p><p>V√¨ v·∫≠y, ch√∫ng ta c√≥ th·ªÉ s·ª≠ d·ª•ng ph∆∞∆°ng ph√°p n√†y ƒë·ªÉ x√°c ƒë·ªãnh xem s·ªë l∆∞·ª£ng d·ªØ li·ªáu trong m·ªôt b·∫£ng c√≥ qu√° nhi·ªÅu kh√¥ng (chi·ªÅu cao c·ªßa c√¢y B+ th∆∞·ªùng kh√¥ng n√™n v∆∞·ª£t qu√° ba t·∫ßng, v√¨ d·ªØ li·ªáu c·ªßa B+ tree ƒë·ªÅu ƒë∆∞·ª£c l∆∞u tr√™n ƒëƒ©a, c√¢y qu√° cao s·∫Ω l√†m tƒÉng s·ªë l·∫ßn IO, v√† hi·ªáu su·∫•t t·ªïng th·ªÉ s·∫Ω gi·∫£m). M·ªçi ng∆∞·ªùi c√≥ th·ªÉ s·ª≠ d·ª•ng ph∆∞∆°ng ph√°p m√† t√¥i gi·ªõi thi·ªáu ƒë·ªÉ t√≠nh s·ªë l∆∞·ª£ng b·∫£n ghi m√† m·ªôt b·∫£ng c√≥ th·ªÉ l∆∞u tr·ªØ khi chi·ªÅu cao c·ªßa B+ tree l√† 2 ho·∫∑c 3. N·∫øu t·ªïng s·ªë b·∫£n ghi th·ª±c t·∫ø trong b·∫£ng v∆∞·ª£t qu√° s·ªë l∆∞·ª£ng m√† 3 t·∫ßng c√≥ th·ªÉ ch·ª©a, th√¨ b·∫£ng ƒë√≥ ƒë∆∞·ª£c coi l√† b·∫£ng l·ªõn, l√∫c n√†y hi·ªáu su·∫•t c·ªßa ch·ªâ m·ª•c s·∫Ω kh√¥ng cao, v√† c·∫ßn ph·∫£i ph√¢n t√°ch b·∫£ng.</p><h2 id="su-khac-biet-giua-count-va-count-1" tabindex="-1"><a class="header-anchor" href="#su-khac-biet-giua-count-va-count-1"><span>S·ª± kh√°c bi·ªát gi·ªØa <code>count(*)</code> v√† <code>count(1)</code></span></a></h2><p>Trong c√¥ng vi·ªác, th∆∞·ªùng xuy√™n c·∫ßn th·ª±c hi·ªán th·ªëng k√™, ch·∫≥ng h·∫°n nh∆∞ khi ph√¢n trang, c·∫ßn bi·∫øt t·ªïng s·ªë d√≤ng d·ªØ li·ªáu trong b·∫£ng, l√∫c n√†y s·∫Ω s·ª≠ d·ª•ng <code>count()</code>. V·∫≠y th√¨ n√™n s·ª≠ d·ª•ng <code>count(*)</code>, <code>count(1)</code>, hay <code>count(c·ªôt n√†o ƒë√≥)</code>?</p><p>Tr√™n trang web ch√≠nh th·ª©c c·ªßa MySQL, th·ª±c t·∫ø ƒë√£ m√¥ t·∫£ <code>count(*)</code>, <a href="https://dev.mysql.com/doc/refman/5.6/en/aggregate-functions.html#function_count" target="_blank" rel="noopener noreferrer">nh·∫•p v√†o ƒë√¢y ƒë·ªÉ xem</a>.</p><p>Trong t√†i li·ªáu ch√≠nh th·ª©c, <code>count(expr)</code> ƒë∆∞·ª£c m√¥ t·∫£ nh∆∞ sau:</p><div class="language-java" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Returns</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> a count of the number of non</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">NULL</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> values of expr in the rows retrieved by a </span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">SELECT</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> statement</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> The</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> result is a </span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">BIGINT</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> value</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">If</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> there are no matching rows</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> COUNT</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">() returns </span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">0</span></span></code></pre></div><p>D·ªãch sang ti·∫øng Vi·ªát c√≥ nghƒ©a l√†: n√≥ tr·∫£ v·ªÅ s·ªë l∆∞·ª£ng gi√° tr·ªã kh√¥ng NULL c·ªßa bi·ªÉu th·ª©c <code>expr</code> trong c√°c d√≤ng ƒë∆∞·ª£c truy v·∫•n b·ªüi c√¢u l·ªánh SELECT. N·∫øu kh√¥ng c√≥ d√≤ng n√†o ph√π h·ª£p, <code>COUNT()</code> s·∫Ω tr·∫£ v·ªÅ 0.</p><p>V√≠ d·ª• v·ªõi SQL d∆∞·ªõi ƒë√¢y:</p><div class="language-java" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">select </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">count</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">*</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) from t1</span></span></code></pre></div><p>L√† ƒë·ªÉ th·ªëng k√™ t·ªïng s·ªë d√≤ng c·ªßa k·∫øt qu·∫£ t·ª´ c√¢u l·ªánh SQL:</p><div class="language-java" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">select </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">*</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> from t1</span></span></code></pre></div><p>Ngay sau ƒë√≥, t√†i li·ªáu c≈©ng m√¥ t·∫£ ri√™ng v·ªÅ <code>count(*)</code>:</p><div class="language-java" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">COUNT</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">*</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) is somewhat different in that it returns a count of the number of rows retrieved</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> whether or not they contain </span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">NULL</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> values</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span></span></code></pre></div><p>ƒêi·ªÅu n√†y c√≥ nghƒ©a l√† <code>count(*)</code> c√≥ m·ªôt ch√∫t kh√°c bi·ªát, v√¨ <code>count()</code> th√¥ng th∆∞·ªùng s·∫Ω kh√¥ng th·ªëng k√™ c√°c gi√° tr·ªã NULL, nh∆∞ng <code>count(*)</code> s·∫Ω th·ªëng k√™ c·∫£ gi√° tr·ªã NULL.</p><p>Ch·∫≥ng h·∫°n, b√¢y gi·ªù c√≥ m·ªôt b·∫£ng v·ªõi ch·ªâ m·ªôt c·ªôt v√† ba b·∫£n ghi, trong ƒë√≥ c√≥ hai gi√° tr·ªã <code>f</code> v√† m·ªôt gi√° tr·ªã NULL:</p><figure><img src="https://cdn.nlark.com/yuque/0/2022/png/365147/1671959484035-6355ab75-49c9-4197-92eb-48f7615c0aae.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>L√∫c n√†y, k·∫øt qu·∫£ c·ªßa <code>count(*)</code> s·∫Ω l√† 3, k·∫øt qu·∫£ c·ªßa <code>count(e)</code> s·∫Ω l√† 2, v√† k·∫øt qu·∫£ c·ªßa <code>count(1)</code> s·∫Ω l√† 3.</p><p>Trong MyISAM, s·∫Ω c√≥ m·ªôt v·ªã tr√≠ ri√™ng ƒë·ªÉ ghi l·∫°i s·ªë l∆∞·ª£ng d√≤ng trong b·∫£ng, v√¨ v·∫≠y khi th·ª±c hi·ªán <code>count(*)</code> trong MyISAM s·∫Ω nhanh h∆°n, t·∫•t nhi√™n ƒëi·ªÅu ki·ªán l√† c√¢u l·ªánh SQL kh√¥ng c√≥ ƒëi·ªÅu ki·ªán WHERE, v√¨ MyISAM ghi l·∫°i t·ªïng s·ªë d√≤ng trong b·∫£ng kh√¥ng c√≥ ƒëi·ªÅu ki·ªán.</p><p>Tuy nhi√™n, Innodb kh√¥ng c√≥ c∆° ch·∫ø n√†y, v√¨ Innodb h·ªó tr·ª£ giao d·ªãch v√† c√°c giao d·ªãch c√≥ c√°c c·∫•p ƒë·ªô c√°ch ly kh√°c nhau. ƒê·ªëi v·ªõi c√πng m·ªôt b·∫£ng, c√°c giao d·ªãch kh√°c nhau c√≥ th·ªÉ c√πng l√∫c thao t√°c tr√™n b·∫£ng n√†y, v√† m·ªói giao d·ªãch l√† ƒë·ªôc l·∫≠p. Giao d·ªãch A ch√®n m·ªôt d·ªØ li·ªáu, trong khi giao d·ªãch B c√≥ th·ªÉ kh√¥ng c·∫ßn bi·∫øt ƒë·∫øn ƒëi·ªÅu ƒë√≥, ƒëi·ªÅu n√†y khi·∫øn Innodb kh√¥ng th·ªÉ ghi l·∫°i t·ªïng s·ªë d√≤ng gi·ªëng nh∆∞ MyISAM.</p><p>V·∫≠y <code>count()</code> trong Innodb th·ª±c hi·ªán nh∆∞ th·∫ø n√†o? N√≥ s·∫Ω s·ª≠ d·ª•ng ch·ªâ m·ª•c.</p><p>V√≠ d·ª•, khi th·ª±c hi·ªán <code>count(*)</code>, n√≥ s·∫Ω ch·ªçn m·ªôt ch·ªâ m·ª•c n√†o ƒë√≥ trong b·∫£ng, v√¨ ch·ªâ m·ª•c B+ tree s·∫Ω ghi l·∫°i t·∫•t c·∫£ c√°c d√≤ng d·ªØ li·ªáu trong b·∫£ng (m·ªôt s·ªë tr∆∞·ªùng c·ªßa m·ªói d√≤ng), n√™n vi·ªác s·ª≠ d·ª•ng trang ch·ªâ m·ª•c c√≥ th·ªÉ th·ªëng k√™ t·ªïng s·ªë d√≤ng nhanh h∆°n.</p><p>V√≠ d·ª• b√¢y gi·ªù c√≥ m·ªôt b·∫£ng v·ªõi nƒÉm c·ªôt a, b, c, d, e, trong ƒë√≥ a l√† kh√≥a ch√≠nh, b, c, d l√† m·ªôt ch·ªâ m·ª•c k·∫øt h·ª£p. L√∫c n√†y n·∫øu th·ª±c hi·ªán:</p><div class="language-java" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">explain select </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">count</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">*</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) from t1</span></span></code></pre></div><p>S·∫Ω th·∫•y r·∫±ng c√¢u l·ªánh SQL n√†y s·∫Ω s·ª≠ d·ª•ng ch·ªâ m·ª•c k·∫øt h·ª£p bcd.</p><figure><img src="https://cdn.nlark.com/yuque/0/2022/png/365147/1671960159223-f31eea23-3b5a-49e0-ab1e-a44c4e7b966e.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>V√¨ ch·ªâ m·ª•c bcd c√≥ √≠t tr∆∞·ªùng h∆°n, d·∫´n ƒë·∫øn s·ªë l∆∞·ª£ng n√∫t l√° trong B+ tree √≠t h∆°n, nh∆∞ng kh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn s·ªë l∆∞·ª£ng d√≤ng d·ªØ li·ªáu (m·ªói d√≤ng ch·ªâ l∆∞u tr·ªØ tr∆∞·ªùng b, c, d, n√≥i ch√≠nh x√°c l√† c≈©ng l∆∞u a, nh∆∞ng tr∆∞·ªùng e ch·∫Øc ch·∫Øn kh√¥ng c√≥ l∆∞u).</p><p>ƒê√≥ l√† <code>count(*)</code>, t∆∞∆°ng t·ª± nh∆∞ s·∫Ω s·ª≠ d·ª•ng ch·ªâ m·ª•c ƒë·ªÉ th·ªëng k√™ t·ªïng s·ªë d√≤ng.</p><p>C√≤n <code>count(1)</code> v√† <code>count(*)</code> th√¨ gi·ªëng nhau, nh∆∞ t√†i li·ªáu ch√≠nh th·ª©c ƒë√£ m√¥ t·∫£:</p><div class="language-java" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">InnoDB</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> handles </span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">SELECT</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> COUNT</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">*</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) and </span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">SELECT</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> COUNT</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) operations in the same </span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">way</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> There</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> is no performance difference</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span></span></code></pre></div><p>N·∫øu l√† <code>count(c·ªôt n√†o ƒë√≥)</code>, th√¨ c≈©ng xem c·ªôt ƒë√≥ c√≥ ch·ªâ m·ª•c n√†o c√≥ s·∫µn kh√¥ng; n·∫øu c√≥ th√¨ s·ª≠ d·ª•ng ch·ªâ m·ª•c ƒë·ªÉ th·ªëng k√™, n·∫øu kh√¥ng th√¨ th·ª±c hi·ªán qu√©t to√†n b·ªô b·∫£ng ƒë·ªÉ th·ªëng k√™, t·∫•t nhi√™n s·∫Ω lo·∫°i b·ªè gi√° tr·ªã NULL.</p><p>Tr√™n ƒë√¢y l√† qu√° tr√¨nh ph√¢n t√≠ch c·ªßa t√¥i k·∫øt h·ª£p v·ªõi t√†i li·ªáu ch√≠nh th·ª©c v√† th·ª±c nghi·ªám, t√≥m t·∫Øt nh∆∞ sau:</p><ol><li>Trong MyISAM, <code>count(*)</code> nhanh h∆°n v√¨ c√≥ th·ªÉ l·∫•y tr·ª±c ti·∫øp t·ªïng s·ªë d√≤ng do MyISAM gi√∫p th·ªëng k√™.</li><li>Trong Innodb, <code>count(*)</code> s·∫Ω ch·ªçn ch·ªâ m·ª•c v√† sau ƒë√≥ s·ª≠ d·ª•ng ch·ªâ m·ª•c ƒë·ªÉ th·ªëng k√™ t·ªïng s·ªë d√≤ng.</li><li><code>count(1)</code> v√† <code>count(*)</code> l√† gi·ªëng nhau, kh√¥ng ph√¢n bi·ªát gi·ªØa Innodb hay MyISAM.</li><li><code>count(c·ªôt n√†o ƒë√≥)</code> s·∫Ω ch·ªçn ch·ªâ m·ª•c c√≥ s·∫µn c·ªßa c·ªôt ƒë√≥ ƒë·ªÉ th·ªëng k√™, n·∫øu kh√¥ng c√≥ th√¨ th·ª±c hi·ªán qu√©t to√†n b·ªô b·∫£ng; b·∫•t k·ªÉ l√† <code>count(c·ªôt n√†o ƒë√≥)</code> ƒë·ªÅu s·∫Ω lo·∫°i b·ªè gi√° tr·ªã NULL, kh√¥ng ph√¢n bi·ªát c√≥ s·ª≠ d·ª•ng ch·ªâ m·ª•c hay kh√¥ng.</li></ol><h2 id="rdb-va-aof-la-gi" tabindex="-1"><a class="header-anchor" href="#rdb-va-aof-la-gi"><span>RDB v√† AOF l√† g√¨</span></a></h2><p><strong>RDB:</strong> Redis DataBase, l√† c√°ch l∆∞u tr·ªØ d·ªØ li·ªáu trong Redis b·∫±ng c√°ch ch·ª•p ·∫£nh (snapshot) c·ªßa t·∫≠p d·ªØ li·ªáu trong b·ªô nh·ªõ v√† ghi v√†o ƒëƒ©a trong c√°c kho·∫£ng th·ªùi gian x√°c ƒë·ªãnh. Qu√° tr√¨nh n√†y th·ª±c hi·ªán b·∫±ng c√°ch t·∫°o m·ªôt ti·∫øn tr√¨nh con (fork) ƒë·ªÉ ghi t·∫≠p d·ªØ li·ªáu v√†o t·ªáp t·∫°m th·ªùi, sau khi ghi th√†nh c√¥ng, n√≥ s·∫Ω thay th·∫ø t·ªáp tr∆∞·ªõc ƒë√≥ b·∫±ng t·ªáp ƒë√£ ƒë∆∞·ª£c n√©n nh·ªã ph√¢n.</p><p><strong>∆Øu ƒëi·ªÉm:</strong></p><ol><li>To√†n b·ªô c∆° s·ªü d·ªØ li·ªáu Redis ch·ªâ ch·ª©a m·ªôt t·ªáp <code>dump.rdb</code>, thu·∫≠n ti·ªán cho vi·ªác l∆∞u tr·ªØ l√¢u d√†i.</li><li>Kh·∫£ nƒÉng ph·ª•c h·ªìi t·ªët, d·ªÖ d√†ng sao l∆∞u.</li><li>T·ªëi ƒëa h√≥a hi·ªáu su·∫•t, ti·∫øn tr√¨nh con ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ th·ª±c hi·ªán c√°c thao t√°c ghi, cho ph√©p ti·∫øn tr√¨nh ch√≠nh ti·∫øp t·ª•c x·ª≠ l√Ω l·ªánh, v√¨ v·∫≠y I/O ƒë∆∞·ª£c t·ªëi ƒëa h√≥a. S·ª≠ d·ª•ng ti·∫øn tr√¨nh con ri√™ng ƒë·ªÉ th·ª±c hi·ªán l∆∞u tr·ªØ l√¢u d√†i, ti·∫øn tr√¨nh ch√≠nh s·∫Ω kh√¥ng th·ª±c hi·ªán b·∫•t k·ª≥ thao t√°c I/O n√†o, ƒë·∫£m b·∫£o hi·ªáu su·∫•t cao cho Redis.</li><li>Khi t·∫≠p d·ªØ li·ªáu l·ªõn, hi·ªáu su·∫•t kh·ªüi ƒë·ªông cao h∆°n so v·ªõi AOF.</li></ol><p><strong>Nh∆∞·ª£c ƒëi·ªÉm:</strong></p><ol><li>An to√†n d·ªØ li·ªáu th·∫•p. RDB th·ª±c hi·ªán vi·ªác l∆∞u tr·ªØ theo kho·∫£ng th·ªùi gian, n·∫øu c√≥ s·ª± c·ªë x·∫£y ra trong kho·∫£ng th·ªùi gian gi·ªØa hai l·∫ßn l∆∞u tr·ªØ, d·ªØ li·ªáu c√≥ th·ªÉ b·ªã m·∫•t. Ph∆∞∆°ng ph√°p n√†y ph√π h·ª£p h∆°n v·ªõi nh·ªØng y√™u c·∫ßu d·ªØ li·ªáu kh√¥ng qu√° nghi√™m ng·∫∑t.</li><li>Do RDB s·ª≠ d·ª•ng ti·∫øn tr√¨nh con ƒë·ªÉ h·ªó tr·ª£ th·ª±c hi·ªán c√¥ng vi·ªác l∆∞u tr·ªØ d·ªØ li·ªáu, n√™n khi t·∫≠p d·ªØ li·ªáu l·ªõn, c√≥ th·ªÉ l√†m to√†n b·ªô m√°y ch·ªß ng·ª´ng ho·∫°t ƒë·ªông t·ª´ v√†i trƒÉm mili gi√¢y ƒë·∫øn m·ªôt gi√¢y.</li></ol><p><strong>AOF:</strong> Append Only File, ghi l·∫°i m·ªçi thao t√°c ghi v√† x√≥a m√† m√°y ch·ªß x·ª≠ l√Ω d∆∞·ªõi d·∫°ng nh·∫≠t k√Ω. C√°c thao t√°c truy v·∫•n s·∫Ω kh√¥ng ƒë∆∞·ª£c ghi l·∫°i v√† ƒë∆∞·ª£c l∆∞u d∆∞·ªõi d·∫°ng vƒÉn b·∫£n, c√≥ th·ªÉ m·ªü t·ªáp ƒë·ªÉ xem chi ti·∫øt c√°c thao t√°c ƒë√£ th·ª±c hi·ªán.</p><p><strong>∆Øu ƒëi·ªÉm:</strong></p><ol><li>An to√†n d·ªØ li·ªáu, Redis cung c·∫•p ba ch√≠nh s√°ch ƒë·ªìng b·ªô: ƒë·ªìng b·ªô m·ªói gi√¢y, ƒë·ªìng b·ªô m·ªói l·∫ßn thay ƒë·ªïi v√† kh√¥ng ƒë·ªìng b·ªô. Th·ª±c t·∫ø, ƒë·ªìng b·ªô m·ªói gi√¢y c≈©ng ƒë∆∞·ª£c th·ª±c hi·ªán kh√¥ng ƒë·ªìng b·ªô, v·ªõi hi·ªáu su·∫•t cao. S·ª± kh√°c bi·ªát l√† n·∫øu h·ªá th·ªëng g·∫∑p s·ª± c·ªë, d·ªØ li·ªáu ƒë√£ thay ƒë·ªïi trong gi√¢y ƒë√≥ s·∫Ω b·ªã m·∫•t. Trong khi ƒë·ªìng b·ªô m·ªói l·∫ßn thay ƒë·ªïi, ch√∫ng ta c√≥ th·ªÉ coi nh∆∞ l∆∞u tr·ªØ ƒë·ªìng b·ªô, t·ª©c l√† m·ªói thay ƒë·ªïi d·ªØ li·ªáu s·∫Ω ngay l·∫≠p t·ª©c ƒë∆∞·ª£c ghi v√†o ƒëƒ©a.</li><li>Th√¥ng qua ch·∫ø ƒë·ªô ghi append, ngay c·∫£ khi m√°y ch·ªß g·∫∑p s·ª± c·ªë gi·ªØa ch·ª´ng, n·ªôi dung ƒë√£ t·ªìn t·∫°i s·∫Ω kh√¥ng b·ªã h·ªèng, c√≥ th·ªÉ s·ª≠ d·ª•ng c√¥ng c·ª• <code>redis-check-aof</code> ƒë·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ nh·∫•t qu√°n d·ªØ li·ªáu.</li><li>Ch·∫ø ƒë·ªô ghi l·∫°i (rewrite) c·ªßa c∆° ch·∫ø AOF. Th·ª±c hi·ªán ghi l·∫°i ƒë·ªãnh k·ª≥ t·ªáp AOF ƒë·ªÉ ƒë·∫°t ƒë∆∞·ª£c m·ª•c ƒë√≠ch n√©n.</li></ol><p><strong>Nh∆∞·ª£c ƒëi·ªÉm:</strong></p><ol><li>T·ªáp AOF l·ªõn h∆°n t·ªáp RDB v√† t·ªëc ƒë·ªô ph·ª•c h·ªìi ch·∫≠m h∆°n.</li><li>Khi t·∫≠p d·ªØ li·ªáu l·ªõn, hi·ªáu su·∫•t kh·ªüi ƒë·ªông th·∫•p h∆°n RDB.</li><li>Hi·ªáu su·∫•t ch·∫°y kh√¥ng cao b·∫±ng RDB.</li></ol><p>T·ªáp AOF c√≥ t·∫ßn su·∫•t c·∫≠p nh·∫≠t cao h∆°n t·ªáp RDB, ∆∞u ti√™n s·ª≠ d·ª•ng AOF ƒë·ªÉ kh√¥i ph·ª•c d·ªØ li·ªáu. AOF an to√†n h∆°n v√† l·ªõn h∆°n, trong khi RDB c√≥ hi·ªáu su·∫•t t·ªët h∆°n AOF. N·∫øu c·∫£ hai ƒë·ªÅu ƒë∆∞·ª£c c·∫•u h√¨nh, ∆∞u ti√™n t·∫£i AOF tr∆∞·ªõc.</p><h2 id="chien-luoc-xoa-khoa-het-han-trong-redis" tabindex="-1"><a class="header-anchor" href="#chien-luoc-xoa-khoa-het-han-trong-redis"><span>Chi·∫øn l∆∞·ª£c x√≥a kh√≥a h·∫øt h·∫°n trong Redis</span></a></h2><p>Redis l√† c∆° s·ªü d·ªØ li·ªáu key-value, cho ph√©p ch√∫ng ta thi·∫øt l·∫≠p th·ªùi gian h·∫øt h·∫°n cho c√°c kh√≥a l∆∞u tr·ªØ trong Redis. Chi·∫øn l∆∞·ª£c h·∫øt h·∫°n c·ªßa Redis ch·ªâ ra c√°ch Redis x·ª≠ l√Ω khi m·ªôt kh√≥a h·∫øt h·∫°n.</p><ul><li><strong>H·∫øt h·∫°n l∆∞·ªùi bi·∫øng (Lazy Expiration):</strong> Ch·ªâ ki·ªÉm tra kh√≥a ƒë√£ h·∫øt h·∫°n khi c√≥ truy c·∫≠p ƒë·∫øn kh√≥a ƒë√≥; n·∫øu h·∫øt h·∫°n th√¨ s·∫Ω x√≥a. Chi·∫øn l∆∞·ª£c n√†y ti·∫øt ki·ªám t·ªëi ƒëa t√†i nguy√™n CPU nh∆∞ng kh√¥ng th√¢n thi·ªán v·ªõi b·ªô nh·ªõ. Trong t√¨nh hu·ªëng c·ª±c ƒëoan, c√≥ th·ªÉ c√≥ nhi·ªÅu kh√≥a h·∫øt h·∫°n kh√¥ng ƒë∆∞·ª£c truy c·∫≠p l·∫°i, d·∫´n ƒë·∫øn vi·ªác kh√¥ng b·ªã x√≥a v√† chi·∫øm d·ª•ng m·ªôt l∆∞·ª£ng l·ªõn b·ªô nh·ªõ.</li><li><strong>H·∫øt h·∫°n ƒë·ªãnh k·ª≥ (Periodic Expiration):</strong> M·ªói kho·∫£ng th·ªùi gian nh·∫•t ƒë·ªãnh, s·∫Ω qu√©t m·ªôt s·ªë l∆∞·ª£ng kh√≥a nh·∫•t ƒë·ªãnh trong t·ª´ ƒëi·ªÉn <code>expires</code> c·ªßa c∆° s·ªü d·ªØ li·ªáu v√† x√≥a c√°c kh√≥a ƒë√£ h·∫øt h·∫°n. Chi·∫øn l∆∞·ª£c n√†y l√† m·ªôt ph∆∞∆°ng √°n th·ªèa hi·ªáp. B·∫±ng c√°ch ƒëi·ªÅu ch·ªânh kho·∫£ng th·ªùi gian qu√©t ƒë·ªãnh k·ª≥ v√† th·ªùi gian qu√©t m·ªói l·∫ßn, c√≥ th·ªÉ t·ªëi ∆∞u h√≥a t√†i nguy√™n CPU v√† b·ªô nh·ªõ trong c√°c t√¨nh hu·ªëng kh√°c nhau.</li></ul><p>(T·ª´ ƒëi·ªÉn <code>expires</code> s·∫Ω l∆∞u tr·ªØ t·∫•t c·∫£ c√°c d·ªØ li·ªáu th·ªùi gian h·∫øt h·∫°n c·ªßa kh√≥a ƒë√£ ƒë∆∞·ª£c thi·∫øt l·∫≠p th·ªùi gian h·∫øt h·∫°n. Trong ƒë√≥, kh√≥a l√† con tr·ªè ƒë·∫øn m·ªôt kh√≥a trong kh√¥ng gian kh√≥a, gi√° tr·ªã l√† th·ªùi gian h·∫øt h·∫°n ƒë∆∞·ª£c bi·ªÉu di·ªÖn b·∫±ng d·∫•u th·ªùi gian UNIX v·ªõi ƒë·ªô ch√≠nh x√°c mili gi√¢y. Kh√¥ng gian kh√≥a l√† t·∫•t c·∫£ c√°c kh√≥a ƒë∆∞·ª£c l∆∞u tr·ªØ trong c·ª•m Redis.)</p><p>Redis s·ª≠ d·ª•ng ƒë·ªìng th·ªùi c·∫£ hai chi·∫øn l∆∞·ª£c h·∫øt h·∫°n l∆∞·ªùi bi·∫øng v√† h·∫øt h·∫°n ƒë·ªãnh k·ª≥.</p><h2 id="tom-tat-viec-thuc-hien-giao-dich-trong-redis" tabindex="-1"><a class="header-anchor" href="#tom-tat-viec-thuc-hien-giao-dich-trong-redis"><span>T√≥m t·∫Øt vi·ªác th·ª±c hi·ªán giao d·ªãch trong Redis</span></a></h2><p><strong>1. B·∫Øt ƒë·∫ßu giao d·ªãch</strong></p><p>Th·ª±c hi·ªán l·ªánh <code>_MULTI_</code> ƒë√°nh d·∫•u b·∫Øt ƒë·∫ßu m·ªôt giao d·ªãch. L·ªánh <code>_MULTI_</code> s·∫Ω m·ªü c·ªù <code>REDIS_MULTI</code> trong thu·ªôc t√≠nh <code>flags</code> c·ªßa tr·∫°ng th√°i m√°y kh√°ch.</p><p><strong>2. L·ªánh ƒë∆∞·ª£c x·∫øp h√†ng</strong></p><p>Khi m·ªôt m√°y kh√°ch chuy·ªÉn sang tr·∫°ng th√°i giao d·ªãch, m√°y ch·ªß s·∫Ω th·ª±c hi·ªán c√°c thao t√°c kh√°c nhau d·ª±a tr√™n c√°c l·ªánh m√† m√°y kh√°ch g·ª≠i ƒë·∫øn. N·∫øu l·ªánh ƒë∆∞·ª£c g·ª≠i l√† m·ªôt trong c√°c l·ªánh <code>_MULTI_</code>, <code>_EXEC_</code>, <code>_WATCH_</code>, <code>_DISCARD_</code>, m√°y ch·ªß s·∫Ω th·ª±c hi·ªán ngay l·ªánh ƒë√≥, n·∫øu kh√¥ng th√¨ l·ªánh s·∫Ω ƒë∆∞·ª£c ƒë∆∞a v√†o m·ªôt h√†ng ƒë·ª£i giao d·ªãch, sau ƒë√≥ g·ª≠i ph·∫£n h·ªìi <code>QUEUED</code> cho m√°y kh√°ch.</p><ul><li>N·∫øu l·ªánh ƒë∆∞·ª£c m√°y kh√°ch g·ª≠i l√† m·ªôt trong b·ªën l·ªánh EXEC, DISCARD, WATCH, MULTI, m√°y ch·ªß s·∫Ω th·ª±c hi·ªán ngay l·ªánh ƒë√≥.</li><li>N·∫øu l·ªánh ƒë∆∞·ª£c m√°y kh√°ch g·ª≠i l√† c√°c l·ªánh kh√°c ngo√†i b·ªën l·ªánh tr√™n, m√°y ch·ªß s·∫Ω kh√¥ng th·ª±c hi·ªán ngay l·ªánh ƒë√≥. ƒê·∫ßu ti√™n, ki·ªÉm tra ƒë·ªãnh d·∫°ng c·ªßa l·ªánh c√≥ ƒë√∫ng kh√¥ng, n·∫øu kh√¥ng ƒë√∫ng, m√°y ch·ªß s·∫Ω t·∫Øt c·ªù <code>REDIS_MULTI</code> trong thu·ªôc t√≠nh tr·∫°ng th√°i c·ªßa m√°y kh√°ch (redisClient) v√† g·ª≠i th√¥ng tin l·ªói cho m√°y kh√°ch. N·∫øu ƒë√∫ng, l·ªánh s·∫Ω ƒë∆∞·ª£c ƒë∆∞a v√†o h√†ng ƒë·ª£i giao d·ªãch v√† g·ª≠i ph·∫£n h·ªìi <code>QUEUED</code> cho m√°y kh√°ch.</li></ul><p>H√†ng ƒë·ª£i giao d·ªãch s·∫Ω l∆∞u tr·ªØ c√°c l·ªánh theo c√°ch FIFO (first in, first out).</p><p><strong>3. Th·ª±c thi giao d·ªãch</strong></p><p>Khi m√°y kh√°ch g·ª≠i l·ªánh <code>EXEC</code>, m√°y ch·ªß s·∫Ω th·ª±c hi·ªán logic c·ªßa l·ªánh <code>EXEC</code>.</p><ul><li>N·∫øu thu·ªôc t√≠nh <code>flags</code> c·ªßa tr·∫°ng th√°i m√°y kh√°ch kh√¥ng ch·ª©a c·ªù <code>REDIS_MULTI</code>, ho·∫∑c ch·ª©a c√°c c·ªù <code>REDIS_DIRTY_CAS</code> ho·∫∑c <code>REDIS_DIRTY_EXEC</code>, th√¨ giao d·ªãch s·∫Ω b·ªã h·ªßy b·ªè.</li><li>N·∫øu kh√¥ng, m√°y kh√°ch ƒëang ·ªü tr·∫°ng th√°i giao d·ªãch (c√≥ c·ªù <code>REDIS_MULTI</code>), m√°y ch·ªß s·∫Ω duy·ªát qua h√†ng ƒë·ª£i giao d·ªãch c·ªßa m√°y kh√°ch v√† th·ª±c hi·ªán t·∫•t c·∫£ c√°c l·ªánh trong h√†ng ƒë·ª£i, cu·ªëi c√πng s·∫Ω tr·∫£ l·∫°i t·∫•t c·∫£ k·∫øt qu·∫£ cho m√°y kh√°ch.</li></ul><p>Redis kh√¥ng h·ªó tr·ª£ c∆° ch·∫ø rollback (ho√†n t√°c) giao d·ªãch, nh∆∞ng n√≥ s·∫Ω ki·ªÉm tra xem t·ª´ng l·ªánh trong giao d·ªãch c√≥ b·ªã l·ªói hay kh√¥ng.</p><p>Giao d·ªãch Redis kh√¥ng h·ªó tr·ª£ ki·ªÉm tra nh·ªØng l·ªói logic do l·∫≠p tr√¨nh vi√™n t·ª± g√¢y ra. V√≠ d·ª•, th·ª±c hi·ªán thao t√°c tr√™n ki·ªÉu d·ªØ li·ªáu HashMap ƒë·ªëi v·ªõi m·ªôt kh√≥a ki·ªÉu String!</p><ul><li>L·ªánh <code>WATCH</code> l√† m·ªôt kh√≥a l·∫°c quan, c√≥ th·ªÉ cung c·∫•p h√†nh vi ki·ªÉm tra v√† thi·∫øt l·∫≠p (check-and-set - CAS) cho giao d·ªãch Redis. N√≥ c√≥ th·ªÉ theo d√µi m·ªôt ho·∫∑c nhi·ªÅu kh√≥a, v√† m·ªôt khi b·∫•t k·ª≥ kh√≥a n√†o trong s·ªë ƒë√≥ b·ªã thay ƒë·ªïi (ho·∫∑c x√≥a), giao d·ªãch sau ƒë√≥ s·∫Ω kh√¥ng ƒë∆∞·ª£c th·ª±c hi·ªán, vi·ªác theo d√µi s·∫Ω ti·∫øp t·ª•c cho ƒë·∫øn khi l·ªánh <code>EXEC</code> ƒë∆∞·ª£c th·ª±c hi·ªán.</li><li>L·ªánh <code>MULTI</code> ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ b·∫Øt ƒë·∫ßu m·ªôt giao d·ªãch, n√≥ lu√¥n tr·∫£ v·ªÅ OK. Sau khi th·ª±c hi·ªán <code>MULTI</code>, m√°y kh√°ch c√≥ th·ªÉ ti·∫øp t·ª•c g·ª≠i b·∫•t k·ª≥ s·ªë l∆∞·ª£ng l·ªánh n√†o t·ªõi m√°y ch·ªß, nh·ªØng l·ªánh n√†y s·∫Ω kh√¥ng ƒë∆∞·ª£c th·ª±c hi·ªán ngay l·∫≠p t·ª©c m√† s·∫Ω ƒë∆∞·ª£c ƒë∆∞a v√†o m·ªôt h√†ng ƒë·ª£i, v√† khi l·ªánh <code>EXEC</code> ƒë∆∞·ª£c g·ªçi, t·∫•t c·∫£ c√°c l·ªánh trong h√†ng ƒë·ª£i m·ªõi ƒë∆∞·ª£c th·ª±c hi·ªán.</li><li>L·ªánh <code>EXEC</code>: th·ª±c hi·ªán t·∫•t c·∫£ c√°c l·ªánh trong kh·ªëi giao d·ªãch. Tr·∫£ v·ªÅ gi√° tr·ªã tr·∫£ v·ªÅ c·ªßa t·∫•t c·∫£ c√°c l·ªánh trong kh·ªëi giao d·ªãch, theo th·ª© t·ª± th·ª±c hi·ªán. Khi thao t√°c b·ªã gi√°n ƒëo·∫°n, tr·∫£ v·ªÅ gi√° tr·ªã r·ªóng <code>nil</code>.</li><li>B·∫±ng c√°ch g·ªçi l·ªánh <code>DISCARD</code>, m√°y kh√°ch c√≥ th·ªÉ l√†m tr·ªëng h√†ng ƒë·ª£i giao d·ªãch v√† t·ª´ b·ªè vi·ªác th·ª±c hi·ªán giao d·ªãch, ƒë·ªìng th·ªùi m√°y kh√°ch s·∫Ω tho√°t kh·ªèi tr·∫°ng th√°i giao d·ªãch.</li><li>L·ªánh <code>UNWATCH</code> c√≥ th·ªÉ h·ªßy b·ªè vi·ªác theo d√µi t·∫•t c·∫£ c√°c kh√≥a.</li></ul><h2 id="nguyen-ly-cot-loi-cua-sao-chep-master-slave-trong-redis" tabindex="-1"><a class="header-anchor" href="#nguyen-ly-cot-loi-cua-sao-chep-master-slave-trong-redis"><span>Nguy√™n l√Ω c·ªët l√µi c·ªßa sao ch√©p master-slave trong Redis</span></a></h2><p>B·∫±ng c√°ch th·ª±c hi·ªán l·ªánh <code>slaveof</code> ho·∫∑c thi·∫øt l·∫≠p t√πy ch·ªçn <code>slaveof</code>, cho ph√©p m·ªôt m√°y ch·ªß sao ch√©p d·ªØ li·ªáu t·ª´ m√°y ch·ªß kh√°c. C∆° s·ªü d·ªØ li·ªáu ch√≠nh c√≥ th·ªÉ th·ª±c hi·ªán c√°c thao t√°c ƒë·ªçc v√† ghi, khi c√°c thao t√°c ghi g√¢y ra s·ª± thay ƒë·ªïi d·ªØ li·ªáu, d·ªØ li·ªáu s·∫Ω t·ª± ƒë·ªông ƒë∆∞·ª£c ƒë·ªìng b·ªô ƒë·∫øn c∆° s·ªü d·ªØ li·ªáu t·ª´. C∆° s·ªü d·ªØ li·ªáu t·ª´ th∆∞·ªùng ch·ªâ l√† ƒë·ªçc, v√† nh·∫≠n d·ªØ li·ªáu ƒë·ªìng b·ªô t·ª´ c∆° s·ªü d·ªØ li·ªáu ch√≠nh. M·ªôt c∆° s·ªü d·ªØ li·ªáu ch√≠nh c√≥ th·ªÉ c√≥ nhi·ªÅu c∆° s·ªü d·ªØ li·ªáu t·ª´, trong khi m·ªôt c∆° s·ªü d·ªØ li·ªáu t·ª´ ch·ªâ c√≥ th·ªÉ c√≥ m·ªôt c∆° s·ªü d·ªØ li·ªáu ch√≠nh.</p><p><strong>Sao ch√©p to√†n b·ªô:</strong></p><ol><li>C∆° s·ªü d·ªØ li·ªáu ch√≠nh th√¥ng qua l·ªánh <code>bgsave</code> t·∫°o m·ªôt ti·∫øn tr√¨nh con ƒë·ªÉ th·ª±c hi·ªán l∆∞u tr·ªØ RDB, qu√° tr√¨nh n√†y r·∫•t ti√™u t·ªën CPU, b·ªô nh·ªõ (sao ch√©p b·∫£ng trang) v√† I/O ·ªï c·ª©ng.</li><li>C∆° s·ªü d·ªØ li·ªáu ch√≠nh s·∫Ω g·ª≠i t·ªáp RDB qua m·∫°ng cho c∆° s·ªü d·ªØ li·ªáu t·ª´, ƒëi·ªÅu n√†y s·∫Ω ti√™u t·ªën bƒÉng th√¥ng c·ªßa c·∫£ hai m√°y ch·ªß.</li><li>Qu√° tr√¨nh t·ª´ c∆° s·ªü d·ªØ li·ªáu t·ª´ l√†m s·∫°ch d·ªØ li·ªáu c≈© v√† t·∫£i t·ªáp RDB m·ªõi l√† qu√° tr√¨nh ch·∫∑n (blocking), kh√¥ng th·ªÉ ph·∫£n h·ªìi c√°c l·ªánh t·ª´ m√°y kh√°ch; n·∫øu c∆° s·ªü d·ªØ li·ªáu t·ª´ th·ª±c hi·ªán <code>bgrewriteaof</code>, ƒëi·ªÅu n√†y c≈©ng s·∫Ω d·∫´n ƒë·∫øn ti√™u t·ªën th√™m t√†i nguy√™n.</li></ol><p><strong>Sao ch√©p m·ªôt ph·∫ßn:</strong></p><ol><li><strong>Offset sao ch√©p:</strong> C·∫£ hai b√™n th·ª±c hi·ªán sao ch√©p, c∆° s·ªü d·ªØ li·ªáu ch√≠nh v√† t·ª´, s·∫Ω duy tr√¨ m·ªôt offset sao ch√©p ri√™ng.</li><li><strong>B·ªô ƒë·ªám sao ch√©p:</strong> C∆° s·ªü d·ªØ li·ªáu ch√≠nh n·ªôi b·ªô duy tr√¨ m·ªôt h√†ng ƒë·ª£i FIFO (first in, first out) c√≥ ƒë·ªô d√†i c·ªë ƒë·ªãnh l√†m b·ªô ƒë·ªám sao ch√©p. Khi ƒë·ªô ch√™nh l·ªách gi·ªØa offset c·ªßa m√°y ch·ªß ch√≠nh v√† t·ª´ v∆∞·ª£t qu√° ƒë·ªô d√†i c·ªßa b·ªô ƒë·ªám, vi·ªác th·ª±c hi·ªán sao ch√©p m·ªôt ph·∫ßn s·∫Ω kh√¥ng kh·∫£ thi v√† ch·ªâ c√≥ th·ªÉ th·ª±c hi·ªán sao ch√©p to√†n b·ªô.</li><li><strong>ID m√°y ch·ªß ch·∫°y (runid):</strong> M·ªói n√∫t Redis ƒë·ªÅu c√≥ ID ch·∫°y c·ªßa n√≥, ID n√†y ƒë∆∞·ª£c t·ª± ƒë·ªông t·∫°o ra khi n√∫t kh·ªüi ƒë·ªông. C∆° s·ªü d·ªØ li·ªáu ch√≠nh s·∫Ω g·ª≠i ID ch·∫°y c·ªßa m√¨nh ƒë·∫øn c∆° s·ªü d·ªØ li·ªáu t·ª´, c∆° s·ªü d·ªØ li·ªáu t·ª´ s·∫Ω l∆∞u gi·ªØ ID ch·∫°y c·ªßa c∆° s·ªü d·ªØ li·ªáu ch√≠nh. Khi c∆° s·ªü d·ªØ li·ªáu t·ª´ Redis k·∫øt n·ªëi l·∫°i, n√≥ s·∫Ω d·ª±a v√†o ID ch·∫°y ƒë·ªÉ x√°c ƒë·ªãnh ti·∫øn ƒë·ªô ƒë·ªìng b·ªô: <ul><li>N·∫øu <code>runid</code> ƒë∆∞·ª£c l∆∞u trong c∆° s·ªü d·ªØ li·ªáu t·ª´ gi·ªëng v·ªõi <code>runid</code> hi·ªán t·∫°i c·ªßa c∆° s·ªü d·ªØ li·ªáu ch√≠nh, ƒëi·ªÅu n√†y c√≥ nghƒ©a l√† c∆° s·ªü d·ªØ li·ªáu ch√≠nh v√† t·ª´ ƒë√£ ƒë·ªìng b·ªô tr∆∞·ªõc ƒë√≥, c∆° s·ªü d·ªØ li·ªáu ch√≠nh s·∫Ω ti·∫øp t·ª•c c·ªë g·∫Øng s·ª≠ d·ª•ng sao ch√©p m·ªôt ph·∫ßn (c√≥ th·ªÉ th·ª±c hi·ªán sao ch√©p m·ªôt ph·∫ßn hay kh√¥ng c√≤n ph·ª• thu·ªôc v√†o t√¨nh h√¨nh offset v√† b·ªô ƒë·ªám sao ch√©p);</li><li>N·∫øu <code>runid</code> ƒë∆∞·ª£c l∆∞u trong c∆° s·ªü d·ªØ li·ªáu t·ª´ kh√°c v·ªõi <code>runid</code> hi·ªán t·∫°i c·ªßa c∆° s·ªü d·ªØ li·ªáu ch√≠nh, ƒëi·ªÅu n√†y c√≥ nghƒ©a l√† c∆° s·ªü d·ªØ li·ªáu t·ª´ ƒë√£ ƒë·ªìng b·ªô v·ªõi n√∫t Redis tr∆∞·ªõc ƒë√≥ kh√¥ng ph·∫£i l√† c∆° s·ªü d·ªØ li·ªáu ch√≠nh hi·ªán t·∫°i, ch·ªâ c√≥ th·ªÉ th·ª±c hi·ªán sao ch√©p to√†n b·ªô.</li></ul></li></ol><h2 id="cac-cau-truc-du-lieu-trong-redis-la-gi-moi-cau-truc-co-nhung-truong-hop-ung-dung-ƒëien-hinh-nao" tabindex="-1"><a class="header-anchor" href="#cac-cau-truc-du-lieu-trong-redis-la-gi-moi-cau-truc-co-nhung-truong-hop-ung-dung-ƒëien-hinh-nao"><span>C√°c c·∫•u tr√∫c d·ªØ li·ªáu trong Redis l√† g√¨? M·ªói c·∫•u tr√∫c c√≥ nh·ªØng tr∆∞·ªùng h·ª£p ·ª©ng d·ª•ng ƒëi·ªÉn h√¨nh n√†o?</span></a></h2><p>C·∫•u tr√∫c d·ªØ li·ªáu c·ªßa Redis c√≥:</p><ol><li><strong>Chu·ªói (String):</strong> C√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ l√†m d·ªØ li·ªáu ƒë∆°n gi·∫£n nh·∫•t, c√≥ th·ªÉ l∆∞u tr·ªØ m·ªôt chu·ªói ƒë∆°n gi·∫£n ho·∫∑c m·ªôt chu·ªói ƒë·ªãnh d·∫°ng JSON, vi·ªác th·ª±c hi·ªán kh√≥a ph√¢n t√°n trong Redis s·ª≠ d·ª•ng c·∫•u tr√∫c d·ªØ li·ªáu n√†y, c≈©ng nh∆∞ c√≥ th·ªÉ th·ª±c hi·ªán c√°c b·ªô ƒë·∫øm, chia s·∫ª phi√™n (Session), ID ph√¢n t√°n.</li><li><strong>B·∫£ng bƒÉm (Hash):</strong> C√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ l∆∞u tr·ªØ m·ªôt s·ªë c·∫∑p key-value, th√≠ch h·ª£p h∆°n ƒë·ªÉ l∆∞u tr·ªØ c√°c ƒë·ªëi t∆∞·ª£ng.</li><li><strong>Danh s√°ch (List):</strong> Danh s√°ch trong Redis c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng nh∆∞ ngƒÉn x·∫øp (stack) ho·∫∑c h√†ng ƒë·ª£i (queue) nh·ªù v√†o c√°c l·ªánh k·∫øt h·ª£p, c√≥ th·ªÉ d√πng ƒë·ªÉ l∆∞u tr·ªØ d·ªØ li·ªáu d√≤ng tin nh·∫Øn t·ª´ c√°c ·ª©ng d·ª•ng nh∆∞ WeChat, Weibo.</li><li><strong>T·∫≠p h·ª£p (Set):</strong> T∆∞∆°ng t·ª± nh∆∞ danh s√°ch, c≈©ng c√≥ th·ªÉ l∆∞u tr·ªØ nhi·ªÅu ph·∫ßn t·ª≠ nh∆∞ng kh√¥ng ƒë∆∞·ª£c tr√πng l·∫∑p, c√≥ th·ªÉ th·ª±c hi·ªán c√°c ph√©p to√°n giao, h·ª£p v√† hi·ªáu c·ªßa t·∫≠p h·ª£p, t·ª´ ƒë√≥ c√≥ th·ªÉ th·ª±c hi·ªán c√°c ch·ª©c nƒÉng nh∆∞: ng∆∞·ªùi m√† t√¥i v√† ai ƒë√≥ c√πng theo d√µi, t∆∞∆°ng t√°c trong v√≤ng b·∫°n b√®.</li><li><strong>T·∫≠p h·ª£p c√≥ th·ª© t·ª± (Sorted Set):</strong> T·∫≠p h·ª£p kh√¥ng c√≥ th·ª© t·ª±, nh∆∞ng t·∫≠p h·ª£p c√≥ th·ª© t·ª± c√≥ th·ªÉ thi·∫øt l·∫≠p th·ª© t·ª±, c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ th·ª±c hi·ªán ch·ª©c nƒÉng b·∫£ng x·∫øp h·∫°ng.</li></ol><h2 id="cach-thuc-hoat-ƒëong-cua-khoa-phan-tan-trong-redis" tabindex="-1"><a class="header-anchor" href="#cach-thuc-hoat-ƒëong-cua-khoa-phan-tan-trong-redis"><span>C√°ch th·ª©c ho·∫°t ƒë·ªông c·ªßa kh√≥a ph√¢n t√°n trong Redis?</span></a></h2><ol><li>ƒê·∫ßu ti√™n, s·ª≠ d·ª•ng <code>setnx</code> ƒë·ªÉ ƒë·∫£m b·∫£o: n·∫øu kh√≥a kh√¥ng t·ªìn t·∫°i th√¨ m·ªõi c√≥ th·ªÉ nh·∫≠n ƒë∆∞·ª£c kh√≥a, n·∫øu kh√≥a t·ªìn t·∫°i, kh√¥ng th·ªÉ nh·∫≠n ƒë∆∞·ª£c kh√≥a.</li><li>Ti·∫øp theo, c·∫ßn s·ª≠ d·ª•ng Lua Script ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh nguy√™n t·ª≠ c·ªßa nhi·ªÅu thao t√°c Redis.</li><li>ƒê·ªìng th·ªùi c·∫ßn xem x√©t ƒë·∫øn vi·ªác kh√≥a h·∫øt h·∫°n, v√¨ v·∫≠y c·∫ßn c√≥ m·ªôt t√°c v·ª• watchdog ƒë·ªãnh k·ª≥ ƒë·ªÉ theo d√µi xem kh√≥a c√≥ c·∫ßn gia h·∫°n hay kh√¥ng.</li><li>ƒê·ªìng th·ªùi c≈©ng c·∫ßn xem x√©t t√¨nh hu·ªëng khi n√∫t Redis g·∫∑p s·ª± c·ªë, v√¨ v·∫≠y c·∫ßn s·ª≠ d·ª•ng ph∆∞∆°ng ph√°p Redlock ƒë·ªÉ ƒë·ªìng th·ªùi y√™u c·∫ßu kh√≥a t·ª´ N/2+1 n√∫t, ch·ªâ khi t·∫•t c·∫£ ƒë·ªÅu nh·∫≠n ƒë∆∞·ª£c kh√≥a th√¨ m·ªõi x√°c nh·∫≠n vi·ªác nh·∫≠n kh√≥a th√†nh c√¥ng. Nh∆∞ v·∫≠y, ngay c·∫£ khi m·ªôt trong c√°c n√∫t Redis g·∫∑p s·ª± c·ªë, kh√≥a c≈©ng kh√¥ng th·ªÉ ƒë∆∞·ª£c nh·∫≠n b·ªüi c√°c m√°y kh√°ch kh√°c.</li></ol><h2 id="nguyen-ly-cot-loi-cua-sao-chep-chinh-phu-trong-redis-master-slave-replication" tabindex="-1"><a class="header-anchor" href="#nguyen-ly-cot-loi-cua-sao-chep-chinh-phu-trong-redis-master-slave-replication"><span>Nguy√™n l√Ω c·ªët l√µi c·ªßa sao ch√©p ch√≠nh - ph·ª• trong Redis (master-slave replication)</span></a></h2><p>Sao ch√©p ch√≠nh - ph·ª• trong Redis l√† m·ªôt bi·ªán ph√°p hi·ªáu qu·∫£ ƒë·ªÉ tƒÉng t√≠nh ƒë√°ng tin c·∫≠y c·ªßa Redis. Quy tr√¨nh sao ch√©p ch√≠nh - ph·ª• nh∆∞ sau:</p><ol><li>Khi kh·ªüi ƒë·ªông c·ª•m, h·ªá th·ªëng s·∫Ω thi·∫øt l·∫≠p k·∫øt n·ªëi gi·ªØa c∆° s·ªü d·ªØ li·ªáu ch√≠nh v√† ph·ª• ƒë·ªÉ chu·∫©n b·ªã cho vi·ªác sao ch√©p to√†n b·ªô d·ªØ li·ªáu.</li><li>C∆° s·ªü d·ªØ li·ªáu ch√≠nh s·∫Ω ƒë·ªìng b·ªô t·∫•t c·∫£ d·ªØ li·ªáu sang c∆° s·ªü d·ªØ li·ªáu ph·ª•. Sau khi nh·∫≠n d·ªØ li·ªáu, c∆° s·ªü d·ªØ li·ªáu ph·ª• s·∫Ω t·∫£i d·ªØ li·ªáu l√™n b·ªô nh·ªõ ƒë·ªãa ph∆∞∆°ng, qu√° tr√¨nh n√†y ph·ª• thu·ªôc v√†o snapshot b·ªô nh·ªõ RDB.</li><li>Trong qu√° tr√¨nh ƒë·ªìng b·ªô d·ªØ li·ªáu t·ª´ c∆° s·ªü d·ªØ li·ªáu ch√≠nh sang c∆° s·ªü d·ªØ li·ªáu ph·ª•, c∆° s·ªü d·ªØ li·ªáu ch√≠nh s·∫Ω kh√¥ng b·ªã ch·∫∑n, v·∫´n c√≥ th·ªÉ x·ª≠ l√Ω c√°c y√™u c·∫ßu b√¨nh th∆∞·ªùng. Tuy nhi√™n, c√°c thao t√°c ghi trong nh·ªØng y√™u c·∫ßu n√†y s·∫Ω kh√¥ng ƒë∆∞·ª£c ghi l·∫°i v√†o file RDB m·ªõi t·∫°o. ƒê·ªÉ ƒë·∫£m b·∫£o t√≠nh nh·∫•t qu√°n c·ªßa d·ªØ li·ªáu gi·ªØa c∆° s·ªü d·ªØ li·ªáu ch√≠nh v√† ph·ª•, c∆° s·ªü d·ªØ li·ªáu ch√≠nh s·∫Ω s·ª≠ d·ª•ng m·ªôt <strong>replication buffer</strong> (b·ªô nh·ªõ ƒë·ªám sao ch√©p) trong b·ªô nh·ªõ ƒë·ªÉ ghi l·∫°i t·∫•t c·∫£ c√°c thao t√°c ghi x·∫£y ra trong qu√° tr√¨nh t·∫°o file RDB.</li><li>Cu·ªëi c√πng, sau khi ho√†n th√†nh vi·ªác g·ª≠i file RDB, c∆° s·ªü d·ªØ li·ªáu ch√≠nh s·∫Ω g·ª≠i c√°c l·ªánh ghi m·ªõi nh·∫≠n ƒë∆∞·ª£c trong qu√° tr√¨nh n√†y t·ª´ <strong>replication buffer</strong> sang c∆° s·ªü d·ªØ li·ªáu ph·ª• ƒë·ªÉ c∆° s·ªü d·ªØ li·ªáu ph·ª• th·ª±c hi·ªán c√°c l·ªánh n√†y, t·ª´ ƒë√≥ ƒë·∫°t ƒë∆∞·ª£c s·ª± ƒë·ªìng b·ªô.</li><li>Sau ƒë√≥, c·∫£ c∆° s·ªü d·ªØ li·ªáu ch√≠nh v√† ph·ª• ƒë·ªÅu c√≥ th·ªÉ x·ª≠ l√Ω c√°c thao t√°c ƒë·ªçc c·ªßa m√°y kh√°ch, nh∆∞ng ch·ªâ c√≥ c∆° s·ªü d·ªØ li·ªáu ch√≠nh m·ªõi x·ª≠ l√Ω ƒë∆∞·ª£c c√°c thao t√°c ghi. C∆° s·ªü d·ªØ li·ªáu ch√≠nh s·∫Ω g·ª≠i c√°c thao t√°c ghi t·ªõi c∆° s·ªü d·ªØ li·ªáu ph·ª• ƒë·ªÉ th·ª±c hi·ªán ƒë·ªìng b·ªô gia tƒÉng.</li></ol><h2 id="chien-luoc-redis-cluster" tabindex="-1"><a class="header-anchor" href="#chien-luoc-redis-cluster"><span>Chi·∫øn l∆∞·ª£c Redis cluster</span></a></h2><p>Redis cung c·∫•p ba chi·∫øn l∆∞·ª£c cluster:</p><ol><li><p><strong>Ch·∫ø ƒë·ªô ch√≠nh - ph·ª•</strong>: Ch·∫ø ƒë·ªô n√†y kh√° ƒë∆°n gi·∫£n, c∆° s·ªü d·ªØ li·ªáu ch√≠nh c√≥ th·ªÉ ƒë·ªçc v√† ghi, ƒë·ªìng th·ªùi ƒë·ªìng b·ªô d·ªØ li·ªáu v·ªõi c∆° s·ªü d·ªØ li·ªáu ph·ª•. Tuy nhi√™n, khi c∆° s·ªü d·ªØ li·ªáu ch√≠nh ho·∫∑c ph·ª• b·ªã h·ªèng, c·∫ßn ph·∫£i s·ª≠a ƒë·ªïi IP th·ªß c√¥ng v√† ch·∫ø ƒë·ªô n√†y kh√≥ m·ªü r·ªông. D·ªØ li·ªáu c·ªßa to√†n b·ªô c·ª•m b·ªã gi·ªõi h·∫°n b·ªüi dung l∆∞·ª£ng b·ªô nh·ªõ c·ªßa m·ªôt m√°y, do ƒë√≥ kh√¥ng th·ªÉ h·ªó tr·ª£ l∆∞·ª£ng d·ªØ li·ªáu qu√° l·ªõn.</p></li><li><p><strong>Ch·∫ø ƒë·ªô Sentinel</strong>: Tr√™n c∆° s·ªü ch√≠nh - ph·ª•, th√™m v√†o c√°c n√∫t Sentinel. Khi c∆° s·ªü d·ªØ li·ªáu ch√≠nh g·∫∑p s·ª± c·ªë, Sentinel s·∫Ω ph√°t hi·ªán v√† ch·ªçn m·ªôt c∆° s·ªü d·ªØ li·ªáu ph·ª• tr·ªü th√†nh c∆° s·ªü d·ªØ li·ªáu ch√≠nh m·ªõi. Sentinel c≈©ng c√≥ th·ªÉ t·∫°o th√†nh c·ª•m ƒë·ªÉ ƒë·∫£m b·∫£o khi m·ªôt Sentinel g·∫∑p s·ª± c·ªë, v·∫´n c√≤n c√°c Sentinel kh√°c ti·∫øp t·ª•c l√†m vi·ªác. Tuy nhi√™n, ch·∫ø ƒë·ªô n√†y v·∫´n kh√¥ng th·ªÉ gi·∫£i quy·∫øt t·ªët v·∫•n ƒë·ªÅ gi·ªõi h·∫°n dung l∆∞·ª£ng c·ªßa Redis.</p></li><li><p><strong>Ch·∫ø ƒë·ªô Cluster</strong>: ƒê√¢y l√† ch·∫ø ƒë·ªô ƒë∆∞·ª£c s·ª≠ d·ª•ng ph·ªï bi·∫øn nh·∫•t, h·ªó tr·ª£ nhi·ªÅu c∆° s·ªü d·ªØ li·ªáu ch√≠nh v√† ph·ª•. Ch·∫ø ƒë·ªô n√†y ph√¢n chia c√°c <strong>slot</strong> theo key ƒë·ªÉ ph√¢n t√°n c√°c key kh√°c nhau t·ªõi c√°c n√∫t ch√≠nh kh√°c nhau, gi√∫p c·ª•m h·ªó tr·ª£ dung l∆∞·ª£ng d·ªØ li·ªáu l·ªõn h∆°n. M·ªói n√∫t ch√≠nh c√≥ th·ªÉ c√≥ nhi·ªÅu n√∫t ph·ª•, v√† khi n√∫t ch√≠nh g·∫∑p s·ª± c·ªë, m·ªôt n√∫t ph·ª• s·∫Ω ƒë∆∞·ª£c b·∫ßu ch·ªçn l√†m n√∫t ch√≠nh m·ªõi.</p></li></ol><p>ƒê·ªëi v·ªõi ba ch·∫ø ƒë·ªô n√†y, n·∫øu l∆∞·ª£ng d·ªØ li·ªáu Redis c·∫ßn l∆∞u tr·ªØ kh√¥ng l·ªõn, c√≥ th·ªÉ ch·ªçn ch·∫ø ƒë·ªô Sentinel. N·∫øu d·ªØ li·ªáu l·ªõn v√† c·∫ßn m·ªü r·ªông li√™n t·ª•c, n√™n ch·ªçn ch·∫ø ƒë·ªô Cluster.</p><h2 id="cache-xuyen-thau-cache-ƒëam-thung-va-cache-sup-ƒëo-la-gi" tabindex="-1"><a class="header-anchor" href="#cache-xuyen-thau-cache-ƒëam-thung-va-cache-sup-ƒëo-la-gi"><span>Cache xuy√™n th·∫•u, cache ƒë√¢m th·ªßng, v√† cache s·ª•p ƒë·ªï l√† g√¨?</span></a></h2><p>Trong cache th∆∞·ªùng l∆∞u tr·ªØ c√°c d·ªØ li·ªáu &quot;n√≥ng&quot; nh·∫±m tr√°nh vi·ªác ph·∫£i truy c·∫≠p tr·ª±c ti·∫øp v√†o MySQL. C√°c v·∫•n ƒë·ªÅ c√≥ th·ªÉ x·∫£y ra l√†:</p><ol><li><p><strong>Cache s·ª•p ƒë·ªï</strong>: Khi m·ªôt l∆∞·ª£ng l·ªõn d·ªØ li·ªáu &quot;n√≥ng&quot; h·∫øt h·∫°n c√πng l√∫c, s·∫Ω d·∫´n ƒë·∫øn l∆∞·ª£ng l·ªõn c√°c y√™u c·∫ßu truy c·∫≠p tr·ª±c ti·∫øp v√†o MySQL. C√°ch gi·∫£i quy·∫øt l√† th√™m m·ªôt s·ªë gi√° tr·ªã ng·∫´u nhi√™n v√†o th·ªùi gian h·∫øt h·∫°n ho·∫∑c x√¢y d·ª±ng c·ª•m Redis c√≥ t√≠nh kh·∫£ d·ª•ng cao.</p></li><li><p><strong>Cache ƒë√¢m th·ªßng</strong>: Kh√°c v·ªõi cache s·ª•p ƒë·ªï l√† nhi·ªÅu d·ªØ li·ªáu c√πng h·∫øt h·∫°n, cache ƒë√¢m th·ªßng x·∫£y ra khi m·ªôt key &quot;n√≥ng&quot; ƒë·ªôt ng·ªôt h·∫øt h·∫°n, d·∫´n ƒë·∫øn l∆∞·ª£ng l·ªõn y√™u c·∫ßu truy c·∫≠p tr·ª±c ti·∫øp v√†o MySQL. Gi·∫£i ph√°p l√† kh√¥ng ƒë·∫∑t th·ªùi gian h·∫øt h·∫°n cho key &quot;n√≥ng&quot;.</p></li><li><p><strong>Cache xuy√™n th·∫•u</strong>: N·∫øu v√†o m·ªôt th·ªùi ƒëi·ªÉm n√†o ƒë√≥ c√≥ nhi·ªÅu key kh√¥ng t·ªìn t·∫°i trong Redis ƒë∆∞·ª£c truy v·∫•n (v√≠ d·ª• hacker c·ªë t√¨nh t·∫°o c√°c key ng·∫´u nhi√™n), s·∫Ω g√¢y √°p l·ª±c l√™n c∆° s·ªü d·ªØ li·ªáu. Gi·∫£i ph√°p l√† s·ª≠ d·ª•ng <strong>Bloom filter</strong> ƒë·ªÉ ch·∫∑n c√°c key kh√¥ng t·ªìn t·∫°i tr∆∞·ªõc khi truy c·∫≠p v√†o cache.</p></li></ol><h2 id="lam-the-nao-ƒëe-ƒëam-bao-du-lieu-nhat-quan-giua-redis-va-mysql" tabindex="-1"><a class="header-anchor" href="#lam-the-nao-ƒëe-ƒëam-bao-du-lieu-nhat-quan-giua-redis-va-mysql"><span>L√†m th·∫ø n√†o ƒë·ªÉ ƒë·∫£m b·∫£o d·ªØ li·ªáu nh·∫•t qu√°n gi·ªØa Redis v√† MySQL?</span></a></h2><ol><li><p>C·∫≠p nh·∫≠t MySQL tr∆∞·ªõc, sau ƒë√≥ c·∫≠p nh·∫≠t Redis. Tuy nhi√™n, n·∫øu c·∫≠p nh·∫≠t Redis th·∫•t b·∫°i, d·ªØ li·ªáu c√≥ th·ªÉ kh√¥ng ƒë·ªìng nh·∫•t.</p></li><li><p>X√≥a d·ªØ li·ªáu cache trong Redis tr∆∞·ªõc, sau ƒë√≥ c·∫≠p nh·∫≠t MySQL. Khi c√≥ truy v·∫•n ti·∫øp theo, d·ªØ li·ªáu m·ªõi s·∫Ω ƒë∆∞·ª£c th√™m l·∫°i v√†o cache. C√°ch n√†y gi·∫£i quy·∫øt ƒë∆∞·ª£c v·∫•n ƒë·ªÅ trong ph∆∞∆°ng ph√°p 1 nh∆∞ng c√≥ hi·ªáu su·∫•t th·∫•p trong m√¥i tr∆∞·ªùng c√≥ ƒë·ªô ƒë·ªìng th·ªùi cao, v√† v·∫´n c√≥ kh·∫£ nƒÉng x·∫£y ra kh√¥ng nh·∫•t qu√°n d·ªØ li·ªáu.</p></li><li><p><strong>Double delete with delay</strong>: X√≥a d·ªØ li·ªáu trong Redis tr∆∞·ªõc, sau ƒë√≥ c·∫≠p nh·∫≠t MySQL, v√† sau m·ªôt v√†i trƒÉm mili gi√¢y x√≥a l·∫°i d·ªØ li·ªáu trong Redis. ƒêi·ªÅu n√†y ƒë·∫£m b·∫£o r·∫±ng n·∫øu c√≥ thread kh√°c ƒë·ªçc d·ªØ li·ªáu c≈© t·ª´ MySQL v√† ƒë∆∞a v√†o Redis, d·ªØ li·ªáu s·∫Ω b·ªã x√≥a l·∫ßn n·ªØa, gi·ªØ ƒë∆∞·ª£c t√≠nh nh·∫•t qu√°n.</p></li></ol><h2 id="co-che-luu-tru-du-lieu-cua-redis" tabindex="-1"><a class="header-anchor" href="#co-che-luu-tru-du-lieu-cua-redis"><span>C∆° ch·∫ø l∆∞u tr·ªØ d·ªØ li·ªáu c·ªßa Redis</span></a></h2><h3 id="rdb" tabindex="-1"><a class="header-anchor" href="#rdb"><span>RDB:</span></a></h3><p>RDB (Redis DataBase) l∆∞u tr·ªØ ·∫£nh ch·ª•p nhanh c·ªßa b·ªô nh·ªõ t·∫°i m·ªôt th·ªùi ƒëi·ªÉm c·ª• th·ªÉ d∆∞·ªõi d·∫°ng nh·ªã ph√¢n v√†o ƒëƒ©a.</p><p><strong>K√≠ch ho·∫°t th·ªß c√¥ng:</strong></p><ul><li>L·ªánh <code>save</code>: khi·∫øn Redis b·ªã kh√≥a cho ƒë·∫øn khi ho√†n th√†nh vi·ªác l∆∞u tr·ªØ RDB, sau ƒë√≥ m·ªõi ph·∫£n h·ªìi c√°c l·ªánh t·ª´ c√°c client kh√°c. V√¨ v·∫≠y, n√™n s·ª≠ d·ª•ng c·∫©n th·∫≠n trong m√¥i tr∆∞·ªùng s·∫£n xu·∫•t.</li><li>L·ªánh <code>bgsave</code>: fork ra m·ªôt ti·∫øn tr√¨nh con ƒë·ªÉ th·ª±c hi·ªán l∆∞u tr·ªØ, ti·∫øn tr√¨nh ch√≠nh ch·ªâ b·ªã kh√≥a trong th·ªùi gian ng·∫Øn khi fork. Sau khi ti·∫øn tr√¨nh con ƒë∆∞·ª£c t·∫°o, ti·∫øn tr√¨nh ch√≠nh c√≥ th·ªÉ ti·∫øp t·ª•c ph·∫£n h·ªìi c√°c y√™u c·∫ßu t·ª´ client.</li></ul><p><strong>K√≠ch ho·∫°t t·ª± ƒë·ªông:</strong></p><ul><li><code>save m n</code>: trong m gi√¢y, n·∫øu c√≥ n kh√≥a thay ƒë·ªïi, vi·ªác l∆∞u tr·ªØ s·∫Ω ƒë∆∞·ª£c k√≠ch ho·∫°t t·ª± ƒë·ªông th√¥ng qua <code>bgsave</code>. N·∫øu c√≥ nhi·ªÅu ƒëi·ªÅu ki·ªán, ch·ªâ c·∫ßn m·ªôt ƒëi·ªÅu ki·ªán th·ªèa m√£n th√¨ s·∫Ω k√≠ch ho·∫°t. C√≥ th·ªÉ c·∫•u h√¨nh trong file c·∫•u h√¨nh (c√≥ th·ªÉ v√¥ hi·ªáu h√≥a).</li><li><code>flushall</code>: d√πng ƒë·ªÉ x√≥a to√†n b·ªô d·ªØ li·ªáu trong Redis, <code>flushdb</code> ch·ªâ x√≥a d·ªØ li·ªáu trong database hi·ªán t·∫°i c·ªßa Redis (m·∫∑c ƒë·ªãnh l√† database s·ªë 0). Vi·ªác n√†y s·∫Ω x√≥a file RDB v√† t·∫°o ra file <code>dump.rdb</code> r·ªóng.</li><li>ƒê·ªìng b·ªô h√≥a master-slave: khi ƒë·ªìng b·ªô to√†n b·ªô, l·ªánh <code>bgsave</code> s·∫Ω ƒë∆∞·ª£c k√≠ch ho·∫°t t·ª± ƒë·ªông ƒë·ªÉ t·∫°o file RDB v√† g·ª≠i ƒë·∫øn node slave.</li></ul><p><strong>∆Øu ƒëi·ªÉm:</strong></p><ol><li>Redis ch·ªâ ch·ª©a m·ªôt file <code>dump.rdb</code>, thu·∫≠n ti·ªán cho vi·ªác l∆∞u tr·ªØ.</li><li>Kh·∫£ nƒÉng ch·ªãu l·ªói t·ªët, d·ªÖ d√†ng sao l∆∞u.</li><li>Hi·ªáu su·∫•t t·ªëi ƒëa: fork ti·∫øn tr√¨nh con ƒë·ªÉ ghi d·ªØ li·ªáu, ti·∫øn tr√¨nh ch√≠nh ti·∫øp t·ª•c x·ª≠ l√Ω l·ªánh, t·ªëi ∆∞u IO.</li><li>Khi dataset l·ªõn, RDB kh·ªüi ƒë·ªông nhanh h∆°n AOF.</li></ol><p><strong>Nh∆∞·ª£c ƒëi·ªÉm:</strong></p><ol><li>ƒê·ªô an to√†n d·ªØ li·ªáu th·∫•p. RDB ch·ªâ l∆∞u tr·ªØ theo kho·∫£ng th·ªùi gian, n√™n n·∫øu Redis g·∫∑p s·ª± c·ªë gi·ªØa c√°c l·∫ßn l∆∞u tr·ªØ, d·ªØ li·ªáu c√≥ th·ªÉ b·ªã m·∫•t.</li><li>Khi dataset l·ªõn, qu√° tr√¨nh fork c√≥ th·ªÉ khi·∫øn server b·ªã d·ª´ng trong v√†i trƒÉm mili gi√¢y, th·∫≠m ch√≠ 1 gi√¢y, ti√™u t·ªën CPU.</li></ol><h3 id="aof" tabindex="-1"><a class="header-anchor" href="#aof"><span>AOF:</span></a></h3><p>AOF (Append Only File) l∆∞u tr·ªØ c√°c l·ªánh ghi v√† x√≥a theo d·∫°ng nh·∫≠t k√Ω, c√°c l·ªánh truy v·∫•n kh√¥ng ƒë∆∞·ª£c l∆∞u. D·ªØ li·ªáu ƒë∆∞·ª£c ghi d∆∞·ªõi d·∫°ng vƒÉn b·∫£n, c√≥ th·ªÉ m·ªü file ƒë·ªÉ xem chi ti·∫øt c√°c l·ªánh.</p><ol><li>M·ªçi l·ªánh ghi s·∫Ω ƒë∆∞·ª£c th√™m v√†o b·ªô ƒë·ªám AOF.</li><li>B·ªô ƒë·ªám AOF s·∫Ω ƒë∆∞·ª£c ƒë·ªìng b·ªô v·ªõi ƒëƒ©a theo chi·∫øn l∆∞·ª£c ƒë∆∞·ª£c c·∫•u h√¨nh.</li><li>Khi file AOF ng√†y c√†ng l·ªõn, c·∫ßn ƒë·ªãnh k·ª≥ th·ª±c hi·ªán vi·∫øt l·∫°i AOF ƒë·ªÉ gi·∫£m dung l∆∞·ª£ng.</li><li>Khi Redis kh·ªüi ƒë·ªông, c√≥ th·ªÉ t·∫£i file AOF ƒë·ªÉ kh√¥i ph·ª•c d·ªØ li·ªáu.</li></ol><p><strong>Chi·∫øn l∆∞·ª£c ƒë·ªìng b·ªô:</strong></p><ul><li>ƒê·ªìng b·ªô m·ªói gi√¢y: th·ª±c hi·ªán kh√¥ng ƒë·ªìng b·ªô, hi·ªáu su·∫•t cao, nh∆∞ng n·∫øu h·ªá th·ªëng g·∫∑p s·ª± c·ªë, d·ªØ li·ªáu thay ƒë·ªïi trong m·ªôt gi√¢y c√≥ th·ªÉ b·ªã m·∫•t.</li><li>ƒê·ªìng b·ªô m·ªói l·∫ßn thay ƒë·ªïi: l∆∞u tr·ªØ ƒë·ªìng b·ªô, m·ªói khi c√≥ thay ƒë·ªïi d·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c ghi ngay v√†o ƒëƒ©a, t·ªëi ƒëa ch·ªâ m·∫•t m·ªôt l·ªánh.</li><li>Kh√¥ng ƒë·ªìng b·ªô: do h·ªá ƒëi·ªÅu h√†nh ki·ªÉm so√°t, c√≥ th·ªÉ m·∫•t nhi·ªÅu d·ªØ li·ªáu h∆°n.</li></ul><p><strong>∆Øu ƒëi·ªÉm:</strong></p><ol><li>An to√†n d·ªØ li·ªáu.</li><li>Ch·∫ø ƒë·ªô ghi <code>append</code> ƒë·∫£m b·∫£o d·ªØ li·ªáu kh√¥ng b·ªã h·ªèng n·∫øu server g·∫∑p s·ª± c·ªë.</li><li>C∆° ch·∫ø rewrite gi√∫p n√©n file AOF ƒë·ªÉ ti·∫øt ki·ªám dung l∆∞·ª£ng.</li></ol><p><strong>Nh∆∞·ª£c ƒëi·ªÉm:</strong></p><ol><li>File AOF l·ªõn h∆°n file RDB v√† t·ªëc ƒë·ªô kh√¥i ph·ª•c ch·∫≠m h∆°n.</li><li>Khi dataset l·ªõn, AOF kh·ªüi ƒë·ªông ch·∫≠m h∆°n RDB.</li><li>Hi·ªáu su·∫•t ch·∫°y kh√¥ng b·∫±ng RDB.</li></ol><h3 id="so-sanh" tabindex="-1"><a class="header-anchor" href="#so-sanh"><span>So s√°nh:</span></a></h3><ul><li>AOF c·∫≠p nh·∫≠t th∆∞·ªùng xuy√™n h∆°n RDB, ∆∞u ti√™n s·ª≠ d·ª•ng AOF ƒë·ªÉ kh√¥i ph·ª•c d·ªØ li·ªáu. AOF an to√†n h∆°n nh∆∞ng dung l∆∞·ª£ng l·ªõn h∆°n.</li><li>RDB c√≥ hi·ªáu su·∫•t t·ªët h∆°n AOF.</li><li>N·∫øu c·∫£ hai ƒë∆∞·ª£c c·∫•u h√¨nh, Redis s·∫Ω ∆∞u ti√™n t·∫£i AOF tr∆∞·ªõc.</li></ul><h2 id="redis-ƒëon-luong-tai-sao-lai-nhanh" tabindex="-1"><a class="header-anchor" href="#redis-ƒëon-luong-tai-sao-lai-nhanh"><span>Redis ƒë∆°n lu·ªìng t·∫°i sao l·∫°i nhanh</span></a></h2><p>Redis d·ª±a tr√™n m√¥ h√¨nh <strong>Reactor</strong>, ph√°t tri·ªÉn b·ªô x·ª≠ l√Ω s·ª± ki·ªán m·∫°ng v√† b·ªô x·ª≠ l√Ω s·ª± ki·ªán t·ªáp (<strong>file event handler</strong>). Redis l√† ƒë∆°n lu·ªìng, do ƒë√≥ ƒë∆∞·ª£c g·ªçi l√† m√¥ h√¨nh ƒë∆°n lu·ªìng. N√≥ s·ª≠ d·ª•ng c∆° ch·∫ø <strong>IO ƒëa k√™nh</strong> (IO multiplexing) ƒë·ªÉ l·∫Øng nghe nhi·ªÅu <strong>Socket</strong> c√πng l√∫c. D·ª±a tr√™n lo·∫°i s·ª± ki·ªán x·∫£y ra tr√™n <strong>Socket</strong>, Redis ch·ªçn b·ªô x·ª≠ l√Ω s·ª± ki·ªán t∆∞∆°ng ·ª©ng ƒë·ªÉ x·ª≠ l√Ω. ƒêi·ªÅu n√†y cho ph√©p th·ª±c hi·ªán m·ªôt m√¥ h√¨nh giao ti·∫øp m·∫°ng hi·ªáu su·∫•t cao, ƒë·ªìng th·ªùi duy tr√¨ t√≠nh ƒë∆°n gi·∫£n c·ªßa m√¥ h√¨nh lu·ªìng n·ªôi b·ªô.</p><p>C·∫•u tr√∫c c·ªßa b·ªô x·ª≠ l√Ω s·ª± ki·ªán t·ªáp g·ªìm 4 ph·∫ßn: nhi·ªÅu <strong>Socket</strong>, ch∆∞∆°ng tr√¨nh <strong>IO ƒëa k√™nh</strong>, b·ªô ƒëi·ªÅu ph·ªëi s·ª± ki·ªán t·ªáp v√† c√°c b·ªô x·ª≠ l√Ω s·ª± ki·ªán (nh∆∞ b·ªô x·ª≠ l√Ω y√™u c·∫ßu l·ªánh, b·ªô x·ª≠ l√Ω ph·∫£n h·ªìi l·ªánh, b·ªô x·ª≠ l√Ω k·∫øt n·ªëi...).</p><p>Nhi·ªÅu <strong>Socket</strong> c√≥ th·ªÉ t·∫°o ra c√°c s·ª± ki·ªán ƒë·ªìng th·ªùi, ch∆∞∆°ng tr√¨nh <strong>IO ƒëa k√™nh</strong> s·∫Ω l·∫Øng nghe c√°c <strong>Socket</strong>, ƒë∆∞a <strong>Socket</strong> v√†o h√†ng ƒë·ª£i. M·ªói l·∫ßn, ch∆∞∆°ng tr√¨nh s·∫Ω l·∫•y ra m·ªôt <strong>Socket</strong> theo th·ª© t·ª± t·ª´ h√†ng ƒë·ª£i v√† giao cho b·ªô ƒëi·ªÅu ph·ªëi s·ª± ki·ªán, sau ƒë√≥ b·ªô ƒëi·ªÅu ph·ªëi s·∫Ω chuy·ªÉn <strong>Socket</strong> ƒë√≥ ƒë·∫øn b·ªô x·ª≠ l√Ω s·ª± ki·ªán t∆∞∆°ng ·ª©ng.</p><p>Khi m·ªôt <strong>Socket</strong> ƒë∆∞·ª£c x·ª≠ l√Ω xong, ch∆∞∆°ng tr√¨nh <strong>IO ƒëa k√™nh</strong> m·ªõi ti·∫øp t·ª•c l·∫•y <strong>Socket</strong> ti·∫øp theo t·ª´ h√†ng ƒë·ª£i v√† giao cho b·ªô ƒëi·ªÅu ph·ªëi s·ª± ki·ªán. B·ªô ƒëi·ªÅu ph·ªëi s·ª± ki·ªán s·∫Ω l·ª±a ch·ªçn b·ªô x·ª≠ l√Ω ph√π h·ª£p d·ª±a tr√™n s·ª± ki·ªán hi·ªán t·∫°i m√† <strong>Socket</strong> t·∫°o ra.</p><ol><li>Khi Redis kh·ªüi ƒë·ªông, b·ªô x·ª≠ l√Ω k·∫øt n·ªëi ƒë∆∞·ª£c li√™n k·∫øt v·ªõi s·ª± ki·ªán <strong>AE_READABLE</strong>.</li><li>Khi m·ªôt m√°y kh√°ch kh·ªüi t·∫°o k·∫øt n·ªëi, s·∫Ω t·∫°o ra m·ªôt s·ª± ki·ªán <strong>AE_READABLE</strong>, v√† b·ªô x·ª≠ l√Ω k·∫øt n·ªëi s·∫Ω x·ª≠ l√Ω vi·ªác t·∫°o k·∫øt n·ªëi, ƒë·ªìng th·ªùi t·∫°o ra <strong>socket</strong> cho m√°y kh√°ch. Sau ƒë√≥, s·ª± ki·ªán <strong>AE_READABLE</strong> c·ªßa <strong>socket</strong> n√†y s·∫Ω ƒë∆∞·ª£c li√™n k·∫øt v·ªõi b·ªô x·ª≠ l√Ω y√™u c·∫ßu l·ªánh ƒë·ªÉ m√°y kh√°ch c√≥ th·ªÉ g·ª≠i y√™u c·∫ßu ƒë·∫øn Redis.</li><li>Khi m√°y kh√°ch g·ª≠i y√™u c·∫ßu t·ªõi Redis (d√π l√† ƒë·ªçc hay ghi), <strong>socket</strong> c·ªßa m√°y kh√°ch s·∫Ω t·∫°o ra m·ªôt s·ª± ki·ªán <strong>AE_READABLE</strong>, k√≠ch ho·∫°t b·ªô x·ª≠ l√Ω y√™u c·∫ßu l·ªánh. B·ªô x·ª≠ l√Ω n√†y s·∫Ω ƒë·ªçc n·ªôi dung y√™u c·∫ßu v√† g·ª≠i t·ªõi ch∆∞∆°ng tr√¨nh th·ª±c thi t∆∞∆°ng ·ª©ng.</li><li>Khi Redis ƒë√£ s·∫µn s√†ng ph·∫£n h·ªìi d·ªØ li·ªáu cho m√°y kh√°ch, s·ª± ki·ªán <strong>AE_WRITABLE</strong> c·ªßa <strong>socket</strong> s·∫Ω ƒë∆∞·ª£c li√™n k·∫øt v·ªõi b·ªô x·ª≠ l√Ω ph·∫£n h·ªìi l·ªánh. Khi m√°y kh√°ch s·∫µn s√†ng ƒë·ªçc d·ªØ li·ªáu, <strong>socket</strong> s·∫Ω t·∫°o ra s·ª± ki·ªán <strong>AE_WRITABLE</strong>, v√† b·ªô x·ª≠ l√Ω ph·∫£n h·ªìi s·∫Ω ghi d·ªØ li·ªáu v√†o <strong>socket</strong> ƒë·ªÉ m√°y kh√°ch c√≥ th·ªÉ ƒë·ªçc.</li><li>Khi b·ªô x·ª≠ l√Ω ph·∫£n h·ªìi l·ªánh ƒë√£ ghi xong d·ªØ li·ªáu v√†o <strong>socket</strong>, s·ª± ki·ªán <strong>AE_WRITABLE</strong> v√† li√™n k·∫øt c·ªßa n√≥ v·ªõi b·ªô x·ª≠ l√Ω ph·∫£n h·ªìi s·∫Ω b·ªã xo√°.</li></ol><h3 id="ly-do-redis-ƒëon-luong-nhanh" tabindex="-1"><a class="header-anchor" href="#ly-do-redis-ƒëon-luong-nhanh"><span>L√Ω do Redis ƒë∆°n lu·ªìng nhanh:</span></a></h3><ol><li>C√°c thao t√°c ch·ªâ di·ªÖn ra tr√™n b·ªô nh·ªõ.</li><li>C∆° ch·∫ø <strong>IO ƒëa k√™nh</strong> kh√¥ng ch·∫∑n.</li><li>Tr√°nh ƒë∆∞·ª£c v·∫•n ƒë·ªÅ chuy·ªÉn ƒë·ªïi ng·ªØ c·∫£nh gi·ªØa nhi·ªÅu lu·ªìng.</li></ol><h2 id="mo-ta-ngan-gon-ve-viec-thuc-hien-giao-dich-trong-redis" tabindex="-1"><a class="header-anchor" href="#mo-ta-ngan-gon-ve-viec-thuc-hien-giao-dich-trong-redis"><span>M√¥ t·∫£ ng·∫Øn g·ªçn v·ªÅ vi·ªác th·ª±c hi·ªán giao d·ªãch trong Redis</span></a></h2><ul><li><strong>B·∫Øt ƒë·∫ßu giao d·ªãch</strong>: Khi l·ªánh <strong>MULTI</strong> ƒë∆∞·ª£c th·ª±c thi, n√≥ ƒë√°nh d·∫•u s·ª± b·∫Øt ƒë·∫ßu c·ªßa m·ªôt giao d·ªãch. <strong>MULTI</strong> m·ªü c·ªù <strong>REDIS_MULTI</strong> trong thu·ªôc t√≠nh <strong>flags</strong> c·ªßa tr·∫°ng th√°i m√°y kh√°ch.</li><li><strong>L·ªánh v√†o h√†ng ƒë·ª£i</strong>: Sau khi m√°y kh√°ch chuy·ªÉn sang tr·∫°ng th√°i giao d·ªãch, Redis s·∫Ω x·∫øp c√°c l·ªánh c·ªßa m√°y kh√°ch v√†o h√†ng ƒë·ª£i giao d·ªãch. N·∫øu m√°y kh√°ch g·ª≠i l·ªánh <strong>MULTI</strong>, <strong>EXEC</strong>, <strong>WATCH</strong>, ho·∫∑c <strong>DISCARD</strong>, Redis s·∫Ω th·ª±c thi ngay l·∫≠p t·ª©c, n·∫øu kh√¥ng, l·ªánh s·∫Ω ƒë∆∞·ª£c ƒë∆∞a v√†o h√†ng ƒë·ª£i v√† tr·∫£ v·ªÅ th√¥ng b√°o <strong>QUEUED</strong>.</li><li><strong>Th·ª±c thi giao d·ªãch</strong>: Khi m√°y kh√°ch g·ª≠i l·ªánh <strong>EXEC</strong>, Redis s·∫Ω th·ª±c thi t·∫•t c·∫£ c√°c l·ªánh trong h√†ng ƒë·ª£i theo th·ª© t·ª± <strong>FIFO</strong>. Redis kh√¥ng h·ªó tr·ª£ ho√†n t√°c (rollback), nh∆∞ng s·∫Ω ki·ªÉm tra l·ªói trong m·ªói l·ªánh.</li></ul><p>Redis kh√¥ng ki·ªÉm tra l·ªói logic c·ªßa l·∫≠p tr√¨nh vi√™n (nh∆∞ vi·ªác th·ª±c hi·ªán l·ªánh kh√¥ng h·ª£p l·ªá tr√™n ki·ªÉu d·ªØ li·ªáu kh√¥ng t∆∞∆°ng ·ª©ng).</p><h2 id="ly-thuyet-cap-la-gi" tabindex="-1"><a class="header-anchor" href="#ly-thuyet-cap-la-gi"><span>L√Ω thuy·∫øt CAP l√† g√¨?</span></a></h2><p>L√Ω thuy·∫øt CAP l√† m·ªôt l√Ω thuy·∫øt h∆∞·ªõng d·∫´n r·∫•t quan tr·ªçng trong lƒ©nh v·ª±c h·ªá th·ªëng ph√¢n t√°n. C (Consistency) bi·ªÉu th·ªã t√≠nh nh·∫•t qu√°n m·∫°nh, A (Availability) bi·ªÉu th·ªã t√≠nh kh·∫£ d·ª•ng, v√† P (Partition Tolerance) bi·ªÉu th·ªã t√≠nh ch·ªãu l·ªói ph√¢n v√πng. L√Ω thuy·∫øt CAP ch·ªâ ra r·∫±ng trong c√°c ƒëi·ªÅu ki·ªán ph·∫ßn c·ª©ng hi·ªán t·∫°i, m·ªôt h·ªá th·ªëng ph√¢n t√°n ph·∫£i ƒë·∫£m b·∫£o t√≠nh ch·ªãu l·ªói ph√¢n v√πng. Tr√™n c∆° s·ªü ƒë√≥, h·ªá th·ªëng ph√¢n t√°n ho·∫∑c ƒë·∫£m b·∫£o CP (Consistency v√† Partition Tolerance) ho·∫∑c ƒë·∫£m b·∫£o AP (Availability v√† Partition Tolerance), nh∆∞ng kh√¥ng th·ªÉ ƒë·∫£m b·∫£o ƒë·ªìng th·ªùi c·∫£ ba y·∫øu t·ªë CAP.</p><p>T√≠nh ch·ªãu l·ªói ph√¢n v√πng bi·ªÉu th·ªã r·∫±ng d√π h·ªá th·ªëng l√† ph√¢n t√°n nh∆∞ng ƒë·ªëi v·ªõi ng∆∞·ªùi d√πng, h·ªá th·ªëng v·∫´n ph·∫£i tr√¥ng nh∆∞ m·ªôt t·ªïng th·ªÉ. ƒêi·ªÅu n√†y c√≥ nghƒ©a l√† n·∫øu m·ªôt n√∫t trong h·ªá th·ªëng b·ªã l·ªói ho·∫∑c c√≥ s·ª± c·ªë v·ªÅ m·∫°ng, h·ªá th·ªëng v·∫´n kh√¥ng ƒë∆∞·ª£c g√¢y ra b·∫•t k·ª≥ s·ª± c·ªë n√†o ƒë·ªëi v·ªõi ng∆∞·ªùi d√πng.</p><p>T√≠nh nh·∫•t qu√°n m·∫°nh nghƒ©a l√† d·ªØ li·ªáu gi·ªØa c√°c n√∫t trong m·ªôt h·ªá th·ªëng ph√¢n t√°n ph·∫£i ƒë∆∞·ª£c ƒë·ªìng b·ªô ngay l·∫≠p t·ª©c, v√† trong qu√° tr√¨nh ƒë·ªìng b·ªô h√≥a, h·ªá th·ªëng kh√¥ng ƒë∆∞·ª£c cung c·∫•p d·ªãch v·ª• cho ng∆∞·ªùi d√πng v√¨ n·∫øu kh√¥ng s·∫Ω d·∫´n ƒë·∫øn d·ªØ li·ªáu kh√¥ng nh·∫•t qu√°n. Do ƒë√≥, t√≠nh nh·∫•t qu√°n m·∫°nh v√† t√≠nh kh·∫£ d·ª•ng kh√¥ng th·ªÉ ƒë·∫£m b·∫£o ƒë·ªìng th·ªùi.</p><p>T√≠nh kh·∫£ d·ª•ng bi·ªÉu th·ªã r·∫±ng h·ªá th·ªëng ph√¢n t√°n ph·∫£i ƒë·∫£m b·∫£o c√≥ th·ªÉ cung c·∫•p d·ªãch v·ª• li√™n t·ª•c cho ng∆∞·ªùi d√πng.</p><h2 id="ly-thuyet-base-la-gi" tabindex="-1"><a class="header-anchor" href="#ly-thuyet-base-la-gi"><span>L√Ω thuy·∫øt BASE l√† g√¨?</span></a></h2><p>Do kh√¥ng th·ªÉ ƒë·ªìng th·ªùi ƒë·∫£m b·∫£o ƒë∆∞·ª£c CAP, l√Ω thuy·∫øt BASE ƒë√£ xu·∫•t hi·ªán:</p><ol><li>BA: Basically Available - bi·ªÉu th·ªã t√≠nh kh·∫£ d·ª•ng c∆° b·∫£n, cho ph√©p m·ªôt s·ªë m·ª©c ƒë·ªô kh√¥ng kh·∫£ d·ª•ng nh·∫•t ƒë·ªãnh, ch·∫≥ng h·∫°n nh∆∞ y√™u c·∫ßu x·ª≠ l√Ω l√¢u h∆°n do s·ª± c·ªë h·ªá th·ªëng ho·∫∑c c√°c ch·ª©c nƒÉng kh√¥ng quan tr·ªçng c√≥ th·ªÉ kh√¥ng kh·∫£ d·ª•ng.</li><li>S: Soft State - bi·ªÉu th·ªã r·∫±ng h·ªá th·ªëng ph√¢n t√°n c√≥ th·ªÉ ·ªü tr·∫°ng th√°i trung gian, ch·∫≥ng h·∫°n nh∆∞ d·ªØ li·ªáu ƒëang ƒë∆∞·ª£c ƒë·ªìng b·ªô.</li><li>E: Eventually Consistent - bi·ªÉu th·ªã t√≠nh nh·∫•t qu√°n cu·ªëi c√πng, kh√¥ng y√™u c·∫ßu d·ªØ li·ªáu trong h·ªá th·ªëng ph√¢n t√°n ph·∫£i ƒë·ªìng b·ªô ngay l·∫≠p t·ª©c m√† ch·ªâ c·∫ßn sau m·ªôt kho·∫£ng th·ªùi gian, h·ªá th·ªëng s·∫Ω ƒë·∫°t ƒë∆∞·ª£c tr·∫°ng th√°i nh·∫•t qu√°n.</li></ol><h2 id="rpc-la-gi" tabindex="-1"><a class="header-anchor" href="#rpc-la-gi"><span>RPC l√† g√¨?</span></a></h2><p>RPC l√† vi·∫øt t·∫Øt c·ªßa Remote Procedure Call (G·ªçi th·ªß t·ª•c t·ª´ xa), ƒë·ªëi v·ªõi c√°c ng√¥n ng·ªØ h∆∞·ªõng ƒë·ªëi t∆∞·ª£ng nh∆∞ Java, RPC c≈©ng c√≥ th·ªÉ hi·ªÉu l√† g·ªçi ph∆∞∆°ng th·ª©c t·ª´ xa. RPC kh√°c v·ªõi HTTP, v√¨ RPC ch·ªâ l√† c√°ch g·ªçi ph∆∞∆°ng th·ª©c t·ª´ xa, v√† c√≥ th·ªÉ ƒë∆∞·ª£c th·ª±c hi·ªán th√¥ng qua giao th·ª©c HTTP ho·∫∑c tr·ª±c ti·∫øp d·ª±a tr√™n giao th·ª©c TCP. Trong Java, ta c√≥ th·ªÉ s·ª≠ d·ª•ng ƒë·ªëi t∆∞·ª£ng proxy c·ªßa m·ªôt giao di·ªán d·ªãch v·ª• ƒë·ªÉ th·ª±c thi ph∆∞∆°ng th·ª©c, v√† t·∫ßng d∆∞·ªõi s·∫Ω g·ª≠i y√™u c·∫ßu HTTP ƒë·ªÉ g·ªçi ph∆∞∆°ng th·ª©c t·ª´ xa. V√¨ v·∫≠y, c√≥ th·ªÉ hi·ªÉu RPC nh∆∞ m·ªôt giao th·ª©c cao h∆°n HTTP.</p><h2 id="cac-mo-hinh-nhat-quan-du-lieu-la-gi" tabindex="-1"><a class="header-anchor" href="#cac-mo-hinh-nhat-quan-du-lieu-la-gi"><span>C√°c m√¥ h√¨nh nh·∫•t qu√°n d·ªØ li·ªáu l√† g√¨?</span></a></h2><ul><li><p><strong>Nh·∫•t qu√°n m·∫°nh</strong>: Khi thao t√°c c·∫≠p nh·∫≠t ho√†n t·∫•t, b·∫•t k·ª≥ ti·∫øn tr√¨nh n√†o sau ƒë√≥ truy c·∫≠p s·∫Ω lu√¥n tr·∫£ v·ªÅ gi√° tr·ªã m·ªõi nh·∫•t ƒë√£ c·∫≠p nh·∫≠t. ƒê√¢y l√† m√¥ h√¨nh th√¢n thi·ªán nh·∫•t v·ªõi ng∆∞·ªùi d√πng, ƒë·∫£m b·∫£o r·∫±ng ng∆∞·ªùi d√πng vi·∫øt g√¨ l·∫ßn tr∆∞·ªõc th√¨ l·∫ßn sau s·∫Ω ƒë·ªçc ƒë∆∞·ª£c ƒë√∫ng nh∆∞ v·∫≠y. Theo l√Ω thuy·∫øt CAP, m√¥ h√¨nh n√†y ph·∫£i hy sinh t√≠nh s·∫µn s√†ng.</p></li><li><p><strong>Nh·∫•t qu√°n y·∫øu</strong>: H·ªá th·ªëng sau khi ghi d·ªØ li·ªáu th√†nh c√¥ng kh√¥ng cam k·∫øt s·∫Ω c√≥ th·ªÉ ƒë·ªçc ngay ƒë∆∞·ª£c gi√° tr·ªã m·ªõi c·∫≠p nh·∫≠t, v√† c≈©ng kh√¥ng cam k·∫øt c·ª• th·ªÉ v·ªÅ th·ªùi gian bao l√¢u th√¨ c√≥ th·ªÉ ƒë·ªçc ƒë∆∞·ª£c. Ng∆∞·ªùi d√πng c·∫ßn m·ªôt kho·∫£ng th·ªùi gian ƒë·ªÉ thao t√°c c·∫≠p nh·∫≠t h·ªá th·ªëng tr·ªü n√™n ƒë·ªìng b·ªô, g·ªçi l√† ‚Äúc·ª≠a s·ªï kh√¥ng nh·∫•t qu√°n‚Äù.</p></li><li><p><strong>Nh·∫•t qu√°n cu·ªëi c√πng</strong>: L√† tr∆∞·ªùng h·ª£p ƒë·∫∑c bi·ªát c·ªßa nh·∫•t qu√°n y·∫øu, nh·∫•n m·∫°nh r·∫±ng sau m·ªôt kho·∫£ng th·ªùi gian ƒë·ªìng b·ªô, t·∫•t c·∫£ c√°c b·∫£n sao d·ªØ li·ªáu cu·ªëi c√πng s·∫Ω ƒë·∫°t ƒë·∫øn m·ªôt tr·∫°ng th√°i nh·∫•t qu√°n. B·∫£n ch·∫•t c·ªßa nh·∫•t qu√°n cu·ªëi c√πng l√† h·ªá th·ªëng ƒë·∫£m b·∫£o d·ªØ li·ªáu cu·ªëi c√πng s·∫Ω nh·∫•t qu√°n, nh∆∞ng kh√¥ng c·∫ßn ƒë·∫£m b·∫£o nh·∫•t qu√°n m·∫°nh theo th·ªùi gian th·ª±c. Th·ªùi gian ƒë·ªÉ ƒë·∫°t ƒë·∫øn nh·∫•t qu√°n cu·ªëi c√πng ch√≠nh l√† th·ªùi gian c·ª≠a s·ªï kh√¥ng nh·∫•t qu√°n, v√† khi kh√¥ng c√≥ l·ªói x·∫£y ra, th·ªùi gian n√†y ch·ªß y·∫øu b·ªã ·∫£nh h∆∞·ªüng b·ªüi ƒë·ªô tr·ªÖ truy·ªÅn th√¥ng, t·∫£i h·ªá th·ªëng v√† s·ªë l∆∞·ª£ng b·∫£n sao.</p></li></ul><h2 id="id-phan-tan-la-gi-cac-giai-phap-nao-co-the-ap-dung" tabindex="-1"><a class="header-anchor" href="#id-phan-tan-la-gi-cac-giai-phap-nao-co-the-ap-dung"><span>ID ph√¢n t√°n l√† g√¨? C√°c gi·∫£i ph√°p n√†o c√≥ th·ªÉ √°p d·ª•ng?</span></a></h2><p>Trong ph√°t tri·ªÉn, ch√∫ng ta th∆∞·ªùng c·∫ßn m·ªôt ID duy nh·∫•t ƒë·ªÉ nh·∫≠n d·∫°ng d·ªØ li·ªáu. N·∫øu l√† ki·∫øn tr√∫c ƒë∆°n th·ªÉ, c√≥ th·ªÉ s·ª≠ d·ª•ng kh√≥a ch√≠nh c·ªßa c∆° s·ªü d·ªØ li·ªáu ho·∫∑c duy tr√¨ m·ªôt s·ªë t·ª± tƒÉng trong b·ªô nh·ªõ ƒë·ªÉ l√†m ID. Tuy nhi√™n, trong h·ªá th·ªëng ph√¢n t√°n, c√≥ th·ªÉ x·∫£y ra xung ƒë·ªôt ID, do ƒë√≥ c√≥ m·ªôt s·ªë gi·∫£i ph√°p sau:</p><ol><li><strong>UUID</strong>: Gi·∫£i ph√°p n√†y c√≥ ƒë·ªô ph·ª©c t·∫°p th·∫•p nh·∫•t, nh∆∞ng ·∫£nh h∆∞·ªüng ƒë·∫øn kh√¥ng gian l∆∞u tr·ªØ v√† hi·ªáu su·∫•t.</li><li><strong>MySQL</strong>: S·ª≠ d·ª•ng kh√≥a ch√≠nh t·ª± tƒÉng c·ªßa c∆° s·ªü d·ªØ li·ªáu ƒë∆°n l·∫ª l√†m b·ªô t·∫°o ID ph√¢n t√°n. ƒê·ªô ph·ª©c t·∫°p v·ª´a ph·∫£i, ID ng·∫Øn h∆°n UUID, nh∆∞ng b·ªã gi·ªõi h·∫°n b·ªüi hi·ªáu su·∫•t c·ªßa c∆° s·ªü d·ªØ li·ªáu ƒë∆°n v√† kh√¥ng ph·∫£i l√† gi·∫£i ph√°p t·ªëi ∆∞u khi c√≥ nhi·ªÅu y√™u c·∫ßu ƒë·ªìng th·ªùi.</li><li><strong>Redis, Zookeeper</strong>: S·ª≠ d·ª•ng l·ªánh t·ª± tƒÉng c·ªßa Redis ho·∫∑c c√°c n√∫t th·ª© t·ª± trong Zookeeper. So v·ªõi c∆° s·ªü d·ªØ li·ªáu ƒë∆°n l·∫ª (MySQL), hi·ªáu su·∫•t ƒë∆∞·ª£c c·∫£i thi·ªán v√† c√≥ th·ªÉ s·ª≠ d·ª•ng trong c√°c tr∆∞·ªùng h·ª£p nh·∫•t ƒë·ªãnh.</li><li><strong>Thu·∫≠t to√°n Snowflake</strong>: ƒê√¢y l√† gi·∫£i ph√°p s·ª≠ d·ª•ng thu·∫≠t to√°n ƒë·ªÉ t·∫°o ID ph√¢n t√°n, trong ƒë√≥ m·ªói m√°y s·∫Ω t·ª± tƒÉng m·ªôt s·ªë trong m·ªôt mili gi√¢y c·ª• th·ªÉ, ƒë·∫£m b·∫£o ID duy nh·∫•t trong h·ªá th·ªëng ph√¢n t√°n. Gi·∫£i ph√°p n√†y ƒë·∫£m b·∫£o ID tƒÉng theo xu h∆∞·ªõng. C√°c middleware m√£ ngu·ªìn m·ªü nh∆∞ TinyID, Leaf ƒë√£ hi·ªán th·ª±c thu·∫≠t to√°n n√†y.</li></ol><h2 id="cac-truong-hop-su-dung-khoa-phan-tan-la-gi-co-nhung-giai-phap-nao" tabindex="-1"><a class="header-anchor" href="#cac-truong-hop-su-dung-khoa-phan-tan-la-gi-co-nhung-giai-phap-nao"><span>C√°c tr∆∞·ªùng h·ª£p s·ª≠ d·ª•ng kh√≥a ph√¢n t√°n l√† g√¨? C√≥ nh·ªØng gi·∫£i ph√°p n√†o?</span></a></h2><p>Trong ki·∫øn tr√∫c ƒë∆°n th·ªÉ, c√°c lu·ªìng (thread) thu·ªôc c√πng m·ªôt ti·∫øn tr√¨nh, do ƒë√≥ khi g·∫∑p ph·∫£i tranh ch·∫•p t√†i nguy√™n trong qu√° tr√¨nh th·ª±c thi ƒë·ªìng th·ªùi, c√≥ th·ªÉ s·ª≠ d·ª•ng c√°c k·ªπ thu·∫≠t nh∆∞ <code>ReentrantLock</code> ho·∫∑c <code>synchronized</code> ƒë·ªÉ kh√≥a v√† ki·ªÉm so√°t t√†i nguy√™n chia s·∫ª.</p><p>Tuy nhi√™n, trong ki·∫øn tr√∫c ph√¢n t√°n, c√°c lu·ªìng c√≥ th·ªÉ thu·ªôc c√°c ti·∫øn tr√¨nh kh√°c nhau, v√† khi g·∫∑p ph·∫£i tranh ch·∫•p t√†i nguy√™n, kh√¥ng th·ªÉ s·ª≠ d·ª•ng <code>ReentrantLock</code> hay <code>synchronized</code>. Do ƒë√≥, c·∫ßn kh√≥a ph√¢n t√°n, t·ª©c l√† m·ªôt b·ªô t·∫°o kh√≥a ph√¢n t√°n m√† c√°c ·ª©ng d·ª•ng trong h·ªá th·ªëng ph√¢n t√°n c√≥ th·ªÉ s·ª≠ d·ª•ng ƒë·ªÉ ƒë·ªìng b·ªô.</p><p>Hi·ªán nay, c√≥ hai gi·∫£i ph√°p ch√≠nh ƒë·ªÉ th·ª±c hi·ªán kh√≥a ph√¢n t√°n:</p><ol><li><strong>Zookeeper</strong>: S·ª≠ d·ª•ng c√°c n√∫t t·∫°m th·ªùi, n√∫t theo th·ª© t·ª± v√† c∆° ch·∫ø theo d√µi (watch) c·ªßa Zookeeper. ƒê·∫∑c ƒëi·ªÉm c·ªßa kh√≥a ph√¢n t√°n Zookeeper l√† t√≠nh nh·∫•t qu√°n cao, do Zookeeper ƒë·∫£m b·∫£o CP (Consistency v√† Partition Tolerance), n√™n kh√≥a n√†y ƒë√°ng tin c·∫≠y v√† kh√¥ng g√¢y ra t√¨nh tr·∫°ng l·ªôn x·ªôn.</li><li><strong>Redis</strong>: S·ª≠ d·ª•ng l·ªánh <code>setnx</code>, script Lua v√† c∆° ch·∫ø subscribe/publish c·ªßa Redis. ƒê·∫∑c ƒëi·ªÉm c·ªßa kh√≥a ph√¢n t√°n Redis l√† t√≠nh s·∫µn s√†ng cao, do Redis ƒë·∫£m b·∫£o AP (Availability v√† Partition Tolerance). Tuy nhi√™n, khi d·ªØ li·ªáu trong Redis kh√¥ng nh·∫•t qu√°n, c√≥ th·ªÉ x·∫£y ra t√¨nh tr·∫°ng nhi·ªÅu client c√πng gi·ªØ kh√≥a.</li></ol><h2 id="giao-dich-phan-tan-la-gi-co-nhung-giai-phap-nao" tabindex="-1"><a class="header-anchor" href="#giao-dich-phan-tan-la-gi-co-nhung-giai-phap-nao"><span>Giao d·ªãch ph√¢n t√°n l√† g√¨? C√≥ nh·ªØng gi·∫£i ph√°p n√†o?</span></a></h2><p>Trong h·ªá th·ªëng ph√¢n t√°n, m·ªôt quy tr√¨nh nghi·ªáp v·ª• c√≥ th·ªÉ c·∫ßn nhi·ªÅu ·ª©ng d·ª•ng ƒë·ªÉ th·ª±c hi·ªán. V√≠ d·ª•, khi ng∆∞·ªùi d√πng g·ª≠i y√™u c·∫ßu ƒë·∫∑t h√†ng, n√≥ s·∫Ω li√™n quan ƒë·∫øn h·ªá th·ªëng ƒë·∫∑t h√†ng t·∫°o ƒë∆°n v√† h·ªá th·ªëng kho h√†ng tr·ª´ kho. ƒê·ªëi v·ªõi m·ªôt ƒë∆°n ƒë·∫∑t h√†ng, vi·ªác t·∫°o ƒë∆°n v√† tr·ª´ kho ph·∫£i th√†nh c√¥ng ho·∫∑c th·∫•t b·∫°i c√πng l√∫c. Tuy nhi√™n, trong h·ªá th·ªëng ph√¢n t√°n, n·∫øu kh√¥ng x·ª≠ l√Ω ƒë√∫ng c√°ch, c√≥ th·ªÉ x·∫£y ra t√¨nh tr·∫°ng t·∫°o ƒë∆°n th√†nh c√¥ng nh∆∞ng tr·ª´ kho th·∫•t b·∫°i. ƒê·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ n√†y, c·∫ßn s·ª≠ d·ª•ng giao d·ªãch ph√¢n t√°n. C√°c gi·∫£i ph√°p ph·ªï bi·∫øn bao g·ªìm:</p><ol><li><p><strong>B·∫£ng tin nh·∫Øn c·ª•c b·ªô</strong>: Khi t·∫°o ƒë∆°n, th√™m th√¥ng b√°o tr·ª´ kho v√†o giao d·ªãch c·ª•c b·ªô v√† c√πng l√∫c l∆∞u v√†o b·∫£ng tin nh·∫Øn c·ª•c b·ªô trong c∆° s·ªü d·ªØ li·ªáu. Sau ƒë√≥, g·ªçi h·ªá th·ªëng kho h√†ng. N·∫øu g·ªçi th√†nh c√¥ng, tr·∫°ng th√°i tin nh·∫Øn trong b·∫£ng s·∫Ω ƒë∆∞·ª£c c·∫≠p nh·∫≠t th√†nh c√¥ng. N·∫øu g·ªçi th·∫•t b·∫°i, m·ªôt nhi·ªám v·ª• ƒë·ªãnh k·ª≥ s·∫Ω l·∫•y tin nh·∫Øn ch∆∞a th√†nh c√¥ng t·ª´ b·∫£ng v√† th·ª≠ l·∫°i vi·ªác g·ªçi h·ªá th·ªëng kho.</p></li><li><p><strong>H√†ng ƒë·ª£i tin nh·∫Øn</strong>: Hi·ªán t·∫°i, <strong>RocketMQ</strong> h·ªó tr·ª£ giao d·ªãch tin nh·∫Øn, v·ªõi nguy√™n t·∫Øc ho·∫°t ƒë·ªông nh∆∞ sau:</p><ol><li>H·ªá th·ªëng ƒë·∫∑t h√†ng tr∆∞·ªõc ti√™n g·ª≠i m·ªôt tin nh·∫Øn &quot;half&quot; (n·ª≠a ch·ª´ng) ƒë·∫øn Broker. Tin nh·∫Øn n√†y kh√¥ng th·ªÉ nh√¨n th·∫•y ƒë·ªëi v·ªõi Consumer.</li><li>Sau ƒë√≥ t·∫°o ƒë∆°n h√†ng v√† g·ª≠i l·ªánh <strong>commit</strong> ho·∫∑c <strong>rollback</strong> ƒë·∫øn Broker t√πy thu·ªôc v√†o vi·ªác t·∫°o ƒë∆°n c√≥ th√†nh c√¥ng hay kh√¥ng.</li><li>H·ªá th·ªëng ƒë·∫∑t h√†ng c≈©ng c√≥ th·ªÉ cung c·∫•p giao di·ªán g·ªçi l·∫°i cho Broker. N·∫øu Broker ph√°t hi·ªán kh√¥ng nh·∫≠n ƒë∆∞·ª£c l·ªánh n√†o trong m·ªôt th·ªùi gian d√†i t·ª´ tin nh·∫Øn &quot;half&quot;, n√≥ s·∫Ω ch·ªß ƒë·ªông g·ªçi l·∫°i giao di·ªán ƒë·ªÉ ki·ªÉm tra xem ƒë∆°n h√†ng ƒë√£ ƒë∆∞·ª£c t·∫°o th√†nh c√¥ng ch∆∞a.</li><li>N·∫øu tin nh·∫Øn &quot;half&quot; ƒë∆∞·ª£c commit, h·ªá th·ªëng kho s·∫Ω ti√™u th·ª• tin nh·∫Øn. N·∫øu ti√™u th·ª• th√†nh c√¥ng, tin nh·∫Øn s·∫Ω b·ªã x√≥a v√† giao d·ªãch ph√¢n t√°n k·∫øt th√∫c th√†nh c√¥ng.</li><li>N·∫øu ti√™u th·ª• th·∫•t b·∫°i, h·ªá th·ªëng s·∫Ω th·ª≠ l·∫°i theo chi·∫øn l∆∞·ª£c t√°i th·ª≠. N·∫øu th·∫•t b·∫°i ti·∫øp, tin nh·∫Øn s·∫Ω ƒë∆∞·ª£c ƒë∆∞a v√†o h√†ng ƒë·ª£i ch·∫øt ƒë·ªÉ x·ª≠ l√Ω th√™m.</li></ol></li><li><p><strong>Seata</strong>: L√† m·ªôt khung giao d·ªãch ph√¢n t√°n m√£ ngu·ªìn m·ªü c·ªßa Alibaba, h·ªó tr·ª£ nhi·ªÅu ch·∫ø ƒë·ªô nh∆∞ <strong>AT</strong> v√† <strong>TCC</strong>, v√† d·ª±a tr√™n l√Ω thuy·∫øt cam k·∫øt hai giai ƒëo·∫°n ƒë·ªÉ th·ª±c hi·ªán.</p></li></ol><h2 id="giao-thuc-zab-la-gi" tabindex="-1"><a class="header-anchor" href="#giao-thuc-zab-la-gi"><span>Giao th·ª©c ZAB l√† g√¨?</span></a></h2><p>Giao th·ª©c <strong>ZAB</strong> l√† giao th·ª©c ph√°t s√≥ng nguy√™n t·ª≠ nh·∫•t qu√°n ƒë∆∞·ª£c s·ª≠ d·ª•ng b·ªüi <strong>Zookeeper</strong> ƒë·ªÉ ƒë·∫°t ƒë∆∞·ª£c t√≠nh nh·∫•t qu√°n. Giao th·ª©c n√†y m√¥ t·∫£ c√°ch <strong>Zookeeper</strong> th·ª±c hi·ªán t√≠nh nh·∫•t qu√°n, bao g·ªìm ba giai ƒëo·∫°n:</p><ol><li><p><strong>Giai ƒëo·∫°n b·∫ßu l√£nh ƒë·∫°o</strong>: T·ª´ c·ª•m Zookeeper, m·ªôt n√∫t s·∫Ω ƒë∆∞·ª£c ch·ªçn l√†m <strong>Leader</strong>. T·∫•t c·∫£ c√°c y√™u c·∫ßu ghi s·∫Ω ƒë∆∞·ª£c x·ª≠ l√Ω b·ªüi n√∫t Leader.</p></li><li><p><strong>Giai ƒëo·∫°n ƒë·ªìng b·ªô d·ªØ li·ªáu</strong>: D·ªØ li·ªáu gi·ªØa c√°c n√∫t trong c·ª•m ph·∫£i nh·∫•t qu√°n v·ªõi Leader. N·∫øu kh√¥ng nh·∫•t qu√°n, d·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c ƒë·ªìng b·ªô h√≥a.</p></li><li><p><strong>Giai ƒëo·∫°n ph√°t s√≥ng y√™u c·∫ßu</strong>: Khi Leader nh·∫≠n ƒë∆∞·ª£c y√™u c·∫ßu ghi, n√≥ s·∫Ω s·ª≠ d·ª•ng c∆° ch·∫ø cam k·∫øt hai giai ƒëo·∫°n ƒë·ªÉ ph√°t s√≥ng y√™u c·∫ßu ghi, ƒë·∫£m b·∫£o r·∫±ng c√°c y√™u c·∫ßu ghi ƒë∆∞·ª£c th·ª±c hi·ªán nh∆∞ m·ªôt giao d·ªãch tr√™n c√°c n√∫t kh√°c, ƒë·ªÉ ƒë·∫°t ƒë∆∞·ª£c t√≠nh nh·∫•t qu√°n c·ªßa d·ªØ li·ªáu.</p></li></ol><p>M·∫∑c d√π <strong>Zookeeper</strong> c·ªë g·∫Øng ƒë·∫°t ƒë∆∞·ª£c t√≠nh nh·∫•t qu√°n m·∫°nh, nh∆∞ng th·ª±c t·∫ø, n√≥ v·∫´n ch·ªâ l√† t√≠nh nh·∫•t qu√°n cu·ªëi c√πng.</p><h2 id="tai-sao-zookeeper-co-the-ƒëuoc-su-dung-lam-trung-tam-ƒëang-ky" tabindex="-1"><a class="header-anchor" href="#tai-sao-zookeeper-co-the-ƒëuoc-su-dung-lam-trung-tam-ƒëang-ky"><span>T·∫°i sao Zookeeper c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng l√†m trung t√¢m ƒëƒÉng k√Ω?</span></a></h2><p>Zookeeper c√≥ th·ªÉ s·ª≠ d·ª•ng c√°c <strong>n√∫t t·∫°m th·ªùi</strong> v√† c∆° ch·∫ø <strong>watch</strong> ƒë·ªÉ th·ª±c hi·ªán vi·ªác ƒëƒÉng k√Ω v√† kh√°m ph√° t·ª± ƒë·ªông cho trung t√¢m ƒëƒÉng k√Ω. Ngo√†i ra, d·ªØ li·ªáu trong Zookeeper ƒë∆∞·ª£c l∆∞u tr·ªØ trong b·ªô nh·ªõ v√† Zookeeper s·ª≠ d·ª•ng m√¥ h√¨nh ƒëa lu·ªìng v√† <strong>NIO</strong> ·ªü t·∫ßng d∆∞·ªõi, v√¨ v·∫≠y hi·ªáu su·∫•t c·ªßa n√≥ kh√° cao, th√≠ch h·ª£p ƒë·ªÉ l√†m trung t√¢m ƒëƒÉng k√Ω. Tuy nhi√™n, n·∫øu x√©t v·ªÅ ƒë·ªô kh·∫£ d·ª•ng, Zookeeper c√≥ th·ªÉ kh√¥ng ph·∫£i l√† l·ª±a ch·ªçn t·ªët nh·∫•t v√¨ n√≥ l√† h·ªá th·ªëng ƒë·∫£m b·∫£o <strong>CP</strong> (t√≠nh nh·∫•t qu√°n v√† ph√¢n v√πng ch·ªãu l·ªói), t·∫≠p trung v√†o t√≠nh nh·∫•t qu√°n. Khi d·ªØ li·ªáu trong c·ª•m kh√¥ng nh·∫•t qu√°n, h·ªá th·ªëng s·∫Ω kh√¥ng kh·∫£ d·ª•ng. Do ƒë√≥, <strong>Redis</strong>, <strong>Eureka</strong> ho·∫∑c <strong>Nacos</strong> s·∫Ω ph√π h·ª£p h∆°n ƒë·ªÉ l√†m trung t√¢m ƒëƒÉng k√Ω.</p><h2 id="quy-trinh-bau-chon-lanh-ƒëao-trong-zookeeper-la-gi" tabindex="-1"><a class="header-anchor" href="#quy-trinh-bau-chon-lanh-ƒëao-trong-zookeeper-la-gi"><span>Quy tr√¨nh b·∫ßu ch·ªçn l√£nh ƒë·∫°o trong Zookeeper l√† g√¨?</span></a></h2><p>ƒê·ªëi v·ªõi c·ª•m Zookeeper, to√†n b·ªô c·ª•m c·∫ßn ch·ªçn ra m·ªôt node l√†m <strong>Leader</strong>. Quy tr√¨nh t·ªïng qu√°t nh∆∞ sau:</p><ol><li>Ban ƒë·∫ßu, m·ªói node trong c·ª•m ƒë·ªÅu ·ªü tr·∫°ng th√°i <strong>LOOKING</strong> (ƒëang quan s√°t) v√† t·ª± b·ªè phi·∫øu cho m√¨nh v√¨ nghƒ© r·∫±ng m√¨nh ph√π h·ª£p nh·∫•t ƒë·ªÉ l√†m <strong>Leader</strong>.</li><li>Sau ƒë√≥, c√°c node s·∫Ω t∆∞∆°ng t√°c v·ªõi nhau ƒë·ªÉ b·ªè phi·∫øu. M·ªói node s·∫Ω nh·∫≠n ƒë∆∞·ª£c phi·∫øu b·∫ßu t·ª´ c√°c node kh√°c, v√† so s√°nh phi·∫øu, ƒë·∫ßu ti√™n so s√°nh <strong>zxid</strong> (Zookeeper Transaction ID), ai c√≥ <strong>zxid</strong> l·ªõn h∆°n s·∫Ω th·∫Øng. N·∫øu <strong>zxid</strong> b·∫±ng nhau th√¨ so s√°nh <strong>myid</strong> (ID c·ªßa m·ªói node), ai c√≥ <strong>myid</strong> l·ªõn h∆°n s·∫Ω th·∫Øng.</li><li>N·∫øu m·ªôt node nh·∫≠n ƒë∆∞·ª£c phi·∫øu b·∫ßu t·ª´ node kh√°c v√† sau khi so s√°nh th·∫•y m√¨nh thua, node ƒë√≥ s·∫Ω ƒë·ªïi phi·∫øu, b·∫ßu cho node c√≥ <strong>zxid</strong> ho·∫∑c <strong>myid</strong> l·ªõn h∆°n, v√† g·ª≠i phi·∫øu m·ªõi cho c√°c node kh√°c.</li><li>N·∫øu so s√°nh b·∫±ng nhau, node s·∫Ω gi·ªØ phi·∫øu v·ª´a nh·∫≠n v√†o h·ªôp phi·∫øu c·ªßa m√¨nh.</li><li>N·∫øu node th·∫Øng so s√°nh, n√≥ s·∫Ω b·ªè qua phi·∫øu b·∫ßu nh·∫≠n ƒë∆∞·ª£c.</li><li>M·ªói node s·∫Ω t√≠nh to√°n s·ªë phi·∫øu trong h·ªôp phi·∫øu c·ªßa m√¨nh. N·∫øu h∆°n m·ªôt n·ª≠a s·ªë node c√πng b·∫ßu cho m·ªôt node, th√¨ node ƒë√≥ s·∫Ω ƒë∆∞·ª£c ch·ªçn l√†m <strong>Leader</strong>.</li><li>T·∫•t c·∫£ c√°c node trong c·ª•m s·∫Ω th·ª±c hi·ªán c√πng quy tr√¨nh n√†y. Cu·ªëi c√πng, m·ªói node s·∫Ω ƒë·ªìng √Ω v·ªõi k·∫øt qu·∫£ v√† <strong>Leader</strong> c·ªßa c·ª•m s·∫Ω ƒë∆∞·ª£c ch·ªçn ra.</li></ol><h2 id="du-lieu-giua-cac-node-trong-cum-zookeeper-ƒëuoc-ƒëong-bo-hoa-nhu-the-nao" tabindex="-1"><a class="header-anchor" href="#du-lieu-giua-cac-node-trong-cum-zookeeper-ƒëuoc-ƒëong-bo-hoa-nhu-the-nao"><span>D·ªØ li·ªáu gi·ªØa c√°c node trong c·ª•m Zookeeper ƒë∆∞·ª£c ƒë·ªìng b·ªô h√≥a nh∆∞ th·∫ø n√†o?</span></a></h2><ol><li>Tr∆∞·ªõc ti√™n, c·ª•m s·∫Ω b·∫ßu ch·ªçn <strong>Leader</strong>, sau ƒë√≥ x√°c ƒë·ªãnh c√°c node l√† <strong>Follower</strong> v√† <strong>Observer</strong>.</li><li><strong>Leader</strong> s·∫Ω ti·∫øn h√†nh ƒë·ªìng b·ªô d·ªØ li·ªáu v·ªõi c√°c node kh√°c, th√¥ng qua vi·ªác g·ª≠i <strong>snapshot</strong> (b·∫£n sao ch·ª•p) v√† <strong>Diff log</strong> (b·∫£n ghi s·ª± kh√°c bi·ªát).</li><li>Trong qu√° tr√¨nh ho·∫°t ƒë·ªông, m·ªçi y√™u c·∫ßu ghi ƒë·ªÅu ƒë∆∞·ª£c g·ª≠i t·ªõi <strong>Leader</strong>, c√°c node kh√°c ch·ªâ x·ª≠ l√Ω y√™u c·∫ßu ƒë·ªçc.</li><li>Khi <strong>Leader</strong> nh·∫≠n ƒë∆∞·ª£c m·ªôt y√™u c·∫ßu ghi, n√≥ s·∫Ω s·ª≠ d·ª•ng c∆° ch·∫ø <strong>hai giai ƒëo·∫°n</strong> ƒë·ªÉ x·ª≠ l√Ω.</li><li><strong>Leader</strong> g·ª≠i b·∫£n ghi t∆∞∆°ng ·ª©ng v·ªõi y√™u c·∫ßu ghi t·ªõi c√°c <strong>Follower</strong> v√† ch·ªù c√°c <strong>Follower</strong> ghi b·∫£n ghi th√†nh c√¥ng.</li><li>Khi <strong>Follower</strong> nh·∫≠n ƒë∆∞·ª£c b·∫£n ghi, n√≥ s·∫Ω l∆∞u tr·ªØ b·∫£n ghi v√† g·ª≠i l·∫°i t√≠n hi·ªáu <strong>Ack</strong> cho <strong>Leader</strong> n·∫øu th√†nh c√¥ng.</li><li>Khi <strong>Leader</strong> nh·∫≠n ƒë∆∞·ª£c h∆°n m·ªôt n·ª≠a <strong>Ack</strong>, n√≥ s·∫Ω c·∫≠p nh·∫≠t d·ªØ li·ªáu b·ªô nh·ªõ c·ªßa m√¨nh v√† g·ª≠i l·ªánh <strong>commit</strong> cho c√°c <strong>Follower</strong>.</li><li>C√°c <strong>Follower</strong> sau khi nh·∫≠n l·ªánh <strong>commit</strong> s·∫Ω c·∫≠p nh·∫≠t d·ªØ li·ªáu b·ªô nh·ªõ c·ªßa m√¨nh.</li><li>ƒê·ªìng th·ªùi, <strong>Leader</strong> c≈©ng g·ª≠i tr·ª±c ti·∫øp y√™u c·∫ßu ghi t·ªõi c√°c <strong>Observer</strong>, v√† <strong>Observer</strong> ch·ªâ th·ª±c hi·ªán c·∫≠p nh·∫≠t d·ªØ li·ªáu b·ªô nh·ªõ m√† kh√¥ng c·∫ßn <strong>commit</strong>.</li><li>Cu·ªëi c√πng, <strong>Leader</strong> tr·∫£ l·∫°i ph·∫£n h·ªìi th√†nh c√¥ng cho client.</li><li>C∆° ch·∫ø ƒë·ªìng b·ªô v√† c∆° ch·∫ø hai giai ƒëo·∫°n ƒë·∫£m b·∫£o t√≠nh nh·∫•t qu√°n d·ªØ li·ªáu gi·ªØa c√°c node trong c·ª•m.</li></ol><h2 id="dubbo-ho-tro-nhung-chien-luoc-can-bang-tai-nao" tabindex="-1"><a class="header-anchor" href="#dubbo-ho-tro-nhung-chien-luoc-can-bang-tai-nao"><span>Dubbo h·ªó tr·ª£ nh·ªØng chi·∫øn l∆∞·ª£c c√¢n b·∫±ng t·∫£i n√†o?</span></a></h2><ol><li><strong>Ng·∫´u nhi√™n</strong>: L·ª±a ch·ªçn ng·∫´u nhi√™n m·ªôt d·ªãch v·ª• t·ª´ c√°c nh√† cung c·∫•p ƒë·ªÉ x·ª≠ l√Ω y√™u c·∫ßu. Khi s·ªë l∆∞·ª£ng g·ªçi tƒÉng l√™n, c√°c y√™u c·∫ßu s·∫Ω ƒë∆∞·ª£c ph√¢n ph·ªëi ƒë·ªÅu h∆°n, v√† c√≥ th·ªÉ thi·∫øt l·∫≠p x√°c su·∫•t ng·∫´u nhi√™n theo tr·ªçng s·ªë.</li><li><strong>V√≤ng l·∫∑p</strong>: L·ª±a ch·ªçn c√°c nh√† cung c·∫•p d·ªãch v·ª• l·∫ßn l∆∞·ª£t ƒë·ªÉ x·ª≠ l√Ω y√™u c·∫ßu, v√† h·ªó tr·ª£ c√¢n b·∫±ng theo tr·ªçng s·ªë, s·ª≠ d·ª•ng thu·∫≠t to√°n v√≤ng l·∫∑p c√≥ tr·ªçng s·ªë m∆∞·ª£t m√†.</li><li><strong>S·ªë l∆∞·ª£ng g·ªçi ho·∫°t ƒë·ªông √≠t nh·∫•t</strong>: Th·ªëng k√™ s·ªë l∆∞·ª£ng y√™u c·∫ßu m√† nh√† cung c·∫•p ƒëang x·ª≠ l√Ω, y√™u c·∫ßu m·ªõi s·∫Ω ƒë∆∞·ª£c g·ª≠i t·ªõi nh√† cung c·∫•p c√≥ s·ªë l∆∞·ª£ng ho·∫°t ƒë·ªông √≠t nh·∫•t.</li><li><strong>BƒÉm nh·∫•t qu√°n</strong>: C√°c y√™u c·∫ßu v·ªõi c√πng tham s·ªë s·∫Ω lu√¥n ƒë∆∞·ª£c g·ª≠i t·ªõi c√πng m·ªôt nh√† cung c·∫•p d·ªãch v·ª•.</li></ol><h2 id="dubbo-thuc-hien-xuat-dich-vu-nhu-the-nao" tabindex="-1"><a class="header-anchor" href="#dubbo-thuc-hien-xuat-dich-vu-nhu-the-nao"><span>Dubbo th·ª±c hi·ªán xu·∫•t d·ªãch v·ª• nh∆∞ th·∫ø n√†o?</span></a></h2><ol><li><strong>Dubbo</strong> s·∫Ω ph√¢n t√≠ch annotation <code>@DubboService</code> ho·∫∑c <code>@Service</code> ƒë·ªÉ l·∫•y c√°c tham s·ªë d·ªãch v·ª• m√† l·∫≠p tr√¨nh vi√™n ƒë√£ ƒë·ªãnh nghƒ©a, bao g·ªìm t√™n d·ªãch v·ª•, giao di·ªán d·ªãch v·ª•, th·ªùi gian ch·ªù, giao th·ª©c d·ªãch v·ª•, v.v., v√† t·∫°o ra m·ªôt <strong>ServiceBean</strong>.</li><li>Sau ƒë√≥ g·ªçi ph∆∞∆°ng th·ª©c <code>export</code> c·ªßa <strong>ServiceBean</strong> ƒë·ªÉ th·ª±c hi·ªán vi·ªác xu·∫•t d·ªãch v·ª•.</li><li><strong>Dubbo</strong> s·∫Ω ƒëƒÉng k√Ω th√¥ng tin d·ªãch v·ª• v√†o trung t√¢m ƒëƒÉng k√Ω. N·∫øu c√≥ nhi·ªÅu giao th·ª©c ho·∫∑c nhi·ªÅu trung t√¢m ƒëƒÉng k√Ω, d·ªãch v·ª• s·∫Ω ƒë∆∞·ª£c ƒëƒÉng k√Ω l·∫ßn l∆∞·ª£t theo t·ª´ng giao th·ª©c v√† t·ª´ng trung t√¢m.</li><li>Sau khi ƒëƒÉng k√Ω d·ªãch v·ª• v√†o trung t√¢m, <strong>Dubbo</strong> s·∫Ω g·∫Øn c√°c b·ªô l·∫Øng nghe ƒë·ªÉ theo d√µi s·ª± thay ƒë·ªïi t·ª´ trung t√¢m c·∫•u h√¨nh ƒë·ªông.</li><li>Cu·ªëi c√πng, d·ª±a tr√™n giao th·ª©c d·ªãch v·ª•, <strong>Dubbo</strong> s·∫Ω kh·ªüi ƒë·ªông c√°c m√°y ch·ªß Web ho·∫∑c c√°c framework m·∫°ng t∆∞∆°ng ·ª©ng nh∆∞ Tomcat, Netty, v.v.</li></ol><h2 id="dubbo-thuc-hien-nhap-dich-vu-nhu-the-nao" tabindex="-1"><a class="header-anchor" href="#dubbo-thuc-hien-nhap-dich-vu-nhu-the-nao"><span>Dubbo th·ª±c hi·ªán nh·∫≠p d·ªãch v·ª• nh∆∞ th·∫ø n√†o?</span></a></h2><ol><li>Khi l·∫≠p tr√¨nh vi√™n s·ª≠ d·ª•ng annotation <code>@Reference</code> ƒë·ªÉ nh·∫≠p d·ªãch v·ª•, <strong>Dubbo</strong> s·∫Ω ph√¢n t√≠ch c√∫ ph√°p c·ªßa annotation v√† th√¥ng tin d·ªãch v·ª• ƒë·ªÉ l·∫•y t√™n v√† giao di·ªán d·ªãch v·ª•.</li><li><strong>Dubbo</strong> s·∫Ω truy v·∫•n th√¥ng tin d·ªãch v·ª• t·ª´ trung t√¢m ƒëƒÉng k√Ω, l·∫•y th√¥ng tin nh√† cung c·∫•p d·ªãch v·ª• v√† l∆∞u v√†o danh m·ª•c d·ªãch v·ª• c·ªßa ph√≠a Consumer.</li><li><strong>Dubbo</strong> c≈©ng s·∫Ω g·∫Øn c√°c b·ªô l·∫Øng nghe ƒë·ªÉ theo d√µi s·ª± thay ƒë·ªïi t·ª´ trung t√¢m c·∫•u h√¨nh ƒë·ªông.</li><li>Cu·ªëi c√πng, <strong>Dubbo</strong> s·∫Ω t·∫°o ra m·ªôt ƒë·ªëi t∆∞·ª£ng proxy cho giao di·ªán d·ªãch v·ª• d·ª±a tr√™n th√¥ng tin nh√† cung c·∫•p v√† ƒë∆∞a v√†o Spring container nh∆∞ m·ªôt <strong>Bean</strong>.</li></ol><h2 id="kien-truc-cua-dubbo-la-gi" tabindex="-1"><a class="header-anchor" href="#kien-truc-cua-dubbo-la-gi"><span>Ki·∫øn tr√∫c c·ªßa Dubbo l√† g√¨?</span></a></h2><p>Dubbo c√≥ thi·∫øt k·∫ø ki·∫øn tr√∫c r·∫•t xu·∫•t s·∫Øc, ƒë∆∞·ª£c chia th√†nh nhi·ªÅu t·∫ßng v√† m·ªói t·∫ßng ƒë·ªÅu c√≥ th·ªÉ m·ªü r·ªông. C√°c t·∫ßng g·ªìm:</p><ol><li><strong>Proxy</strong> (t·∫ßng d·ªãch v·ª• proxy): H·ªó tr·ª£ c√°c c∆° ch·∫ø proxy nh∆∞ JDK dynamic proxy, javassist, v.v.</li><li><strong>Registry</strong> (t·∫ßng trung t√¢m ƒëƒÉng k√Ω): H·ªó tr·ª£ Zookeeper, Redis, v.v. l√†m trung t√¢m ƒëƒÉng k√Ω.</li><li><strong>Protocol</strong> (t·∫ßng g·ªçi t·ª´ xa): H·ªó tr·ª£ c√°c giao th·ª©c g·ªçi nh∆∞ Dubbo, Http, v.v.</li><li><strong>Transport</strong> (t·∫ßng truy·ªÅn t·∫£i m·∫°ng): H·ªó tr·ª£ c√°c framework truy·ªÅn t·∫£i m·∫°ng nh∆∞ Netty, Mina, v.v.</li><li><strong>Serialize</strong> (t·∫ßng tu·∫ßn t·ª± h√≥a d·ªØ li·ªáu): H·ªó tr·ª£ c√°c c∆° ch·∫ø tu·∫ßn t·ª± h√≥a nh∆∞ JSON, Hessian, v.v.</li></ol><h3 id="giai-thich-cac-tang" tabindex="-1"><a class="header-anchor" href="#giai-thich-cac-tang"><span>Gi·∫£i th√≠ch c√°c t·∫ßng:</span></a></h3><ul><li><strong>T·∫ßng c·∫•u h√¨nh</strong>: ƒê·ªëi v·ªõi giao di·ªán c·∫•u h√¨nh, t·∫≠p trung v√†o <code>ServiceConfig</code> v√† <code>ReferenceConfig</code>, c√≥ th·ªÉ tr·ª±c ti·∫øp kh·ªüi t·∫°o ho·∫∑c th√¥ng qua Spring ƒë·ªÉ ph√¢n t√≠ch c√∫ ph√°p v√† t·∫°o ra c√°c l·ªõp c·∫•u h√¨nh.</li><li><strong>T·∫ßng d·ªãch v·ª• proxy</strong>: Cung c·∫•p d·ªãch v·ª• proxy minh b·∫°ch cho c√°c d·ªãch v·ª•, t·∫°o ra Stub ·ªü ph√≠a client v√† Skeleton ·ªü ph√≠a server, v·ªõi <code>ServiceProxy</code> l√† trung t√¢m v√† <code>ProxyFactory</code> l√† giao di·ªán m·ªü r·ªông.</li><li><strong>T·∫ßng trung t√¢m ƒëƒÉng k√Ω</strong>: ƒê√≥ng g√≥i vi·ªác ƒëƒÉng k√Ω v√† ph√°t hi·ªán ƒë·ªãa ch·ªâ d·ªãch v·ª•, t·∫≠p trung v√†o URL d·ªãch v·ª•, giao di·ªán m·ªü r·ªông l√† <code>RegistryFactory</code>, <code>Registry</code>, v√† <code>RegistryService</code>.</li><li><strong>T·∫ßng ƒë·ªãnh tuy·∫øn</strong>: ƒê√≥ng g√≥i vi·ªác ƒë·ªãnh tuy·∫øn v√† c√¢n b·∫±ng t·∫£i cho nhi·ªÅu nh√† cung c·∫•p d·ªãch v·ª• v√† k·∫øt n·ªëi v·ªõi trung t√¢m ƒëƒÉng k√Ω, v·ªõi <code>Invoker</code> l√† trung t√¢m.</li><li><strong>T·∫ßng gi√°m s√°t</strong>: Theo d√µi s·ªë l∆∞·ª£ng v√† th·ªùi gian c·ªßa c√°c cu·ªôc g·ªçi RPC, v·ªõi <code>Statistics</code> l√† trung t√¢m.</li><li><strong>T·∫ßng g·ªçi t·ª´ xa</strong>: ƒê√≥ng g√≥i c√°c cu·ªôc g·ªçi RPC, v·ªõi <code>Invocation</code>, <code>Result</code> l√† trung t√¢m.</li><li><strong>T·∫ßng trao ƒë·ªïi th√¥ng tin</strong>: ƒê√≥ng g√≥i c√°c y√™u c·∫ßu/ƒë√°p ·ª©ng, chuy·ªÉn t·ª´ ƒë·ªìng b·ªô sang b·∫•t ƒë·ªìng b·ªô, v·ªõi <code>Request</code>, <code>Response</code> l√† trung t√¢m.</li><li><strong>T·∫ßng truy·ªÅn t·∫£i m·∫°ng</strong>: Tr·ª´u t∆∞·ª£ng h√≥a Netty v√† Mina th√†nh m·ªôt giao di·ªán th·ªëng nh·∫•t, v·ªõi <code>Message</code> l√† trung t√¢m.</li><li><strong>T·∫ßng tu·∫ßn t·ª± h√≥a d·ªØ li·ªáu</strong>: C√°c c√¥ng c·ª• c√≥ th·ªÉ t√°i s·ª≠ d·ª•ng, v·ªõi giao di·ªán m·ªü r·ªông l√† <code>Serialization</code>, <code>ObjectInput</code>, v√† <code>ObjectOutput</code>.</li></ul><h3 id="giai-thich-moi-quan-he" tabindex="-1"><a class="header-anchor" href="#giai-thich-moi-quan-he"><span>Gi·∫£i th√≠ch m·ªëi quan h·ªá</span></a></h3><ul><li>Trong RPC, <strong>Protocol</strong> l√† t·∫ßng c·ªët l√µi. Ch·ªâ c·∫ßn <strong>Protocol + Invoker + Exporter</strong> l√† c√≥ th·ªÉ th·ª±c hi·ªán cu·ªôc g·ªçi RPC kh√¥ng minh b·∫°ch. <strong>Invoker</strong> l√† ƒëi·ªÉm ch·∫∑n ch√≠nh c·ªßa qu√° tr√¨nh ch√≠nh.</li><li><strong>Consumer</strong> v√† <strong>Provider</strong> trong s∆° ƒë·ªì l√† kh√°i ni·ªám tr·ª´u t∆∞·ª£ng gi√∫p ng∆∞·ªùi xem d·ªÖ hi·ªÉu h∆°n v·ªÅ ph√¢n lo·∫°i c√°c l·ªõp thu·ªôc ph√≠a m√°y kh√°ch v√† m√°y ch·ªß. <strong>Provider</strong>, <strong>Consumer</strong>, <strong>Registry</strong>, v√† <strong>Monitor</strong> ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ chia logic c√°c node topo trong nhi·ªÅu ng·ªØ c·∫£nh kh√°c nhau, gi·ªØ kh√°i ni·ªám th·ªëng nh·∫•t.</li><li><strong>Cluster</strong> l√† kh√°i ni·ªám ngo·∫°i vi. M·ª•c ƒë√≠ch c·ªßa <strong>Cluster</strong> l√† gi·∫£ l·∫≠p nhi·ªÅu <strong>Invoker</strong> th√†nh m·ªôt <strong>Invoker</strong> ƒë·ªÉ c√°c t·∫ßng kh√°c ch·ªâ c·∫ßn quan t√¢m ƒë·∫øn t·∫ßng <strong>Invoker</strong> c·ªßa <strong>Protocol</strong>. Th√™m ho·∫∑c b·ªõt <strong>Cluster</strong> s·∫Ω kh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c t·∫ßng kh√°c v√¨ khi ch·ªâ c√≥ m·ªôt nh√† cung c·∫•p, <strong>Cluster</strong> kh√¥ng c·∫ßn thi·∫øt.</li><li>T·∫ßng <strong>Proxy</strong> ƒë√≥ng g√≥i proxy minh b·∫°ch cho t·∫•t c·∫£ giao di·ªán, v√† ·ªü c√°c t·∫ßng kh√°c ƒë·ªÅu t·∫≠p trung v√†o <strong>Invoker</strong>. Khi l·ªô ra cho ng∆∞·ªùi d√πng s·ª≠ d·ª•ng, <strong>Proxy</strong> s·∫Ω chuy·ªÉn <strong>Invoker</strong> th√†nh giao di·ªán ho·∫∑c chuy·ªÉn vi·ªác th·ª±c hi·ªán giao di·ªán th√†nh <strong>Invoker</strong>. Lo·∫°i b·ªè t·∫ßng <strong>Proxy</strong>, RPC v·∫´n ch·∫°y ƒë∆∞·ª£c, ch·ªâ l√† kh√¥ng minh b·∫°ch v√† kh√¥ng gi·ªëng vi·ªác g·ªçi d·ªãch v·ª• c·ª•c b·ªô.</li><li><strong>Remoting</strong> l√† s·ª± th·ª±c hi·ªán c·ªßa giao th·ª©c <strong>Dubbo</strong>. N·∫øu b·∫°n ch·ªçn giao th·ª©c <strong>RMI</strong>, to√†n b·ªô <strong>Remoting</strong> s·∫Ω kh√¥ng ƒë∆∞·ª£c s·ª≠ d·ª•ng. <strong>Remoting</strong> ƒë∆∞·ª£c chia th√†nh t·∫ßng <strong>Transport</strong> (truy·ªÅn t·∫£i) v√† t·∫ßng <strong>Exchange</strong> (trao ƒë·ªïi th√¥ng tin). <strong>Transport</strong> ch·ªâ ch·ªãu tr√°ch nhi·ªám truy·ªÅn t·∫£i th√¥ng ƒëi·ªáp m·ªôt chi·ªÅu, tr·ª´u t∆∞·ª£ng h√≥a Mina, Netty, Grizzly, v√† c√≥ th·ªÉ m·ªü r·ªông truy·ªÅn t·∫£i UDP. <strong>Exchange</strong> ƒë√≥ng g√≥i ng·ªØ nghƒ©a y√™u c·∫ßu-ƒë√°p ·ª©ng tr√™n t·∫ßng <strong>Transport</strong>.</li><li><strong>Registry</strong> v√† <strong>Monitor</strong> th·ª±c ch·∫•t kh√¥ng ph·∫£i l√† m·ªôt t·∫ßng m√† l√† m·ªôt node ƒë·ªôc l·∫≠p. Ch√∫ng ƒë∆∞·ª£c v·∫Ω th√†nh t·∫ßng ƒë·ªÉ cung c·∫•p c√°i nh√¨n t·ªïng quan.</li></ul><figure><img src="https://cdn.nlark.com/yuque/0/2021/jpeg/365147/1626176708107-3ad83a45-25b3-403e-beaf-02185e787ff9.jpeg" alt="S∆° ƒë·ªì ki·∫øn tr√∫c Dubbo" tabindex="0" loading="lazy"><figcaption>S∆° ƒë·ªì ki·∫øn tr√∫c Dubbo</figcaption></figure><h2 id="cac-thuat-toan-can-bang-tai" tabindex="-1"><a class="header-anchor" href="#cac-thuat-toan-can-bang-tai"><span>C√°c thu·∫≠t to√°n c√¢n b·∫±ng t·∫£i:</span></a></h2><ol><li><strong>Round Robin</strong> (C√¢n b·∫±ng v√≤ng): Y√™u c·∫ßu ƒë∆∞·ª£c ph√¢n ph·ªëi l·∫ßn l∆∞·ª£t theo th·ª© t·ª± ƒë·∫øn c√°c m√°y ch·ªß ph√≠a sau. Ph∆∞∆°ng ph√°p n√†y ƒë·ªëi x·ª≠ c√¥ng b·∫±ng v·ªõi t·ª´ng m√°y ch·ªß m√† kh√¥ng quan t√¢m ƒë·∫øn s·ªë l∆∞·ª£ng k·∫øt n·ªëi th·ª±c t·∫ø hay t·∫£i h·ªá th·ªëng hi·ªán t·∫°i c·ªßa c√°c m√°y ch·ªß.</li><li><strong>Random</strong> (Ng·∫´u nhi√™n): S·ª≠ d·ª•ng thu·∫≠t to√°n ng·∫´u nhi√™n c·ªßa h·ªá th·ªëng, ch·ªçn ng·∫´u nhi√™n m·ªôt m√°y ch·ªß trong danh s√°ch ƒë·ªÉ truy c·∫≠p. Theo l√Ω thuy·∫øt x√°c su·∫•t, khi s·ªë l∆∞·ª£ng y√™u c·∫ßu t·ª´ ph√≠a m√°y kh√°ch tƒÉng l√™n, k·∫øt qu·∫£ th·ª±c t·∫ø s·∫Ω ti·∫øn g·∫ßn ƒë·∫øn vi·ªác ph√¢n ph·ªëi ƒë·ªÅu c√°c y√™u c·∫ßu cho t·∫•t c·∫£ c√°c m√°y ch·ªß, t∆∞∆°ng t·ª± nh∆∞ ph∆∞∆°ng ph√°p v√≤ng l·∫∑p.</li><li><strong>Source IP Hash</strong> (BƒÉm theo ƒë·ªãa ch·ªâ IP ngu·ªìn): D·ª±a tr√™n ƒë·ªãa ch·ªâ IP c·ªßa m√°y kh√°ch, t√≠nh to√°n m·ªôt gi√° tr·ªã th√¥ng qua h√†m bƒÉm, sau ƒë√≥ s·ª≠ d·ª•ng gi√° tr·ªã n√†y ƒë·ªÉ chia cho k√≠ch th∆∞·ªõc danh s√°ch m√°y ch·ªß, k·∫øt qu·∫£ s·∫Ω cho ra s·ªë th·ª© t·ª± c·ªßa m√°y ch·ªß m√† m√°y kh√°ch s·∫Ω truy c·∫≠p. Khi danh s√°ch m√°y ch·ªß kh√¥ng thay ƒë·ªïi, c√πng m·ªôt ƒë·ªãa ch·ªâ IP s·∫Ω lu√¥n ƒë∆∞·ª£c √°nh x·∫° ƒë·∫øn c√πng m·ªôt m√°y ch·ªß.</li><li><strong>Weighted Round Robin</strong> (C√¢n b·∫±ng v√≤ng c√≥ tr·ªçng s·ªë): C√°c m√°y ch·ªß ph√≠a sau c√≥ c·∫•u h√¨nh v√† t·∫£i h·ªá th·ªëng kh√°c nhau, do ƒë√≥ kh·∫£ nƒÉng ch·ªãu t·∫£i c≈©ng kh√¥ng gi·ªëng nhau. Ph∆∞∆°ng ph√°p n√†y g√°n tr·ªçng s·ªë cao h∆°n cho c√°c m√°y ch·ªß c√≥ c·∫•u h√¨nh m·∫°nh v√† t·∫£i nh·∫π, ƒë·ªÉ ch√∫ng x·ª≠ l√Ω nhi·ªÅu y√™u c·∫ßu h∆°n; trong khi c√°c m√°y ch·ªß c√≥ c·∫•u h√¨nh y·∫øu v√† t·∫£i n·∫∑ng ƒë∆∞·ª£c g√°n tr·ªçng s·ªë th·∫•p h∆°n ƒë·ªÉ gi·∫£m b·ªõt t·∫£i. Ph∆∞∆°ng ph√°p n√†y gi√∫p ph√¢n ph·ªëi y√™u c·∫ßu m·ªôt c√°ch h·ª£p l√Ω theo tr·ªçng s·ªë.</li><li><strong>Weighted Random</strong> (Ng·∫´u nhi√™n c√≥ tr·ªçng s·ªë): T∆∞∆°ng t·ª± ph∆∞∆°ng ph√°p v√≤ng l·∫∑p c√≥ tr·ªçng s·ªë, nh∆∞ng thay v√¨ ph√¢n ph·ªëi y√™u c·∫ßu theo th·ª© t·ª±, c√°c y√™u c·∫ßu ƒë∆∞·ª£c ph√¢n ph·ªëi ng·∫´u nhi√™n d·ª±a tr√™n tr·ªçng s·ªë c·ªßa m√°y ch·ªß.</li><li><strong>Least Connections</strong> (√çt k·∫øt n·ªëi nh·∫•t): ƒê√¢y l√† m·ªôt thu·∫≠t to√°n linh ho·∫°t v√† th√¥ng minh h∆°n. N√≥ l·ª±a ch·ªçn m√°y ch·ªß d·ª±a tr√™n s·ªë l∆∞·ª£ng k·∫øt n·ªëi hi·ªán t·∫°i c·ªßa c√°c m√°y ch·ªß, ch·ªçn m√°y ch·ªß c√≥ s·ªë l∆∞·ª£ng k·∫øt n·ªëi √≠t nh·∫•t ƒë·ªÉ x·ª≠ l√Ω y√™u c·∫ßu. Ph∆∞∆°ng ph√°p n√†y gi√∫p tƒÉng hi·ªáu su·∫•t s·ª≠ d·ª•ng c·ªßa m√°y ch·ªß v√† ph√¢n ph·ªëi t·∫£i h·ª£p l√Ω gi·ªØa c√°c m√°y ch·ªß.</li></ol><h2 id="giai-phap-chia-se-session-trong-kien-truc-phan-tan" tabindex="-1"><a class="header-anchor" href="#giai-phap-chia-se-session-trong-kien-truc-phan-tan"><span>Gi·∫£i ph√°p chia s·∫ª Session trong ki·∫øn tr√∫c ph√¢n t√°n</span></a></h2><ol><li><p>S·ª≠ d·ª•ng d·ªãch v·ª• kh√¥ng tr·∫°ng th√°i, lo·∫°i b·ªè Session.</p></li><li><p>L∆∞u v√†o cookie (c√≥ nguy c∆° v·ªÅ b·∫£o m·∫≠t).</p></li><li><p>ƒê·ªìng b·ªô Session gi·ªØa c√°c m√°y ch·ªß. ƒêi·ªÅu n√†y ƒë·∫£m b·∫£o m·ªói m√°y ch·ªß ƒë·ªÅu c√≥ th√¥ng tin Session, nh∆∞ng khi s·ªë l∆∞·ª£ng m√°y ch·ªß l·ªõn, vi·ªác ƒë·ªìng b·ªô s·∫Ω c√≥ ƒë·ªô tr·ªÖ ho·∫∑c th·∫≠m ch√≠ th·∫•t b·∫°i.</p></li><li><p>S·ª≠ d·ª•ng ch√≠nh s√°ch r√†ng bu·ªôc IP.</p><ul><li>S·ª≠ d·ª•ng <strong>Nginx</strong> (ho·∫∑c c√°c ph·∫ßn m·ªÅm v√† ph·∫ßn c·ª©ng c√¢n b·∫±ng t·∫£i ph·ª©c t·∫°p kh√°c) v·ªõi ch√≠nh s√°ch r√†ng bu·ªôc IP. M·ªói IP ch·ªâ ƒë∆∞·ª£c truy c·∫≠p c√πng m·ªôt m√°y ch·ªß. Tuy nhi√™n, ƒëi·ªÅu n√†y l√†m m·∫•t √Ω nghƒ©a c·ªßa c√¢n b·∫±ng t·∫£i v√† khi m·ªôt m√°y ch·ªß b·ªã h·ªèng, m·ªôt s·ªë l∆∞·ª£ng l·ªõn ng∆∞·ªùi d√πng s·∫Ω b·ªã ·∫£nh h∆∞·ªüng, t·∫°o ra r·ªßi ro l·ªõn.</li></ul></li><li><p>S·ª≠ d·ª•ng Redis ƒë·ªÉ l∆∞u tr·ªØ Session.</p><p>L∆∞u Session v√†o Redis gi√∫p tƒÉng t√≠nh ph·ª©c t·∫°p c·ªßa ki·∫øn tr√∫c v√† c·∫ßn th√™m m·ªôt l·∫ßn truy c·∫≠p Redis, nh∆∞ng n√≥ mang l·∫°i nhi·ªÅu l·ª£i √≠ch:</p><ul><li>Th·ª±c hi·ªán chia s·∫ª Session.</li><li>C√≥ th·ªÉ m·ªü r·ªông ngang (th√™m m√°y ch·ªß Redis).</li><li>Server kh·ªüi ƒë·ªông l·∫°i kh√¥ng l√†m m·∫•t Session (c·∫ßn ch√∫ √Ω c∆° ch·∫ø l√†m m·ªõi/h·∫øt h·∫°n Session trong Redis).</li><li>Kh√¥ng ch·ªâ chia s·∫ª Session gi·ªØa c√°c server, m√† c√≤n c√≥ th·ªÉ chia s·∫ª gi·ªØa c√°c n·ªÅn t·∫£ng (v√≠ d·ª•: gi·ªØa trang web v√† ·ª©ng d·ª•ng di ƒë·ªông).</li></ul></li></ol><h2 id="cach-thuc-hien-tinh-idempotency-cho-api" tabindex="-1"><a class="header-anchor" href="#cach-thuc-hien-tinh-idempotency-cho-api"><span>C√°ch th·ª±c hi·ªán t√≠nh idempotency cho API</span></a></h2><ul><li><strong>ID duy nh·∫•t:</strong> M·ªói l·∫ßn thao t√°c, t·∫°o m·ªôt ID duy nh·∫•t d·ª±a tr√™n thao t√°c v√† n·ªôi dung. Tr∆∞·ªõc khi th·ª±c hi·ªán, ki·ªÉm tra xem ID n√†y ƒë√£ t·ªìn t·∫°i ch∆∞a. N·∫øu ch∆∞a t·ªìn t·∫°i, th·ª±c hi·ªán thao t√°c v√† l∆∞u v√†o c∆° s·ªü d·ªØ li·ªáu ho·∫∑c Redis.</li><li><strong>Token t·ª´ server:</strong> M√°y ch·ªß cung c·∫•p m·ªôt API ƒë·ªÉ g·ª≠i token. Tr∆∞·ªõc khi g·ªçi API x·ª≠ l√Ω nghi·ªáp v·ª•, l·∫•y token tr∆∞·ªõc r·ªìi g·ª≠i c√πng v·ªõi y√™u c·∫ßu. M√°y ch·ªß s·∫Ω ki·ªÉm tra xem token c√≥ t·ªìn t·∫°i trong Redis hay kh√¥ng. N·∫øu t·ªìn t·∫°i, nghƒ©a l√† ƒë√¢y l√† l·∫ßn ƒë·∫ßu ti√™n th·ª±c hi·ªán y√™u c·∫ßu, ti·∫øp t·ª•c x·ª≠ l√Ω v√† x√≥a token trong Redis sau khi ho√†n th√†nh.</li><li><strong>B·∫£ng lo·∫°i b·ªè tr√πng l·∫∑p:</strong> L∆∞u tr·ªØ c√°c tr∆∞·ªùng c√≥ ƒë·ªãnh danh duy nh·∫•t v√†o m·ªôt b·∫£ng lo·∫°i b·ªè tr√πng l·∫∑p. N·∫øu b·∫£ng n√†y ƒë√£ c√≥ d·ªØ li·ªáu, t·ª©c l√† thao t√°c ƒë√£ ƒë∆∞·ª£c x·ª≠ l√Ω tr∆∞·ªõc ƒë√≥.</li><li><strong>Ki·ªÉm so√°t phi√™n b·∫£n:</strong> Th√™m s·ªë phi√™n b·∫£n. Ch·ªâ khi s·ªë phi√™n b·∫£n h·ª£p l·ªá th√¨ m·ªõi ƒë∆∞·ª£c ph√©p c·∫≠p nh·∫≠t d·ªØ li·ªáu.</li><li><strong>Ki·ªÉm so√°t tr·∫°ng th√°i:</strong> V√≠ d·ª•, ƒë∆°n h√†ng c√≥ c√°c tr·∫°ng th√°i nh∆∞ &quot;ƒê√£ thanh to√°n,&quot; &quot;Ch∆∞a thanh to√°n,&quot; &quot;ƒêang thanh to√°n,&quot; v√† &quot;Thanh to√°n th·∫•t b·∫°i.&quot; Ch·ªâ khi ·ªü tr·∫°ng th√°i &quot;Ch∆∞a thanh to√°n&quot; m·ªõi ƒë∆∞·ª£c ph√©p chuy·ªÉn sang &quot;ƒêang thanh to√°n&quot; ho·∫∑c c√°c tr·∫°ng th√°i kh√°c.</li></ul><h2 id="tong-quan-ve-dich-vu-ƒëat-ten-quan-ly-cau-hinh-va-quan-ly-cum-trong-zookeeper" tabindex="-1"><a class="header-anchor" href="#tong-quan-ve-dich-vu-ƒëat-ten-quan-ly-cau-hinh-va-quan-ly-cum-trong-zookeeper"><span>T·ªïng quan v·ªÅ d·ªãch v·ª• ƒë·∫∑t t√™n, qu·∫£n l√Ω c·∫•u h√¨nh v√† qu·∫£n l√Ω c·ª•m trong Zookeeper</span></a></h2><ul><li><p><strong>D·ªãch v·ª• ƒë·∫∑t t√™n:</strong> D·ªãch v·ª• n√†y cung c·∫•p c√°ch l·∫•y t√†i nguy√™n ho·∫∑c ƒë·ªãa ch·ªâ d·ªãch v·ª• th√¥ng qua m·ªôt t√™n c·ª• th·ªÉ. Zookeeper c√≥ th·ªÉ t·∫°o ra m·ªôt ƒë∆∞·ªùng d·∫´n duy nh·∫•t to√†n c·∫ßu, ƒë∆∞·ªùng d·∫´n n√†y c√≥ th·ªÉ ƒë∆∞·ª£c coi l√† m·ªôt t√™n. C√°c th·ª±c th·ªÉ ƒë∆∞·ª£c ƒë·∫∑t t√™n c√≥ th·ªÉ l√† c√°c m√°y trong c·ª•m, ƒë·ªãa ch·ªâ d·ªãch v·ª•, ho·∫∑c ƒë·ªëi t∆∞·ª£ng t·ª´ xa. M·ªôt s·ªë framework ph√¢n t√°n nh∆∞ RPC, RMI s·ª≠ d·ª•ng d·ªãch v·ª• ƒë·∫∑t t√™n ƒë·ªÉ gi√∫p ·ª©ng d·ª•ng kh√°ch l·∫•y ƒë∆∞·ª£c t√†i nguy√™n ho·∫∑c th√¥ng tin v·ªÅ ƒë·ªãa ch·ªâ d·ªãch v·ª• theo t√™n.</p></li><li><p><strong>Qu·∫£n l√Ω c·∫•u h√¨nh:</strong> Trong ph√°t tri·ªÉn d·ª± √°n th·ª±c t·∫ø, c√°c t·ªáp c·∫•u h√¨nh nh∆∞ .properties ho·∫∑c .xml th∆∞·ªùng ch·ª©a c√°c th√¥ng tin quan tr·ªçng nh∆∞ c·∫•u h√¨nh k·∫øt n·ªëi c∆° s·ªü d·ªØ li·ªáu, ƒë·ªãa ch·ªâ FPS, c·ªïng, v.v. Khi tri·ªÉn khai ch∆∞∆°ng tr√¨nh theo c√°ch ph√¢n t√°n, n·∫øu l∆∞u c√°c th√¥ng tin c·∫•u h√¨nh n√†y v√†o Zookeeper (trong c√°c znode), khi c·∫ßn thay ƒë·ªïi c·∫•u h√¨nh, c√≥ th·ªÉ c·∫≠p nh·∫≠t znode. Nh·ªù c∆° ch·∫ø watcher, c√°c thay ƒë·ªïi s·∫Ω ƒë∆∞·ª£c th√¥ng b√°o ƒë·∫øn t·∫•t c·∫£ c√°c m√°y kh√°ch ƒë·ªÉ c·∫≠p nh·∫≠t c·∫•u h√¨nh.</p></li><li><p><strong>Qu·∫£n l√Ω c·ª•m:</strong> Qu·∫£n l√Ω c·ª•m bao g·ªìm gi√°m s√°t v√† ki·ªÉm so√°t c·ª•m, t·ª©c l√† gi√°m s√°t tr·∫°ng th√°i c·ªßa c√°c m√°y trong c·ª•m, lo·∫°i b·ªè ho·∫∑c th√™m m√°y m·ªõi. Zookeeper gi√∫p qu·∫£n l√Ω c·ª•m m·ªôt c√°ch hi·ªáu qu·∫£ b·∫±ng c√°ch gi√°m s√°t s·ª± thay ƒë·ªïi c·ªßa c√°c znode. Khi ph√°t hi·ªán m·ªôt m√°y b·ªã ng·∫Øt k·∫øt n·ªëi, znode t·∫°m th·ªùi t∆∞∆°ng ·ª©ng s·∫Ω b·ªã x√≥a v√† th√¥ng b√°o ƒë∆∞·ª£c g·ª≠i ƒë·∫øn t·∫•t c·∫£ c√°c m√°y kh√°c. Th√™m m√°y m·ªõi v√†o c·ª•m c≈©ng di·ªÖn ra t∆∞∆°ng t·ª±.</p></li></ul><h2 id="co-che-watch-trong-zookeeper" tabindex="-1"><a class="header-anchor" href="#co-che-watch-trong-zookeeper"><span>C∆° ch·∫ø Watch trong Zookeeper</span></a></h2><p>M√°y kh√°ch c√≥ th·ªÉ thi·∫øt l·∫≠p watch tr√™n c√°c znode ƒë·ªÉ theo d√µi s·ª± thay ƒë·ªïi trong th·ªùi gian th·ª±c.</p><p>Watch l√† m·ªôt tr√¨nh k√≠ch ho·∫°t m·ªôt l·∫ßn. Khi d·ªØ li·ªáu m√† watch ƒë∆∞·ª£c thi·∫øt l·∫≠p thay ƒë·ªïi, Zookeeper s·∫Ω g·ª≠i th√¥ng b√°o v·ªÅ thay ƒë·ªïi n√†y cho m√°y kh√°ch ƒë√£ thi·∫øt l·∫≠p watch.</p><ul><li>Vi·ªác t·∫°o, s·ª≠a ƒë·ªïi, ho·∫∑c x√≥a n√∫t cha s·∫Ω k√≠ch ho·∫°t s·ª± ki·ªán Watcher.</li><li>Vi·ªác t·∫°o ho·∫∑c x√≥a c√°c n√∫t con c≈©ng s·∫Ω k√≠ch ho·∫°t s·ª± ki·ªán Watcher.</li></ul><p><strong>T√≠nh m·ªôt l·∫ßn:</strong> M·ªôt khi watch b·ªã k√≠ch ho·∫°t, n√≥ s·∫Ω b·ªã x√≥a. ƒê·ªÉ theo d√µi ti·∫øp t·ª•c, ph·∫£i ƒëƒÉng k√Ω l·∫°i watch. C∆° ch·∫ø n√†y gi√∫p gi·∫£m t·∫£i h·ªá th·ªëng, v√¨ m·ªói thay ƒë·ªïi ch·ªâ c·∫ßn th√¥ng b√°o m·ªôt l·∫ßn cho t·∫•t c·∫£ c√°c m√°y kh√°ch. T·ª´ phi√™n b·∫£n 3.6.0, Zookeeper h·ªó tr·ª£ watch ƒë·ªá quy v√† c√≥ th·ªÉ k√≠ch ho·∫°t nhi·ªÅu l·∫ßn.</p><p><strong>T√≠nh nh·∫π:</strong> Watch ch·ªâ th√¥ng b√°o r·∫±ng c√≥ s·ª± ki·ªán x·∫£y ra m√† kh√¥ng g·ª≠i k√®m th√¥ng tin chi ti·∫øt, gi√∫p gi·∫£m t·∫£i cho m√°y ch·ªß v√† ti·∫øt ki·ªám bƒÉng th√¥ng.</p><p>C∆° ch·∫ø Watch g·ªìm ba th√†nh ph·∫ßn ch√≠nh: lu·ªìng c·ªßa m√°y kh√°ch, <strong>WatchManager</strong> tr√™n m√°y kh√°ch, v√† m√°y ch·ªß Zookeeper.</p><ol><li>M√°y kh√°ch ƒëƒÉng k√Ω m·ªôt Watcher v·ªõi m√°y ch·ªß Zookeeper.</li><li>Th√¥ng tin v·ªÅ Watcher ƒë∆∞·ª£c l∆∞u v√†o <strong>WatchManager</strong> c·ªßa m√°y kh√°ch.</li><li>Khi m·ªôt znode trong Zookeeper thay ƒë·ªïi, m√°y ch·ªß s·∫Ω th√¥ng b√°o cho m√°y kh√°ch, v√† m√°y kh√°ch s·∫Ω g·ªçi ph∆∞∆°ng th·ª©c callback trong Watcher t∆∞∆°ng ·ª©ng ƒë·ªÉ x·ª≠ l√Ω s·ª± ki·ªán.</li></ol><h2 id="su-khac-biet-giua-zookeeper-va-eureka" tabindex="-1"><a class="header-anchor" href="#su-khac-biet-giua-zookeeper-va-eureka"><span>S·ª± kh√°c bi·ªát gi·ªØa Zookeeper v√† Eureka</span></a></h2><ul><li><p><strong>Zookeeper (ZK):</strong> Zookeeper ƒë∆∞·ª£c thi·∫øt k·∫ø d·ª±a tr√™n nguy√™n t·∫Øc CP (Consistency &amp; Partition tolerance - T√≠nh nh·∫•t qu√°n v√† kh·∫£ nƒÉng ch·ªãu ph√¢n v√πng). M·ª•c ti√™u c·ªßa ZK l√† tr·ªü th√†nh h·ªá th·ªëng ƒëi·ªÅu ph·ªëi ph√¢n t√°n, d√πng ƒë·ªÉ qu·∫£n l√Ω t√†i nguy√™n th·ªëng nh·∫•t. Khi m·ªôt n√∫t b·ªã crash, c·∫ßn ph·∫£i th·ª±c hi·ªán b·∫ßu ch·ªçn leader, trong kho·∫£ng th·ªùi gian n√†y, d·ªãch v·ª• ZK s·∫Ω kh√¥ng th·ªÉ s·ª≠ d·ª•ng.</p></li><li><p><strong>Eureka:</strong> Eureka ƒë∆∞·ª£c thi·∫øt k·∫ø d·ª±a tr√™n nguy√™n t·∫Øc AP (Availability &amp; Partition tolerance - T√≠nh kh·∫£ d·ª•ng v√† kh·∫£ nƒÉng ch·ªãu ph√¢n v√πng). M·ª•c ti√™u c·ªßa Eureka l√† tr·ªü th√†nh h·ªá th·ªëng ƒëƒÉng k√Ω v√† ph√°t hi·ªán d·ªãch v·ª•, chuy√™n d√πng trong ki·∫øn tr√∫c microservices. C√°c n√∫t trong Eureka ƒë·ªÅu b√¨nh ƒë·∫≥ng, vi·ªác m·ªôt v√†i n√∫t b·ªã h·ªèng s·∫Ω kh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c n√∫t kh√°c. C√°c n√∫t c√≤n l·∫°i v·∫´n c√≥ th·ªÉ cung c·∫•p d·ªãch v·ª• ƒëƒÉng k√Ω v√† truy v·∫•n. N·∫øu m·ªôt n√∫t Eureka b·ªã ng·∫Øt k·∫øt n·ªëi, m√°y kh√°ch s·∫Ω t·ª± ƒë·ªông chuy·ªÉn sang n√∫t kh√°c. Mi·ªÖn l√† c√≥ √≠t nh·∫•t m·ªôt n√∫t Eureka c√≤n ho·∫°t ƒë·ªông, d·ªãch v·ª• ƒëƒÉng k√Ω v·∫´n c√≥ th·ªÉ s·ª≠ d·ª•ng, m·∫∑c d√π th√¥ng tin c√≥ th·ªÉ kh√¥ng ph·∫£i l√† m·ªõi nh·∫•t (kh√¥ng ƒë·∫£m b·∫£o t√≠nh nh·∫•t qu√°n m·∫°nh).</p></li></ul><p>Ngo√†i ra, khi m√°y ch·ªß Eureka ph√°t hi·ªán h∆°n 85% d·ªãch v·ª• kh√¥ng c√≥ t√≠n hi·ªáu heartbeat, n√≥ s·∫Ω cho r·∫±ng m·∫°ng c·ªßa m√¨nh g·∫∑p v·∫•n ƒë·ªÅ v√† s·∫Ω kh√¥ng x√≥a c√°c d·ªãch v·ª• n√†y kh·ªèi danh s√°ch. ƒê·ªìng th·ªùi, m√°y kh√°ch Eureka c≈©ng s·∫Ω l∆∞u tr·ªØ th√¥ng tin d·ªãch v·ª• trong b·ªô ƒë·ªám. ƒêi·ªÅu n√†y gi√∫p Eureka tr·ªü th√†nh l·ª±a ch·ªçn t·ªët cho vi·ªác ph√°t hi·ªán v√† ƒëƒÉng k√Ω d·ªãch v·ª•.</p><h2 id="cach-giai-quyet-van-ƒëe-khoa-chinh-duy-nhat-sau-khi-tach-bang" tabindex="-1"><a class="header-anchor" href="#cach-giai-quyet-van-ƒëe-khoa-chinh-duy-nhat-sau-khi-tach-bang"><span>C√°ch gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ kh√≥a ch√≠nh duy nh·∫•t sau khi t√°ch b·∫£ng</span></a></h2><ul><li><strong>UUID:</strong> ƒê∆°n gi·∫£n, hi·ªáu su·∫•t t·ªët, kh√¥ng c√≥ th·ª© t·ª±, kh√¥ng ch·ª©a th√¥ng tin nghi·ªáp v·ª•, c√≥ r·ªßi ro r√≤ r·ªâ ƒë·ªãa ch·ªâ MAC.</li><li><strong>Kh√≥a ch√≠nh t·ª´ c∆° s·ªü d·ªØ li·ªáu:</strong> D·ªÖ th·ª±c hi·ªán, tƒÉng d·∫ßn, c√≥ t√≠nh ƒë·ªçc hi·ªÉu theo nghi·ªáp v·ª•, ph·ª• thu·ªôc v√†o c∆° s·ªü d·ªØ li·ªáu, c√≥ nguy c∆° g√¢y ngh·∫Ωn hi·ªáu su·∫•t, c√≥ th·ªÉ l√†m l·ªô th√¥ng tin nghi·ªáp v·ª•.</li><li><strong>Redis, MongoDB, Zookeeper:</strong> TƒÉng ƒë·ªô ph·ª©c t·∫°p v√† ƒë√≤i h·ªèi s·ª± ·ªïn ƒë·ªãnh cao h∆°n cho h·ªá th·ªëng.</li><li><strong>Thu·∫≠t to√°n Snowflake:</strong></li></ul><h2 id="nguyen-ly-cua-thuat-toan-snowflake" tabindex="-1"><a class="header-anchor" href="#nguyen-ly-cua-thuat-toan-snowflake"><span>Nguy√™n l√Ω c·ªßa thu·∫≠t to√°n Snowflake</span></a></h2><figure><img src="https://cdn.nlark.com/yuque/0/2021/png/365147/1627449092303-9281aa79-94f4-4eae-9ddc-22e5b53eed2e.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Thu·∫≠t to√°n Snowflake t·∫°o ID v·ªõi c·∫•u tr√∫c sau:</p><ul><li>Bit ƒë·∫ßu ti√™n l√† bit d·∫•u, c·ªë ƒë·ªãnh l√† 0.</li><li>41 bit ti·∫øp theo l√† th·ªùi gian, t√≠nh t·ª´ m·ªëc th·ªùi gian c·ªë ƒë·ªãnh.</li><li>10 bit l√† workId (ID c·ªßa m√°y).</li><li>12 bit cu·ªëi c√πng l√† s·ªë th·ª© t·ª± tƒÉng d·∫ßn trong m·ªói mili gi√¢y.</li></ul><p><strong>∆Øu ƒëi·ªÉm:</strong> M·ªói mili gi√¢y c√≥ th·ªÉ t·∫°o ra nhi·ªÅu ID, d·ªÖ d√†ng ƒëi·ªÅu ch·ªânh theo y√™u c·∫ßu c·ªßa h·ªá th·ªëng. Hi·ªáu su·∫•t t·ªët v√† ID tƒÉng d·∫ßn theo th·ªùi gian, c√≥ th·ªÉ t√πy ch·ªânh s·ªë l∆∞·ª£ng bit ƒë·ªÉ linh ho·∫°t theo y√™u c·∫ßu b·ªë tr√≠ c∆° s·ªü d·ªØ li·ªáu.</p><p><strong>Nh∆∞·ª£c ƒëi·ªÉm:</strong> Ph·ª• thu·ªôc nhi·ªÅu v√†o ƒë·ªìng h·ªì c·ªßa m√°y. N·∫øu ƒë·ªìng h·ªì b·ªã l√πi th·ªùi gian, c√≥ th·ªÉ t·∫°o ra ID tr√πng l·∫∑p, d·∫´n ƒë·∫øn l·ªói. Do ƒë√≥, trong tr∆∞·ªùng h·ª£p ƒë·ªìng h·ªì l√πi, thu·∫≠t to√°n s·∫Ω n√©m ngo·∫°i l·ªá v√† ng·ª´ng t·∫°o ID, c√≥ th·ªÉ l√†m d·ªãch v·ª• kh√¥ng th·ªÉ ho·∫°t ƒë·ªông.</p><h2 id="cach-giai-quyet-van-ƒëe-truy-van-khong-su-dung-khoa-phan-vung" tabindex="-1"><a class="header-anchor" href="#cach-giai-quyet-van-ƒëe-truy-van-khong-su-dung-khoa-phan-vung"><span>C√°ch gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ truy v·∫•n kh√¥ng s·ª≠ d·ª•ng kh√≥a ph√¢n v√πng</span></a></h2><ul><li><strong>Mapping (√Ånh x·∫°):</strong> √Ånh x·∫° tr∆∞·ªùng truy v·∫•n v·ªõi kh√≥a ph√¢n v√πng, t·∫°o b·∫£ng ri√™ng ƒë·ªÉ l∆∞u tr·ªØ (s·ª≠ d·ª•ng ch·ªâ m·ª•c bao ph·ªß) ho·∫∑c l∆∞u tr·ªØ trong b·ªô ƒë·ªám.</li><li><strong>Ph∆∞∆°ng ph√°p Gene (Ph√¢n chia theo bit):</strong> S·ª≠ d·ª•ng c√°c bit cu·ªëi c·ªßa kh√≥a ph√¢n v√πng ƒë∆∞·ª£c l·∫•y t·ª´ tr∆∞·ªùng truy v·∫•n sau khi hash, ph√π h·ª£p khi tr∆∞·ªùng truy v·∫•n kh√¥ng ph·∫£i kh√≥a ph√¢n v√πng ch·ªâ c√≥ m·ªôt gi√° tr·ªã duy nh·∫•t.</li><li><strong>Redundancy (D∆∞ th·ª´a):</strong> L∆∞u tr·ªØ d∆∞ th·ª´a tr∆∞·ªùng truy v·∫•n.</li></ul><h2 id="cac-thanh-phan-pho-bien-cua-spring-cloud-va-chuc-nang" tabindex="-1"><a class="header-anchor" href="#cac-thanh-phan-pho-bien-cua-spring-cloud-va-chuc-nang"><span>C√°c th√†nh ph·∫ßn ph·ªï bi·∫øn c·ªßa Spring Cloud v√† ch·ª©c nƒÉng</span></a></h2><ol><li><strong>Eureka:</strong> Trung t√¢m ƒëƒÉng k√Ω d·ªãch v·ª•.</li><li><strong>Nacos:</strong> Trung t√¢m ƒëƒÉng k√Ω v√† c·∫•u h√¨nh.</li><li><strong>Consul:</strong> Trung t√¢m ƒëƒÉng k√Ω v√† c·∫•u h√¨nh.</li><li><strong>Spring Cloud Config:</strong> Trung t√¢m qu·∫£n l√Ω c·∫•u h√¨nh.</li><li><strong>Feign/OpenFeign:</strong> RPC Calling.</li><li><strong>Kong:</strong> Gateway.</li><li><strong>Zuul:</strong> Gateway.</li><li><strong>Spring Cloud Gateway:</strong> Gateway.</li><li><strong>Ribbon:</strong> C√¢n b·∫±ng t·∫£i.</li><li><strong>Spring Cloud Sleuth:</strong> Theo d√µi li√™n k·∫øt.</li><li><strong>Zipkin:</strong> Theo d√µi li√™n k·∫øt.</li><li><strong>Seata:</strong> Giao d·ªãch ph√¢n t√°n.</li><li><strong>Dubbo:</strong> RPC Calling.</li><li><strong>Sentinel:</strong> Ng·∫Øt m·∫°ch d·ªãch v·ª•.</li><li><strong>Hystrix:</strong> Ng·∫Øt m·∫°ch d·ªãch v·ª•.</li></ol><h2 id="cach-tranh-xuyen-thung-bo-nho-ƒëem-pha-vo-bo-nho-ƒëem-va-sup-ƒëo-bo-nho-ƒëem" tabindex="-1"><a class="header-anchor" href="#cach-tranh-xuyen-thung-bo-nho-ƒëem-pha-vo-bo-nho-ƒëem-va-sup-ƒëo-bo-nho-ƒëem"><span>C√°ch tr√°nh xuy√™n th·ªßng b·ªô nh·ªõ ƒë·ªám, ph√° v·ª° b·ªô nh·ªõ ƒë·ªám, v√† s·ª•p ƒë·ªï b·ªô nh·ªõ ƒë·ªám</span></a></h2><p>S·ª•p ƒë·ªï b·ªô nh·ªõ ƒë·ªám l√† khi m·ªôt l∆∞·ª£ng l·ªõn b·ªô nh·ªõ ƒë·ªám b·ªã h·∫øt h·∫°n c√πng m·ªôt l√∫c, khi·∫øn t·∫•t c·∫£ c√°c y√™u c·∫ßu r∆°i v√†o c∆° s·ªü d·ªØ li·ªáu, t·∫°o ra l∆∞·ª£ng l·ªõn truy v·∫•n ƒë·∫øn c∆° s·ªü d·ªØ li·ªáu trong th·ªùi gian ng·∫Øn, d·∫´n ƒë·∫øn s·ª•p ƒë·ªï.</p><p>Gi·∫£i ph√°p:</p><ul><li>ƒê·∫∑t th·ªùi gian h·∫øt h·∫°n b·ªô nh·ªõ ƒë·ªám ng·∫´u nhi√™n ƒë·ªÉ tr√°nh vi·ªác h·∫øt h·∫°n c√πng l√∫c m·ªôt l∆∞·ª£ng l·ªõn d·ªØ li·ªáu.</li><li>Th√™m d·∫•u hi·ªáu b·ªô nh·ªõ ƒë·ªám cho m·ªói d·ªØ li·ªáu ƒë·ªÉ ki·ªÉm tra xem b·ªô nh·ªõ ƒë·ªám c√≥ h·∫øt h·∫°n hay kh√¥ng, n·∫øu d·∫•u hi·ªáu h·∫øt h·∫°n, th√¨ c·∫≠p nh·∫≠t b·ªô nh·ªõ ƒë·ªám.</li><li>Kh√≥a tr∆∞·ªõc khi l√†m n√≥ng b·ªô nh·ªõ ƒë·ªám.</li></ul><p>Xuy√™n th·ªßng b·ªô nh·ªõ ƒë·ªám l√† khi c·∫£ b·ªô nh·ªõ ƒë·ªám v√† c∆° s·ªü d·ªØ li·ªáu ƒë·ªÅu kh√¥ng c√≥ d·ªØ li·ªáu, d·∫´n ƒë·∫øn t·∫•t c·∫£ c√°c y√™u c·∫ßu ƒë·ªÅu ƒëi th·∫≥ng v√†o c∆° s·ªü d·ªØ li·ªáu, g√¢y qu√° t·∫£i cho c∆° s·ªü d·ªØ li·ªáu trong th·ªùi gian ng·∫Øn.</p><p>Gi·∫£i ph√°p:</p><ul><li>Th√™m x√°c th·ª±c ·ªü t·∫ßng API, nh∆∞ x√°c th·ª±c ng∆∞·ªùi d√πng ho·∫∑c ki·ªÉm tra c∆° b·∫£n v·ªõi ID. N·∫øu ID &lt;= 0, th√¨ ch·∫∑n y√™u c·∫ßu.</li><li>N·∫øu kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu trong b·ªô nh·ªõ ƒë·ªám v√† c∆° s·ªü d·ªØ li·ªáu, c√≥ th·ªÉ ghi key-value v·ªõi gi√° tr·ªã key-null. Th·ªùi gian hi·ªáu l·ª±c c·ªßa b·ªô nh·ªõ ƒë·ªám c√≥ th·ªÉ ng·∫Øn, kho·∫£ng 30 gi√¢y, ƒë·ªÉ tr√°nh vi·ªác b·ªã t·∫•n c√¥ng l·∫∑p l·∫°i v·ªõi c√πng m·ªôt ID.</li><li>S·ª≠ d·ª•ng Bloom Filter ƒë·ªÉ hash t·∫•t c·∫£ c√°c d·ªØ li·ªáu c√≥ th·ªÉ t·ªìn t·∫°i v√†o m·ªôt bitmap l·ªõn. D·ªØ li·ªáu kh√¥ng t·ªìn t·∫°i s·∫Ω b·ªã Bloom Filter ch·∫∑n, tr√°nh √°p l·ª±c l√™n h·ªá th·ªëng l∆∞u tr·ªØ c∆° s·ªü.</li></ul><p>Ph√° v·ª° b·ªô nh·ªõ ƒë·ªám x·∫£y ra khi d·ªØ li·ªáu kh√¥ng c√≤n trong b·ªô nh·ªõ ƒë·ªám nh∆∞ng v·∫´n c√≥ trong c∆° s·ªü d·ªØ li·ªáu. N·∫øu s·ªë l∆∞·ª£ng ng∆∞·ªùi d√πng ƒë·ªìng th·ªùi l·ªõn, h·ªç s·∫Ω c√πng truy c·∫≠p v√†o c∆° s·ªü d·ªØ li·ªáu, g√¢y √°p l·ª±c l√™n c∆° s·ªü d·ªØ li·ªáu. ƒêi·ªÅu n√†y kh√°c v·ªõi s·ª•p ƒë·ªï b·ªô nh·ªõ ƒë·ªám ·ªü ch·ªó ph√° v·ª° x·∫£y ra khi ch·ªâ m·ªôt d·ªØ li·ªáu c·ª• th·ªÉ b·ªã truy v·∫•n ƒë·ªìng th·ªùi, trong khi s·ª•p ƒë·ªï l√† khi nhi·ªÅu d·ªØ li·ªáu kh√°c nhau b·ªã h·∫øt h·∫°n c√πng l√∫c.</p><p>Gi·∫£i ph√°p:</p><ul><li>ƒê·∫∑t d·ªØ li·ªáu n√≥ng kh√¥ng bao gi·ªù h·∫øt h·∫°n ho·∫∑c s·ª≠ d·ª•ng kh√≥a tr∆∞·ªõc khi truy xu·∫•t.</li></ul><h2 id="cac-giai-phap-bo-nho-ƒëem-thuong-dung-trong-he-thong-phan-tan" tabindex="-1"><a class="header-anchor" href="#cac-giai-phap-bo-nho-ƒëem-thuong-dung-trong-he-thong-phan-tan"><span>C√°c gi·∫£i ph√°p b·ªô nh·ªõ ƒë·ªám th∆∞·ªùng d√πng trong h·ªá th·ªëng ph√¢n t√°n</span></a></h2><ul><li>B·ªô nh·ªõ ƒë·ªám ph√≠a m√°y kh√°ch: B·ªô nh·ªõ ƒë·ªám trang v√† tr√¨nh duy·ªát, b·ªô nh·ªõ ƒë·ªám ·ª©ng d·ª•ng, b·ªô nh·ªõ ƒë·ªám H5, localStorage v√† sessionStorage.</li><li>CDN: B·ªô nh·ªõ ƒë·ªám n·ªôi dung: d·ªØ li·ªáu; Ph√¢n ph·ªëi n·ªôi dung: c√¢n b·∫±ng t·∫£i.</li><li>B·ªô nh·ªõ ƒë·ªám Nginx: cho t√†i nguy√™n tƒ©nh.</li><li>B·ªô nh·ªõ ƒë·ªám ph√≠a m√°y ch·ªß: B·ªô nh·ªõ ƒë·ªám c·ª•c b·ªô v√† b·ªô nh·ªõ ƒë·ªám ngo√†i.</li><li>B·ªô nh·ªõ ƒë·ªám c∆° s·ªü d·ªØ li·ªáu: B·ªô nh·ªõ ƒë·ªám t·∫ßng b·ªÅn v·ªØng (mybatis, hibernate nhi·ªÅu t·∫ßng b·ªô nh·ªõ ƒë·ªám), b·ªô nh·ªõ ƒë·ªám truy v·∫•n MySQL.</li><li>B·ªô nh·ªõ ƒë·ªám h·ªá ƒëi·ªÅu h√†nh: PageCache, BufferCache.</li></ul><h2 id="cac-chien-luoc-het-han-bo-nho-ƒëem" tabindex="-1"><a class="header-anchor" href="#cac-chien-luoc-het-han-bo-nho-ƒëem"><span>C√°c chi·∫øn l∆∞·ª£c h·∫øt h·∫°n b·ªô nh·ªõ ƒë·ªám</span></a></h2><ul><li>H·∫øt h·∫°n ƒë·ªãnh th·ªùi: M·ªói key c√≥ th·ªùi gian h·∫øt h·∫°n s·∫Ω t·∫°o ra m·ªôt b·ªô h·∫πn gi·ªù, v√† khi ƒë·∫øn th·ªùi gian h·∫øt h·∫°n, n√≥ s·∫Ω ƒë∆∞·ª£c x√≥a ngay l·∫≠p t·ª©c. Chi·∫øn l∆∞·ª£c n√†y gi·∫£i ph√≥ng b·ªô nh·ªõ t·ªët, nh∆∞ng ti√™u t·ªën nhi·ªÅu CPU ƒë·ªÉ x·ª≠ l√Ω c√°c key h·∫øt h·∫°n, l√†m gi·∫£m th·ªùi gian ph·∫£n h·ªìi v√† l∆∞u l∆∞·ª£ng c·ªßa b·ªô nh·ªõ ƒë·ªám.</li><li>H·∫øt h·∫°n l∆∞·ªùi bi·∫øng: Ch·ªâ khi truy c·∫≠p m·ªôt key m·ªõi ki·ªÉm tra n√≥ c√≥ h·∫øt h·∫°n hay kh√¥ng. N·∫øu h·∫øt h·∫°n, s·∫Ω x√≥a. Chi·∫øn l∆∞·ª£c n√†y ti·∫øt ki·ªám CPU, nh∆∞ng s·∫Ω gi·ªØ l·∫°i nhi·ªÅu d·ªØ li·ªáu ƒë√£ h·∫øt h·∫°n trong b·ªô nh·ªõ, g√¢y t·ªën nhi·ªÅu b·ªô nh·ªõ.</li><li>H·∫øt h·∫°n ƒë·ªãnh k·ª≥: M·ªói kho·∫£ng th·ªùi gian nh·∫•t ƒë·ªãnh s·∫Ω qu√©t m·ªôt s·ªë l∆∞·ª£ng key nh·∫•t ƒë·ªãnh v√† x√≥a c√°c key ƒë√£ h·∫øt h·∫°n. Chi·∫øn l∆∞·ª£c n√†y c√¢n b·∫±ng gi·ªØa h·∫øt h·∫°n ƒë·ªãnh th·ªùi v√† h·∫øt h·∫°n l∆∞·ªùi bi·∫øng.</li><li>Chi·∫øn l∆∞·ª£c ph√¢n v√πng: T·ªëi ∆∞u h√≥a vi·ªác h·∫øt h·∫°n ƒë·ªãnh k·ª≥ b·∫±ng c√°ch nh√≥m c√°c key c√≥ th·ªùi gian h·∫øt h·∫°n g·∫ßn nhau v√† qu√©t theo ph√¢n v√πng th·ªùi gian.</li></ul><h2 id="cac-thuat-toan-loai-bo-bo-nho-ƒëem-pho-bien" tabindex="-1"><a class="header-anchor" href="#cac-thuat-toan-loai-bo-bo-nho-ƒëem-pho-bien"><span>C√°c thu·∫≠t to√°n lo·∫°i b·ªè b·ªô nh·ªõ ƒë·ªám ph·ªï bi·∫øn</span></a></h2><ul><li>FIFO (First In First Out - V√†o tr∆∞·ªõc ra tr∆∞·ªõc): D·ªØ li·ªáu ƒë∆∞·ª£c l∆∞u tr·ªØ l√¢u nh·∫•t s·∫Ω b·ªã lo·∫°i b·ªè tr∆∞·ªõc.</li><li>LRU (Least Recently Used - √çt ƒë∆∞·ª£c s·ª≠ d·ª•ng g·∫ßn ƒë√¢y): D·ªØ li·ªáu √≠t ƒë∆∞·ª£c s·ª≠ d·ª•ng nh·∫•t s·∫Ω b·ªã lo·∫°i b·ªè.</li><li>LFU (Least Frequently Used - √çt ƒë∆∞·ª£c s·ª≠ d·ª•ng nh·∫•t): D·ªØ li·ªáu √≠t ƒë∆∞·ª£c truy c·∫≠p nh·∫•t trong kho·∫£ng th·ªùi gian nh·∫•t ƒë·ªãnh s·∫Ω b·ªã lo·∫°i b·ªè.</li></ul><h2 id="nguyen-ly-va-uu-nhuoc-ƒëiem-cua-bloom-filter" tabindex="-1"><a class="header-anchor" href="#nguyen-ly-va-uu-nhuoc-ƒëiem-cua-bloom-filter"><span>Nguy√™n l√Ω v√† ∆∞u, nh∆∞·ª£c ƒëi·ªÉm c·ªßa Bloom Filter</span></a></h2><ul><li>Bitmap: <code>int[10]</code> c√≥ 320 bit (10 * 32 bit). Khi th√™m d·ªØ li·ªáu, n√≥ s·∫Ω hash d·ªØ li·ªáu v√† √°nh x·∫° ƒë·∫øn c√°c bit trong bitmap, c√°c bit ƒë√≥ s·∫Ω chuy·ªÉn th√†nh 1. Hash function c√≥ th·ªÉ ƒë·ªãnh nghƒ©a nhi·ªÅu h√†m kh√°c nhau ƒë·ªÉ gi·∫£m xung ƒë·ªôt.</li><li>Truy v·∫•n: N·∫øu b·∫•t k·ª≥ bit n√†o trong c√°c bit ƒë∆∞·ª£c hash l√† 0, d·ªØ li·ªáu kh√¥ng t·ªìn t·∫°i; n·∫øu t·∫•t c·∫£ c√°c bit ƒë·ªÅu l√† 1, d·ªØ li·ªáu c√≥ th·ªÉ t·ªìn t·∫°i.</li></ul><p>∆Øu ƒëi·ªÉm:</p><ul><li>Ti·∫øt ki·ªám b·ªô nh·ªõ.</li><li>Th·ªùi gian th√™m v√† truy v·∫•n d·ªØ li·ªáu l√† O(K) v·ªõi K l√† s·ªë l∆∞·ª£ng hash function, kh√¥ng ph·ª• thu·ªôc v√†o k√≠ch th∆∞·ªõc d·ªØ li·ªáu.</li><li>Kh√¥ng c·∫ßn l∆∞u tr·ªØ ch√≠nh d·ªØ li·ªáu, gi√∫p b·∫£o m·∫≠t.</li><li>Bloom Filter c√≥ th·ªÉ th·ª±c hi·ªán c√°c ph√©p giao, h·ª£p v√† hi·ªáu.</li></ul><p>Nh∆∞·ª£c ƒëi·ªÉm:</p><ul><li>C√≥ t·ª∑ l·ªá sai s√≥t (False Positive), kh√¥ng th·ªÉ x√°c ƒë·ªãnh ch√≠nh x√°c d·ªØ li·ªáu.</li><li>Th√¥ng th∆∞·ªùng kh√¥ng th·ªÉ x√≥a d·ªØ li·ªáu kh·ªèi Bloom Filter.</li></ul><h2 id="thuat-toan-ƒëinh-ƒëia-chi-bo-nho-ƒëem-phan-tan" tabindex="-1"><a class="header-anchor" href="#thuat-toan-ƒëinh-ƒëia-chi-bo-nho-ƒëem-phan-tan"><span>Thu·∫≠t to√°n ƒë·ªãnh ƒë·ªãa ch·ªâ b·ªô nh·ªõ ƒë·ªám ph√¢n t√°n</span></a></h2><ul><li><strong>Thu·∫≠t to√°n hash:</strong> D·ª±a tr√™n k·∫øt qu·∫£ c·ªßa h√†m bƒÉm (hash) ƒë∆∞·ª£c t√≠nh t·ª´ kh√≥a (key), sau ƒë√≥ l·∫•y ph·∫ßn d∆∞ c·ªßa s·ªë l∆∞·ª£ng ph√¢n m·∫£nh ƒë·ªÉ x√°c ƒë·ªãnh ph√¢n m·∫£nh. Ph√π h·ª£p v·ªõi c√°c k·ªãch b·∫£n c√≥ s·ªë l∆∞·ª£ng ph√¢n m·∫£nh c·ªë ƒë·ªãnh. Khi m·ªü r·ªông ho·∫∑c gi·∫£m s·ªë l∆∞·ª£ng ph√¢n m·∫£nh, t·∫•t c·∫£ d·ªØ li·ªáu c·∫ßn ƒë∆∞·ª£c t√≠nh to√°n l·∫°i v√† l∆∞u tr·ªØ v√†o ph√¢n m·∫£nh m·ªõi.</li><li><strong>Hash nh·∫•t qu√°n:</strong> T·ªï ch·ª©c to√†n b·ªô d·∫£i gi√° tr·ªã hash th√†nh m·ªôt v√≤ng tr√≤n k√≠n, t√≠nh gi√° tr·ªã hash c·ªßa m·ªói m√°y ch·ªß v√† √°nh x·∫° v√†o v√≤ng tr√≤n. S·ª≠ d·ª•ng c√πng thu·∫≠t to√°n bƒÉm ƒë·ªÉ t√≠nh gi√° tr·ªã hash c·ªßa d·ªØ li·ªáu, √°nh x·∫° n√≥ v√†o v√≤ng tr√≤n v√† t√¨m ki·∫øm theo chi·ªÅu kim ƒë·ªìng h·ªì, m√°y ch·ªß ƒë·∫ßu ti√™n t√¨m th·∫•y l√† n∆°i l∆∞u tr·ªØ d·ªØ li·ªáu. Khi th√™m ho·∫∑c x√≥a n√∫t, ch·ªâ c√°c gi√° tr·ªã n·∫±m gi·ªØa n√∫t ƒë√≥ v√† n√∫t g·∫ßn nh·∫•t theo chi·ªÅu ng∆∞·ª£c kim ƒë·ªìng h·ªì m·ªõi b·ªã ·∫£nh h∆∞·ªüng. C√≥ th·ªÉ g·∫∑p v·∫•n ƒë·ªÅ ph√¢n b·ªë kh√¥ng ƒë·ªÅu tr√™n v√≤ng hash, ƒëi·ªÅu n√†y c√≥ th·ªÉ gi·∫£i quy·∫øt b·∫±ng c√°ch s·ª≠ d·ª•ng c√°c n√∫t ·∫£o.</li><li><strong>Hash slot:</strong> T√°ch bi·ªát d·ªØ li·ªáu v√† m√°y ch·ªß. D·ªØ li·ªáu ƒë∆∞·ª£c √°nh x·∫° v√†o c√°c slot, c√°c slot ƒë∆∞·ª£c √°nh x·∫° v√†o m√°y ch·ªß. Khi th√™m ho·∫∑c x√≥a n√∫t, ch·ªâ c·∫ßn di chuy·ªÉn slot l√† ƒë·ªß.</li></ul><h2 id="su-khac-biet-giua-spring-cloud-va-dubbo" tabindex="-1"><a class="header-anchor" href="#su-khac-biet-giua-spring-cloud-va-dubbo"><span>S·ª± kh√°c bi·ªát gi·ªØa Spring Cloud v√† Dubbo?</span></a></h2><p>Spring Cloud l√† m·ªôt khung c√¥ng t√°c microservices, cung c·∫•p nhi·ªÅu th√†nh ph·∫ßn ch·ª©c nƒÉng trong lƒ©nh v·ª±c microservice. Dubbo ban ƒë·∫ßu l√† m·ªôt khung RPC (Remote Procedure Call), tr·ªçng t√¢m l√† gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ g·ªçi d·ªãch v·ª•. Spring Cloud l√† m·ªôt khung to√†n di·ªán, trong khi Dubbo t·∫≠p trung h∆°n v√†o vi·ªác g·ªçi d·ªãch v·ª•, v√¨ v·∫≠y c√°c t√≠nh nƒÉng c·ªßa Dubbo kh√¥ng ƒëa d·∫°ng nh∆∞ Spring Cloud. Tuy nhi√™n, hi·ªáu su·∫•t g·ªçi d·ªãch v·ª• c·ªßa Dubbo cao h∆°n Spring Cloud. Spring Cloud v√† Dubbo kh√¥ng ƒë·ªëi l·∫≠p nhau m√† c√≥ th·ªÉ k·∫øt h·ª£p ƒë·ªÉ s·ª≠ d·ª•ng c√πng nhau.</p><h6 id="-6" tabindex="-1"><a class="header-anchor" href="#-6"><span></span></a></h6><h2 id="tuyet-lo-dich-vu-la-gi-gioi-han-luu-luong-dich-vu-la-gi" tabindex="-1"><a class="header-anchor" href="#tuyet-lo-dich-vu-la-gi-gioi-han-luu-luong-dich-vu-la-gi"><span>Tuy·∫øt l·ªü d·ªãch v·ª• l√† g√¨? Gi·ªõi h·∫°n l∆∞u l∆∞·ª£ng d·ªãch v·ª• l√† g√¨?</span></a></h2><ol><li>Khi d·ªãch v·ª• A g·ªçi d·ªãch v·ª• B, d·ªãch v·ª• B g·ªçi d·ªãch v·ª• C, l√∫c n√†y c√≥ m·ªôt l∆∞·ª£ng l·ªõn y√™u c·∫ßu ƒë·ªôt ng·ªôt ƒë·∫øn d·ªãch v·ª• A. Gi·∫£ s·ª≠ d·ªãch v·ª• A c√≥ th·ªÉ ch·ªãu ƒë∆∞·ª£c nh·ªØng y√™u c·∫ßu n√†y, nh∆∞ng n·∫øu d·ªãch v·ª• C kh√¥ng th·ªÉ ch·ªãu n·ªïi, d·∫´n ƒë·∫øn y√™u c·∫ßu g·ª≠i t·ªõi d·ªãch v·ª• C b·ªã d·ªìn ·ª©, t·ª´ ƒë√≥ y√™u c·∫ßu g·ª≠i t·ªõi d·ªãch v·ª• B c≈©ng b·ªã d·ªìn ·ª©, khi·∫øn d·ªãch v·ª• A kh√¥ng kh·∫£ d·ª•ng. ƒê√¢y ch√≠nh l√† hi·ªán t∆∞·ª£ng tuy·∫øt l·ªü d·ªãch v·ª•. Gi·∫£i ph√°p cho v·∫•n ƒë·ªÅ n√†y l√† h·∫° c·∫•p d·ªãch v·ª• v√† ng·∫Øt m·∫°ch d·ªãch v·ª•.</li><li>Gi·ªõi h·∫°n l∆∞u l∆∞·ª£ng d·ªãch v·ª• l√† vi·ªác trong c√°c t√¨nh hu·ªëng c√≥ nhi·ªÅu y√™u c·∫ßu ƒë·ªìng th·ªùi, ƒë·ªÉ b·∫£o v·ªá h·ªá th·ªëng, c√≥ th·ªÉ gi·ªõi h·∫°n s·ªë l∆∞·ª£ng y√™u c·∫ßu truy c·∫≠p v√†o d·ªãch v·ª•, t·ª´ ƒë√≥ ngƒÉn ng·ª´a h·ªá th·ªëng b·ªã qu√° t·∫£i b·ªüi s·ªë l∆∞·ª£ng y√™u c·∫ßu l·ªõn. Trong c√°c s·ª± ki·ªán b√°n h√†ng &quot;flash sale&quot;, gi·ªõi h·∫°n l∆∞u l∆∞·ª£ng l√† v√¥ c√πng quan tr·ªçng.</li></ol><h2 id="ngat-mach-dich-vu-la-gi-ha-cap-dich-vu-la-gi-su-khac-biet-la-gi" tabindex="-1"><a class="header-anchor" href="#ngat-mach-dich-vu-la-gi-ha-cap-dich-vu-la-gi-su-khac-biet-la-gi"><span>Ng·∫Øt m·∫°ch d·ªãch v·ª• l√† g√¨? H·∫° c·∫•p d·ªãch v·ª• l√† g√¨? S·ª± kh√°c bi·ªát l√† g√¨?</span></a></h2><ol><li><strong>Ng·∫Øt m·∫°ch d·ªãch v·ª•</strong> l√† khi d·ªãch v·ª• A g·ªçi m·ªôt d·ªãch v·ª• B m√† d·ªãch v·ª• B kh√¥ng kh·∫£ d·ª•ng. ƒê·ªÉ b·∫£o v·ªá ch√≠nh m√¨nh, d·ªãch v·ª• A ng·ª´ng g·ªçi d·ªãch v·ª• B v√† tr·∫£ v·ªÅ k·∫øt qu·∫£ tr·ª±c ti·∫øp, gi·∫£m √°p l·ª±c cho c·∫£ hai d·ªãch v·ª• cho ƒë·∫øn khi B ph·ª•c h·ªìi.</li><li><strong>H·∫° c·∫•p d·ªãch v·ª•</strong> l√† khi h·ªá th·ªëng qu√° t·∫£i, m·ªôt s·ªë d·ªãch v·ª• s·∫Ω b·ªã t·∫Øt ho·∫∑c gi·ªõi h·∫°n ƒë·ªÉ gi·∫£m t·∫£i cho h·ªá th·ªëng.</li></ol><h3 id="ƒëiem-chung" tabindex="-1"><a class="header-anchor" href="#ƒëiem-chung"><span>ƒêi·ªÉm chung:</span></a></h3><ol><li>C·∫£ hai ƒë·ªÅu nh·∫±m ngƒÉn ng·ª´a h·ªá th·ªëng b·ªã s·∫≠p.</li><li>C·∫£ hai ƒë·ªÅu khi·∫øn ng∆∞·ªùi d√πng c·∫£m nh·∫≠n m·ªôt s·ªë t√≠nh nƒÉng t·∫°m th·ªùi kh√¥ng kh·∫£ d·ª•ng.</li></ol><h3 id="ƒëiem-khac-biet" tabindex="-1"><a class="header-anchor" href="#ƒëiem-khac-biet"><span>ƒêi·ªÉm kh√°c bi·ªát:</span></a></h3><ul><li><strong>Ng·∫Øt d·ªãch v·ª•</strong> ƒë∆∞·ª£c k√≠ch ho·∫°t khi d·ªãch v·ª• ph√≠a d∆∞·ªõi g·∫∑p s·ª± c·ªë.</li><li><strong>H·∫° c·∫•p d·ªãch v·ª•</strong> ƒë∆∞·ª£c th·ª±c hi·ªán ƒë·ªÉ gi·∫£m t·∫£i cho h·ªá th·ªëng.</li></ul><h6 id="-7" tabindex="-1"><a class="header-anchor" href="#-7"><span></span></a></h6><h2 id="moi-quan-he-va-su-khac-biet-giua-soa-phan-tan-va-microservices-la-gi" tabindex="-1"><a class="header-anchor" href="#moi-quan-he-va-su-khac-biet-giua-soa-phan-tan-va-microservices-la-gi"><span>M·ªëi quan h·ªá v√† s·ª± kh√°c bi·ªát gi·ªØa SOA, ph√¢n t√°n v√† microservices l√† g√¨?</span></a></h2><ol><li>Ki·∫øn tr√∫c ph√¢n t√°n l√† vi·ªác t√°ch c√°c ph·∫ßn c·ªßa ki·∫øn tr√∫c ƒë∆°n th·ªÉ ra v√† tri·ªÉn khai tr√™n c√°c m√°y ho·∫∑c ti·∫øn tr√¨nh kh√°c nhau. SOA v√† microservices v·ªÅ c∆° b·∫£n ƒë·ªÅu l√† ki·∫øn tr√∫c ph√¢n t√°n.</li><li>SOA l√† m·ªôt ki·∫øn tr√∫c h∆∞·ªõng d·ªãch v·ª•, trong ƒë√≥ t·∫•t c·∫£ c√°c d·ªãch v·ª• c·ªßa h·ªá th·ªëng ƒë∆∞·ª£c ƒëƒÉng k√Ω tr√™n m·ªôt bus chung, khi c√≥ y√™u c·∫ßu g·ªçi d·ªãch v·ª•, h·ªá th·ªëng s·∫Ω t√¨m ki·∫øm th√¥ng tin d·ªãch v·ª• tr√™n bus v√† sau ƒë√≥ th·ª±c hi·ªán g·ªçi d·ªãch v·ª•.</li><li>Microservices l√† m·ªôt ki·∫øn tr√∫c h∆∞·ªõng d·ªãch v·ª• tri·ªát ƒë·ªÉ h∆°n, t√°ch c√°c ch·ª©c nƒÉng c·ªßa h·ªá th·ªëng th√†nh c√°c ·ª©ng d·ª•ng nh·ªè, th∆∞·ªùng gi·ªØ m·ªôt ·ª©ng d·ª•ng t∆∞∆°ng ·ª©ng v·ªõi m·ªôt d·ªãch v·ª• trong ki·∫øn tr√∫c.</li></ol><h2 id="lam-the-nao-ƒëe-tach-microservices" tabindex="-1"><a class="header-anchor" href="#lam-the-nao-ƒëe-tach-microservices"><span>L√†m th·∫ø n√†o ƒë·ªÉ t√°ch microservices?</span></a></h2><p>Khi t√°ch microservices, ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh ·ªïn ƒë·ªãnh c·ªßa ch√∫ng, c·∫ßn tu√¢n theo m·ªôt s·ªë nguy√™n t·∫Øc c∆° b·∫£n:</p><ol><li>C·ªë g·∫Øng kh√¥ng ƒë·ªÉ microservices c√≥ s·ª± giao thoa v·ªÅ nghi·ªáp v·ª•.</li><li>C√°c microservices ch·ªâ c√≥ th·ªÉ g·ªçi d·ªãch v·ª• qua API, kh√¥ng ƒë∆∞·ª£c truy c·∫≠p tr·ª±c ti·∫øp v√†o d·ªØ li·ªáu c·ªßa nhau m√† kh√¥ng th√¥ng qua api.</li><li>T·∫°o s·ª± k·∫øt h·ª£p n·ªôi b·ªô ch·∫∑t ch·∫Ω (high cohesion) v√† m·ª©c ƒë·ªô ph·ª• thu·ªôc th·∫•p (low coupling).</li></ol><h2 id="lam-the-nao-ƒëe-thiet-ke-microservices-co-ƒëo-ket-hop-noi-bo-chat-che-va-muc-ƒëo-phu-thuoc-thap" tabindex="-1"><a class="header-anchor" href="#lam-the-nao-ƒëe-thiet-ke-microservices-co-ƒëo-ket-hop-noi-bo-chat-che-va-muc-ƒëo-phu-thuoc-thap"><span>L√†m th·∫ø n√†o ƒë·ªÉ thi·∫øt k·∫ø microservices c√≥ ƒë·ªô k·∫øt h·ª£p n·ªôi b·ªô ch·∫∑t ch·∫Ω v√† m·ª©c ƒë·ªô ph·ª• thu·ªôc th·∫•p?</span></a></h2><p>Thi·∫øt k·∫ø c√≥ ƒë·ªô k·∫øt h·ª£p n·ªôi b·ªô ch·∫∑t ch·∫Ω v√† m·ª©c ƒë·ªô ph·ª• thu·ªôc th·∫•p l√† m·ªôt ph∆∞∆°ng ph√°p t·ª´ tr√™n xu·ªëng ƒë·ªÉ h∆∞·ªõng d·∫´n thi·∫øt k·∫ø microservices. C√≥ hai c√°ch ch√≠nh ƒë·ªÉ th·ª±c hi·ªán ƒëi·ªÅu n√†y: g·ªçi api ƒë·ªìng b·ªô v√† s·ª± ki·ªán ƒëi·ªÅu khi·ªÉn kh√¥ng ƒë·ªìng b·ªô.</p><h2 id="ban-ƒëa-tung-nghe-ve-thiet-ke-ddd-domain-driven-design" tabindex="-1"><a class="header-anchor" href="#ban-ƒëa-tung-nghe-ve-thiet-ke-ddd-domain-driven-design"><span>B·∫°n ƒë√£ t·ª´ng nghe v·ªÅ thi·∫øt k·∫ø DDD (Domain-Driven Design)?</span></a></h2><p>DDD l√† g√¨: ƒê∆∞·ª£c Eric Evans gi·ªõi thi·ªáu v√†o nƒÉm 2004, DDD l√† m·ªôt c√°ch ti·∫øp c·∫≠n ƒë·ªÉ gi·∫£i quy·∫øt s·ª± ph·ª©c t·∫°p trong ph·∫ßn m·ªÅm. Domain-Driven Design ‚Äì Tackling Complexity in the Heart of Software.</p><p>Monolith: Kh√¥ng ph√π h·ª£p cho vi·ªác t√°ch microservices. Ki·∫øn tr√∫c monolith ƒë∆∞·ª£c t√°ch ra v·∫´n c√≥ th·ªÉ l√† c√°c d·ªãch v·ª• l·∫´n l·ªôn. Khi nghi·ªáp v·ª• d·ªãch v·ª• tr·ªü n√™n ph·ª©c t·∫°p, monolith n√†y c√≥ th·ªÉ m·ªü r·ªông th√†nh m·ªôt monolith l·ªõn h∆°n.</p><p>DDD ch·ªâ l√† m·ªôt ph∆∞∆°ng ph√°p lu·∫≠n, kh√¥ng c√≥ m·ªôt khung c√¥ng ngh·ªá c·ªë ƒë·ªãnh. DDD y√™u c·∫ßu r·∫±ng domain (mi·ªÅn) kh√¥ng ph·ª• thu·ªôc v√†o c√¥ng ngh·ªá, l∆∞u tr·ªØ hay giao ti·∫øp.</p><h2 id="trung-tam-middle-platform-la-gi" tabindex="-1"><a class="header-anchor" href="#trung-tam-middle-platform-la-gi"><span>Trung t√¢m (Middle Platform) l√† g√¨?</span></a></h2><p>Trung t√¢m (middle platform) l√† vi·ªác t√°ch ra c√°c ch·ª©c nƒÉng c√≥ th·ªÉ t√°i s·ª≠ d·ª•ng t·ª´ c√°c tuy·∫øn nghi·ªáp v·ª• kh√°c nhau, b·ªè ƒëi c√°c t√≠nh nƒÉng c√° nh√¢n, tr√≠ch xu·∫•t c√°c ƒëi·ªÉm chung, v√† t·∫°o ra c√°c th√†nh ph·∫ßn c√≥ th·ªÉ t√°i s·ª≠ d·ª•ng.</p><p>V·ªÅ c∆° b·∫£n, trung t√¢m c√≥ th·ªÉ chia th√†nh ba lo·∫°i: trung t√¢m nghi·ªáp v·ª•, trung t√¢m d·ªØ li·ªáu v√† trung t√¢m k·ªπ thu·∫≠t. V·∫•n ƒë·ªÅ big data b·ªã thao t√∫ng ‚Äì trung t√¢m d·ªØ li·ªáu.</p><p>S·ª± k·∫øt h·ª£p gi·ªØa trung t√¢m v√† DDD: DDD s·∫Ω t√°ch h·ªá th·ªëng th√†nh c√°c domain qua gi·ªõi h·∫°n ng·ªØ c·∫£nh (bounded context), v√† gi·ªõi h·∫°n n√†y t·ª± nhi√™n tr·ªü th√†nh r√†o c·∫£n logic gi·ªØa c√°c trung t√¢m.</p><p>DDD cung c·∫•p h∆∞·ªõng d·∫´n t·ªët cho vi·ªác x√¢y d·ª±ng trung t√¢m trong c·∫£ k·ªπ thu·∫≠t v√† qu·∫£n l√Ω t√†i nguy√™n.</p><p>DDD chia l√†m thi·∫øt k·∫ø chi·∫øn l∆∞·ª£c v√† thi·∫øt k·∫ø chi·∫øn thu·∫≠t. Thi·∫øt k·∫ø chi·∫øn l∆∞·ª£c ·ªü t·∫ßng cao gi√∫p h∆∞·ªõng d·∫´n ph√¢n chia trung t√¢m, trong khi thi·∫øt k·∫ø chi·∫øn thu·∫≠t ·ªü t·∫ßng th·∫•p gi√∫p x√¢y d·ª±ng microservices hi·ªáu qu·∫£.</p><h6 id="-8" tabindex="-1"><a class="header-anchor" href="#-8"><span></span></a></h6><h2 id="du-an-cua-ban-ƒëam-bao-phat-trien-agile-cho-microservices-nhu-the-nao" tabindex="-1"><a class="header-anchor" href="#du-an-cua-ban-ƒëam-bao-phat-trien-agile-cho-microservices-nhu-the-nao"><span>D·ª± √°n c·ªßa b·∫°n ƒë·∫£m b·∫£o ph√°t tri·ªÉn agile cho microservices nh∆∞ th·∫ø n√†o?</span></a></h2><ul><li>T√≠ch h·ª£p ph√°t tri·ªÉn v√† v·∫≠n h√†nh.</li><li>Ph√°t tri·ªÉn agile: M·ª•c ti√™u l√† ƒë·ªÉ n√¢ng cao hi·ªáu su·∫•t delivery c·ªßa team, nhanh ch√≥ng l·∫∑p l·∫°i v√† th·ª≠ nghi·ªám nhanh.</li><li>M·ªói th√°ng ph√°t h√†nh phi√™n b·∫£n m·ªõi m·ªôt c√°ch c·ªë ƒë·ªãnh, l∆∞u tr·ªØ d∆∞·ªõi d·∫°ng nh√°nh trong kho m√£. Nh·∫≠p c√¥ng vi·ªác nhanh ch√≥ng. B·∫£ng nhi·ªám v·ª•, cu·ªôc h·ªçp ƒë·ª©ng. Nh√¢n s·ª± trong ƒë·ªôi linh ho·∫°t chuy·ªÉn ƒë·ªïi, ƒë·ªìng th·ªùi h√¨nh th√†nh c√°c ƒë·∫°i di·ªán chuy√™n gia.</li><li>M√¥i tr∆∞·ªùng test - M√¥i tr∆∞·ªùng product - M√¥i tr∆∞·ªùng dev v√† ki·ªÉm th·ª≠ SIT - M√¥i tr∆∞·ªùng ki·ªÉm th·ª≠ t√≠ch h·ª£p - M√¥i tr∆∞·ªùng ki·ªÉm th·ª≠ t·∫£i STR - M√¥i tr∆∞·ªùng pre-product - M√¥i tr∆∞·ªùng product PRD.</li><li>Cu·ªôc h·ªçp s√°ng, cu·ªôc h·ªçp tu·∫ßn, cu·ªôc h·ªçp t√°ch y√™u c·∫ßu.</li></ul><h2 id="lam-the-nao-ƒëe-chon-lua-hang-ƒëoi-tin-nhan" tabindex="-1"><a class="header-anchor" href="#lam-the-nao-ƒëe-chon-lua-hang-ƒëoi-tin-nhan"><span>L√†m th·∫ø n√†o ƒë·ªÉ ch·ªçn l·ª±a h√†ng ƒë·ª£i tin nh·∫Øn?</span></a></h2><ul><li>Kafka: <ul><li>∆Øu ƒëi·ªÉm: Kh·∫£ nƒÉng th√¥ng l∆∞·ª£ng r·∫•t l·ªõn, hi·ªáu su·∫•t r·∫•t t·ªët, c·ª•m c√≥ t√≠nh kh·∫£ d·ª•ng cao.</li><li>Nh∆∞·ª£c ƒëi·ªÉm: C√≥ th·ªÉ m·∫•t d·ªØ li·ªáu, ch·ª©c nƒÉng kh√° ƒë∆°n gi·∫£n.</li><li>T√¨nh hu·ªëng s·ª≠ d·ª•ng: Ph√¢n t√≠ch nh·∫≠t k√Ω, thu th·∫≠p d·ªØ li·ªáu l·ªõn.</li></ul></li><li>RabbitMQ: <ul><li>∆Øu ƒëi·ªÉm: ƒê·ªô tin c·∫≠y tin nh·∫Øn cao, ch·ª©c nƒÉng to√†n di·ªán.</li><li>Nh∆∞·ª£c ƒëi·ªÉm: Kh·∫£ nƒÉng th√¥ng l∆∞·ª£ng kh√° th·∫•p, t√≠ch l≈©y tin nh·∫Øn c√≥ th·ªÉ ·∫£nh h∆∞·ªüng nghi√™m tr·ªçng ƒë·∫øn hi·ªáu su·∫•t. Ng√¥n ng·ªØ Erlang kh√≥ t√πy ch·ªânh.</li><li>T√¨nh hu·ªëng s·ª≠ d·ª•ng: T√¨nh hu·ªëng quy m√¥ nh·ªè.</li></ul></li><li>RocketMQ: <ul><li>∆Øu ƒëi·ªÉm: Kh·∫£ nƒÉng th√¥ng l∆∞·ª£ng cao, hi·ªáu su·∫•t cao, c√≥ t√≠nh kh·∫£ d·ª•ng cao, ch·ª©c nƒÉng r·∫•t to√†n di·ªán.</li><li>Nh∆∞·ª£c ƒëi·ªÉm: Phi√™n b·∫£n m√£ ngu·ªìn m·ªü kh√¥ng c√≥ ch·ª©c nƒÉng b·∫±ng phi√™n b·∫£n th∆∞∆°ng m·∫°i tr√™n ƒë√°m m√¢y. T√†i li·ªáu ch√≠nh th·ª©c v√† h·ªá sinh th√°i xung quanh ch∆∞a ƒë·ªß tr∆∞·ªüng th√†nh. M√°y kh√°ch ch·ªâ h·ªó tr·ª£ Java.</li><li>T√¨nh hu·ªëng s·ª≠ d·ª•ng: G·∫ßn nh∆∞ trong m·ªçi t√¨nh hu·ªëng.</li></ul></li></ul><h2 id="tin-nhan-giao-dich-cua-rocketmq-ƒëuoc-thuc-hien-nhu-the-nao" tabindex="-1"><a class="header-anchor" href="#tin-nhan-giao-dich-cua-rocketmq-ƒëuoc-thuc-hien-nhu-the-nao"><span>Tin nh·∫Øn giao d·ªãch c·ªßa RocketMQ ƒë∆∞·ª£c th·ª±c hi·ªán nh∆∞ th·∫ø n√†o?</span></a></h2><ol><li>H·ªá th·ªëng ƒë·∫∑t h√†ng c·ªßa Producer tr∆∞·ªõc ti√™n g·ª≠i m·ªôt tin nh·∫Øn &quot;half&quot; ƒë·∫øn Broker, tin nh·∫Øn &quot;half&quot; l√† kh√¥ng th·ªÉ th·∫•y ƒë∆∞·ª£c ƒë·ªëi v·ªõi Consumer.</li><li>Sau ƒë√≥ t·∫°o ƒë∆°n h√†ng, d·ª±a v√†o vi·ªác ƒë∆°n h√†ng ƒë∆∞·ª£c t·∫°o th√†nh c√¥ng hay kh√¥ng, g·ª≠i y√™u c·∫ßu commit ho·∫∑c rollback ƒë·∫øn Broker.</li><li>H·ªá th·ªëng ƒë·∫∑t h√†ng c·ªßa Producer c≈©ng c√≥ th·ªÉ cung c·∫•p giao di·ªán g·ªçi l·∫°i cho Broker, khi Broker ph√°t hi·ªán tin nh·∫Øn &quot;half&quot; kh√¥ng nh·∫≠n ƒë∆∞·ª£c b·∫•t k·ª≥ l·ªánh thao t√°c n√†o trong m·ªôt kho·∫£ng th·ªùi gian, n√≥ s·∫Ω ch·ªß ƒë·ªông g·ªçi giao di·ªán n√†y ƒë·ªÉ ki·ªÉm tra xem ƒë∆°n h√†ng ƒë√£ ƒë∆∞·ª£c t·∫°o th√†nh c√¥ng hay ch∆∞a.</li><li>M·ªôt khi tin nh·∫Øn &quot;half&quot; ƒë∆∞·ª£c commit, h·ªá th·ªëng t·ªìn kho c·ªßa Consumer s·∫Ω ƒë·∫øn ti√™u th·ª•, n·∫øu ti√™u th·ª• th√†nh c√¥ng, tin nh·∫Øn s·∫Ω b·ªã x√≥a, giao d·ªãch ph√¢n t√°n s·∫Ω k·∫øt th√∫c th√†nh c√¥ng.</li><li>N·∫øu ti√™u th·ª• th·∫•t b·∫°i, s·∫Ω th·ª≠ l·∫°i theo ch√≠nh s√°ch th·ª≠ l·∫°i, n·∫øu cu·ªëi c√πng v·∫´n th·∫•t b·∫°i s·∫Ω v√†o h√†ng ƒë·ª£i ch·∫øt, ch·ªù x·ª≠ l√Ω th√™m.</li></ol><h2 id="tai-sao-rocketmq-khong-su-dung-zookeeper-lam-trung-tam-ƒëang-ky" tabindex="-1"><a class="header-anchor" href="#tai-sao-rocketmq-khong-su-dung-zookeeper-lam-trung-tam-ƒëang-ky"><span>T·∫°i sao RocketMQ kh√¥ng s·ª≠ d·ª•ng Zookeeper l√†m trung t√¢m ƒëƒÉng k√Ω?</span></a></h2><p>Theo l√Ω thuy·∫øt CAP, m·ªôt l√∫c ch·ªâ c√≥ th·ªÉ th·ªèa m√£n t·ªëi ƒëa hai y·∫øu t·ªë, trong khi Zookeeper th·ªèa m√£n CP, c√≥ nghƒ©a l√† Zookeeper kh√¥ng th·ªÉ ƒë·∫£m b·∫£o t√≠nh kh·∫£ d·ª•ng c·ªßa d·ªãch v·ª•. Khi Zookeeper th·ª±c hi·ªán b·∫ßu c·ª≠, th·ªùi gian b·∫ßu c·ª≠ qu√° d√†i, trong th·ªùi gian ƒë√≥, to√†n b·ªô c·ª•m ƒë·ªÅu kh√¥ng kh·∫£ d·ª•ng, ƒëi·ªÅu n√†y l√† kh√¥ng th·ªÉ ch·∫•p nh·∫≠n ƒë·ªëi v·ªõi m·ªôt trung t√¢m ƒëƒÉng k√Ω, b·ªüi v√¨ vi·ªác ph√°t hi·ªán d·ªãch v·ª• ph·∫£i ƒë∆∞·ª£c thi·∫øt k·∫ø cho t√≠nh kh·∫£ d·ª•ng.</p><p>D·ª±a tr√™n c√¢n nh·∫Øc v·ªÅ hi·ªáu su·∫•t, vi·ªác tri·ªÉn khai NameServer r·∫•t nh·∫π v√† c√≥ th·ªÉ m·ªü r·ªông theo chi·ªÅu ngang b·∫±ng c√°ch th√™m m√°y m√≥c, tƒÉng c∆∞·ªùng kh·∫£ nƒÉng ch·ªãu t·∫£i c·ªßa c·ª•m, trong khi vi·ªác ghi c·ªßa Zookeeper l√† kh√¥ng th·ªÉ m·ªü r·ªông. ƒê·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ n√†y, Zookeeper ph·∫£i ph√¢n chia lƒ©nh v·ª±c, chia th√†nh nhi·ªÅu c·ª•m Zookeeper, nh∆∞ng ƒëi·ªÅu n√†y ƒë·∫ßu ti√™n l√† qu√° ph·ª©c t·∫°p ƒë·ªÉ v·∫≠n h√†nh, v√† th·ª© hai, v·∫´n vi ph·∫°m thi·∫øt k·∫ø A trong CAP, d·∫´n ƒë·∫øn vi·ªác c√°c d·ªãch v·ª• kh√¥ng th·ªÉ k·∫øt n·ªëi v·ªõi nhau.</p><p>V·∫•n ƒë·ªÅ ph√°t sinh t·ª´ c∆° ch·∫ø l∆∞u tr·ªØ l√¢u d√†i, giao th·ª©c ZAB c·ªßa ZooKeeper s·∫Ω gi·ªØ m·ªôt nh·∫≠t k√Ω giao d·ªãch cho m·ªói y√™u c·∫ßu ghi ·ªü m·ªói n√∫t ZooKeeper, ƒë·ªìng th·ªùi th∆∞·ªùng xuy√™n sao l∆∞u d·ªØ li·ªáu b·ªô nh·ªõ (Snapshot) v√†o ƒëƒ©a ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh nh·∫•t qu√°n v√† t√≠nh b·ªÅn v·ªØng c·ªßa d·ªØ li·ªáu. Tuy nhi√™n, ƒë·ªëi v·ªõi m·ªôt t√¨nh hu·ªëng ph√°t hi·ªán d·ªãch v·ª• ƒë∆°n gi·∫£n, th·ª±c s·ª± kh√¥ng c·∫ßn thi·∫øt ph·∫£i ph·ª©c t·∫°p nh∆∞ v·∫≠y. Ph∆∞∆°ng √°n tri·ªÉn khai n√†y qu√° n·∫∑ng n·ªÅ, v√† d·ªØ li·ªáu l∆∞u tr·ªØ n√™n ƒë∆∞·ª£c t√πy ch·ªânh cao.</p><p>Vi·ªác g·ª≠i tin nh·∫Øn n√™n ph·ª• thu·ªôc y·∫øu v√†o trung t√¢m ƒëƒÉng k√Ω, v√† tri·∫øt l√Ω thi·∫øt k·∫ø c·ªßa RocketMQ ch√≠nh l√† d·ª±a tr√™n ƒëi·ªÅu n√†y. Khi Producer g·ª≠i tin nh·∫Øn l·∫ßn ƒë·∫ßu ti√™n, n√≥ s·∫Ω l·∫•y ƒë·ªãa ch·ªâ Broker t·ª´ NameServer v√† l∆∞u v√†o b·ªô nh·ªõ cache c·ª•c b·ªô. N·∫øu c·ª•m NameServer kh√¥ng kh·∫£ d·ª•ng, trong th·ªùi gian ng·∫Øn, s·∫Ω kh√¥ng ·∫£nh h∆∞·ªüng l·ªõn ƒë·∫øn Producer v√† Consumer.</p><p>D∆∞·ªõi ƒë√¢y l√† b·∫£n d·ªãch sang ti·∫øng Vi·ªát:</p><h2 id="nguyen-ly-thuc-hien-cua-rocketmq" tabindex="-1"><a class="header-anchor" href="#nguyen-ly-thuc-hien-cua-rocketmq"><span>Nguy√™n l√Ω th·ª±c hi·ªán c·ªßa RocketMQ?</span></a></h2><p>RocketMQ bao g·ªìm m·ªôt c·ª•m trung t√¢m ƒëƒÉng k√Ω NameServer, c·ª•m Producer, c·ª•m Consumer v√† m·ªôt s·ªë Broker (RocketMQ Process). Nguy√™n l√Ω ki·∫øn tr√∫c c·ªßa n√≥ nh∆∞ sau:</p><p>Broker khi kh·ªüi ƒë·ªông s·∫Ω ƒëƒÉng k√Ω v·ªõi t·∫•t c·∫£ c√°c NameServer v√† gi·ªØ k·∫øt n·ªëi d√†i h·∫°n, m·ªói 30 gi√¢y s·∫Ω g·ª≠i m·ªôt t√≠n hi·ªáu nh·ªãp.</p><p>Khi Producer g·ª≠i tin nh·∫Øn, h·ªç s·∫Ω l·∫•y ƒë·ªãa ch·ªâ m√°y ch·ªß Broker t·ª´ NameServer v√† ch·ªçn m·ªôt m√°y ch·ªß ƒë·ªÉ g·ª≠i tin nh·∫Øn d·ª±a tr√™n thu·∫≠t to√°n c√¢n b·∫±ng t·∫£i.</p><p>Consumer khi ti√™u th·ª• tin nh·∫Øn c≈©ng l·∫•y ƒë·ªãa ch·ªâ Broker t·ª´ NameServer, sau ƒë√≥ ch·ªß ƒë·ªông k√©o tin nh·∫Øn ƒë·ªÉ ti√™u th·ª•.</p><h2 id="tai-sao-rocketmq-lai-nhanh" tabindex="-1"><a class="header-anchor" href="#tai-sao-rocketmq-lai-nhanh"><span>T·∫°i sao RocketMQ l·∫°i nhanh?</span></a></h2><p>B·ªüi v√¨ n√≥ s·ª≠ d·ª•ng l∆∞u tr·ªØ tu·∫ßn t·ª±, Page Cache v√† ghi ƒëƒ©a b·∫•t ƒë·ªìng b·ªô. Khi ghi v√†o commitlog, ch√∫ng t√¥i th·ª±c hi·ªán vi·ªác ghi theo th·ª© t·ª±, ƒëi·ªÅu n√†y gi√∫p n√¢ng cao hi·ªáu su·∫•t so v·ªõi ghi ng·∫´u nhi√™n. Khi ghi v√†o commitlog, d·ªØ li·ªáu kh√¥ng ƒë∆∞·ª£c ghi tr·ª±c ti·∫øp v√†o ƒëƒ©a m√† ƒë∆∞·ª£c ghi v√†o PageCache c·ªßa h·ªá ƒëi·ªÅu h√†nh tr∆∞·ªõc, sau ƒë√≥ h·ªá ƒëi·ªÅu h√†nh s·∫Ω ghi d·ªØ li·ªáu t·ª´ b·ªô nh·ªõ cache ra ƒëƒ©a m·ªôt c√°ch b·∫•t ƒë·ªìng b·ªô.</p><h2 id="hang-ƒëoi-tin-nhan-lam-the-nao-ƒëe-ƒëam-bao-truyen-tai-tin-nhan-ƒëang-tin-cay" tabindex="-1"><a class="header-anchor" href="#hang-ƒëoi-tin-nhan-lam-the-nao-ƒëe-ƒëam-bao-truyen-tai-tin-nhan-ƒëang-tin-cay"><span>H√†ng ƒë·ª£i tin nh·∫Øn l√†m th·∫ø n√†o ƒë·ªÉ ƒë·∫£m b·∫£o truy·ªÅn t·∫£i tin nh·∫Øn ƒë√°ng tin c·∫≠y?</span></a></h2><p>Truy·ªÅn t·∫£i tin nh·∫Øn ƒë√°ng tin c·∫≠y c√≥ nghƒ©a l√† kh√¥ng ƒë∆∞·ª£c g·ª≠i qu√° nhi·ªÅu hay qu√° √≠t.</p><ol><li>ƒê·ªÉ ƒë·∫£m b·∫£o kh√¥ng g·ª≠i qu√° nhi·ªÅu tin nh·∫Øn, t·ª©c l√† tin nh·∫Øn kh√¥ng ƒë∆∞·ª£c l·∫∑p l·∫°i, Producer kh√¥ng ƒë∆∞·ª£c s·∫£n xu·∫•t l·∫°i tin nh·∫Øn, ho·∫∑c Consumer kh√¥ng ƒë∆∞·ª£c ti√™u th·ª• l·∫°i tin nh·∫Øn.</li><li>Tr∆∞·ªõc ti√™n c·∫ßn ƒë·∫£m b·∫£o kh√¥ng ph√°t sinh tin nh·∫Øn qu√° m·ª©c, v·∫•n ƒë·ªÅ n√†y kh√¥ng th∆∞·ªùng x·∫£y ra v√† c≈©ng kh√≥ ki·ªÉm so√°t, v√¨ n·∫øu c√≥ ph√°t sinh qu√° m·ª©c, ph·∫ßn l·ªõn nguy√™n nh√¢n ƒë·∫øn t·ª´ ch√≠nh Producer. ƒê·ªÉ tr√°nh v·∫•n ƒë·ªÅ n√†y, c·∫ßn th·ª±c hi·ªán ki·ªÉm so√°t ·ªü ph√≠a Consumer.</li><li>ƒê·ªÉ tr√°nh ti√™u th·ª• l·∫°i, c∆° ch·∫ø an to√†n nh·∫•t l√† Consumer th·ª±c hi·ªán t√≠nh idempotence, ƒë·∫£m b·∫£o r·∫±ng ngay c·∫£ khi ti√™u th·ª• l·∫°i c≈©ng kh√¥ng g·∫∑p v·∫•n ƒë·ªÅ. Th√¥ng qua t√≠nh idempotence, v·∫•n ƒë·ªÅ Producer g·ª≠i l·∫°i tin nh·∫Øn c≈©ng ƒë∆∞·ª£c gi·∫£i quy·∫øt.</li><li>Tin nh·∫Øn kh√¥ng ƒë∆∞·ª£c thi·∫øu, c√≥ nghƒ©a l√† tin nh·∫Øn kh√¥ng ƒë∆∞·ª£c m·∫•t. Tin nh·∫Øn m√† Producer g·ª≠i ƒëi ph·∫£i ƒë∆∞·ª£c Consumer ti√™u th·ª•. V·∫•n ƒë·ªÅ n√†y c·∫ßn xem x√©t hai kh√≠a c·∫°nh:</li><li>Khi Producer g·ª≠i tin nh·∫Øn, c·∫ßn x√°c nh·∫≠n r·∫±ng broker ƒë√£ nh·∫≠n v√† l∆∞u tr·ªØ tin nh·∫Øn ƒë√≥. V√≠ d·ª•, c∆° ch·∫ø x√°c nh·∫≠n c·ªßa RabbitMQ v√† c∆° ch·∫ø ack c·ªßa Kafka ƒë·ªÅu c√≥ th·ªÉ ƒë·∫£m b·∫£o r·∫±ng Producer g·ª≠i ƒë√∫ng tin nh·∫Øn t·ªõi broker.</li><li>Broker c·∫ßn ƒë·ª£i cho ƒë·∫øn khi Consumer x√°c nh·∫≠n r·∫±ng h·ªç ƒë√£ ti√™u th·ª• tin nh·∫Øn tr∆∞·ªõc khi x√≥a tin nh·∫Øn. ƒêi·ªÅu n√†y th∆∞·ªùng li√™n quan ƒë·∫øn c∆° ch·∫ø ack c·ªßa ph√≠a consumer; sau khi Consumer nh·∫≠n ƒë∆∞·ª£c m·ªôt tin nh·∫Øn v√† x√°c nh·∫≠n kh√¥ng c√≥ v·∫•n ƒë·ªÅ g√¨, h·ªç c√≥ th·ªÉ g·ª≠i m·ªôt ack cho broker. Ch·ªâ khi broker nh·∫≠n ƒë∆∞·ª£c ack, n√≥ m·ªõi x√≥a tin nh·∫Øn.</li></ol><h2 id="hang-ƒëoi-tin-nhan-co-nhung-tac-dung-gi" tabindex="-1"><a class="header-anchor" href="#hang-ƒëoi-tin-nhan-co-nhung-tac-dung-gi"><span>H√†ng ƒë·ª£i tin nh·∫Øn c√≥ nh·ªØng t√°c d·ª•ng g√¨?</span></a></h2><ol><li>Gi·∫£m s·ª± ph·ª• thu·ªôc: S·ª≠ d·ª•ng h√†ng ƒë·ª£i tin nh·∫Øn nh∆∞ m·ªôt ph∆∞∆°ng th·ª©c giao ti·∫øp gi·ªØa hai h·ªá th·ªëng, hai h·ªá th·ªëng kh√¥ng c·∫ßn ph·∫£i ph·ª• thu·ªôc l·∫´n nhau.</li><li>B·∫•t ƒë·ªìng b·ªô: Sau khi h·ªá th·ªëng A g·ª≠i xong tin nh·∫Øn t·ªõi h√†ng ƒë·ª£i tin nh·∫Øn, n√≥ c√≥ th·ªÉ ti·∫øp t·ª•c th·ª±c hi·ªán c√°c c√¥ng vi·ªác kh√°c.</li><li>Gi·∫£m t·∫£i: N·∫øu s·ª≠ d·ª•ng h√†ng ƒë·ª£i tin nh·∫Øn ƒë·ªÉ g·ªçi m·ªôt h·ªá th·ªëng n√†o ƒë√≥, th√¨ tin nh·∫Øn s·∫Ω ƒë∆∞·ª£c x·∫øp h√†ng trong h√†ng ƒë·ª£i, Consumer t·ª± ki·ªÉm so√°t t·ªëc ƒë·ªô ti√™u th·ª•.</li></ol><h5 id="-9" tabindex="-1"><a class="header-anchor" href="#-9"><span></span></a></h5><h2 id="hang-ƒëoi-chet-la-gi-hang-ƒëoi-tri-hoan-la-gi" tabindex="-1"><a class="header-anchor" href="#hang-ƒëoi-chet-la-gi-hang-ƒëoi-tri-hoan-la-gi"><span>H√†ng ƒë·ª£i ch·∫øt l√† g√¨? H√†ng ƒë·ª£i tr√¨ ho√£n l√† g√¨?</span></a></h2><ol><li>H√†ng ƒë·ª£i ch·∫øt c≈©ng l√† m·ªôt h√†ng ƒë·ª£i tin nh·∫Øn, n√≥ d√πng ƒë·ªÉ l∆∞u tr·ªØ nh·ªØng tin nh·∫Øn kh√¥ng ƒë∆∞·ª£c ti√™u th·ª• th√†nh c√¥ng, th∆∞·ªùng c√≥ th·ªÉ s·ª≠ d·ª•ng ƒë·ªÉ th·ª≠ l·∫°i tin nh·∫Øn.</li><li>H√†ng ƒë·ª£i tr√¨ ho√£n l√† h√†ng ƒë·ª£i d√πng ƒë·ªÉ l∆∞u tr·ªØ c√°c ph·∫ßn t·ª≠ c·∫ßn ƒë∆∞·ª£c x·ª≠ l√Ω trong m·ªôt th·ªùi gian ch·ªâ ƒë·ªãnh, th∆∞·ªùng c√≥ th·ªÉ d√πng ƒë·ªÉ x·ª≠ l√Ω c√°c nghi·ªáp v·ª• c√≥ t√≠nh ch·∫•t h·∫øt h·∫°n, ch·∫≥ng h·∫°n nh∆∞ h·ªßy ƒë∆°n h√†ng n·∫øu kh√¥ng thanh to√°n trong v√≤ng m∆∞·ªùi ph√∫t.</li></ol><h2 id="lam-the-nao-ƒëe-ƒëam-bao-ƒëoc-va-ghi-tin-nhan-hieu-qua" tabindex="-1"><a class="header-anchor" href="#lam-the-nao-ƒëe-ƒëam-bao-ƒëoc-va-ghi-tin-nhan-hieu-qua"><span>L√†m th·∫ø n√†o ƒë·ªÉ ƒë·∫£m b·∫£o ƒë·ªçc v√† ghi tin nh·∫Øn hi·ªáu qu·∫£?</span></a></h2><p><strong>Zero Copy</strong>: Kafka v√† RocketMQ ƒë·ªÅu s·ª≠ d·ª•ng c√¥ng ngh·ªá zero copy ƒë·ªÉ t·ªëi ∆∞u<br> h√≥a vi·ªác ƒë·ªçc v√† ghi file.</p><p>Ph∆∞∆°ng ph√°p sao ch√©p file truy·ªÅn th·ªëng: C·∫ßn ph·∫£i sao ch√©p file trong b·ªô nh·ªõ b·ªën l·∫ßn.</p><p><strong>Zero Copy</strong>: C√≥ hai ph∆∞∆°ng ph√°p, <code>mmap</code> v√† <code>transfile</code>. Java ƒë√£ bao b·ªçc zero copy; ph∆∞∆°ng ph√°p mmap ƒë∆∞·ª£c th·ª±c hi·ªán th√¥ng qua ƒë·ªëi t∆∞·ª£ng <code>MappedByteBuffer</code>, trong khi <code>transfile</code> ƒë∆∞·ª£c th·ª±c hi·ªán th√¥ng qua <code>FileChannel</code>. Mmap ph√π h·ª£p cho c√°c file nh·ªè, th∆∞·ªùng k√≠ch th∆∞·ªõc file kh√¥ng v∆∞·ª£t qu√° t·ª´ 1.5G ƒë·∫øn 2G. Transfile kh√¥ng c√≥ gi·ªõi h·∫°n k√≠ch th∆∞·ªõc file. RocketMQ s·ª≠ d·ª•ng ph∆∞∆°ng ph√°p mmap ƒë·ªÉ ƒë·ªçc v√† ghi file c·ªßa m√¨nh.</p><p>Trong Kafka, file nh·∫≠t k√Ω index c≈©ng ƒë∆∞·ª£c ƒë·ªçc v√† ghi th√¥ng qua ph∆∞∆°ng ph√°p mmap. Trong c√°c file nh·∫≠t k√Ω kh√°c, kh√¥ng s·ª≠ d·ª•ng ph∆∞∆°ng ph√°p zero copy. Kafka s·ª≠ d·ª•ng ph∆∞∆°ng ph√°p transfile ƒë·ªÉ t·∫£i d·ªØ li·ªáu t·ª´ ·ªï c·ª©ng v√†o card m·∫°ng.</p><h2 id="su-khac-nhau-giua-epoll-va-poll" tabindex="-1"><a class="header-anchor" href="#su-khac-nhau-giua-epoll-va-poll"><span>S·ª± kh√°c nhau gi·ªØa epoll v√† poll</span></a></h2><ol><li>M√¥ h√¨nh select s·ª≠ d·ª•ng m·∫£ng ƒë·ªÉ l∆∞u tr·ªØ c√°c m√¥ t·∫£ file k·∫øt n·ªëi Socket, dung l∆∞·ª£ng l√† c·ªë ƒë·ªãnh, c·∫ßn ph·∫£i ki·ªÉm tra tu·∫ßn t·ª± xem c√≥ x·∫£y ra s·ª± ki·ªán IO hay kh√¥ng.</li><li>M√¥ h√¨nh poll s·ª≠ d·ª•ng danh s√°ch li√™n k·∫øt ƒë·ªÉ l∆∞u tr·ªØ c√°c m√¥ t·∫£ file k·∫øt n·ªëi Socket, dung l∆∞·ª£ng kh√¥ng c·ªë ƒë·ªãnh, c≈©ng c·∫ßn ph·∫£i ki·ªÉm tra tu·∫ßn t·ª± xem c√≥ x·∫£y ra s·ª± ki·ªán IO hay kh√¥ng.</li><li>M√¥ h√¨nh epoll th√¨ ho√†n to√†n kh√°c v·ªõi poll; epoll l√† m·ªôt m√¥ h√¨nh th√¥ng b√°o s·ª± ki·ªán, khi x·∫£y ra s·ª± ki·ªán IO, ·ª©ng d·ª•ng m·ªõi th·ª±c hi·ªán thao t√°c IO, kh√¥ng c·∫ßn ph·∫£i nh∆∞ m√¥ h√¨nh poll ƒë·ªÉ ch·ªß ƒë·ªông ki·ªÉm tra.</li></ol><h2 id="bat-tay-ba-buoc-va-bon-buoc-ket-thuc-trong-tcp" tabindex="-1"><a class="header-anchor" href="#bat-tay-ba-buoc-va-bon-buoc-ket-thuc-trong-tcp"><span>B·∫Øt tay ba b∆∞·ªõc v√† b·ªën b∆∞·ªõc k·∫øt th√∫c trong TCP</span></a></h2><p>Giao th·ª©c TCP l√† giao th·ª©c t·∫ßng truy·ªÅn t·∫£i trong m√¥ h√¨nh m·∫°ng 7 t·∫ßng OSI, ch·ªãu tr√°ch nhi·ªám cho vi·ªác truy·ªÅn d·ªØ li·ªáu ƒë√°ng tin c·∫≠y.</p><p>Khi thi·∫øt l·∫≠p k·∫øt n·ªëi TCP, c·∫ßn th·ª±c hi·ªán b·∫Øt tay ba b∆∞·ªõc v·ªõi c√°c b∆∞·ªõc nh∆∞ sau:</p><ol><li>M√°y kh√°ch g·ª≠i m·ªôt g√≥i SYN ƒë·∫øn m√°y ch·ªß</li><li>M√°y ch·ªß nh·∫≠n ƒë∆∞·ª£c SYN v√† g·ª≠i l·∫°i m·ªôt g√≥i SYN_ACK cho M√°y kh√°ch</li><li>M√°y kh√°ch nh·∫≠n ƒë∆∞·ª£c SYN_ACK v√† g·ª≠i m·ªôt g√≥i ACK ƒë·∫øn m√°y ch·ªß</li></ol><p>Khi ng·∫Øt k·∫øt n·ªëi TCP, c·∫ßn th·ª±c hi·ªán b·∫Øt tay b·ªën b∆∞·ªõc k·∫øt th√∫c v·ªõi c√°c b∆∞·ªõc nh∆∞ sau:</p><ol><li>M√°y kh√°ch g·ª≠i g√≥i FIN ƒë·∫øn m√°y ch·ªß</li><li>M√°y ch·ªß nh·∫≠n ƒë∆∞·ª£c g√≥i FIN v√† g·ª≠i l·∫°i g√≥i ACK cho m√°y kh√°ch, b√°o r·∫±ng ƒë√£ nh·∫≠n ƒë∆∞·ª£c y√™u c·∫ßu ng·∫Øt k·∫øt n·ªëi, v√† M√°y kh√°ch kh√¥ng c·∫ßn g·ª≠i th√™m d·ªØ li·ªáu n·ªØa, nh∆∞ng m√°y ch·ªß c√≥ th·ªÉ v·∫´n ƒëang x·ª≠ l√Ω d·ªØ li·ªáu.</li><li>Sau khi x·ª≠ l√Ω xong t·∫•t c·∫£ d·ªØ li·ªáu, m√°y ch·ªß g·ª≠i g√≥i FIN ƒë·∫øn M√°y kh√°ch, b√°o r·∫±ng m√°y ch·ªß c√≥ th·ªÉ ng·∫Øt k·∫øt n·ªëi</li><li>M√°y kh√°ch nh·∫≠n ƒë∆∞·ª£c g√≥i FIN t·ª´ m√°y ch·ªß v√† g·ª≠i l·∫°i g√≥i ACK, b√°o r·∫±ng M√°y kh√°ch c≈©ng s·∫Ω ng·∫Øt k·∫øt n·ªëi.</li></ol><h2 id="trinh-duyet-gui-yeu-cau-va-nhan-phan-hoi-trai-qua-nhung-buoc-nao" tabindex="-1"><a class="header-anchor" href="#trinh-duyet-gui-yeu-cau-va-nhan-phan-hoi-trai-qua-nhung-buoc-nao"><span>Tr√¨nh duy·ªát g·ª≠i y√™u c·∫ßu v√† nh·∫≠n ph·∫£n h·ªìi tr·∫£i qua nh·ªØng b∆∞·ªõc n√†o?</span></a></h2><ol><li>Tr√¨nh duy·ªát ph√¢n t√≠ch URL ng∆∞·ªùi d√πng nh·∫≠p v√†o v√† t·∫°o ra m·ªôt y√™u c·∫ßu ƒë·ªãnh d·∫°ng HTTP</li><li>Tr∆∞·ªõc ti√™n ki·ªÉm tra file hosts tr√™n m√°y t√≠nh ƒë·ªÉ xem c√≥ IP t∆∞∆°ng ·ª©ng v·ªõi t√™n mi·ªÅn kh√¥ng. N·∫øu kh√¥ng c√≥, tr√¨nh duy·ªát s·∫Ω g·ª≠i t√™n mi·ªÅn ƒë·∫øn DNS ƒë∆∞·ª£c c·∫•u h√¨nh ƒë·ªÉ th·ª±c hi·ªán ph√¢n gi·∫£i t√™n mi·ªÅn v√† nh·∫≠n ƒë∆∞·ª£c ƒë·ªãa ch·ªâ IP.</li><li>Tr√¨nh duy·ªát th√¥ng qua h·ªá ƒëi·ªÅu h√†nh ƒë·ªÉ g·ª≠i y√™u c·∫ßu qua giao th·ª©c m·∫°ng t·∫ßng 4</li><li>Y√™u c·∫ßu c√≥ th·ªÉ ƒëi qua nhi·ªÅu b·ªô ƒë·ªãnh tuy·∫øn, switch v√† cu·ªëi c√πng ƒë·∫øn m√°y ch·ªß</li><li>M√°y ch·ªß nh·∫≠n ƒë∆∞·ª£c y√™u c·∫ßu, d·ª±a tr√™n c·ªïng ch·ªâ ƒë·ªãnh trong y√™u c·∫ßu, s·∫Ω truy·ªÅn y√™u c·∫ßu ƒë·∫øn ·ª©ng d·ª•ng ƒëang chi·∫øm c·ªïng ƒë√≥, v√≠ d·ª• c·ªïng 8080 ƒë∆∞·ª£c tomcat s·ª≠ d·ª•ng.</li><li>Tomcat nh·∫≠n d·ªØ li·ªáu y√™u c·∫ßu, ph√¢n t√≠ch d·ªØ li·ªáu theo ƒë·ªãnh d·∫°ng giao th·ª©c HTTP v√† l·∫•y servlet c·∫ßn truy c·∫≠p.</li><li>Servlet x·ª≠ l√Ω y√™u c·∫ßu. N·∫øu l√† DispatcherServlet trong SpringMVC, servlet s·∫Ω t√¨m ph∆∞∆°ng th·ª©c t∆∞∆°ng ·ª©ng trong Controller v√† th·ª±c hi·ªán ph∆∞∆°ng th·ª©c ƒë√≥ ƒë·ªÉ l·∫•y k·∫øt qu·∫£.</li><li>Tomcat nh·∫≠n ƒë∆∞·ª£c k·∫øt qu·∫£ ph·∫£n h·ªìi, ƒë√≥ng g√≥i th√†nh ƒë·ªãnh d·∫°ng ph·∫£n h·ªìi HTTP v√† g·ª≠i l·∫°i qua m·∫°ng ƒë·∫øn m√°y ch·ªß ch·ª©a tr√¨nh duy·ªát.</li><li>M√°y ch·ªß nh·∫≠n ƒë∆∞·ª£c k·∫øt qu·∫£ s·∫Ω truy·ªÅn ƒë·∫øn tr√¨nh duy·ªát, v√† tr√¨nh duy·ªát ch·ªãu tr√°ch nhi·ªám ph√¢n t√≠ch v√† hi·ªÉn th·ªã n·ªôi dung.</li></ol><h2 id="yeu-cau-cross-origin-la-gi-co-van-ƒëe-gi-cach-giai-quyet" tabindex="-1"><a class="header-anchor" href="#yeu-cau-cross-origin-la-gi-co-van-ƒëe-gi-cach-giai-quyet"><span>Y√™u c·∫ßu cross-origin l√† g√¨? C√≥ v·∫•n ƒë·ªÅ g√¨? C√°ch gi·∫£i quy·∫øt?</span></a></h2><p>Cross-origin (y√™u c·∫ßu t·ª´ ngu·ªìn kh√°c) nghƒ©a l√† khi tr√¨nh duy·ªát g·ª≠i m·ªôt y√™u c·∫ßu m·∫°ng, n√≥ s·∫Ω ki·ªÉm tra xem giao th·ª©c, t√™n mi·ªÅn, v√† c·ªïng c·ªßa y√™u c·∫ßu c√≥ kh·ªõp v·ªõi trang hi·ªán t·∫°i hay kh√¥ng. N·∫øu kh√¥ng kh·ªõp, tr√¨nh duy·ªát s·∫Ω h·∫°n ch·∫ø y√™u c·∫ßu ƒë√≥. V√≠ d·ª•, khi truy c·∫≠p trang web <a href="http://www.baidu.com" target="_blank" rel="noopener noreferrer">www.baidu.com</a>, vi·ªác s·ª≠ d·ª•ng ajax ƒë·ªÉ truy c·∫≠p <a href="http://www.jd.com" target="_blank" rel="noopener noreferrer">www.jd.com</a> s·∫Ω kh√¥ng ƒë∆∞·ª£c ph√©p. Tuy nhi√™n, c√°c th·∫ª nh∆∞ img, iframe, script v·ªõi thu·ªôc t√≠nh src v·∫´n c√≥ th·ªÉ truy c·∫≠p. Tr√¨nh duy·ªát √°p d·ª•ng l·ªõp h·∫°n ch·∫ø n√†y ƒë·ªÉ b·∫£o v·ªá th√¥ng tin ng∆∞·ªùi d√πng. Tuy nhi√™n, c√°c nh√† ph√°t tri·ªÉn c√≥ th·ªÉ v∆∞·ª£t qua h·∫°n ch·∫ø n√†y b·∫±ng c√°ch:</p><ol><li>Th√™m header v√†o response, v√≠ d·ª• <code>resp.setHeader(&quot;Access-Control-Allow-Origin&quot;, &quot;*&quot;);</code> cho ph√©p truy c·∫≠p t·ª´ m·ªçi trang web m√† kh√¥ng b·ªã gi·ªõi h·∫°n b·ªüi ch√≠nh s√°ch ngu·ªìn g·ªëc.</li><li>S·ª≠ d·ª•ng ph∆∞∆°ng ph√°p jsonp, k·ªπ thu·∫≠t n√†y d·ª±a tr√™n th·∫ª script v√¨ th·∫ª n√†y c√≥ th·ªÉ th·ª±c hi·ªán cross-origin.</li><li>M√°y ch·ªß t·ª± ki·ªÉm so√°t, tr∆∞·ªõc ti√™n truy c·∫≠p giao di·ªán trong c√πng t√™n mi·ªÅn, sau ƒë√≥ s·ª≠ d·ª•ng c√°c c√¥ng c·ª• nh∆∞ HTTPClient ƒë·ªÉ g·ªçi giao di·ªán m·ª•c ti√™u.</li><li>S·ª≠ d·ª•ng gateway, t∆∞∆°ng t·ª± c√°ch th·ª© ba, giao cho d·ªãch v·ª• backend th·ª±c hi·ªán cross-origin.</li></ol><h2 id="zero-copy-la-gi" tabindex="-1"><a class="header-anchor" href="#zero-copy-la-gi"><span>Zero Copy l√† g√¨?</span></a></h2><p>Zero Copy (kh√¥ng sao ch√©p) nghƒ©a l√† khi ·ª©ng d·ª•ng c·∫ßn chuy·ªÉn d·ªØ li·ªáu t·ª´ m·ªôt v√πng c·ªßa kernel sang m·ªôt v√πng kh√°c trong kernel, kh√¥ng c·∫ßn sao ch√©p d·ªØ li·ªáu qua kh√¥ng gian ng∆∞·ªùi d√πng m√† c√≥ th·ªÉ th·ª±c hi·ªán vi·ªác chuy·ªÉn tr·ª±c ti·∫øp.</p><h2 id="trong-mysql-co-20-trieu-du-lieu-redis-chi-luu-200-nghin-du-lieu-lam-the-nao-ƒëe-ƒëam-bao-du-lieu-trong-redis-la-du-lieu-hot" tabindex="-1"><a class="header-anchor" href="#trong-mysql-co-20-trieu-du-lieu-redis-chi-luu-200-nghin-du-lieu-lam-the-nao-ƒëe-ƒëam-bao-du-lieu-trong-redis-la-du-lieu-hot"><span>Trong MySQL c√≥ 20 tri·ªáu d·ªØ li·ªáu, Redis ch·ªâ l∆∞u 200 ngh√¨n d·ªØ li·ªáu, l√†m th·∫ø n√†o ƒë·ªÉ ƒë·∫£m b·∫£o d·ªØ li·ªáu trong Redis l√† d·ªØ li·ªáu &quot;hot&quot;?</span></a></h2><p>ƒê·∫ßu ti√™n, c√≥ th·ªÉ th·∫•y dung l∆∞·ª£ng c·ªßa Redis nh·ªè h∆°n nhi·ªÅu so v·ªõi MySQL. V·∫≠y Redis c√≥ th·ªÉ l·ªçc ra d·ªØ li·ªáu &quot;hot&quot; nh∆∞ th·∫ø n√†o? C√¢u h·ªèi n√†y li√™n quan ƒë·∫øn ch√≠nh s√°ch lo·∫°i b·ªè d·ªØ li·ªáu c·ªßa Redis (kh√¥ng n√™n nh·∫ßm l·∫´n gi·ªØa ch√≠nh s√°ch lo·∫°i b·ªè d·ªØ li·ªáu v√† ch√≠nh s√°ch h·∫øt h·∫°n d·ªØ li·ªáu). Sau Redis 4.0, c√≥ 8 ch√≠nh s√°ch lo·∫°i b·ªè d·ªØ li·ªáu ƒë∆∞·ª£c cung c·∫•p, trong khi tr∆∞·ªõc 4.0 ch·ªâ c√≥ 6 ch√≠nh s√°ch. Phi√™n b·∫£n m·ªõi th√™m v√†o thu·∫≠t to√°n LFU. Th·ª±c t·∫ø l√† c√≥ 8 ch√≠nh s√°ch nh∆∞ng th·ª±c s·ª± ch·ªâ c√≥ 5 ch√≠nh s√°ch quan tr·ªçng. V·ªõi random, lru, v√† lfu, c√≥ hai ph·∫°m vi d·ªØ li·ªáu kh√°c nhau: m·ªôt d√†nh cho d·ªØ li·ªáu c√≥ th·ªùi gian h·∫øt h·∫°n v√† m·ªôt d√†nh cho d·ªØ li·ªáu kh√¥ng c√≥ th·ªùi gian h·∫øt h·∫°n. NƒÉm ch√≠nh s√°ch c·ª• th·ªÉ l√†:</p><ol><li><code>noeviction</code>: Kh√¥ng lo·∫°i b·ªè d·ªØ li·ªáu. ƒê√¢y l√† ch√≠nh s√°ch m·∫∑c ƒë·ªãnh c·ªßa Redis, khi b·ªô nh·ªõ ƒë·ªám ƒë·∫ßy, Redis s·∫Ω kh√¥ng cho ph√©p th√™m d·ªØ li·ªáu m·ªõi v√† y√™u c·∫ßu ghi s·∫Ω th·∫•t b·∫°i.</li><li><code>random</code>: Ch·ªçn ng·∫´u nhi√™n. C√≥ hai lo·∫°i: <code>volatile</code>, d√†nh cho d·ªØ li·ªáu c√≥ th·ªùi gian h·∫øt h·∫°n, v√† <code>allkeys</code>, bao g·ªìm t·∫•t c·∫£ d·ªØ li·ªáu. Khi b·ªô nh·ªõ ƒë·ªám ƒë·∫ßy, ch√≠nh s√°ch n√†y s·∫Ω x√≥a ng·∫´u nhi√™n d·ªØ li·ªáu.</li><li><code>volatile-ttl</code>: Ch·ªâ d√†nh cho d·ªØ li·ªáu c√≥ th·ªùi gian h·∫øt h·∫°n, v√† d·ªØ li·ªáu s·∫Ω b·ªã x√≥a theo th·ª© t·ª± h·∫øt h·∫°n, d·ªØ li·ªáu h·∫øt h·∫°n s·ªõm h∆°n s·∫Ω b·ªã x√≥a tr∆∞·ªõc.</li><li><code>lru</code>: T∆∞∆°ng t·ª± ch√≠nh s√°ch random, c√≥ hai t·∫≠p d·ªØ li·ªáu ƒë·ªÉ x·ª≠ l√Ω. Thu·∫≠t to√°n LRU (Least Recently Used - √≠t ƒë∆∞·ª£c s·ª≠ d·ª•ng g·∫ßn ƒë√¢y nh·∫•t) d·ª±a tr√™n nguy√™n t·∫Øc: &quot;N·∫øu d·ªØ li·ªáu g·∫ßn ƒë√¢y ƒë√£ ƒë∆∞·ª£c truy c·∫≠p, kh·∫£ nƒÉng n√≥ s·∫Ω ƒë∆∞·ª£c truy c·∫≠p l·∫°i trong t∆∞∆°ng lai l√† cao.&quot;</li><li><code>lfu</code>: Ch√≠nh s√°ch LFU (Least Frequently Used - √≠t ƒë∆∞·ª£c truy c·∫≠p th∆∞·ªùng xuy√™n) th√™m y·∫øu t·ªë s·ªë l·∫ßn truy c·∫≠p v√†o LRU, gi√∫p x√°c ƒë·ªãnh ch√≠nh x√°c h∆°n d·ªØ li·ªáu &quot;hot&quot;.</li></ol><p>D·ª±a tr√™n v·∫•n ƒë·ªÅ ƒë·∫∑t ra, r√µ r√†ng ch√∫ng ta c·∫ßn s·ª≠ d·ª•ng chi·∫øn l∆∞·ª£c LFU. Ch·ªçn <code>volatile</code> hay <code>allkeys</code> ph·ª• thu·ªôc v√†o nhu c·∫ßu c·ª• th·ªÉ c·ªßa h·ªá th·ªëng.</p><h2 id="vu-khi-huy-diet-trong-jdk19-virtual-thread-la-gi" tabindex="-1"><a class="header-anchor" href="#vu-khi-huy-diet-trong-jdk19-virtual-thread-la-gi"><span>&quot;V≈© kh√≠ h·ªßy di·ªát&quot; trong JDK19: Virtual Thread l√† g√¨?</span></a></h2><p>Virtual Thread trong JDK19 ch√≠nh l√† <strong>Coroutine</strong> trong ng√†nh c√¥ng nghi·ªáp.</p><p>V√¨ coroutine ho·∫°t ƒë·ªông ·ªü t·∫ßng ng∆∞·ªùi d√πng (user space) c√≤n thread l√† t·∫ßng kernel (kernel space) c·ªßa h·ªá ƒëi·ªÅu h√†nh, n√™n coroutine v·∫´n d·ª±a tr√™n thread. M·ªôt thread c√≥ th·ªÉ ch·ª©a nhi·ªÅu coroutine, nh∆∞ng n·∫øu t·∫•t c·∫£ coroutine ƒë·ªÅu ch·ªâ d·ª±a tr√™n m·ªôt thread, th√¨ hi·ªáu su·∫•t ch·∫Øc ch·∫Øn s·∫Ω kh√¥ng cao. V√¨ v·∫≠y, trong JDK19, coroutine s·∫Ω d·ª±a tr√™n ForkJoinPool ‚Äì m·ªôt lo·∫°i thread pool, s·ª≠ d·ª•ng nhi·ªÅu thread ƒë·ªÉ h·ªó tr·ª£ vi·ªác ch·∫°y coroutine v√† s·ª≠ d·ª•ng ForkJoinPool thay v√¨ ThreadPoolExecutor th√¥ng th∆∞·ªùng ƒë·ªÉ h·ªó tr·ª£ chia nh·ªè c√°c t√°c v·ª• l·ªõn.</p><p>Coroutine trong JDK19 ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n n·ªÅn t·∫£ng ForkJoinPool. Khi ch√∫ng ta s·ª≠ d·ª•ng coroutine ƒë·ªÉ th·ª±c thi m·ªôt <code>Runnable</code>, v·ªÅ c∆° b·∫£n, <code>Runnable</code> ƒë√≥ s·∫Ω ƒë∆∞·ª£c g·ª≠i ƒë·∫øn ForkJoinPool ƒë·ªÉ th·ª±c thi. Ch√∫ng ta c√≥ th·ªÉ s·ª≠ d·ª•ng c√°c tham s·ªë sau ƒë·ªÉ c·∫•u h√¨nh s·ªë l∆∞·ª£ng thread ch√≠nh v√† s·ªë l∆∞·ª£ng thread t·ªëi ƒëa c·ªßa ForkJoinPool:</p><ul><li><code>-Djdk.virtualThreadScheduler.parallelism=1</code></li><li><code>-Djdk.virtualThreadScheduler.maxPoolSize=1</code></li></ul><p>C·ª• th·ªÉ:</p><ul><li><code>parallelism</code> m·∫∑c ƒë·ªãnh l√† <code>Runtime.getRuntime().availableProcessors()</code></li><li><code>maxPoolSize</code> m·∫∑c ƒë·ªãnh l√† <code>256</code></li></ul><p>Khi m·ªôt thread trong ForkJoinPool th·ª±c thi t√°c v·ª• v√† b·ªã ch·∫∑n (v√≠ d·ª• nh∆∞ <code>sleep</code>, <code>lock</code>, hay ho·∫°t ƒë·ªông I/O), th√¨ thread n√†y s·∫Ω chuy·ªÉn sang th·ª±c thi c√°c t√°c v·ª• kh√°c trong ForkJoinPool, cho ph√©p m·ªôt thread c√≥ th·ªÉ th·ª±c thi nhi·ªÅu t√°c v·ª• c√πng l√∫c, ƒë·∫°t ƒë∆∞·ª£c hi·ªáu qu·∫£ ch·∫°y song song c·ªßa coroutine.</p><h2 id="lam-the-nao-ƒëe-ƒëam-bao-tinh-idempotent-bat-bien-khi-thuc-hien-nhieu-lan-cua-api-trong-moi-truong-cao-tai" tabindex="-1"><a class="header-anchor" href="#lam-the-nao-ƒëe-ƒëam-bao-tinh-idempotent-bat-bien-khi-thuc-hien-nhieu-lan-cua-api-trong-moi-truong-cao-tai"><span>L√†m th·∫ø n√†o ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh <strong>idempotent</strong> (b·∫•t bi·∫øn khi th·ª±c hi·ªán nhi·ªÅu l·∫ßn) c·ªßa API trong m√¥i tr∆∞·ªùng cao t·∫£i?</span></a></h2><p>Tr∆∞·ªõc ti√™n, h√£y t√¨m hi·ªÉu kh√°i ni·ªám v·ªÅ <strong>idempotent</strong>:</p><blockquote><p>&quot;Trong l·∫≠p tr√¨nh, m·ªôt thao t√°c idempotent c√≥ ƒë·∫∑c ƒëi·ªÉm l√† d√π ƒë∆∞·ª£c th·ª±c hi·ªán nhi·ªÅu l·∫ßn, k·∫øt qu·∫£ cu·ªëi c√πng v·∫´n kh√¥ng thay ƒë·ªïi so v·ªõi khi th·ª±c hi·ªán m·ªôt l·∫ßn. H√†m idempotent l√† h√†m c√≥ th·ªÉ th·ª±c thi nhi·ªÅu l·∫ßn v·ªõi c√πng m·ªôt tham s·ªë v√† lu√¥n tr·∫£ v·ªÅ c√πng m·ªôt k·∫øt qu·∫£.&quot;</p></blockquote><p>Trong c√°c t√¨nh hu·ªëng th·ª±c t·∫ø, idempotent l√† m·ªôt kh√°i ni·ªám ph·ªï bi·∫øn, v√≠ d·ª•:</p><ul><li>Trong c√°c trang th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠, ng∆∞·ªùi d√πng c√≥ th·ªÉ b·∫•m nhi·ªÅu l·∫ßn do s·ª± c·ªë m·∫°ng, d·∫´n ƒë·∫øn vi·ªác ƒë·∫∑t h√†ng nhi·ªÅu l·∫ßn</li><li>H√†ng ƒë·ª£i tin nh·∫Øn MQ c√≥ th·ªÉ b·ªã ti√™u th·ª• nhi·ªÅu l·∫ßn</li><li>C∆° ch·∫ø retry khi x·∫£y ra timeout trong RPC</li><li>V√† nhi·ªÅu t√¨nh hu·ªëng kh√°c</li></ul><p>V·∫≠y ch√∫ng ta c√≥ th·ªÉ s·ª≠ d·ª•ng nh·ªØng gi·∫£i ph√°p n√†o ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh idempotent?</p><ul><li><strong>S·ª≠ d·ª•ng kh√≥a ch√≠nh duy nh·∫•t trong c∆° s·ªü d·ªØ li·ªáu ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh idempotent</strong><ul><li>C√°ch th·ª±c hi·ªán l√† s·ª≠ d·ª•ng ID ph√¢n t√°n l√†m kh√≥a ch√≠nh thay v√¨ s·ª≠ d·ª•ng kh√≥a t·ª± tƒÉng trong MySQL.</li></ul></li><li><strong>S·ª≠ d·ª•ng kh√≥a l·∫°c quan ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh idempotent</strong><ul><li>Th√™m m·ªôt c·ªôt phi√™n b·∫£n v√†o b·∫£ng d·ªØ li·ªáu, ch·ªâ c·∫≠p nh·∫≠t th√†nh c√¥ng khi phi√™n b·∫£n ƒë·ªìng b·ªô.</li></ul></li><li><strong>S·ª≠ d·ª•ng kh√≥a ph√¢n t√°n</strong><ul><li>ƒê∆°n gi·∫£n l√† s·ª≠ d·ª•ng kh√≥a ƒë·ªôc quy·ªÅn ph√¢n t√°n, nh∆∞ng c√≥ th·ªÉ ƒëi·ªÅu ch·ªânh k√≠ch th∆∞·ªõc kh√≥a ƒë·ªÉ c·∫£i thi·ªán hi·ªáu su·∫•t ch∆∞∆°ng tr√¨nh.</li></ul></li><li><strong>S·ª≠ d·ª•ng token</strong><ol><li>Server cung c·∫•p API l·∫•y Token, tr∆∞·ªõc khi th·ª±c hi·ªán y√™u c·∫ßu, client s·∫Ω g·ªçi API n√†y ƒë·ªÉ l·∫•y Token.</li><li>Token sau ƒë√≥ s·∫Ω ƒë∆∞·ª£c l∆∞u v√†o c∆° s·ªü d·ªØ li·ªáu Redis, s·ª≠ d·ª•ng Token l√†m key (l∆∞u √Ω ph·∫£i ƒë·∫∑t th·ªùi gian h·∫øt h·∫°n).</li><li>Token s·∫Ω ƒë∆∞·ª£c tr·∫£ v·ªÅ cho client, v√† trong y√™u c·∫ßu ti·∫øp theo, client s·∫Ω g·ª≠i k√®m theo Token.</li><li>Khi server nh·∫≠n ƒë∆∞·ª£c y√™u c·∫ßu, n√≥ s·∫Ω ki·ªÉm tra trong Redis xem Token c√≥ t·ªìn t·∫°i kh√¥ng (ph·∫£i ƒë·∫£m b·∫£o t√≠nh nguy√™n t·ª≠).</li><li>N·∫øu Token t·ªìn t·∫°i, server s·∫Ω x√≥a Token v√† th·ª±c hi·ªán logic nghi·ªáp v·ª• b√¨nh th∆∞·ªùng. N·∫øu kh√¥ng, server s·∫Ω n√©m ra ngo·∫°i l·ªá v√† tr·∫£ v·ªÅ th√¥ng b√°o l·ªói &quot;g·ª≠i l·∫°i y√™u c·∫ßu&quot;.</li></ol></li></ul><h2 id="redis-lam-the-nao-ƒëe-ƒëam-bao-tinh-nhat-quan-kep-voi-co-so-du-lieu" tabindex="-1"><a class="header-anchor" href="#redis-lam-the-nao-ƒëe-ƒëam-bao-tinh-nhat-quan-kep-voi-co-so-du-lieu"><span>Redis l√†m th·∫ø n√†o ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh nh·∫•t qu√°n k√©p v·ªõi c∆° s·ªü d·ªØ li·ªáu</span></a></h2><p>H√£y c√πng ph√¢n t√≠ch m·ªôt c√¢u h·ªèi ph·ªèng v·∫•n, c√¢u h·ªèi n√†y thi√™n v·ªÅ ·ª©ng d·ª•ng th·ª±c t·∫ø.</p><p>B·ªô nh·ªõ ƒë·ªám c√≥ th·ªÉ c·∫£i thi·ªán hi·ªáu su·∫•t v√† gi·∫£m t·∫£i cho c∆° s·ªü d·ªØ li·ªáu, nh∆∞ng ƒë·ªìng th·ªùi c≈©ng mang l·∫°i m·ªôt s·ªë v·∫•n ƒë·ªÅ m·ªõi, trong ƒë√≥ n·ªïi b·∫≠t l√† v·∫•n ƒë·ªÅ nh·∫•t qu√°n d·ªØ li·ªáu gi·ªØa b·ªô nh·ªõ ƒë·ªám v√† c∆° s·ªü d·ªØ li·ªáu.</p><p>Ch·∫Øc h·∫≥n trong c√¥ng vi·ªác, ai ƒë√£ t·ª´ng s·ª≠ d·ª•ng b·ªô nh·ªõ ƒë·ªám ƒë·ªÅu ƒë√£ g·∫∑p v·∫•n ƒë·ªÅ n√†y. V·∫≠y l√†m th·∫ø n√†o ƒë·ªÉ tr·∫£ l·ªùi c√¢u h·ªèi n√†y?</p><p>Tr∆∞·ªõc ti√™n, h√£y xem x√©t c√°c m·ª©c ƒë·ªô nh·∫•t qu√°n:</p><ul><li><strong>Nh·∫•t qu√°n m·∫°nh</strong>: B·∫•t k·ª≥ l·∫ßn ƒë·ªçc n√†o c≈©ng c√≥ th·ªÉ ƒë·ªçc ƒë∆∞·ª£c d·ªØ li·ªáu m·ªõi nh·∫•t t·ª´ l·∫ßn ghi g·∫ßn nh·∫•t.</li><li><strong>Nh·∫•t qu√°n y·∫øu</strong>: Sau khi d·ªØ li·ªáu ƒë∆∞·ª£c c·∫≠p nh·∫≠t, n·∫øu c√≥ th·ªÉ ch·∫•p nh·∫≠n vi·ªác c√°c y√™u c·∫ßu sau ƒë√≥ ch·ªâ c√≥ th·ªÉ truy c·∫≠p m·ªôt ph·∫ßn ho·∫∑c kh√¥ng th·ªÉ truy c·∫≠p ƒë∆∞·ª£c d·ªØ li·ªáu th√¨ g·ªçi l√† nh·∫•t qu√°n y·∫øu.</li></ul><h3 id="giai-phap-ƒëam-bao-tinh-nhat-quan-kep" tabindex="-1"><a class="header-anchor" href="#giai-phap-ƒëam-bao-tinh-nhat-quan-kep"><span>Gi·∫£i ph√°p ƒë·∫£m b·∫£o t√≠nh nh·∫•t qu√°n k√©p:</span></a></h3><ul><li><p><strong>X√≥a k√©p tr√¨ ho√£n</strong></p><ul><li>Chi·∫øn l∆∞·ª£c x√≥a k√©p tr√¨ ho√£n l√† m·ªôt ph∆∞∆°ng ph√°p th∆∞·ªùng ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ duy tr√¨ t√≠nh nh·∫•t qu√°n gi·ªØa c∆° s·ªü d·ªØ li·ªáu v√† b·ªô nh·ªõ ƒë·ªám trong h·ªá th·ªëng ph√¢n t√°n, tuy nhi√™n n√≥ kh√¥ng ƒë·∫£m b·∫£o nh·∫•t qu√°n m·∫°nh.</li><li>√ù t∆∞·ªüng: X√≥a b·ªô nh·ªõ ƒë·ªám tr∆∞·ªõc, sau ƒë√≥ c·∫≠p nh·∫≠t c∆° s·ªü d·ªØ li·ªáu, cu·ªëi c√πng sau N gi√¢y th·ª±c hi·ªán x√≥a l·∫°i b·ªô nh·ªõ ƒë·ªám.</li><li>Nh∆∞·ª£c ƒëi·ªÉm: C√≥ kh·∫£ nƒÉng g·∫∑p t√¨nh hu·ªëng kh√¥ng nh·∫•t qu√°n, m·ª©c ƒë·ªô ph·ª• thu·ªôc cao.</li></ul></li><li><p><strong>X√≥a th√¥ng qua MQ (h√†ng ƒë·ª£i tin nh·∫Øn) ƒë·ªÉ th·ª≠ l·∫°i</strong></p><ul><li>Sau khi c·∫≠p nh·∫≠t c∆° s·ªü d·ªØ li·ªáu, n·∫øu vi·ªác x√≥a b·ªô nh·ªõ ƒë·ªám th·∫•t b·∫°i, g·ª≠i m·ªôt tin nh·∫Øn t·ªõi MQ ƒë·ªÉ consumer th·ª±c hi·ªán x√≥a l·∫°i li√™n t·ª•c.</li></ul></li><li><p><strong>X√≥a b·∫•t ƒë·ªìng b·ªô qua binlog</strong></p><ul><li>√ù t∆∞·ªüng: Gi·∫£i ph√°p c√≥ ƒë·ªô ph·ª• thu·ªôc th·∫•p l√† s·ª≠ d·ª•ng Canal. Canal gi·∫£ l·∫≠p th√†nh m√°y ph·ª• c·ªßa MySQL, l·∫Øng nghe t·ªáp nh·ªã ph√¢n c·ªßa MySQL ch·ªß, khi d·ªØ li·ªáu thay ƒë·ªïi, g·ª≠i th√¥ng b√°o t·ªõi MQ. Sau ƒë√≥, ti·∫øn h√†nh x√≥a b·ªô nh·ªõ ƒë·ªám.</li></ul></li></ul><h2 id="phan-biet-su-khac-nhau-giua-cache-penetration-cache-breakdown-va-cache-avalanche-cung-nhu-cach-giai-quyet" tabindex="-1"><a class="header-anchor" href="#phan-biet-su-khac-nhau-giua-cache-penetration-cache-breakdown-va-cache-avalanche-cung-nhu-cach-giai-quyet"><span>Ph√¢n bi·ªát s·ª± kh√°c nhau gi·ªØa Cache Penetration, Cache Breakdown v√† Cache Avalanche, c≈©ng nh∆∞ c√°ch gi·∫£i quy·∫øt</span></a></h2><h3 id="phan-tich-cau-hoi-phong-van" tabindex="-1"><a class="header-anchor" href="#phan-tich-cau-hoi-phong-van"><span>Ph√¢n t√≠ch c√¢u h·ªèi ph·ªèng v·∫•n</span></a></h3><p>C√¢u h·ªèi n√†y nh·∫±m ƒë√°nh gi√° kh·∫£ nƒÉng t∆∞ duy v·ªÅ x·ª≠ l√Ω l∆∞·ª£ng truy c·∫≠p cao c·ªßa ·ª©ng vi√™n, v√† l√† m·ªôt trong nh·ªØng c√¢u h·ªèi ph·ªï bi·∫øn trong ph·ªèng v·∫•n.</p><h3 id="cache-penetration-xuyen-pha-bo-nho-ƒëem" tabindex="-1"><a class="header-anchor" href="#cache-penetration-xuyen-pha-bo-nho-ƒëem"><span>Cache Penetration (Xuy√™n ph√° b·ªô nh·ªõ ƒë·ªám)</span></a></h3><blockquote><p>Cache Penetration c√≥ nghƒ©a l√† khi kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu trong b·ªô nh·ªõ ƒë·ªám, t·∫•t c·∫£ c√°c y√™u c·∫ßu s·∫Ω ƒë·ªï v·ªÅ c∆° s·ªü d·ªØ li·ªáu, khi·∫øn cho b·ªô nh·ªõ ƒë·ªám m·∫•t ƒëi √Ω nghƒ©a ban ƒë·∫ßu v√† c√≥ kh·∫£ nƒÉng g√¢y qu√° t·∫£i cho c∆° s·ªü d·ªØ li·ªáu, d·∫´n ƒë·∫øn d·ªãch v·ª• kh√¥ng kh·∫£ d·ª•ng.</p></blockquote><p>Gi·∫£i ph√°p:</p><ul><li><strong>L∆∞u tr·ªØ th√¥ng tin k·∫øt qu·∫£ r·ªóng trong b·ªô nh·ªõ ƒë·ªám</strong></li><li><strong>Bloom Filter</strong> (N·∫øu kh√¥ng t·ªìn t·∫°i th√¨ ch·∫Øc ch·∫Øn kh√¥ng t·ªìn t·∫°i, c√≤n n·∫øu t·ªìn t·∫°i th√¨ c√≥ th·ªÉ kh√¥ng t·ªìn t·∫°i, ƒë∆∞·ª£c th·ª±c hi·ªán qua bitmap)</li><li><strong>L·ªçc c√°c tham s·ªë kh√¥ng h·ª£p l·ªá ph·ªï bi·∫øn ƒë·ªÉ ch·∫∑n ph·∫ßn l·ªõn c√°c y√™u c·∫ßu kh√¥ng h·ª£p l·ªá</strong></li></ul><h3 id="cache-breakdown-sap-bo-nho-ƒëem" tabindex="-1"><a class="header-anchor" href="#cache-breakdown-sap-bo-nho-ƒëem"><span>Cache Breakdown (S·∫≠p b·ªô nh·ªõ ƒë·ªám)</span></a></h3><blockquote><p>Cache Breakdown l√† t√¨nh hu·ªëng d·ªØ li·ªáu t·ªìn t·∫°i trong c∆° s·ªü d·ªØ li·ªáu nh∆∞ng kh√¥ng c√≥ trong b·ªô nh·ªõ ƒë·ªám. Tr∆∞·ªùng h·ª£p n√†y th∆∞·ªùng x·∫£y ra khi b·ªô nh·ªõ ƒë·ªám h·∫øt h·∫°n, trong c√°c tr∆∞·ªùng h·ª£p t·∫£i cao c√≥ th·ªÉ g√¢y ra qu√° t·∫£i c∆° s·ªü d·ªØ li·ªáu.</p></blockquote><p>Gi·∫£i ph√°p:</p><ul><li><strong>Thi·∫øt l·∫≠p b·ªô nh·ªõ ƒë·ªám kh√¥ng bao gi·ªù h·∫øt h·∫°n cho c√°c API n√≥ng c√≥ l∆∞·ª£ng truy c·∫≠p l·ªõn</strong></li><li><strong>N·∫øu kh√¥ng th·ªÉ thi·∫øt l·∫≠p b·ªô nh·ªõ ƒë·ªám vƒ©nh vi·ªÖn, c√≥ th·ªÉ √°p d·ª•ng kh√≥a ƒë·ªÉ tr√°nh t√¨nh tr·∫°ng qu√° t·∫£i c∆° s·ªü d·ªØ li·ªáu khi c·∫≠p nh·∫≠t b·ªô nh·ªõ ƒë·ªám</strong></li></ul><h3 id="cache-avalanche-sup-ƒëo-bo-nho-ƒëem" tabindex="-1"><a class="header-anchor" href="#cache-avalanche-sup-ƒëo-bo-nho-ƒëem"><span>Cache Avalanche (S·ª•p ƒë·ªï b·ªô nh·ªõ ƒë·ªám)</span></a></h3><blockquote><p>Cache Avalanche x·∫£y ra khi m·ªôt l∆∞·ª£ng l·ªõn b·ªô nh·ªõ ƒë·ªám h·∫øt h·∫°n c√πng l√∫c, khi·∫øn t·∫•t c·∫£ c√°c y√™u c·∫ßu ƒë·ªï v·ªÅ c∆° s·ªü d·ªØ li·ªáu, d·∫´n ƒë·∫øn qu√° t·∫£i c∆° s·ªü d·ªØ li·ªáu.</p></blockquote><p>Gi·∫£i ph√°p:</p><ul><li><strong>Thi·∫øt l·∫≠p b·ªô nh·ªõ ƒë·ªám kh√¥ng bao gi·ªù h·∫øt h·∫°n cho c√°c API n√≥ng c√≥ l∆∞·ª£ng truy c·∫≠p l·ªõn</strong></li><li><strong>Thi·∫øt l·∫≠p th·ªùi gian h·∫øt h·∫°n c·ªßa b·ªô nh·ªõ ƒë·ªám m·ªôt c√°ch ng·∫´u nhi√™n ƒë·ªÉ tr√°nh t√¨nh tr·∫°ng h·∫øt h·∫°n ƒë·ªìng lo·∫°t</strong></li></ul><h2 id="tim-hieu-ve-phat-hanh-theo-dang-canary-trong-10-phut" tabindex="-1"><a class="header-anchor" href="#tim-hieu-ve-phat-hanh-theo-dang-canary-trong-10-phut"><span>T√¨m hi·ªÉu v·ªÅ ph√°t h√†nh theo d·∫°ng Canary trong 10 ph√∫t</span></a></h2><div class="hint-container warning"><p class="hint-container-title">Warning</p><p>Ph√°t h√†nh Canary (hay c√≤n g·ªçi l√† ph√°t h√†nh x√°m) l√† m·ªôt ph∆∞∆°ng th·ª©c ph√°t h√†nh c√≥ kh·∫£ nƒÉng chuy·ªÉn ti·∫øp m∆∞·ª£t m√† gi·ªØa hai phi√™n b·∫£n c·ªßa s·∫£n ph·∫©m. Trong ph∆∞∆°ng th·ª©c n√†y, b·∫°n c√≥ th·ªÉ ti·∫øn h√†nh <strong>A/B testing</strong> ƒë·ªÉ cho m·ªôt ph·∫ßn ng∆∞·ªùi d√πng ti·∫øp t·ª•c s·ª≠ d·ª•ng t√≠nh nƒÉng A, trong khi m·ªôt ph·∫ßn kh√°c b·∫Øt ƒë·∫ßu s·ª≠ d·ª•ng t√≠nh nƒÉng B. N·∫øu ng∆∞·ªùi d√πng kh√¥ng ph·∫£n ƒë·ªëi t√≠nh nƒÉng B, th√¨ d·∫ßn d·∫ßn m·ªü r·ªông ph·∫°m vi ƒë·ªÉ t·∫•t c·∫£ ng∆∞·ªùi d√πng chuy·ªÉn sang s·ª≠ d·ª•ng t√≠nh nƒÉng B. Ph√°t h√†nh Canary gi√∫p ƒë·∫£m b·∫£o s·ª± ·ªïn ƒë·ªãnh c·ªßa h·ªá th·ªëng v√† cho ph√©p ph√°t hi·ªán, ƒëi·ªÅu ch·ªânh c√°c v·∫•n ƒë·ªÅ t·ª´ s·ªõm ƒë·ªÉ h·∫°n ch·∫ø t√°c ƒë·ªông ti√™u c·ª±c.</p></div><p><strong>Ph√°t h√†nh to√†n b·ªô</strong></p><ul><li><strong>Chu k·ª≥ quay l·∫°i l√¢u</strong></li><li><strong>L·ªói g√¢y ra s·ª•p ƒë·ªï c·ª•m d·ªãch v·ª•</strong></li><li><strong>T√≠nh kh·∫£ d·ª•ng c·ªßa d·ªãch v·ª• th·∫•p, ·∫£nh h∆∞·ªüng tr·∫£i nghi·ªám ng∆∞·ªùi d√πng</strong></li></ul><p><strong>Ph√°t h√†nh Canary</strong></p><ul><li><strong>Gi·∫£m thi·ªÉu ph·∫°m vi ·∫£nh h∆∞·ªüng, c·∫£i thi·ªán tr·∫£i nghi·ªám ng∆∞·ªùi d√πng</strong></li><li><strong>C√≥ th·ªÉ th·ª±c hi·ªán m√† kh√¥ng c·∫ßn t·∫Øt d·ªãch v·ª•</strong></li><li><strong>Th·ªùi gian quay l·∫°i nhanh</strong></li></ul><h2 id="redis-co-ho-tro-acid-khong" tabindex="-1"><a class="header-anchor" href="#redis-co-ho-tro-acid-khong"><span>Redis c√≥ h·ªó tr·ª£ ACID kh√¥ng?</span></a></h2><p><strong>Nguy√™n t·ª≠ (Atomicity):</strong> T·∫•t c·∫£ c√°c thao t√°c trong m·ªôt giao d·ªãch ph·∫£i ƒë∆∞·ª£c ho√†n th√†nh, ho·∫∑c kh√¥ng ƒë∆∞·ª£c th·ª±c hi·ªán ch√∫t n√†o.</p><p><strong>T√≠nh nh·∫•t qu√°n (Consistency):</strong> Sau khi giao d·ªãch k·∫øt th√∫c, c√°c r√†ng bu·ªôc to√†n v·∫πn c·ªßa c∆° s·ªü d·ªØ li·ªáu kh√¥ng b·ªã ph√° v·ª°, v√† tr·∫°ng th√°i d·ªØ li·ªáu tr∆∞·ªõc v√† sau giao d·ªãch ƒë·ªÅu h·ª£p l·ªá.</p><p><strong>T√≠nh c√¥ l·∫≠p (Isolation):</strong> C√°c thao t√°c trong giao d·ªãch ph·∫£i ƒë∆∞·ª£c c√°ch ly v·ªõi c√°c giao d·ªãch kh√°c, c√°c giao d·ªãch th·ª±c thi song song kh√¥ng ƒë∆∞·ª£c can thi·ªáp l·∫´n nhau.</p><p><strong>T√≠nh b·ªÅn v·ªØng (Durability):</strong> M·ªôt khi giao d·ªãch ƒë√£ ƒë∆∞·ª£c cam k·∫øt, t·∫•t c·∫£ c√°c thay ƒë·ªïi s·∫Ω ƒë∆∞·ª£c l∆∞u tr·ªØ vƒ©nh vi·ªÖn trong c∆° s·ªü d·ªØ li·ªáu, ngay c·∫£ khi h·ªá th·ªëng b·ªã s·∫≠p ho·∫∑c kh·ªüi ƒë·ªông l·∫°i, d·ªØ li·ªáu c≈©ng s·∫Ω kh√¥ng b·ªã m·∫•t.</p><p>Ch·ª©c nƒÉng giao d·ªãch trong Redis ƒë∆∞·ª£c th·ª±c hi·ªán th√¥ng qua b·ªën l·ªánh nguy√™n th·ªßy: <code>MULTI</code>, <code>EXEC</code>, <code>DISCARD</code> v√† <code>WATCH</code>.</p><p>Redis s·∫Ω tu·∫ßn t·ª± h√≥a t·∫•t c·∫£ c√°c l·ªánh trong m·ªôt giao d·ªãch v√† th·ª±c thi ch√∫ng theo th·ª© t·ª±.</p><h3 id="cac-thao-tac-co-lap-rieng-le" tabindex="-1"><a class="header-anchor" href="#cac-thao-tac-co-lap-rieng-le"><span>C√°c thao t√°c c√¥ l·∫≠p ri√™ng l·∫ª</span></a></h3><ul><li>T·∫•t c·∫£ c√°c l·ªánh trong giao d·ªãch ƒë·ªÅu s·∫Ω ƒë∆∞·ª£c tu·∫ßn t·ª± h√≥a v√† th·ª±c hi·ªán theo th·ª© t·ª±. Giao d·ªãch s·∫Ω kh√¥ng b·ªã gi√°n ƒëo·∫°n b·ªüi c√°c l·ªánh t·ª´ c√°c client kh√°c trong qu√° tr√¨nh th·ª±c thi.</li></ul><h3 id="khong-co-khai-niem-muc-ƒëo-co-lap" tabindex="-1"><a class="header-anchor" href="#khong-co-khai-niem-muc-ƒëo-co-lap"><span>Kh√¥ng c√≥ kh√°i ni·ªám m·ª©c ƒë·ªô c√¥ l·∫≠p</span></a></h3><ul><li>C√°c l·ªánh trong h√†ng ƒë·ª£i s·∫Ω kh√¥ng ƒë∆∞·ª£c th·ª±c thi cho ƒë·∫øn khi giao d·ªãch ƒë∆∞·ª£c cam k·∫øt, v√† tr∆∞·ªõc khi cam k·∫øt, kh√¥ng c√≥ l·ªánh n√†o th·ª±c s·ª± ƒë∆∞·ª£c th·ª±c hi·ªán.</li></ul><h3 id="khong-ƒëam-bao-nguyen-tu" tabindex="-1"><a class="header-anchor" href="#khong-ƒëam-bao-nguyen-tu"><span>Kh√¥ng ƒë·∫£m b·∫£o nguy√™n t·ª≠</span></a></h3><ul><li>N·∫øu m·ªôt l·ªánh trong giao d·ªãch th·∫•t b·∫°i, c√°c l·ªánh ti·∫øp theo v·∫´n s·∫Ω ƒë∆∞·ª£c th·ª±c hi·ªán m√† kh√¥ng c√≥ t√≠nh nƒÉng rollback.</li></ul><p><strong>L∆∞u √Ω:</strong> L·ªánh <code>DISCARD</code> ch·ªâ k·∫øt th√∫c giao d·ªãch hi·ªán t·∫°i, v√† t√°c ƒë·ªông c·ªßa c√°c l·ªánh ƒë√£ th·ª±c hi·ªán th√†nh c√¥ng s·∫Ω v·∫´n t·ªìn t·∫°i.</p><ol><li><p><strong><code>MULTI</code>:</strong> D√πng ƒë·ªÉ m·ªü m·ªôt giao d·ªãch, lu√¥n tr·∫£ v·ªÅ OK. Sau khi th·ª±c hi·ªán <code>MULTI</code>, client c√≥ th·ªÉ ti·∫øp t·ª•c g·ª≠i b·∫•t k·ª≥ l·ªánh n√†o, nh∆∞ng ch√∫ng s·∫Ω kh√¥ng ƒë∆∞·ª£c th·ª±c thi ngay l·∫≠p t·ª©c m√† ƒë∆∞·ª£c th√™m v√†o h√†ng ƒë·ª£i. Khi l·ªánh <code>EXEC</code> ƒë∆∞·ª£c g·ªçi, t·∫•t c·∫£ c√°c l·ªánh trong h√†ng ƒë·ª£i m·ªõi ƒë∆∞·ª£c th·ª±c hi·ªán.</p></li><li><p><strong><code>EXEC</code>:</strong> Th·ª±c thi t·∫•t c·∫£ c√°c l·ªánh trong kh·ªëi giao d·ªãch. Tr·∫£ v·ªÅ gi√° tr·ªã c·ªßa c√°c l·ªánh theo th·ª© t·ª± th·ª±c thi. N·∫øu giao d·ªãch b·ªã gi√°n ƒëo·∫°n, tr·∫£ v·ªÅ <code>nil</code>.</p></li><li><p><strong><code>DISCARD</code>:</strong> D√πng ƒë·ªÉ h·ªßy b·ªè h√†ng ƒë·ª£i giao d·ªãch v√† tho√°t kh·ªèi tr·∫°ng th√°i giao d·ªãch m√† kh√¥ng th·ª±c thi c√°c l·ªánh.</p></li><li><p><strong><code>WATCH</code>:</strong> Cung c·∫•p c∆° ch·∫ø ki·ªÉm tra v√† thi·∫øt l·∫≠p (CAS) cho giao d·ªãch trong Redis. Theo d√µi m·ªôt ho·∫∑c nhi·ªÅu kh√≥a, n·∫øu m·ªôt trong c√°c kh√≥a ƒë√≥ b·ªã thay ƒë·ªïi (ho·∫∑c b·ªã x√≥a), giao d·ªãch s·∫Ω kh√¥ng ƒë∆∞·ª£c th·ª±c thi.</p></li></ol><h2 id="redis-co-nhung-phuong-phap-nao-ƒëe-duy-tri-du-lieu-va-lam-the-nao-ƒëe-cau-hinh-tren-moi-truong-thuc-te" tabindex="-1"><a class="header-anchor" href="#redis-co-nhung-phuong-phap-nao-ƒëe-duy-tri-du-lieu-va-lam-the-nao-ƒëe-cau-hinh-tren-moi-truong-thuc-te"><span>Redis c√≥ nh·ªØng ph∆∞∆°ng ph√°p n√†o ƒë·ªÉ duy tr√¨ d·ªØ li·ªáu, v√† l√†m th·∫ø n√†o ƒë·ªÉ c·∫•u h√¨nh tr√™n m√¥i tr∆∞·ªùng th·ª±c t·∫ø?</span></a></h2><p>Redis cung c·∫•p hai ph∆∞∆°ng ph√°p duy tr√¨ d·ªØ li·ªáu: RDB v√† AOF.</p><h3 id="rdb-snapshot" tabindex="-1"><a class="header-anchor" href="#rdb-snapshot"><span>RDB (Snapshot)</span></a></h3><p>RDB (Redis DataBase) t·∫°o ra b·∫£n sao d·ªØ li·ªáu hi·ªán t·∫°i c·ªßa qu√° tr√¨nh v√† l∆∞u tr·ªØ n√≥ tr√™n ƒëƒ©a d∆∞·ªõi d·∫°ng snapshot. ƒê√¢y l√† b·∫£n sao t·∫°i m·ªôt th·ªùi ƒëi·ªÉm c·ª• th·ªÉ, v√¨ v·∫≠y gi√° tr·ªã trong snapshot s·∫Ω c≈© h∆°n ho·∫∑c b·∫±ng gi√° tr·ªã trong b·ªô nh·ªõ.</p><p><strong>∆Øu ƒëi·ªÉm:</strong></p><ol><li>Dung l∆∞·ª£ng nh·ªè sau khi n√©n.</li><li>T·∫£i t·ªáp RDB ƒë·ªÉ kh√¥i ph·ª•c r·∫•t nhanh.</li></ol><p><strong>Nh∆∞·ª£c ƒëi·ªÉm:</strong></p><ol><li>T√≠nh t·ª©c th√¨ kh√¥ng cao.</li><li>Khi th·ª±c hi·ªán <code>bgsave</code>, Redis ph·∫£i t·∫°o m·ªôt ti·∫øn tr√¨nh con (fork), chi ph√≠ hi·ªáu su·∫•t cao khi th·ª±c hi·ªán nhi·ªÅu l·∫ßn.</li></ol><h3 id="aof-append-only-file" tabindex="-1"><a class="header-anchor" href="#aof-append-only-file"><span>AOF (Append Only File)</span></a></h3><p>Redis ghi l·∫°i nh·∫≠t k√Ω sau khi l·ªánh ƒë√£ ƒë∆∞·ª£c th·ª±c thi, t·ª©c l√† n√≥ s·∫Ω th·ª±c thi l·ªánh v√† ghi d·ªØ li·ªáu v√†o b·ªô nh·ªõ tr∆∞·ªõc, sau ƒë√≥ m·ªõi ghi v√†o nh·∫≠t k√Ω. Nh·∫≠t k√Ω ghi l·∫°i t·ª´ng l·ªánh Redis nh·∫≠n ƒë∆∞·ª£c v√† l∆∞u tr·ªØ ch√∫ng d∆∞·ªõi d·∫°ng vƒÉn b·∫£n.</p><p><strong>∆Øu ƒëi·ªÉm:</strong></p><ol><li>AOF c√≥ th·ªÉ ƒë·∫£m b·∫£o m·∫•t √≠t d·ªØ li·ªáu t√πy thu·ªôc v√†o c·∫•u h√¨nh.</li></ol><p><strong>Nh∆∞·ª£c ƒëi·ªÉm:</strong></p><ol><li>Dung l∆∞·ª£ng t·ªáp l·ªõn h∆°n RDB.</li><li>Kh√¥i ph·ª•c d·ªØ li·ªáu ch·∫≠m h∆°n trong tr∆∞·ªùng h·ª£p d·ªØ li·ªáu l·ªõn.</li></ol><h3 id="ket-hop-rdb-va-aof" tabindex="-1"><a class="header-anchor" href="#ket-hop-rdb-va-aof"><span>K·∫øt h·ª£p RDB v√† AOF</span></a></h3><p>Redis c≈©ng h·ªó tr·ª£ k·∫øt h·ª£p gi·ªØa RDB v√† AOF b·∫±ng c√°ch s·ª≠ d·ª•ng <code>aof-use-rdb-preamble yes</code> ƒë·ªÉ t·∫≠n d·ª•ng ∆∞u ƒëi·ªÉm c·ªßa c·∫£ hai ph∆∞∆°ng ph√°p.</p><h2 id="nguyen-ly-redisson-trong-viec-thuc-hien-khoa-phan-tan" tabindex="-1"><a class="header-anchor" href="#nguyen-ly-redisson-trong-viec-thuc-hien-khoa-phan-tan"><span>Nguy√™n l√Ω Redisson trong vi·ªác th·ª±c hi·ªán kh√≥a ph√¢n t√°n</span></a></h2><p>C√≥ nhi·ªÅu gi·∫£i ph√°p k·ªπ thu·∫≠t ƒë·ªÉ th·ª±c hi·ªán kh√≥a ph√¢n t√°n, v√≠ d·ª• nh∆∞ Redis ho·∫∑c Zookeeper. B√¢y gi·ªù, ch√∫ng ta s·∫Ω t√¨m hi·ªÉu c√°ch Redisson th·ª±c hi·ªán kh√≥a ph√¢n t√°n.</p><h3 id="cac-yeu-to-can-xem-xet-khi-thuc-hien-khoa-phan-tan" tabindex="-1"><a class="header-anchor" href="#cac-yeu-to-can-xem-xet-khi-thuc-hien-khoa-phan-tan"><span>C√°c y·∫øu t·ªë c·∫ßn xem x√©t khi th·ª±c hi·ªán kh√≥a ph√¢n t√°n:</span></a></h3><ul><li><strong>T√≠nh t∆∞∆°ng h·ªó (Mutual exclusion):</strong> S·ª≠ d·ª•ng <code>setnx</code>.</li><li><strong>Tr√°nh kh√≥a ch·∫øt (Deadlock prevention):</strong></li><li><strong>T√≠nh t√°i nh·∫≠p (Reentrancy):</strong></li><li><strong>Hi·ªáu su·∫•t cao:</strong></li></ul><h4 id="so-ƒëo-nguyen-ly-redisson-khoa-phan-tan" tabindex="-1"><a class="header-anchor" href="#so-ƒëo-nguyen-ly-redisson-khoa-phan-tan"><span>S∆° ƒë·ªì nguy√™n l√Ω Redisson kh√≥a ph√¢n t√°n:</span></a></h4><figure><img src="https://cdn.nlark.com/yuque/0/2022/jpeg/8380143/1668513379681-00f7ed75-e093-4688-9b9a-cfd9ac16fe9c.jpeg" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="cap-ƒëinh-ly-va-ly-thuyet-base-la-gi" tabindex="-1"><a class="header-anchor" href="#cap-ƒëinh-ly-va-ly-thuyet-base-la-gi"><span>CAP ƒë·ªãnh l√Ω v√† L√Ω thuy·∫øt BASE l√† g√¨?</span></a></h2><h4 id="cap" tabindex="-1"><a class="header-anchor" href="#cap"><span>CAP</span></a></h4><p>Trong khoa h·ªçc m√°y t√≠nh, m·ªói khi ch√∫ng ta n√≥i ƒë·∫øn h·ªá th·ªëng ph√¢n t√°n, s·∫Ω kh√¥ng th·ªÉ tr√°nh kh·ªèi vi·ªác nh·∫Øc ƒë·∫øn ƒë·ªãnh l√Ω CAP, m·ªôt nguy√™n l√Ω c∆° b·∫£n trong c√°c h·ªá th·ªëng ph√¢n t√°n. H√£y c√πng t·ª´ng b∆∞·ªõc kh√°m ph√° b√≠ ·∫©n c·ªßa n√≥.</p><p>CAP b·∫Øt ngu·ªìn t·ª´ m·ªôt gi√°o s∆∞ c·ªßa m·ªôt tr∆∞·ªùng ƒë·∫°i h·ªçc t·∫°i M·ªπ, ng∆∞·ªùi ƒë√£ ƒë∆∞a ra gi·∫£ thuy·∫øt n√†y t·∫°i h·ªôi th·∫£o ACM v√†o nƒÉm 2000. ƒê·∫øn nƒÉm 2002, hai sinh vi√™n c·ªßa MIT ƒë√£ ch·ª©ng minh gi·∫£ thuy·∫øt n√†y v√† bi·∫øn n√≥ th√†nh ƒë·ªãnh l√Ω.</p><figure><img src="https://raw.githubusercontent.com/csunny/etcd-from-arch-to-souce-code/master/_asserts/images/cap.jpg" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>CAP ƒë·ªãnh l√Ω bao g·ªìm ba y·∫øu t·ªë:</p><ul><li><strong>T√≠nh nh·∫•t qu√°n</strong> (Consistency): T·∫•t c·∫£ c√°c n√∫t truy c·∫≠p c√πng m·ªôt b·∫£n sao d·ªØ li·ªáu m·ªõi nh·∫•t.</li><li><strong>T√≠nh s·∫µn s√†ng</strong> (Availability): M·ªói y√™u c·∫ßu ƒë·ªÅu nh·∫≠n ƒë∆∞·ª£c ph·∫£n h·ªìi kh√¥ng b·ªã l·ªói ‚Äî nh∆∞ng kh√¥ng ƒë·∫£m b·∫£o r·∫±ng d·ªØ li·ªáu nh·∫≠n ƒë∆∞·ª£c l√† m·ªõi nh·∫•t.</li><li><strong>T√≠nh ch·ªãu l·ªói ph√¢n v√πng</strong> (Partition Tolerance): V·ªÅ c∆° b·∫£n, ph√¢n v√πng l√† y√™u c·∫ßu v·ªÅ gi·ªõi h·∫°n th·ªùi gian truy·ªÅn th√¥ng. H·ªá th·ªëng kh√¥ng th·ªÉ ƒë·∫°t ƒë∆∞·ª£c t√≠nh nh·∫•t qu√°n d·ªØ li·ªáu trong kho·∫£ng th·ªùi gian quy ƒë·ªãnh s·∫Ω coi l√† x·∫£y ra ph√¢n v√πng. L√∫c n√†y, ph·∫£i ch·ªçn gi·ªØa C (nh·∫•t qu√°n) v√† A (s·∫µn s√†ng).</li></ul><p>ƒê·ªãnh l√Ω ch·ªâ ra r·∫±ng ƒë·ªëi v·ªõi m·ªôt h·ªá th·ªëng ph√¢n t√°n, <strong>kh√¥ng th·ªÉ c√πng l√∫c th·ªèa m√£n c·∫£ ba y·∫øu t·ªë tr√™n</strong>. ƒê·ªÉ d·ªÖ hi·ªÉu v·ªÅ l√Ω thuy·∫øt CAP, h√£y t∆∞·ªüng t∆∞·ª£ng c√≥ hai n√∫t n·∫±m ·ªü hai ph√≠a c·ªßa m·ªôt ph√¢n v√πng. N·∫øu cho ph√©p √≠t nh·∫•t m·ªôt n√∫t c·∫≠p nh·∫≠t tr·∫°ng th√°i, s·∫Ω d·∫´n ƒë·∫øn d·ªØ li·ªáu kh√¥ng nh·∫•t qu√°n, t·ª©c l√† m·∫•t t√≠nh nh·∫•t qu√°n (C). N·∫øu mu·ªën ƒë·∫£m b·∫£o d·ªØ li·ªáu nh·∫•t qu√°n, ph·∫£i v√¥ hi·ªáu h√≥a m·ªôt n√∫t ·ªü ph√≠a ph√¢n v√πng, ƒëi·ªÅu n√†y l√†m m·∫•t t√≠nh s·∫µn s√†ng (A). Tr·ª´ khi hai n√∫t c√≥ th·ªÉ giao ti·∫øp, m·ªõi c√≥ th·ªÉ ƒë·∫£m b·∫£o c·∫£ t√≠nh nh·∫•t qu√°n v√† s·∫µn s√†ng, nh∆∞ng ƒëi·ªÅu n√†y l·∫°i l√†m m·∫•t t√≠nh ch·ªãu l·ªói ph√¢n v√πng (P).</p><p>V√¨ kh√¥ng th·ªÉ th·ªèa m√£n ƒë·ªìng th·ªùi c·∫£ ba y·∫øu t·ªë c·ªßa CAP, n√™n khi thi·∫øt k·∫ø h·ªá th·ªëng, ch√∫ng ta c·∫ßn ƒë∆∞a ra s·ª± c√¢n nh·∫Øc v√† l·ª±a ch·ªçn y·∫øu t·ªë n√†o c·∫ßn gi·∫£m thi·ªÉu ƒë·ªÉ h·ªó tr·ª£ hai y·∫øu t·ªë c√≤n l·∫°i.</p><ul><li><strong>Gi·∫£m t√≠nh nh·∫•t qu√°n</strong>: ·ª®ng d·ª•ng kh√¥ng nh·∫°y c·∫£m v·ªõi k·∫øt qu·∫£ c√≥ th·ªÉ ch·∫•p nh·∫≠n vi·ªác c·∫≠p nh·∫≠t th√†nh c√¥ng sau m·ªôt kho·∫£ng th·ªùi gian nh·∫•t ƒë·ªãnh, kh√¥ng c·∫ßn ƒë·∫£m b·∫£o t√≠nh nh·∫•t qu√°n m·∫°nh m·∫Ω, ch·ªâ c·∫ßn ƒë·∫£m b·∫£o t√≠nh nh·∫•t qu√°n cu·ªëi c√πng. V√≠ d·ª•: c√°c trang web tƒ©nh.</li><li><strong>Gi·∫£m t√≠nh s·∫µn s√†ng</strong>: ·ª®ng d·ª•ng nh·∫°y c·∫£m v·ªõi t√≠nh nh·∫•t qu√°n, nh∆∞ m√°y ATM c·ªßa ng√¢n h√†ng, s·∫Ω d·ª´ng d·ªãch v·ª• khi h·ªá th·ªëng g·∫∑p s·ª± c·ªë. V√≠ d·ª•: c√°c ·ª©ng d·ª•ng thanh to√°n, chuy·ªÉn kho·∫£n. C√°c thu·∫≠t to√°n nh∆∞ Paxos, Raft ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh nh·∫•t qu√°n m·∫°nh m·∫Ω.</li><li><strong>Gi·∫£m t√≠nh ch·ªãu l·ªói ph√¢n v√πng</strong>: Trong th·ª±c t·∫ø, x√°c su·∫•t ph√¢n v√πng m·∫°ng l√† kh√° nh·ªè nh∆∞ng kh√¥ng th·ªÉ tr√°nh kh·ªèi. Trong qu√° tr√¨nh th·ª±c h√†nh, giao ti·∫øp m·∫°ng c√≥ th·ªÉ ƒë∆∞·ª£c c·∫£i thi·ªán th√¥ng qua c√°c c∆° ch·∫ø nh∆∞ k√™nh k√©p ƒë·ªÉ ƒë·∫°t ƒë∆∞·ª£c truy·ªÅn th√¥ng ·ªïn ƒë·ªãnh h∆°n.</li></ul><h4 id="ly-thuyet-base" tabindex="-1"><a class="header-anchor" href="#ly-thuyet-base"><span>L√Ω thuy·∫øt BASE</span></a></h4><p>Ti·∫øp theo, ch√∫ng ta t√¨m hi·ªÉu v·ªÅ l√Ω thuy·∫øt BASE (vi·∫øt t·∫Øt c·ªßa <strong>Basically Available</strong> - kh·∫£ d·ª•ng c∆° b·∫£n, <strong>Soft state</strong> - tr·∫°ng th√°i m·ªÅm, v√† <strong>Eventually consistent</strong> - nh·∫•t qu√°n cu·ªëi c√πng). L√Ω thuy·∫øt BASE l√† k·∫øt qu·∫£ c·ªßa vi·ªác c√¢n b·∫±ng gi·ªØa t√≠nh nh·∫•t qu√°n v√† t√≠nh s·∫µn s√†ng trong CAP, d·ª±a tr√™n √Ω t∆∞·ªüng r·∫±ng <strong>ngay c·∫£ khi h·ªá th·ªëng kh√¥ng th·ªÉ ƒë·∫°t ƒë∆∞·ª£c t√≠nh nh·∫•t qu√°n m·∫°nh m·∫Ω, n√≥ v·∫´n c√≥ th·ªÉ ƒë·∫£m b·∫£o t√≠nh nh·∫•t qu√°n cu·ªëi c√πng</strong> th√¥ng qua c√°c ph∆∞∆°ng ph√°p ph√π h·ª£p d·ª±a tr√™n ƒë·∫∑c ƒëi·ªÉm c·ªßa t·ª´ng ·ª©ng d·ª•ng.</p><ul><li><strong>Kh·∫£ d·ª•ng c∆° b·∫£n</strong>: Cho ph√©p m·∫•t m·ªôt ph·∫ßn t√≠nh kh·∫£ d·ª•ng khi h·ªá th·ªëng ph√¢n t√°n g·∫∑p s·ª± c·ªë. V√≠ d·ª•: <ul><li>M·∫•t th·ªùi gian ph·∫£n h·ªìi: Th√¥ng th∆∞·ªùng, c√¥ng c·ª• t√¨m ki·∫øm tr·ª±c tuy·∫øn ph·∫£i tr·∫£ v·ªÅ k·∫øt qu·∫£ trong v√≤ng 0,5 gi√¢y, nh∆∞ng khi g·∫∑p s·ª± c·ªë, th·ªùi gian ph·∫£n h·ªìi c√≥ th·ªÉ k√©o d√†i ƒë·∫øn 1~2 gi√¢y.</li><li>M·∫•t ch·ª©c nƒÉng: C√°ch ti·∫øp c·∫≠n th√¥ng th∆∞·ªùng l√† <strong>gi·∫£m c·∫•p d·ªãch v·ª•</strong>, ch·∫≥ng h·∫°n nh∆∞ kh√¥ng hi·ªÉn th·ªã c√°c th√†nh ph·∫ßn c√≥ th·ª© t·ª± tr√™n m·ªôt trang khi m·ªôt s·ªë th√†nh ph·∫ßn g·∫∑p s·ª± c·ªë, ch·ªâ hi·ªÉn th·ªã danh s√°ch kh√¥ng c√≥ th·ª© t·ª±.</li></ul></li><li><strong>Tr·∫°ng th√°i m·ªÅm</strong>: Cho ph√©p d·ªØ li·ªáu c·ªßa h·ªá th·ªëng t·ªìn t·∫°i ·ªü tr·∫°ng th√°i trung gian m√† kh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn t√≠nh kh·∫£ d·ª•ng t·ªïng th·ªÉ c·ªßa h·ªá th·ªëng, t·ª©c l√† d·ªØ li·ªáu gi·ªØa c√°c b·∫£n sao tr√™n c√°c n√∫t kh√°c nhau c√≥ th·ªÉ t·ªìn t·∫°i ƒë·ªô tr·ªÖ trong qu√° tr√¨nh ƒë·ªìng b·ªô h√≥a.</li><li><strong>Nh·∫•t qu√°n cu·ªëi c√πng</strong>: Nh·∫•n m·∫°nh r·∫±ng t·∫•t c·∫£ c√°c b·∫£n sao d·ªØ li·ªáu c·ªßa h·ªá th·ªëng, sau khi ƒë·ªìng b·ªô h√≥a trong m·ªôt kho·∫£ng th·ªùi gian, cu·ªëi c√πng s·∫Ω ƒë·∫°t ƒë∆∞·ª£c tr·∫°ng th√°i nh·∫•t qu√°n. Do ƒë√≥, b·∫£n ch·∫•t c·ªßa nh·∫•t qu√°n cu·ªëi c√πng l√† h·ªá th·ªëng ph·∫£i ƒë·∫£m b·∫£o d·ªØ li·ªáu cu·ªëi c√πng nh·∫•t qu√°n, nh∆∞ng kh√¥ng c·∫ßn ƒë·∫£m b·∫£o t√≠nh nh·∫•t qu√°n m·∫°nh m·∫Ω trong m·ªçi th·ªùi ƒëi·ªÉm.</li></ul><h2 id="nguoi-phong-van-hoi-ban-biet-cach-viet-mot-ƒëoan-ma-java-tao-ra-deadlock-khong" tabindex="-1"><a class="header-anchor" href="#nguoi-phong-van-hoi-ban-biet-cach-viet-mot-ƒëoan-ma-java-tao-ra-deadlock-khong"><span>Ng∆∞·ªùi ph·ªèng v·∫•n h·ªèi b·∫°n bi·∫øt c√°ch vi·∫øt m·ªôt ƒëo·∫°n m√£ Java t·∫°o ra deadlock kh√¥ng?</span></a></h2><p>C√¢u h·ªèi n√†y nh·∫±m ki·ªÉm tra m·ª©c ƒë·ªô hi·ªÉu bi·∫øt c·ªßa ·ª©ng vi√™n v·ªÅ deadlock (s·ª± b·∫ø t·∫Øc), v√† c√°ch ƒë·∫∑t c√¢u h·ªèi n√†y c≈©ng kh√° th√∫ v·ªã.</p><p>Tr∆∞·ªõc ti√™n, ƒë·ªÉ t·∫°o ra m·ªôt deadlock, c·∫ßn c√≥ b·ªën ƒëi·ªÅu ki·ªán sau:</p><ul><li><strong>S·ª≠ d·ª•ng ƒë·ªôc quy·ªÅn</strong>: Nghƒ©a l√† khi t√†i nguy√™n b·ªã m·ªôt lu·ªìng chi·∫øm gi·ªØ, c√°c lu·ªìng kh√°c kh√¥ng th·ªÉ s·ª≠ d·ª•ng t√†i nguy√™n ƒë√≥.</li><li><strong>Kh√¥ng th·ªÉ c∆∞·ª°ng ch·∫ø thu h·ªìi</strong>: Lu·ªìng y√™u c·∫ßu t√†i nguy√™n kh√¥ng th·ªÉ c∆∞·ª°ng √©p l·∫•y t√†i nguy√™n t·ª´ lu·ªìng ƒëang chi·∫øm gi·ªØ, m√† ch·ªâ c√≥ lu·ªìng chi·∫øm gi·ªØ m·ªõi c√≥ th·ªÉ t·ª± gi·∫£i ph√≥ng.</li><li><strong>Y√™u c·∫ßu v√† duy tr√¨</strong>: Khi lu·ªìng ƒëang y√™u c·∫ßu t√†i nguy√™n kh√°c, n√≥ v·∫´n gi·ªØ l·∫°i t√†i nguy√™n ban ƒë·∫ßu.</li><li><strong>Ch·ªù ƒë·ª£i v√≤ng tr√≤n</strong>: C√≥ m·ªôt v√≤ng tr√≤n ch·ªù ƒë·ª£i, nghƒ©a l√† lu·ªìng A c·∫ßn t√†i nguy√™n c·ªßa lu·ªìng B, trong khi lu·ªìng B l·∫°i c·∫ßn t√†i nguy√™n c·ªßa lu·ªìng A. ƒêi·ªÅu n√†y t·∫°o ra m·ªôt v√≤ng tr√≤n ch·ªù ƒë·ª£i.</li></ul><p>V·∫≠y, l√†m th·∫ø n√†o ƒë·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ deadlock?</p><ul><li><strong>Thi·∫øt l·∫≠p th·ªùi gian ch·ªù</strong>: N·∫øu kh√¥ng nh·∫≠n ƒë∆∞·ª£c kh√≥a trong m·ªôt kho·∫£ng th·ªùi gian nh·∫•t ƒë·ªãnh, thay v√¨ ch·ªù ƒë·ª£i m√£i, ch√∫ng ta s·∫Ω l√†m vi·ªác kh√°c, v√≠ d·ª• nh∆∞ s·ª≠ d·ª•ng ph∆∞∆°ng th·ª©c <code>tryLock</code> c·ªßa giao di·ªán <code>Lock</code> trong g√≥i JUC, thay v√¨ s·ª≠ d·ª•ng <code>synchronized</code> ƒë·ªÉ ch·ªù ƒë·ª£i v√¥ th·ªùi h·∫°n.</li><li><strong>Gi·∫£m ƒë·ªô ph√¢n t√°n c·ªßa kh√≥a</strong>: V√≠ d·ª•, n·∫øu m·ªôt l·ªõp s·ª≠ d·ª•ng m·ªôt kh√≥a ƒë·ªÉ b·∫£o v·ªá, n√≥ c√≥ th·ªÉ d·∫´n ƒë·∫øn hi·ªáu su·∫•t k√©m v√† tƒÉng nguy c∆° deadlock. N·∫øu c√≥ th·ªÉ, h√£y gi·∫£m thi·ªÉu vi·ªác s·ª≠ d·ª•ng kh√≥a, ch·ªâ s·ª≠ d·ª•ng khi th·ª±c s·ª± c·∫ßn thi·∫øt ƒë·ªÉ ƒë√°p ·ª©ng y√™u c·∫ßu nghi·ªáp v·ª•.</li><li><strong>Tr√°nh kh√≥a l·ªìng nhau</strong>: V√≠ d·ª• m√† ch√∫ng ta ƒë√£ tr√¨nh b√†y tr∆∞·ªõc ƒë√≥ l√† m·ªôt tr∆∞·ªùng h·ª£p c·ªßa kh√≥a l·ªìng nhau. Trong m√¥i tr∆∞·ªùng ƒëa lu·ªìng, n·∫øu th·ª© t·ª± l·∫•y kh√≥a b·ªã ƒë·∫£o ng∆∞·ª£c, s·∫Ω d·∫´n ƒë·∫øn deadlock.</li><li><strong>S·ª≠ d·ª•ng kh√≥a chuy√™n d·ª•ng</strong>: Kh√¥ng n√™n s·ª≠ d·ª•ng c√πng m·ªôt kh√≥a cho nhi·ªÅu ch·ª©c nƒÉng kh√°c nhau, ƒëi·ªÅu n√†y gi√∫p tr√°nh xung ƒë·ªôt kh√≥a. N·∫øu nhi·ªÅu lu·ªìng s·ª≠ d·ª•ng c√πng m·ªôt kh√≥a, r·∫•t d·ªÖ g√¢y ra deadlock.</li><li><strong>Thu·∫≠t to√°n Banker</strong>: ƒê√¢y l√† m·ªôt thu·∫≠t to√°n n·ªïi ti·∫øng, c·ªët l√µi c·ªßa n√≥ l√† tr∆∞·ªõc khi ph√¢n b·ªï t√†i nguy√™n, h·ªá th·ªëng s·∫Ω ki·ªÉm tra xem li·ªáu c√≥ th·ªÉ thu h·ªìi t√†i nguy√™n hay kh√¥ng. N·∫øu kh√¥ng thu h·ªìi ƒë∆∞·ª£c t√†i nguy√™n v√† c√≥ kh·∫£ nƒÉng g√¢y ra deadlock, h·ªá th·ªëng s·∫Ω kh√¥ng ph√¢n b·ªï t√†i nguy√™n cho lu·ªìng ƒë√≥. Ng∆∞·ª£c l·∫°i, n·∫øu c√≥ th·ªÉ thu h·ªìi ƒë∆∞·ª£c t√†i nguy√™n, h·ªá th·ªëng s·∫Ω ph√¢n b·ªï t√†i nguy√™n.</li></ul><h2 id="chi-muc-an-trong-mysql-8" tabindex="-1"><a class="header-anchor" href="#chi-muc-an-trong-mysql-8"><span>Ch·ªâ m·ª•c ·∫©n trong MySQL 8</span></a></h2><p>MySQL 8 h·ªó tr·ª£ t√≠nh nƒÉng <strong>Invisible Indexes</strong> (ch·ªâ m·ª•c ·∫©n), cho ph√©p m·ªôt ch·ªâ m·ª•c kh√¥ng ƒë∆∞·ª£c s·ª≠ d·ª•ng b·ªüi b·ªô t·ªëi ∆∞u h√≥a khi t·∫°o k·∫ø ho·∫°ch truy v·∫•n nh∆∞ng v·∫´n ƒë∆∞·ª£c duy tr√¨ khi d·ªØ li·ªáu thay ƒë·ªïi.</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">-- ƒê·∫∑t ch·ªâ m·ª•c l√†m ch·ªâ m·ª•c ·∫©n</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">ALTER</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> TABLE</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> xxx </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">ALTER</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> INDEX</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> xxx INVISIBLE;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">-- ƒê·∫∑t ch·ªâ m·ª•c l√†m ch·ªâ m·ª•c hi·ªán</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">ALTER</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> TABLE</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> xxx </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">ALTER</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> INDEX</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> xxx VISIBLE;</span></span></code></pre></div><h2 id="phuong-thuc-ƒëuoc-sua-ƒëoi-boi-private-co-the-truy-cap-thong-qua-phan-chieu-vay-y-nghia-cua-private-la-gi" tabindex="-1"><a class="header-anchor" href="#phuong-thuc-ƒëuoc-sua-ƒëoi-boi-private-co-the-truy-cap-thong-qua-phan-chieu-vay-y-nghia-cua-private-la-gi"><span>Ph∆∞∆°ng th·ª©c ƒë∆∞·ª£c s·ª≠a ƒë·ªïi b·ªüi <code>private</code> c√≥ th·ªÉ truy c·∫≠p th√¥ng qua ph·∫£n chi·∫øu, v·∫≠y √Ω nghƒ©a c·ªßa <code>private</code> l√† g√¨?</span></a></h2><p>Trong Java, khi ch√∫ng ta kh√¥ng mu·ªën ng∆∞·ªùi kh√°c truy c·∫≠p v√†o m·ªôt s·ªë thu·ªôc t√≠nh ho·∫∑c ph∆∞∆°ng th·ª©c, c√°ch th√¥ng th∆∞·ªùng l√† s·ª≠ d·ª•ng t·ª´ kh√≥a <code>private</code> ƒë·ªÉ s·ª≠a ƒë·ªïi. Tuy nhi√™n, Java ƒë∆∞·ª£c thi·∫øt k·∫ø cho ph√©p truy c·∫≠p nh·ªØng ph∆∞∆°ng th·ª©c n√†y th√¥ng qua c∆° ch·∫ø ph·∫£n chi·∫øu (reflection), ch·ªâ c·∫ßn t·∫Øt ki·ªÉm tra quy·ªÅn truy c·∫≠p l√† ƒë∆∞·ª£c.</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> java.lang.reflect.Field</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> Test</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[] </span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">args</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        C</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> c</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> C</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        try</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            Field</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> f</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> C</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">class</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">getDeclaredField</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;a&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            f</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">setAccessible</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            Integer</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> (Integer) </span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">f</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(c);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            System</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">out</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">println</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(i);</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">        } </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Exception</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> e</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) {}</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> C</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> Integer</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> a </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 6</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>V·∫≠y, ph·∫£i chƒÉng t·ª´ kh√≥a <code>private</code> ƒë√£ m·∫•t ƒëi √Ω nghƒ©a ban ƒë·∫ßu c·ªßa n√≥?</p><p>Th·ª±c ra kh√¥ng ph·∫£i v·∫≠y. T·ª´ kh√≥a <code>private</code> ch·ªß y·∫øu ph·∫£n √°nh kh√°i ni·ªám ƒë√≥ng g√≥i d·ª±a tr√™n t∆∞ t∆∞·ªüng OOP (l·∫≠p tr√¨nh h∆∞·ªõng ƒë·ªëi t∆∞·ª£ng), v√† n√≥ l√† m·ªôt r√†ng bu·ªôc cho ng∆∞·ªùi s·ª≠ d·ª•ng, kh√¥ng ph·∫£i l√† m·ªôt c∆° ch·∫ø b·∫£o m·∫≠t. V√≠ d·ª•, khi b·∫°n l√°i xe tr√™n ƒë∆∞·ªùng, h·ªá th·ªëng ƒë·ªãnh v·ªã c√≥ th·ªÉ nh·∫Øc nh·ªü b·∫°n gi·ªõi h·∫°n t·ªëc ƒë·ªô, ƒë√≥ l√† quy ƒë·ªãnh c·ªßa ph√°p lu·∫≠t giao th√¥ng, nh∆∞ng khi xe c·ª©u th∆∞∆°ng g·∫∑p tr∆∞·ªùng h·ª£p kh·∫©n c·∫•p, h·ªç c√≥ th·ªÉ v∆∞·ª£t qu√° t·ªëc ƒë·ªô quy ƒë·ªãnh. ƒê√¢y ch√≠nh l√† s·ª± kh√°c bi·ªát gi·ªØa hai v·∫•n ƒë·ªÅ n√†y.</p><p>Khi b·∫°n s·ª≠ d·ª•ng IoC c·ªßa Spring, b·∫°n bi·∫øt r·∫±ng c·∫ßn th·ª±c hi·ªán ‚Äúinjection‚Äù (ti√™m), b·∫•t k·ªÉ thu·ªôc t√≠nh ƒë√≥ l√† <code>private</code>, v·∫´n c√≥ th·ªÉ ƒë∆∞·ª£c ti√™m v√†o, ƒë√∫ng kh√¥ng?</p><p>N·∫øu b·∫°n tu√¢n th·ªß quy t·∫Øc n√†y, th√¨ c√°c nh√† ph√°t tri·ªÉn c√≥ th·ªÉ ƒë·∫£m b·∫£o r·∫±ng s·∫Ω kh√¥ng g·∫∑p v·∫•n ƒë·ªÅ n√†o, nh∆∞ng n·∫øu kh√¥ng tu√¢n th·ªß, c√≥ th·ªÉ g√¢y ra h·∫≠u qu·∫£ th·∫£m kh·ªëc ·ªü nh·ªØng n∆°i kh√¥ng ng·ªù t·ªõi.</p><h2 id="tinh-nang-moi-cua-mysql8-chi-muc-sap-xep-theo-thu-tu-giam-dan" tabindex="-1"><a class="header-anchor" href="#tinh-nang-moi-cua-mysql8-chi-muc-sap-xep-theo-thu-tu-giam-dan"><span>T√≠nh nƒÉng m·ªõi c·ªßa MySQL8 - Ch·ªâ m·ª•c s·∫Øp x·∫øp theo th·ª© t·ª± gi·∫£m d·∫ßn</span></a></h2><p>Ch·ªâ m·ª•c s·∫Øp x·∫øp gi·∫£m d·∫ßn, nh∆∞ t√™n g·ªçi, ch·ªâ l√† ch·ªâ m·ª•c ƒë∆∞·ª£c s·∫Øp x·∫øp theo th·ª© t·ª± t·ª´ l·ªõn ƒë·∫øn nh·ªè, ng∆∞·ª£c l·∫°i v·ªõi ch·ªâ m·ª•c s·∫Øp x·∫øp theo th·ª© t·ª± tƒÉng d·∫ßn. Th√¥ng th∆∞·ªùng, c√°c ch·ªâ m·ª•c m√† ch√∫ng ta t·∫°o ra ƒë·ªÅu l√† ch·ªâ m·ª•c s·∫Øp x·∫øp tƒÉng d·∫ßn.</p><p>Khi c√¢u l·ªánh SQL c·ªßa ch√∫ng ta ch·ªâ ch·ª©a m·ªôt c·ªôt, hi·ªáu su·∫•t truy v·∫•n gi·ªØa ch·ªâ m·ª•c s·∫Øp x·∫øp tƒÉng d·∫ßn v√† gi·∫£m d·∫ßn l√† nh∆∞ nhau. Tuy nhi√™n, khi c√¢u l·ªánh SQL ch·ª©a nhi·ªÅu c·ªôt m√† m·ªói c·ªôt c√≥ th·ª© t·ª± s·∫Øp x·∫øp kh√°c nhau, ch·ªâ m·ª•c s·∫Øp x·∫øp gi·∫£m d·∫ßn s·∫Ω ph√°t huy t√°c d·ª•ng quan tr·ªçng. Ch√∫ng ta s·∫Ω ph√¢n t√≠ch chi ti·∫øt h∆°n v·ªÅ ƒëi·ªÅu n√†y sau.</p><h2 id="tinh-nang-moi-cua-mysql8-thay-ƒëoi-bo-ky-tu-mac-ƒëinh" tabindex="-1"><a class="header-anchor" href="#tinh-nang-moi-cua-mysql8-thay-ƒëoi-bo-ky-tu-mac-ƒëinh"><span>T√≠nh nƒÉng m·ªõi c·ªßa MySQL8 - Thay ƒë·ªïi b·ªô k√Ω t·ª± m·∫∑c ƒë·ªãnh</span></a></h2><p>Tr∆∞·ªõc phi√™n b·∫£n MySQL 8.0, b·ªô k√Ω t·ª± m·∫∑c ƒë·ªãnh l√† <code>latin-1</code>, v√† b·ªô k√Ω t·ª± UTF8 th·ª±c ra l·∫°i ch·ªâ tr·ªè ƒë·∫øn <code>utf8mb3</code>. ƒêi·ªÅu n√†y c√≥ th·ªÉ ƒë√£ l√†m kh√≥ kh√¥ng √≠t ng∆∞·ªùi, b·ªüi c√°i t√™n c·ªßa n√≥ g√¢y hi·ªÉu l·∫ßm r·∫•t l·ªõn. Khi l∆∞u tr·ªØ c√°c k√Ω t·ª± ƒë·∫∑c bi·ªát ho·∫∑c bi·ªÉu t∆∞·ª£ng c·∫£m x√∫c, h·ªá th·ªëng c√≥ th·ªÉ b√°o l·ªói SQL.</p><div class="language-java" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">SQLException</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">:</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> Incorrect</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> string value</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">:</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> ‚Äò\xF0\xA1\x8B\xBE\xE5\xA2‚Ä¶‚Äô </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> column ‚Äòname‚Äô</span></span></code></pre></div><p><code>utf8mb3</code> th·ª±c ra l√† vi·∫øt t·∫Øt c·ªßa &quot;most bytes&quot;, nghƒ©a l√† s·ªë byte t·ªëi ƒëa m√† m·ªôt k√Ω t·ª± c√≥ th·ªÉ chi·∫øm. Trong MySQL, ƒë·ªô d√†i chu·ªói ƒë∆∞·ª£c t√≠nh b·∫±ng s·ªë k√Ω t·ª±, kh√¥ng ph·∫£i s·ªë byte. Do ƒë√≥, v·ªõi lo·∫°i d·ªØ li·ªáu <code>char</code>, c·∫ßn d√†nh ƒë·ªß kh√¥ng gian cho c√°c k√Ω t·ª±. Khi s·ª≠ d·ª•ng b·ªô k√Ω t·ª± <code>utf8</code>, gi·ªõi h·∫°n ƒë·ªô d√†i t·ªëi ƒëa l√† 3 byte. N·∫øu mu·ªën c√≥ kh·∫£ nƒÉng t∆∞∆°ng th√≠ch t·ªët h∆°n, n√™n s·ª≠ d·ª•ng <code>utf8mb4</code> thay v√¨ <code>utf8</code>, m·∫∑c d√π c√≥ th·ªÉ t·ªën th√™m m·ªôt √≠t kh√¥ng gian. MySQL khuy·∫øn ngh·ªã s·ª≠ d·ª•ng VARCHAR thay cho CHAR.</p><p>T·ª´ MySQL 8.0 tr·ªü ƒëi, b·ªô m√£ m·∫∑c ƒë·ªãnh ƒë√£ ƒë∆∞·ª£c thay ƒë·ªïi t·ª´ <code>latin1</code> th√†nh <code>utf8mb4</code>, gi√∫p tr√°nh nh·ªØng v·∫•n ƒë·ªÅ c√≥ th·ªÉ g·∫∑p ph·∫£i n·∫øu qu√™n thay ƒë·ªïi b·ªô k√Ω t·ª±, v√† ch√∫ng ta s·∫Ω kh√¥ng c·∫ßn lo l·∫Øng nhi·ªÅu v·ªÅ b·ªô k√Ω t·ª± n·ªØa.</p><h2 id="bat-ngo-mysql8-ƒëa-loai-bo-bo-nho-ƒëem-truy-van" tabindex="-1"><a class="header-anchor" href="#bat-ngo-mysql8-ƒëa-loai-bo-bo-nho-ƒëem-truy-van"><span>B·∫•t ng·ªù: MySQL8 ƒë√£ lo·∫°i b·ªè b·ªô nh·ªõ ƒë·ªám truy v·∫•n!!!</span></a></h2><p>Ngay c·∫£ nh·ªØng t√≠nh nƒÉng l·ªõn c≈©ng ƒë·∫øn l√∫c ph·∫£i k·∫øt th√∫c. MySQL 8.0 ƒë√£ ch√≠nh th·ª©c lo·∫°i b·ªè t√≠nh nƒÉng <code>Query Cache</code> (b·ªô nh·ªõ ƒë·ªám truy v·∫•n). T√≠nh nƒÉng n√†y ƒë√£ b·ªã ƒë√°nh d·∫•u l√† kh√¥ng ƒë∆∞·ª£c khuy·∫øn kh√≠ch s·ª≠ d·ª•ng (Deprecated) t·ª´ phi√™n b·∫£n 5.7, v√† m·∫∑c ƒë·ªãnh b·ªã t·∫Øt.</p><p>V·∫≠y t·∫°i sao t√≠nh nƒÉng n√†y l·∫°i b·ªã lo·∫°i b·ªè? M·ª•c ti√™u ban ƒë·∫ßu c·ªßa n√≥ l√† g√¨? H√£y c√πng nhau t√¨m hi·ªÉu s√¢u h∆°n t·ª´ng b∆∞·ªõc ƒë·ªÉ hi·ªÉu r√µ v·∫•n ƒë·ªÅ.</p><h3 id="bo-nho-ƒëem-truy-van" tabindex="-1"><a class="header-anchor" href="#bo-nho-ƒëem-truy-van"><span>B·ªô nh·ªõ ƒë·ªám truy v·∫•n</span></a></h3><blockquote><p>The query cache stores the text of a <a href="https://docs.oracle.com/cd/E17952_01/mysql-5.6-en/select.html" target="_blank" rel="noopener noreferrer">SELECT</a> statement together with the corresponding result that was sent to the client. If an identical statement is received later, the server retrieves the results from the query cache rather than parsing and executing the statement again. The query cache is shared among sessions, so a result set generated by one client can be sent in response to the same query issued by another client. The query cache can be useful in an environment where you have tables that do not change very often and for which the server receives many identical queries. This is a typical situation for many Web servers that generate many dynamic pages based on database content. The query cache does not return stale data. When tables are modified, any relevant entries in the query cache are flushed.</p></blockquote><p>B·ªô nh·ªõ ƒë·ªám truy v·∫•n l∆∞u tr·ªØ vƒÉn b·∫£n c·ªßa c√¢u l·ªánh SELECT v√† k·∫øt qu·∫£ t∆∞∆°ng ·ª©ng g·ª≠i ƒë·∫øn kh√°ch h√†ng. N·∫øu m·ªôt c√¢u l·ªánh t∆∞∆°ng t·ª± ƒë∆∞·ª£c nh·∫≠n sau ƒë√≥, m√°y ch·ªß s·∫Ω truy xu·∫•t k·∫øt qu·∫£ t·ª´ b·ªô nh·ªõ ƒë·ªám truy v·∫•n thay v√¨ ph·∫£i ph√¢n t√≠ch v√† th·ª±c thi c√¢u l·ªánh l·∫°i. B·ªô nh·ªõ ƒë·ªám n√†y chia s·∫ª gi·ªØa c√°c phi√™n, v√¨ v·∫≠y m·ªôt t·∫≠p k·∫øt qu·∫£ t·∫°o ra b·ªüi m·ªôt kh√°ch h√†ng c√≥ th·ªÉ ƒë∆∞·ª£c g·ª≠i cho truy v·∫•n t∆∞∆°ng t·ª± c·ªßa kh√°ch h√†ng kh√°c.</p><p>B·ªô nh·ªõ ƒë·ªám truy v·∫•n r·∫•t h·ªØu √≠ch trong m√¥i tr∆∞·ªùng m√† c√°c b·∫£ng kh√¥ng thay ƒë·ªïi th∆∞·ªùng xuy√™n v√† m√°y ch·ªß nh·∫≠n ƒë∆∞·ª£c nhi·ªÅu truy v·∫•n gi·ªëng nhau. ƒê√¢y l√† t√¨nh hu·ªëng ƒëi·ªÉn h√¨nh ƒë·ªëi v·ªõi nhi·ªÅu m√°y ch·ªß web t·∫°o ra c√°c trang ƒë·ªông d·ª±a tr√™n n·ªôi dung c∆° s·ªü d·ªØ li·ªáu.</p><p>B·ªô nh·ªõ ƒë·ªám truy v·∫•n kh√¥ng tr·∫£ v·ªÅ d·ªØ li·ªáu l·ªói th·ªùi. Khi c√°c b·∫£ng ƒë∆∞·ª£c s·ª≠a ƒë·ªïi, c√°c m·ª•c li√™n quan trong b·ªô nh·ªõ ƒë·ªám s·∫Ω b·ªã x√≥a.</p><p>Tr√≠ch t·ª´ t√†i li·ªáu ch√≠nh th·ª©c c·ªßa MySQL: <a href="https://docs.oracle.com/cd/E17952_01/mysql-5.6-en/query-cache.html" target="_blank" rel="noopener noreferrer">https://docs.oracle.com/cd/E17952_01/mysql-5.6-en/query-cache.html</a></p><h3 id="nguyen-ly-hoat-ƒëong" tabindex="-1"><a class="header-anchor" href="#nguyen-ly-hoat-ƒëong"><span>Nguy√™n l√Ω ho·∫°t ƒë·ªông</span></a></h3><p>Tr∆∞·ªõc khi ph√¢n t√≠ch, MySQL so s√°nh truy v·∫•n v·ªõi c√°c truy v·∫•n trong b·ªô nh·ªõ ƒë·ªám. V√¨ v·∫≠y, b·ªô nh·ªõ ƒë·ªám truy v·∫•n coi hai truy v·∫•n sau l√† kh√°c nhau:</p><div class="language-" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span>SELECT * FROM tbl_name</span></span>
<span class="line"><span>Select * from tbl_name</span></span></code></pre></div><p>M·∫∑c d√π hai c√¢u truy v·∫•n c√≥ nghƒ©a gi·ªëng nhau, MySQL s·∫Ω t·∫°o ra m·ªôt gi√° tr·ªã hash cho c√¢u l·ªánh SQL. D√π ch·ªâ kh√°c nhau ·ªü ch·ªØ vi·∫øt hoa v√† vi·∫øt th∆∞·ªùng, ch√∫ng v·∫´n ƒë∆∞·ª£c coi l√† hai truy v·∫•n kh√°c nhau.</p><p>Sau ƒë√≥, gi√° tr·ªã hash v√† k·∫øt qu·∫£ truy v·∫•n s·∫Ω ƒë∆∞·ª£c l∆∞u v√†o Query Cache. Nh·ªØng truy v·∫•n ti·∫øp theo s·∫Ω so s√°nh gi√° tr·ªã hash, n·∫øu tr√πng kh·ªõp th√¨ tr·∫£ v·ªÅ k·∫øt qu·∫£ t·ª´ b·ªô nh·ªõ ƒë·ªám, n·∫øu kh√¥ng th√¨ s·∫Ω truy v·∫•n l·∫°i c∆° s·ªü d·ªØ li·ªáu.</p><p>Ban ƒë·∫ßu, MySQL thi·∫øt k·∫ø Query Cache ƒë·ªÉ c·∫£i thi·ªán hi·ªáu su·∫•t truy v·∫•n v√¨ khu v·ª±c Query Cache ƒë∆∞·ª£c l∆∞u trong b·ªô nh·ªõ. N·∫øu c√≥ nhi·ªÅu truy v·∫•n l·∫∑p l·∫°i, h·ªá th·ªëng kh√¥ng c·∫ßn th·ª±c hi·ªán l·∫°i c√°c b∆∞·ªõc nh∆∞ ph√¢n t√≠ch SQL, t·ªëi ∆∞u h√≥a, truy v·∫•n ƒëƒ©a c·ª©ng, t·ª´ ƒë√≥ c·∫£i thi·ªán hi·ªáu su·∫•t ƒë√°ng k·ªÉ.</p><p><strong>C√≥ v·∫ª r·∫•t tuy·ªát, v·∫≠y t·∫°i sao MySQL l·∫°i lo·∫°i b·ªè t√≠nh nƒÉng n√†y?</strong></p><ul><li>Th·ª© nh·∫•t, nh∆∞ ƒë√£ ƒë·ªÅ c·∫≠p, m·∫∑c d√π hai c√¢u l·ªánh SQL gi·ªëng nhau v·ªÅ k·∫øt qu·∫£ nh∆∞ng ch·ªâ c·∫ßn kh√°c bi·ªát nh·ªè (ch·ªØ hoa, ch·ªØ th∆∞·ªùng) c≈©ng khi·∫øn b·ªô nh·ªõ ƒë·ªám kh√¥ng ƒë∆∞·ª£c s·ª≠ d·ª•ng. Trong m√¥i tr∆∞·ªùng s·∫£n xu·∫•t th·ª±c t·∫ø, nhi·ªÅu truy v·∫•n t∆∞∆°ng t·ª± nhau v·∫´n tr·∫£ v·ªÅ k·∫øt qu·∫£ gi·ªëng nhau nh∆∞ng do c√°c quy t·∫Øc so s√°nh kh·∫Øt khe, b·ªô nh·ªõ ƒë·ªám kh√¥ng ƒë∆∞·ª£c t·∫≠n d·ª•ng.</li><li>Th·ª© hai, ch√≠nh s√°ch h·∫øt h·∫°n b·ªô nh·ªõ ƒë·ªám c≈©ng r·∫•t nghi√™m ng·∫∑t. Ch·ªâ c·∫ßn c√≥ b·∫•t k·ª≥ thay ƒë·ªïi n√†o trong d·ªØ li·ªáu (th√™m, x√≥a, s·ª≠a), ho·∫∑c ƒëi·ªÅu ch·ªânh c·∫•u tr√∫c b·∫£ng, b·ªô nh·ªõ ƒë·ªám s·∫Ω b·ªã v√¥ hi·ªáu. ƒêi·ªÅu n√†y ch·ªâ c√≥ √Ω nghƒ©a trong c√°c m√¥i tr∆∞·ªùng ƒë·ªçc nhi·ªÅu h∆°n vi·∫øt. ƒê·ªëi v·ªõi c√°c m√¥i tr∆∞·ªùng ƒë·ªçc/ghi c√¢n b·∫±ng ho·∫∑c vi·∫øt nhi·ªÅu h∆°n ƒë·ªçc, Query Cache kh√¥ng c√≥ gi√° tr·ªã nhi·ªÅu.</li><li>Th·ª© ba, n·∫øu s·ª≠ d·ª•ng b·∫£ng ph√¢n v√πng, Query Cache s·∫Ω b·ªã v√¥ hi·ªáu v√† kh√¥ng ho·∫°t ƒë·ªông.</li><li>Th·ª© t∆∞, khi Query Cache ƒë∆∞·ª£c k√≠ch ho·∫°t, n·∫øu truy v·∫•n kh√¥ng kh·ªõp v·ªõi b·ªô nh·ªõ ƒë·ªám, MySQL s·∫Ω m·∫•t th√™m t√†i nguy√™n ƒë·ªÉ x·ª≠ l√Ω v√† ghi v√†o Query Cache. Trong tr∆∞·ªùng h·ª£p t·ªìi t·ªá nh·∫•t, vi·ªác n√†y ti√™u t·ªën kho·∫£ng 13% hi·ªáu su·∫•t, m·∫∑c d√π trong c√°c tr∆∞·ªùng h·ª£p th·ª±c t·∫ø, m·ª©c ti√™u t·ªën c√≥ th·ªÉ th·∫•p h∆°n nh∆∞ng v·∫´n l√† m·ªôt s·ª± m·∫•t m√°t kh√¥ng c·∫ßn thi·∫øt.</li><li>M·ªôt s·ªë h√†m c·ª• th·ªÉ trong SQL (nh∆∞ <code>now()</code>) s·∫Ω kh√¥ng s·ª≠ d·ª•ng b·ªô nh·ªõ ƒë·ªám.</li></ul><p>T√≥m l·∫°i, MySQL √°p ƒë·∫∑t nhi·ªÅu h·∫°n ch·∫ø v·ªõi Query Cache, nh∆∞ng trong m√¥i tr∆∞·ªùng s·∫£n xu·∫•t, nhi·ªÅu truy v·∫•n s·∫Ω kh√¥ng s·ª≠ d·ª•ng ƒë∆∞·ª£c b·ªô nh·ªõ ƒë·ªám do c√°c ƒëi·ªÅu ki·ªán gi·ªõi h·∫°n. V√¨ v·∫≠y, MySQL ƒë√£ quy·∫øt ƒë·ªãnh lo·∫°i b·ªè Query Cache v√† thay th·∫ø b·∫±ng c√°c gi·∫£i ph√°p kh√°c.</p><blockquote><p>Assuming that scalability could be improved, the limiting factor of the query cache is that since only queries that hit the cache will see improvement; it is unlikely to improve <em>predictability of performance.</em> For user facing systems, reducing the <em>variability</em> of performance is often more important than improving <em>peak throughput</em>:</p></blockquote><p>MySQL ƒë√£ quy·∫øt ƒë·ªãnh lo·∫°i b·ªè ho√†n to√†n Query Cache trong phi√™n b·∫£n 8.0 v√† ƒë·ªÅ xu·∫•t s·ª≠ d·ª•ng c√¥ng c·ª• thay th·∫ø b√™n th·ª© ba l√† ProxySQL ƒë·ªÉ thay th·∫ø Query Cache.</p><p>Nh∆∞ trong h√¨nh d∆∞·ªõi ƒë√¢y, MySQL ƒë√£ so s√°nh hi·ªáu su·∫•t gi·ªØa ProxySQL v√† Query Cache nguy√™n b·∫£n, c√≥ th·ªÉ th·∫•y ProxySQL v∆∞·ª£t tr·ªôi h∆°n h·∫≥n v·ªÅ hi·ªáu su·∫•t truy v·∫•n.</p><figure><img src="https://cdn.nlark.com/yuque/0/2022/png/8380143/1670317738162-e224abb6-ea76-479c-a861-4e762f47d2a9.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/vanhung4499/my-wiki/edit/main/src/interview/knowledge/combine/complete-java-interview-qa.md" aria-label="Edit this page on GitHub" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page on GitHub<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">Last update: </span><!----></div><div class="contributors"><span class="vp-meta-label">Contributors: </span><!--[--><!--[--><span class="vp-meta-info" title="email: vanhung4499@gmail.com">Hung Nguyen Van</span><!--]--><!--]--></div></div></footer><!----><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper" style="display:none;--1ea755b8:;"><div class="footer-content"><div class="footer">Made with ‚ù§Ô∏è by Hung Nguyen</div><div class="copyright">Copyright ¬© 2016-2024 Hung Nguyen</div></div><span id="runtime_span"></span></footer></div><!--]--><!--[--><!----><!----><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-CmlOSuIY.js" defer></script>
  </body>
</html>
