<!doctype html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.15" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.52" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://vanhung4499.github.io/interview/knowledge/mysql/mysql-qa.html"><meta property="og:site_name" content="VanHung4499"><meta property="og:title" content="MySQL Q&A"><meta property="og:description" content="60 C√¢u H·ªèi Ph·ªèng V·∫•n C∆° S·ªü D·ªØ Li·ªáu ƒê∆∞·ª£c Ch·ªçn L·ªçc: Ph·∫£i Xem: H√¨nh ·∫£nh v√† gi·∫£i th√≠ch chi ti·∫øt 60 c√¢u h·ªèi ph·ªèng v·∫•n MySQL th∆∞·ªùng g·∫∑p, l·∫ßn n√†y t√¥i s·∫Ω d·ªÖ d√†ng v∆∞·ª£t qua ph·ªèng v·∫•n vi√™n..."><meta property="og:type" content="article"><meta property="og:image" content="https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/herongwei/mysql-a2b8e123-41cb-4717-9225-3a8b49197004.png"><meta property="og:locale" content="en-US"><meta property="og:updated_time" content="2024-10-02T17:20:50.000Z"><meta property="article:author" content="Hung Nguyen"><meta property="article:tag" content="interview"><meta property="article:tag" content="mysql"><meta property="article:modified_time" content="2024-10-02T17:20:50.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"MySQL Q&A","image":["https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/herongwei/mysql-a2b8e123-41cb-4717-9225-3a8b49197004.png","https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/herongwei/mysql-11420486-f9d0-483a-ba2e-a742ec4c518d.png","https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/herongwei/mysql-ee8a859f-d1e8-4ab6-94d1-9733373be825.png"],"dateModified":"2024-10-02T17:20:50.000Z","author":[{"@type":"Person","name":"Hung Nguyen","url":"https://vanhung4499.github.io"}]}</script><meta name="referrer" content="no-referrer-when-downgrade"><link rel="alternate" type="application/rss+xml" href="https://vanhung4499.github.io/rss.xml" title="VanHung4499 RSS Feed"><title>MySQL Q&A | VanHung4499</title><meta name="description" content="60 C√¢u H·ªèi Ph·ªèng V·∫•n C∆° S·ªü D·ªØ Li·ªáu ƒê∆∞·ª£c Ch·ªçn L·ªçc: Ph·∫£i Xem: H√¨nh ·∫£nh v√† gi·∫£i th√≠ch chi ti·∫øt 60 c√¢u h·ªèi ph·ªèng v·∫•n MySQL th∆∞·ªùng g·∫∑p, l·∫ßn n√†y t√¥i s·∫Ω d·ªÖ d√†ng v∆∞·ª£t qua ph·ªèng v·∫•n vi√™n...">
    <link rel="preload" href="/assets/style-DFXXOFfS.css" as="style"><link rel="stylesheet" href="/assets/style-DFXXOFfS.css">
    <link rel="modulepreload" href="/assets/app-CIGQMwlz.js"><link rel="modulepreload" href="/assets/mysql-qa.html-DMwgE9_g.js">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">Skip to main content</a><!--]--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo" src="/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">VanHung4499</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="Home"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:home" width="1em" height="1em"></iconify-icon><!--]-->Home<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/wiki.html" aria-label="Wiki"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="carbon:wikis" width="1em" height="1em"></iconify-icon><!--]-->Wiki<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/dsa/" aria-label="Algorithms"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="hugeicons:algorithm" width="1em" height="1em"></iconify-icon><!--]-->Algorithms<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Programming"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:code" width="1em" height="1em"></iconify-icon>Programming<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/java/" aria-label="Java"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:java" width="1em" height="1em"></iconify-icon><!--]-->Java<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/golang/" aria-label="Golang"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:go" width="1em" height="1em"></iconify-icon><!--]-->Golang<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/js/" aria-label="JavaScript"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:javascript" width="1em" height="1em"></iconify-icon><!--]-->JavaScript<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/ts/" aria-label="TypeScript"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:typescript" width="1em" height="1em"></iconify-icon><!--]-->TypeScript<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/python/" aria-label="Python"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:python" width="1em" height="1em"></iconify-icon><!--]-->Python<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Database"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:database" width="1em" height="1em"></iconify-icon>Database<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/sql/" aria-label="SQL"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:sql-query" width="1em" height="1em"></iconify-icon><!--]-->SQL<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/mysql/" aria-label="MySQL"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:mysql" width="1em" height="1em"></iconify-icon><!--]-->MySQL<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/mongodb/" aria-label="MongoDB"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:mongodb" width="1em" height="1em"></iconify-icon><!--]-->MongoDB<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/redis/" aria-label="Redis"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/elasticsearch/" aria-label="Elasticsearch"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:elasticsearch" width="1em" height="1em"></iconify-icon><!--]-->Elasticsearch<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/elastic/" aria-label="Elastic Stack"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="cib:elastic-stack" width="1em" height="1em"></iconify-icon><!--]-->Elastic Stack<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Framework"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="simple-icons:framework" width="1em" height="1em"></iconify-icon>Framework<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/spring/" aria-label="Spring"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->Spring<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/spring-boot/" aria-label="Spring Boot"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->Spring Boot<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/nestjs/" aria-label="NestJS"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:nestjs" width="1em" height="1em"></iconify-icon><!--]-->NestJS<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/gin/" aria-label="Gin"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="logos:gin" width="1em" height="1em"></iconify-icon><!--]-->Gin<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="DevOps"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon-plain:azuredevops" width="1em" height="1em"></iconify-icon>DevOps<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/docker/" aria-label="Docker"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:docker" width="1em" height="1em"></iconify-icon><!--]-->Docker<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/kubernetes/" aria-label="Kubernetes"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:kubernetes" width="1em" height="1em"></iconify-icon><!--]-->Kubernetes<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/jenkins/" aria-label="Jenkins"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:jenkins" width="1em" height="1em"></iconify-icon><!--]-->Jenkins<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/git/" aria-label="Git"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:git" width="1em" height="1em"></iconify-icon><!--]-->Git<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/linux/" aria-label="Linux"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:linux" width="1em" height="1em"></iconify-icon><!--]-->Linux<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Design"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="tdesign:system-sum" width="1em" height="1em"></iconify-icon>Design<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/design/design-pattern/" aria-label="Design Pattern"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="tabler:grid-pattern" width="1em" height="1em"></iconify-icon><!--]-->Design Pattern<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/design/system-design/" aria-label="System Design"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="icon-park-outline:system" width="1em" height="1em"></iconify-icon><!--]-->System Design<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Project"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="ant-design:project-outlined" width="1em" height="1em"></iconify-icon>Project<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/project/rouyi-vue-pro/" aria-label="Rouyi Vue Pro"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->Rouyi Vue Pro<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/project/yudao-cloud/" aria-label="Yudao Cloud"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->Yudao Cloud<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="route-link route-link-active auto-link" href="/interview/" aria-label="Interview"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:account-tie" width="1em" height="1em"></iconify-icon><!--]-->Interview<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="About"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:about" width="1em" height="1em"></iconify-icon>About<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/about-me.html" aria-label="About me"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="cib:about-me" width="1em" height="1em"></iconify-icon><!--]-->About me<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/about.html" aria-label="About"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:about" width="1em" height="1em"></iconify-icon><!--]-->About<!----></a></li></ul></button></div></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/vanhung4499/my-wiki" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><!--[--><button type="button" class="search-pro-button" aria-label="Search"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon" name="search"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">Search</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><a class="route-link route-link-active auto-link vp-sidebar-title no-external-link-icon" href="/interview/knowledge/" aria-label="Knowledge"><!---->Knowledge<!----></a><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Combine</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Java</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">My</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">Mysql</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/interview/knowledge/mysql/mysql-qa.html" aria-label="MySQL Q&amp;A"><!---->MySQL Q&amp;A<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/interview/knowledge/mysql/mysql-index-qa.html" aria-label="MySQL Index Q&amp;A"><!---->MySQL Index Q&amp;A<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Redis</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Prepare</span><span class="vp-arrow end"></span></button><!----></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->MySQL Q&amp;A</h1><div class="page-info"><span class="page-author-info" aria-label="Authorüñä" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://vanhung4499.github.io" target="_blank" rel="noopener noreferrer">Hung Nguyen</a></span><span property="author" content="Hung Nguyen"></span></span><!----><span class="page-date-info" aria-label="Writing DateüìÖ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-07-05T10:10:42.000Z"></span><!----><span class="page-reading-time-info" aria-label="Reading Time‚åõ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 41 min</span><meta property="timeRequired" content="PT41M"></span><span class="page-category-info" aria-label="Categoryüåà" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color4 clickable" role="navigation">interview</span><!--]--><meta property="articleSection" content="interview"></span><span class="page-tag-info" aria-label="Tagüè∑" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color4 clickable" role="navigation">interview</span><span class="page-tag-item color1 clickable" role="navigation">mysql</span><!--]--><meta property="keywords" content="interview,mysql"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">On This Page<button type="button" class="print-button" title="Print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#kien-thuc-co-ban">Ki·∫øn Th·ª©c C∆° B·∫£n</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-su-khac-biet-giua-co-so-du-lieu-quan-he-va-phi-quan-he">1. S·ª± kh√°c bi·ªát gi·ªØa c∆° s·ªü d·ªØ li·ªáu quan h·ªá v√† phi quan h·ªá?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-mo-ta-chi-tiet-cac-buoc-thuc-hien-mot-cau-lenh-mysql">2. M√¥ t·∫£ chi ti·∫øt c√°c b∆∞·ªõc th·ª±c hi·ªán m·ªôt c√¢u l·ªánh MySQL</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#lien-quan-ƒëen-chi-muc">Li√™n Quan ƒê·∫øn Ch·ªâ M·ª•c</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-ly-do-mysql-su-dung-chi-muc">3. L√Ω do MySQL s·ª≠ d·ª•ng ch·ªâ m·ª•c?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-ba-cau-truc-du-lieu-co-ban-cua-chi-muc-va-uu-nhuoc-ƒëiem-cua-chung">4. Ba c·∫•u tr√∫c d·ªØ li·ªáu c∆° b·∫£n c·ªßa ch·ªâ m·ª•c v√† ∆∞u nh∆∞·ª£c ƒëi·ªÉm c·ªßa ch√∫ng</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-cac-loai-chi-muc-thong-thuong-va-chung-hoat-ƒëong-nhu-the-nao">5. C√°c lo·∫°i ch·ªâ m·ª•c th√¥ng th∆∞·ªùng v√† ch√∫ng ho·∫°t ƒë·ªông nh∆∞ th·∫ø n√†o?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_6-su-khac-biet-giua-cach-thuc-hien-chi-muc-b-tree-cua-myisam-va-innodb-la-gi">6. S·ª± kh√°c bi·ªát gi·ªØa c√°ch th·ª±c hi·ªán ch·ªâ m·ª•c B-tree c·ªßa MyISAM v√† InnoDB l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-tai-sao-innodb-thiet-ke-chi-muc-b-tree">7. T·∫°i sao InnoDB thi·∫øt k·∫ø ch·ªâ m·ª•c B+ tree?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_8-chi-muc-bao-phu-va-chi-muc-ƒëay-la-gi">8. Ch·ªâ m·ª•c bao ph·ªß v√† ch·ªâ m·ª•c ƒë·∫©y l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_9-nhung-thao-tac-nao-khien-chi-muc-khong-con-hieu-luc">9. Nh·ªØng thao t√°c n√†o khi·∫øn ch·ªâ m·ª•c kh√¥ng c√≤n hi·ªáu l·ª±c?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_10-them-chi-muc-cho-chuoi-ky-tu">10. Th√™m ch·ªâ m·ª•c cho chu·ªói k√Ω t·ª±</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#lien-quan-ƒëen-nhat-ky">Li√™n Quan ƒê·∫øn Nh·∫≠t K√Ω</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_11-change-buffer-cua-mysql-la-gi">11. Change Buffer c·ªßa MySQL l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_12-mysql-lam-the-nao-ƒëe-ƒëanh-gia-so-luong-hang-can-quet">12. MySQL l√†m th·∫ø n√†o ƒë·ªÉ ƒë√°nh gi√° s·ªë l∆∞·ª£ng h√†ng c·∫ßn qu√©t?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_13-su-khac-biet-giua-redo-log-va-binlog-cua-mysql">13. S·ª± kh√°c bi·ªát gi·ªØa redo log v√† binlog c·ªßa MySQL?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_14-tai-sao-can-redo-log">14. T·∫°i sao c·∫ßn redo log?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_15-tai-sao-redo-log-co-kha-nang-crash-safe-ma-binlog-khong-the-thay-the-ƒëuoc">15. T·∫°i sao redo log c√≥ kh·∫£ nƒÉng crash-safe, m√† binlog kh√¥ng th·ªÉ thay th·∫ø ƒë∆∞·ª£c?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_16-khi-co-so-du-lieu-gap-su-co-lam-the-nao-ƒëe-khoi-phuc-du-lieu-chua-ƒëuoc-ghi-vao-ƒëia-vao-bo-nho">16. Khi c∆° s·ªü d·ªØ li·ªáu g·∫∑p s·ª± c·ªë, l√†m th·∫ø n√†o ƒë·ªÉ kh√¥i ph·ª•c d·ªØ li·ªáu ch∆∞a ƒë∆∞·ª£c ghi v√†o ƒëƒ©a v√†o b·ªô nh·ªõ?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_17-cach-ghi-redo-log">17. C√°ch ghi redo log?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_18-quy-trinh-thuc-hien-cua-redo-log">18. Quy tr√¨nh th·ª±c hi·ªán c·ªßa redo log?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_19-binlog-la-gi-chuc-nang-cua-no-la-gi-va-no-co-ƒëam-bao-an-toan-khi-gap-su-co-khong">19. Binlog l√† g√¨, ch·ª©c nƒÉng c·ªßa n√≥ l√† g√¨, v√† n√≥ c√≥ ƒë·∫£m b·∫£o an to√†n khi g·∫∑p s·ª± c·ªë kh√¥ng?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_20-giao-dich-hai-giai-ƒëoan-la-gi">20. Giao d·ªãch hai giai ƒëo·∫°n l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_21-mysql-lam-the-nao-ƒëe-biet-binlog-la-hoan-chinh">21. MySQL l√†m th·∫ø n√†o ƒë·ªÉ bi·∫øt binlog l√† ho√†n ch·ªânh?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_22-wal-la-gi-va-uu-ƒëiem-cua-no-la-gi">22. WAL l√† g√¨ v√† ∆∞u ƒëi·ªÉm c·ªßa n√≥ l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_23-cac-ƒëinh-dang-nhat-ky-binlog">23. C√°c ƒë·ªãnh d·∫°ng nh·∫≠t k√Ω binlog</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_24-ƒëinh-dang-nhat-ky-redo-log">24. ƒê·ªãnh d·∫°ng nh·∫≠t k√Ω redo log</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_25-nhung-nguyen-nhan-gi-khien-cau-lenh-sql-ƒëang-le-thuc-thi-rat-nhanh-nhung-lai-chay-cham-hon-du-kien-lam-the-nao-ƒëe-giai-quyet">25. Nh·ªØng nguy√™n nh√¢n g√¨ khi·∫øn c√¢u l·ªánh SQL ƒë√°ng l·∫Ω th·ª±c thi r·∫•t nhanh nh∆∞ng l·∫°i ch·∫°y ch·∫≠m h∆°n d·ª± ki·∫øn? L√†m th·∫ø n√†o ƒë·ªÉ gi·∫£i quy·∫øt?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_26-cau-truc-trang-du-lieu-cua-innodb">26. C·∫•u tr√∫c trang d·ªØ li·ªáu c·ªßa InnoDB</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cac-khai-niem-lien-quan-ƒëen-du-lieu">C√°c kh√°i ni·ªám li√™n quan ƒë·∫øn d·ªØ li·ªáu</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_27-mysql-ƒëam-bao-du-lieu-khong-bi-mat-nhu-the-nao">27. MySQL ƒë·∫£m b·∫£o d·ªØ li·ªáu kh√¥ng b·ªã m·∫•t nh∆∞ th·∫ø n√†o?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_28-lam-gi-khi-du-lieu-bi-xoa-nham">28. L√†m g√¨ khi d·ªØ li·ªáu b·ªã x√≥a nh·∫ßm?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_29-su-khac-biet-giua-drop-truncate-va-delete">29. S·ª± kh√°c bi·ªát gi·ªØa drop, truncate v√† delete</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_30-co-hai-lenh-kill-trong-mysql">30. C√≥ hai l·ªánh kill trong MySQL</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_31-hieu-nhu-the-nao-ve-viec-ƒëoc-va-gui-du-lieu-ƒëong-thoi-trong-mysql">31. Hi·ªÉu nh∆∞ th·∫ø n√†o v·ªÅ vi·ªác ƒë·ªçc v√† g·ª≠i d·ªØ li·ªáu ƒë·ªìng th·ªùi trong MySQL</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_32-tai-sao-truy-van-bang-lon-trong-mysql-khong-lam-ƒëay-bo-nho">32. T·∫°i sao truy v·∫•n b·∫£ng l·ªõn trong MySQL kh√¥ng l√†m ƒë·∫ßy b·ªô nh·ªõ?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_33-cach-su-dung-va-ƒëac-tinh-cua-bang-tam-thoi-trong-mysql">33. C√°ch s·ª≠ d·ª•ng v√† ƒë·∫∑c t√≠nh c·ªßa b·∫£ng t·∫°m th·ªùi trong MySQL</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_34-gioi-thieu-cac-bo-may-luu-tru-mysql-innodb-myisam-memory">34. Gi·ªõi thi·ªáu c√°c b·ªô m√°y l∆∞u tr·ªØ MySQL (InnoDB, MyISAM, MEMORY)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_35-innodb-tot-nhung-co-nen-su-dung-bo-may-memory-khong">35. InnoDB t·ªët, nh∆∞ng c√≥ n√™n s·ª≠ d·ª•ng b·ªô m√°y MEMORY kh√¥ng?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_36-lam-the-nao-ƒëe-khoi-phuc-du-lieu-khi-thao-tac-nham-tren-co-so-du-lieu">36. L√†m th·∫ø n√†o ƒë·ªÉ kh√¥i ph·ª•c d·ªØ li·ªáu khi thao t√°c nh·∫ßm tr√™n c∆° s·ªü d·ªØ li·ªáu?</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#lien-quan-ƒëen-sao-luu-chinh-phu">Li√™n quan ƒë·∫øn sao l∆∞u ch√≠nh ph·ª•</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_37-mysql-ƒëam-bao-ƒëong-bo-chinh-phu-nhu-the-nao">37. MySQL ƒë·∫£m b·∫£o ƒë·ªìng b·ªô ch√≠nh ph·ª• nh∆∞ th·∫ø n√†o?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_38-ƒëo-tre-chinh-phu-la-gi">38. ƒê·ªô tr·ªÖ ch√≠nh ph·ª• l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_39-tai-sao-can-co-chien-luoc-sao-chep-ƒëa-luong">39. T·∫°i sao c·∫ßn c√≥ chi·∫øn l∆∞·ª£c sao ch√©p ƒëa lu·ªìng?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_40-cac-chien-luoc-song-song-cua-mysql-la-gi">40. C√°c chi·∫øn l∆∞·ª£c song song c·ªßa MySQL l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_41-su-khac-biet-giua-mot-chinh-mot-phu-va-mot-chinh-nhieu-phu-trong-mysql-la-gi">41. S·ª± kh√°c bi·ªát gi·ªØa m·ªôt ch√≠nh m·ªôt ph·ª• v√† m·ªôt ch√≠nh nhi·ªÅu ph·ª• trong MySQL l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_42-lam-the-nao-ƒëe-giai-quyet-van-ƒëe-khi-chinh-gap-su-co">42. L√†m th·∫ø n√†o ƒë·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ khi ch√≠nh g·∫∑p s·ª± c·ªë?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_43-cac-giai-phap-cho-van-ƒëe-ƒëoc-qua-han-lien-quan-ƒëen-phan-tach-ƒëoc-ghi-trong-mysql-la-gi">43. C√°c gi·∫£i ph√°p cho v·∫•n ƒë·ªÅ ƒë·ªçc qu√° h·∫°n li√™n quan ƒë·∫øn ph√¢n t√°ch ƒë·ªçc ghi trong MySQL l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_44-su-khac-biet-giua-ket-noi-ƒëong-thoi-va-truy-van-ƒëong-thoi-trong-mysql-la-gi">44. S·ª± kh√°c bi·ªát gi·ªØa k·∫øt n·ªëi ƒë·ªìng th·ªùi v√† truy v·∫•n ƒë·ªìng th·ªùi trong MySQL l√† g√¨?</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#lien-quan-ƒëen-hieu-suat">Li√™n quan ƒë·∫øn hi·ªáu su·∫•t</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_45-cach-nang-cao-hieu-suat-mysql-trong-thoi-gian-ngan">45. C√°ch n√¢ng cao hi·ªáu su·∫•t MySQL trong th·ªùi gian ng·∫Øn</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_46-tai-sao-id-khoa-chinh-tu-tang-cua-mysql-khong-lien-tuc">46. T·∫°i sao ID kh√≥a ch√≠nh t·ª± tƒÉng c·ªßa MySQL kh√¥ng li√™n t·ª•c?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_47-tai-sao-innodb-su-dung-id-tu-tang-lam-khoa-chinh">47. T·∫°i sao InnoDB s·ª≠ d·ª•ng ID t·ª± tƒÉng l√†m kh√≥a ch√≠nh?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_48-cach-sao-chep-mot-bang-nhanh-nhat">48. C√°ch sao ch√©p m·ªôt b·∫£ng nhanh nh·∫•t?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_49-lenh-grant-va-flush-privileges">49. L·ªánh grant v√† flush privileges</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_50-co-nen-su-dung-bang-phan-vung">50. C√≥ n√™n s·ª≠ d·ª•ng b·∫£ng ph√¢n v√πng?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_51-cach-su-dung-join">51. C√°ch s·ª≠ d·ª•ng join</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_52-mysql-co-nhung-id-tu-tang-nao-cac-truong-hop-su-dung-cua-chung-la-gi">52. MySQL c√≥ nh·ªØng ID t·ª± tƒÉng n√†o? C√°c tr∆∞·ªùng h·ª£p s·ª≠ d·ª•ng c·ªßa ch√∫ng l√† g√¨?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_53-xid-trong-mysql-ƒëuoc-tao-ra-nhu-the-nao">53. Xid trong MySQL ƒë∆∞·ª£c t·∫°o ra nh∆∞ th·∫ø n√†o?</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#lien-quan-ƒëen-khoa">Li√™n quan ƒë·∫øn kh√≥a</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_54-noi-ve-khoa-cua-mysql">54. N√≥i v·ªÅ kh√≥a c·ªßa MySQL</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_55-the-nao-la-ƒëoc-ao-phantom-read">55. Th·∫ø n√†o l√† ƒë·ªçc ·∫£o (phantom read)?</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#nhung-cau-hoi-khac">Nh·ªØng c√¢u h·ªèi kh√°c</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_56-tai-sao-mysql-lai-thinh-thoang-cham-lai">56. T·∫°i sao MySQL l·∫°i th·ªânh tho·∫£ng ch·∫≠m l·∫°i?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_57-tai-sao-sau-khi-xoa-bang-kich-thuoc-tep-bang-van-khong-thay-ƒëoi">57. T·∫°i sao sau khi x√≥a b·∫£ng, k√≠ch th∆∞·ªõc t·ªáp b·∫£ng v·∫´n kh√¥ng thay ƒë·ªïi?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_58-cach-thuc-hien-count-va-so-sanh-cac-loai-count">58. C√°ch th·ª±c hi·ªán count(*) v√† so s√°nh c√°c lo·∫°i count</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_59-nguyen-ly-sap-xep-orderby">59. Nguy√™n l√Ω s·∫Øp x·∫øp orderby</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_60-cach-su-dung-mysql-ƒëe-chon-ngau-nhien-mot-cach-hieu-qua">60. C√°ch s·ª≠ d·ª•ng MySQL ƒë·ªÉ ch·ªçn ng·∫´u nhi√™n m·ªôt c√°ch hi·ªáu qu·∫£</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h1 id="_60-cau-hoi-phong-van-co-so-du-lieu-ƒëuoc-chon-loc-phai-xem" tabindex="-1"><a class="header-anchor" href="#_60-cau-hoi-phong-van-co-so-du-lieu-ƒëuoc-chon-loc-phai-xem"><span>60 C√¢u H·ªèi Ph·ªèng V·∫•n C∆° S·ªü D·ªØ Li·ªáu ƒê∆∞·ª£c Ch·ªçn L·ªçc: Ph·∫£i Xem:</span></a></h1><blockquote><p>H√¨nh ·∫£nh v√† gi·∫£i th√≠ch chi ti·∫øt 60 c√¢u h·ªèi ph·ªèng v·∫•n MySQL th∆∞·ªùng g·∫∑p, l·∫ßn n√†y t√¥i s·∫Ω d·ªÖ d√†ng v∆∞·ª£t qua ph·ªèng v·∫•n vi√™n (tay ch√≥). T·ªïng h·ª£p: Tr·∫ßm M·∫∑c V∆∞∆°ng Nh·ªã, nh·∫•n v√†o <a href="https://mp.weixin.qq.com/s/c-sy7tM0BmrqMUQFW7C65g" target="_blank" rel="noopener noreferrer">li√™n k·∫øt b√†i vi·∫øt</a> ƒë·ªÉ xem s∆° ƒë·ªì t∆∞ duy chi ti·∫øt; T√°c gi·∫£: Herongwei, nh·∫•n v√†o <a href="https://mp.weixin.qq.com/s/-SqqKmhZcOlQxM-rHiIpKg" target="_blank" rel="noopener noreferrer">li√™n k·∫øt g·ªëc</a>.</p></blockquote><h2 id="kien-thuc-co-ban" tabindex="-1"><a class="header-anchor" href="#kien-thuc-co-ban"><span>Ki·∫øn Th·ª©c C∆° B·∫£n</span></a></h2><h3 id="_1-su-khac-biet-giua-co-so-du-lieu-quan-he-va-phi-quan-he" tabindex="-1"><a class="header-anchor" href="#_1-su-khac-biet-giua-co-so-du-lieu-quan-he-va-phi-quan-he"><span>1. S·ª± kh√°c bi·ªát gi·ªØa c∆° s·ªü d·ªØ li·ªáu quan h·ªá v√† phi quan h·ªá?</span></a></h3><p><strong>∆Øu ƒëi·ªÉm c·ªßa c∆° s·ªü d·ªØ li·ªáu quan h·ªá:</strong></p><ul><li>D·ªÖ hi·ªÉu v√¨ n√≥ s·ª≠ d·ª•ng m√¥ h√¨nh quan h·ªá ƒë·ªÉ t·ªï ch·ª©c d·ªØ li·ªáu.</li><li>C√≥ th·ªÉ duy tr√¨ t√≠nh nh·∫•t qu√°n c·ªßa d·ªØ li·ªáu.</li><li>Chi ph√≠ c·∫≠p nh·∫≠t d·ªØ li·ªáu t∆∞∆°ng ƒë·ªëi th·∫•p.</li><li>H·ªó tr·ª£ c√°c truy v·∫•n ph·ª©c t·∫°p (truy v·∫•n v·ªõi m·ªánh ƒë·ªÅ where).</li></ul><p><strong>∆Øu ƒëi·ªÉm c·ªßa c∆° s·ªü d·ªØ li·ªáu phi quan h·ªá (NoSQL):</strong></p><ul><li>Kh√¥ng c·∫ßn ph√¢n t√≠ch qua l·ªõp SQL, hi·ªáu su·∫•t ƒë·ªçc/ghi cao.</li><li>D·ª±a tr√™n c·∫∑p kh√≥a-gi√° tr·ªã, hi·ªáu su·∫•t ƒë·ªçc/ghi cao, d·ªÖ m·ªü r·ªông.</li><li>C√≥ th·ªÉ h·ªó tr·ª£ nhi·ªÅu lo·∫°i d·ªØ li·ªáu nh∆∞ h√¨nh ·∫£nh, t√†i li·ªáu, v.v.</li><li>M·ªü r·ªông (c√≥ th·ªÉ chia th√†nh c∆° s·ªü d·ªØ li·ªáu trong b·ªô nh·ªõ v√† c∆° s·ªü d·ªØ li·ªáu t√†i li·ªáu, nh∆∞ Redis, MongoDB, HBase, v.v., ph√π h·ª£p v·ªõi c√°c k·ªãch b·∫£n: h·ªá th·ªëng nh·∫≠t k√Ω c√≥ kh·∫£ nƒÉng ch·ªãu t·∫£i cao/d·ªØ li·ªáu ƒë·ªãa l√Ω).</li></ul><h3 id="_2-mo-ta-chi-tiet-cac-buoc-thuc-hien-mot-cau-lenh-mysql" tabindex="-1"><a class="header-anchor" href="#_2-mo-ta-chi-tiet-cac-buoc-thuc-hien-mot-cau-lenh-mysql"><span>2. M√¥ t·∫£ chi ti·∫øt c√°c b∆∞·ªõc th·ª±c hi·ªán m·ªôt c√¢u l·ªánh MySQL</span></a></h3><p>C√°c b∆∞·ªõc th·ª±c hi·ªán SQL c·ªßa l·ªõp Server theo th·ª© t·ª± nh∆∞ sau:</p><ul><li>Y√™u c·∫ßu t·ª´ kh√°ch h√†ng -&gt; B·ªô k·∫øt n·ªëi (x√°c minh danh t√≠nh ng∆∞·ªùi d√πng, c·∫•p quy·ªÅn)</li><li>B·ªô nh·ªõ ƒë·ªám truy v·∫•n (n·∫øu t·ªìn t·∫°i b·ªô nh·ªõ ƒë·ªám th√¨ tr·∫£ v·ªÅ tr·ª±c ti·∫øp, n·∫øu kh√¥ng th√¨ th·ª±c hi·ªán c√°c b∆∞·ªõc ti·∫øp theo)</li><li>B·ªô ph√¢n t√≠ch (th·ª±c hi·ªán ph√¢n t√≠ch t·ª´ v·ª±ng v√† ph√¢n t√≠ch c√∫ ph√°p cho SQL)</li><li>B·ªô t·ªëi ∆∞u h√≥a (t·ªëi ∆∞u h√≥a SQL ƒë·ªÉ ch·ªçn ph∆∞∆°ng ph√°p th·ª±c hi·ªán t·ªëi ∆∞u nh·∫•t)</li><li>B·ªô th·ª±c thi (ki·ªÉm tra xem ng∆∞·ªùi d√πng c√≥ quy·ªÅn th·ª±c thi hay kh√¥ng, n·∫øu c√≥ th√¨ s·ª≠ d·ª•ng giao di·ªán do c√¥ng c·ª• cung c·∫•p) -&gt; L·∫•y d·ªØ li·ªáu t·ª´ l·ªõp c√¥ng c·ª• v√† tr·∫£ v·ªÅ (n·∫øu m·ªü b·ªô nh·ªõ ƒë·ªám truy v·∫•n th√¨ s·∫Ω l∆∞u k·∫øt qu·∫£ truy v·∫•n).</li></ul><h2 id="lien-quan-ƒëen-chi-muc" tabindex="-1"><a class="header-anchor" href="#lien-quan-ƒëen-chi-muc"><span>Li√™n Quan ƒê·∫øn Ch·ªâ M·ª•c</span></a></h2><h3 id="_3-ly-do-mysql-su-dung-chi-muc" tabindex="-1"><a class="header-anchor" href="#_3-ly-do-mysql-su-dung-chi-muc"><span>3. L√Ω do MySQL s·ª≠ d·ª•ng ch·ªâ m·ª•c?</span></a></h3><p>Nguy√™n nh√¢n c∆° b·∫£n:</p><ul><li>S·ª± xu·∫•t hi·ªán c·ªßa ch·ªâ m·ª•c nh·∫±m n√¢ng cao hi·ªáu su·∫•t truy v·∫•n d·ªØ li·ªáu, gi·ªëng nh∆∞ m·ª•c l·ª•c c·ªßa m·ªôt cu·ªën s√°ch.</li><li>ƒê·ªëi v·ªõi b·∫£ng c·ªßa c∆° s·ªü d·ªØ li·ªáu, ch·ªâ m·ª•c th·ª±c ch·∫•t l√† &quot;m·ª•c l·ª•c&quot; c·ªßa n√≥.</li></ul><p>M·ªü r·ªông:</p><ul><li>T·∫°o ch·ªâ m·ª•c duy nh·∫•t c√≥ th·ªÉ ƒë·∫£m b·∫£o t√≠nh duy nh·∫•t c·ªßa m·ªói h√†ng d·ªØ li·ªáu trong b·∫£ng c∆° s·ªü d·ªØ li·ªáu.</li><li>Gi√∫p l·ªõp ƒë·ªông c∆° tr√°nh s·∫Øp x·∫øp v√† t·∫°o b·∫£ng t·∫°m th·ªùi.</li><li>Bi·∫øn IO ng·∫´u nhi√™n th√†nh IO tu·∫ßn t·ª±, tƒÉng t·ªëc k·∫øt n·ªëi gi·ªØa c√°c b·∫£ng.</li></ul><h3 id="_4-ba-cau-truc-du-lieu-co-ban-cua-chi-muc-va-uu-nhuoc-ƒëiem-cua-chung" tabindex="-1"><a class="header-anchor" href="#_4-ba-cau-truc-du-lieu-co-ban-cua-chi-muc-va-uu-nhuoc-ƒëiem-cua-chung"><span>4. Ba c·∫•u tr√∫c d·ªØ li·ªáu c∆° b·∫£n c·ªßa ch·ªâ m·ª•c v√† ∆∞u nh∆∞·ª£c ƒëi·ªÉm c·ªßa ch√∫ng</span></a></h3><p>Ba c·∫•u tr√∫c d·ªØ li·ªáu c∆° b·∫£n c·ªßa ch·ªâ m·ª•c: B·∫£ng bƒÉm, m·∫£ng c√≥ th·ª© t·ª± v√† c√¢y t√¨m ki·∫øm.</p><ul><li><strong>B·∫£ng bƒÉm</strong>: Ph√π h·ª£p v·ªõi c√°c t√¨nh hu·ªëng truy v·∫•n b·∫±ng gi√° tr·ªã, v√≠ d·ª• nh∆∞ memcached v√† m·ªôt s·ªë ƒë·ªông c∆° NoSQL kh√°c, kh√¥ng ph√π h·ª£p v·ªõi truy v·∫•n ph·∫°m vi.</li><li><strong>M·∫£ng c√≥ th·ª© t·ª±</strong>: Ch·ªâ ph√π h·ª£p v·ªõi ƒë·ªông c∆° l∆∞u tr·ªØ tƒ©nh, hi·ªáu su·∫•t t·ªët trong truy v·∫•n gi√° tr·ªã v√† ph·∫°m vi nh∆∞ng chi ph√≠ c·∫≠p nh·∫≠t d·ªØ li·ªáu cao.</li><li><strong>C√¢y N-ary</strong>: Do ∆∞u ƒëi·ªÉm v·ªÅ hi·ªáu su·∫•t ƒë·ªçc/ghi v√† ph√π h·ª£p v·ªõi m√¥ h√¨nh truy c·∫≠p ƒëƒ©a, ƒë∆∞·ª£c s·ª≠ d·ª•ng r·ªông r√£i trong c√°c ƒë·ªông c∆° c∆° s·ªü d·ªØ li·ªáu.</li></ul><p>M·ªü r·ªông (v√≠ d·ª• v·ªõi ch·ªâ m·ª•c c·ªßa m·ªôt tr∆∞·ªùng s·ªë nguy√™n trong InnoDB, s·ªë N x·∫•p x·ªâ l√† 1200. Khi c√¢y c√≥ chi·ªÅu cao l√† 4, n√≥ c√≥ th·ªÉ ch·ª©a gi√° tr·ªã t∆∞∆°ng ƒë∆∞∆°ng 1200 m≈© 3, t·ª©c l√† 1,7 t·ª∑. C√¢n nh·∫Øc r·∫±ng kh·ªëi d·ªØ li·ªáu c·ªßa g·ªëc c√¢y lu√¥n n·∫±m trong b·ªô nh·ªõ, m·ªôt ch·ªâ m·ª•c c·ªßa m·ªôt tr∆∞·ªùng s·ªë nguy√™n tr√™n b·∫£ng 1 t·ª∑ h√†ng, t√¨m m·ªôt gi√° tr·ªã ch·ªâ c·∫ßn truy c·∫≠p ƒëƒ©a 3 l·∫ßn. Th·ª±c t·∫ø, t·∫ßng th·ª© hai c·ªßa c√¢y c≈©ng c√≥ kh·∫£ nƒÉng l·ªõn n·∫±m trong b·ªô nh·ªõ, v√¨ v·∫≠y s·ªë l·∫ßn truy c·∫≠p ƒëƒ©a trung b√¨nh s·∫Ω √≠t h∆°n n·ªØa.)</p><h3 id="_5-cac-loai-chi-muc-thong-thuong-va-chung-hoat-ƒëong-nhu-the-nao" tabindex="-1"><a class="header-anchor" href="#_5-cac-loai-chi-muc-thong-thuong-va-chung-hoat-ƒëong-nhu-the-nao"><span>5. C√°c lo·∫°i ch·ªâ m·ª•c th√¥ng th∆∞·ªùng v√† ch√∫ng ho·∫°t ƒë·ªông nh∆∞ th·∫ø n√†o?</span></a></h3><p>D·ª±a tr√™n n·ªôi dung c·ªßa c√°c n√∫t l√°, ch·ªâ m·ª•c ƒë∆∞·ª£c chia th√†nh ch·ªâ m·ª•c kh√≥a ch√≠nh v√† ch·ªâ m·ª•c kh√¥ng kh√≥a ch√≠nh.</p><ul><li>N√∫t l√° c·ªßa ch·ªâ m·ª•c kh√≥a ch√≠nh ch·ª©a to√†n b·ªô d·ªØ li·ªáu h√†ng, trong InnoDB c≈©ng ƒë∆∞·ª£c g·ªçi l√† ch·ªâ m·ª•c c·ª•m.</li><li>N√∫t l√° c·ªßa ch·ªâ m·ª•c kh√¥ng kh√≥a ch√≠nh ch·ª©a gi√° tr·ªã c·ªßa kh√≥a ch√≠nh, trong InnoDB c≈©ng ƒë∆∞·ª£c g·ªçi l√† ch·ªâ m·ª•c th·ª© c·∫•p.</li></ul><h3 id="_6-su-khac-biet-giua-cach-thuc-hien-chi-muc-b-tree-cua-myisam-va-innodb-la-gi" tabindex="-1"><a class="header-anchor" href="#_6-su-khac-biet-giua-cach-thuc-hien-chi-muc-b-tree-cua-myisam-va-innodb-la-gi"><span>6. S·ª± kh√°c bi·ªát gi·ªØa c√°ch th·ª±c hi·ªán ch·ªâ m·ª•c B-tree c·ªßa MyISAM v√† InnoDB l√† g√¨?</span></a></h3><ul><li><strong>ƒê·ªông c∆° l∆∞u tr·ªØ InnoDB</strong>: N√∫t l√° c·ªßa ch·ªâ m·ª•c B+ tree l∆∞u tr·ªØ d·ªØ li·ªáu th·ª±c t·∫ø, t·ªáp d·ªØ li·ªáu th·ª±c ch·∫•t l√† t·ªáp ch·ªâ m·ª•c.</li><li><strong>ƒê·ªông c∆° l∆∞u tr·ªØ MyISAM</strong>: N√∫t l√° c·ªßa ch·ªâ m·ª•c B+ tree l∆∞u tr·ªØ ƒë·ªãa ch·ªâ v·∫≠t l√Ω c·ªßa d·ªØ li·ªáu, v√πng d·ªØ li·ªáu c·ªßa n√∫t l√° l∆∞u tr·ªØ ƒë·ªãa ch·ªâ c·ªßa b·∫£n ghi d·ªØ li·ªáu, t·ªáp ch·ªâ m·ª•c v√† t·ªáp d·ªØ li·ªáu ƒë∆∞·ª£c t√°ch bi·ªát.</li></ul><h3 id="_7-tai-sao-innodb-thiet-ke-chi-muc-b-tree" tabindex="-1"><a class="header-anchor" href="#_7-tai-sao-innodb-thiet-ke-chi-muc-b-tree"><span>7. T·∫°i sao InnoDB thi·∫øt k·∫ø ch·ªâ m·ª•c B+ tree?</span></a></h3><p>Hai y·∫øu t·ªë c√¢n nh·∫Øc:</p><ol><li>C√°c t√¨nh hu·ªëng v√† ch·ª©c nƒÉng m√† InnoDB c·∫ßn th·ª±c hi·ªán y√™u c·∫ßu c√≥ hi·ªáu su·∫•t m·∫°nh m·∫Ω trong c√°c truy v·∫•n c·ª• th·ªÉ.</li><li>CPU m·∫•t nhi·ªÅu th·ªùi gian ƒë·ªÉ t·∫£i d·ªØ li·ªáu t·ª´ ƒëƒ©a v√†o b·ªô nh·ªõ.</li></ol><p><strong>T·∫°i sao ch·ªçn B+ tree:</strong></p><ul><li><p><strong>Ch·ªâ m·ª•c bƒÉm</strong> tuy c√≥ th·ªÉ cung c·∫•p truy v·∫•n ph·ª©c t·∫°p O(1), nh∆∞ng kh√¥ng h·ªó tr·ª£ t·ªët truy v·∫•n ph·∫°m vi v√† s·∫Øp x·∫øp, cu·ªëi c√πng s·∫Ω d·∫´n ƒë·∫øn qu√©t to√†n b·ªô b·∫£ng.</p></li><li><p><strong>C√¢y B</strong> c√≥ th·ªÉ l∆∞u tr·ªØ d·ªØ li·ªáu ·ªü c√°c n√∫t kh√¥ng ph·∫£i l√† l√°, nh∆∞ng ƒëi·ªÅu n√†y c√≥ th·ªÉ d·∫´n ƒë·∫øn nhi·ªÅu IO ng·∫´u nhi√™n h∆°n khi truy v·∫•n d·ªØ li·ªáu li√™n t·ª•c.</p></li><li><p>C√°c n√∫t l√° c·ªßa <strong>c√¢y B+</strong> c√≥ th·ªÉ k·∫øt n·ªëi v·ªõi nhau b·∫±ng con tr·ªè, gi·∫£m IO ng·∫´u nhi√™n do duy·ªát tu·∫ßn t·ª±.</p></li><li><p>Ch·ªâ m·ª•c duy nh·∫•t hay kh√¥ng duy nh·∫•t?</p><p>V√¨ ch·ªâ m·ª•c duy nh·∫•t kh√¥ng th·ªÉ s·ª≠ d·ª•ng c∆° ch·∫ø t·ªëi ∆∞u h√≥a c·ªßa b·ªô ƒë·ªám thay ƒë·ªïi, do ƒë√≥ n·∫øu nghi·ªáp v·ª• c√≥ th·ªÉ ch·∫•p nh·∫≠n, t·ª´ g√≥c ƒë·ªô hi·ªáu su·∫•t, n√™n ∆∞u ti√™n ch·ªâ m·ª•c kh√¥ng duy nh·∫•t.</p></li></ul><h3 id="_8-chi-muc-bao-phu-va-chi-muc-ƒëay-la-gi" tabindex="-1"><a class="header-anchor" href="#_8-chi-muc-bao-phu-va-chi-muc-ƒëay-la-gi"><span>8. Ch·ªâ m·ª•c bao ph·ªß v√† ch·ªâ m·ª•c ƒë·∫©y l√† g√¨?</span></a></h3><p><strong>Ch·ªâ m·ª•c bao ph·ªß:</strong></p><ul><li>Trong m·ªôt truy v·∫•n, ch·ªâ m·ª•c k ƒë√£ &quot;bao ph·ªß&quot; nhu c·∫ßu truy v·∫•n c·ªßa ch√∫ng ta, ƒë∆∞·ª£c g·ªçi l√† ch·ªâ m·ª•c bao ph·ªß.</li><li>Ch·ªâ m·ª•c bao ph·ªß c√≥ th·ªÉ gi·∫£m s·ªë l·∫ßn t√¨m ki·∫øm tr√™n c√¢y, tƒÉng ƒë√°ng k·ªÉ hi·ªáu su·∫•t truy v·∫•n, v√¨ v·∫≠y s·ª≠ d·ª•ng ch·ªâ m·ª•c bao ph·ªß l√† m·ªôt ph∆∞∆°ng ph√°p t·ªëi ∆∞u hi·ªáu su·∫•t ph·ªï bi·∫øn.</li></ul><p><strong>Ch·ªâ m·ª•c ƒë·∫©y:</strong></p><ul><li>MySQL 5.6 gi·ªõi thi·ªáu t·ªëi ∆∞u h√≥a ch·ªâ m·ª•c ƒë·∫©y (index condition pushdown), c√≥ th·ªÉ trong qu√° tr√¨nh duy·ªát ch·ªâ m·ª•c, tr∆∞·ªõc ti√™n th·ª±c hi·ªán ph√°n ƒëo√°n tr√™n c√°c tr∆∞·ªùng ch·ª©a trong ch·ªâ m·ª•c, l·ªçc tr·ª±c ti·∫øp c√°c b·∫£n ghi kh√¥ng th·ªèa m√£n ƒëi·ªÅu ki·ªán, gi·∫£m s·ªë l·∫ßn quay l·∫°i b·∫£ng.</li></ul><h3 id="_9-nhung-thao-tac-nao-khien-chi-muc-khong-con-hieu-luc" tabindex="-1"><a class="header-anchor" href="#_9-nhung-thao-tac-nao-khien-chi-muc-khong-con-hieu-luc"><span>9. Nh·ªØng thao t√°c n√†o khi·∫øn ch·ªâ m·ª•c kh√¥ng c√≤n hi·ªáu l·ª±c?</span></a></h3><ul><li>S·ª≠ d·ª•ng kh·ªõp m·∫´u b√™n tr√°i ho·∫∑c kh·ªõp m·∫´u tr√°i ph·∫£i, t·ª©c l√† like %xx ho·∫∑c like %xx%, ƒë·ªÅu g√¢y ch·ªâ m·ª•c kh√¥ng c√≤n hi·ªáu l·ª±c. Nguy√™n nh√¢n l√† k·∫øt qu·∫£ truy v·∫•n c√≥ th·ªÉ l√† nhi·ªÅu, kh√¥ng bi·∫øt so s√°nh t·ª´ gi√° tr·ªã ch·ªâ m·ª•c n√†o, v√¨ v·∫≠y ch·ªâ c√≥ th·ªÉ qu√©t to√†n b·ªô b·∫£ng.</li><li>Th·ª±c hi·ªán ch·ª©c nƒÉng tr√™n ch·ªâ m·ª•c ho·∫∑c t√≠nh to√°n bi·ªÉu th·ª©c tr√™n ch·ªâ m·ª•c, v√¨ ch·ªâ m·ª•c gi·ªØ gi√° tr·ªã g·ªëc c·ªßa tr∆∞·ªùng ch·ªâ m·ª•c, kh√¥ng ph·∫£i l√† gi√° tr·ªã sau khi t√≠nh to√°n b·ªüi ch·ª©c nƒÉng, do ƒë√≥ kh√¥ng th·ªÉ s·ª≠ d·ª•ng ch·ªâ m·ª•c.</li><li>Th·ª±c hi·ªán chuy·ªÉn ƒë·ªïi ng·∫ßm tr√™n ch·ªâ m·ª•c t∆∞∆°ng ƒë∆∞∆°ng v·ªõi vi·ªác s·ª≠ d·ª•ng ch·ª©c nƒÉng m·ªõi.</li><li>Trong c√¢u l·ªánh WHERE c√≥ c√¢u l·ªánh OR, ch·ªâ c·∫ßn c√≥ m·ªôt ƒëi·ªÅu ki·ªán kh√¥ng ph·∫£i l√† tr∆∞·ªùng ch·ªâ m·ª•c, s·∫Ω th·ª±c hi·ªán qu√©t to√†n b·ªô b·∫£ng.</li></ul><h3 id="_10-them-chi-muc-cho-chuoi-ky-tu" tabindex="-1"><a class="header-anchor" href="#_10-them-chi-muc-cho-chuoi-ky-tu"><span>10. Th√™m ch·ªâ m·ª•c cho chu·ªói k√Ω t·ª±</span></a></h3><ul><li>T·∫°o ch·ªâ m·ª•c ƒë·∫ßy ƒë·ªß tr·ª±c ti·∫øp, c√≥ th·ªÉ t·ªën nhi·ªÅu kh√¥ng gian.</li><li>T·∫°o ch·ªâ m·ª•c ti·ªÅn t·ªë, ti·∫øt ki·ªám kh√¥ng gian, nh∆∞ng tƒÉng s·ªë l·∫ßn qu√©t truy v·∫•n v√† kh√¥ng th·ªÉ s·ª≠ d·ª•ng ch·ªâ m·ª•c bao ph·ªß.</li><li>L∆∞u tr·ªØ ng∆∞·ª£c r·ªìi t·∫°o ch·ªâ m·ª•c ti·ªÅn t·ªë ƒë·ªÉ tr√°nh v·∫•n ƒë·ªÅ kh√¥ng ƒë·ªß ƒë·ªô ph√¢n bi·ªát c·ªßa ti·ªÅn t·ªë chu·ªói.</li><li>T·∫°o ch·ªâ m·ª•c tr∆∞·ªùng bƒÉm, hi·ªáu su·∫•t truy v·∫•n ·ªïn ƒë·ªãnh, c√≥ th√™m chi ph√≠ l∆∞u tr·ªØ v√† t√≠nh to√°n, gi·ªëng nh∆∞ c√°ch th·ª© ba, ƒë·ªÅu kh√¥ng h·ªó tr·ª£ qu√©t ph·∫°m vi.</li></ul><h2 id="lien-quan-ƒëen-nhat-ky" tabindex="-1"><a class="header-anchor" href="#lien-quan-ƒëen-nhat-ky"><span>Li√™n Quan ƒê·∫øn Nh·∫≠t K√Ω</span></a></h2><h3 id="_11-change-buffer-cua-mysql-la-gi" tabindex="-1"><a class="header-anchor" href="#_11-change-buffer-cua-mysql-la-gi"><span>11. Change Buffer c·ªßa MySQL l√† g√¨?</span></a></h3><ul><li>Khi c·∫ßn c·∫≠p nh·∫≠t m·ªôt trang d·ªØ li·ªáu, n·∫øu trang d·ªØ li·ªáu ƒë√≥ ƒë√£ n·∫±m trong b·ªô nh·ªõ th√¨ s·∫Ω c·∫≠p nh·∫≠t tr·ª±c ti·∫øp; c√≤n n·∫øu trang d·ªØ li·ªáu ƒë√≥ ch∆∞a n·∫±m trong b·ªô nh·ªõ, InnoDB s·∫Ω l∆∞u c√°c thao t√°c c·∫≠p nh·∫≠t n√†y v√†o change buffer m√† kh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn t√≠nh nh·∫•t qu√°n c·ªßa d·ªØ li·ªáu.</li><li>B·∫±ng c√°ch n√†y, kh√¥ng c·∫ßn ph·∫£i ƒë·ªçc trang d·ªØ li·ªáu n√†y t·ª´ ƒëƒ©a v√†o b·ªô nh·ªõ. Khi c√≥ truy v·∫•n c·∫ßn truy c·∫≠p trang d·ªØ li·ªáu n√†y, trang d·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c ƒë·ªçc v√†o b·ªô nh·ªõ, sau ƒë√≥ th·ª±c hi·ªán c√°c thao t√°c li√™n quan trong change buffer. Qua ƒë√≥, c√≥ th·ªÉ ƒë·∫£m b·∫£o t√≠nh ch√≠nh x√°c c·ªßa d·ªØ li·ªáu.</li><li>L∆∞u √Ω r·∫±ng vi·ªác c·∫≠p nh·∫≠t ch·ªâ m·ª•c duy nh·∫•t kh√¥ng th·ªÉ s·ª≠ d·ª•ng change buffer, th·ª±c t·∫ø ch·ªâ c√≥ ch·ªâ m·ª•c th√¥ng th∆∞·ªùng m·ªõi c√≥ th·ªÉ s·ª≠ d·ª•ng.</li><li><strong>·ª®ng d·ª•ng:</strong><ul><li>ƒê·ªëi v·ªõi c√°c nghi·ªáp v·ª• ghi nhi·ªÅu ƒë·ªçc √≠t, kh·∫£ nƒÉng trang d·ªØ li·ªáu ƒë∆∞·ª£c truy c·∫≠p ngay sau khi ghi xong l√† kh√° th·∫•p, l√∫c n√†y vi·ªác s·ª≠ d·ª•ng change buffer s·∫Ω hi·ªáu qu·∫£ nh·∫•t. M√¥ h√¨nh nghi·ªáp v·ª• n√†y th∆∞·ªùng th·∫•y trong c√°c h·ªá th·ªëng qu·∫£n l√Ω h√≥a ƒë∆°n, nh·∫≠t k√Ω.</li><li>Ng∆∞·ª£c l·∫°i, n·∫øu m·ªôt nghi·ªáp v·ª• c√≥ m√¥ h√¨nh c·∫≠p nh·∫≠t l√† ghi xong s·∫Ω truy v·∫•n ngay l·∫≠p t·ª©c, m·∫∑c d√π c√≥ th·ªÉ ghi change buffer tr∆∞·ªõc nh∆∞ng ngay sau ƒë√≥ s·∫Ω truy c·∫≠p trang d·ªØ li·ªáu n√†y, qu√° tr√¨nh merge s·∫Ω ƒë∆∞·ª£c k√≠ch ho·∫°t ngay. Do ƒë√≥, s·ªë l·∫ßn truy c·∫≠p IO ng·∫´u nhi√™n s·∫Ω kh√¥ng gi·∫£m, th·∫≠m ch√≠ tƒÉng th√™m chi ph√≠ b·∫£o tr√¨ change buffer.</li></ul></li></ul><h3 id="_12-mysql-lam-the-nao-ƒëe-ƒëanh-gia-so-luong-hang-can-quet" tabindex="-1"><a class="header-anchor" href="#_12-mysql-lam-the-nao-ƒëe-ƒëanh-gia-so-luong-hang-can-quet"><span>12. MySQL l√†m th·∫ø n√†o ƒë·ªÉ ƒë√°nh gi√° s·ªë l∆∞·ª£ng h√†ng c·∫ßn qu√©t?</span></a></h3><ul><li>Tr∆∞·ªõc khi th·ª±c s·ª± b·∫Øt ƒë·∫ßu th·ª±c hi·ªán c√¢u l·ªánh, MySQL kh√¥ng th·ªÉ bi·∫øt ch√≠nh x√°c c√≥ bao nhi√™u b·∫£n ghi th·ªèa m√£n ƒëi·ªÅu ki·ªán n√†y.</li><li>MySQL ch·ªâ c√≥ th·ªÉ ∆∞·ªõc l∆∞·ª£ng s·ªë l∆∞·ª£ng b·∫£n ghi d·ª±a tr√™n th√¥ng tin th·ªëng k√™, th√¥ng tin n√†y ch√≠nh l√† ƒë·ªô ph√¢n bi·ªát c·ªßa ch·ªâ m·ª•c.</li></ul><h3 id="_13-su-khac-biet-giua-redo-log-va-binlog-cua-mysql" tabindex="-1"><a class="header-anchor" href="#_13-su-khac-biet-giua-redo-log-va-binlog-cua-mysql"><span>13. S·ª± kh√°c bi·ªát gi·ªØa redo log v√† binlog c·ªßa MySQL?</span></a></h3><figure><img src="https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/herongwei/mysql-a2b8e123-41cb-4717-9225-3a8b49197004.png" alt="Difference between redo log and binlog" tabindex="0" loading="lazy"><figcaption>Difference between redo log and binlog</figcaption></figure><h3 id="_14-tai-sao-can-redo-log" tabindex="-1"><a class="header-anchor" href="#_14-tai-sao-can-redo-log"><span>14. T·∫°i sao c·∫ßn redo log?</span></a></h3><ul><li>Redo log ch·ªß y·∫øu d√πng ƒë·ªÉ kh√¥i ph·ª•c d·ªØ li·ªáu khi MySQL kh·ªüi ƒë·ªông l·∫°i sau khi g·∫∑p s·ª± c·ªë, ƒë·∫£m b·∫£o t√≠nh nh·∫•t qu√°n c·ªßa d·ªØ li·ªáu.</li><li>Th·ª±c t·∫ø, redo log h·ªó tr·ª£ c∆° ch·∫ø WAL c·ªßa MySQL. V√¨ MySQL th·ª±c hi·ªán c·∫≠p nh·∫≠t, ƒë·ªÉ c√≥ th·ªÉ ph·∫£n h·ªìi nhanh ch√≥ng, n√™n s·ª≠ d·ª•ng k·ªπ thu·∫≠t ghi kh√¥ng ƒë·ªìng b·ªô v√†o ƒëƒ©a, ghi v√†o b·ªô nh·ªõ xong l√† tr·∫£ l·ªùi. Nh∆∞ng ƒëi·ªÅu n√†y g√¢y ra nguy c∆° m·∫•t d·ªØ li·ªáu trong b·ªô nh·ªõ sau khi crash, v√† redo log c√≥ kh·∫£ nƒÉng ƒë·∫£m b·∫£o an to√†n khi crash.</li></ul><h3 id="_15-tai-sao-redo-log-co-kha-nang-crash-safe-ma-binlog-khong-the-thay-the-ƒëuoc" tabindex="-1"><a class="header-anchor" href="#_15-tai-sao-redo-log-co-kha-nang-crash-safe-ma-binlog-khong-the-thay-the-ƒëuoc"><span>15. T·∫°i sao redo log c√≥ kh·∫£ nƒÉng crash-safe, m√† binlog kh√¥ng th·ªÉ thay th·∫ø ƒë∆∞·ª£c?</span></a></h3><p><strong>ƒêi·ªÉm ƒë·∫ßu ti√™n:</strong> Redo log c√≥ th·ªÉ ƒë·∫£m b·∫£o InnoDB x√°c ƒë·ªãnh d·ªØ li·ªáu n√†o ƒë√£ ƒë∆∞·ª£c ghi v√†o ƒëƒ©a, d·ªØ li·ªáu n√†o ch∆∞a.</p><ul><li>Redo log v√† binlog c√≥ m·ªôt s·ª± kh√°c bi·ªát l·ªõn l√†, m·ªôt c√°i ghi tu·∫ßn ho√†n, m·ªôt c√°i ghi th√™m. Redo log ch·ªâ ghi l·∫°i c√°c nh·∫≠t k√Ω ch∆∞a ƒë∆∞·ª£c ghi v√†o ƒëƒ©a, c√≤n c√°c d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c ghi v√†o ƒëƒ©a s·∫Ω ƒë∆∞·ª£c x√≥a kh·ªèi file nh·∫≠t k√Ω c√≥ k√≠ch th∆∞·ªõc gi·ªõi h·∫°n n√†y. Binlog l√† nh·∫≠t k√Ω ghi th√™m, l∆∞u tr·ªØ to√†n b·ªô nh·∫≠t k√Ω.</li><li>Khi c∆° s·ªü d·ªØ li·ªáu g·∫∑p s·ª± c·ªë, mu·ªën kh√¥i ph·ª•c d·ªØ li·ªáu ch∆∞a ƒë∆∞·ª£c ghi v√†o ƒëƒ©a nh∆∞ng ƒë√£ ghi v√†o redo log v√† binlog v√†o b·ªô nh·ªõ, binlog kh√¥ng th·ªÉ kh√¥i ph·ª•c ƒë∆∞·ª£c. M·∫∑c d√π binlog c√≥ to√†n b·ªô nh·∫≠t k√Ω, nh∆∞ng kh√¥ng c√≥ d·∫•u hi·ªáu n√†o cho ph√©p InnoDB x√°c ƒë·ªãnh d·ªØ li·ªáu n√†o ƒë√£ ƒë∆∞·ª£c ghi v√†o ƒëƒ©a, d·ªØ li·ªáu n√†o ch∆∞a.</li><li>Nh∆∞ng redo log th√¨ kh√°c, d·ªØ li·ªáu n√†o ƒë√£ ƒë∆∞·ª£c ghi v√†o ƒëƒ©a s·∫Ω ƒë∆∞·ª£c x√≥a kh·ªèi redo log v√¨ n√≥ l√† ghi tu·∫ßn ho√†n. Sau khi kh·ªüi ƒë·ªông l·∫°i c∆° s·ªü d·ªØ li·ªáu, ch·ªâ c·∫ßn kh√¥i ph·ª•c c√°c d·ªØ li·ªáu trong redo log v√†o b·ªô nh·ªõ.</li></ul><p><strong>ƒêi·ªÉm th·ª© hai:</strong> N·∫øu ghi redo log th·∫•t b·∫°i, ƒëi·ªÅu n√†y c√≥ nghƒ©a l√† thao t√°c ƒë√≥ th·∫•t b·∫°i, v√† giao d·ªãch c≈©ng kh√¥ng th·ªÉ ƒë∆∞·ª£c cam k·∫øt.</p><ul><li>Sau m·ªói thao t√°c c·∫≠p nh·∫≠t, redo log s·∫Ω ƒë∆∞·ª£c ghi v√†o nh·∫≠t k√Ω. N·∫øu ghi th·∫•t b·∫°i, ƒëi·ªÅu ƒë√≥ c√≥ nghƒ©a l√† thao t√°c n√†y th·∫•t b·∫°i, v√† giao d·ªãch c≈©ng kh√¥ng th·ªÉ ƒë∆∞·ª£c cam k·∫øt.</li><li>C·∫•u tr√∫c b√™n trong c·ªßa redo log d·ª±a tr√™n trang, ghi l·∫°i s·ª± thay ƒë·ªïi c·ªßa c√°c gi√° tr·ªã tr∆∞·ªùng tr√™n trang ƒë√≥, ch·ªâ c·∫ßn ƒë·ªçc redo log v√† th·ª±c hi·ªán l·∫°i sau khi crash l√† c√≥ th·ªÉ kh√¥i ph·ª•c d·ªØ li·ªáu.</li><li>ƒê√≥ l√† l√Ω do t·∫°i sao redo log c√≥ kh·∫£ nƒÉng crash-safe, trong khi binlog th√¨ kh√¥ng.</li></ul><h3 id="_16-khi-co-so-du-lieu-gap-su-co-lam-the-nao-ƒëe-khoi-phuc-du-lieu-chua-ƒëuoc-ghi-vao-ƒëia-vao-bo-nho" tabindex="-1"><a class="header-anchor" href="#_16-khi-co-so-du-lieu-gap-su-co-lam-the-nao-ƒëe-khoi-phuc-du-lieu-chua-ƒëuoc-ghi-vao-ƒëia-vao-bo-nho"><span>16. Khi c∆° s·ªü d·ªØ li·ªáu g·∫∑p s·ª± c·ªë, l√†m th·∫ø n√†o ƒë·ªÉ kh√¥i ph·ª•c d·ªØ li·ªáu ch∆∞a ƒë∆∞·ª£c ghi v√†o ƒëƒ©a v√†o b·ªô nh·ªõ?</span></a></h3><p>D·ª±a tr√™n c∆° ch·∫ø cam k·∫øt hai giai ƒëo·∫°n c·ªßa redo log v√† binlog, d·ªØ li·ªáu ch∆∞a ƒë∆∞·ª£c l∆∞u tr·ªØ bao g·ªìm c√°c tr∆∞·ªùng h·ª£p sau:</p><ul><li>Change buffer ƒë√£ ƒë∆∞·ª£c ghi, redo log ƒë√£ fsync nh∆∞ng ch∆∞a cam k·∫øt, binlog ch∆∞a fsync v√†o ƒëƒ©a, d·ªØ li·ªáu n√†y b·ªã m·∫•t.</li><li>Change buffer ƒë√£ ƒë∆∞·ª£c ghi, redo log fsync nh∆∞ng ch∆∞a cam k·∫øt, binlog ƒë√£ fsync v√†o ƒëƒ©a, kh√¥i ph·ª•c redo log t·ª´ binlog, sau ƒë√≥ kh√¥i ph·ª•c change buffer t·ª´ redo log.</li><li>Change buffer ƒë√£ ƒë∆∞·ª£c ghi, redo log v√† binlog ƒë·ªÅu ƒë√£ fsync, kh√¥i ph·ª•c tr·ª±c ti·∫øp t·ª´ redo log.</li></ul><h3 id="_17-cach-ghi-redo-log" tabindex="-1"><a class="header-anchor" href="#_17-cach-ghi-redo-log"><span>17. C√°ch ghi redo log?</span></a></h3><p>Redo log bao g·ªìm hai ph·∫ßn: <strong>b·ªô ƒë·ªám nh·∫≠t k√Ω</strong> (redo log buffer) trong b·ªô nh·ªõ v√† <strong>t·ªáp nh·∫≠t k√Ω</strong> (redo log file) tr√™n ƒëƒ©a.</p><p>MySQL th·ª±c hi·ªán m·ªói c√¢u l·ªánh DML, tr∆∞·ªõc ti√™n s·∫Ω ghi l·∫°i v√†o <strong>redo log buffer (kh√¥ng gian ng∆∞·ªùi d√πng)</strong>, sau ƒë√≥ l∆∞u v√†o b·ªô ƒë·ªám c·ªßa h·ªá ƒëi·ªÅu h√†nh OS-buffer, v√† sau ƒë√≥ v√†o m·ªôt th·ªùi ƒëi·ªÉm n√†o ƒë√≥ s·∫Ω ghi l·∫°i nhi·ªÅu thao t√°c v√†o <strong>redo log file (ghi v√†o ƒëƒ©a)</strong>. K·ªπ thu·∫≠t n√†y g·ªçi l√† <strong>WAL</strong>.</p><p>C√≥ th·ªÉ th·∫•y, redo log buffer ƒë∆∞·ª£c ghi v√†o redo log file th√¥ng qua OS buffer. Th·ª±c t·∫ø, c√≥ th·ªÉ c·∫•u h√¨nh th√¥ng qua tham s·ªë <code>innodb_flush_log_at_trx_commit</code>, v·ªõi c√°c gi√° tr·ªã sau:</p><ul><li><code>0</code>: g·ªçi l√† <strong>ghi tr·ªÖ</strong>, khi cam k·∫øt giao d·ªãch s·∫Ω kh√¥ng ghi nh·∫≠t k√Ω trong redo log buffer v√†o OS buffer, m√† s·∫Ω ghi v√†o OS buffer m·ªói gi√¢y v√† sau ƒë√≥ g·ªçi ghi v√†o redo log file.</li><li><code>1</code>: g·ªçi l√† <strong>ghi th·ªùi gian th·ª±c</strong>, khi cam k·∫øt giao d·ªãch s·∫Ω ghi nh·∫≠t k√Ω trong redo log buffer v√†o OS buffer v√† l∆∞u v√†o redo log file m·ªói l·∫ßn.</li><li><code>2</code>: g·ªçi l√† <strong>ghi th·ªùi gian th·ª±c, ghi tr·ªÖ v√†o ƒëƒ©a</strong>, khi cam k·∫øt giao d·ªãch s·∫Ω ghi v√†o OS buffer, sau ƒë√≥ m·ªói gi√¢y s·∫Ω ghi nh·∫≠t k√Ω v√†o redo log file.</li></ul><h3 id="_18-quy-trinh-thuc-hien-cua-redo-log" tabindex="-1"><a class="header-anchor" href="#_18-quy-trinh-thuc-hien-cua-redo-log"><span>18. Quy tr√¨nh th·ª±c hi·ªán c·ªßa redo log?</span></a></h3><p>Ch√∫ng ta c√πng xem quy tr√¨nh th·ª±c hi·ªán c·ªßa redo log, gi·∫£ s·ª≠ c√¢u l·ªánh SQL nh∆∞ sau:</p><div class="language-" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span>update T set a = 1 where id = 666</span></span></code></pre></div><ol><li>MySQL client g·ª≠i c√¢u l·ªánh <code>update T set a = 1 where id = 666</code> t·ªõi l·ªõp MySQL Server.</li><li>L·ªõp MySQL Server nh·∫≠n c√¢u l·ªánh SQL, ph√¢n t√≠ch, t·ªëi ∆∞u h√≥a v√† th·ª±c hi·ªán c√°c c√¥ng vi·ªác li√™n quan, sau ƒë√≥ g·ª≠i k·∫ø ho·∫°ch th·ª±c hi·ªán SQL t·ªõi l·ªõp InnoDB Storage Engine ƒë·ªÉ th·ª±c hi·ªán.</li><li>L·ªõp InnoDB Storage Engine ghi nh·∫≠n thao t√°c <strong>a ƒë∆∞·ª£c s·ª≠a th√†nh 1</strong> v√†o b·ªô nh·ªõ.</li><li>Sau khi ghi v√†o b·ªô nh·ªõ, s·∫Ω c·∫≠p nh·∫≠t ghi ch√©p trong redo log, th√™m m·ªôt d√≤ng ghi ch√©p v·ªõi n·ªôi dung <strong>th·ª±c hi·ªán thay ƒë·ªïi g√¨ tr√™n trang d·ªØ li·ªáu n√†o</strong>.</li><li>Sau ƒë√≥, ƒë·∫∑t tr·∫°ng th√°i c·ªßa giao d·ªãch th√†nh <code>prepare</code>, cho bi·∫øt ƒë√£ s·∫µn s√†ng cam k·∫øt giao d·ªãch.</li><li>Khi l·ªõp MySQL Server x·ª≠ l√Ω xong giao d·ªãch, s·∫Ω ƒë·∫∑t tr·∫°ng th√°i c·ªßa giao d·ªãch th√†nh <code>commit</code>, t·ª©c l√† cam k·∫øt giao d·ªãch.</li><li>Sau khi nh·∫≠n y√™u c·∫ßu cam k·∫øt giao d·ªãch, redo log s·∫Ω ghi c√°c thao t√°c ƒë√£ ghi v√†o b·ªô nh·ªõ v√†o ƒëƒ©a, ho√†n th√†nh qu√° tr√¨nh ghi nh·∫≠t k√Ω.</li></ol><h3 id="_19-binlog-la-gi-chuc-nang-cua-no-la-gi-va-no-co-ƒëam-bao-an-toan-khi-gap-su-co-khong" tabindex="-1"><a class="header-anchor" href="#_19-binlog-la-gi-chuc-nang-cua-no-la-gi-va-no-co-ƒëam-bao-an-toan-khi-gap-su-co-khong"><span>19. Binlog l√† g√¨, ch·ª©c nƒÉng c·ªßa n√≥ l√† g√¨, v√† n√≥ c√≥ ƒë·∫£m b·∫£o an to√†n khi g·∫∑p s·ª± c·ªë kh√¥ng?</span></a></h3><ul><li>Binlog l√† nh·∫≠t k√Ω l∆∞u tr·ªØ, thu·ªôc v·ªÅ l·ªõp MySQL Server. N√≥ c√≥ hai ch·ª©c nƒÉng ch√≠nh l√† <strong>sao ch√©p ch√≠nh-ph·ª•</strong> v√† <strong>kh√¥i ph·ª•c d·ªØ li·ªáu</strong>.</li><li>Khi c·∫ßn <strong>kh√¥i ph·ª•c d·ªØ li·ªáu</strong>, c√≥ th·ªÉ tr√≠ch xu·∫•t binlog trong kho·∫£ng th·ªùi gian c·ª• th·ªÉ ƒë·ªÉ ph√°t l·∫°i v√† kh√¥i ph·ª•c.</li><li>Tuy nhi√™n, binlog kh√¥ng ƒë·∫£m b·∫£o an to√†n khi g·∫∑p s·ª± c·ªë v√¨ tr∆∞·ªõc khi s·ª± c·ªë x·∫£y ra, binlog <strong>c√≥ th·ªÉ ch∆∞a ƒë∆∞·ª£c ghi ho√†n to√†n</strong> v√†o MySQL. Do ƒë√≥, c·∫ßn ph·∫£i k·∫øt h·ª£p v·ªõi <strong>redo log</strong> ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n khi g·∫∑p s·ª± c·ªë.</li></ul><h3 id="_20-giao-dich-hai-giai-ƒëoan-la-gi" tabindex="-1"><a class="header-anchor" href="#_20-giao-dich-hai-giai-ƒëoan-la-gi"><span>20. Giao d·ªãch hai giai ƒëo·∫°n l√† g√¨?</span></a></h3><p>MySQL chia qu√° tr√¨nh ghi redo log th√†nh hai b∆∞·ªõc: prepare v√† commit, xen gi·ªØa l√† qu√° tr√¨nh ghi binlog, ƒë√≥ l√† &quot;giao d·ªãch hai giai ƒëo·∫°n&quot;.</p><figure><img src="https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/herongwei/mysql-11420486-f9d0-483a-ba2e-a742ec4c518d.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Giao d·ªãch hai giai ƒëo·∫°n gi√∫p ƒë·∫£m b·∫£o hai tr·∫°ng th√°i n√†y duy tr√¨ t√≠nh nh·∫•t qu√°n logic. Redo log d√πng ƒë·ªÉ kh√¥i ph·ª•c d·ªØ li·ªáu ch∆∞a c·∫≠p nh·∫≠t khi m√°y ch·ªß g·∫∑p s·ª± c·ªë, binlog d√πng cho sao l∆∞u. V√¨ c·∫£ hai l√† hai th·ª±c th·ªÉ ƒë·ªôc l·∫≠p, ƒë·ªÉ gi·ªØ cho ch√∫ng nh·∫•t qu√°n, c·∫ßn s·ª≠ d·ª•ng gi·∫£i ph√°p giao d·ªãch ph√¢n t√°n.</p><p><strong>T·∫°i sao c·∫ßn giao d·ªãch hai giai ƒëo·∫°n?</strong></p><ul><li>N·∫øu kh√¥ng d√πng giao d·ªãch hai giai ƒëo·∫°n, c√≥ th·ªÉ x·∫£y ra c√°c t√¨nh hu·ªëng sau: <ul><li>Ghi redo log tr∆∞·ªõc, sau ƒë√≥ g·∫∑p s·ª± c·ªë, qu√° tr√¨nh sao l∆∞u binlog s·∫Ω thi·∫øu m·ªôt l·∫ßn c·∫≠p nh·∫≠t, kh√¥ng nh·∫•t qu√°n v·ªõi d·ªØ li·ªáu hi·ªán t·∫°i.</li><li>Ghi binlog tr∆∞·ªõc, sau ƒë√≥ g·∫∑p s·ª± c·ªë, do redo log ch∆∞a ƒë∆∞·ª£c ghi, giao d·ªãch kh√¥ng h·ª£p l·ªá, v√¨ v·∫≠y khi sao l∆∞u binlog, d·ªØ li·ªáu s·∫Ω kh√¥ng nh·∫•t qu√°n.</li></ul></li><li>Giao d·ªãch hai giai ƒëo·∫°n ƒë·∫£m b·∫£o s·ª± nh·∫•t qu√°n an to√†n c·ªßa d·ªØ li·ªáu gi·ªØa redo log v√† binlog. Ch·ªâ khi hai t·ªáp nh·∫≠t k√Ω n√†y nh·∫•t qu√°n logic, b·∫°n m·ªõi c√≥ th·ªÉ y√™n t√¢m s·ª≠ d·ª•ng.</li></ul><p>Khi kh√¥i ph·ª•c d·ªØ li·ªáu, n·∫øu tr·∫°ng th√°i c·ªßa redo log l√† commit th√¨ binlog c≈©ng th√†nh c√¥ng, kh√¥i ph·ª•c d·ªØ li·ªáu tr·ª±c ti·∫øp; n·∫øu redo log ·ªü tr·∫°ng th√°i prepare, c·∫ßn ki·ªÉm tra xem giao d·ªãch t∆∞∆°ng ·ª©ng trong binlog c√≥ th√†nh c√¥ng hay kh√¥ng ƒë·ªÉ quy·∫øt ƒë·ªãnh rollback ho·∫∑c ti·∫øp t·ª•c th·ª±c hi·ªán.</p><h3 id="_21-mysql-lam-the-nao-ƒëe-biet-binlog-la-hoan-chinh" tabindex="-1"><a class="header-anchor" href="#_21-mysql-lam-the-nao-ƒëe-biet-binlog-la-hoan-chinh"><span>21. MySQL l√†m th·∫ø n√†o ƒë·ªÉ bi·∫øt binlog l√† ho√†n ch·ªânh?</span></a></h3><p>Binlog c·ªßa m·ªôt giao d·ªãch c√≥ ƒë·ªãnh d·∫°ng ho√†n ch·ªânh:</p><ul><li>ƒê·ªëi v·ªõi ƒë·ªãnh d·∫°ng statement, binlog cu·ªëi c√πng s·∫Ω c√≥ COMMIT;</li><li>ƒê·ªëi v·ªõi ƒë·ªãnh d·∫°ng row, binlog cu·ªëi c√πng s·∫Ω c√≥ m·ªôt s·ª± ki·ªán XID.</li></ul><h3 id="_22-wal-la-gi-va-uu-ƒëiem-cua-no-la-gi" tabindex="-1"><a class="header-anchor" href="#_22-wal-la-gi-va-uu-ƒëiem-cua-no-la-gi"><span>22. WAL l√† g√¨ v√† ∆∞u ƒëi·ªÉm c·ªßa n√≥ l√† g√¨?</span></a></h3><p>WAL, vi·∫øt t·∫Øt c·ªßa Write-Ahead Logging, c√≥ nghƒ©a l√† ghi nh·∫≠t k√Ω tr∆∞·ªõc khi ghi v√†o ƒëƒ©a. Sau khi MySQL th·ª±c hi·ªán thao t√°c c·∫≠p nh·∫≠t, <strong>tr∆∞·ªõc khi th·ª±c s·ª± ghi d·ªØ li·ªáu v√†o ƒëƒ©a, tr∆∞·ªõc ti√™n s·∫Ω ghi nh·∫≠t k√Ω</strong>.</p><p>∆Øu ƒëi·ªÉm l√† kh√¥ng c·∫ßn ghi d·ªØ li·ªáu v√†o ƒëƒ©a ngay l·∫≠p t·ª©c cho m·ªói thao t√°c, ngay c·∫£ khi g·∫∑p s·ª± c·ªë, c√≥ th·ªÉ kh√¥i ph·ª•c d·ªØ li·ªáu th√¥ng qua redo log, do ƒë√≥ c√≥ th·ªÉ ph·∫£n h·ªìi nhanh ch√≥ng c√°c c√¢u l·ªánh SQL.</p><h3 id="_23-cac-ƒëinh-dang-nhat-ky-binlog" tabindex="-1"><a class="header-anchor" href="#_23-cac-ƒëinh-dang-nhat-ky-binlog"><span>23. C√°c ƒë·ªãnh d·∫°ng nh·∫≠t k√Ω binlog</span></a></h3><p>Binlog c√≥ ba ƒë·ªãnh d·∫°ng:</p><ul><li>Statement: Sao ch√©p d·ª±a tr√™n c√¢u l·ªánh (statement-based replication, SBR)</li><li>Row: Sao ch√©p d·ª±a tr√™n h√†ng (row-based replication, RBR)</li><li>Mixed: Sao ch√©p ·ªü ch·∫ø ƒë·ªô h·ªón h·ª£p (mixed-based replication, MBR)</li></ul><p><strong>ƒê·ªãnh d·∫°ng Statement</strong></p><p>M·ªói c√¢u l·ªánh SQL thay ƒë·ªïi d·ªØ li·ªáu ƒë·ªÅu ƒë∆∞·ª£c ghi l·∫°i trong binlog.</p><ul><li>∆Øu ƒëi·ªÉm: Kh√¥ng c·∫ßn ghi l·∫°i t·ª´ng thay ƒë·ªïi c·ªßa m·ªói h√†ng, gi·∫£m l∆∞·ª£ng nh·∫≠t k√Ω binlog, ti·∫øt ki·ªám IO, c·∫£i thi·ªán hi·ªáu su·∫•t.</li><li>Nh∆∞·ª£c ƒëi·ªÉm: V√¨ ch·ªâ ghi l·∫°i c√¢u l·ªánh th·ª±c hi·ªán, ƒë·ªÉ c√°c c√¢u l·ªánh n√†y c√≥ th·ªÉ ch·∫°y ƒë√∫ng tr√™n m√°y ch·ªß ph·ª•, c·∫ßn ghi l·∫°i m·ªôt s·ªë th√¥ng tin li√™n quan khi th·ª±c hi·ªán m·ªói c√¢u l·ªánh ƒë·ªÉ ƒë·∫£m b·∫£o t·∫•t c·∫£ c√°c c√¢u l·ªánh tr√™n m√°y ch·ªß ph·ª• c√≥ k·∫øt qu·∫£ gi·ªëng nh∆∞ khi th·ª±c hi·ªán tr√™n m√°y ch·ªß ch√≠nh.</li></ul><p><strong>ƒê·ªãnh d·∫°ng Row</strong></p><p>Kh√¥ng ghi l·∫°i th√¥ng tin li√™n quan ƒë·∫øn c√¢u l·ªánh SQL, ch·ªâ l∆∞u tr·ªØ h√†ng n√†o b·ªã thay ƒë·ªïi.</p><ul><li>∆Øu ƒëi·ªÉm: Binlog kh√¥ng c·∫ßn ghi l·∫°i th√¥ng tin li√™n quan ƒë·∫øn ng·ªØ c·∫£nh c·ªßa c√¢u l·ªánh SQL, ch·ªâ c·∫ßn ghi l·∫°i h√†ng n√†o b·ªã thay ƒë·ªïi v√† thay ƒë·ªïi th√†nh g√¨. Do ƒë√≥, n·ªôi dung nh·∫≠t k√Ω row-level s·∫Ω ghi chi ti·∫øt c√°c thay ƒë·ªïi c·ªßa t·ª´ng h√†ng d·ªØ li·ªáu. Kh√¥ng g·∫∑p v·∫•n ƒë·ªÅ v·ªÅ sao ch√©p ƒë√∫ng trong m·ªôt s·ªë t√¨nh hu·ªëng nh·∫•t ƒë·ªãnh nh∆∞ c√°c th·ªß t·ª•c l∆∞u tr·ªØ, h√†m, ho·∫∑c trigger.</li><li>Nh∆∞·ª£c ƒëi·ªÉm: C√≥ th·ªÉ t·∫°o ra l∆∞·ª£ng l·ªõn n·ªôi dung nh·∫≠t k√Ω.</li></ul><p><strong>ƒê·ªãnh d·∫°ng Mixed</strong></p><p>Th·ª±c ch·∫•t l√† s·ª± k·∫øt h·ª£p gi·ªØa Statement v√† Row. C√°c c√¢u l·ªánh thay ƒë·ªïi th√¥ng th∆∞·ªùng s·ª≠ d·ª•ng ƒë·ªãnh d·∫°ng statement ƒë·ªÉ l∆∞u tr·ªØ binlog, nh∆∞ c√°c h√†m m√† statement kh√¥ng th·ªÉ th·ª±c hi·ªán sao ch√©p ch√≠nh-ph·ª• th√¨ s·ª≠ d·ª•ng ƒë·ªãnh d·∫°ng row ƒë·ªÉ l∆∞u tr·ªØ binlog. MySQL s·∫Ω d·ª±a tr√™n t·ª´ng c√¢u l·ªánh SQL c·ª• th·ªÉ ƒë·ªÉ quy·∫øt ƒë·ªãnh ƒë·ªãnh d·∫°ng nh·∫≠t k√Ω n√†o.</p><h3 id="_24-ƒëinh-dang-nhat-ky-redo-log" tabindex="-1"><a class="header-anchor" href="#_24-ƒëinh-dang-nhat-ky-redo-log"><span>24. ƒê·ªãnh d·∫°ng nh·∫≠t k√Ω redo log</span></a></h3><figure><img src="https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/herongwei/mysql-ee8a859f-d1e8-4ab6-94d1-9733373be825.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Redo log buffer (trong b·ªô nh·ªõ) ƒë∆∞·ª£c t·∫°o th√†nh t·ª´ b·ªën t·ªáp n·ªëi ti·∫øp nhau, bao g·ªìm: ib_logfile_1, ib_logfile_2, ib_logfile_3, ib_logfile_4.</p><ul><li>Write pos l√† v·ªã tr√≠ hi·ªán t·∫°i ghi nh·∫≠t k√Ω, khi ghi xong s·∫Ω di chuy·ªÉn v·ªÅ ph√≠a sau. Khi ghi ƒë·∫øn cu·ªëi t·ªáp th·ª© ba th√¨ quay l·∫°i ƒë·∫ßu t·ªáp 0.</li><li>Checkpoint l√† v·ªã tr√≠ hi·ªán t·∫°i c·∫ßn x√≥a, c≈©ng di chuy·ªÉn v·ªÅ ph√≠a sau v√† l·∫∑p l·∫°i. Tr∆∞·ªõc khi x√≥a nh·∫≠t k√Ω c·∫ßn c·∫≠p nh·∫≠t nh·∫≠t k√Ω v√†o t·ªáp d·ªØ li·ªáu.</li><li>Kho·∫£ng tr·ªëng gi·ªØa write pos v√† checkpoint l√† ph·∫ßn ch∆∞a ƒë∆∞·ª£c s·ª≠ d·ª•ng, c√≥ th·ªÉ ghi nh·∫≠t k√Ω m·ªõi.</li><li>N·∫øu write pos ƒëu·ªïi k·ªãp checkpoint, nghƒ©a l√† nh·∫≠t k√Ω ƒë√£ ƒë·∫ßy, kh√¥ng th·ªÉ th·ª±c hi·ªán c√°c c·∫≠p nh·∫≠t m·ªõi m√† ph·∫£i d·ª´ng l·∫°i ƒë·ªÉ x√≥a m·ªôt s·ªë nh·∫≠t k√Ω, ƒë·∫©y checkpoint v·ªÅ ph√≠a tr∆∞·ªõc.</li><li>V·ªõi redo log, khi c∆° s·ªü d·ªØ li·ªáu g·∫∑p s·ª± c·ªë v√† kh·ªüi ƒë·ªông l·∫°i, c√≥ th·ªÉ kh√¥i ph·ª•c d·ªØ li·ªáu ch∆∞a ƒë∆∞·ª£c ghi v√†o ƒëƒ©a (d·ªØ li·ªáu sau checkpoint) t·ª´ redo log, ƒë·∫£m b·∫£o c√°c b·∫£n ghi giao d·ªãch ƒë√£ ƒë∆∞·ª£c ho√†n th√†nh kh√¥ng b·ªã m·∫•t, kh·∫£ nƒÉng n√†y ƒë∆∞·ª£c g·ªçi l√† <strong>crash-safe</strong>.</li></ul><h3 id="_25-nhung-nguyen-nhan-gi-khien-cau-lenh-sql-ƒëang-le-thuc-thi-rat-nhanh-nhung-lai-chay-cham-hon-du-kien-lam-the-nao-ƒëe-giai-quyet" tabindex="-1"><a class="header-anchor" href="#_25-nhung-nguyen-nhan-gi-khien-cau-lenh-sql-ƒëang-le-thuc-thi-rat-nhanh-nhung-lai-chay-cham-hon-du-kien-lam-the-nao-ƒëe-giai-quyet"><span>25. Nh·ªØng nguy√™n nh√¢n g√¨ khi·∫øn c√¢u l·ªánh SQL ƒë√°ng l·∫Ω th·ª±c thi r·∫•t nhanh nh∆∞ng l·∫°i ch·∫°y ch·∫≠m h∆°n d·ª± ki·∫øn? L√†m th·∫ø n√†o ƒë·ªÉ gi·∫£i quy·∫øt?</span></a></h3><p>Nguy√™n nh√¢n: T·ª´ l·ªõn ƒë·∫øn nh·ªè c√≥ th·ªÉ chia th√†nh b·ªën t√¨nh hu·ªëng:</p><ul><li>MySQL b·ªã t·∫Øc ngh·∫Ωn, ch·∫≥ng h·∫°n nh∆∞: t√†i nguy√™n h·ªá th·ªëng ho·∫∑c m·∫°ng kh√¥ng ƒë·ªß.</li><li>C√¢u l·ªánh SQL b·ªã t·∫Øc ngh·∫Ωn, ch·∫≥ng h·∫°n nh∆∞: kh√≥a b·∫£ng, kh√≥a h√†ng, l√†m cho b·ªô m√°y l∆∞u tr·ªØ kh√¥ng th·ª±c hi·ªán c√¢u l·ªánh SQL t∆∞∆°ng ·ª©ng.</li><li>Do s·ª≠ d·ª•ng ch·ªâ m·ª•c kh√¥ng ƒë√∫ng, kh√¥ng s·ª≠ d·ª•ng ch·ªâ m·ª•c.</li><li>ƒê·∫∑c ƒëi·ªÉm c·ªßa d·ªØ li·ªáu trong b·∫£ng d·∫´n ƒë·∫øn, m·∫∑c d√π c√≥ ch·ªâ m·ª•c nh∆∞ng s·ªë l·∫ßn quay l·∫°i b·∫£ng r·∫•t l·ªõn.</li></ul><p>Gi·∫£i ph√°p:</p><ul><li>Xem x√©t s·ª≠ d·ª•ng force index ƒë·ªÉ √©p bu·ªôc ch·ªçn m·ªôt ch·ªâ m·ª•c.</li><li>Xem x√©t s·ª≠a ƒë·ªïi c√¢u l·ªánh, h∆∞·ªõng d·∫´n MySQL s·ª≠ d·ª•ng ch·ªâ m·ª•c m√† b·∫°n mong mu·ªën. V√≠ d·ª•, thay ƒë·ªïi &quot;order by b limit 1&quot; th√†nh &quot;order by b, a limit 1&quot;, logic ng·ªØ nghƒ©a l√† t∆∞∆°ng ƒë∆∞∆°ng.</li><li>Ph∆∞∆°ng ph√°p th·ª© ba l√†, trong m·ªôt s·ªë t√¨nh hu·ªëng, c√≥ th·ªÉ t·∫°o m·ªôt ch·ªâ m·ª•c ph√π h·ª£p h∆°n ƒë·ªÉ cung c·∫•p cho b·ªô t·ªëi ∆∞u h√≥a ƒë·ªÉ l·ª±a ch·ªçn, ho·∫∑c x√≥a ch·ªâ m·ª•c b·ªã s·ª≠ d·ª•ng sai.</li><li>N·∫øu x√°c ƒë·ªãnh ch·ªâ m·ª•c kh√¥ng c·∫ßn thi·∫øt, c√≥ th·ªÉ xem x√©t x√≥a ch·ªâ m·ª•c.</li></ul><h3 id="_26-cau-truc-trang-du-lieu-cua-innodb" tabindex="-1"><a class="header-anchor" href="#_26-cau-truc-trang-du-lieu-cua-innodb"><span>26. C·∫•u tr√∫c trang d·ªØ li·ªáu c·ªßa InnoDB</span></a></h3><p>M·ªôt trang d·ªØ li·ªáu ƒë∆∞·ª£c chia th√†nh b·∫£y ph·∫ßn:</p><ul><li>File Header: Bi·ªÉu th·ªã th√¥ng tin chung c·ªßa trang, chi·∫øm 38 byte c·ªë ƒë·ªãnh.</li><li>Page Header: Bi·ªÉu th·ªã th√¥ng tin ri√™ng c·ªßa trang d·ªØ li·ªáu, chi·∫øm 56 byte c·ªë ƒë·ªãnh.</li><li>Minimum + Supermum: Hai b·∫£n ghi gi·∫£ l·∫≠p, l·∫ßn l∆∞·ª£t bi·ªÉu th·ªã b·∫£n ghi nh·ªè nh·∫•t v√† l·ªõn nh·∫•t trong trang, chi·∫øm 26 byte c·ªë ƒë·ªãnh.</li><li>User Records: Th·ª±c s·ª± l∆∞u tr·ªØ d·ªØ li·ªáu ch√∫ng ta ch√®n v√†o, k√≠ch th∆∞·ªõc kh√¥ng c·ªë ƒë·ªãnh.</li><li>Free Space: Ph·∫ßn ch∆∞a ƒë∆∞·ª£c s·ª≠ d·ª•ng trong trang, k√≠ch th∆∞·ªõc kh√¥ng c·ªë ƒë·ªãnh.</li><li>Page Directory: V·ªã tr√≠ t∆∞∆°ng ƒë·ªëi c·ªßa m·ªôt s·ªë b·∫£n ghi trong trang, nghƒ©a l√† ƒë·ªãa ch·ªâ c·ªßa m·ªói b·∫£n ghi trong trang.</li><li>File Trailer: D√πng ƒë·ªÉ ki·ªÉm tra trang c√≥ ho√†n ch·ªânh kh√¥ng, chi·∫øm 8 byte c·ªë ƒë·ªãnh.</li></ul><h2 id="cac-khai-niem-lien-quan-ƒëen-du-lieu" tabindex="-1"><a class="header-anchor" href="#cac-khai-niem-lien-quan-ƒëen-du-lieu"><span>C√°c kh√°i ni·ªám li√™n quan ƒë·∫øn d·ªØ li·ªáu</span></a></h2><h3 id="_27-mysql-ƒëam-bao-du-lieu-khong-bi-mat-nhu-the-nao" tabindex="-1"><a class="header-anchor" href="#_27-mysql-ƒëam-bao-du-lieu-khong-bi-mat-nhu-the-nao"><span>27. MySQL ƒë·∫£m b·∫£o d·ªØ li·ªáu kh√¥ng b·ªã m·∫•t nh∆∞ th·∫ø n√†o?</span></a></h3><ul><li>Ch·ªâ c·∫ßn <code>redolog</code> v√† <code>binlog</code> ƒë·∫£m b·∫£o ƒë∆∞·ª£c ghi v√†o ƒëƒ©a th√¨ c√≥ th·ªÉ ƒë·∫£m b·∫£o d·ªØ li·ªáu c·ªßa MySQL c√≥ th·ªÉ ƒë∆∞·ª£c kh√¥i ph·ª•c sau khi kh·ªüi ƒë·ªông l·∫°i do l·ªói.</li><li>Khi kh√¥i ph·ª•c d·ªØ li·ªáu, n·∫øu tr·∫°ng th√°i <code>redolog</code> l√† <code>commit</code> th√¨ c√≥ nghƒ©a l√† <code>binlog</code> c≈©ng ƒë√£ th√†nh c√¥ng, d·ªØ li·ªáu ƒë∆∞·ª£c kh√¥i ph·ª•c tr·ª±c ti·∫øp; n·∫øu tr·∫°ng th√°i <code>redolog</code> l√† <code>prepare</code>, c·∫ßn ki·ªÉm tra giao d·ªãch <code>binlog</code> t∆∞∆°ng ·ª©ng c√≥ th√†nh c√¥ng hay kh√¥ng ƒë·ªÉ quy·∫øt ƒë·ªãnh kh√¥i ph·ª•c ho·∫∑c rollback.</li></ul><h3 id="_28-lam-gi-khi-du-lieu-bi-xoa-nham" tabindex="-1"><a class="header-anchor" href="#_28-lam-gi-khi-du-lieu-bi-xoa-nham"><span>28. L√†m g√¨ khi d·ªØ li·ªáu b·ªã x√≥a nh·∫ßm?</span></a></h3><p>C√¥ng vi·ªác c·ªët l√µi c·ªßa DBA l√† ƒë·∫£m b·∫£o t√≠nh to√†n v·∫πn c·ªßa d·ªØ li·ªáu. Tr∆∞·ªõc ti√™n, c·∫ßn th·ª±c hi·ªán c√°c bi·ªán ph√°p ph√≤ng ng·ª´a th√¥ng qua c√°c ƒëi·ªÉm sau:</p><ul><li>Ki·ªÉm so√°t v√† ph√¢n quy·ªÅn (quy·ªÅn h·∫°n c·ªßa c∆° s·ªü d·ªØ li·ªáu v√† m√°y ch·ªß)</li><li>Thi·∫øt l·∫≠p quy tr√¨nh thao t√°c</li><li>ƒê√†o t·∫°o ƒë·ªãnh k·ª≥ cho c√°c nh√† ph√°t tri·ªÉn</li><li>X√¢y d·ª±ng b·∫£n sao l∆∞u tr·ªÖ</li><li>Th·ª±c hi·ªán ki·ªÉm tra SQL, t·∫•t c·∫£ c√°c c√¢u l·ªánh thay ƒë·ªïi d·ªØ li·ªáu tr√™n m√¥i tr∆∞·ªùng tr·ª±c tuy·∫øn (DML v√† DDL) c·∫ßn ƒë∆∞·ª£c ki·ªÉm tra k·ªπ l∆∞·ª°ng</li><li>Th·ª±c hi·ªán sao l∆∞u. C√≥ hai ph∆∞∆°ng ph√°p sao l∆∞u: <ol><li>N·∫øu d·ªØ li·ªáu l·ªõn, s·ª≠ d·ª•ng sao l∆∞u v·∫≠t l√Ω <code>xtrabackup</code>. Th·ª±c hi·ªán sao l∆∞u to√†n b·ªô ƒë·ªãnh k·ª≥ v√† c√≥ th·ªÉ sao l∆∞u gia tƒÉng.</li><li>N·∫øu d·ªØ li·ªáu nh·ªè, s·ª≠ d·ª•ng <code>mysqldump</code> ho·∫∑c <code>mysqldumper</code>. Sau ƒë√≥ kh√¥i ph·ª•c b·∫±ng <code>binlog</code> ho·∫∑c x√¢y d·ª±ng c·∫•u h√¨nh master-slave ƒë·ªÉ kh√¥i ph·ª•c d·ªØ li·ªáu. ƒê·ªãnh k·ª≥ sao l∆∞u t·ªáp <code>binlog</code> c≈©ng r·∫•t c·∫ßn thi·∫øt.</li></ol></li><li>Khi x·∫£y ra thao t√°c x√≥a d·ªØ li·ªáu, c√≥ th·ªÉ kh√¥i ph·ª•c theo c√°c ph∆∞∆°ng ph√°p sau: <ul><li>N·∫øu thao t√°c DML g√¢y m·∫•t ho·∫∑c kh√¥ng ho√†n ch·ªânh d·ªØ li·ªáu, c√≥ th·ªÉ s·ª≠ d·ª•ng <code>flashback</code> ho·∫∑c c√¥ng c·ª• <code>myflash</code> c·ªßa Meituan. C·∫£ hai ƒë·ªÅu ph√¢n t√≠ch s·ª± ki·ªán <code>binlog</code> v√† th·ª±c hi·ªán ƒë·∫£o ng∆∞·ª£c c√°c thao t√°c nh∆∞ <code>delete</code> th√†nh <code>insert</code>, <code>insert</code> th√†nh <code>delete</code>, ho√°n ƒë·ªïi ·∫£nh tr∆∞·ªõc v√† sau c·ªßa <code>update</code>. ƒêi·ªÅu n√†y ƒë√≤i h·ªèi <code>binlog_format</code> ph·∫£i l√† <code>row</code> v√† <code>binlog_row_image</code> l√† <code>full</code>. Kh√¥i ph·ª•c d·ªØ li·ªáu tr∆∞·ªõc ti√™n n√™n th·ª±c hi·ªán tr√™n instance t·∫°m th·ªùi, sau ƒë√≥ kh√¥i ph·ª•c l√™n master.</li><li>N·∫øu thao t√°c DDL nh∆∞ <code>truncate</code> ho·∫∑c <code>drop</code> x·∫£y ra, do DDL kh√¥ng ghi h√¨nh ·∫£nh (image) trong <code>binlog</code>, n√™n kh√¥i ph·ª•c s·∫Ω ph·ª©c t·∫°p h∆°n, c·∫ßn s·ª≠ d·ª•ng ph∆∞∆°ng ph√°p sao l∆∞u to√†n b·ªô v√† √°p d·ª•ng <code>binlog</code>. Khi d·ªØ li·ªáu l·ªõn, th·ªùi gian kh√¥i ph·ª•c s·∫Ω r·∫•t l√¢u.</li><li>Khi l·ªánh <code>rm</code> x√≥a d·ªØ li·ªáu, s·ª≠ d·ª•ng sao l∆∞u l∆∞u tr·ªØ ·ªü trung t√¢m d·ªØ li·ªáu kh√°c ho·∫∑c t·ªët nh·∫•t l√† ·ªü th√†nh ph·ªë kh√°c.</li></ul></li></ul><h3 id="_29-su-khac-biet-giua-drop-truncate-va-delete" tabindex="-1"><a class="header-anchor" href="#_29-su-khac-biet-giua-drop-truncate-va-delete"><span>29. S·ª± kh√°c bi·ªát gi·ªØa <code>drop</code>, <code>truncate</code> v√† <code>delete</code></span></a></h3><ul><li>L·ªánh <code>DELETE</code> x√≥a t·ª´ng d√≤ng trong b·∫£ng v√† ghi l·∫°i thao t√°c x√≥a v√†o nh·∫≠t k√Ω ƒë·ªÉ c√≥ th·ªÉ rollback.</li><li>L·ªánh <code>TRUNCATE TABLE</code> x√≥a t·∫•t c·∫£ d·ªØ li·ªáu trong b·∫£ng m√† kh√¥ng ghi l·∫°i t·ª´ng thao t√°c x√≥a v√†o nh·∫≠t k√Ω, n√™n kh√¥ng th·ªÉ kh√¥i ph·ª•c. Qu√° tr√¨nh x√≥a kh√¥ng k√≠ch ho·∫°t trigger li√™n quan v√† th·ª±c thi nhanh ch√≥ng.</li><li>L·ªánh <code>drop</code> gi·∫£i ph√≥ng to√†n b·ªô kh√¥ng gian b·∫£ng.</li><li>V·ªÅ t·ªëc ƒë·ªô, <code>drop</code> &gt; <code>truncate</code> &gt; <code>delete</code>.</li><li>N·∫øu mu·ªën x√≥a m·ªôt ph·∫ßn d·ªØ li·ªáu, s·ª≠ d·ª•ng <code>delete</code> v·ªõi ƒëi·ªÅu ki·ªán <code>where</code> v√† ƒë·∫£m b·∫£o v√πng rollback ƒë·ªß l·ªõn.</li><li>N·∫øu mu·ªën x√≥a b·∫£ng, s·ª≠ d·ª•ng <code>drop</code>; n·∫øu mu·ªën gi·ªØ b·∫£ng nh∆∞ng x√≥a t·∫•t c·∫£ d·ªØ li·ªáu, s·ª≠ d·ª•ng <code>truncate</code> n·∫øu kh√¥ng li√™n quan ƒë·∫øn giao d·ªãch.</li><li>N·∫øu li√™n quan ƒë·∫øn giao d·ªãch ho·∫∑c c·∫ßn trigger, s·ª≠ d·ª•ng <code>delete</code>. N·∫øu c·∫ßn s·∫Øp x·∫øp l·∫°i c√°c ƒëo·∫°n tr·ªëng trong b·∫£ng, s·ª≠ d·ª•ng <code>truncate</code> v·ªõi <code>reuse storage</code>, sau ƒë√≥ nh·∫≠p l·∫°i d·ªØ li·ªáu.</li></ul><h3 id="_30-co-hai-lenh-kill-trong-mysql" tabindex="-1"><a class="header-anchor" href="#_30-co-hai-lenh-kill-trong-mysql"><span>30. C√≥ hai l·ªánh <code>kill</code> trong MySQL</span></a></h3><ul><li><code>kill query + id lu·ªìng</code>, ch·∫•m d·ª©t c√¢u l·ªánh ƒëang ch·∫°y trong lu·ªìng ƒë√≥.</li><li><code>kill connection + id lu·ªìng</code> (ho·∫∑c <code>kill + id lu·ªìng</code>), ng·∫Øt k·∫øt n·ªëi c·ªßa lu·ªìng ƒë√≥.</li></ul><p>L√Ω do l·ªánh <code>kill</code> kh√¥ng ho·∫°t ƒë·ªông:</p><ul><li>L·ªánh <code>kill</code> b·ªã ch·∫∑n v√† ch∆∞a ƒë·∫øn n∆°i.</li><li>L·ªánh <code>kill</code> ƒë√£ ƒë·∫øn n∆°i nh∆∞ng ch∆∞a ƒë∆∞·ª£c k√≠ch ho·∫°t ngay l·∫≠p t·ª©c.</li><li>L·ªánh <code>kill</code> ƒë√£ ƒë∆∞·ª£c k√≠ch ho·∫°t nh∆∞ng c·∫ßn th·ªùi gian ƒë·ªÉ ho√†n t·∫•t.</li></ul><h3 id="_31-hieu-nhu-the-nao-ve-viec-ƒëoc-va-gui-du-lieu-ƒëong-thoi-trong-mysql" tabindex="-1"><a class="header-anchor" href="#_31-hieu-nhu-the-nao-ve-viec-ƒëoc-va-gui-du-lieu-ƒëong-thoi-trong-mysql"><span>31. Hi·ªÉu nh∆∞ th·∫ø n√†o v·ªÅ vi·ªác ƒë·ªçc v√† g·ª≠i d·ªØ li·ªáu ƒë·ªìng th·ªùi trong MySQL</span></a></h3><ul><li>N·∫øu kh√°ch h√†ng nh·∫≠n d·ªØ li·ªáu ch·∫≠m, MySQL s·∫Ω g·∫∑p kh√≥ khƒÉn trong vi·ªác g·ª≠i k·∫øt qu·∫£, l√†m k√©o d√†i th·ªùi gian th·ª±c thi giao d·ªãch.</li><li>M√°y ch·ªß kh√¥ng c·∫ßn l∆∞u tr·ªØ to√†n b·ªô t·∫≠p k·∫øt qu·∫£, qu√° tr√¨nh l·∫•y v√† g·ª≠i d·ªØ li·ªáu ƒë∆∞·ª£c th·ª±c hi·ªán th√¥ng qua <code>next_buffer</code>.</li><li>C√°c trang d·ªØ li·ªáu trong b·ªô nh·ªõ ƒë∆∞·ª£c qu·∫£n l√Ω trong <code>Buffer_Pool</code>.</li><li>InnoDB qu·∫£n l√Ω <code>Buffer_Pool</code> b·∫±ng thu·∫≠t to√°n LRU c·∫£i ti·∫øn, s·ª≠ d·ª•ng danh s√°ch li√™n k·∫øt v√† chia t·ª∑ l·ªá 5:3 th√†nh c√°c khu v·ª±c <code>young</code> v√† <code>old</code>.</li></ul><h3 id="_32-tai-sao-truy-van-bang-lon-trong-mysql-khong-lam-ƒëay-bo-nho" tabindex="-1"><a class="header-anchor" href="#_32-tai-sao-truy-van-bang-lon-trong-mysql-khong-lam-ƒëay-bo-nho"><span>32. T·∫°i sao truy v·∫•n b·∫£ng l·ªõn trong MySQL kh√¥ng l√†m ƒë·∫ßy b·ªô nh·ªõ?</span></a></h3><ul><li>MySQL g·ª≠i d·ªØ li·ªáu ƒë·ªìng th·ªùi khi ƒë·ªçc, n√™n kh√¥ng c·∫ßn l∆∞u tr·ªØ to√†n b·ªô t·∫≠p k·∫øt qu·∫£ tr√™n m√°y ch·ªß. N·∫øu kh√°ch h√†ng nh·∫≠n d·ªØ li·ªáu ch·∫≠m, qu√° tr√¨nh truy v·∫•n MySQL s·∫Ω b·ªã ch·∫∑n nh∆∞ng kh√¥ng l√†m ƒë·∫ßy b·ªô nh·ªõ.</li><li>N·ªôi b·ªô InnoDB c√≥ chi·∫øn l∆∞·ª£c lo·∫°i b·ªè, qu·∫£n l√Ω <code>Buffer_Pool</code> b·∫±ng thu·∫≠t to√°n LRU c·∫£i ti·∫øn. InnoDB chia danh s√°ch li√™n k·∫øt LRU theo t·ª∑ l·ªá 5:3 th√†nh c√°c khu v·ª±c <code>young</code> v√† <code>old</code>. Vi·ªác qu√©t to√†n b·ªô d·ªØ li·ªáu l·∫°nh c≈©ng c√≥ th·ªÉ ƒë∆∞·ª£c ki·ªÉm so√°t.</li></ul><h3 id="_33-cach-su-dung-va-ƒëac-tinh-cua-bang-tam-thoi-trong-mysql" tabindex="-1"><a class="header-anchor" href="#_33-cach-su-dung-va-ƒëac-tinh-cua-bang-tam-thoi-trong-mysql"><span>33. C√°ch s·ª≠ d·ª•ng v√† ƒë·∫∑c t√≠nh c·ªßa b·∫£ng t·∫°m th·ªùi trong MySQL</span></a></h3><ul><li>Ch·ªâ hi·ªÉn th·ªã cho session hi·ªán t·∫°i.</li><li>C√≥ th·ªÉ tr√πng t√™n v·ªõi b·∫£ng th∆∞·ªùng.</li><li>S·ª≠ d·ª•ng ƒë·ªÉ th√™m, x√≥a, s·ª≠a, truy v·∫•n d·ªØ li·ªáu t·∫°m th·ªùi.</li><li><code>show tables</code> kh√¥ng hi·ªÉn th·ªã b·∫£ng t·∫°m th·ªùi.</li><li>Trong ·ª©ng d·ª•ng th·ª±c t·∫ø, b·∫£ng t·∫°m th·ªùi th∆∞·ªùng d√πng ƒë·ªÉ x·ª≠ l√Ω c√°c logic t√≠nh to√°n ph·ª©c t·∫°p.</li><li>V√¨ b·∫£ng t·∫°m th·ªùi ch·ªâ hi·ªÉn th·ªã cho t·ª´ng lu·ªìng ri√™ng l·∫ª, kh√¥ng c·∫ßn lo l·∫Øng v·ªÅ vi·ªác tr√πng t√™n khi nhi·ªÅu lu·ªìng th·ª±c thi c√πng m·ªôt x·ª≠ l√Ω. B·∫£ng t·∫°m th·ªùi s·∫Ω t·ª± ƒë·ªông x√≥a khi lu·ªìng k·∫øt th√∫c.</li></ul><h3 id="_34-gioi-thieu-cac-bo-may-luu-tru-mysql-innodb-myisam-memory" tabindex="-1"><a class="header-anchor" href="#_34-gioi-thieu-cac-bo-may-luu-tru-mysql-innodb-myisam-memory"><span>34. Gi·ªõi thi·ªáu c√°c b·ªô m√°y l∆∞u tr·ªØ MySQL (InnoDB, MyISAM, MEMORY)</span></a></h3><ul><li>InnoDB l√† b·ªô m√°y l∆∞u tr·ªØ ch√≠nh cho c∆° s·ªü d·ªØ li·ªáu giao d·ªãch, h·ªó tr·ª£ b·∫£ng an to√†n giao d·ªãch (ACID), kh√≥a d√≤ng v√† kh√≥a ngo·∫°i. T·ª´ MySQL 5.5.5 tr·ªü ƒëi, InnoDB l√† b·ªô m√°y l∆∞u tr·ªØ m·∫∑c ƒë·ªãnh.</li><li>MyISAM d·ª±a tr√™n ISAM v√† m·ªü r·ªông th√™m. ƒê√¢y l√† b·ªô m√°y l∆∞u tr·ªØ ph·ªï bi·∫øn trong c√°c ·ª©ng d·ª•ng web, l∆∞u tr·ªØ d·ªØ li·ªáu v√† c√°c m√¥i tr∆∞·ªùng kh√°c. MyISAM c√≥ t·ªëc ƒë·ªô ch√®n v√† truy v·∫•n cao nh∆∞ng kh√¥ng h·ªó tr·ª£ giao d·ªãch. Tr∆∞·ªõc phi√™n b·∫£n MySQL 5.5.5, MyISAM l√† b·ªô m√°y l∆∞u tr·ªØ m·∫∑c ƒë·ªãnh.</li><li>MEMORY l∆∞u tr·ªØ d·ªØ li·ªáu trong b·ªô nh·ªõ, cung c·∫•p truy c·∫≠p nhanh cho c√°c truy v·∫•n v√† tham chi·∫øu d·ªØ li·ªáu t·ª´ b·∫£ng kh√°c.</li></ul><h3 id="_35-innodb-tot-nhung-co-nen-su-dung-bo-may-memory-khong" tabindex="-1"><a class="header-anchor" href="#_35-innodb-tot-nhung-co-nen-su-dung-bo-may-memory-khong"><span>35. InnoDB t·ªët, nh∆∞ng c√≥ n√™n s·ª≠ d·ª•ng b·ªô m√°y MEMORY kh√¥ng?</span></a></h3><ul><li>B·∫£ng b·ªô nh·ªõ l√† b·∫£ng ƒë∆∞·ª£c t·∫°o b·∫±ng b·ªô m√°y MEMORY.</li><li>T√¥i kh√¥ng khuy·∫øn kh√≠ch s·ª≠ d·ª•ng b·∫£ng b·ªô nh·ªõ trong m√¥i tr∆∞·ªùng s·∫£n xu·∫•t v√¨ c√°c l√Ω do ch√≠nh sau: v·∫•n ƒë·ªÅ kh√≥a h·∫°t m·ªãn v√† v·∫•n ƒë·ªÅ l∆∞u tr·ªØ d·ªØ li·ªáu.</li><li>Do d·ªØ li·ªáu b·ªã m·∫•t khi kh·ªüi ƒë·ªông l·∫°i, n·∫øu m·ªôt m√°y sao l∆∞u kh·ªüi ƒë·ªông l·∫°i, n√≥ s·∫Ω d·ª´ng ƒë·ªìng b·ªô h√≥a t·ª´ m√°y ch·ªß ch√≠nh. N·∫øu c·∫•u h√¨nh master-master, d·ªØ li·ªáu b·∫£ng b·ªô nh·ªõ tr√™n m√°y ch·ªß ch√≠nh c≈©ng c√≥ th·ªÉ b·ªã x√≥a.</li></ul><h3 id="_36-lam-the-nao-ƒëe-khoi-phuc-du-lieu-khi-thao-tac-nham-tren-co-so-du-lieu" tabindex="-1"><a class="header-anchor" href="#_36-lam-the-nao-ƒëe-khoi-phuc-du-lieu-khi-thao-tac-nham-tren-co-so-du-lieu"><span>36. L√†m th·∫ø n√†o ƒë·ªÉ kh√¥i ph·ª•c d·ªØ li·ªáu khi thao t√°c nh·∫ßm tr√™n c∆° s·ªü d·ªØ li·ªáu?</span></a></h3><p>Khi x·∫£y ra thao t√°c nh·∫ßm, t√¨m ƒë·∫øn <code>binlog</code> g·∫ßn nh·∫•t v·ªõi th·ªùi ƒëi·ªÉm thao t√°c nh·∫ßm, ph√°t l·∫°i tr√™n c∆° s·ªü d·ªØ li·ªáu t·∫°m th·ªùi, sau ƒë√≥ ch·ªçn d·ªØ li·ªáu b·ªã x√≥a nh·∫ßm v√† kh√¥i ph·ª•c l·∫°i tr√™n c∆° s·ªü d·ªØ li·ªáu ch√≠nh.</p><h2 id="lien-quan-ƒëen-sao-luu-chinh-phu" tabindex="-1"><a class="header-anchor" href="#lien-quan-ƒëen-sao-luu-chinh-phu"><span>Li√™n quan ƒë·∫øn sao l∆∞u ch√≠nh ph·ª•</span></a></h2><h3 id="_37-mysql-ƒëam-bao-ƒëong-bo-chinh-phu-nhu-the-nao" tabindex="-1"><a class="header-anchor" href="#_37-mysql-ƒëam-bao-ƒëong-bo-chinh-phu-nhu-the-nao"><span>37. MySQL ƒë·∫£m b·∫£o ƒë·ªìng b·ªô ch√≠nh ph·ª• nh∆∞ th·∫ø n√†o?</span></a></h3><p>Thi·∫øt l·∫≠p quan h·ªá ch√≠nh ph·ª•:</p><ul><li>Ban ƒë·∫ßu, khi thi·∫øt l·∫≠p quan h·ªá ch√≠nh ph·ª•, l√† do ph·ª• ƒë·ªãnh tr∆∞·ªõc, v√≠ d·ª• d·ª±a tr√™n quan h·ªá ch√≠nh ph·ª• theo ƒëi·ªÉm v·ªã tr√≠, ph·ª• s·∫Ω n√≥i &quot;T√¥i mu·ªën ƒë·ªìng b·ªô t·ª´ v·ªã tr√≠ P c·ªßa t·ªáp binlog A&quot;, v√† ch√≠nh s·∫Ω b·∫Øt ƒë·∫ßu g·ª≠i t·ª´ v·ªã tr√≠ ƒë√≥.</li><li>Sau khi thi·∫øt l·∫≠p quan h·ªá ch√≠nh ph·ª•, ch√≠nh quy·∫øt ƒë·ªãnh g·ª≠i d·ªØ li·ªáu n√†o cho ph·ª•, do ƒë√≥, khi ch√≠nh c√≥ nh·∫≠t k√Ω m·ªõi s·∫Ω g·ª≠i cho ph·ª•.</li></ul><p>Quy tr√¨nh chuy·ªÉn ƒë·ªïi ch√≠nh ph·ª• trong MySQL:</p><ul><li>Kh√°ch h√†ng ƒë·ªçc v√† ghi ƒë·ªÅu tr·ª±c ti·∫øp truy c·∫≠p v√†o A, trong khi B l√† ph·ª•, ch·ªâ c·∫ßn ƒë·ªìng b·ªô h√≥a c√°c c·∫≠p nh·∫≠t c·ªßa A ƒë·∫øn B ƒë·ªÉ ƒë·∫£m b·∫£o d·ªØ li·ªáu l√† gi·ªëng nhau.</li><li>Khi c·∫ßn chuy·ªÉn ƒë·ªïi, ch·ªâ c·∫ßn ƒë·ªïi v·ªã tr√≠, t·ª©c l√† B tr·ªü th√†nh ch√≠nh v√† A tr·ªü th√†nh ph·ª•.</li></ul><p>Qu√° tr√¨nh ƒë·ªìng b·ªô h√≥a m·ªôt giao d·ªãch ho√†n ch·ªânh:</p><ul><li>Ph·ª• B v√† ch√≠nh A thi·∫øt l·∫≠p m·ªôt k·∫øt n·ªëi d√†i, trong A c√≥ m·ªôt lu·ªìng chuy√™n d·ª•ng ƒë·ªÉ duy tr√¨ k·∫øt n·ªëi d√†i n√†y.</li><li>Tr√™n ph·ª• B, s·ª≠ d·ª•ng l·ªánh <code>changemaster</code> ƒë·ªÉ thi·∫øt l·∫≠p ƒë·ªãa ch·ªâ IP, c·ªïng, t√™n ng∆∞·ªùi d√πng v√† m·∫≠t kh·∫©u c·ªßa ch√≠nh A c≈©ng nh∆∞ b·∫Øt ƒë·∫ßu y√™u c·∫ßu binlog t·ª´ v·ªã tr√≠ n√†o, bao g·ªìm t√™n t·ªáp v√† ƒë·ªô l·ªách nh·∫≠t k√Ω.</li><li>Tr√™n ph·ª• B, th·ª±c hi·ªán l·ªánh <code>start-slave</code>, ph·ª• s·∫Ω kh·ªüi ƒë·ªông hai lu·ªìng: <code>io_thread</code> v√† <code>sql_thread</code> ƒë·ªÉ thi·∫øt l·∫≠p k·∫øt n·ªëi v√† ƒë·ªçc, ph√¢n t√≠ch v√† th·ª±c thi nh·∫≠t k√Ω trung gian.</li><li>Ph·ª• ƒë·ªçc t·ªáp binlog m√† ch√≠nh ƒë√£ g·ª≠i v√† ghi l·∫°i v√†o nh·∫≠t k√Ω trung gian.</li><li>Sau n√†y, do gi·ªõi thi·ªáu c·ªßa ph∆∞∆°ng ph√°p sao ch√©p ƒëa lu·ªìng, <code>sql_thread</code> ƒë√£ ph√°t tri·ªÉn th√†nh nhi·ªÅu lu·ªìng.</li></ul><h3 id="_38-ƒëo-tre-chinh-phu-la-gi" tabindex="-1"><a class="header-anchor" href="#_38-ƒëo-tre-chinh-phu-la-gi"><span>38. ƒê·ªô tr·ªÖ ch√≠nh ph·ª• l√† g√¨?</span></a></h3><p>ƒê·ªô tr·ªÖ gi·ªØa ch√≠nh v√† ph·ª• khi th·ª±c hi·ªán c√πng m·ªôt giao d·ªãch x·∫£y ra do:</p><ul><li>Trong m·ªôt s·ªë ƒëi·ªÅu ki·ªán tri·ªÉn khai, hi·ªáu su·∫•t c·ªßa m√°y ph·ª• k√©m h∆°n so v·ªõi ch√≠nh.</li><li>√Åp l·ª±c l·ªõn tr√™n ph·ª•.</li><li>Giao d·ªãch l·ªõn, n·∫øu m·ªôt c√¢u l·ªánh tr√™n ch√≠nh m·∫•t 10 ph√∫t ƒë·ªÉ th·ª±c hi·ªán, th√¨ giao d·ªãch n√†y c√≥ th·ªÉ g√¢y ra ƒë·ªô tr·ªÖ 10 ph√∫t tr√™n ph·ª•.</li></ul><h3 id="_39-tai-sao-can-co-chien-luoc-sao-chep-ƒëa-luong" tabindex="-1"><a class="header-anchor" href="#_39-tai-sao-can-co-chien-luoc-sao-chep-ƒëa-luong"><span>39. T·∫°i sao c·∫ßn c√≥ chi·∫øn l∆∞·ª£c sao ch√©p ƒëa lu·ªìng?</span></a></h3><ul><li>V√¨ kh·∫£ nƒÉng sao ch√©p ƒë∆°n lu·ªìng ho√†n to√†n th·∫•p h∆°n so v·ªõi sao ch√©p ƒëa lu·ªìng, ƒë·ªëi v·ªõi ch√≠nh c√≥ √°p l·ª±c c·∫≠p nh·∫≠t l·ªõn, ph·ª• c√≥ th·ªÉ kh√¥ng bao gi·ªù theo k·ªãp ch√≠nh, d·∫´n ƒë·∫øn gi√° tr·ªã <code>seconds_behind_master</code> tr√™n ph·ª• ng√†y c√†ng l·ªõn.</li><li>Trong ·ª©ng d·ª•ng th·ª±c t·∫ø, n√™n s·ª≠ d·ª•ng chi·∫øn l∆∞·ª£c ∆∞u ti√™n ƒë·ªô tin c·∫≠y ƒë·ªÉ gi·∫£m ƒë·ªô tr·ªÖ ch√≠nh ph·ª•, tƒÉng t√≠nh kh·∫£ d·ª•ng c·ªßa h·ªá th·ªëng v√† gi·∫£m thi·ªÉu thao t√°c giao d·ªãch l·ªõn, chia nh·ªè giao d·ªãch l·ªõn th√†nh giao d·ªãch nh·ªè.</li></ul><h3 id="_40-cac-chien-luoc-song-song-cua-mysql-la-gi" tabindex="-1"><a class="header-anchor" href="#_40-cac-chien-luoc-song-song-cua-mysql-la-gi"><span>40. C√°c chi·∫øn l∆∞·ª£c song song c·ªßa MySQL l√† g√¨?</span></a></h3><ul><li>Chi·∫øn l∆∞·ª£c ph√¢n ph·ªëi theo b·∫£ng: N·∫øu hai giao d·ªãch c·∫≠p nh·∫≠t c√°c b·∫£ng kh√°c nhau, ch√∫ng c√≥ th·ªÉ song song. Do d·ªØ li·ªáu ƒë∆∞·ª£c l∆∞u tr·ªØ trong b·∫£ng, n√™n ph√¢n ph·ªëi theo b·∫£ng c√≥ th·ªÉ ƒë·∫£m b·∫£o hai worker kh√¥ng c·∫≠p nh·∫≠t c√πng m·ªôt d√≤ng. Nh∆∞·ª£c ƒëi·ªÉm: N·∫øu g·∫∑p b·∫£ng n√≥ng, t·ª©c l√† t·∫•t c·∫£ c√°c giao d·ªãch c·∫≠p nh·∫≠t ƒë·ªÅu li√™n quan ƒë·∫øn m·ªôt b·∫£ng, th√¨ t·∫•t c·∫£ c√°c giao d·ªãch s·∫Ω ƒë∆∞·ª£c ph√¢n b·ªï v√†o m·ªôt worker, tr·ªü th√†nh sao ch√©p ƒë∆°n lu·ªìng.</li><li>Chi·∫øn l∆∞·ª£c ph√¢n ph·ªëi theo d√≤ng: N·∫øu hai giao d·ªãch kh√¥ng c·∫≠p nh·∫≠t c√πng m·ªôt d√≤ng, ch√∫ng c√≥ th·ªÉ song song tr√™n ph·ª•. R√µ r√†ng, ch·∫ø ƒë·ªô n√†y y√™u c·∫ßu ƒë·ªãnh d·∫°ng binlog ph·∫£i l√† <code>row</code>. Nh∆∞·ª£c ƒëi·ªÉm: So v·ªõi chi·∫øn l∆∞·ª£c ph√¢n ph·ªëi song song theo b·∫£ng, chi·∫øn l∆∞·ª£c ph√¢n ph·ªëi song song theo d√≤ng c·∫ßn t·ªën nhi·ªÅu t√†i nguy√™n t√≠nh to√°n h∆°n khi quy·∫øt ƒë·ªãnh ph√¢n ph·ªëi lu·ªìng.</li></ul><h3 id="_41-su-khac-biet-giua-mot-chinh-mot-phu-va-mot-chinh-nhieu-phu-trong-mysql-la-gi" tabindex="-1"><a class="header-anchor" href="#_41-su-khac-biet-giua-mot-chinh-mot-phu-va-mot-chinh-nhieu-phu-trong-mysql-la-gi"><span>41. S·ª± kh√°c bi·ªát gi·ªØa m·ªôt ch√≠nh m·ªôt ph·ª• v√† m·ªôt ch√≠nh nhi·ªÅu ph·ª• trong MySQL l√† g√¨?</span></a></h3><p>Trong c·∫•u tr√∫c m·ªôt ch√≠nh m·ªôt ph·ª• c·ªßa m√¥ h√¨nh M k√©p, chuy·ªÉn ƒë·ªïi ch√≠nh ph·ª• ch·ªâ c·∫ßn chuy·ªÉn l∆∞u l∆∞·ª£ng kh√°ch h√†ng sang ph·ª•; trong khi trong c·∫•u tr√∫c m·ªôt ch√≠nh nhi·ªÅu ph·ª•, chuy·ªÉn ƒë·ªïi ch√≠nh ph·ª• kh√¥ng ch·ªâ c·∫ßn chuy·ªÉn l∆∞u l∆∞·ª£ng kh√°ch h√†ng sang ph·ª• m√† c√≤n c·∫ßn k·∫øt n·ªëi c√°c ph·ª• v·ªõi ch√≠nh m·ªõi.</p><h3 id="_42-lam-the-nao-ƒëe-giai-quyet-van-ƒëe-khi-chinh-gap-su-co" tabindex="-1"><a class="header-anchor" href="#_42-lam-the-nao-ƒëe-giai-quyet-van-ƒëe-khi-chinh-gap-su-co"><span>42. L√†m th·∫ø n√†o ƒë·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ khi ch√≠nh g·∫∑p s·ª± c·ªë?</span></a></h3><ul><li>Chuy·ªÉn ƒë·ªïi ch√≠nh ph·ª• d·ª±a tr√™n ƒëi·ªÉm v·ªã tr√≠: C√≥ v·∫•n ƒë·ªÅ t√¨m ƒëi·ªÉm ƒë·ªìng b·ªô h√≥a.</li><li>Phi√™n b·∫£n MySQL 5.6 ƒë√£ gi·ªõi thi·ªáu GTID, gi·∫£i quy·∫øt tri·ªát ƒë·ªÉ v·∫•n ƒë·ªÅ n√†y. GTID l√† g√¨ v√† l√†m th·∫ø n√†o ƒë·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ t√¨m ƒëi·ªÉm ƒë·ªìng b·ªô h√≥a?</li><li>GTID (Global Transaction ID): ID giao d·ªãch to√†n c·∫ßu, ƒë∆∞·ª£c t·∫°o ra khi giao d·ªãch ƒë∆∞·ª£c cam k·∫øt, l√† ƒë·ªãnh danh duy nh·∫•t c·ªßa giao d·ªãch n√†y; n√≥ bao g·ªìm hai ph·∫ßn, ƒë·ªãnh d·∫°ng l√†: GTID=server_uuid:gno.</li><li>M·ªói phi√™n b·∫£n MySQL duy tr√¨ m·ªôt t·∫≠p h·ª£p GTID ƒë·ªÉ t∆∞∆°ng ·ª©ng v·ªõi &quot;t·∫•t c·∫£ c√°c giao d·ªãch m√† phi√™n b·∫£n n√†y ƒë√£ th·ª±c hi·ªán&quot;.</li><li>Trong quan h·ªá ch√≠nh ph·ª• d·ª±a tr√™n GTID, h·ªá th·ªëng cho r·∫±ng ch·ªâ c·∫ßn thi·∫øt l·∫≠p quan h·ªá ch√≠nh ph·ª• th√¨ ph·∫£i ƒë·∫£m b·∫£o r·∫±ng nh·∫≠t k√Ω m√† ch√≠nh g·ª≠i cho ph·ª• l√† ƒë·∫ßy ƒë·ªß. Do ƒë√≥, n·∫øu ph·ª• B y√™u c·∫ßu nh·∫≠t k√Ω kh√¥ng c√≤n t·ªìn t·∫°i, A&#39; s·∫Ω t·ª´ ch·ªëi g·ª≠i nh·∫≠t k√Ω cho B.</li></ul><h3 id="_43-cac-giai-phap-cho-van-ƒëe-ƒëoc-qua-han-lien-quan-ƒëen-phan-tach-ƒëoc-ghi-trong-mysql-la-gi" tabindex="-1"><a class="header-anchor" href="#_43-cac-giai-phap-cho-van-ƒëe-ƒëoc-qua-han-lien-quan-ƒëen-phan-tach-ƒëoc-ghi-trong-mysql-la-gi"><span>43. C√°c gi·∫£i ph√°p cho v·∫•n ƒë·ªÅ ƒë·ªçc qu√° h·∫°n li√™n quan ƒë·∫øn ph√¢n t√°ch ƒë·ªçc ghi trong MySQL l√† g√¨?</span></a></h3><ul><li>Gi·∫£i ph√°p b·∫Øt bu·ªôc truy c·∫≠p ch√≠nh.</li><li>Gi·∫£i ph√°p s·ª≠ d·ª•ng <code>sleep</code>.</li><li>Gi·∫£i ph√°p x√°c ƒë·ªãnh kh√¥ng c√≥ ƒë·ªô tr·ªÖ ch√≠nh ph·ª•.</li><li>Gi·∫£i ph√°p k·∫øt h·ª£p semi-sync.</li><li>Gi·∫£i ph√°p ch·ªù ƒëi·ªÉm v·ªã tr√≠ c·ªßa ch√≠nh.</li><li>Gi·∫£i ph√°p GTID.</li><li>Trong s·∫£n xu·∫•t th·ª±c t·∫ø, ƒë·∫ßu ti√™n ph√¢n lo·∫°i y√™u c·∫ßu c·ªßa kh√°ch h√†ng, ph√¢n bi·ªát y√™u c·∫ßu n√†o c√≥ th·ªÉ ch·∫•p nh·∫≠n ƒë·ªçc qu√° h·∫°n v√† y√™u c·∫ßu n√†o kh√¥ng th·ªÉ ch·∫•p nh·∫≠n ƒë·ªçc qu√° h·∫°n; sau ƒë√≥, ƒë·ªëi v·ªõi c√°c c√¢u l·ªánh kh√¥ng th·ªÉ ch·∫•p nh·∫≠n ƒë·ªçc qu√° h·∫°n, s·ª≠ d·ª•ng gi·∫£i ph√°p ch·ªù GTID ho·∫∑c ch·ªù ƒëi·ªÉm v·ªã tr√≠.</li></ul><h3 id="_44-su-khac-biet-giua-ket-noi-ƒëong-thoi-va-truy-van-ƒëong-thoi-trong-mysql-la-gi" tabindex="-1"><a class="header-anchor" href="#_44-su-khac-biet-giua-ket-noi-ƒëong-thoi-va-truy-van-ƒëong-thoi-trong-mysql-la-gi"><span>44. S·ª± kh√°c bi·ªát gi·ªØa k·∫øt n·ªëi ƒë·ªìng th·ªùi v√† truy v·∫•n ƒë·ªìng th·ªùi trong MySQL l√† g√¨?</span></a></h3><ul><li>Trong k·∫øt qu·∫£ c·ªßa l·ªánh <code>show processlist</code>, nh√¨n th·∫•y h√†ng ng√†n k·∫øt n·ªëi, ƒë√≥ l√† k·∫øt n·ªëi ƒë·ªìng th·ªùi. C√≤n c√°c c√¢u l·ªánh &quot;ƒëang th·ª±c hi·ªán&quot; m·ªõi l√† truy v·∫•n ƒë·ªìng th·ªùi.</li><li>S·ªë l∆∞·ª£ng k·∫øt n·ªëi ƒë·ªìng th·ªùi l·ªõn ·∫£nh h∆∞·ªüng ƒë·∫øn b·ªô nh·ªõ, s·ªë l∆∞·ª£ng truy v·∫•n ƒë·ªìng th·ªùi cao ·∫£nh h∆∞·ªüng ƒë·∫øn CPU. M·ªôt m√°y t√≠nh c√≥ s·ªë l∆∞·ª£ng l√µi CPU h·∫°n ch·∫ø, n·∫øu t·∫•t c·∫£ c√°c lu·ªìng c√πng th·ª±c hi·ªán, chi ph√≠ chuy·ªÉn ƒë·ªïi ng·ªØ c·∫£nh s·∫Ω qu√° cao.</li><li>Do ƒë√≥, c·∫ßn thi·∫øt l·∫≠p tham s·ªë <code>innodb_thread_concurrency</code> ƒë·ªÉ gi·ªõi h·∫°n s·ªë l∆∞·ª£ng lu·ªìng. Khi s·ªë l∆∞·ª£ng lu·ªìng ƒë·∫°t ƒë·∫øn tham s·ªë n√†y, InnoDB s·∫Ω coi nh∆∞ s·ªë l∆∞·ª£ng lu·ªìng ƒë√£ d√πng h·∫øt v√† s·∫Ω ngƒÉn ch·∫∑n c√°c c√¢u l·ªánh kh√°c v√†o ƒë·ªông c∆° th·ª±c thi.</li></ul><h2 id="lien-quan-ƒëen-hieu-suat" tabindex="-1"><a class="header-anchor" href="#lien-quan-ƒëen-hieu-suat"><span>Li√™n quan ƒë·∫øn hi·ªáu su·∫•t</span></a></h2><h3 id="_45-cach-nang-cao-hieu-suat-mysql-trong-thoi-gian-ngan" tabindex="-1"><a class="header-anchor" href="#_45-cach-nang-cao-hieu-suat-mysql-trong-thoi-gian-ngan"><span>45. C√°ch n√¢ng cao hi·ªáu su·∫•t MySQL trong th·ªùi gian ng·∫Øn</span></a></h3><ul><li>Ph∆∞∆°ng ph√°p th·ª© nh·∫•t: X·ª≠ l√Ω c√°c k·∫øt n·ªëi ƒëang chi·∫øm gi·ªØ nh∆∞ng kh√¥ng ho·∫°t ƒë·ªông. Ho·∫∑c c√¢n nh·∫Øc ng·∫Øt k·∫øt n·ªëi trong giao d·ªãch ƒë√£ r·∫£nh r·ªói qu√° l√¢u. <code>kill connection + id</code>.</li><li>Ph∆∞∆°ng ph√°p th·ª© hai: Gi·∫£m thi·ªÉu chi ph√≠ c·ªßa qu√° tr√¨nh k·∫øt n·ªëi: V·∫•n ƒë·ªÅ hi·ªáu su·∫•t truy v·∫•n ch·∫≠m trong MySQL c√≥ th·ªÉ g√¢y ra c√°c v·∫•n ƒë·ªÅ v·ªÅ hi·ªáu su·∫•t, c√≥ ba kh·∫£ nƒÉng ch√≠nh: Thi·∫øt k·∫ø ch·ªâ m·ª•c kh√¥ng t·ªët; C√¢u l·ªánh SQL vi·∫øt kh√¥ng t·ªët; MySQL ch·ªçn sai ch·ªâ m·ª•c (d√πng <code>force index</code>).</li></ul><h3 id="_46-tai-sao-id-khoa-chinh-tu-tang-cua-mysql-khong-lien-tuc" tabindex="-1"><a class="header-anchor" href="#_46-tai-sao-id-khoa-chinh-tu-tang-cua-mysql-khong-lien-tuc"><span>46. T·∫°i sao ID kh√≥a ch√≠nh t·ª± tƒÉng c·ªßa MySQL kh√¥ng li√™n t·ª•c?</span></a></h3><ul><li><p>Xung ƒë·ªôt kh√≥a duy nh·∫•t.</p></li><li><p>Giao d·ªãch b·ªã quay lui.</p></li><li><p>Y√™u c·∫ßu tƒÉng s·ªë l∆∞·ª£ng kh√≥a ch√≠nh t·ª± tƒÉng.</p></li><li><p>Nguy√™n nh√¢n s√¢u xa l√† MySQL kh√¥ng ki·ªÉm tra s·ª± t·ªìn t·∫°i c·ªßa kh√≥a ch√≠nh t·ª± tƒÉng, nh·∫±m gi·∫£m ph·∫°m vi v√† m·ª©c ƒë·ªô kh√≥a, do ƒë√≥ c√≥ th·ªÉ duy tr√¨ hi·ªáu su·∫•t cao h∆°n, ƒë·∫£m b·∫£o kh√≥a ch√≠nh t·ª± tƒÉng kh√¥ng th·ªÉ quay lui, v√¨ v·∫≠y kh√≥a ch√≠nh t·ª± tƒÉng kh√¥ng li√™n t·ª•c.</p></li><li><p>L√†m th·∫ø n√†o ƒë·ªÉ kh√≥a ch√≠nh t·ª± tƒÉng ƒë·∫°t ƒë∆∞·ª£c t√≠nh duy nh·∫•t? Gi√° tr·ªã t·ª± tƒÉng th√™m 1 v√† ki·ªÉm so√°t ƒë·ªìng th·ªùi th√¥ng qua kh√≥a t·ª± tƒÉng.</p></li></ul><h3 id="_47-tai-sao-innodb-su-dung-id-tu-tang-lam-khoa-chinh" tabindex="-1"><a class="header-anchor" href="#_47-tai-sao-innodb-su-dung-id-tu-tang-lam-khoa-chinh"><span>47. T·∫°i sao InnoDB s·ª≠ d·ª•ng ID t·ª± tƒÉng l√†m kh√≥a ch√≠nh?</span></a></h3><ul><li><p>Ch·∫ø ƒë·ªô ch√®n kh√≥a ch√≠nh t·ª± tƒÉng ph√π h·ª£p v·ªõi ch√®n tƒÉng d·∫ßn, m·ªói l·∫ßn ƒë·ªÅu l√† thao t√°c b·ªï sung, kh√¥ng li√™n quan ƒë·∫øn di chuy·ªÉn b·∫£n ghi, c≈©ng kh√¥ng k√≠ch ho·∫°t ph√¢n chia n√∫t l√°.</p></li><li><p>M·ªói l·∫ßn ch√®n b·∫£n ghi m·ªõi s·∫Ω ƒë∆∞·ª£c th√™m tu·∫ßn t·ª± v√†o v·ªã tr√≠ ti·∫øp theo c·ªßa n√∫t ch·ªâ m·ª•c hi·ªán t·∫°i, khi m·ªôt trang ƒë∆∞·ª£c vi·∫øt ƒë·∫ßy, s·∫Ω t·ª± ƒë·ªông m·ªü ra m·ªôt trang m·ªõi.</p></li><li><p>Trong khi c√°c tr∆∞·ªùng c√≥ logic nghi·ªáp v·ª• l√†m kh√≥a ch√≠nh, kh√¥ng d·ªÖ ƒë·∫£m b·∫£o ch√®n theo th·ª© t·ª±, do m·ªói l·∫ßn ch√®n gi√° tr·ªã kh√≥a ch√≠nh g·∫ßn nh∆∞ ng·∫´u nhi√™n.</p></li><li><p>Do ƒë√≥, m·ªói b·∫£n ghi m·ªõi ƒë·ªÅu ph·∫£i ƒë∆∞·ª£c ch√®n v√†o m·ªôt v·ªã tr√≠ n√†o ƒë√≥ gi·ªØa c√°c trang ch·ªâ m·ª•c hi·ªán c√≥, vi·ªác di chuy·ªÉn v√† ph√¢n trang th∆∞·ªùng xuy√™n g√¢y ra nhi·ªÅu m·∫£nh v·ª•n, d·∫´n ƒë·∫øn c·∫•u tr√∫c ch·ªâ m·ª•c kh√¥ng ƒë·ªß ch·∫∑t ch·∫Ω, chi ph√≠ ghi d·ªØ li·ªáu cao.</p></li></ul><h3 id="_48-cach-sao-chep-mot-bang-nhanh-nhat" tabindex="-1"><a class="header-anchor" href="#_48-cach-sao-chep-mot-bang-nhanh-nhat"><span>48. C√°ch sao ch√©p m·ªôt b·∫£ng nhanh nh·∫•t?</span></a></h3><ul><li>ƒê·ªÉ tr√°nh kh√≥a ƒë·ªçc tr√™n b·∫£ng ngu·ªìn, ph∆∞∆°ng ph√°p an to√†n h∆°n l√† vi·∫øt d·ªØ li·ªáu ra t·ªáp vƒÉn b·∫£n b√™n ngo√†i, sau ƒë√≥ ghi l·∫°i v√†o b·∫£ng ƒë√≠ch.</li><li>M·ªôt c√°ch l√† s·ª≠ d·ª•ng l·ªánh <code>mysqldump</code> ƒë·ªÉ xu·∫•t d·ªØ li·ªáu th√†nh m·ªôt t·∫≠p h·ª£p c√°c c√¢u l·ªánh <code>INSERT</code>.</li><li>C√°ch kh√°c l√† xu·∫•t tr·ª±c ti·∫øp k·∫øt qu·∫£ th√†nh t·ªáp <code>.csv</code>. MySQL cung c·∫•p c√∫ ph√°p ƒë·ªÉ xu·∫•t k·∫øt qu·∫£ truy v·∫•n ra th∆∞ m·ª•c c·ª•c b·ªô c·ªßa m√°y ch·ªß: <code>select * from db1.t where a&gt;900 into outfile &#39;/server_tmp/t.csv&#39;</code>; sau khi c√≥ t·ªáp xu·∫•t <code>.csv</code>, b·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng l·ªánh <code>load data</code> sau ƒë√¢y ƒë·ªÉ nh·∫≠p d·ªØ li·ªáu v√†o b·∫£ng ƒë√≠ch <code>db2.t</code>: <code>load data infile &#39;/server_tmp/t.csv&#39; into table db2.t;</code>.</li><li>Sao ch√©p v·∫≠t l√Ω: Phi√™n b·∫£n MySQL 5.6 ƒë√£ gi·ªõi thi·ªáu ph∆∞∆°ng ph√°p kh√¥ng gian b·∫£ng c√≥ th·ªÉ truy·ªÅn t·∫£i (transportable tablespace), c√≥ th·ªÉ th·ª±c hi·ªán sao ch√©p v·∫≠t l√Ω b·∫£ng th√¥ng qua xu·∫•t v√† nh·∫≠p kh√¥ng gian b·∫£ng.</li></ul><h3 id="_49-lenh-grant-va-flush-privileges" tabindex="-1"><a class="header-anchor" href="#_49-lenh-grant-va-flush-privileges"><span>49. L·ªánh <code>grant</code> v√† <code>flush privileges</code></span></a></h3><ul><li>L·ªánh <code>grant</code> s·∫Ω ƒë·ªìng th·ªùi s·ª≠a ƒë·ªïi b·∫£ng d·ªØ li·ªáu v√† b·ªô nh·ªõ, vi·ªác x√°c ƒë·ªãnh quy·ªÅn s·ª≠ d·ª•ng d·ªØ li·ªáu trong b·ªô nh·ªõ, do ƒë√≥, s·ª≠ d·ª•ng ƒë√∫ng c√°ch kh√¥ng c·∫ßn th√™m l·ªánh <code>flush privileges</code>.</li><li>L·ªánh <code>flush privileges</code> s·∫Ω x√¢y d·ª±ng l·∫°i d·ªØ li·ªáu quy·ªÅn b·ªô nh·ªõ t·ª´ d·ªØ li·ªáu b·∫£ng, do ƒë√≥, ch·ªâ s·ª≠ d·ª•ng khi d·ªØ li·ªáu quy·ªÅn c√≥ th·ªÉ kh√¥ng nh·∫•t qu√°n.</li></ul><h3 id="_50-co-nen-su-dung-bang-phan-vung" tabindex="-1"><a class="header-anchor" href="#_50-co-nen-su-dung-bang-phan-vung"><span>50. C√≥ n√™n s·ª≠ d·ª•ng b·∫£ng ph√¢n v√πng?</span></a></h3><ul><li>Ph√¢n v√πng kh√¥ng ph·∫£i l√† c√†ng nh·ªè c√†ng t·ªët. Th·ª±c t·∫ø, b·∫£ng ƒë∆°n ho·∫∑c ph√¢n v√πng ƒë∆°n c√≥ d·ªØ li·ªáu 10 tri·ªáu d√≤ng, n·∫øu kh√¥ng c√≥ ch·ªâ m·ª•c qu√° l·ªõn, ƒë·ªëi v·ªõi kh·∫£ nƒÉng ph·∫ßn c·ª©ng hi·ªán t·∫°i, v·∫´n ƒë∆∞·ª£c coi l√† b·∫£ng nh·ªè.</li><li>C≈©ng kh√¥ng c·∫ßn d·ª± tr·ªØ qu√° nhi·ªÅu ph√¢n v√πng tr∆∞·ªõc, ch·ªâ c·∫ßn t·∫°o tr∆∞·ªõc khi s·ª≠ d·ª•ng. V√≠ d·ª•, n·∫øu ph√¢n v√πng theo th√°ng, v√†o cu·ªëi nƒÉm c√≥ th·ªÉ t·∫°o tr∆∞·ªõc 12 ph√¢n v√πng m·ªõi cho nƒÉm ti·∫øp theo. ƒê·ªëi v·ªõi c√°c ph√¢n v√πng l·ªãch s·ª≠ kh√¥ng c√≥ d·ªØ li·ªáu, c·∫ßn x√≥a b·ªè k·ªãp th·ªùi.</li></ul><h3 id="_51-cach-su-dung-join" tabindex="-1"><a class="header-anchor" href="#_51-cach-su-dung-join"><span>51. C√°ch s·ª≠ d·ª•ng <code>join</code></span></a></h3><ul><li>S·ª≠ d·ª•ng <code>left join</code>, b·∫£ng b√™n tr√°i kh√¥ng nh·∫•t thi·∫øt l√† b·∫£ng d·∫´n.</li><li>N·∫øu c·∫ßn ng·ªØ nghƒ©a <code>left join</code>, kh√¥ng n√™n ƒë·∫∑t c√°c tr∆∞·ªùng c·ªßa b·∫£ng d·∫´n v√†o ƒëi·ªÅu ki·ªán <code>where</code> ƒë·ªÉ th·ª±c hi·ªán so s√°nh b·∫±ng ho·∫∑c kh√¥ng b·∫±ng, m√† ph·∫£i vi·∫øt trong <code>on</code>.</li><li>C√¢u l·ªánh <code>group by</code> ti√™u chu·∫©n c·∫ßn c√≥ h√†m t·ªïng h·ª£p trong ph·∫ßn <code>select</code>, v√≠ d·ª•: <code>select a, count(*) from t group by a order by null;</code>.</li></ul><h3 id="_52-mysql-co-nhung-id-tu-tang-nao-cac-truong-hop-su-dung-cua-chung-la-gi" tabindex="-1"><a class="header-anchor" href="#_52-mysql-co-nhung-id-tu-tang-nao-cac-truong-hop-su-dung-cua-chung-la-gi"><span>52. MySQL c√≥ nh·ªØng ID t·ª± tƒÉng n√†o? C√°c tr∆∞·ªùng h·ª£p s·ª≠ d·ª•ng c·ªßa ch√∫ng l√† g√¨?</span></a></h3><ul><li><p>Khi ID t·ª± tƒÉng c·ªßa b·∫£ng ƒë·∫°t gi·ªõi h·∫°n, vi·ªác y√™u c·∫ßu gi√° tr·ªã s·∫Ω kh√¥ng thay ƒë·ªïi, d·∫´n ƒë·∫øn l·ªói xung ƒë·ªôt kh√≥a ch√≠nh khi ch√®n d·ªØ li·ªáu li√™n t·ª•c.</p></li><li><p>Khi <code>row_id</code> ƒë·∫°t gi·ªõi h·∫°n, s·∫Ω quay v·ªÅ 0 v√† tƒÉng l·∫°i, n·∫øu xu·∫•t hi·ªán <code>row_id</code> tr√πng l·∫∑p, d·ªØ li·ªáu ghi sau s·∫Ω ghi ƒë√® d·ªØ li·ªáu tr∆∞·ªõc ƒë√≥.</p></li><li><p><code>Xid</code> ch·ªâ c·∫ßn kh√¥ng xu·∫•t hi·ªán gi√° tr·ªã tr√πng l·∫∑p trong c√πng m·ªôt t·ªáp binlog l√† ƒë∆∞·ª£c, l√Ω thuy·∫øt c√≥ th·ªÉ xu·∫•t hi·ªán gi√° tr·ªã tr√πng l·∫∑p nh∆∞ng x√°c su·∫•t c·ª±c nh·ªè, c√≥ th·ªÉ b·ªè qua.</p></li><li><p>Gi√° tr·ªã tƒÉng c·ªßa <code>max_trx_id</code> trong InnoDB s·∫Ω ƒë∆∞·ª£c l∆∞u l·∫°i m·ªói l·∫ßn MySQL kh·ªüi ƒë·ªông l·∫°i.</p></li><li><p><code>Xid</code> ƒë∆∞·ª£c duy tr√¨ b·ªüi l·ªõp server. InnoDB s·ª≠ d·ª•ng <code>Xid</code> ƒë·ªÉ l√†m li√™n k·∫øt gi·ªØa giao d·ªãch InnoDB v√† server. Tuy nhi√™n, <code>trx_id</code> c·ªßa InnoDB l√† do InnoDB t·ª± duy tr√¨.</p></li><li><p><code>thread_id</code> l√† ID t·ª± tƒÉng ph·ªï bi·∫øn nh·∫•t trong qu√° tr√¨nh s·ª≠ d·ª•ng v√† c≈©ng ƒë∆∞·ª£c x·ª≠ l√Ω t·ªët nh·∫•t, s·ª≠ d·ª•ng thu·∫≠t to√°n <code>insert_unique</code>.</p></li></ul><h3 id="_53-xid-trong-mysql-ƒëuoc-tao-ra-nhu-the-nao" tabindex="-1"><a class="header-anchor" href="#_53-xid-trong-mysql-ƒëuoc-tao-ra-nhu-the-nao"><span>53. <code>Xid</code> trong MySQL ƒë∆∞·ª£c t·∫°o ra nh∆∞ th·∫ø n√†o?</span></a></h3><p><strong>MySQL n·ªôi b·ªô duy tr√¨ m·ªôt bi·∫øn to√†n c·ª•c <code>global_query_id</code>, m·ªói l·∫ßn th·ª±c hi·ªán c√¢u l·ªánh (bao g·ªìm c·∫£ c√¢u l·ªánh <code>select</code>) s·∫Ω g√°n gi√° tr·ªã c·ªßa n√≥ cho <code>Query_id</code>, sau ƒë√≥ tƒÉng bi·∫øn n√†y l√™n 1. N·∫øu c√¢u l·ªánh hi·ªán t·∫°i l√† c√¢u l·ªánh ƒë·∫ßu ti√™n c·ªßa giao d·ªãch, MySQL c≈©ng s·∫Ω g√°n gi√° tr·ªã <code>Query_id</code> cho <code>Xid</code> c·ªßa giao d·ªãch n√†y.</strong></p><p><code>global_query_id</code> l√† m·ªôt bi·∫øn trong b·ªô nh·ªõ, s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t l·∫°i v·ªÅ 0 khi kh·ªüi ƒë·ªông l·∫°i. Do ƒë√≥, trong c√πng m·ªôt phi√™n b·∫£n c∆° s·ªü d·ªØ li·ªáu, <code>Xid</code> c·ªßa c√°c giao d·ªãch kh√°c nhau c√≥ th·ªÉ tr√πng l·∫∑p. Tuy nhi√™n, MySQL s·∫Ω t·∫°o ra t·ªáp binlog m·ªõi khi kh·ªüi ƒë·ªông l·∫°i, ƒë·∫£m b·∫£o r·∫±ng trong c√πng m·ªôt t·ªáp binlog, <code>Xid</code> l√† duy nh·∫•t.</p><h2 id="lien-quan-ƒëen-khoa" tabindex="-1"><a class="header-anchor" href="#lien-quan-ƒëen-khoa"><span>Li√™n quan ƒë·∫øn kh√≥a</span></a></h2><h3 id="_54-noi-ve-khoa-cua-mysql" tabindex="-1"><a class="header-anchor" href="#_54-noi-ve-khoa-cua-mysql"><span>54. N√≥i v·ªÅ kh√≥a c·ªßa MySQL</span></a></h3><ul><li>MySQL s·ª≠ d·ª•ng nhi·ªÅu lo·∫°i kh√≥a ·ªü c·∫£ l·ªõp server v√† l·ªõp l∆∞u tr·ªØ.</li><li>L·ªõp server c·ªßa MySQL c·∫ßn nh·∫Øc ƒë·∫øn hai lo·∫°i kh√≥a: kh√≥a MDL (metadata lock) v√† kh√≥a b·∫£ng (Table Lock).</li><li>MDL c√≤n ƒë∆∞·ª£c g·ªçi l√† kh√≥a si√™u d·ªØ li·ªáu. Si√™u d·ªØ li·ªáu l√† b·∫•t k·ª≥ th√¥ng tin n√†o m√¥ t·∫£ c∆° s·ªü d·ªØ li·ªáu, ch·∫≥ng h·∫°n nh∆∞ c·∫•u tr√∫c b·∫£ng, c·∫•u tr√∫c c∆° s·ªü d·ªØ li·ªáu, v.v. T·∫°i sao c·∫ßn kh√≥a MDL?</li><li>Ch·ªß y·∫øu gi·∫£i quy·∫øt hai v·∫•n ƒë·ªÅ: v·∫•n ƒë·ªÅ c√°ch ly giao d·ªãch v√† v·∫•n ƒë·ªÅ sao ch√©p d·ªØ li·ªáu.</li><li>InnoDB c√≥ nƒÉm lo·∫°i kh√≥a b·∫£ng: IS (√Ω ƒë·ªãnh ƒë·ªçc), IX (√Ω ƒë·ªãnh vi·∫øt), S (ƒë·ªçc), X (vi·∫øt), AUTO-INC.</li><li>Khi th·ª±c hi·ªán c√°c l·ªánh select/insert/delete/update tr√™n b·∫£ng s·∫Ω kh√¥ng th√™m kh√≥a b·∫£ng.</li><li>IS v√† IX d√πng ƒë·ªÉ x√°c ƒë·ªãnh xem trong b·∫£ng c√≥ b·∫£n ghi n√†o ƒë√£ ƒë∆∞·ª£c kh√≥a hay kh√¥ng.</li><li>Kh√≥a t·ª± tƒÉng (AUTO-INC) ƒë·∫£m b·∫£o gi√° tr·ªã t·ª± tƒÉng c·ªßa kh√≥a ch√≠nh, ·ªü c·∫•p ƒë·ªô c√¢u l·ªánh: khi th√™m c·ªôt AUTO_INCREMENT v√†o b·∫£ng, m·ªói l·∫ßn ch√®n b·∫£n ghi, gi√° tr·ªã c·ªßa c·ªôt n√†y s·∫Ω t·ª± ƒë·ªông tƒÉng l√™n.</li><li>InnoDB c√≥ b·ªën lo·∫°i kh√≥a h√†ng: <ul><li>RecordLock: Kh√≥a b·∫£n ghi.</li><li>GapLock: Kh√≥a kho·∫£ng c√°ch ƒë·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ ƒë·ªçc ·∫£o; khi m·ªôt truy v·∫•n tr∆∞·ªõc ƒë√≥ kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu nh∆∞ng truy v·∫•n sau ƒë√≥ l·∫°i t√¨m th·∫•y, ƒëi·ªÅu n√†y x·∫£y ra do c√≥ giao d·ªãch B ch√®n d·ªØ li·ªáu gi·ªØa hai l·∫ßn truy v·∫•n c·ªßa giao d·ªãch A.</li><li>Next-KeyLock: Kh√≥a b·∫£n ghi hi·ªán t·∫°i v√† ngƒÉn ch·∫∑n giao d·ªãch kh√°c ch√®n b·∫£n ghi m·ªõi v√†o kho·∫£ng c√°ch tr∆∞·ªõc b·∫£n ghi n√†y.</li><li>InsertIntentionLock: Kh√≥a √Ω ƒë·ªãnh ch√®n; n·∫øu nhi·ªÅu giao d·ªãch ch√®n v√†o c√πng m·ªôt kho·∫£ng c√°ch m√† kh√¥ng c√πng v·ªã tr√≠, th√¨ kh√¥ng c·∫ßn ch·ªù ƒë·ª£i.</li></ul></li><li>L·ª±a ch·ªçn gi·ªØa kh√≥a h√†ng v√† kh√≥a b·∫£ng: <ul><li>S·ª≠ d·ª•ng kh√≥a h√†ng khi th·ª±c hi·ªán qu√©t to√†n b·ªô b·∫£ng.</li></ul></li></ul><h3 id="_55-the-nao-la-ƒëoc-ao-phantom-read" tabindex="-1"><a class="header-anchor" href="#_55-the-nao-la-ƒëoc-ao-phantom-read"><span>55. Th·∫ø n√†o l√† ƒë·ªçc ·∫£o (phantom read)?</span></a></h3><ul><li>ƒê·ªçc ·∫£o x·∫£y ra khi trong c√πng m·ªôt giao d·ªãch, c√≥ hai l·∫ßn truy v·∫•n c√πng m·ªôt ph·∫°m vi d·ªØ li·ªáu, nh∆∞ng l·∫ßn th·ª© hai th·∫•y d·ªØ li·ªáu m√† l·∫ßn ƒë·∫ßu kh√¥ng th·∫•y.</li></ul><p>C√°c t√¨nh hu·ªëng d·∫´n ƒë·∫øn ƒë·ªçc ·∫£o:</p><ul><li>M·ª©c c√°ch ly c·ªßa giao d·ªãch l√† ƒê·ªçc l·∫∑p l·∫°i (Repeatable Read), v√† l√† ƒë·ªçc hi·ªán t·∫°i (Read commited).</li><li>ƒê·ªçc ·∫£o ƒë·ªÅ c·∫≠p ƒë·∫øn c√°c h√†ng m·ªõi ƒë∆∞·ª£c ch√®n.</li></ul><p>V·∫•n ƒë·ªÅ do ƒë·ªçc ·∫£o g√¢y ra:</p><ul><li>Ph√° v·ª° ng·ªØ nghƒ©a kh√≥a h√†ng.</li><li>Ph√° v·ª° t√≠nh nh·∫•t qu√°n d·ªØ li·ªáu.</li></ul><p>Gi·∫£i ph√°p:</p><ul><li>Th√™m kh√≥a kho·∫£ng c√°ch ƒë·ªÉ kh√≥a kho·∫£ng c√°ch gi·ªØa c√°c h√†ng, ngƒÉn ch·∫∑n thao t√°c ch√®n m·ªõi.</li><li>V·∫•n ƒë·ªÅ do ƒë√≥ g√¢y ra: gi·∫£m ƒë·ªô ƒë·ªìng th·ªùi, c√≥ th·ªÉ d·∫´n ƒë·∫øn deadlock.</li></ul><h2 id="nhung-cau-hoi-khac" tabindex="-1"><a class="header-anchor" href="#nhung-cau-hoi-khac"><span>Nh·ªØng c√¢u h·ªèi kh√°c</span></a></h2><h3 id="_56-tai-sao-mysql-lai-thinh-thoang-cham-lai" tabindex="-1"><a class="header-anchor" href="#_56-tai-sao-mysql-lai-thinh-thoang-cham-lai"><span>56. T·∫°i sao MySQL l·∫°i th·ªânh tho·∫£ng ch·∫≠m l·∫°i?</span></a></h3><ul><li>C√°c trang b·∫©n (dirty page) s·∫Ω ƒë∆∞·ª£c flush t·ª± ƒë·ªông b·ªüi c√°c lu·ªìng n·ªÅn, ho·∫∑c do lo·∫°i b·ªè trang d·ªØ li·ªáu m√† g√¢y ra flush. Qu√° tr√¨nh flush trang b·∫©n s·ª≠ d·ª•ng t√†i nguy√™n, c√≥ th·ªÉ l√†m tƒÉng th·ªùi gian ph·∫£n h·ªìi c·ªßa c√°c l·ªánh c·∫≠p nh·∫≠t v√† truy v·∫•n.</li></ul><h3 id="_57-tai-sao-sau-khi-xoa-bang-kich-thuoc-tep-bang-van-khong-thay-ƒëoi" tabindex="-1"><a class="header-anchor" href="#_57-tai-sao-sau-khi-xoa-bang-kich-thuoc-tep-bang-van-khong-thay-ƒëoi"><span>57. T·∫°i sao sau khi x√≥a b·∫£ng, k√≠ch th∆∞·ªõc t·ªáp b·∫£ng v·∫´n kh√¥ng thay ƒë·ªïi?</span></a></h3><ul><li>Sau khi x√≥a d·ªØ li·ªáu, m·ªôt trang trong InnoDB c√≥ th·ªÉ ƒë∆∞·ª£c ƒë√°nh d·∫•u l√† c√≥ th·ªÉ s·ª≠ d·ª•ng l·∫°i.</li><li>L·ªánh delete x√≥a to√†n b·ªô d·ªØ li·ªáu trong b·∫£ng, k·∫øt qu·∫£ l√†, t·∫•t c·∫£ c√°c trang d·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c ƒë√°nh d·∫•u l√† c√≥ th·ªÉ s·ª≠ d·ª•ng l·∫°i. Nh∆∞ng tr√™n ƒëƒ©a, k√≠ch th∆∞·ªõc t·ªáp s·∫Ω kh√¥ng thay ƒë·ªïi.</li><li>C√°c b·∫£ng ƒë√£ tr·∫£i qua nhi·ªÅu l·∫ßn th√™m, x√≥a, s·ª≠a ƒë·ªïi c√≥ th·ªÉ c√≥ c√°c kho·∫£ng tr·ªëng. C√°c kho·∫£ng tr·ªëng n√†y c≈©ng chi·∫øm dung l∆∞·ª£ng, v√¨ v·∫≠y, n·∫øu c√≥ th·ªÉ lo·∫°i b·ªè c√°c kho·∫£ng tr·ªëng n√†y, ta c√≥ th·ªÉ gi·∫£m k√≠ch th∆∞·ªõc b·∫£ng.</li><li>Vi·ªác x√¢y d·ª±ng l·∫°i b·∫£ng c√≥ th·ªÉ ƒë·∫°t ƒë∆∞·ª£c m·ª•c ti√™u n√†y. C√≥ th·ªÉ s·ª≠ d·ª•ng l·ªánh <code>alter table A engine=InnoDB</code> ƒë·ªÉ x√¢y d·ª±ng l·∫°i b·∫£ng.</li></ul><h3 id="_58-cach-thuc-hien-count-va-so-sanh-cac-loai-count" tabindex="-1"><a class="header-anchor" href="#_58-cach-thuc-hien-count-va-so-sanh-cac-loai-count"><span>58. C√°ch th·ª±c hi·ªán <code>count(*)</code> v√† so s√°nh c√°c lo·∫°i count</span></a></h3><ul><li>ƒê·ªëi v·ªõi <code>count(id ch√≠nh)</code>, InnoDB s·∫Ω duy·ªát to√†n b·ªô b·∫£ng, l·∫•y ra gi√° tr·ªã id c·ªßa m·ªói h√†ng v√† tr·∫£ v·ªÅ cho l·ªõp server. L·ªõp server sau ƒë√≥ ki·ªÉm tra id v√† c·ªông d·ªìn.</li><li>ƒê·ªëi v·ªõi <code>count(1)</code>, InnoDB duy·ªát to√†n b·ªô b·∫£ng nh∆∞ng kh√¥ng l·∫•y gi√° tr·ªã. L·ªõp server nh·∫≠n m·ªói h√†ng v√† ch√®n m·ªôt s·ªë ‚Äú1‚Äù v√†o, ki·ªÉm tra kh√¥ng null v√† c·ªông d·ªìn. So v·ªõi <code>count(id ch√≠nh)</code>, <code>count(1)</code> nhanh h∆°n v√¨ kh√¥ng c·∫ßn l·∫•y v√† sao ch√©p gi√° tr·ªã tr∆∞·ªùng.</li><li>ƒê·ªëi v·ªõi <code>count(tr∆∞·ªùng)</code>, n·∫øu tr∆∞·ªùng ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a l√† not null, m·ªói h√†ng ƒë∆∞·ª£c ƒë·ªçc v√† ki·ªÉm tra kh√¥ng null r·ªìi c·ªông d·ªìn. N·∫øu tr∆∞·ªùng c√≥ th·ªÉ null, ph·∫£i l·∫•y gi√° tr·ªã ra ki·ªÉm tra tr∆∞·ªõc khi c·ªông d·ªìn.</li><li><code>count(*)</code> ƒë∆∞·ª£c t·ªëi ∆∞u h√≥a, kh√¥ng l·∫•y gi√° tr·ªã m√† ch·ªâ c·ªông d·ªìn.</li><li>K·∫øt lu·∫≠n: hi·ªáu su·∫•t t·ª´ th·∫•p ƒë·∫øn cao l√† <code>count(tr∆∞·ªùng) &lt; count(id ch√≠nh) &lt; count(1) ‚âà count(*)</code>, do ƒë√≥, n√™n s·ª≠ d·ª•ng <code>count(*)</code> khi c√≥ th·ªÉ.</li></ul><h3 id="_59-nguyen-ly-sap-xep-orderby" tabindex="-1"><a class="header-anchor" href="#_59-nguyen-ly-sap-xep-orderby"><span>59. Nguy√™n l√Ω s·∫Øp x·∫øp <code>orderby</code></span></a></h3><ul><li>MySQL s·∫Ω c·∫•p ph√°t m·ªôt b·ªô nh·ªõ (sort-buffer) cho m·ªói lu·ªìng ƒë·ªÉ s·∫Øp x·∫øp, k√≠ch th∆∞·ªõc l√† sort_buffer_size.</li><li>N·∫øu l∆∞·ª£ng d·ªØ li·ªáu s·∫Øp x·∫øp nh·ªè h∆°n sort_buffer_size, vi·ªác s·∫Øp x·∫øp s·∫Ω ho√†n th√†nh trong b·ªô nh·ªõ.</li><li>C√≥ hai lo·∫°i s·∫Øp x·∫øp n·ªôi b·ªô: <ul><li>S·∫Øp x·∫øp to√†n b·ªô tr∆∞·ªùng: t√¨m id ch√≠nh th·ªèa ƒëi·ªÅu ki·ªán trong c√¢y ch·ªâ m·ª•c, l·∫•y d·ªØ li·ªáu v√† ƒë·∫∑t v√†o sort_buffer, sau ƒë√≥ s·∫Øp x·∫øp.</li><li>S·∫Øp x·∫øp rowid: ki·ªÉm so√°t ƒë·ªô d√†i d·ªØ li·ªáu s·∫Øp x·∫øp ƒë·ªÉ t·ªëi ƒëa h√≥a s·ªë l∆∞·ª£ng d·ªØ li·ªáu trong sort_buffer.</li></ul></li><li>N·∫øu l∆∞·ª£ng d·ªØ li·ªáu l·ªõn, kh√¥ng ƒë·ªß b·ªô nh·ªõ, s·∫Ω s·ª≠ d·ª•ng t·ªáp t·∫°m th·ªùi tr√™n ƒëƒ©a ƒë·ªÉ h·ªó tr·ª£ s·∫Øp x·∫øp, g·ªçi l√† s·∫Øp x·∫øp b√™n ngo√†i.</li><li>S·∫Øp x·∫øp b√™n ngo√†i: MySQL s·∫Ω chia d·ªØ li·ªáu th√†nh nhi·ªÅu t·ªáp t·∫°m th·ªùi, m·ªói t·ªáp s·∫Øp x·∫øp ri√™ng r·ªìi h·ª£p nh·∫•t th√†nh m·ªôt t·ªáp l·ªõn.</li></ul><h3 id="_60-cach-su-dung-mysql-ƒëe-chon-ngau-nhien-mot-cach-hieu-qua" tabindex="-1"><a class="header-anchor" href="#_60-cach-su-dung-mysql-ƒëe-chon-ngau-nhien-mot-cach-hieu-qua"><span>60. C√°ch s·ª≠ d·ª•ng MySQL ƒë·ªÉ ch·ªçn ng·∫´u nhi√™n m·ªôt c√°ch hi·ªáu qu·∫£</span></a></h3><ul><li>L·∫•y ng·∫´u nhi√™n Y1, Y2, Y3, sau ƒë√≥ t√≠nh Ymax, Ymin.</li><li>Sau khi c√≥ id, t√≠nh to√°n Y1, Y2, Y3 t∆∞∆°ng ·ª©ng v·ªõi ba id, cu·ªëi c√πng <code>select * from t where id in (id1, id2, id3)</code>, s·ªë h√†ng ƒë∆∞·ª£c qu√©t l√† C + Ymax + 3.</li></ul><div class="language-mysql" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span>mysql&gt; select count(*) into @C from t;</span></span>
<span class="line"><span>set @Y1 = floor(@C * rand());</span></span>
<span class="line"><span>set @Y2 = floor(@C * rand());</span></span>
<span class="line"><span>set @Y3 = floor(@C * rand());</span></span>
<span class="line"><span>Ymax = max(Y1,Y2,Y3)</span></span>
<span class="line"><span>Ymin = min(Y1,Y2,Y3)</span></span>
<span class="line"><span>select id from t limit Ymin, (Ymax - Ymin)</span></span></code></pre></div></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/vanhung4499/my-wiki/edit/main/src/interview/knowledge/mysql/mysql-qa.md" aria-label="Edit this page on GitHub" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page on GitHub<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">Last update: </span><!----></div><div class="contributors"><span class="vp-meta-label">Contributors: </span><!--[--><!--[--><span class="vp-meta-info" title="email: vanhung4499@gmail.com">Hung Nguyen Van</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><!----><a class="route-link auto-link next" href="/interview/knowledge/mysql/mysql-index-qa.html" aria-label="MySQL Index Q&amp;A"><div class="hint">Next<span class="arrow end"></span></div><div class="link">MySQL Index Q&amp;A<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper" style="display:none;--1ea755b8:;"><div class="footer-content"><div class="footer">Made with ‚ù§Ô∏è by Hung Nguyen</div><div class="copyright">Copyright ¬© 2016-2024 Hung Nguyen</div></div><span id="runtime_span"></span></footer></div><!--]--><!--[--><!----><!----><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-CIGQMwlz.js" defer></script>
  </body>
</html>
