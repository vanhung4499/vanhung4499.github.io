<!doctype html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.12" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.46" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://vanhung4499.github.io/programming/java/Concurency/Java%20Concurrency%20Intro.html"><meta property="og:site_name" content="VanHung4499"><meta property="og:title" content="Java Concurrency Intro"><meta property="og:description" content="Giá»›i thiá»‡u vá» Concurrency trong Java Keyword: Process, Thread, Thread-Safe, Performance, Deadlock, Starvation, Context Switch TÃ³m táº¯t: Láº­p trÃ¬nh Ä‘a luá»“ng khÃ´ng chá»‰ riÃªng cá»§a ngÃ´..."><meta property="og:type" content="article"><meta property="og:image" content="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230715210906.png"><meta property="og:locale" content="en-US"><meta property="og:updated_time" content="2024-06-28T15:54:38.000Z"><meta property="article:author" content="Hung Nguyen"><meta property="article:tag" content="java"><meta property="article:tag" content="javase"><meta property="article:tag" content="concurrency"><meta property="article:modified_time" content="2024-06-28T15:54:38.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Java Concurrency Intro","image":["https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230715210906.png","https://raw.githubusercontent.com/dunwu/images/dev/snap/20201225170052.jpg"],"dateModified":"2024-06-28T15:54:38.000Z","author":[{"@type":"Person","name":"Hung Nguyen","url":"https://vanhung4499.github.io"}]}</script><meta name="referrer" content="no-referrer-when-downgrade"><link rel="alternate" type="application/rss+xml" href="https://vanhung4499.github.io/rss.xml" title="VanHung4499 RSS Feed"><title>Java Concurrency Intro | VanHung4499</title><meta name="description" content="Giá»›i thiá»‡u vá» Concurrency trong Java Keyword: Process, Thread, Thread-Safe, Performance, Deadlock, Starvation, Context Switch TÃ³m táº¯t: Láº­p trÃ¬nh Ä‘a luá»“ng khÃ´ng chá»‰ riÃªng cá»§a ngÃ´...">
    <link rel="preload" href="/assets/style-BqjKxtxe.css" as="style"><link rel="stylesheet" href="/assets/style-BqjKxtxe.css">
    <link rel="modulepreload" href="/assets/app-C7tm95bn.js"><link rel="modulepreload" href="/assets/Java Concurrency Intro.html-CxL_tNj_.js">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">Skip to main content</a><!--]--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo" src="/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">VanHung4499</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="Home"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:home" width="1em" height="1em"></iconify-icon><!--]-->Home<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/wiki.html" aria-label="Wiki"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="carbon:wikis" width="1em" height="1em"></iconify-icon><!--]-->Wiki<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/dsa/" aria-label="Algorithms"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="hugeicons:algorithm" width="1em" height="1em"></iconify-icon><!--]-->Algorithms<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Programming"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:code" width="1em" height="1em"></iconify-icon>Programming<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link route-link-active auto-link" href="/programming/java/" aria-label="Java"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:java" width="1em" height="1em"></iconify-icon><!--]-->Java<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/golang/" aria-label="Golang"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:go" width="1em" height="1em"></iconify-icon><!--]-->Golang<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/js/" aria-label="JavaScript"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:javascript" width="1em" height="1em"></iconify-icon><!--]-->JavaScript<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/ts/" aria-label="TypeScript"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:typescript" width="1em" height="1em"></iconify-icon><!--]-->TypeScript<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/python/" aria-label="Python"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:python" width="1em" height="1em"></iconify-icon><!--]-->Python<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Database"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:database" width="1em" height="1em"></iconify-icon>Database<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/sql/" aria-label="SQL"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:sql-query" width="1em" height="1em"></iconify-icon><!--]-->SQL<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/mysql/" aria-label="MySQL"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:mysql" width="1em" height="1em"></iconify-icon><!--]-->MySQL<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/mongodb/" aria-label="MongoDB"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:mongodb" width="1em" height="1em"></iconify-icon><!--]-->MongoDB<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/redis/" aria-label="Redis"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/elasticsearch/" aria-label="Elasticsearch"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:elasticsearch" width="1em" height="1em"></iconify-icon><!--]-->Elasticsearch<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/elastic/" aria-label="Elastic Stack"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="cib:elastic-stack" width="1em" height="1em"></iconify-icon><!--]-->Elastic Stack<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Framework"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="simple-icons:framework" width="1em" height="1em"></iconify-icon>Framework<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/spring/" aria-label="Spring"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->Spring<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/spring-boot/" aria-label="Spring Boot"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->Spring Boot<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/nestjs/" aria-label="NestJS"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:nestjs" width="1em" height="1em"></iconify-icon><!--]-->NestJS<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/gin/" aria-label="Gin"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="logos:gin" width="1em" height="1em"></iconify-icon><!--]-->Gin<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="DevOps"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon-plain:azuredevops" width="1em" height="1em"></iconify-icon>DevOps<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/docker/" aria-label="Docker"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:docker" width="1em" height="1em"></iconify-icon><!--]-->Docker<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/kubernetes/" aria-label="Kubernetes"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:kubernetes" width="1em" height="1em"></iconify-icon><!--]-->Kubernetes<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/jenkins/" aria-label="Jenkins"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:jenkins" width="1em" height="1em"></iconify-icon><!--]-->Jenkins<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/git/" aria-label="Git"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:git" width="1em" height="1em"></iconify-icon><!--]-->Git<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/linux/" aria-label="Linux"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:linux" width="1em" height="1em"></iconify-icon><!--]-->Linux<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Design"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="tdesign:system-sum" width="1em" height="1em"></iconify-icon>Design<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/design/design-pattern/" aria-label="Design Pattern"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="tabler:grid-pattern" width="1em" height="1em"></iconify-icon><!--]-->Design Pattern<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/design/system-design/" aria-label="System Design"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="icon-park-outline:system" width="1em" height="1em"></iconify-icon><!--]-->System Design<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/project/" aria-label="Project"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="ant-design:project-outlined" width="1em" height="1em"></iconify-icon><!--]-->Project<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/interview/" aria-label="Interview"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:account-tie" width="1em" height="1em"></iconify-icon><!--]-->Interview<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="About"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:about" width="1em" height="1em"></iconify-icon>About<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/about-me.html" aria-label="About me"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="cib:about-me" width="1em" height="1em"></iconify-icon><!--]-->About me<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/about.html" aria-label="About"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:about" width="1em" height="1em"></iconify-icon><!--]-->About<!----></a></li></ul></button></div></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/vanhung4499/my-wiki" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><!--[--><button type="button" class="search-pro-button" aria-label="Search"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon" name="search"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">Search</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/programming/java/" aria-label="Java"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:java" width="1em" height="1em"></iconify-icon><!--]-->Java<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Basic</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Array</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">String</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">OOP</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Extra</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Collection</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Exception</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Advanced</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">IO</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">New Features</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">Concurrency</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/programming/java/Concurency/Java%20Atomic%20Class.html" aria-label="Java Atomic Class"><!---->Java Atomic Class<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/programming/java/Concurency/Java%20Concurent%20Tools.html" aria-label="Java Concurent Tools"><!---->Java Concurent Tools<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/programming/java/Concurency/Java%20Concurrency%20Core%20Mechanism.html" aria-label="Java Concurrency Core Mechanism"><!---->Java Concurrency Core Mechanism<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link vp-sidebar-page active" href="/programming/java/Concurency/Java%20Concurrency%20Intro.html" aria-label="Java Concurrency Intro"><!---->Java Concurrency Intro<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/programming/java/Concurency/Java%20Concurrent%20Collection.html" aria-label="Java Concurrent Collection"><!---->Java Concurrent Collection<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/programming/java/Concurency/Java%20ForkJoin.html" aria-label="Java ForkJoin"><!---->Java ForkJoin<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/programming/java/Concurency/Java%20Lock.html" aria-label="Java Lock"><!---->Java Lock<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/programming/java/Concurency/Java%20Memory%20Model.html" aria-label="Java Memory Model"><!---->Java Memory Model<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/programming/java/Concurency/Java%20Thread%20Basic.html" aria-label="Java Thread Basic"><!---->Java Thread Basic<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/programming/java/Concurency/Java%20Thread%20Pool.html" aria-label="Java Thread Pool"><!---->Java Thread Pool<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">JVM</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Common Tool</span><span class="vp-arrow end"></span></button><!----></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->Java Concurrency Intro</h1><div class="page-info"><span class="page-author-info" aria-label="AuthorğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://vanhung4499.github.io" target="_blank" rel="noopener noreferrer">Hung Nguyen</a></span><span property="author" content="Hung Nguyen"></span></span><!----><span class="page-date-info" aria-label="Writing DateğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-06-28T15:54:38.000Z"></span><!----><span class="page-reading-time-info" aria-label="Reading TimeâŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 31 min</span><meta property="timeRequired" content="PT31M"></span><span class="page-category-info" aria-label="CategoryğŸŒˆ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color8 clickable" role="navigation">java</span><span class="page-category-item color1 clickable" role="navigation">javase</span><span class="page-category-item color5 clickable" role="navigation">concurrency</span><!--]--><meta property="articleSection" content="java,javase,concurrency"></span><span class="page-tag-info" aria-label="TagğŸ·" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color8 clickable" role="navigation">java</span><span class="page-tag-item color1 clickable" role="navigation">javase</span><span class="page-tag-item color5 clickable" role="navigation">concurrency</span><!--]--><meta property="keywords" content="java,javase,concurrency"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">On This Page<button type="button" class="print-button" title="Print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#khai-niem-ve-Ä‘a-luong">KhÃ¡i niá»‡m vá» Äa luá»“ng</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Ä‘a-luong-va-song-song">Äa luá»“ng vÃ  Song song</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Ä‘ong-bo-va-bat-Ä‘ong-bo">Äá»“ng bá»™ vÃ  Báº¥t Ä‘á»“ng bá»™</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#chan-va-khong-chan">Cháº·n vÃ  KhÃ´ng cháº·n</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#tien-trinh-va-luong">Tiáº¿n trÃ¬nh vÃ  Luá»“ng</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Ä‘ieu-kien-canh-tranh-va-vung-quan-trong">Äiá»u kiá»‡n cáº¡nh tranh vÃ  VÃ¹ng quan trá»ng</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#giam-sat">GiÃ¡m sÃ¡t</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#Ä‘ac-Ä‘iem-cua-Ä‘a-luong">Äáº·c Ä‘iá»ƒm cá»§a Ä‘a luá»“ng</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#tang-cuong-su-dung-tai-nguyen">TÄƒng cÆ°á»ng sá»­ dá»¥ng tÃ i nguyÃªn</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#tang-toc-Ä‘o-phan-hoi-cua-chuong-trinh">TÄƒng tá»‘c Ä‘á»™ pháº£n há»“i cá»§a chÆ°Æ¡ng trÃ¬nh</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#van-Ä‘e-cua-Ä‘a-luong">Váº¥n Ä‘á» cá»§a Ä‘a luá»“ng</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#van-Ä‘e-an-toan">Váº¥n Ä‘á» an toÃ n</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#van-Ä‘e-cua-bo-nho-Ä‘em-va-tinh-nhin-thay">Váº¥n Ä‘á» cá»§a bá»™ nhá»› Ä‘á»‡m vÃ  tÃ­nh nhÃ¬n tháº¥y</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#van-Ä‘e-ve-tinh-nguyen-tu-do-chuyen-Ä‘oi-luong">Váº¥n Ä‘á» vá» tÃ­nh nguyÃªn tá»­ do chuyá»ƒn Ä‘á»•i luá»“ng</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#van-Ä‘e-ve-thu-tu-do-toi-uu-hoa-bien-dich">Váº¥n Ä‘á» vá» thá»© tá»± do tá»‘i Æ°u hÃ³a biÃªn dá»‹ch</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#cac-phuong-phap-Ä‘am-bao-an-toan-Ä‘ong-thoi">CÃ¡c phÆ°Æ¡ng phÃ¡p Ä‘áº£m báº£o an toÃ n Ä‘á»“ng thá»i</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#van-Ä‘e-ve-tinh-hoat-Ä‘ong">Váº¥n Ä‘á» vá» tÃ­nh hoáº¡t Ä‘á»™ng</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#deadlock">Deadlock</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#livelock">Livelock</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Ä‘oi-starvation">ÄÃ³i (Starvation)</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#van-Ä‘e-ve-hieu-suat">Váº¥n Ä‘á» vá» hiá»‡u suáº¥t</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#chuyen-Ä‘oi-ngu-canh-context-switching">Chuyá»ƒn Ä‘á»•i ngá»¯ cáº£nh (Context Switching)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#han-che-tai-nguyen">Háº¡n cháº¿ tÃ i nguyÃªn</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#tom-tat">TÃ³m táº¯t</a></li><!----><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h1 id="gioi-thieu-ve-concurrency-trong-java" tabindex="-1"><a class="header-anchor" href="#gioi-thieu-ve-concurrency-trong-java"><span>Giá»›i thiá»‡u vá» Concurrency trong Java</span></a></h1><blockquote><p><strong>Keyword</strong>: <code>Process</code>, <code>Thread</code>, <code>Thread-Safe</code>, <code>Performance</code>, <code>Deadlock</code>, <code>Starvation</code>, <code>Context Switch</code></p><p><strong>TÃ³m táº¯t</strong>: Láº­p trÃ¬nh Ä‘a luá»“ng khÃ´ng chá»‰ riÃªng cá»§a ngÃ´n ngá»¯ Java,mÃ  lÃ  má»™t mÃ´ hÃ¬nh láº­p trÃ¬nh Ä‘Ã£ Ä‘Æ°á»£c phÃ¡t triá»ƒn. Java chá»‰ thá»±c hiá»‡n mÃ´ hÃ¬nh cÃ´ng viá»‡c Ä‘a luá»“ng theo cÃ¡ch riÃªng cá»§a nÃ³. Äá»ƒ há»c láº­p trÃ¬nh Ä‘a luá»“ng trong Java, báº¡n nÃªn hiá»ƒu cÃ¡c khÃ¡i niá»‡m cÆ¡ báº£n vá» Ä‘a luá»“ng vÃ  sau Ä‘Ã³ tÃ¬m hiá»ƒu sÃ¢u hÆ¡n vá» cÃ¡c tÃ­nh cháº¥t vÃ  nhá»¯ng váº¥n Ä‘á» liÃªn quan khi lÃ m viá»‡c vá»›i Ä‘a luá»“ng. Khi báº¡n hiá»ƒu Ä‘Æ°á»£c nhá»¯ng Ä‘iá»u nÃ y, báº¡n sáº½ hiá»ƒu táº¡i sao cÃ¡c cÃ´ng cá»¥ Ä‘a luá»“ng trong Java Ä‘Æ°á»£c thiáº¿t káº¿ nhÆ° tháº¿ nÃ o vÃ  giáº£i quyáº¿t váº¥n Ä‘á» gÃ¬. Báº±ng cÃ¡ch há»c tá»«ng pháº§n nhÆ° váº­y, báº¡n sáº½ dá»… dÃ ng náº¯m vá»¯ng kiáº¿n thá»©c vá» Ä‘a luá»“ng vÃ  xÃ¢y dá»±ng má»™t há»‡ thá»‘ng kiáº¿n thá»©c vá»¯ng cháº¯c.</p></blockquote><h2 id="khai-niem-ve-Ä‘a-luong" tabindex="-1"><a class="header-anchor" href="#khai-niem-ve-Ä‘a-luong"><span>KhÃ¡i niá»‡m vá» Äa luá»“ng</span></a></h2><p>Láº­p trÃ¬nh Ä‘a luá»“ng (Multi-Threading) cÃ³ nhiá»u thuáº­t ngá»¯ vÃ  khÃ¡i niá»‡m tÆ°Æ¡ng tá»±, dá»… gÃ¢y nháº§m láº«n. Pháº§n nÃ y sáº½ giÃºp báº¡n hiá»ƒu rÃµ cÃ¡c khÃ¡i niá»‡m vÃ  sá»± khÃ¡c biá»‡t giá»¯a chÃºng.</p><h3 id="Ä‘a-luong-va-song-song" tabindex="-1"><a class="header-anchor" href="#Ä‘a-luong-va-song-song"><span>Äa luá»“ng vÃ  Song song</span></a></h3><p>Äa luá»“ng (Multi-Threading) vÃ  song song (Parallel) lÃ  hai khÃ¡i niá»‡m dá»… gÃ¢y nháº§m láº«n nháº¥t, váº­y lÃ m sao Ä‘á»ƒ hiá»ƒu Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a chÃºng? Sá»± khÃ¡c biá»‡t quan trá»ng nháº¥t náº±m á»Ÿ viá»‡c liá»‡u chÃºng cÃ³ diá»…n ra <strong>Ä‘á»“ng thá»i</strong> hay khÃ´ng:</p><ul><li><strong>Äa luá»“ng</strong>: Äa luá»“ng lÃ  kháº£ nÄƒng xá»­ lÃ½ nhiá»u tÃ¡c vá»¥ cÃ¹ng má»™t lÃºc, nhÆ°ng khÃ´ng nháº¥t thiáº¿t pháº£i diá»…n ra Ä‘á»“ng thá»i.</li><li><strong>Song song</strong>: Song song lÃ  kháº£ nÄƒng xá»­ lÃ½ nhiá»u tÃ¡c vá»¥ cÃ¹ng má»™t lÃºc.</li></ul><p>DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ thá»±c táº¿ giÃºp báº¡n hiá»ƒu rÃµ hÆ¡n:</p><ul><li>Báº¡n Ä‘ang Äƒn cÆ¡m, Ä‘iá»‡n thoáº¡i reo, báº¡n chá»‰ ngá»«ng Äƒn sau khi Äƒn xong má»›i nháº­n cuá»™c gá»i, Ä‘iá»u nÃ y cho tháº¥y báº¡n khÃ´ng há»— trá»£ Ä‘a luá»“ng cÅ©ng khÃ´ng há»— trá»£ song song.</li><li>Báº¡n Ä‘ang Äƒn cÆ¡m, Ä‘iá»‡n thoáº¡i reo, báº¡n ngá»«ng Äƒn Ä‘á»ƒ nháº­n cuá»™c gá»i, sau khi nháº­n xong báº¡n tiáº¿p tá»¥c Äƒn cÆ¡m, Ä‘iá»u nÃ y cho tháº¥y báº¡n há»— trá»£ Ä‘a luá»“ng.</li><li>Báº¡n Ä‘ang Äƒn cÆ¡m, Ä‘iá»‡n thoáº¡i reo, báº¡n vá»«a nghe Ä‘iá»‡n thoáº¡i vá»«a Äƒn cÆ¡m, Ä‘iá»u nÃ y cho tháº¥y báº¡n há»— trá»£ song song.</li></ul><h3 id="Ä‘ong-bo-va-bat-Ä‘ong-bo" tabindex="-1"><a class="header-anchor" href="#Ä‘ong-bo-va-bat-Ä‘ong-bo"><span>Äá»“ng bá»™ vÃ  Báº¥t Ä‘á»“ng bá»™</span></a></h3><ul><li><strong>Äá»“ng bá»™ (synchronous)</strong>: Äá»“ng bá»™ lÃ  khi gá»­i má»™t cuá»™c gá»i vÃ  chÆ°a nháº­n Ä‘Æ°á»£c káº¿t quáº£, cuá»™c gá»i sáº½ khÃ´ng tráº£ vá» cho Ä‘áº¿n khi nháº­n Ä‘Æ°á»£c káº¿t quáº£. NhÆ°ng má»™t khi cuá»™c gá»i tráº£ vá», báº¡n Ä‘Ã£ nháº­n Ä‘Æ°á»£c káº¿t quáº£.</li><li><strong>Báº¥t Ä‘á»“ng bá»™ (asynchronous)</strong>: NgÆ°á»£c láº¡i, báº¥t Ä‘á»“ng bá»™ lÃ  khi gá»­i má»™t cuá»™c gá»i vÃ  khÃ´ng chá» káº¿t quáº£. Thay vÃ o Ä‘Ã³, cuá»™c gá»i sáº½ tráº£ vá» ngay láº­p tá»©c mÃ  khÃ´ng cÃ³ káº¿t quáº£. NÃ³i cÃ¡ch khÃ¡c, sau khi gá»­i má»™t cuá»™c gá»i báº¥t Ä‘á»“ng bá»™, ngÆ°á»i gá»i khÃ´ng nháº­n Ä‘Æ°á»£c káº¿t quáº£ ngay láº­p tá»©c. Thay vÃ o Ä‘Ã³, ngÆ°á»i Ä‘Æ°á»£c gá»i sáº½ thÃ´ng bÃ¡o cho ngÆ°á»i gá»i thÃ´ng qua tráº¡ng thÃ¡i hoáº·c thÃ´ng bÃ¡o.</li></ul><p>DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ Ä‘á»ƒ minh há»a:</p><ul><li>Cuá»™c gá»i Ä‘á»“ng bá»™ giá»‘ng nhÆ° viá»‡c gá»i Ä‘iá»‡n thoáº¡i: Náº¿u khÃ´ng cÃºp mÃ¡y, cuá»™c gá»i sáº½ khÃ´ng káº¿t thÃºc.</li><li>Cuá»™c gá»i báº¥t Ä‘á»“ng bá»™ giá»‘ng nhÆ° viá»‡c gá»­i tin nháº¯n: Sau khi gá»­i tin nháº¯n, báº¡n cÃ³ thá»ƒ lÃ m viá»‡c khÃ¡c; khi nháº­n Ä‘Æ°á»£c tin nháº¯n tráº£ lá»i, Ä‘iá»‡n thoáº¡i sáº½ thÃ´ng bÃ¡o cho báº¡n báº±ng cÃ¡ch rung hoáº·c kÃªu.</li></ul><h3 id="chan-va-khong-chan" tabindex="-1"><a class="header-anchor" href="#chan-va-khong-chan"><span>Cháº·n vÃ  KhÃ´ng cháº·n</span></a></h3><p>Cháº·n vÃ  khÃ´ng cháº·n liÃªn quan Ä‘áº¿n tráº¡ng thÃ¡i cá»§a chÆ°Æ¡ng trÃ¬nh khi chá» káº¿t quáº£ (tin nháº¯n, giÃ¡ trá»‹ tráº£ vá»):</p><ul><li><strong>Cháº·n (Blocking)</strong>: Khi chá» káº¿t quáº£ tráº£ vá», luá»“ng hiá»‡n táº¡i sáº½ bá»‹ treo. Luá»“ng gá»i chá»‰ trá»Ÿ láº¡i sau khi nháº­n Ä‘Æ°á»£c káº¿t quáº£.</li><li><strong>KhÃ´ng cháº·n (Non-Blocking)</strong>: NgÆ°á»£c láº¡i, khÃ´ng cháº·n cÃ³ nghÄ©a lÃ  khi chá» káº¿t quáº£, luá»“ng hiá»‡n táº¡i khÃ´ng bá»‹ treo. NÃ³ sáº½ tiáº¿p tá»¥c thá»±c hiá»‡n cÃ¡c cÃ´ng viá»‡c khÃ¡c trong khi chá» káº¿t quáº£.</li></ul><p>DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ Ä‘á»ƒ minh há»a:</p><ul><li>Cuá»™c gá»i cháº·n giá»‘ng nhÆ° viá»‡c gá»i Ä‘iá»‡n thoáº¡i: Cuá»™c gá»i chá»‰ káº¿t thÃºc khi báº¡n nháº­n Ä‘Æ°á»£c káº¿t quáº£.</li><li>Cuá»™c gá»i khÃ´ng cháº·n giá»‘ng nhÆ° viá»‡c gá»­i tin nháº¯n: Sau khi gá»­i tin nháº¯n, báº¡n cÃ³ thá»ƒ lÃ m viá»‡c khÃ¡c trong khi chá» tin nháº¯n tráº£ lá»i.</li></ul><h3 id="tien-trinh-va-luong" tabindex="-1"><a class="header-anchor" href="#tien-trinh-va-luong"><span>Tiáº¿n trÃ¬nh vÃ  Luá»“ng</span></a></h3><ul><li><strong>Tiáº¿n trÃ¬nh (Process)</strong>: Tiáº¿n trÃ¬nh lÃ  má»™t hoáº¡t Ä‘á»™ng cháº¡y Ä‘á»™c láº­p vá»›i má»™t táº­p há»£p cÃ¡c tÃ i nguyÃªn. Tiáº¿n trÃ¬nh lÃ  Ä‘Æ¡n vá»‹ cÆ¡ báº£n Ä‘á»ƒ phÃ¢n chia vÃ  quáº£n lÃ½ tÃ i nguyÃªn trong há»‡ Ä‘iá»u hÃ nh. Má»™t tiáº¿n trÃ¬nh cÃ³ thá»ƒ Ä‘Æ°á»£c coi nhÆ° má»™t chÆ°Æ¡ng trÃ¬nh Ä‘ang cháº¡y.</li><li><strong>Luá»“ng (Thread)</strong>: Luá»“ng lÃ  Ä‘Æ¡n vá»‹ nhá» nháº¥t cá»§a tiáº¿n trÃ¬nh. Má»™t tiáº¿n trÃ¬nh cÃ³ thá»ƒ chá»©a nhiá»u luá»“ng. Luá»“ng chia sáº» cÃ¹ng tÃ i nguyÃªn vá»›i cÃ¡c luá»“ng khÃ¡c trong cÃ¹ng má»™t tiáº¿n trÃ¬nh.</li></ul><p>Sá»± khÃ¡c biá»‡t giá»¯a tiáº¿n trÃ¬nh vÃ  luá»“ng:</p><ul><li>Má»™t chÆ°Æ¡ng trÃ¬nh Ã­t nháº¥t cÃ³ má»™t tiáº¿n trÃ¬nh, má»™t tiáº¿n trÃ¬nh Ã­t nháº¥t cÃ³ má»™t luá»“ng.</li><li>Luá»“ng chia nhá» hÆ¡n tiáº¿n trÃ¬nh, do Ä‘Ã³ chi phÃ­ thá»±c thi tháº¥p hÆ¡n vÃ  kháº£ nÄƒng Ä‘á»“ng thá»i cao hÆ¡n.</li><li>Tiáº¿n trÃ¬nh lÃ  má»™t thá»±c thá»ƒ Ä‘á»™c láº­p, cÃ³ tÃ i nguyÃªn riÃªng; trong khi cÃ¡c luá»“ng trong cÃ¹ng má»™t tiáº¿n trÃ¬nh chia sáº» tÃ i nguyÃªn cá»§a tiáº¿n trÃ¬nh Ä‘Ã³.</li></ul><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230715210906.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>JVM cháº¡y trong má»™t tiáº¿n trÃ¬nh duy nháº¥t vÃ  cÃ¡c luá»“ng trong JVM chia sáº» heap cá»§a tiáº¿n trÃ¬nh Ä‘Ã³. Äiá»u nÃ y giáº£i thÃ­ch táº¡i sao má»™t sá»‘ luá»“ng cÃ³ thá»ƒ truy cáº­p vÃ o cÃ¹ng má»™t Ä‘á»‘i tÆ°á»£ng. Luá»“ng chia sáº» heap vÃ  cÃ³ ngÄƒn xáº¿p riÃªng. Äiá»u nÃ y giáº£i thÃ­ch cÃ¡ch má»™t luá»“ng gá»i má»™t phÆ°Æ¡ng thá»©c vÃ  lÃ m tháº¿ nÃ o biáº¿n cá»¥c bá»™ cá»§a nÃ³ Ä‘Æ°á»£c báº£o vá»‡. Tuy nhiÃªn, heap khÃ´ng an toÃ n Ä‘á»‘i vá»›i luá»“ng vÃ  cáº§n Ä‘Æ°á»£c Ä‘á»“ng bá»™ hÃ³a Ä‘á»ƒ Ä‘áº£m báº£o an toÃ n luá»“ng.</p><h3 id="Ä‘ieu-kien-canh-tranh-va-vung-quan-trong" tabindex="-1"><a class="header-anchor" href="#Ä‘ieu-kien-canh-tranh-va-vung-quan-trong"><span>Äiá»u kiá»‡n cáº¡nh tranh vÃ  VÃ¹ng quan trá»ng</span></a></h3><ul><li><p><strong>Äiá»u kiá»‡n cáº¡nh tranh (Race Condition)</strong>: Khi hai luá»“ng cáº¡nh tranh cho cÃ¹ng má»™t tÃ i nguyÃªn, náº¿u thá»© tá»± truy cáº­p tÃ i nguyÃªn quan trá»ng, thÃ¬ cÃ³ Ä‘iá»u kiá»‡n cáº¡nh tranh xáº£y ra.</p></li><li><p><strong>VÃ¹ng quan trá»ng</strong> (Critical Sections)**: Äoáº¡n mÃ£ gÃ¢y ra Ä‘iá»u kiá»‡n cáº¡nh tranh Ä‘Æ°á»£c gá»i lÃ  vÃ¹ng quan trá»ng.</p></li></ul><h3 id="giam-sat" tabindex="-1"><a class="header-anchor" href="#giam-sat"><span>GiÃ¡m sÃ¡t</span></a></h3><p>GiÃ¡m sÃ¡t (Monitor) lÃ  quáº£n lÃ½ biáº¿n chia sáº» vÃ  quÃ¡ trÃ¬nh thao tÃ¡c trÃªn biáº¿n chia sáº», giÃºp chÃºng há»— trá»£ Ä‘á»“ng thá»i.</p><p>Java sá»­ dá»¥ng cÃ´ng nghá»‡ giÃ¡m sÃ¡t, tá»« khÃ³a synchronized vÃ  cÃ¡c phÆ°Æ¡ng thá»©c wait(), notify(), notifyAll() lÃ  cÃ¡c thÃ nh pháº§n cá»§a giÃ¡m sÃ¡t.Â <strong>GiÃ¡m sÃ¡t vÃ  Semaphore lÃ  tÆ°Æ¡ng Ä‘Æ°Æ¡ng, cÃ³ nghÄ©a lÃ  giÃ¡m sÃ¡t cÃ³ thá»ƒ thá»±c hiá»‡n Semaphore vÃ  Semaphore cÅ©ng cÃ³ thá»ƒ thá»±c hiá»‡n giÃ¡m sÃ¡t</strong>.</p><h2 id="Ä‘ac-Ä‘iem-cua-Ä‘a-luong" tabindex="-1"><a class="header-anchor" href="#Ä‘ac-Ä‘iem-cua-Ä‘a-luong"><span>Äáº·c Ä‘iá»ƒm cá»§a Ä‘a luá»“ng</span></a></h2><p>CÃ´ng nghá»‡ ngÃ y cÃ ng tiáº¿n bá»™, hiá»‡u suáº¥t cá»§a CPU, bá»™ nhá»› vÃ  thiáº¿t bá»‹ I/O cÅ©ng ngÃ y cÃ ng cáº£i thiá»‡n. Tuy nhiÃªn, váº«n tá»“n táº¡i má»™t mÃ¢u thuáº«n cá»‘t lÃµi:Â <strong>CPU, bá»™ nhá»› vÃ  thiáº¿t bá»‹ I/O cÃ³ tá»‘c Ä‘á»™ khÃ¡c nhau</strong>. CPU nhanh hÆ¡n bá»™ nhá»›, bá»™ nhá»› nhanh hÆ¡n thiáº¿t bá»‹ I/O.</p><p>LÃ½ thuyáº¿t thÃ¹ng gá»— cho chÃºng ta biáº¿t: má»™t thÃ¹ng gá»— cÃ³ thá»ƒ chá»©a bao nhiÃªu nÆ°á»›c, phá»¥ thuá»™c vÃ o táº¥m gá»— ngáº¯n nháº¥t. TÆ°Æ¡ng tá»±, hiá»‡u suáº¥t chung cá»§a chÆ°Æ¡ng trÃ¬nh phá»¥ thuá»™c vÃ o hoáº¡t Ä‘á»™ng cháº­m nháº¥t (tá»©c lÃ  hoáº¡t Ä‘á»™ng I/O), vÃ¬ váº­y viá»‡c cáº£i thiá»‡n hiá»‡u suáº¥t CPU vÃ  bá»™ nhá»› má»™t cÃ¡ch Ä‘Æ¡n láº» lÃ  vÃ´ Ã­ch.</p><figure><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20201225170052.jpg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>Äá»ƒ táº­n dá»¥ng hiá»‡u suáº¥t cao cá»§a CPU má»™t cÃ¡ch há»£p lÃ½, cÃ¢n báº±ng sá»± chÃªnh lá»‡ch tá»‘c Ä‘á»™ giá»¯a ba yáº¿u tá»‘ nÃ y, kiáº¿n trÃºc mÃ¡y tÃ­nh, há»‡ Ä‘iá»u hÃ nh vÃ  trÃ¬nh biÃªn dá»‹ch Ä‘Ã£ Ä‘Ã³ng gÃ³p, chá»§ yáº¿u lÃ :</p><ul><li><strong>CPU Ä‘Ã£ Ä‘Æ°á»£c gia tÄƒng bá»™ nhá»› cache</strong> Ä‘á»ƒ cÃ¢n báº±ng sá»± chÃªnh lá»‡ch vá» tá»‘c Ä‘á»™ giá»¯a nÃ³ vÃ  bá»™ nhá»›;</li><li><strong>Há»‡ Ä‘iá»u hÃ nh Ä‘Ã£ thÃªm cÃ¡c tiáº¿n trÃ¬nh, luá»“ng</strong> Ä‘á»ƒ phÃ¢n chia thá»i gian sá»­ dá»¥ng CPU, tá»« Ä‘Ã³ lÃ m cÃ¢n báº±ng sá»± chÃªnh lá»‡ch vá» tá»‘c Ä‘á»™ giá»¯a CPU vÃ  thiáº¿t bá»‹ I/O;</li><li><strong>TrÃ¬nh biÃªn dá»‹ch Ä‘Ã£ tá»‘i Æ°u hÃ³a thá»© tá»± thá»±c hiá»‡n cÃ¡c chá»‰ thá»‹</strong>Â Ä‘á»ƒ táº­n dá»¥ng cache má»™t cÃ¡ch há»£p lÃ½.</li></ul><p>Trong Ä‘Ã³, tiáº¿n trÃ¬nh vÃ  luá»“ng cho phÃ©p mÃ¡y tÃ­nh vÃ  chÆ°Æ¡ng trÃ¬nh cÃ³ kháº£ nÄƒng xá»­ lÃ½ Ä‘á»“ng thá»i cÃ¡c nhiá»‡m vá»¥.</p><p>Lá»£i Ã­ch cá»§a Ä‘a luá»“ng bao gá»“m:</p><ul><li>TÄƒng cÆ°á»ng sá»­ dá»¥ng tÃ i nguyÃªn</li><li>TÄƒng tá»‘c Ä‘á»™ pháº£n há»“i cá»§a chÆ°Æ¡ng trÃ¬nh</li></ul><h3 id="tang-cuong-su-dung-tai-nguyen" tabindex="-1"><a class="header-anchor" href="#tang-cuong-su-dung-tai-nguyen"><span>TÄƒng cÆ°á»ng sá»­ dá»¥ng tÃ i nguyÃªn</span></a></h3><p>HÃ£y tÆ°á»Ÿng tÆ°á»£ng má»™t á»©ng dá»¥ng cáº§n Ä‘á»c vÃ  xá»­ lÃ½ tá»‡p tá»« há»‡ thá»‘ng tá»‡p cá»¥c bá»™. VÃ­ dá»¥, viá»‡c Ä‘á»c má»™t tá»‡p tá»« Ä‘Ä©a cáº§n máº¥t 5 giÃ¢y vÃ  xá»­ lÃ½ má»™t tá»‡p cáº§n máº¥t 2 giÃ¢y. Xá»­ lÃ½ hai tá»‡p sáº½ máº¥t:</p><div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span>Äá»c tá»‡p A trong 5 giÃ¢y</span></span>
<span class="line"><span>Xá»­ lÃ½ tá»‡p A trong 2 giÃ¢y</span></span>
<span class="line"><span>Äá»c tá»‡p B trong 5 giÃ¢y</span></span>
<span class="line"><span>Xá»­ lÃ½ tá»‡p B trong 2 giÃ¢y</span></span>
<span class="line"><span>---------------------</span></span>
<span class="line"><span>Tá»•ng cá»™ng 14 giÃ¢y</span></span></code></pre></div><p>Khi Ä‘á»c tá»‡p tá»« Ä‘Ä©a, háº§u háº¿t thá»i gian cá»§a CPU Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ chá» Ä‘Ä©a Ä‘á»c dá»¯ liá»‡u. Trong thá»i gian nÃ y, CPU ráº¥t trá»‘ng ráº£i. NÃ³ cÃ³ thá»ƒ lÃ m má»™t sá»‘ cÃ´ng viá»‡c khÃ¡c. Báº±ng cÃ¡ch thay Ä‘á»•i thá»© tá»± cÃ¡c hoáº¡t Ä‘á»™ng, ta cÃ³ thá»ƒ táº­n dá»¥ng tá»‘t hÆ¡n tÃ i nguyÃªn CPU. Xem xÃ©t thá»© tá»± sau:</p><div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span>Äá»c tá»‡p A trong 5 giÃ¢y</span></span>
<span class="line"><span>Äá»c tá»‡p B trong 5 giÃ¢y + Xá»­ lÃ½ tá»‡p A trong 2 giÃ¢y</span></span>
<span class="line"><span>Xá»­ lÃ½ tá»‡p B trong 2 giÃ¢y</span></span>
<span class="line"><span>---------------------</span></span>
<span class="line"><span>Tá»•ng cá»™ng 12 giÃ¢y</span></span></code></pre></div><p>CPU chá» cho Ä‘áº¿n khi tá»‡p Ä‘áº§u tiÃªn Ä‘Æ°á»£c Ä‘á»c xong. Sau Ä‘Ã³, nÃ³ báº¯t Ä‘áº§u Ä‘á»c tá»‡p thá»© hai. Trong khi tá»‡p thá»© hai Ä‘ang Ä‘Æ°á»£c Ä‘á»c, CPU xá»­ lÃ½ tá»‡p Ä‘áº§u tiÃªn. HÃ£y nhá»› ráº±ng trong quÃ¡ trÃ¬nh chá» Ä‘Ä©a Ä‘á»c tá»‡p, CPU ráº¥t trá»‘ng tráº£i.</p><p>NÃ³i chung, CPU cÃ³ thá»ƒ lÃ m má»™t sá»‘ cÃ´ng viá»‡c khÃ¡c trong quÃ¡ trÃ¬nh chá» I/O. Äiá»u nÃ y khÃ´ng nháº¥t thiáº¿t pháº£i lÃ  I/O Ä‘Ä©a. NÃ³ cÅ©ng cÃ³ thá»ƒ lÃ  I/O máº¡ng hoáº·c Ä‘áº§u vÃ o tá»« ngÆ°á»i dÃ¹ng. ThÃ´ng thÆ°á»ng, I/O máº¡ng vÃ  I/O Ä‘Ä©a cháº­m hÆ¡n nhiá»u so vá»›i I/O CPU vÃ  bá»™ nhá»›.</p><h3 id="tang-toc-Ä‘o-phan-hoi-cua-chuong-trinh" tabindex="-1"><a class="header-anchor" href="#tang-toc-Ä‘o-phan-hoi-cua-chuong-trinh"><span>TÄƒng tá»‘c Ä‘á»™ pháº£n há»“i cá»§a chÆ°Æ¡ng trÃ¬nh</span></a></h3><p>Má»™t má»¥c tiÃªu phá»• biáº¿n khÃ¡c cá»§a viá»‡c chuyá»ƒn Ä‘á»•i tá»« á»©ng dá»¥ng Ä‘Æ¡n luá»“ng sang á»©ng dá»¥ng Ä‘a luá»“ng lÃ  táº¡o ra má»™t á»©ng dá»¥ng pháº£n há»“i nhanh hÆ¡n. HÃ£y tÆ°á»Ÿng tÆ°á»£ng má»™t á»©ng dá»¥ng mÃ¡y chá»§, nÃ³ láº¯ng nghe cÃ¡c yÃªu cáº§u Ä‘áº¿n tá»« má»™t cá»•ng. Khi má»™t yÃªu cáº§u Ä‘áº¿n, nÃ³ xá»­ lÃ½ yÃªu cáº§u Ä‘Ã³ vÃ  sau Ä‘Ã³ quay trá»Ÿ láº¡i láº¯ng nghe.</p><p>Luá»“ng chÃ­nh cá»§a mÃ¡y chá»§ Ä‘Æ°á»£c mÃ´ táº£ nhÆ° sau:</p><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">while</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> (server is active) {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    listen </span><span style="color:#C678DD;--shiki-dark:#C678DD;">for</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> request</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    process request</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">}</span></span></code></pre></div><p>Náº¿u má»™t yÃªu cáº§u máº¥t nhiá»u thá»i gian Ä‘á»ƒ xá»­ lÃ½, trong thá»i gian Ä‘Ã³, khÃ´ng cÃ³ yÃªu cáº§u má»›i nÃ o cÃ³ thá»ƒ Ä‘Æ°á»£c gá»­i Ä‘áº¿n mÃ¡y chá»§. YÃªu cáº§u chá»‰ cÃ³ thá»ƒ Ä‘Æ°á»£c cháº¥p nháº­n khi mÃ¡y chá»§ Ä‘ang láº¯ng nghe. Má»™t thiáº¿t káº¿ khÃ¡c lÃ  cho luá»“ng láº¯ng nghe chuyá»ƒn yÃªu cáº§u cho luá»“ng cÃ´ng nhÃ¢n (worker thread) vÃ  sau Ä‘Ã³ ngay láº­p tá»©c quay trá»Ÿ láº¡i viá»‡c láº¯ng nghe. Luá»“ng cÃ´ng nhÃ¢n cÃ³ thá»ƒ xá»­ lÃ½ yÃªu cáº§u vÃ  gá»­i pháº£n há»“i cho khÃ¡ch hÃ ng. Thiáº¿t káº¿ nÃ y Ä‘Æ°á»£c mÃ´ táº£ nhÆ° sau:</p><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">while</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> (server is active) {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    listen </span><span style="color:#C678DD;--shiki-dark:#C678DD;">for</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> request</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    hand request to worker thread</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">}</span></span></code></pre></div><p>Theo cÃ¡ch nÃ y, luá»“ng mÃ¡y chá»§ nhanh chÃ³ng quay trá»Ÿ láº¡i viá»‡c láº¯ng nghe. Do Ä‘Ã³, nhiá»u khÃ¡ch hÃ ng hÆ¡n cÃ³ thá»ƒ gá»­i yÃªu cáº§u Ä‘áº¿n mÃ¡y chá»§. á»¨ng dá»¥ng nÃ y cÅ©ng trá»Ÿ nÃªn pháº£n há»“i nhanh hÆ¡n.</p><p>TÆ°Æ¡ng tá»±, Ä‘iá»u nÃ y cÅ©ng Ã¡p dá»¥ng cho á»©ng dá»¥ng trÃªn mÃ¡y tÃ­nh Ä‘á»ƒ bÃ n. Náº¿u báº¡n nháº¥p vÃ o má»™t nÃºt Ä‘á»ƒ báº¯t Ä‘áº§u má»™t tÃ¡c vá»¥ tá»‘n thá»i gian, luá»“ng nÃ y pháº£i thá»±c hiá»‡n tÃ¡c vá»¥ vÃ  cáº­p nháº­t cá»­a sá»• vÃ  nÃºt. Trong quÃ¡ trÃ¬nh thá»±c hiá»‡n tÃ¡c vá»¥, á»©ng dá»¥ng cÃ³ váº» nhÆ° khÃ´ng pháº£n há»“i. NgÆ°á»£c láº¡i, tÃ¡c vá»¥ cÃ³ thá»ƒ Ä‘Æ°á»£c chuyá»ƒn Ä‘áº¿n luá»“ng cÃ´ng nhÃ¢n. Khi luá»“ng cÃ´ng nhÃ¢n Ä‘ang báº­n rá»™n xá»­ lÃ½ tÃ¡c vá»¥, luá»“ng cá»­a sá»• cÃ³ thá»ƒ tá»± do pháº£n há»“i yÃªu cáº§u cá»§a ngÆ°á»i dÃ¹ng khÃ¡c. Khi luá»“ng cÃ´ng nhÃ¢n hoÃ n thÃ nh tÃ¡c vá»¥, nÃ³ gá»­i tÃ­n hiá»‡u cho luá»“ng cá»­a sá»•. Luá»“ng cá»­a sá»• cÃ³ thá»ƒ cáº­p nháº­t cá»­a sá»• á»©ng dá»¥ng vÃ  hiá»ƒn thá»‹ káº¿t quáº£ cá»§a tÃ¡c vá»¥. Äá»‘i vá»›i ngÆ°á»i dÃ¹ng, á»©ng dá»¥ng cÃ³ thiáº¿t káº¿ vá»›i luá»“ng cÃ´ng nhÃ¢n sáº½ pháº£n há»“i nhanh hÆ¡n.</p><h3 id="van-Ä‘e-cua-Ä‘a-luong" tabindex="-1"><a class="header-anchor" href="#van-Ä‘e-cua-Ä‘a-luong"><span>Váº¥n Ä‘á» cá»§a Ä‘a luá»“ng</span></a></h3><p>Má»i thá»© Ä‘á»u cÃ³ lá»£i vÃ  háº¡i, vÃ  Ä‘a luá»“ng cÅ©ng khÃ´ng pháº£i lÃ  ngoáº¡i lá»‡.</p><p>ChÃºng ta Ä‘Ã£ biáº¿t Ä‘Æ°á»£c nhá»¯ng lá»£i Ã­ch cá»§a Ä‘a luá»“ng: tÄƒng cÆ°á»ng sá»­ dá»¥ng tÃ i nguyÃªn, tÄƒng tá»‘c Ä‘á»™ pháº£n há»“i cá»§a chÆ°Æ¡ng trÃ¬nh. Tuy nhiÃªn, cÅ©ng cáº§n nháº­n thá»©c vá» nhá»¯ng váº¥n Ä‘á» mÃ  Ä‘a luá»“ng gÃ¢y ra, chá»§ yáº¿u bao gá»“m:</p><ul><li>Váº¥n Ä‘á» an toÃ n</li><li>Váº¥n Ä‘á» hoáº¡t Ä‘á»™ng</li><li>Váº¥n Ä‘á» hiá»‡u suáº¥t</li></ul><p>ChÃºng sáº½ Ä‘Æ°á»£c trÃ¬nh bÃ y chi tiáº¿t trong cÃ¡c pháº§n tiáº¿p theo.</p><h3 id="van-Ä‘e-an-toan" tabindex="-1"><a class="header-anchor" href="#van-Ä‘e-an-toan"><span>Váº¥n Ä‘á» an toÃ n</span></a></h3><p>Váº¥n Ä‘á» quan trá»ng nháº¥t trong Ä‘a luá»“ng lÃ  váº¥n Ä‘á» an toÃ n Ä‘a luá»“ng.</p><p><strong>An toÃ n Ä‘a luá»“ng</strong>: Äáº£m báº£o tÃ­nh chÃ­nh xÃ¡c cá»§a chÆ°Æ¡ng trÃ¬nh, Ä‘áº£m báº£o káº¿t quáº£ xá»­ lÃ½ Ä‘a luá»“ng Ä‘Ã¡p á»©ng cÃ¡c ká»³ vá»ng.</p><p>An toÃ n Ä‘a luá»“ng yÃªu cáº§u Ä‘áº£m báº£o má»™t sá»‘ tÃ­nh cháº¥t cÆ¡ báº£n:</p><ul><li><strong>TÃ­nh nhÃ¬n tháº¥y</strong>Â - Khi má»™t luá»“ng thay Ä‘á»•i má»™t biáº¿n chia sáº», tráº¡ng thÃ¡i cá»§a biáº¿n Ä‘Ã³ cÃ³ thá»ƒ Ä‘Æ°á»£c cÃ¡c luá»“ng khÃ¡c nhÃ¬n tháº¥y ngay láº­p tá»©c, thÆ°á»ng Ä‘Æ°á»£c hiá»ƒu lÃ  Ä‘á»“ng bá»™ tráº¡ng thÃ¡i tá»« luá»“ng cá»¥c bá»™ cá»§a luá»“ng vÃ o bá»™ nhá»› chÃ­nh,Â <code>volatile</code>Â Ä‘áº£m báº£o tÃ­nh nhÃ¬n tháº¥y.</li><li><strong>TÃ­nh nguyÃªn tá»­</strong>Â - ÄÆ¡n giáº£n nÃ³i lÃ  cÃ¡c hoáº¡t Ä‘á»™ng liÃªn quan khÃ´ng bá»‹ can thiá»‡p bá»Ÿi cÃ¡c luá»“ng khÃ¡c, thÆ°á»ng Ä‘Æ°á»£c thá»±c hiá»‡n thÃ´ng qua cÆ¡ cháº¿ Ä‘á»“ng bá»™ hÃ³a (khÃ³a:Â <code>synchronized</code>,Â <code>Lock</code>).</li><li><strong>TÃ­nh tuáº§n tá»±</strong>Â - Äáº£m báº£o ngá»¯ nghÄ©a tuáº§n tá»± bÃªn trong má»™t luá»“ng, trÃ¡nh tÃ¡i sáº¯p xáº¿p cÃ¡c chá»‰ thá»‹.</li></ul><h3 id="van-Ä‘e-cua-bo-nho-Ä‘em-va-tinh-nhin-thay" tabindex="-1"><a class="header-anchor" href="#van-Ä‘e-cua-bo-nho-Ä‘em-va-tinh-nhin-thay"><span>Váº¥n Ä‘á» cá»§a bá»™ nhá»› Ä‘á»‡m vÃ  tÃ­nh nhÃ¬n tháº¥y</span></a></h3><blockquote><p>Má»™t luá»“ng thay Ä‘á»•i má»™t biáº¿n chia sáº», luá»“ng khÃ¡c cÃ³ thá»ƒ khÃ´ng nhÃ¬n tháº¥y sá»± thay Ä‘á»•i Ä‘Ã³, gá»i lÃ Â <strong>tÃ­nh nhÃ¬n tháº¥y</strong>.</p></blockquote><p>Trong thá»i Ä‘áº¡i má»™t lÃµi, táº¥t cáº£ cÃ¡c luá»“ng Ä‘á»u cháº¡y trÃªn cÃ¹ng má»™t CPU, viá»‡c Ä‘á»“ng bá»™ dá»¯ liá»‡u giá»¯a bá»™ nhá»› vÃ  CPU dá»… dÃ ng giáº£i quyáº¿t. VÃ¬ táº¥t cáº£ cÃ¡c luá»“ng Ä‘á»u lÃ m viá»‡c trÃªn bá»™ nhá»› chung cá»§a CPU, viá»‡c ghi cá»§a má»™t luá»“ng vÃ o bá»™ nhá»› sáº½ Ä‘Æ°á»£c luá»“ng khÃ¡c nhÃ¬n tháº¥y ngay láº­p tá»©c. VÃ­ dá»¥, trong hÃ¬nh dÆ°á»›i Ä‘Ã¢y, luá»“ng A vÃ  luá»“ng B Ä‘á»u lÃ m viá»‡c trÃªn cÃ¹ng má»™t bá»™ nhá»› CPU, vÃ¬ váº­y khi luá»“ng A cáº­p nháº­t giÃ¡ trá»‹ cá»§a biáº¿n V, luá»“ng B sáº½ nhÃ¬n tháº¥y giÃ¡ trá»‹ má»›i (giÃ¡ trá»‹ Ä‘Ã£ Ä‘Æ°á»£c luá»“ng A ghi).</p><p align="center"><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/Drawing 2023-07-16 11.47.05.excalidraw.png"></p><p>Trong thá»i Ä‘áº¡i Ä‘a lÃµi, má»—i CPU cÃ³ bá»™ nhá»› cache riÃªng cá»§a mÃ¬nh, viá»‡c Ä‘á»“ng bá»™ dá»¯ liá»‡u giá»¯a bá»™ nhá»› vÃ  CPU trá»Ÿ nÃªn khÃ³ khÄƒn hÆ¡n, khi nhiá»u luá»“ng cháº¡y trÃªn cÃ¡c CPU khÃ¡c nhau, cÃ¡c luá»“ng nÃ y sáº½ lÃ m viá»‡c trÃªn cÃ¡c bá»™ nhá»› cache khÃ¡c nhau. VÃ­ dá»¥ trong hÃ¬nh dÆ°á»›i Ä‘Ã¢y, luá»“ng A lÃ m viá»‡c trÃªn bá»™ nhá»› cache CPU-1, trong khi luá»“ng B lÃ m viá»‡c trÃªn bá»™ nhá»› cache CPU-2. RÃµ rÃ ng, khi Ä‘Ã³ luá»“ng A thay Ä‘á»•i giÃ¡ trá»‹ cá»§a biáº¿n V, Ä‘á»‘i vá»›i luá»“ng B, giÃ¡ trá»‹ cá»§a biáº¿n V khÃ´ng cÃ²n tÃ­nh nhÃ¬n tháº¥y.</p><p align="center"><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/Drawing 2023-07-16 13.17.00.excalidraw.png"></p><p>ã€VÃ­ dá»¥ã€‘Má»™t vÃ­ dá»¥ vá» váº¥n Ä‘á» khÃ´ng an toÃ n Ä‘á»‘i vá»›i luá»“ng</p><p>DÆ°á»›i Ä‘Ã¢y, chÃºng ta sáº½ sá»­ dá»¥ng má»™t Ä‘oáº¡n mÃ£ Ä‘á»ƒ xÃ¡c minh váº¥n Ä‘á» vá» tÃ­nh nhÃ¬n tháº¥y trong mÃ´i trÆ°á»ng Ä‘a nhÃ¢n. Äoáº¡n mÃ£ dÆ°á»›i Ä‘Ã¢y, má»—i láº§n thá»±c hiá»‡n phÆ°Æ¡ng thá»©c <code>add10K()</code>, sáº½ láº·p láº¡i 10000 láº§n phÃ©p toÃ¡n count+=1. Trong phÆ°Æ¡ng thá»©c <code>calc()</code>, chÃºng ta táº¡o ra hai luá»“ng, má»—i luá»“ng gá»i má»™t láº§n phÆ°Æ¡ng thá»©c <code>add10K()</code>. HÃ£y suy nghÄ© xem káº¿t quáº£ cá»§a viá»‡c thá»±c hiá»‡n phÆ°Æ¡ng thá»©c <code>calc()</code> sáº½ lÃ  bao nhiÃªu?</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Test</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">  private</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> long</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> count </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">  private</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> add10K</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    int</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> idx</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    while</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(idx++ </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">&lt;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 10000</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">      count </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">+=</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">  public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> static</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> long</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> calc</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    final</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Test</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> test</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> Test</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Táº¡o ra hai luá»“ng, thá»±c hiá»‡n phÃ©p toÃ¡n add()</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    Thread</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> th1</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> Thread</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(()</span><span style="color:#C678DD;--shiki-dark:#C678DD;">-&gt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">      test</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">add10K</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    Thread</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> th2</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> Thread</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(()</span><span style="color:#C678DD;--shiki-dark:#C678DD;">-&gt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">      test</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">add10K</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Khá»Ÿi Ä‘á»™ng hai luá»“ng</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    th1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">start</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    th2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">start</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Chá» hai luá»“ng thá»±c hiá»‡n xong</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    th1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">join</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    th2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">join</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    return</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> count;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Trá»±c giÃ¡c cho chÃºng ta biáº¿t ráº±ng káº¿t quáº£ sáº½ lÃ  20000, vÃ¬ trong má»™t luá»“ng Ä‘Æ¡n, gá»i hai láº§n phÆ°Æ¡ng thá»©c add10K() thÃ¬ giÃ¡ trá»‹ cá»§a count sáº½ lÃ  20000, nhÆ°ng thá»±c táº¿ káº¿t quáº£ thá»±c hiá»‡n <code>calc()</code> lÃ  má»™t sá»‘ ngáº«u nhiÃªn tá»« 10000 Ä‘áº¿n 20000. Táº¡i sao váº­y?</p><p>ChÃºng ta giáº£ Ä‘á»‹nh ráº±ng luá»“ng A vÃ  luá»“ng B báº¯t Ä‘áº§u thá»±c hiá»‡n cÃ¹ng nhau, vÃ¬ váº­y láº§n Ä‘áº§u tiÃªn cáº£ hai Ä‘á»u Ä‘á»c count=0 vÃ o bá»™ nhá»› Ä‘á»‡m CPU cá»§a mÃ¬nh, sau khi thá»±c hiá»‡n count+=1, giÃ¡ trá»‹ trong bá»™ nhá»› Ä‘á»‡m CPU cá»§a má»—i luá»“ng Ä‘á»u lÃ  1, sau Ä‘Ã³ ghi vÃ o bá»™ nhá»›, chÃºng ta sáº½ tháº¥y ráº±ng giÃ¡ trá»‹ trong bá»™ nhá»› lÃ  1, khÃ´ng pháº£i lÃ  2 nhÆ° chÃºng ta mong Ä‘á»£i. Sau Ä‘Ã³, vÃ¬ má»—i bá»™ nhá»› Ä‘á»‡m CPU Ä‘á»u cÃ³ giÃ¡ trá»‹ cá»§a count, hai luá»“ng Ä‘á»u dá»±a trÃªn giÃ¡ trá»‹ count trong bá»™ nhá»› Ä‘á»‡m CPU cá»§a mÃ¬nh Ä‘á»ƒ tÃ­nh toÃ¡n, dáº«n Ä‘áº¿n giÃ¡ trá»‹ cuá»‘i cÃ¹ng cá»§a count Ä‘á»u nhá» hÆ¡n 20000. ÄÃ¢y chÃ­nh lÃ  váº¥n Ä‘á» vá» tÃ­nh nhÃ¬n tháº¥y cá»§a bá»™ nhá»› Ä‘á»‡m.</p><p>Náº¿u thay Ä‘á»•i láº·p láº¡i 10000 láº§n phÃ©p toÃ¡n <code>count+=1</code> thÃ nh láº·p láº¡i 1 tá»· láº§n, báº¡n sáº½ nháº­n tháº¥y hiá»‡u quáº£ rÃµ rÃ ng hÆ¡n, giÃ¡ trá»‹ cuá»‘i cÃ¹ng cá»§a <code>count</code> gáº§n 1 tá»·, khÃ´ng pháº£i 2 tá»·. Náº¿u láº·p láº¡i 10000 láº§n, giÃ¡ trá»‹ count gáº§n 20000, nguyÃªn nhÃ¢n lÃ  hai luá»“ng khÃ´ng Ä‘Æ°á»£c khá»Ÿi Ä‘á»™ng cÃ¹ng má»™t lÃºc, cÃ³ má»™t khoáº£ng thá»i gian chÃªnh lá»‡ch.</p><p align="center"><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/Drawing 2023-07-16 13.32.35.excalidraw.png"></p><h3 id="van-Ä‘e-ve-tinh-nguyen-tu-do-chuyen-Ä‘oi-luong" tabindex="-1"><a class="header-anchor" href="#van-Ä‘e-ve-tinh-nguyen-tu-do-chuyen-Ä‘oi-luong"><span>Váº¥n Ä‘á» vá» tÃ­nh nguyÃªn tá»­ do chuyá»ƒn Ä‘á»•i luá»“ng</span></a></h3><p>VÃ¬ IO quÃ¡ cháº­m, cÃ¡c há»‡ Ä‘iá»u hÃ nh ban Ä‘áº§u Ä‘Ã£ phÃ¡t minh ra khÃ¡i niá»‡m &quot;Ä‘a tiáº¿n trÃ¬nh&quot; (multi-process), cho phÃ©p má»™t tiáº¿n trÃ¬nh thá»±c hiá»‡n má»™t Ä‘oáº¡n mÃ£ nhá» trong má»™t khoáº£ng thá»i gian (gá»i lÃ  &quot;time slice&quot;).</p><p>Trong má»™t time slice, náº¿u má»™t tiáº¿n trÃ¬nh thá»±c hiá»‡n má»™t hoáº¡t Ä‘á»™ng IO nhÆ° Ä‘á»c táº­p tin, lÃºc nÃ y tiáº¿n trÃ¬nh cÃ³ thá»ƒ Ä‘Æ°á»£c gÃ¡n nhÃ£n lÃ  &quot;tráº¡ng thÃ¡i ngá»§&quot; vÃ  nhÆ°á»ng quyá»n sá»­ dá»¥ng CPU. Khi táº­p tin Ä‘Æ°á»£c Ä‘á»c vÃ o bá»™ nhá»›, há»‡ Ä‘iá»u hÃ nh sáº½ kÃ­ch hoáº¡t láº¡i tiáº¿n trÃ¬nh ngá»§ vÃ  sau khi tá»‰nh dáº­y, tiáº¿n trÃ¬nh nÃ y cÃ³ cÆ¡ há»™i Ä‘á»ƒ láº¥y láº¡i quyá»n sá»­ dá»¥ng CPU.</p><p>Tiáº¿n trÃ¬nh á»Ÿ Ä‘Ã¢y giáº£i phÃ³ng quyá»n sá»­ dá»¥ng CPU khi chá» IO Ä‘á»ƒ CPU cÃ³ thá»ƒ lÃ m viá»‡c khÃ¡c trong khoáº£ng thá»i gian chá» Ä‘Ã³, tá»« Ä‘Ã³ tÄƒng tá»· lá»‡ sá»­ dá»¥ng CPU; ngoÃ i ra, náº¿u cÃ³ má»™t tiáº¿n trÃ¬nh khÃ¡c Ä‘á»c tá»‡p vÃ o thá»i Ä‘iá»ƒm nÃ y, hoáº¡t Ä‘á»™ng Ä‘á»c tá»‡p sáº½ Ä‘Æ°á»£c xáº¿p hÃ ng, khi hoÃ n thÃ nh má»™t hoáº¡t Ä‘á»™ng Ä‘á»c cá»§a má»™t tiáº¿n trÃ¬nh, trÃ¬nh Ä‘iá»u khiá»ƒn Ä‘Ä©a sáº½ khá»Ÿi Ä‘á»™ng ngay láº­p tá»©c hoáº¡t Ä‘á»™ng Ä‘á»c tiáº¿p theo, tá»« Ä‘Ã³ tÄƒng tá»· lá»‡ sá»­ dá»¥ng IO.</p><p>Há»‡ Ä‘iá»u hÃ nh ban Ä‘áº§u Ä‘Æ°á»£c xÃ¢y dá»±ng dá»±a trÃªn khÃ¡i niá»‡m &quot;tiáº¿n trÃ¬nh&quot; Ä‘á»ƒ láº­p lá»‹ch CPU, cÃ¡c tiáº¿n trÃ¬nh khÃ¡c nhau khÃ´ng chia sáº» khÃ´ng gian bá»™ nhá»› vÃ  do Ä‘Ã³ Ä‘á»ƒ chuyá»ƒn nhiá»‡m vá»¥ giá»¯a cÃ¡c tiáº¿n trÃ¬nh pháº£i chuyá»ƒn mÃ£ Ã¡nh xáº¡ bá»™ nhá»›. Tuy nhiÃªn, táº¥t cáº£ cÃ¡c luá»“ng Ä‘Æ°á»£c táº¡o ra bá»Ÿi má»™t tiáº¿n trÃ¬nh chia sáº» cÃ¹ng má»™t khÃ´ng gian bá»™ nhá»›, do Ä‘Ã³ chi phÃ­ cá»§a viá»‡c chuyá»ƒn nhiá»‡m vá»¥ (<strong>Context Switching</strong>) giá»¯a cÃ¡c luá»“ng ráº¥t tháº¥p. Há»‡ Ä‘iá»u hÃ nh hiá»‡n Ä‘áº¡i dá»±a trÃªn luá»“ng nháº¹ hÆ¡n Ä‘á»ƒ láº­p lá»‹ch vÃ  khi ta nÃ³i vá» &quot;chuyá»ƒn nhiá»‡m vá»¥&quot; ngÃ y nay thÃ¬ thá»±c ra lÃ  &quot;chuyá»ƒn luá»“ng&quot;.</p><p>ChÆ°Æ¡ng trÃ¬nh Ä‘á»“ng thá»i Java dá»±a trÃªn Ä‘a luá»“ng, tá»± nhiÃªn cÅ©ng liÃªn quan Ä‘áº¿n viá»‡c chuyá»ƒn Ä‘á»•i nhiá»‡m vá»¥, cÃ³ láº½ báº¡n khÃ´ng nghÄ© Ä‘áº¿n viá»‡c chuyá»ƒn Ä‘á»•i nhiá»‡m vá»¥ cÃ³ thá»ƒ lÃ  nguá»“n gá»‘c cá»§a cÃ¡c lá»—i ká»³ quÃ¡i trong láº­p trÃ¬nh Ä‘á»“ng thá»i. Thá»i Ä‘iá»ƒm chuyá»ƒn Ä‘á»•i nhiá»‡m vá»¥ thÆ°á»ng lÃ  khi time slice káº¿t thÃºc, chÃºng ta hiá»‡n Ä‘ang sá»­ dá»¥ng ngÃ´n ngá»¯ láº­p trÃ¬nh cáº¥p cao (high level), trong ngÃ´n ngá»¯ láº­p trÃ¬nh cáº¥p cao, má»™t cÃ¢u lá»‡nh thÆ°á»ng cáº§n nhiá»u hÆ¡n má»™t chá»‰ thá»‹ CPU (CPU Instruction) Ä‘á»ƒ hoÃ n thÃ nh, vÃ­ dá»¥ nhÆ°Â <code>count += 1</code>Â trong Ä‘oáº¡n mÃ£ trÃªn, Ã­t nháº¥t cáº§n ba chá»‰ thá»‹ CPU.</p><ul><li>Chá»‰ thá»‹ 1: Äáº§u tiÃªn, cáº§n táº£i biáº¿n count tá»« bá»™ nhá»› vÃ o thanh ghi CPU;</li><li>Chá»‰ thá»‹ 2: Sau Ä‘Ã³, thá»±c hiá»‡n phÃ©p cá»™ng 1 trong thanh ghi;</li><li>Chá»‰ thá»‹ 3: Cuá»‘i cÃ¹ng, ghi káº¿t quáº£ tá»« thanh ghi vÃ o bá»™ nhá»› (do cÆ¡ cháº¿ bá»™ nhá»› cache, cÃ³ thá»ƒ ghi vÃ o bá»™ nhá»› cache CPU chá»© khÃ´ng pháº£i bá»™ nhá»›).</li></ul><p>Há»‡ Ä‘iá»u hÃ nh thá»±c hiá»‡n viá»‡c chuyá»ƒn Ä‘á»•i nhiá»‡m vá»¥ cÃ³ thá»ƒ xáº£y ra sau khi má»™t chá»‰ thá»‹ <strong>CPU</strong> Ä‘Æ°á»£c thá»±c thi, Ä‘Ãºng váº­y, lÃ  chá»‰ thá»‹ CPU chá»© khÃ´ng pháº£i cÃ¢u lá»‡nh trong ngÃ´n ngá»¯ cáº¥p cao. Äá»‘i vá»›i ba chá»‰ thá»‹ trÃªn, giáº£ sá»­ count=0, náº¿u luá»“ng A chuyá»ƒn Ä‘á»•i sau khi hoÃ n thÃ nh chá»‰ thá»‹ 1 vÃ  tiáº¿p tá»¥c theo chuá»—i nhÆ° hÃ¬nh dÆ°á»›i Ä‘Ã¢y, ta sáº½ nháº­n ra cáº£ hai luá»“ng Ä‘Ã£ thá»±c hiá»‡n phÃ©p toÃ¡n count+=1, tuy nhiÃªn káº¿t quáº£ thu Ä‘Æ°á»£c khÃ´ng pháº£i lÃ  2 nhÆ° mong muá»‘n mÃ  láº¡i lÃ  1.</p><p align="center"><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/Drawing 2023-07-16 13.53.50.excalidraw.png"></p><p>Tiá»m thá»©c cá»§a chÃºng ta cho ráº±ng hoáº¡t Ä‘á»™ngÂ <code>count += 1</code>Â lÃ  má»™t thao tÃ¡c khÃ´ng thá»ƒ chia tÃ¡ch, giá»‘ng nhÆ° má»™t nguyÃªn tá»­, viá»‡c chuyá»ƒn Ä‘á»•i luá»“ng cÃ³ thá»ƒ xáº£y ra trÆ°á»›c khiÂ <code>count += 1</code>, hoáº·c sau khiÂ <code>count += 1</code>, nhÆ°ng khÃ´ng bao giá» xáº£y ra á»Ÿ giá»¯a.Â <strong>ChÃºng ta gá»i tÃ­nh cháº¥t mÃ  má»™t hoáº·c nhiá»u hoáº¡t Ä‘á»™ng khÃ´ng bá»‹ giÃ¡n Ä‘oáº¡n trong quÃ¡ trÃ¬nh CPU thá»±c hiá»‡n lÃ  tÃ­nh nguyÃªn tá»­ (Atomicity)</strong>. CÃ¡c hoáº¡t Ä‘á»™ng nguyÃªn tá»­ mÃ  CPU Ä‘áº£m báº£o lÃ  cáº¥p Ä‘á»™ chá»‰ thá»‹ CPU, khÃ´ng pháº£i toÃ¡n tá»­ trong ngÃ´n ngá»¯ láº­p trÃ¬nh cáº¥p cao, Ä‘Ã¢y lÃ  Ä‘iá»u mÃ  chÃºng ta khÃ´ng thá»ƒ hiá»ƒu Ä‘Æ°á»£c. Do Ä‘Ã³, trong nhiá»u trÆ°á»ng há»£p, chÃºng ta cáº§n Ä‘áº£m báº£o tÃ­nh nguyÃªn tá»­ cá»§a hoáº¡t Ä‘á»™ng á»Ÿ má»©c ngÃ´n ngá»¯ láº­p trÃ¬nh cao cáº¥p.</p><h3 id="van-Ä‘e-ve-thu-tu-do-toi-uu-hoa-bien-dich" tabindex="-1"><a class="header-anchor" href="#van-Ä‘e-ve-thu-tu-do-toi-uu-hoa-bien-dich"><span>Váº¥n Ä‘á» vá» thá»© tá»± do tá»‘i Æ°u hÃ³a biÃªn dá»‹ch</span></a></h3><p>Váº­y trong láº­p trÃ¬nh Ä‘á»“ng thá»i cÃ²n cÃ³ cÃ¡c ká»¹ thuáº­t khÃ¡c cÃ³ thá»ƒ vi pháº¡m trá»±c giÃ¡c vÃ  dáº«n Ä‘áº¿n cÃ¡c lá»—i ká»³ quÃ¡i khÃ´ng? CÃ³, Ä‘Ã³ lÃ  tÃ­nh tuÃ¢n thá»§ thá»© tá»±. NhÆ° tÃªn gá»i, tÃ­nh tuÃ¢n thá»§ thá»© tá»± Ä‘á» cáº­p Ä‘áº¿n viá»‡c chÆ°Æ¡ng trÃ¬nh thá»±c thi theo thá»© tá»± cÃ¡c cÃ¢u lá»‡nh trong mÃ£ nguá»“n. Äá»ƒ tá»‘i Æ°u hiá»‡u suáº¥t, trÃ¬nh biÃªn dá»‹ch Ä‘Ã´i khi sáº½ thay Ä‘á»•i thá»© tá»± cÃ¡c cÃ¢u lá»‡nh trong chÆ°Æ¡ng trÃ¬nh, vÃ­ dá»¥: trong chÆ°Æ¡ng trÃ¬nh <code>a = 6; b = 7;</code>, trÃ¬nh biÃªn dá»‹ch cÃ³ thá»ƒ tá»‘i Æ°u thÃ nh <code>b = 7; a = 6;</code>, trong vÃ­ dá»¥ nÃ y, trÃ¬nh biÃªn dá»‹ch Ä‘Ã£ thay Ä‘á»•i thá»© tá»± cÃ¡c cÃ¢u lá»‡nh nhÆ°ng khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n káº¿t quáº£ cuá»‘i cÃ¹ng cá»§a chÆ°Æ¡ng trÃ¬nh. Tuy nhiÃªn, Ä‘Ã´i khi tá»‘i Æ°u hÃ³a cá»§a trÃ¬nh biÃªn dá»‹ch vÃ  trÃ¬nh thÃ´ng dá»‹ch cÃ³ thá»ƒ dáº«n Ä‘áº¿n cÃ¡c lá»—i khÃ´ng mong muá»‘n.</p><p>Trong Java, má»™t vÃ­ dá»¥ cá»• Ä‘iá»ƒn lÃ  sá»­ dá»¥ng kiá»ƒm tra kÃ©p Ä‘á»ƒ táº¡o Ä‘á»‘i tÆ°á»£ng duy nháº¥t, vÃ­ dá»¥ mÃ£ sau: trong phÆ°Æ¡ng thá»©c getInstance() Ä‘á»ƒ láº¥y má»™t thá»ƒ hiá»‡n, chÃºng ta kiá»ƒm tra xem instance cÃ³ null khÃ´ng, náº¿u cÃ³, chÃºng ta sáº½ khÃ³a Singleton.class vÃ  kiá»ƒm tra láº¡i xem instance cÃ³ null khÃ´ng, náº¿u váº«n null, chÃºng ta sáº½ táº¡o má»™t thá»ƒ hiá»‡n cá»§a Singleton.</p><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Singleton</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">  static</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Singleton</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> instance</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">  static</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Singleton</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> getInstance</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(){</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (instance </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">==</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">      synchronized</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Singleton</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">class</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (instance </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">==</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">          instance </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> Singleton</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    return</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> instance;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><p>Giáº£ sá»­ cÃ³ hai luá»“ng A vÃ  B cÃ¹ng gá»i phÆ°Æ¡ng thá»©c getInstance(), cáº£ hai Ä‘á»u nháº­n tháº¥yÂ <code>instance == null</code>, sau Ä‘Ã³ cáº£ hai Ä‘á»u khÃ³a Singleton.class, táº¡i thá»i Ä‘iá»ƒm nÃ y JVM Ä‘áº£m báº£o chá»‰ cÃ³ má»™t luá»“ng cÃ³ thá»ƒ khÃ³a thÃ nh cÃ´ng (giáº£ sá»­ lÃ  luá»“ng A), luá»“ng cÃ²n láº¡i sáº½ á»Ÿ tráº¡ng thÃ¡i chá» (giáº£ sá»­ lÃ  luá»“ng B); luá»“ng A sáº½ táº¡o má»™t thá»ƒ hiá»‡n Singleton, sau Ä‘Ã³ giáº£i phÃ³ng khÃ³a, sau khi giáº£i phÃ³ng khÃ³a, luá»“ng B Ä‘Æ°á»£c Ä‘Ã¡nh thá»©c, luá»“ng B sáº½ thá»­ khÃ³a vÃ  láº§n nÃ y sáº½ thÃ nh cÃ´ng, sau khi khÃ³a thÃ nh cÃ´ng, luá»“ng B kiá»ƒm traÂ <code>instance == null</code>Â vÃ  nháº­n tháº¥y Ä‘Ã£ táº¡o má»™t thá»ƒ hiá»‡n cá»§a Singleton, vÃ¬ váº­y luá»“ng B sáº½ khÃ´ng táº¡o má»™t thá»ƒ hiá»‡n Singleton ná»¯a.</p><p>Äiá»u gÃ¬ khÃ´ng hoÃ n háº£o trong phÆ°Æ¡ng thá»©c getInstance() nÃ y? Váº¥n Ä‘á» náº±m á»Ÿ phÃ©p toÃ¡n new, chÃºng ta nghÄ© ráº±ng phÃ©p toÃ¡n new sáº½ lÃ m nhÆ° sau:</p><ol><li>Cáº¥p phÃ¡t má»™t khá»‘i bá»™ nhá»› M;</li><li>Khá»Ÿi táº¡o Ä‘á»‘i tÆ°á»£ng Singleton trÃªn bá»™ nhá»› M;</li><li>GÃ¡n Ä‘á»‹a chá»‰ M cho biáº¿n instance.</li></ol><p>Tuy nhiÃªn, thá»±c táº¿ Ä‘Æ°á»ng Ä‘i thá»±c thi tá»‘i Æ°u hÃ³a láº¡i nhÆ° sau:</p><ol><li>Cáº¥p phÃ¡t má»™t khá»‘i bá»™ nhá»› M;</li><li>GÃ¡n Ä‘á»‹a chá»‰ M cho biáº¿n instance;</li><li>Cuá»‘i cÃ¹ng, khá»Ÿi táº¡o Ä‘á»‘i tÆ°á»£ng Singleton trÃªn bá»™ nhá»› M.</li></ol><p>Tá»‘i Æ°u hÃ³a nÃ y sáº½ gÃ¢y ra váº¥n Ä‘á» gÃ¬? Giáº£ sá»­ luá»“ng A thá»±c hiá»‡n trÆ°á»›c phÆ°Æ¡ng thá»©c getInstance(), khi thá»±c hiá»‡n xong chá»‰ thá»‹ 2 thÃ¬ xáº£y ra chuyá»ƒn Ä‘á»•i luá»“ng, chuyá»ƒn Ä‘á»•i sang luá»“ng B; náº¿u lÃºc nÃ y luá»“ng B cÅ©ng thá»±c hiá»‡n phÆ°Æ¡ng thá»©c getInstance(), thÃ¬ khi thá»±c hiá»‡n kiá»ƒm tra Ä‘áº§u tiÃªn, luá»“ng B sáº½ nháº­n tháº¥yÂ <code>instance != null</code>, vÃ¬ váº­y nÃ³ sáº½ tráº£ vá» instance, nhÆ°ng lÃºc nÃ y instance chÆ°a Ä‘Æ°á»£c khá»Ÿi táº¡o, náº¿u chÃºng ta truy cáº­p vÃ o biáº¿n thÃ nh viÃªn cá»§a instance, cÃ³ thá»ƒ gÃ¢y ra <code>NullPointerException</code>.</p><p align="center"><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/Drawing 2023-07-16 14.20.26.excalidraw.png"></p><h3 id="cac-phuong-phap-Ä‘am-bao-an-toan-Ä‘ong-thoi" tabindex="-1"><a class="header-anchor" href="#cac-phuong-phap-Ä‘am-bao-an-toan-Ä‘ong-thoi"><span>CÃ¡c phÆ°Æ¡ng phÃ¡p Ä‘áº£m báº£o an toÃ n Ä‘á»“ng thá»i</span></a></h3><h4 id="Ä‘ong-bo-hoa-mutex-Ä‘ong-bo-hoa-chan" tabindex="-1"><a class="header-anchor" href="#Ä‘ong-bo-hoa-mutex-Ä‘ong-bo-hoa-chan"><span>Äá»“ng bá»™ hÃ³a Mutex (Äá»“ng bá»™ hÃ³a cháº·n)</span></a></h4><p>Äá»“ng bá»™ hÃ³a Mutex lÃ  biá»‡n phÃ¡p báº£o Ä‘áº£m an toÃ n Ä‘á»“ng thá»i phá»• biáº¿n nháº¥t.</p><p><strong>Äá»“ng bá»™ hÃ³a Ä‘á» cáº­p Ä‘áº¿n viá»‡c Ä‘áº£m báº£o ráº±ng dá»¯ liá»‡u chia sáº» chá»‰ Ä‘Æ°á»£c truy cáº­p bá»Ÿi má»™t luá»“ng duy nháº¥t trong cÃ¹ng má»™t thá»i Ä‘iá»ƒm</strong>.</p><p>Äá»“ng bá»™ hÃ³a lÃ  má»™t phÆ°Æ¡ng phÃ¡p Ä‘á»ƒ thá»±c hiá»‡n Ä‘á»“ng bá»™. Critical Sections (VÃ¹ng quan trá»ng), Mutex vÃ  bá»™ Semaphore lÃ  cÃ¡c cÃ¡ch chÃ­nh Ä‘á»ƒ thá»±c hiá»‡n Ä‘á»“ng bá»™.</p><p>VÃ­ dá»¥ Ä‘iá»ƒn hÃ¬nh lÃ  sá»­ dá»¥ng <code>synchronized</code> hoáº·c <code>Lock</code>.</p><p><strong>Váº¥n Ä‘á» chÃ­nh cá»§a Ä‘á»“ng bá»™ hÃ³a mutex lÃ  hiá»‡u suáº¥t bá»‹ áº£nh hÆ°á»Ÿng bá»Ÿi viá»‡c cháº·n vÃ  Ä‘Ã¡nh thá»©c luá»“ng</strong>. Äá»“ng bá»™ hÃ³a mutex thuá»™c vá» má»™t chiáº¿n lÆ°á»£c Ä‘á»“ng thá»i bi quan, luÃ´n cho ráº±ng náº¿u khÃ´ng thá»±c hiá»‡n biá»‡n phÃ¡p Ä‘á»“ng bá»™ há»£p lÃ½, sáº½ xáº£y ra váº¥n Ä‘á». DÃ¹ cÃ³ cáº¡nh tranh dá»¯ liá»‡u chia sáº» hay khÃ´ng, nÃ³ váº«n pháº£i thá»±c hiá»‡n khÃ³a (trong mÃ´ hÃ¬nh khÃ¡i niá»‡m nÃ y, mÃ¡y áº£o sáº½ tá»‘i Æ°u hÃ³a má»™t pháº§n lá»›n khÃ³a khÃ´ng cáº§n thiáº¿t), chuyá»ƒn Ä‘á»•i giá»¯a cháº¿ Ä‘á»™ ngÆ°á»i dÃ¹ng vÃ  cháº¿ Ä‘á»™ kernel, duy trÃ¬ bá»™ Ä‘áº¿m khÃ³a vÃ  kiá»ƒm tra xem cÃ³ luá»“ng bá»‹ cháº·n cáº§n Ä‘Æ°á»£c Ä‘Ã¡nh thá»©c hay khÃ´ng.</p><h4 id="Ä‘ong-bo-hoa-khong-chan" tabindex="-1"><a class="header-anchor" href="#Ä‘ong-bo-hoa-khong-chan"><span>Äá»“ng bá»™ hÃ³a khÃ´ng cháº·n</span></a></h4><p>Vá»›i sá»± phÃ¡t triá»ƒn cá»§a táº­p lá»‡nh pháº§n cá»©ng, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng chiáº¿n lÆ°á»£c Ä‘á»“ng thá»i láº¡c quan dá»±a trÃªn phÃ¡t hiá»‡n xung Ä‘á»™t: thá»±c hiá»‡n hoáº¡t Ä‘á»™ng trÆ°á»›c, náº¿u khÃ´ng cÃ³ luá»“ng khÃ¡c cáº¡nh tranh vá»›i dá»¯ liá»‡u chia sáº», thÃ¬ hoáº¡t Ä‘á»™ng sáº½ thÃ nh cÃ´ng, náº¿u khÃ´ng, thÃ¬ thá»±c hiá»‡n biá»‡n phÃ¡p bÃ¹ (láº·p láº¡i liÃªn tá»¥c cho Ä‘áº¿n khi thÃ nh cÃ´ng). Äiá»u nÃ y Ä‘Æ°á»£c gá»i lÃ  chiáº¿n lÆ°á»£c Ä‘á»“ng thá»i láº¡c quan khÃ´ng cháº·n.</p><p>Tuy nhiÃªn, Ä‘á»ƒ thá»±c hiá»‡n chiáº¿n lÆ°á»£c Ä‘á»“ng thá»i láº¡c quan, cáº§n sá»± phÃ¡t triá»ƒn cá»§a bá»™ chá»‰ thá»‹ pháº§n cá»©ng. Cáº§n cÃ³ tÃ­nh nguyÃªn tá»­ trong quÃ¡ trÃ¬nh thá»±c hiá»‡n cÃ¡c hoáº¡t Ä‘á»™ng vÃ  phÃ¡t hiá»‡n xung Ä‘á»™t. Äiá»u nÃ y do pháº§n cá»©ng thá»±c hiá»‡n, náº¿u sá»­ dá»¥ng Ä‘á»“ng bá»™ hÃ³a Ä‘á»ƒ Ä‘áº£m báº£o, nÃ³ sáº½ máº¥t Ä‘i Ã½ nghÄ©a.</p><p>CÃ¡c chá»‰ thá»‹ khÃ³a láº¡c quan phá»• biáº¿n bao gá»“m:</p><ul><li>Kiá»ƒm tra vÃ  Ä‘áº·t (Test-and-Set)</li><li>Láº¥y vÃ  tÄƒng (Fetch-and-Increment)</li><li>Trao Ä‘á»•i (Swap)</li><li>So sÃ¡nh vÃ  trao Ä‘á»•i (CAS)</li><li>Táº£i - liÃªn káº¿t, lÆ°u trá»¯ - Ä‘iá»u kiá»‡n (Load-linked / Store-Conditional)</li></ul><p>á»¨ng dá»¥ng Ä‘iá»ƒn hÃ¬nh trong Java: CÃ¡c lá»›p nguyÃªn tá»­ trong gÃ³i J.U.C (dá»±a trÃªn hoáº¡t Ä‘á»™ng CAS cá»§a lá»›pÂ <code>Unsafe</code>).</p><h4 id="khong-Ä‘ong-bo" tabindex="-1"><a class="header-anchor" href="#khong-Ä‘ong-bo"><span>KhÃ´ng Ä‘á»“ng bá»™</span></a></h4><p>Äá»ƒ Ä‘áº£m báº£o an toÃ n Ä‘á»“ng thá»i, khÃ´ng nháº¥t thiáº¿t pháº£i Ä‘á»“ng bá»™ hÃ³a. Äá»“ng bá»™ chá»‰ Ä‘áº£m báº£o tÃ­nh chÃ­nh xÃ¡c khi cÃ³ cáº¡nh tranh dá»¯ liá»‡u chia sáº», náº¿u má»™t phÆ°Æ¡ng thá»©c khÃ´ng liÃªn quan Ä‘áº¿n dá»¯ liá»‡u chia sáº», thÃ¬ khÃ´ng cáº§n Ä‘á»“ng bá»™.</p><p>CÃ¡c phÆ°Æ¡ng phÃ¡p <strong>khÃ´ng Ä‘á»“ng bá»™</strong> trong Java bao gá»“m:</p><ul><li>MÃ£ cÃ³ thá»ƒ láº·p láº¡i - cÃ²n Ä‘Æ°á»£c gá»i lÃ  mÃ£ thuáº§n tÃºy. Náº¿u má»™t phÆ°Æ¡ng thá»©c cÃ³ thá»ƒ dá»± Ä‘oÃ¡n Ä‘Æ°á»£c káº¿t quáº£, tá»©c lÃ  chá»‰ cáº§n cÃ¹ng má»™t dá»¯ liá»‡u Ä‘áº§u vÃ o, nÃ³ sáº½ tráº£ vá» cÃ¹ng má»™t káº¿t quáº£, thÃ¬ nÃ³ Ä‘Ã¡p á»©ng tÃ­nh cháº¥t cÃ³ thá»ƒ láº·p láº¡i vÃ  tá»± nhiÃªn lÃ  an toÃ n Ä‘á»“ng thá»i.</li><li>LÆ°u trá»¯ cá»¥c bá»™ cá»§a luá»“ng - sá»­ dá»¥ng <code>ThreadLocal</code> Ä‘á»ƒ táº¡o má»™t báº£n sao cá»¥c bá»™ cá»§a biáº¿n chia sáº» cho má»—i luá»“ng, báº£n sao nÃ y chá»‰ cÃ³ thá»ƒ Ä‘Æ°á»£c truy cáº­p bá»Ÿi luá»“ng hiá»‡n táº¡i, cÃ¡c luá»“ng khÃ¡c khÃ´ng thá»ƒ truy cáº­p, do Ä‘Ã³ nÃ³ tá»± nhiÃªn lÃ  an toÃ n Ä‘á»“ng thá»i.</li></ul><h2 id="van-Ä‘e-ve-tinh-hoat-Ä‘ong" tabindex="-1"><a class="header-anchor" href="#van-Ä‘e-ve-tinh-hoat-Ä‘ong"><span>Váº¥n Ä‘á» vá» tÃ­nh hoáº¡t Ä‘á»™ng</span></a></h2><h3 id="deadlock" tabindex="-1"><a class="header-anchor" href="#deadlock"><span>Deadlock</span></a></h3><h4 id="deadlock-la-gi" tabindex="-1"><a class="header-anchor" href="#deadlock-la-gi"><span>Deadlock lÃ  gÃ¬?</span></a></h4><p>Deadlock xáº£y ra khi nhiá»u luá»“ng Ä‘ang chá» Ä‘á»£i láº«n nhau Ä‘á»ƒ giáº£i phÃ³ng khÃ³a.</p><p>Deadlock xáº£y ra khi má»™t luá»“ng bá»‹ cháº·n vÃ´ thá»i háº¡n vÃ¬ khÃ³a mÃ  nÃ³ yÃªu cáº§u Ä‘ang Ä‘Æ°á»£c má»™t luá»“ng khÃ¡c náº¯m giá»¯, vÃ  luá»“ng Ä‘Ã³ láº¡i Ä‘ang chá» Ä‘á»£i luá»“ng ban Ä‘áº§u giáº£i phÃ³ng má»™t khÃ³a khÃ¡c.</p><p align="center"><img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/java/javacore/concurrent/deadlock.png"></p><h4 id="tranh-deadlock" tabindex="-1"><a class="header-anchor" href="#tranh-deadlock"><span>TrÃ¡nh Deadlock</span></a></h4><p>(1) Sáº¯p xáº¿p khÃ³a theo thá»© tá»±</p><p>Khi nhiá»u luá»“ng cáº§n cÃ¹ng má»™t sá»‘ khÃ³a, nhÆ°ng láº¡i Ä‘Æ°á»£c khÃ³a theo thá»© tá»± khÃ¡c nhau, Deadlock ráº¥t dá»… xáº£y ra.</p><p>Náº¿u cÃ³ thá»ƒ Ä‘áº£m báº£o táº¥t cáº£ cÃ¡c luá»“ng Ä‘á»u nháº­n Ä‘Æ°á»£c cÃ¡c khÃ³a theo cÃ¹ng má»™t thá»© tá»±, thÃ¬ Deadlock sáº½ khÃ´ng xáº£y ra.</p><p>Sáº¯p xáº¿p khÃ³a theo thá»© tá»± lÃ  má»™t cÃ¡ch hiá»‡u quáº£ Ä‘á»ƒ trÃ¡nh Deadlock. Tuy nhiÃªn, cÃ¡ch nÃ y yÃªu cáº§u báº¡n biáº¿t trÆ°á»›c táº¥t cáº£ cÃ¡c khÃ³a cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng (chÃº Ã½: vÃ  sáº¯p xáº¿p chÃºng theo Ä‘Ãºng thá»© tá»±), nhÆ°ng Ä‘Ã´i khi khÃ´ng thá»ƒ dá»± Ä‘oÃ¡n Ä‘Æ°á»£c.</p><p>(2) Giáº£i phÃ³ng khÃ³a sau má»™t khoáº£ng thá»i gian</p><p>Má»™t cÃ¡ch khÃ¡c Ä‘á»ƒ trÃ¡nh Deadlock lÃ  thÃªm thá»i gian chá» (timeout) khi cá»‘ gáº¯ng láº¥y khÃ³a. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  náº¿u má»™t luá»“ng khÃ´ng thá»ƒ láº¥y Ä‘Æ°á»£c táº¥t cáº£ cÃ¡c khÃ³a cáº§n thiáº¿t trong khoáº£ng thá»i gian Ä‘Ã£ cho, nÃ³ sáº½ tá»« bá» yÃªu cáº§u khÃ³a Ä‘Ã³. Náº¿u má»™t luá»“ng khÃ´ng thÃ nh cÃ´ng trong viá»‡c nháº­n táº¥t cáº£ cÃ¡c khÃ³a cáº§n thiáº¿t trong thá»i gian Ä‘Ã£ cho, nÃ³ sáº½ quay láº¡i vÃ  giáº£i phÃ³ng táº¥t cáº£ cÃ¡c khÃ³a Ä‘Ã£ nháº­n Ä‘Æ°á»£c, sau Ä‘Ã³ chá» má»™t khoáº£ng thá»i gian ngáº«u nhiÃªn trÆ°á»›c khi thá»­ láº¡i. Thá»i gian chá» ngáº«u nhiÃªn nÃ y cho phÃ©p cÃ¡c luá»“ng khÃ¡c cÃ³ cÆ¡ há»™i thá»­ láº¥y cÃ¡c khÃ³a tÆ°Æ¡ng tá»± vÃ  cho phÃ©p á»©ng dá»¥ng tiáº¿p tá»¥c cháº¡y khi khÃ´ng láº¥y Ä‘Æ°á»£c khÃ³a (Quay láº¡i vÃ  láº·p láº¡i logic cá»§a khÃ³a trÆ°á»›c Ä‘Ã³).</p><p>(3) Kiá»ƒm tra Deadlock</p><p>Kiá»ƒm tra Deadlock lÃ  má»™t cÆ¡ cháº¿ phÃ²ng ngá»«a Deadlock tá»‘t hÆ¡n, chá»§ yáº¿u Ã¡p dá»¥ng cho cÃ¡c tÃ¬nh huá»‘ng khÃ´ng thá»ƒ thá»±c hiá»‡n viá»‡c sáº¯p xáº¿p khÃ³a theo thá»© tá»± vÃ  khÃ´ng thá»ƒ sá»­ dá»¥ng thá»i gian chá» khÃ³a.</p><p>Má»—i khi má»™t luá»“ng nháº­n Ä‘Æ°á»£c má»™t khÃ³a, nÃ³ sáº½ ghi láº¡i thÃ´ng tin liÃªn quan Ä‘áº¿n luá»“ng vÃ  khÃ³a trong cáº¥u trÃºc dá»¯ liá»‡u liÃªn quan (báº£ng bÄƒm, Ä‘á»“ thá»‹, v.v.). NgoÃ i ra, má»—i khi má»™t luá»“ng yÃªu cáº§u khÃ³a, nÃ³ cÅ©ng cáº§n Ä‘Æ°á»£c ghi láº¡i trong cáº¥u trÃºc dá»¯ liá»‡u nÃ y.</p><p>Khi má»™t luá»“ng khÃ´ng thÃ nh cÃ´ng trong viá»‡c yÃªu cáº§u khÃ³a, nÃ³ cÃ³ thá»ƒ duyá»‡t qua Ä‘á»“ thá»‹ khÃ³a Ä‘á»ƒ kiá»ƒm tra xem cÃ³ xáº£y ra Deadlock khÃ´ng.</p><p>Náº¿u phÃ¡t hiá»‡n Deadlock, cÃ³ hai cÃ¡ch xá»­ lÃ½:</p><ul><li>Giáº£i phÃ³ng táº¥t cáº£ cÃ¡c khÃ³a, quay láº¡i vÃ  chá» má»™t khoáº£ng thá»i gian ngáº«u nhiÃªn trÆ°á»›c khi thá»­ láº¡i. Äiá»u nÃ y tÆ°Æ¡ng tá»± nhÆ° viá»‡c thÃªm thá»i gian chá» khi yÃªu cáº§u khÃ³a, nhÆ°ng chá»‰ thá»±c hiá»‡n khi Deadlock Ä‘Ã£ xáº£y ra, chá»© khÃ´ng pháº£i do yÃªu cáº§u khÃ³a vÆ°á»£t quÃ¡ thá»i gian chá». Máº·c dÃ¹ cÃ³ thá»i gian chá» vÃ  quay láº¡i, nhÆ°ng náº¿u cÃ³ nhiá»u luá»“ng cáº¡nh tranh cÃ¹ng má»™t sá»‘ lÆ°á»£ng lá»›n khÃ³a, chÃºng váº«n cÃ³ thá»ƒ Deadlock láº·p láº¡i.</li><li>Má»™t giáº£i phÃ¡p tá»‘t hÆ¡n lÃ  Ä‘áº·t Ä‘á»™ Æ°u tiÃªn cho cÃ¡c luá»“ng nÃ y, cho phÃ©p má»™t (hoáº·c má»™t sá»‘) luá»“ng quay láº¡i, trong khi cÃ¡c luá»“ng cÃ²n láº¡i tiáº¿p tá»¥c giá»¯ cÃ¡c khÃ³a cáº§n thiáº¿t nhÆ° khÃ´ng cÃ³ Deadlock. Náº¿u cÃ¡c luá»“ng Ä‘Æ°á»£c gÃ¡n cÃ¹ng má»™t Ä‘á»™ Æ°u tiÃªn khÃ´ng thay Ä‘á»•i, cÃ¹ng má»™t nhÃ³m luá»“ng sáº½ luÃ´n cÃ³ Ä‘á»™ Æ°u tiÃªn cao hÆ¡n. Äá»ƒ trÃ¡nh váº¥n Ä‘á» nÃ y, báº¡n cÃ³ thá»ƒ Ä‘áº·t Ä‘á»™ Æ°u tiÃªn ngáº«u nhiÃªn khi Deadlock xáº£y ra.</li></ul><h3 id="livelock" tabindex="-1"><a class="header-anchor" href="#livelock"><span>Livelock</span></a></h3><h4 id="livelock-la-gi" tabindex="-1"><a class="header-anchor" href="#livelock-la-gi"><span>Livelock lÃ  gÃ¬</span></a></h4><p>Livelock lÃ  má»™t tÃ¬nh huá»‘ng láº·p Ä‘i láº·p láº¡i, hai hoáº·c nhiá»u luá»“ng sáº½ liÃªn tá»¥c láº·p láº¡i má»™t Ä‘oáº¡n mÃ£ cá»¥ thá»ƒ. MÃ£ dá»± kiáº¿n â€‹â€‹sáº½ cung cáº¥p cÆ¡ há»™i cho cÃ¡c luá»“ng khÃ¡c tiáº¿p tá»¥c há»— trá»£ luá»“ng hiá»‡n táº¡i.</p><p>HÃ£y tÆ°á»Ÿng tÆ°á»£ng má»™t vÃ­ dá»¥ nhÆ° sau: hai ngÆ°á»i gáº·p nhau trong má»™t hÃ nh lang háº¹p, cáº£ hai Ä‘á»u lá»‹ch sá»± vÃ  cá»‘ gáº¯ng di chuyá»ƒn sang má»™t bÃªn Ä‘á»ƒ Ä‘á»ƒ ngÆ°á»i kia Ä‘i trÆ°á»›c. NhÆ°ng cuá»‘i cÃ¹ng, há» váº«n tiáº¿p tá»¥c dao Ä‘á»™ng sang trÃ¡i vÃ  pháº£i vÃ¬ cáº£ hai Ä‘á»u di chuyá»ƒn cÃ¹ng má»™t hÆ°á»›ng cÃ¹ng má»™t lÃºc.</p><p align="center"><img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/java/javacore/concurrent/livelock.png"></p><p>NhÆ° hÃ¬nh minh há»a: hai luá»“ng muá»‘n truy cáº­p vÃ otÃ i nguyÃªn chung Ä‘Æ°á»£c chia sáº» thÃ´ng qua Ä‘á»‘i tÆ°á»£ng Worker, nhÆ°ng khi há» tháº¥y Worker khÃ¡c (gá»i trÃªn má»™t luá»“ng khÃ¡c) cÅ©ng &quot;hoáº¡t Ä‘á»™ng&quot;, há» sáº½ cá»‘ gáº¯ng chuyá»ƒn giao tÃ i nguyÃªn Ä‘Ã³ cho ngÆ°á»i khÃ¡c vÃ  chá» cho nÃ³ káº¿t thÃºc. Náº¿u ban Ä‘áº§u chÃºng ta lÃ m cho cáº£ hai Worker Ä‘á»u &quot;hoáº¡t Ä‘á»™ng&quot;, chÃºng sáº½ gáº·p váº¥n Ä‘á» vá» Livelock.</p><h4 id="tranh-livelock" tabindex="-1"><a class="header-anchor" href="#tranh-livelock"><span>TrÃ¡nh Livelock</span></a></h4><p>Giáº£i quyáº¿t váº¥n Ä‘á» &quot;Livelock&quot; khÃ¡ Ä‘Æ¡n giáº£n, chá»‰ cáº§n nhÆ°á»ng Ä‘Æ°á»ng vÃ  chá» má»™t khoáº£ng thá»i gian ngáº«u nhiÃªn. VÃ¬ thá»i gian chá» lÃ  ngáº«u nhiÃªn, nÃªn kháº£ nÄƒng xáº£y ra va cháº¡m láº§n thá»© hai sau khi Ä‘Ã£ xáº£y ra va cháº¡m láº§n Ä‘áº§u tiÃªn lÃ  ráº¥t tháº¥p. PhÆ°Æ¡ng phÃ¡p &quot;chá» má»™t khoáº£ng thá»i gian ngáº«u nhiÃªn&quot; máº·c dÃ¹ Ä‘Æ¡n giáº£n, nhÆ°ng ráº¥t hiá»‡u quáº£, tháº­m chÃ­ cÃ²n Ä‘Æ°á»£c sá»­ dá»¥ng trong cÃ¡c thuáº­t toÃ¡n ná»•i tiáº¿ng vá» Ä‘á»“ng thuáº­n phÃ¢n tÃ¡n nhÆ° Raft.</p><h3 id="Ä‘oi-starvation" tabindex="-1"><a class="header-anchor" href="#Ä‘oi-starvation"><span>ÄÃ³i (Starvation)</span></a></h3><h4 id="Ä‘oi-la-gi" tabindex="-1"><a class="header-anchor" href="#Ä‘oi-la-gi"><span>ÄÃ³i lÃ  gÃ¬</span></a></h4><ul><li>CÃ¡c luá»“ng Æ°u tiÃªn cao chiáº¿m háº¿t thá»i gian CPU cá»§a cÃ¡c luá»“ng Æ°u tiÃªn tháº¥p.</li><li>Luá»“ng bá»‹ cháº·n vÄ©nh viá»…n trong tráº¡ng thÃ¡i chá» Ä‘á»ƒ vÃ o khá»‘i Ä‘á»“ng bá»™, vÃ¬ cÃ¡c luá»“ng khÃ¡c luÃ´n tiáº¿p tá»¥c truy cáº­p vÃ o khá»‘i Ä‘á»“ng bá»™ Ä‘Ã³ trÆ°á»›c.</li><li>Luá»“ng Ä‘ang chá» má»™t Ä‘á»‘i tÆ°á»£ng hoÃ n thÃ nh (gá»i wait() trÃªn Ä‘á»‘i tÆ°á»£ng Ä‘Ã³) cÅ©ng bá»‹ cháº·n vÄ©nh viá»…n, vÃ¬ cÃ¡c luá»“ng khÃ¡c luÃ´n Ä‘Æ°á»£c Ä‘Ã¡nh thá»©c trÆ°á»›c.</li></ul><p align="center"><img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/java/javacore/concurrent/starvation-and-fairness.png"></p><p>VÃ­ dá»¥ kinh Ä‘iá»ƒn vá» váº¥n Ä‘á» Ä‘Ã³i lÃ  váº¥n Ä‘á» cá»§a triáº¿t gia. NhÆ° hÃ¬nh minh há»a: cÃ³ nÄƒm triáº¿t gia Ä‘ang Äƒn, má»—i ngÆ°á»i cáº§n hai cÃ¡i nÄ©a Ä‘á»ƒ Äƒn. Khi 2 vÃ  4 Ä‘ang Äƒn, 1, 3 vÃ  5 sáº½ khÃ´ng bao giá» cÃ³ cÆ¡ há»™i Äƒn, chá»‰ cÃ³ thá»ƒ nhÃ¬n vÃ o mÃ³n Äƒn trÃªn Ä‘Ä©a vÃ  Ä‘Ã³i Ä‘áº¿n cháº¿t.</p><h4 id="giai-quyet-van-Ä‘e-Ä‘oi" tabindex="-1"><a class="header-anchor" href="#giai-quyet-van-Ä‘e-Ä‘oi"><span>Giáº£i quyáº¿t váº¥n Ä‘á» Ä‘Ã³i</span></a></h4><p>Java khÃ´ng thá»ƒ Ä‘áº£m báº£o 100% tÃ­nh cÃ´ng báº±ng, nhÆ°ng chÃºng ta váº«n cÃ³ thá»ƒ cáº£i thiá»‡n tÃ­nh cÃ´ng báº±ng giá»¯a cÃ¡c luá»“ng thÃ´ng qua cáº¥u trÃºc Ä‘á»“ng bá»™ giá»¯a cÃ¡c luá»“ng.</p><p>CÃ³ ba phÆ°Æ¡ng Ã¡n:</p><ul><li>Äáº£m báº£o tÃ i nguyÃªn Ä‘á»§:</li><li>PhÃ¢n phá»‘i tÃ i nguyÃªn má»™t cÃ¡ch cÃ´ng báº±ng:</li><li>TrÃ¡nh luá»“ng giá»¯ khÃ³a trong thá»i gian dÃ i:</li></ul><p>Ba phÆ°Æ¡ng Ã¡n nÃ y, phÆ°Æ¡ng Ã¡n má»™t vÃ  phÆ°Æ¡ng Ã¡n ba cÃ³ giá»›i háº¡n á»©ng dá»¥ng, vÃ¬ trong nhiá»u tÃ¬nh huá»‘ng, khÃ´ng thá»ƒ giáº£i quyáº¿t Ä‘Æ°á»£c sá»± khan hiáº¿m cá»§a tÃ i nguyÃªn hoáº·c giáº£m thá»i gian thá»±c thi cá»§a luá»“ng giá»¯ khÃ³a. PhÆ°Æ¡ng Ã¡n hai cÃ³ á»©ng dá»¥ng tÆ°Æ¡ng Ä‘á»‘i rá»™ng rÃ£i hÆ¡n.</p><p>Váº­y lÃ m tháº¿ nÃ o Ä‘á»ƒ phÃ¢n phá»‘i tÃ i nguyÃªn má»™t cÃ¡ch cÃ´ng báº±ng? Trong láº­p trÃ¬nh Ä‘á»“ng thá»i, chá»§ yáº¿u sá»­ dá»¥ng khÃ³a cÃ´ng báº±ng. KhÃ³a cÃ´ng báº±ng lÃ  má»™t cÆ¡ cháº¿ theo thá»© tá»± Ä‘áº¿n trÆ°á»›c Ä‘áº¿n trÆ°á»›c, viá»‡c chá» Ä‘á»£i cá»§a luá»“ng Ä‘Æ°á»£c sáº¯p xáº¿p theo thá»© tá»±, cÃ¡c luá»“ng á»Ÿ phÃ­a trÆ°á»›c hÃ ng Ä‘á»£i sáº½ Ä‘Æ°á»£c Æ°u tiÃªn nháº­n tÃ i nguyÃªn.</p><h2 id="van-Ä‘e-ve-hieu-suat" tabindex="-1"><a class="header-anchor" href="#van-Ä‘e-ve-hieu-suat"><span>Váº¥n Ä‘á» vá» hiá»‡u suáº¥t</span></a></h2><p>Viá»‡c thá»±c thi Ä‘á»“ng thá»i cÃ³ cháº¯c cháº¯n nhanh hÆ¡n viá»‡c thá»±c thi tuáº§n tá»± khÃ´ng? Sá»‘ luá»“ng cÃ ng nhiá»u thÃ¬ thá»±c thi cÃ ng nhanh?</p><p>CÃ¢u tráº£ lá»i lÃ : <strong>Viá»‡c thá»±c thi Ä‘á»“ng thá»i khÃ´ng cháº¯c cháº¯n nhanh hÆ¡n thá»±c thi tuáº§n tá»±</strong>. Bá»Ÿi vÃ¬ cÃ³ chi phÃ­ táº¡o luá»“ng vÃ  chi phÃ­ chuyá»ƒn Ä‘á»•i ngá»¯ cáº£nh giá»¯a cÃ¡c luá»“ng.</p><h3 id="chuyen-Ä‘oi-ngu-canh-context-switching" tabindex="-1"><a class="header-anchor" href="#chuyen-Ä‘oi-ngu-canh-context-switching"><span>Chuyá»ƒn Ä‘á»•i ngá»¯ cáº£nh (Context Switching)</span></a></h3><h4 id="chuyen-Ä‘oi-ngu-canh-la-gi" tabindex="-1"><a class="header-anchor" href="#chuyen-Ä‘oi-ngu-canh-la-gi"><span>Chuyá»ƒn Ä‘á»•i ngá»¯ cáº£nh lÃ  gÃ¬?</span></a></h4><p>Khi CPU chuyá»ƒn tá»« viá»‡c thá»±c thi má»™t luá»“ng sang viá»‡c thá»±c thi má»™t luá»“ng khÃ¡c, CPU cáº§n lÆ°u trá»¯ tráº¡ng thÃ¡i dá»¯ liá»‡u cá»¥c bá»™, con trá» chÆ°Æ¡ng trÃ¬nh vÃ  cÃ¡c tráº¡ng thÃ¡i khÃ¡c cá»§a luá»“ng hiá»‡n táº¡i vÃ  táº£i dá»¯ liá»‡u cá»¥c bá»™, con trá» chÆ°Æ¡ng trÃ¬nh vÃ  cÃ¡c tráº¡ng thÃ¡i khÃ¡c cá»§a luá»“ng tiáº¿p theo cáº§n thá»±c thi. QuÃ¡ trÃ¬nh nÃ y Ä‘Æ°á»£c gá»i lÃ  &quot;chuyá»ƒn Ä‘á»•i ngá»¯ cáº£nh&quot;.</p><h4 id="cach-giam-thieu-chuyen-Ä‘oi-ngu-canh" tabindex="-1"><a class="header-anchor" href="#cach-giam-thieu-chuyen-Ä‘oi-ngu-canh"><span>CÃ¡ch giáº£m thiá»ƒu chuyá»ƒn Ä‘á»•i ngá»¯ cáº£nh</span></a></h4><ul><li>Láº­p trÃ¬nh khÃ´ng khÃ³a - Khi nhiá»u luá»“ng cáº¡nh tranh vá»›i nhau Ä‘á»ƒ giÃ nh khÃ³a, sáº½ gÃ¢y ra chuyá»ƒn Ä‘á»•i ngá»¯ cáº£nh. VÃ¬ váº­y, khi xá»­ lÃ½ dá»¯ liá»‡u Ä‘a luá»“ng, cÃ³ thá»ƒ trÃ¡nh sá»­ dá»¥ng khÃ³a báº±ng cÃ¡ch chia dá»¯ liá»‡u thÃ nh cÃ¡c phÃ¢n Ä‘oáº¡n theo thuáº­t toÃ¡n bÄƒm vÃ  xá»­ lÃ½ cÃ¡c phÃ¢n Ä‘oáº¡n khÃ¡c nhau trong cÃ¡c luá»“ng khÃ¡c nhau.</li><li>Thuáº­t toÃ¡n CAS - GÃ³i Atomic cá»§a Java sá»­ dá»¥ng thuáº­t toÃ¡n CAS Ä‘á»ƒ cáº­p nháº­t dá»¯ liá»‡u mÃ  khÃ´ng cáº§n khÃ³a.</li><li>Sá»­ dá»¥ng Ã­t luá»“ng nháº¥t cÃ³ thá»ƒ - TrÃ¡nh táº¡o ra cÃ¡c luá»“ng khÃ´ng cáº§n thiáº¿t, vÃ­ dá»¥: nhiá»‡m vá»¥ Ã­t nhÆ°ng táº¡o ra nhiá»u luá»“ng Ä‘á»ƒ xá»­ lÃ½, Ä‘iá»u nÃ y sáº½ dáº«n Ä‘áº¿n tÃ¬nh tráº¡ng nhiá»u luá»“ng Ä‘ang chá» Ä‘á»£i.</li><li>Sá»­ dá»¥ng Coroutines - Triá»ƒn khai láº­p lá»‹ch nhiá»u nhiá»‡m vá»¥ trong má»™t luá»“ng duy nháº¥t vÃ  chuyá»ƒn Ä‘á»•i giá»¯a cÃ¡c nhiá»‡m vá»¥ trong luá»“ng duy nháº¥t Ä‘Ã³.</li></ul><h3 id="han-che-tai-nguyen" tabindex="-1"><a class="header-anchor" href="#han-che-tai-nguyen"><span>Háº¡n cháº¿ tÃ i nguyÃªn</span></a></h3><h4 id="han-che-tai-nguyen-la-gi" tabindex="-1"><a class="header-anchor" href="#han-che-tai-nguyen-la-gi"><span>Háº¡n cháº¿ tÃ i nguyÃªn lÃ  gÃ¬</span></a></h4><p>Háº¡n cháº¿ tÃ i nguyÃªn lÃ  khi tá»‘c Ä‘á»™ thá»±c thi cá»§a chÆ°Æ¡ng trÃ¬nh bá»‹ háº¡n cháº¿ bá»Ÿi tÃ i nguyÃªn pháº§n cá»©ng hoáº·c pháº§n má»m cá»§a mÃ¡y tÃ­nh.</p><h4 id="van-Ä‘e-gay-ra-boi-han-che-tai-nguyen" tabindex="-1"><a class="header-anchor" href="#van-Ä‘e-gay-ra-boi-han-che-tai-nguyen"><span>Váº¥n Ä‘á» gÃ¢y ra bá»Ÿi háº¡n cháº¿ tÃ i nguyÃªn</span></a></h4><p>Trong láº­p trÃ¬nh Ä‘á»“ng thá»i, nguyÃªn táº¯c Ä‘á»ƒ tÄƒng tá»‘c Ä‘á»™ thá»±c thi mÃ£ lÃ  chuyá»ƒn Ä‘á»•i cÃ¡c pháº§n mÃ£ tuáº§n tá»± trong mÃ£ thÃ nh thá»±c thi Ä‘á»“ng thá»i, nhÆ°ng náº¿u má»™t pháº§n mÃ£ tuáº§n tá»± Ä‘Æ°á»£c chuyá»ƒn Ä‘á»•i thÃ nh thá»±c thi Ä‘á»“ng thá»i nhÆ°ng váº«n tuáº§n tá»± do háº¡n cháº¿ tÃ i nguyÃªn, chÆ°Æ¡ng trÃ¬nh khÃ´ng chá»‰ khÃ´ng thá»ƒ tÄƒng tá»‘c Ä‘á»™ thá»±c thi mÃ  cÃ²n cháº­m hÆ¡n, vÃ¬ Ä‘Ã£ tÄƒng thÃªm thá»i gian chuyá»ƒn Ä‘á»•i ngá»¯ cáº£nh vÃ  láº­p lá»‹ch tÃ i nguyÃªn.</p><h4 id="cach-giai-quyet-van-Ä‘e-han-che-tai-nguyen" tabindex="-1"><a class="header-anchor" href="#cach-giai-quyet-van-Ä‘e-han-che-tai-nguyen"><span>CÃ¡ch giáº£i quyáº¿t váº¥n Ä‘á» háº¡n cháº¿ tÃ i nguyÃªn</span></a></h4><p>Trong láº­p trÃ¬nh Ä‘á»“ng thá»i trong trÆ°á»ng há»£p háº¡n cháº¿ tÃ i nguyÃªn, Ä‘iá»u chá»‰nh má»©c Ä‘á»™ Ä‘á»“ng thá»i cá»§a chÆ°Æ¡ng trÃ¬nh dá»±a trÃªn háº¡n cháº¿ tÃ i nguyÃªn cá»¥ thá»ƒ.</p><ul><li>Äá»‘i vá»›i háº¡n cháº¿ tÃ i nguyÃªn pháº§n cá»©ng, cÃ³ thá»ƒ xem xÃ©t sá»­ dá»¥ng cá»¥m Ä‘á»ƒ thá»±c thi chÆ°Æ¡ng trÃ¬nh song song.</li><li>Äá»‘i vá»›i háº¡n cháº¿ tÃ i nguyÃªn pháº§n má»m, cÃ³ thá»ƒ xem xÃ©t sá»­ dá»¥ng bá»ƒ tÃ i nguyÃªn Ä‘á»ƒ tÃ¡i sá»­ dá»¥ng tÃ i nguyÃªn.</li></ul><h2 id="tom-tat" tabindex="-1"><a class="header-anchor" href="#tom-tat"><span>TÃ³m táº¯t</span></a></h2><p>Láº­p trÃ¬nh Ä‘á»“ng thá»i cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ³m táº¯t thÃ nh ba váº¥n Ä‘á» cá»‘t lÃµi: phÃ¢n cÃ´ng, Ä‘á»“ng bá»™ hÃ³a vÃ  khÃ³a.</p><ul><li><strong>PhÃ¢n cÃ´ng</strong>: Äá» cáº­p Ä‘áº¿n cÃ¡ch hiá»‡u quáº£ Ä‘á»ƒ phÃ¢n chia nhiá»‡m vá»¥ vÃ  giao cho cÃ¡c luá»“ng.</li><li><strong>Äá»“ng bá»™ hÃ³a (Synchronization)</strong>: Äá» cáº­p Ä‘áº¿n cÃ¡ch cÃ¡c luá»“ng lÃ m viá»‡c cÃ¹ng nhau.</li><li><strong>Loáº¡i trá»« láº«n nhau (Mutual exclusion)</strong>: Äáº£m báº£o chá»‰ cho phÃ©p má»™t luá»“ng truy cáº­p vÃ o tÃ i nguyÃªn chung trong má»™t thá»i Ä‘iá»ƒm.</li></ul></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/vanhung4499/my-wiki/edit/main/src/programming/java/Concurency/Java Concurrency Intro.md" aria-label="Edit this page on GitHub" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page on GitHub<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">Last update: </span><!----></div><div class="contributors"><span class="vp-meta-label">Contributors: </span><!--[--><!--[--><span class="vp-meta-info" title="email: vanhung4499@gmail.com">Hung Nguyen Van</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/programming/java/Concurency/Java%20Concurrency%20Core%20Mechanism.html" aria-label="Java Concurrency Core Mechanism"><div class="hint"><span class="arrow start"></span>Prev</div><div class="link"><!---->Java Concurrency Core Mechanism</div></a><a class="route-link auto-link next" href="/programming/java/Concurency/Java%20Concurrent%20Collection.html" aria-label="Java Concurrent Collection"><div class="hint">Next<span class="arrow end"></span></div><div class="link">Java Concurrent Collection<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper" style="display:none;--1ea755b8:;"><div class="footer-content"><div class="footer">Made with â¤ï¸ by Hung Nguyen</div><div class="copyright">Copyright Â© 2016-2024 Hung Nguyen</div></div><span id="runtime_span"></span></footer></div><!--]--><!--[--><!----><!----><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-C7tm95bn.js" defer></script>
  </body>
</html>
