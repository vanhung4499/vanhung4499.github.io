<!doctype html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.12" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.46" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://vanhung4499.github.io/programming/java/JVM/JVM%20Garbage%20Collection.html"><meta property="og:site_name" content="VanHung4499"><meta property="og:title" content="JVM Garbage Collection"><meta property="og:description" content="Thu gom rÃ¡c trong JVM CÃ¡c vÃ¹ng nhá»› nhÆ° bá»™ Ä‘áº¿m chÆ°Æ¡ng trÃ¬nh, ngÄƒn xáº¿p áº£o vÃ  ngÄƒn xáº¿p phÆ°Æ¡ng thá»©c cÃ¹ng vá»›i cÃ¡c vÃ¹ng nhá»› nÃ y Ä‘á»u thuá»™c vá» tá»«ng luá»“ng riÃªng biá»‡t vÃ  chá»‰ tá»“n táº¡i trong..."><meta property="og:type" content="article"><meta property="og:image" content="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230718153129.png"><meta property="og:locale" content="en-US"><meta property="og:updated_time" content="2024-06-28T15:54:38.000Z"><meta property="article:author" content="Hung Nguyen"><meta property="article:tag" content="java"><meta property="article:tag" content="javase"><meta property="article:tag" content="jvm"><meta property="article:tag" content="gc"><meta property="article:modified_time" content="2024-06-28T15:54:38.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"JVM Garbage Collection","image":["https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230718153129.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230718172452.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230718172523.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230718172532.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230718201633.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230718202918.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230718203540.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide1.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide2.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide3.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide4.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide5.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide6.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide7.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide8.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide9.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide10.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide11.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide12.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide13.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide14.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide15.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide16.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide17.png"],"dateModified":"2024-06-28T15:54:38.000Z","author":[{"@type":"Person","name":"Hung Nguyen","url":"https://vanhung4499.github.io"}]}</script><meta name="referrer" content="no-referrer-when-downgrade"><link rel="alternate" type="application/rss+xml" href="https://vanhung4499.github.io/rss.xml" title="VanHung4499 RSS Feed"><title>JVM Garbage Collection | VanHung4499</title><meta name="description" content="Thu gom rÃ¡c trong JVM CÃ¡c vÃ¹ng nhá»› nhÆ° bá»™ Ä‘áº¿m chÆ°Æ¡ng trÃ¬nh, ngÄƒn xáº¿p áº£o vÃ  ngÄƒn xáº¿p phÆ°Æ¡ng thá»©c cÃ¹ng vá»›i cÃ¡c vÃ¹ng nhá»› nÃ y Ä‘á»u thuá»™c vá» tá»«ng luá»“ng riÃªng biá»‡t vÃ  chá»‰ tá»“n táº¡i trong...">
    <link rel="preload" href="/assets/style-BqjKxtxe.css" as="style"><link rel="stylesheet" href="/assets/style-BqjKxtxe.css">
    <link rel="modulepreload" href="/assets/app-BG8AAbz2.js"><link rel="modulepreload" href="/assets/JVM Garbage Collection.html-aAmzE_wk.js">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">Skip to main content</a><!--]--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo" src="/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">VanHung4499</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="Home"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:home" width="1em" height="1em"></iconify-icon><!--]-->Home<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/wiki.html" aria-label="Wiki"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="carbon:wikis" width="1em" height="1em"></iconify-icon><!--]-->Wiki<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/dsa/" aria-label="Algorithms"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="hugeicons:algorithm" width="1em" height="1em"></iconify-icon><!--]-->Algorithms<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Programming"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:code" width="1em" height="1em"></iconify-icon>Programming<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link route-link-active auto-link" href="/programming/java/" aria-label="Java"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:java" width="1em" height="1em"></iconify-icon><!--]-->Java<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/golang/" aria-label="Golang"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:go" width="1em" height="1em"></iconify-icon><!--]-->Golang<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/js/" aria-label="JavaScript"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:javascript" width="1em" height="1em"></iconify-icon><!--]-->JavaScript<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/ts/" aria-label="TypeScript"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:typescript" width="1em" height="1em"></iconify-icon><!--]-->TypeScript<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/python/" aria-label="Python"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:python" width="1em" height="1em"></iconify-icon><!--]-->Python<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Database"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:database" width="1em" height="1em"></iconify-icon>Database<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/sql/" aria-label="SQL"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:sql-query" width="1em" height="1em"></iconify-icon><!--]-->SQL<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/mysql/" aria-label="MySQL"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:mysql" width="1em" height="1em"></iconify-icon><!--]-->MySQL<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/mongodb/" aria-label="MongoDB"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:mongodb" width="1em" height="1em"></iconify-icon><!--]-->MongoDB<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/redis/" aria-label="Redis"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/elasticsearch/" aria-label="Elasticsearch"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:elasticsearch" width="1em" height="1em"></iconify-icon><!--]-->Elasticsearch<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/elastic/" aria-label="Elastic Stack"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="cib:elastic-stack" width="1em" height="1em"></iconify-icon><!--]-->Elastic Stack<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Framework"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="simple-icons:framework" width="1em" height="1em"></iconify-icon>Framework<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/spring/" aria-label="Spring"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->Spring<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/spring-boot/" aria-label="Spring Boot"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->Spring Boot<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/nestjs/" aria-label="NestJS"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:nestjs" width="1em" height="1em"></iconify-icon><!--]-->NestJS<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/gin/" aria-label="Gin"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="logos:gin" width="1em" height="1em"></iconify-icon><!--]-->Gin<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="DevOps"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon-plain:azuredevops" width="1em" height="1em"></iconify-icon>DevOps<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/docker/" aria-label="Docker"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:docker" width="1em" height="1em"></iconify-icon><!--]-->Docker<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/kubernetes/" aria-label="Kubernetes"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:kubernetes" width="1em" height="1em"></iconify-icon><!--]-->Kubernetes<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/jenkins/" aria-label="Jenkins"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:jenkins" width="1em" height="1em"></iconify-icon><!--]-->Jenkins<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/git/" aria-label="Git"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:git" width="1em" height="1em"></iconify-icon><!--]-->Git<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/linux/" aria-label="Linux"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:linux" width="1em" height="1em"></iconify-icon><!--]-->Linux<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Design"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="tdesign:system-sum" width="1em" height="1em"></iconify-icon>Design<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/design/design-pattern/" aria-label="Design Pattern"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="tabler:grid-pattern" width="1em" height="1em"></iconify-icon><!--]-->Design Pattern<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/design/system-design/" aria-label="System Design"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="icon-park-outline:system" width="1em" height="1em"></iconify-icon><!--]-->System Design<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/project/" aria-label="Project"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="ant-design:project-outlined" width="1em" height="1em"></iconify-icon><!--]-->Project<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/interview/" aria-label="Interview"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:account-tie" width="1em" height="1em"></iconify-icon><!--]-->Interview<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="About"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:about" width="1em" height="1em"></iconify-icon>About<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/about-me.html" aria-label="About me"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="cib:about-me" width="1em" height="1em"></iconify-icon><!--]-->About me<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/about.html" aria-label="About"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:about" width="1em" height="1em"></iconify-icon><!--]-->About<!----></a></li></ul></button></div></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/vanhung4499/my-wiki" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><!--[--><button type="button" class="search-pro-button" aria-label="Search"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon" name="search"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">Search</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/programming/java/" aria-label="Java"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:java" width="1em" height="1em"></iconify-icon><!--]-->Java<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Basic</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Array</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">String</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">OOP</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Extra</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Collection</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Common Tools</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">IO</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Exception</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">New Features</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">NIO</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Advanced</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Concurrency</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">JVM</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/programming/java/JVM/Java%20Bytecode.html" aria-label="Java Bytecode"><!---->Java Bytecode<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/programming/java/JVM/JVM%20Architecture.html" aria-label="JVM Architecture"><!---->JVM Architecture<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/programming/java/JVM/JVM%20Class%20Loader.html" aria-label="JVM Class Loader"><!---->JVM Class Loader<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/programming/java/JVM/JVM%20Command%20Line%20Tools.html" aria-label="JVM Command Line Tools"><!---->JVM Command Line Tools<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link vp-sidebar-page active" href="/programming/java/JVM/JVM%20Garbage%20Collection.html" aria-label="JVM Garbage Collection"><!---->JVM Garbage Collection<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/programming/java/JVM/JVM%20GUI%20Tools.html" aria-label="JVM GUI Tools"><!---->JVM GUI Tools<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/programming/java/JVM/JVM%20In%20Action.html" aria-label="JVM In Action"><!---->JVM In Action<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/programming/java/JVM/JVM%20Memory%20Managment.html" aria-label="JVM Memory Managment"><!---->JVM Memory Managment<!----></a></li></ul></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->JVM Garbage Collection</h1><div class="page-info"><span class="page-author-info" aria-label="AuthorğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://vanhung4499.github.io" target="_blank" rel="noopener noreferrer">Hung Nguyen</a></span><span property="author" content="Hung Nguyen"></span></span><!----><span class="page-date-info" aria-label="Writing DateğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-06-28T15:54:38.000Z"></span><!----><span class="page-reading-time-info" aria-label="Reading TimeâŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 35 min</span><meta property="timeRequired" content="PT35M"></span><span class="page-category-info" aria-label="CategoryğŸŒˆ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color8 clickable" role="navigation">java</span><span class="page-category-item color1 clickable" role="navigation">javase</span><span class="page-category-item color5 clickable" role="navigation">jvm</span><!--]--><meta property="articleSection" content="java,javase,jvm"></span><span class="page-tag-info" aria-label="TagğŸ·" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color8 clickable" role="navigation">java</span><span class="page-tag-item color1 clickable" role="navigation">javase</span><span class="page-tag-item color5 clickable" role="navigation">jvm</span><span class="page-tag-item color7 clickable" role="navigation">gc</span><!--]--><meta property="keywords" content="java,javase,jvm,gc"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">On This Page<button type="button" class="print-button" title="Print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#Ä‘oi-tuong-con-song-hay-Ä‘a-chet">Äá»‘i tÆ°á»£ng cÃ²n sá»‘ng hay Ä‘Ã£ cháº¿t</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#thuat-toan-Ä‘em-tham-chieu">Thuáº­t toÃ¡n Ä‘áº¿m tham chiáº¿u</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#thuat-toan-phan-tich-kha-nang-tiep-can">Thuáº­t toÃ¡n phÃ¢n tÃ­ch kháº£ nÄƒng tiáº¿p cáº­n</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#loai-tham-chieu">Loáº¡i tham chiáº¿u</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#thu-gom-vung-phuong-thuc">Thu gom vÃ¹ng phÆ°Æ¡ng thá»©c</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#thu-gom-vung-phuong-thuc-1">Thu gom vÃ¹ng phÆ°Æ¡ng thá»©c</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#finalize">finalize()</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#thuat-toan-thu-gom-rac">Thuáº­t toÃ¡n thu gom rÃ¡c</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#hieu-suat-thu-gom-rac">Hiá»‡u suáº¥t thu gom rÃ¡c</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Ä‘anh-dau-don-dep-mark-sweep">ÄÃ¡nh dáº¥u - Dá»n dáº¹p (Mark-Sweep)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Ä‘anh-dau-sap-xep-mark-compact">ÄÃ¡nh dáº¥u - Sáº¯p xáº¿p (Mark-Compact)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#sao-chep-copying">Sao chÃ©p (Copying)</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#thuat-toan-thu-gom-rac-theo-the-he">Thuáº­t toÃ¡n thu gom rÃ¡c theo tháº¿ há»‡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#bo-thu-gom-rac">Bá»™ thu gom rÃ¡c</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#bo-thu-gom-rac-tuan-tu">Bá»™ thu gom rÃ¡c tuáº§n tá»±</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#bo-thu-gom-rac-song-song">Bá»™ thu gom rÃ¡c song song</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#bo-thu-gom-rac-Ä‘ong-thoi-Ä‘anh-dau-xoa">Bá»™ thu gom rÃ¡c Ä‘á»“ng thá»i Ä‘Ã¡nh dáº¥u-xÃ³a</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#bo-thu-gom-g1">Bá»™ thu gom G1</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#tong-ket">Tá»•ng káº¿t</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#chien-luoc-cap-phat-va-thu-gom-bo-nho">Chiáº¿n lÆ°á»£c cáº¥p phÃ¡t vÃ  thu gom bá»™ nhá»›</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#minor-gc">Minor GC</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#full-gc">Full GC</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h1 id="thu-gom-rac-trong-jvm" tabindex="-1"><a class="header-anchor" href="#thu-gom-rac-trong-jvm"><span>Thu gom rÃ¡c trong JVM</span></a></h1><blockquote><p>CÃ¡c vÃ¹ng nhá»› nhÆ° bá»™ Ä‘áº¿m chÆ°Æ¡ng trÃ¬nh, ngÄƒn xáº¿p áº£o vÃ  ngÄƒn xáº¿p phÆ°Æ¡ng thá»©c cÃ¹ng vá»›i cÃ¡c vÃ¹ng nhá»› nÃ y Ä‘á»u thuá»™c vá» tá»«ng luá»“ng riÃªng biá»‡t vÃ  chá»‰ tá»“n táº¡i trong suá»‘t vÃ²ng Ä‘á»i cá»§a luá»“ng. Sau khi luá»“ng káº¿t thÃºc, cÃ¡c vÃ¹ng nhá»› nÃ y cÅ©ng sáº½ biáº¿n máº¥t, do Ä‘Ã³ khÃ´ng cáº§n thu gom rÃ¡c cho cÃ¡c vÃ¹ng nhá»› nÃ y. <strong>Thu gom rÃ¡c chá»§ yáº¿u Ä‘Æ°á»£c thá»±c hiá»‡n trÃªn Java Heap vÃ  Method Area</strong>.</p></blockquote><h2 id="Ä‘oi-tuong-con-song-hay-Ä‘a-chet" tabindex="-1"><a class="header-anchor" href="#Ä‘oi-tuong-con-song-hay-Ä‘a-chet"><span>Äá»‘i tÆ°á»£ng cÃ²n sá»‘ng hay Ä‘Ã£ cháº¿t</span></a></h2><h3 id="thuat-toan-Ä‘em-tham-chieu" tabindex="-1"><a class="header-anchor" href="#thuat-toan-Ä‘em-tham-chieu"><span>Thuáº­t toÃ¡n Ä‘áº¿m tham chiáº¿u</span></a></h3><p>ThÃªm má»™t bá»™ Ä‘áº¿m tham chiáº¿u cho Ä‘á»‘i tÆ°á»£ng, khi Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c tham chiáº¿u thÃ¬ bá»™ Ä‘áº¿m tÄƒng lÃªn 1, khi tham chiáº¿u máº¥t hiá»‡u lá»±c thÃ¬ bá»™ Ä‘áº¿m giáº£m Ä‘i 1. Äá»‘i tÆ°á»£ng cÃ³ bá»™ Ä‘áº¿m tham chiáº¿u báº±ng 0 cÃ³ thá»ƒ bá»‹ thu gom.</p><p>Tuy nhiÃªn, trong trÆ°á»ng há»£p hai Ä‘á»‘i tÆ°á»£ng tham chiáº¿u láº«n nhau, bá»™ Ä‘áº¿m tham chiáº¿u sáº½ khÃ´ng bao giá» báº±ng 0, dáº«n Ä‘áº¿n khÃ´ng thá»ƒ thu gom Ä‘Æ°á»£c cÃ¡c Ä‘á»‘i tÆ°á»£ng nÃ y.</p><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> ReferenceCountingGC</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Object</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> instance </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> static</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> main</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[] </span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;">args</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        ReferenceCountingGC</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> objectA</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> ReferenceCountingGC</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        ReferenceCountingGC</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> objectB</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> ReferenceCountingGC</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        objectA</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">instance</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> objectB;</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        objectB</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">instance</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> objectA;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><p>VÃ¬ sá»± tá»“n táº¡i cá»§a tham chiáº¿u láº«n nhau, nÃªn <strong>Java Virtual Machine khÃ´ng sá»­ dá»¥ng thuáº­t toÃ¡n Ä‘áº¿m tham chiáº¿u</strong>.</p><h3 id="thuat-toan-phan-tich-kha-nang-tiep-can" tabindex="-1"><a class="header-anchor" href="#thuat-toan-phan-tich-kha-nang-tiep-can"><span>Thuáº­t toÃ¡n phÃ¢n tÃ­ch kháº£ nÄƒng tiáº¿p cáº­n</span></a></h3><p>Dá»±a trÃªn cÃ¡c <strong>GC Roots</strong> lÃ m Ä‘iá»ƒm báº¯t Ä‘áº§u Ä‘á»ƒ tÃ¬m kiáº¿m, JVM coi cÃ¡c Ä‘á»‘i tÆ°á»£ng mÃ  cÃ³ thá»ƒ tiáº¿p cáº­n Ä‘Æ°á»£c tá»« GC Roots lÃ  <strong>cÃ²n sá»‘ng</strong>, cÃ¡c Ä‘á»‘i tÆ°á»£ng khÃ´ng thá»ƒ tiáº¿p cáº­n Ä‘Æ°á»£c lÃ  <strong>Ä‘Ã£ cháº¿t</strong>.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230718153129.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p><strong>CÃ¡c Ä‘á»‘i tÆ°á»£ng cÃ³ thá»ƒ lÃ  GC Roots</strong> bao gá»“m:</p><ul><li>Äá»‘i tÆ°á»£ng Ä‘Æ°á»£c tham chiáº¿u trong ngÄƒn xáº¿p áº£o</li><li>Äá»‘i tÆ°á»£ng Ä‘Æ°á»£c tham chiáº¿u trong ngÄƒn xáº¿p phÆ°Æ¡ng thá»©c (phÆ°Æ¡ng thá»©c Native)</li><li>Äá»‘i tÆ°á»£ng Ä‘Æ°á»£c tham chiáº¿u trong vÃ¹ng nhá»› phÆ°Æ¡ng thá»©c, thuá»™c tÃ­nh tÄ©nh cá»§a lá»›p</li><li>Äá»‘i tÆ°á»£ng Ä‘Æ°á»£c tham chiáº¿u trong vÃ¹ng nhá»› phÆ°Æ¡ng thá»©c, háº±ng sá»‘</li></ul><h3 id="loai-tham-chieu" tabindex="-1"><a class="header-anchor" href="#loai-tham-chieu"><span>Loáº¡i tham chiáº¿u</span></a></h3><p>DÃ¹ sá»­ dá»¥ng thuáº­t toÃ¡n Ä‘áº¿m tham chiáº¿u Ä‘á»ƒ xÃ¡c Ä‘á»‹nh sá»‘ lÆ°á»£ng tham chiáº¿u cá»§a Ä‘á»‘i tÆ°á»£ng, hay sá»­ dá»¥ng thuáº­t toÃ¡n phÃ¢n tÃ­ch kháº£ nÄƒng tiáº¿p cáº­n Ä‘á»ƒ xÃ¡c Ä‘á»‹nh xem chuá»—i tham chiáº¿u cÃ³ thá»ƒ tiáº¿p cáº­n Ä‘Æ°á»£c hay khÃ´ng, viá»‡c xÃ¡c Ä‘á»‹nh xem Ä‘á»‘i tÆ°á»£ng cÃ³ thá»ƒ bá»‹ thu gom hay khÃ´ng Ä‘á»u liÃªn quan Ä‘áº¿n tham chiáº¿u.</p><p>Java cÃ³ bá»‘n loáº¡i tham chiáº¿u vá»›i má»©c Ä‘á»™ máº¡nh yáº¿u khÃ¡c nhau.</p><h4 id="tham-chieu-manh-strong-reference" tabindex="-1"><a class="header-anchor" href="#tham-chieu-manh-strong-reference"><span>Tham chiáº¿u máº¡nh (Strong Reference)</span></a></h4><p><strong>Äá»‘i tÆ°á»£ng Ä‘Æ°á»£c tham chiáº¿u máº¡nh (Strong Reference) sáº½ khÃ´ng bá»‹ thu gom bá»Ÿi bá»™ thu gom rÃ¡c.</strong></p><p>Tham chiáº¿u máº¡nh: Sá»­ dá»¥ng cÃ¡ch táº¡o má»™t Ä‘á»‘i tÆ°á»£ng má»›i báº±ng tá»« khÃ³a <code>new</code>.</p><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Object</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> obj </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> Object</span><span style="color:#E06C75;--shiki-dark:#E06C75;">()</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span></code></pre></div><h4 id="tham-chieu-mem-soft-reference" tabindex="-1"><a class="header-anchor" href="#tham-chieu-mem-soft-reference"><span>Tham chiáº¿u má»m (Soft Reference)</span></a></h4><p><strong>Äá»‘i tÆ°á»£ng Ä‘Æ°á»£c tham chiáº¿u má»m (Soft Reference) chá»‰ bá»‹ thu gom khi bá»™ nhá»› khÃ´ng Ä‘á»§.</strong></p><p>Tham chiáº¿u má»m: Sá»­ dá»¥ng lá»›p <code>SoftReference</code> Ä‘á»ƒ táº¡o tham chiáº¿u má»m.</p><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Object</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> obj </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> Object</span><span style="color:#E06C75;--shiki-dark:#E06C75;">()</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">SoftReference</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Object</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> sf </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> SoftReference</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Object</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">(obj)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">obj </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;"> // Äá»‘i tÆ°á»£ng chá»‰ Ä‘Æ°á»£c tham chiáº¿u má»m</span></span></code></pre></div><h4 id="tham-chieu-yeu-weak-reference" tabindex="-1"><a class="header-anchor" href="#tham-chieu-yeu-weak-reference"><span>Tham chiáº¿u yáº¿u (Weak Reference)</span></a></h4><p><strong>Äá»‘i tÆ°á»£ng Ä‘Æ°á»£c tham chiáº¿u yáº¿u (Weak Reference) sáº½ bá»‹ thu gom cháº¯c cháº¯n, tá»©c lÃ  chá»‰ tá»“n táº¡i Ä‘áº¿n láº§n thu gom rÃ¡c tiáº¿p theo.</strong></p><p>Sá»­ dá»¥ng lá»›p <code>WeakReference</code> Ä‘á»ƒ táº¡o tham chiáº¿u yáº¿u.</p><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Object</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> obj </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> Object</span><span style="color:#E06C75;--shiki-dark:#E06C75;">()</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">WeakReference</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Object</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> wf </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> WeakReference</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Object</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">(obj)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">obj </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span></code></pre></div><p><code>Entry</code> trong <code>WeakHashMap</code> káº¿ thá»«a tá»« <code>WeakReference</code>, Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thá»±c hiá»‡n chá»©c nÄƒng bá»™ nhá»› Ä‘á»‡m.</p><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">private</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> static</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Entry</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">K</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">V</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> extends</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> WeakReference</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Object</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> implements</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Map</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Entry</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">K</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">V</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre></div><p><code>ConcurrentCache</code> trong Tomcat sá»­ dá»¥ng <code>WeakHashMap</code> Ä‘á»ƒ thá»±c hiá»‡n chá»©c nÄƒng bá»™ nhá»› Ä‘á»‡m. <code>ConcurrentCache</code> sá»­ dá»¥ng bá»™ nhá»› Ä‘á»‡m theo tháº¿ há»‡, Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c sá»­ dá»¥ng thÆ°á»ng xuyÃªn Ä‘Æ°á»£c Ä‘áº·t trong eden, trong khi Ä‘á»‘i tÆ°á»£ng khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng thÆ°á»ng xuyÃªn Ä‘Æ°á»£c Ä‘áº·t trong longterm. Eden sá»­ dá»¥ng <code>ConcurrentHashMap</code> Ä‘á»ƒ thá»±c hiá»‡n, longterm sá»­ dá»¥ng <code>WeakHashMap</code>, Ä‘áº£m báº£o ráº±ng cÃ¡c Ä‘á»‘i tÆ°á»£ng khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng thÆ°á»ng xuyÃªn dá»… dÃ ng bá»‹ thu gom.</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> final</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> ConcurrentCache</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">K</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> V</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> final</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> int</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> size</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> final</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Map</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">K</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> V</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> eden</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> final</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Map</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">K</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> V</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> longterm</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> ConcurrentCache</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#C678DD;--shiki-dark:#C678DD;">int</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> size</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        this</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">size</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> size;</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        this</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">eden</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> ConcurrentHashMap</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;&gt;(size);</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        this</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">longterm</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> WeakHashMap</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;&gt;(size);</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> V</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> get</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">K</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> k</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        V</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> v</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> this</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">eden</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">get</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(k);</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (v </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">==</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">            v </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> this</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">longterm</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">get</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(k);</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">            if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (v </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">!=</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">                this</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">eden</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">put</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(k, v);</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> v;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> put</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">K</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> k</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">V</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> v</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">this</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">eden</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">size</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">() </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">&gt;=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> size) {</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">            this</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">longterm</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">putAll</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">this</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">eden</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">            this</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">eden</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">clear</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        this</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">eden</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">put</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(k, v);</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="tham-chieu-ao-phantom-reference" tabindex="-1"><a class="header-anchor" href="#tham-chieu-ao-phantom-reference"><span>Tham chiáº¿u áº£o (Phantom Reference)</span></a></h4><p>CÃ²n Ä‘Æ°á»£c gá»i lÃ  tham chiáº¿u ma hoáº·c tham chiáº¿u áº£o. Sá»± tá»“n táº¡i cá»§a má»™t tham chiáº¿u áº£o khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n thá»i gian sá»‘ng cá»§a má»™t Ä‘á»‘i tÆ°á»£ng, vÃ  khÃ´ng thá»ƒ truy cáº­p Ä‘Æ°á»£c má»™t thá»ƒ hiá»‡n Ä‘á»‘i tÆ°á»£ng.</p><p><strong>Má»¥c Ä‘Ã­ch duy nháº¥t cá»§a viá»‡c thiáº¿t láº­p má»™t tham chiáº¿u áº£o cho má»™t Ä‘á»‘i tÆ°á»£ng lÃ  Ä‘á»ƒ nháº­n Ä‘Æ°á»£c má»™t thÃ´ng bÃ¡o há»‡ thá»‘ng khi Ä‘á»‘i tÆ°á»£ng Ä‘Ã³ bá»‹ thu gom.</strong></p><p>Sá»­ dá»¥ng lá»›p <code>PhantomReference</code> Ä‘á»ƒ táº¡o tham chiáº¿u áº£o.</p><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Object</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> obj </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> Object</span><span style="color:#E06C75;--shiki-dark:#E06C75;">()</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">PhantomReference</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Object</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> pf </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> PhantomReference</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Object</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">(obj)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">obj </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span></code></pre></div><h3 id="thu-gom-vung-phuong-thuc" tabindex="-1"><a class="header-anchor" href="#thu-gom-vung-phuong-thuc"><span>Thu gom vÃ¹ng phÆ°Æ¡ng thá»©c</span></a></h3><p>VÃ¬ vÃ¹ng phÆ°Æ¡ng thá»©c chá»§ yáº¿u chá»©a cÃ¡c Ä‘á»‘i tÆ°á»£ng trong khÃ´ng gian vÄ©nh viá»…n, vÃ  tá»· lá»‡ thu gom cá»§a cÃ¡c Ä‘á»‘i tÆ°á»£ng trong khÃ´ng gian vÄ©nh viá»…n tháº¥p hÆ¡n so vá»›i khÃ´ng gian tráº», nÃªn viá»‡c thu gom rÃ¡c trÃªn vÃ¹ng phÆ°Æ¡ng thá»©c khÃ´ng hiá»‡u quáº£.</p><p>Chá»§ yáº¿u lÃ  thu gom rÃ¡c trong bá»™ nhá»› háº±ng sá»‘ vÃ  há»§y bá» lá»›p.</p><p>CÃ³ nhiá»u Ä‘iá»u kiá»‡n Ä‘á»ƒ há»§y bá» má»™t lá»›p, pháº£i Ä‘Ã¡p á»©ng ba Ä‘iá»u kiá»‡n sau vÃ  khÃ´ng Ä‘áº£m báº£o ráº±ng lá»›p sáº½ bá»‹ há»§y bá»:</p><ul><li>Táº¥t cáº£ cÃ¡c thá»ƒ hiá»‡n cá»§a lá»›p Ä‘Ã£ Ä‘Æ°á»£c thu gom, nghÄ©a lÃ  khÃ´ng cÃ³ thá»ƒ hiá»‡n cá»§a lá»›p nÃ o tá»“n táº¡i trong Java Heap.</li><li><code>ClassLoader</code> táº£i lá»›p Ä‘Ã£ bá»‹ thu gom.</li><li>Äá»‘i tÆ°á»£ng <code>java.lang.Class</code> tÆ°Æ¡ng á»©ng vá»›i lá»›p khÃ´ng Ä‘Æ°á»£c tham chiáº¿u á»Ÿ báº¥t ká»³ Ä‘Ã¢u, nghÄ©a lÃ  khÃ´ng thá»ƒ truy cáº­p vÃ o phÆ°Æ¡ng thá»©c cá»§a lá»›p Ä‘Ã³ á»Ÿ báº¥t ká»³ Ä‘Ã¢u báº±ng cÃ¡ch pháº£n chiáº¿u.</li></ul><p>CÃ³ thá»ƒ sá»­ dá»¥ng tham sá»‘ <code>-Xnoclassgc</code> Ä‘á»ƒ kiá»ƒm soÃ¡t viá»‡c há»§y bá» lá»›p.</p><p>Trong cÃ¡c tÃ¬nh huá»‘ng sá»­ dá»¥ng nhiá»u pháº£n chiáº¿u, Ä‘áº¡i diá»‡n Ä‘á»™ng, CGLib vÃ  táº¡o JSP Ä‘á»™ng vÃ  OSGi, cáº§n cÃ³ kháº£ nÄƒng há»§y bá» lá»›p trong mÃ¡y áº£o Ä‘á»ƒ Ä‘áº£m báº£o khÃ´ng xáº£y ra lá»—i trÃ n bá»™ nhá»›.</p><h3 id="thu-gom-vung-phuong-thuc-1" tabindex="-1"><a class="header-anchor" href="#thu-gom-vung-phuong-thuc-1"><span>Thu gom vÃ¹ng phÆ°Æ¡ng thá»©c</span></a></h3><p>VÃ¬ vÃ¹ng phÆ°Æ¡ng thá»©c chá»§ yáº¿u chá»©a cÃ¡c Ä‘á»‘i tÆ°á»£ng trong khÃ´ng gian vÄ©nh viá»…n, vÃ  tá»· lá»‡ thu gom cá»§a cÃ¡c Ä‘á»‘i tÆ°á»£ng trong khÃ´ng gian vÄ©nh viá»…n tháº¥p hÆ¡n so vá»›i khÃ´ng gian tráº», nÃªn viá»‡c thu gom rÃ¡c trÃªn vÃ¹ng phÆ°Æ¡ng thá»©c khÃ´ng hiá»‡u quáº£.</p><p>Chá»§ yáº¿u lÃ  thu gom rÃ¡c trong vÃ¹ng háº±ng sá»‘ vÃ  há»§y bá» lá»›p.</p><p>CÃ³ nhiá»u Ä‘iá»u kiá»‡n Ä‘á»ƒ há»§y bá» má»™t lá»›p, pháº£i Ä‘Ã¡p á»©ng ba Ä‘iá»u kiá»‡n sau vÃ  khÃ´ng Ä‘áº£m báº£o ráº±ng lá»›p sáº½ bá»‹ há»§y bá»:</p><ul><li>Táº¥t cáº£ cÃ¡c thá»ƒ hiá»‡n cá»§a lá»›p Ä‘Ã£ Ä‘Æ°á»£c thu gom, nghÄ©a lÃ  khÃ´ng cÃ³ thá»ƒ hiá»‡n cá»§a lá»›p nÃ o tá»“n táº¡i trong Java Heap.</li><li><code>ClassLoader</code> táº£i lá»›p Ä‘Ã£ bá»‹ thu gom.</li><li>Äá»‘i tÆ°á»£ng <code>java.lang.Class</code> tÆ°Æ¡ng á»©ng vá»›i lá»›p khÃ´ng Ä‘Æ°á»£c tham chiáº¿u á»Ÿ báº¥t ká»³ Ä‘Ã¢u, nghÄ©a lÃ  khÃ´ng thá»ƒ truy cáº­p vÃ o phÆ°Æ¡ng thá»©c cá»§a lá»›p Ä‘Ã³ á»Ÿ báº¥t ká»³ Ä‘Ã¢u báº±ng cÃ¡ch pháº£n chiáº¿u.</li></ul><p>CÃ³ thá»ƒ sá»­ dá»¥ng tham sá»‘ <code>-Xnoclassgc</code> Ä‘á»ƒ kiá»ƒm soÃ¡t viá»‡c há»§y bá» lá»›p.</p><p>Trong cÃ¡c tÃ¬nh huá»‘ng sá»­ dá»¥ng nhiá»u pháº£n chiáº¿u, Ä‘áº¡i diá»‡n Ä‘á»™ng, CGLib vÃ  táº¡o JSP Ä‘á»™ng vÃ  OSGi, cáº§n cÃ³ kháº£ nÄƒng há»§y bá» lá»›p trong mÃ¡y áº£o Ä‘á»ƒ Ä‘áº£m báº£o khÃ´ng xáº£y ra lá»—i trÃ n bá»™ nhá»›.</p><h3 id="finalize" tabindex="-1"><a class="header-anchor" href="#finalize"><span>finalize()</span></a></h3><p><code>finalize()</code> tÆ°Æ¡ng tá»± nhÆ° hÃ m há»§y trong C++, Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c cÃ´ng viá»‡c nhÆ° Ä‘Ã³ng tÃ i nguyÃªn bÃªn ngoÃ i. Tuy nhiÃªn, viá»‡c sá»­ dá»¥ng <code>try-finally</code> hoáº·c cÃ¡c cÃ¡ch khÃ¡c cÃ³ thá»ƒ tá»‘t hÆ¡n vÃ  phÆ°Æ¡ng thá»©c nÃ y cÃ³ chi phÃ­ thá»±c thi cao, khÃ´ng cháº¯c cháº¯n vÃ  khÃ´ng Ä‘áº£m báº£o thá»© tá»± gá»i cá»§a cÃ¡c Ä‘á»‘i tÆ°á»£ng, do Ä‘Ã³ <strong>khÃ´ng nÃªn sá»­ dá»¥ng <code>finalize()</code></strong>.</p><p>Khi má»™t Ä‘á»‘i tÆ°á»£ng cÃ³ thá»ƒ Ä‘Æ°á»£c thu gom, náº¿u cáº§n thá»±c thi phÆ°Æ¡ng thá»©c <code>finalize()</code> cá»§a Ä‘á»‘i tÆ°á»£ng Ä‘Ã³, cÃ³ thá»ƒ lÃ m cho Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c tham chiáº¿u láº¡i vÃ  tá»± cá»©u mÃ¬nh.</p><h2 id="thuat-toan-thu-gom-rac" tabindex="-1"><a class="header-anchor" href="#thuat-toan-thu-gom-rac"><span>Thuáº­t toÃ¡n thu gom rÃ¡c</span></a></h2><h3 id="hieu-suat-thu-gom-rac" tabindex="-1"><a class="header-anchor" href="#hieu-suat-thu-gom-rac"><span>Hiá»‡u suáº¥t thu gom rÃ¡c</span></a></h3><p>CÃ³ hai chá»‰ sá»‘ chÃ­nh Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ hiá»‡u suáº¥t cá»§a bá»™ thu gom rÃ¡c:</p><ul><li><strong>Thá»i gian táº¡m dá»«ng</strong>Â - Thá»i gian mÃ  chÆ°Æ¡ng trÃ¬nh khÃ´ng thá»ƒ hoáº¡t Ä‘á»™ng do quÃ¡ trÃ¬nh thu gom rÃ¡c.</li><li><strong>ThÃ´ng lÆ°á»£ng</strong>Â - Tá»•ng sá»‘ cÃ´ng viá»‡c mÃ  á»©ng dá»¥ng cÃ³ thá»ƒ thá»±c hiá»‡n trong má»™t khoáº£ng thá»i gian cá»‘ Ä‘á»‹nh. Äá»‘i vá»›i cÃ¡c á»©ng dá»¥ng quan tÃ¢m Ä‘áº¿n thÃ´ng lÆ°á»£ng, thá»i gian táº¡m dá»«ng dÃ i cÃ³ thá»ƒ cháº¥p nháº­n Ä‘Æ°á»£c. VÃ¬ cÃ¡c á»©ng dá»¥ng cÃ³ thá»‘ng suáº¥t cao thÆ°á»ng táº­p trung vÃ o chu ká»³ thá»i gian dÃ i hÆ¡n, nÃªn thá»i gian pháº£n há»“i nhanh khÃ´ng Ä‘Æ°á»£c xem xÃ©t.</li></ul><h3 id="Ä‘anh-dau-don-dep-mark-sweep" tabindex="-1"><a class="header-anchor" href="#Ä‘anh-dau-don-dep-mark-sweep"><span>ÄÃ¡nh dáº¥u - Dá»n dáº¹p (Mark-Sweep)</span></a></h3><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230718172452.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>ÄÃ¡nh dáº¥u cÃ¡c Ä‘á»‘i tÆ°á»£ng cáº§n thu gom, sau Ä‘Ã³ dá»n dáº¹p cÃ¡c Ä‘á»‘i tÆ°á»£ng Ä‘Ã£ Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u.</p><p>NhÆ°á»£c Ä‘iá»ƒm:</p><ul><li>Hiá»‡u suáº¥t Ä‘Ã¡nh dáº¥u vÃ  dá»n dáº¹p Ä‘á»u khÃ´ng cao.</li><li>Táº¡o ra nhiá»u máº£nh bá»™ nhá»› khÃ´ng liÃªn tá»¥c, dáº«n Ä‘áº¿n khÃ´ng thá»ƒ cáº¥p phÃ¡t bá»™ nhá»› cho cÃ¡c Ä‘á»‘i tÆ°á»£ng lá»›n.</li></ul><h3 id="Ä‘anh-dau-sap-xep-mark-compact" tabindex="-1"><a class="header-anchor" href="#Ä‘anh-dau-sap-xep-mark-compact"><span>ÄÃ¡nh dáº¥u - Sáº¯p xáº¿p (Mark-Compact)</span></a></h3><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230718172523.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>Di chuyá»ƒn táº¥t cáº£ cÃ¡c Ä‘á»‘i tÆ°á»£ng cÃ²n sá»‘ng vá» má»™t Ä‘áº§u, sau Ä‘Ã³ xÃ³a bá» bá»™ nhá»› á»Ÿ phÃ­a bÃªn ngoÃ i ranh giá»›i.</p><p>PhÆ°Æ¡ng phÃ¡p nÃ y giáº£i quyáº¿t Ä‘Æ°á»£c váº¥n Ä‘á» vá» máº£nh bá»™ nhá»› khÃ´ng liÃªn tá»¥c, nhÆ°ng Ä‘á»“ng thá»i tÄƒng chi phÃ­ thá»±c hiá»‡n cá»§a thuáº­t toÃ¡n nÃ©n.</p><h3 id="sao-chep-copying" tabindex="-1"><a class="header-anchor" href="#sao-chep-copying"><span>Sao chÃ©p (Copying)</span></a></h3><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230718172532.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>Chia bá»™ nhá»› thÃ nh hai pháº§n báº±ng nhau, chá»‰ sá»­ dá»¥ng má»™t pháº§n trong má»—i láº§n. Khi pháº§n nÃ y Ä‘áº§y, cÃ¡c Ä‘á»‘i tÆ°á»£ng cÃ²n sá»‘ng sáº½ Ä‘Æ°á»£c sao chÃ©p sang pháº§n cÃ²n láº¡i, sau Ä‘Ã³ xÃ³a bá» pháº§n Ä‘Ã£ sá»­ dá»¥ng.</p><p>NhÆ°á»£c Ä‘iá»ƒm chÃ­nh lÃ  chá»‰ sá»­ dá»¥ng Ä‘Æ°á»£c má»™t ná»­a bá»™ nhá»›.</p><p>Hiá»‡n nay, cÃ¡c mÃ¡y áº£o thÆ°Æ¡ng máº¡i sá»­ dá»¥ng thuáº­t toÃ¡n nÃ y Ä‘á»ƒ thu gom tháº¿ há»‡ tráº», nhÆ°ng khÃ´ng pháº£i chia bá»™ nhá»› thÃ nh hai pháº§n báº±ng nhau, mÃ  chia thÃ nh má»™t pháº§n Eden lá»›n hÆ¡n vÃ  hai pháº§n Survivor nhá» hÆ¡n. Má»—i láº§n thu gom, cÃ¡c Ä‘á»‘i tÆ°á»£ng cÃ²n sá»‘ng trong Eden vÃ  Survivor sáº½ Ä‘Æ°á»£c sao chÃ©p sang Survivor cÃ²n láº¡i, sau Ä‘Ã³ dá»n dáº¹p Eden vÃ  Survivor Ä‘Ã£ sá»­ dá»¥ng. KÃ­ch thÆ°á»›c máº·c Ä‘á»‹nh cá»§a Eden vÃ  Survivor trong HotSpot VM lÃ  8:1 (cÃ³ thá»ƒ Ä‘iá»u chá»‰nh báº±ng tham sá»‘<code> -XX:SurvivorRatio</code>), Ä‘áº£m báº£o sá»­ dá»¥ng bá»™ nhá»› hiá»‡u quáº£ Ä‘áº¡t 90%. Náº¿u cÃ³ hÆ¡n 10% Ä‘á»‘i tÆ°á»£ng sá»‘ng sau má»—i láº§n thu gom, má»™t Survivor khÃ´ng Ä‘á»§, vÃ  cáº§n sá»± há»— trá»£ tá»« tháº¿ há»‡ cÅ© Ä‘á»ƒ cáº¥p phÃ¡t bá»™ nhá»› cho cÃ¡c Ä‘á»‘i tÆ°á»£ng khÃ´ng thá»ƒ lÆ°u trá»¯ trong Survivor.</p><h2 id="thuat-toan-thu-gom-rac-theo-the-he" tabindex="-1"><a class="header-anchor" href="#thuat-toan-thu-gom-rac-theo-the-he"><span>Thuáº­t toÃ¡n thu gom rÃ¡c theo tháº¿ há»‡</span></a></h2><p>CÃ¡c mÃ¡y áº£o hiá»‡n Ä‘áº¡i sá»­ dá»¥ng thuáº­t toÃ¡n thu gom rÃ¡c theo tháº¿ há»‡, chia bá»™ nhá»› thÃ nh cÃ¡c tháº¿ há»‡ dá»±a trÃªn tuá»•i thá» cá»§a Ä‘á»‘i tÆ°á»£ng vÃ  sá»­ dá»¥ng thuáº­t toÃ¡n thu gom phÃ¹ há»£p cho tá»«ng tháº¿ há»‡.</p><p>ThÆ°á»ng thÃ¬ Java Heap Ä‘Æ°á»£c chia thÃ nh tháº¿ há»‡ tráº» vÃ  tháº¿ há»‡ giÃ .</p><ul><li>Tháº¿ há»‡ tráº» sá»­ dá»¥ng thuáº­t toÃ¡n <strong>sao chÃ©p</strong>.</li><li>Tháº¿ há»‡ giÃ  sá»­ dá»¥ng thuáº­t toÃ¡n <strong>Ä‘Ã¡nh dáº¥u - dá»n dáº¹p</strong> hoáº·c <strong>Ä‘Ã¡nh dáº¥u - sáº¯p xáº¿p</strong>.</li></ul><div align="center"><img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/java/javacore/jvm/jvm-hotspot-heap-structure.png"></div><h4 id="the-he-tre" tabindex="-1"><a class="header-anchor" href="#the-he-tre"><span>Tháº¿ há»‡ tráº»</span></a></h4><p>Tháº¿ há»‡ tráº» lÃ  nÆ¡i táº¡o ra vÃ  há»§y bá» Ä‘a sá»‘ cÃ¡c Ä‘á»‘i tÆ°á»£ng, trong á»©ng dá»¥ng Java thÃ´ng thÆ°á»ng, háº§u háº¿t cÃ¡c Ä‘á»‘i tÆ°á»£ng cÃ³ tuá»•i thá» ngáº¯n. NÃ³ Ä‘Æ°á»£c chia thÃ nh khu vá»±c <code>Eden</code>, lÃ  nÆ¡i Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c cáº¥p phÃ¡t ban Ä‘áº§u, vÃ  hai khu vá»±c <code>Survivor</code>, Ä‘Ã´i khi Ä‘Æ°á»£c gá»i lÃ  <code>from</code> vÃ  <code>to</code>, Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ lÆ°u trá»¯ cÃ¡c Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c giá»¯ láº¡i tá»« quÃ¡ trÃ¬nh thu gom nhá» trÆ°á»›c Ä‘Ã³.</p><p>JVM sáº½ chá»n ngáº«u nhiÃªn má»™t khu vá»±c <code>Survivor</code> lÃ m <code>to</code>, vÃ  trong quÃ¡ trÃ¬nh thu gom rÃ¡c, cÃ¡c Ä‘á»‘i tÆ°á»£ng sá»‘ng sÃ³t trong <code>Eden</code> vÃ  khu vá»±c <code>from</code> sáº½ Ä‘Æ°á»£c sao chÃ©p vÃ o khu vá»±c <code>to</code>. Thiáº¿t káº¿ nÃ y nháº±m má»¥c Ä‘Ã­ch ngÄƒn cháº·n sá»± phÃ¢n máº£nh bá»™ nhá»› vÃ  tiáº¿p tá»¥c lÃ m sáº¡ch cÃ¡c Ä‘á»‘i tÆ°á»£ng khÃ´ng sá»­ dá»¥ng.</p><p>Java Virtual Machine sáº½ ghi láº¡i sá»‘ láº§n sao chÃ©p cá»§a cÃ¡c Ä‘á»‘i tÆ°á»£ng trong khu vá»±c <code>Survivor</code>. Náº¿u má»™t Ä‘á»‘i tÆ°á»£ng Ä‘Ã£ Ä‘Æ°á»£c sao chÃ©p 15 láº§n (tÆ°Æ¡ng á»©ng vá»›i tham sá»‘ <code>-XX:+MaxTenuringThreshold</code> cá»§a mÃ¡y áº£o), Ä‘á»‘i tÆ°á»£ng Ä‘Ã³ sáº½ Ä‘Æ°á»£c thÄƒng chuyá»ƒn (promote) lÃªn tháº¿ há»‡ giÃ . NgoÃ i ra, náº¿u má»™t khu vá»±c <code>Survivor</code> Ä‘Ã£ sá»­ dá»¥ng 50% (tÆ°Æ¡ng á»©ng vá»›i tham sá»‘ <code>-XX:TargetSurvivorRatio</code> cá»§a mÃ¡y áº£o), cÃ¡c Ä‘á»‘i tÆ°á»£ng cÃ³ sá»‘ láº§n sao chÃ©p cao hÆ¡n cÅ©ng sáº½ Ä‘Æ°á»£c thÄƒng chuyá»ƒn lÃªn tháº¿ há»‡ giÃ .</p><h4 id="the-he-gia" tabindex="-1"><a class="header-anchor" href="#the-he-gia"><span>Tháº¿ há»‡ giÃ </span></a></h4><p>Tháº¿ há»‡ giÃ  chá»©a cÃ¡c Ä‘á»‘i tÆ°á»£ng cÃ³ tuá»•i thá» dÃ i, thÆ°á»ng lÃ  cÃ¡c Ä‘á»‘i tÆ°á»£ng Ä‘Ã£ tá»“n táº¡i trong tháº¿ há»‡ tráº» vÃ  Ä‘Ã£ Ä‘Æ°á»£c sao chÃ©p nhiá»u láº§n. Khi khÃ´ng cÃ²n Ä‘á»§ khÃ´ng gian trong tháº¿ há»‡ tráº» Ä‘á»ƒ sao chÃ©p cÃ¡c Ä‘á»‘i tÆ°á»£ng, JVM sáº½ chuyá»ƒn chÃºng trá»±c tiáº¿p vÃ o tháº¿ há»‡ giÃ .</p><h4 id="vung-vinh-vien" tabindex="-1"><a class="header-anchor" href="#vung-vinh-vien"><span>VÃ¹ng vÄ©nh viá»…n</span></a></h4><p>ÄÃ¢y lÃ  pháº§n cá»§a phÆ°Æ¡ng phÃ¡p thá»±c hiá»‡n cá»§a JVM trÆ°á»›c Ä‘Ã¢y, lÆ°u trá»¯ cÃ¡c siÃªu dá»¯ liá»‡u lá»›p Java, báº£ng háº±ng sá»‘ vÃ  bá»™ Ä‘á»‡m chuá»—i Intern. Tá»« JDK 8 trá»Ÿ Ä‘i, khÃ´ng cÃ²n VÃ¹ng vÄ©nh viá»…n nÃ y ná»¯a.</p><h4 id="tham-so-jvm" tabindex="-1"><a class="header-anchor" href="#tham-so-jvm"><span>Tham sá»‘ JVM</span></a></h4><p>DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ tham sá»‘ JVM cho phÃ©p Ä‘iá»u chá»‰nh kÃ­ch thÆ°á»›c cá»§a Heap, cÃ¡c tháº¿ há»‡ vÃ  cÃ¡c vÃ¹ng nhá»› liÃªn quan:</p><table><thead><tr><th>Cáº¥u hÃ¬nh</th><th>MÃ´ táº£</th></tr></thead><tbody><tr><td><code>-Xss</code></td><td>KÃ­ch thÆ°á»›c ngÄƒn xáº¿p cá»§a mÃ¡y áº£o.</td></tr><tr><td><code>-Xms</code></td><td>GiÃ¡ trá»‹ khá»Ÿi táº¡o cá»§a Heap.</td></tr><tr><td><code>-Xmx</code></td><td>GiÃ¡ trá»‹ tá»‘i Ä‘a cá»§a Heap.</td></tr><tr><td><code>-Xmn</code></td><td>KÃ­ch thÆ°á»›c cá»§a tháº¿ há»‡ tráº».</td></tr><tr><td><code>-XX:NewSize</code></td><td>GiÃ¡ trá»‹ khá»Ÿi táº¡o cá»§a tháº¿ há»‡ tráº».</td></tr><tr><td><code>-XX:MaxNewSize</code></td><td>GiÃ¡ trá»‹ tá»‘i Ä‘a cá»§a tháº¿ há»‡ tráº».</td></tr><tr><td><code>-XX:NewRatio</code></td><td>Tá»· lá»‡ giá»¯a tháº¿ há»‡ tráº» vÃ  tháº¿ há»‡ giÃ . Máº·c Ä‘á»‹nh lÃ  2, tá»©c lÃ  tháº¿ há»‡ giÃ  gáº¥p Ä‘Ã´i tháº¿ há»‡ tráº».</td></tr><tr><td><code>-XX:SurvivorRatio</code></td><td>Tá»· lá»‡ giá»¯a khu vá»±c Eden vÃ  khu vá»±c Survivor. Máº·c Ä‘á»‹nh lÃ  8, tá»©c lÃ  khu vá»±c <code>eden</code> chiáº¿m 80% kÃ­ch thÆ°á»›c, hai khu vá»±c <code>survivor</code> má»—i khu vá»±c chiáº¿m 10% kÃ­ch thÆ°á»›c.</td></tr><tr><td><code>-XX:PermSize</code></td><td>GiÃ¡ trá»‹ khá»Ÿi táº¡o cá»§a VÃ¹ng vÄ©nh viá»…n.</td></tr><tr><td><code>-XX:MaxPermSize</code></td><td>GiÃ¡ trá»‹ tá»‘i Ä‘a cá»§a VÃ¹ng vÄ©nh viá»…n.</td></tr></tbody></table><h2 id="bo-thu-gom-rac" tabindex="-1"><a class="header-anchor" href="#bo-thu-gom-rac"><span>Bá»™ thu gom rÃ¡c</span></a></h2><div align="center"><img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/java/javacore/jvm/jvm-gc-overview.jpg"></div><p>TrÃªn Ä‘Ã¢y lÃ  7 bá»™ thu gom rÃ¡c trong mÃ¡y áº£o HotSpot, cÃ¡c Ä‘Æ°á»ng káº¿t ná»‘i biá»ƒu thá»‹ cÃ¡c bá»™ thu gom rÃ¡c cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng cÃ¹ng nhau.</p><p>ChÃº thÃ­ch: Bá»™ thu gom rÃ¡c G1 cÃ³ thá»ƒ thu gom bá»™ nhá»› cá»§a cáº£ tháº¿ há»‡ tráº» vÃ  tháº¿ há»‡ giÃ . Trong khi Ä‘Ã³, cÃ¡c bá»™ thu gom rÃ¡c khÃ¡c chá»‰ cÃ³ thá»ƒ thu gom bá»™ nhá»› cá»§a má»™t tháº¿ há»‡ cá»¥ thá»ƒ.</p><h3 id="bo-thu-gom-rac-tuan-tu" tabindex="-1"><a class="header-anchor" href="#bo-thu-gom-rac-tuan-tu"><span>Bá»™ thu gom rÃ¡c tuáº§n tá»±</span></a></h3><p>Bá»™ thu gom rÃ¡c tuáº§n tá»± (Serial) lÃ  bá»™ thu gom rÃ¡c cÆ¡ báº£n nháº¥t vÃ  cÃ³ lá»‹ch sá»­ phÃ¡t triá»ƒn lÃ¢u nháº¥t.</p><p>Bá»™ thu gom rÃ¡c tuáº§n tá»± lÃ  cáº¥u hÃ¬nh máº·c Ä‘á»‹nh cá»§a cháº¿ Ä‘á»™ <code>client</code>. VÃ¬ trong cháº¿ Ä‘á»™ client, bá»™ nhá»› Ä‘Æ°á»£c cáº¥p phÃ¡t cho mÃ¡y áº£o thÆ°á»ng khÃ´ng lá»›n. Thá»i gian táº¡m dá»«ng cá»§a bá»™ thu gom rÃ¡c Serial khi thu gom tháº¿ há»‡ tráº» vÃ i chá»¥c megabyte hoáº·c cáº£ trÄƒm megabyte cÃ³ thá»ƒ kiá»ƒm soÃ¡t trong khoáº£ng hÆ¡n má»™t trÄƒm mili giÃ¢y, miá»…n lÃ  khÃ´ng quÃ¡ thÆ°á»ng xuyÃªn, thá»i gian táº¡m dá»«ng nÃ y lÃ  cháº¥p nháº­n Ä‘Æ°á»£c.</p><p><strong>Bá»™ thu gom rÃ¡c tuáº§n tá»± sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p stop-the-world vá»›i má»™t luá»“ng Ä‘á»ƒ thu gom rÃ¡c</strong>. Khi khÃ´ng gian bá»™ nhá»› khÃ´ng Ä‘á»§, bá»™ thu gom rÃ¡c tuáº§n tá»± Ä‘áº·t cá» dá»«ng, chá» táº¥t cáº£ cÃ¡c luá»“ng Ä‘á»u Ä‘áº¡t Ä‘áº¿n Ä‘iá»ƒm an toÃ n (Safepoint), sau Ä‘Ã³ luá»“ng á»©ng dá»¥ng táº¡m dá»«ng, bá»™ thu gom rÃ¡c tuáº§n tá»± báº¯t Ä‘áº§u lÃ m viá»‡c, <strong>sá»­ dá»¥ng má»™t luá»“ng Ä‘á»ƒ thu gom khÃ´ng gian vÃ  sáº¯p xáº¿p láº¡i bá»™ nhá»›</strong>.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230718201633.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>Luá»“ng Ä‘Æ¡n nghÄ©a cÃ³ nghÄ©a lÃ  Ä‘á»™ phá»©c táº¡p tháº¥p hÆ¡n, chiáº¿m Ã­t bá»™ nhá»› hÆ¡n vÃ  hiá»‡u suáº¥t thu gom rÃ¡c cao; nhÆ°ng Ä‘á»“ng thá»i cÅ©ng cÃ³ nghÄ©a lÃ  khÃ´ng thá»ƒ táº­n dá»¥ng hiá»‡u suáº¥t Ä‘a nhÃ¢n. TrÃªn thá»±c táº¿, bá»™ thu gom rÃ¡c tuáº§n tá»± ráº¥t phÃ¹ há»£p vá»›i cÃ¡c trÆ°á»ng há»£p cÃ³ Ã­t bá»™ nhá»›, CPU Ä‘Æ¡n lÃµi hoáº·c CPU hai lÃµi.</p><h4 id="bo-thu-gom-rac-serial" tabindex="-1"><a class="header-anchor" href="#bo-thu-gom-rac-serial"><span>Bá»™ thu gom rÃ¡c Serial</span></a></h4><blockquote><p>Báº­t tÃ¹y chá»n: <code>-XX:+UseSerialGC</code></p><p>Sau khi báº­t tÃ¹y chá»n nÃ y, sá»­ dá»¥ng bá»™ thu gom rÃ¡c <strong>Serial</strong> + <strong>Serial Old</strong> Ä‘á»ƒ thu gom bá»™ nhá»›.</p></blockquote><h4 id="bo-thu-gom-rac-serial-old" tabindex="-1"><a class="header-anchor" href="#bo-thu-gom-rac-serial-old"><span>Bá»™ thu gom rÃ¡c Serial Old</span></a></h4><p>Serial Old lÃ  phiÃªn báº£n cá»§a bá»™ thu gom rÃ¡c Serial dÃ nh cho tháº¿ há»‡ giÃ , cÅ©ng Ä‘Æ°á»£c sá»­ dá»¥ng cho mÃ¡y áº£o cháº¿ Ä‘á»™ <code>client</code>. Náº¿u sá»­ dá»¥ng trong cháº¿ Ä‘á»™ <code>server</code>, nÃ³ cÃ³ hai má»¥c Ä‘Ã­ch:</p><ul><li>Trong JDK 1.5 vÃ  cÃ¡c phiÃªn báº£n trÆ°á»›c Ä‘Ã³ (trÆ°á»›c khi Parallel Old ra Ä‘á»i), nÃ³ Ä‘Æ°á»£c sá»­ dá»¥ng cÃ¹ng vá»›i bá»™ thu gom rÃ¡c Parallel Scavenge.</li><li>LÃ  phÆ°Æ¡ng Ã¡n dá»± phÃ²ng cho bá»™ thu gom rÃ¡c CMS, Ä‘Æ°á»£c sá»­ dá»¥ng khi xáº£y ra lá»—i thu gom Ä‘á»“ng thá»i Concurrent Mode Failure.</li></ul><h3 id="bo-thu-gom-rac-song-song" tabindex="-1"><a class="header-anchor" href="#bo-thu-gom-rac-song-song"><span>Bá»™ thu gom rÃ¡c song song</span></a></h3><blockquote><p>Báº­t tÃ¹y chá»n: <code>-XX:+UseParallelGC</code></p><p>Sau khi báº­t tÃ¹y chá»n nÃ y, sá»­ dá»¥ng bá»™ thu gom rÃ¡c <strong>Parallel Scavenge</strong> + <strong>Serial Old</strong> Ä‘á»ƒ thu gom bá»™ nhá»›.</p><p>Báº­t tÃ¹y chá»n: <code>-XX:+UseParallelOldGC</code></p><p>Sau khi báº­t tÃ¹y chá»n nÃ y, sá»­ dá»¥ng bá»™ thu gom rÃ¡c <strong>Parallel Scavenge</strong> + <strong>Parallel Old</strong> Ä‘á»ƒ thu gom bá»™ nhá»›.</p></blockquote><p>CÃ¡c bá»™ thu gom rÃ¡c khÃ¡c Ä‘á»u táº­p trung vÃ o thá»i gian táº¡m dá»«ng, trong khi <strong>bá»™ thu gom rÃ¡c song song (Parallel) táº­p trung vÃ o thÃ´ng lÆ°á»£ng (Throughput)</strong>.</p><ul><li>Thá»i gian táº¡m dá»«ng cÃ ng ngáº¯n thÃ¬ cÃ ng phÃ¹ há»£p vá»›i cÃ¡c chÆ°Æ¡ng trÃ¬nh cáº§n tÆ°Æ¡ng tÃ¡c vá»›i ngÆ°á»i dÃ¹ng, thá»i gian pháº£n há»“i tá»‘t cÃ³ thá»ƒ cáº£i thiá»‡n tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng;</li><li>Trong khi Ä‘Ã³, thÃ´ng lÆ°á»£ng cao cÃ³ thá»ƒ táº­n dá»¥ng hiá»‡u suáº¥t CPU má»™t cÃ¡ch hiá»‡u quáº£, hoÃ n thÃ nh nhanh nhiá»‡m vá»¥ tÃ­nh toÃ¡n cá»§a chÆ°Æ¡ng trÃ¬nh, chá»§ yáº¿u phÃ¹ há»£p vá»›i cÃ¡c nhiá»‡m vá»¥ tÃ­nh toÃ¡n ná»n mÃ  khÃ´ng cáº§n nhiá»u tÆ°Æ¡ng tÃ¡c.</li></ul><div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span>ThÃ´ng lÆ°á»£ng = Thá»i gian cháº¡y mÃ£ ngÆ°á»i dÃ¹ng / (Thá»i gian cháº¡y mÃ£ ngÆ°á»i dÃ¹ng + Thá»i gian thu gom rÃ¡c)</span></span></code></pre></div><p><strong>Bá»™ thu gom rÃ¡c song song lÃ  bá»™ thu gom rÃ¡c máº·c Ä‘á»‹nh trong cháº¿ Ä‘á»™ server.</strong></p><p>Bá»™ thu gom rÃ¡c song song hoáº¡t Ä‘á»™ng tÆ°Æ¡ng tá»± nhÆ° bá»™ thu gom rÃ¡c tuáº§n tá»±, Ä‘á»u sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p stop-the-world, chá»‰ khÃ¡c lÃ  táº¡m dá»«ng thá»±c hiá»‡n thu gom rÃ¡c song song. <strong>Bá»™ thu gom rÃ¡c song song sá»­ dá»¥ng thuáº­t toÃ¡n sao chÃ©p cho tháº¿ há»‡ tráº» vÃ  thuáº­t toÃ¡n Ä‘Ã¡nh dáº¥u-sáº¯p xáº¿p cho tháº¿ há»‡ giÃ </strong>, Ä‘á»“ng thá»i nÃ©n bá»™ nhá»› trong quÃ¡ trÃ¬nh thu gom rÃ¡c. Bá»™ thu gom rÃ¡c song song phÃ¹ há»£p vá»›i cÃ¡c tÃ¬nh huá»‘ng yÃªu cáº§u thÃ´ng lÆ°á»£ng cao hÆ¡n yÃªu cáº§u Ä‘á»™ trá»… vÃ  cung cáº¥p thÃ´ng lÆ°á»£ng tá»‘t nháº¥t trong trÆ°á»ng há»£p Ä‘áº£m báº£o Ä‘á»™ trá»… tá»‡ nháº¥t.</p><p><strong>Trong cÃ¡c trÆ°á»ng há»£p quan tÃ¢m Ä‘áº¿n thÃ´ng lÆ°á»£ng vÃ  tÃ i nguyÃªn CPU, nÃªn Æ°u tiÃªn sá»­ dá»¥ng bá»™ thu gom rÃ¡c Parallel Scavenge + Parallel Old.</strong></p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230718202918.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><h4 id="bo-thu-gom-rac-parallel-scavenge" tabindex="-1"><a class="header-anchor" href="#bo-thu-gom-rac-parallel-scavenge"><span>Bá»™ thu gom rÃ¡c Parallel Scavenge</span></a></h4><p>Bá»™ thu gom rÃ¡c Parallel Scavenge cung cáº¥p hai tham sá»‘ Ä‘á»ƒ kiá»ƒm soÃ¡t thÃ´ng lÆ°á»£ng chÃ­nh xÃ¡c, Ä‘Ã³ lÃ :</p><ul><li><code>-XX:MaxGCPauseMillis</code> - Kiá»ƒm soÃ¡t thá»i gian táº¡m dá»«ng thu gom rÃ¡c tá»‘i Ä‘a, bá»™ thu gom rÃ¡c sáº½ cá»‘ gáº¯ng Ä‘áº£m báº£o thá»i gian thu gom rÃ¡c khÃ´ng vÆ°á»£t quÃ¡ giÃ¡ trá»‹ Ä‘Æ°á»£c Ä‘áº·t.</li><li><code>-XX:GCTimeRatio</code> - Thiáº¿t láº­p trá»±c tiáº¿p kÃ­ch thÆ°á»›c thÃ´ng lÆ°á»£ng (giÃ¡ trá»‹ lÃ  sá»‘ nguyÃªn lá»›n hÆ¡n 0 vÃ  nhá» hÆ¡n 100).</li></ul><p>RÃºt ngáº¯n thá»i gian táº¡m dá»«ng Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng cÃ¡ch hy sinh thÃ´ng lÆ°á»£ng vÃ  khÃ´ng gian tháº¿ há»‡ tráº»: khÃ´ng gian tháº¿ há»‡ tráº» nhá» hÆ¡n, thu gom rÃ¡c trá»Ÿ nÃªn thÆ°á»ng xuyÃªn hÆ¡n, dáº«n Ä‘áº¿n giáº£m thÃ´ng lÆ°á»£ng.</p><p>Bá»™ thu gom rÃ¡c Parallel Scavenge cÃ²n cung cáº¥p má»™t tham sá»‘ <code>-XX:+UseAdaptiveSizePolicy</code>, Ä‘Ã¢y lÃ  má»™t cá» báº­t, khi báº­t cá» nÃ y, khÃ´ng cáº§n chá»‰ Ä‘á»‹nh kÃ­ch thÆ°á»›c tháº¿ há»‡ tráº» (<code>-Xmn</code>), tá»· lá»‡ Eden vÃ  Survivor (<code>-XX:SurvivorRatio</code>), tuá»•i Ä‘á»‘i tÆ°á»£ng chuyá»ƒn lÃªn tháº¿ há»‡ giÃ  (<code>-XX:PretenureSizeThreshold</code>) vÃ  cÃ¡c tham sá»‘ chi tiáº¿t khÃ¡c, mÃ¡y áº£o sáº½ dá»±a trÃªn thÃ´ng tin giÃ¡m sÃ¡t hiá»‡u suáº¥t hiá»‡n táº¡i cá»§a há»‡ thá»‘ng, tá»± Ä‘á»™ng Ä‘iá»u chá»‰nh cÃ¡c tham sá»‘ nÃ y Ä‘á»ƒ cung cáº¥p thá»i gian táº¡m dá»«ng tá»‘t nháº¥t hoáº·c thÃ´ng lÆ°á»£ng tá»‘i Ä‘a, phÆ°Æ¡ng phÃ¡p nÃ y Ä‘Æ°á»£c gá»i lÃ  cÆ¡ cháº¿ Ä‘iá»u chá»‰nh tá»± Ä‘á»™ng GC (GC Ergonomics).</p><h4 id="bo-thu-gom-rac-parallel-old" tabindex="-1"><a class="header-anchor" href="#bo-thu-gom-rac-parallel-old"><span>Bá»™ thu gom rÃ¡c Parallel Old</span></a></h4><p>ÄÃ¢y lÃ  phiÃªn báº£n cá»§a bá»™ thu gom rÃ¡c Parallel Scavenge dÃ nh cho tháº¿ há»‡ giÃ , sá»­ dá»¥ng <strong>nhiá»u luá»“ng vÃ  thuáº­t toÃ¡n &quot;Ä‘Ã¡nh dáº¥u-sáº¯p xáº¿p&quot;</strong>.</p><h3 id="bo-thu-gom-rac-Ä‘ong-thoi-Ä‘anh-dau-xoa" tabindex="-1"><a class="header-anchor" href="#bo-thu-gom-rac-Ä‘ong-thoi-Ä‘anh-dau-xoa"><span>Bá»™ thu gom rÃ¡c Ä‘á»“ng thá»i Ä‘Ã¡nh dáº¥u-xÃ³a</span></a></h3><blockquote><p>Báº­t tÃ¹y chá»n: <code>-XX:+UseConcMarkSweepGC</code></p><p>Sau khi báº­t tÃ¹y chá»n nÃ y, sá»­ dá»¥ng bá»™ thu gom rÃ¡c <strong>CMS</strong> + <strong>ParNew</strong> + <strong>Serial Old</strong> Ä‘á»ƒ thu gom bá»™ nhá»›.</p></blockquote><p>Bá»™ thu gom rÃ¡c Ä‘á»“ng thá»i Ä‘Ã¡nh dáº¥u-xÃ³a nháº±m má»¥c tiÃªu giáº£m thiá»ƒu thá»i gian táº¡m dá»«ng.</p><p>Sau khi báº­t tÃ¹y chá»n nÃ y, ParNew Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thu gom tháº¿ há»‡ tráº»; CMS Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thu gom tháº¿ há»‡ giÃ . Náº¿u CMS táº¡o ra quÃ¡ nhiá»u máº£nh vá»¥n mÃ  khÃ´ng thá»ƒ chá»©a Ä‘Æ°á»£c rÃ¡c lÆ°u Ä‘á»™ng, JVM sáº½ gáº·p pháº£i <code>Concurrent Mode Failure</code> , lÃºc nÃ y Serial Old sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thay tháº¿ CMS Ä‘á»ƒ lÃ m sáº¡ch máº£nh vá»¥n.</p><h4 id="bo-thu-gom-rac-cms" tabindex="-1"><a class="header-anchor" href="#bo-thu-gom-rac-cms"><span>Bá»™ thu gom rÃ¡c CMS</span></a></h4><p><strong>Bá»™ thu gom rÃ¡c CMS lÃ  má»™t bá»™ thu gom rÃ¡c Ä‘á»“ng thá»i vá»›i má»¥c tiÃªu giáº£m thiá»ƒu thá»i gian táº¡m dá»«ng.</strong></p><p>CMS (Concurrent Mark Sweep), Mark Sweep chá»‰ Ä‘Ã¡nh dáº¥u-xÃ³a.</p><h5 id="co-che-thu-gom-cua-cms" tabindex="-1"><a class="header-anchor" href="#co-che-thu-gom-cua-cms"><span>CÆ¡ cháº¿ thu gom cá»§a CMS</span></a></h5><p>BÆ°á»›c thu gom cá»§a bá»™ thu gom rÃ¡c CMS nhÆ° sau:</p><ol><li><strong>ÄÃ¡nh dáº¥u ban Ä‘áº§u</strong>: Chá»‰ Ä‘Æ¡n giáº£n lÃ  Ä‘Ã¡nh dáº¥u cÃ¡c Ä‘á»‘i tÆ°á»£ng mÃ  GC Roots cÃ³ thá»ƒ trá»±c tiáº¿p liÃªn káº¿t Ä‘áº¿n, nhanh chÃ³ng vÃ  cáº§n táº¡m dá»«ng.</li><li><strong>ÄÃ¡nh dáº¥u Ä‘á»“ng thá»i</strong>: QuÃ¡ trÃ¬nh theo dÃµi GC Roots Ä‘á»ƒ tÃ¬m cÃ¡c Ä‘á»‘i tÆ°á»£ng sá»‘ng trong quÃ¡ trÃ¬nh thá»±c thi á»©ng dá»¥ng, lÃ  quÃ¡ trÃ¬nh tá»‘n thá»i gian nháº¥t, khÃ´ng cáº§n táº¡m dá»«ng.</li><li><strong>ÄÃ¡nh dáº¥u láº¡i</strong>: Äá»ƒ sá»­a chá»¯a cÃ¡c Ä‘á»‘i tÆ°á»£ng Ä‘Ã£ bá»‹ thay Ä‘á»•i trong quÃ¡ trÃ¬nh Ä‘Ã¡nh dáº¥u Ä‘á»“ng thá»i, cáº§n táº¡m dá»«ng.</li><li><strong>XÃ³a Ä‘á»“ng thá»i</strong>: Thu há»“i cÃ¡c Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh lÃ  khÃ´ng thá»ƒ truy cáº­p trong giai Ä‘oáº¡n Ä‘Ã¡nh dáº¥u. KhÃ´ng cáº§n táº¡m dá»«ng.</li></ol><p>Trong suá»‘t quÃ¡ trÃ¬nh thu gom, cÃ¡c luá»“ng thu gom rÃ¡c cÃ³ thá»ƒ cháº¡y song song vá»›i cÃ¡c luá»“ng á»©ng dá»¥ng, khÃ´ng cáº§n táº¡m dá»«ng.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230718203540.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><h5 id="buoc-thu-gom-the-he-tre-cua-cms" tabindex="-1"><a class="header-anchor" href="#buoc-thu-gom-the-he-tre-cua-cms"><span>BÆ°á»›c thu gom tháº¿ há»‡ tráº» cá»§a CMS</span></a></h5><p><strong>(1) PhÃ¢n chia khÃ´ng gian heap thÃ nh ba pháº§n</strong></p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide1.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>Tháº¿ há»‡ tráº» Ä‘Æ°á»£c chia thÃ nh má»™t khu vá»±c Eden vÃ  hai khu vá»±c Survivor. Tháº¿ há»‡ giÃ  lÃ  má»™t khÃ´ng gian liÃªn tá»¥c. Thu gom Ä‘á»‘i tÆ°á»£ng táº¡i chá»—. KhÃ´ng nÃ©n trá»« khi cÃ³ FullGC.</p><p><strong>(2) LÃ m tháº¿ nÃ o CMS thu gom tháº¿ há»‡ tráº»</strong></p><p>Tháº¿ há»‡ tráº» Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u mÃ u xanh lÃ¡ cÃ¢y, tháº¿ há»‡ giÃ  Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u mÃ u xanh lam. Náº¿u á»©ng dá»¥ng cá»§a báº¡n Ä‘Ã£ cháº¡y má»™t thá»i gian, heap cá»§a CMS sáº½ trÃ´ng nhÆ° tháº¿ nÃ y. CÃ¡c Ä‘á»‘i tÆ°á»£ng phÃ¢n tÃ¡n trong khÃ´ng gian tháº¿ há»‡ giÃ .</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide2.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>Vá»›i CMS, cÃ¡c Ä‘á»‘i tÆ°á»£ng trong tháº¿ há»‡ giÃ  Ä‘Æ°á»£c giáº£i phÃ³ng táº¡i chá»—. ChÃºng khÃ´ng bá»‹ di chuyá»ƒn. KhÃ´ng gian nÃ y khÃ´ng bá»‹ nÃ©n trá»« khi cÃ³ FullGC.</p><p><strong>(3) Thu gom tháº¿ há»‡ tráº»</strong></p><p>Sao chÃ©p cÃ¡c Ä‘á»‘i tÆ°á»£ng sá»‘ng tá»« Eden vÃ  Survivor sang Survivor khÃ¡c. Táº¥t cáº£ cÃ¡c Ä‘á»‘i tÆ°á»£ng Ä‘áº¡t Ä‘áº¿n ngÆ°á»¡ng tuá»•i cá»§a chÃºng sáº½ Ä‘Æ°á»£c thÄƒng chuyá»ƒn sang tháº¿ há»‡ giÃ .</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide3.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p><strong>(4) Sau khi thu gom tháº¿ há»‡ tráº»</strong></p><p>Sau má»™t láº§n thu gom rÃ¡c tháº¿ há»‡ tráº», Eden vÃ  má»™t trong hai Survivor sáº½ Ä‘Æ°á»£c lÃ m trá»‘ng.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide4.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>CÃ¡c Ä‘á»‘i tÆ°á»£ng má»›i Ä‘Æ°á»£c thÄƒng chuyá»ƒn sáº½ Ä‘Æ°á»£c hiá»ƒn thá»‹ mÃ u xanh lam trong hÃ¬nh trÃªn, cÃ¡c Ä‘á»‘i tÆ°á»£ng mÃ u xanh lÃ¡ cÃ¢y lÃ  nhá»¯ng Ä‘á»‘i tÆ°á»£ng tráº» chÆ°a thÄƒng chuyá»ƒn sang tháº¿ há»‡ giÃ .</p><h5 id="buoc-thu-gom-the-he-gia-cua-cms" tabindex="-1"><a class="header-anchor" href="#buoc-thu-gom-the-he-gia-cua-cms"><span>BÆ°á»›c thu gom tháº¿ há»‡ giÃ  cá»§a CMS</span></a></h5><p><strong>(1) Thu gom tháº¿ há»‡ giÃ  cá»§a CMS</strong></p><p>CÃ³ hai sá»± kiá»‡n stop the world: Ä‘Ã¡nh dáº¥u ban Ä‘áº§u vÃ  Ä‘Ã¡nh dáº¥u láº¡i. Khi tháº¿ há»‡ giÃ  Ä‘áº¡t Ä‘áº¿n tá»· lá»‡ sá»­ dá»¥ng bá»™ nhá»› cá»¥ thá»ƒ, CMS báº¯t Ä‘áº§u thá»±c hiá»‡n.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide5.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><ul><li>ÄÃ¡nh dáº¥u ban Ä‘áº§u lÃ  giai Ä‘oáº¡n táº¡m dá»«ng ngáº¯n, chá»‰ Ä‘Ã¡nh dáº¥u cÃ¡c Ä‘á»‘i tÆ°á»£ng cÃ³ thá»ƒ tiáº¿p cáº­n Ä‘Æ°á»£c.</li><li>ÄÃ¡nh dáº¥u Ä‘á»“ng thá»i tÃ¬m kiáº¿m Ä‘á»‘i tÆ°á»£ng sá»‘ng trong quÃ¡ trÃ¬nh thá»±c thi á»©ng dá»¥ng.</li><li>Cuá»‘i cÃ¹ng, trong giai Ä‘oáº¡n Ä‘Ã¡nh dáº¥u láº¡i, tÃ¬m kiáº¿m cÃ¡c Ä‘á»‘i tÆ°á»£ng bá»‹ máº¥t trong giai Ä‘oáº¡n Ä‘Ã¡nh dáº¥u Ä‘á»“ng thá»i trÆ°á»›c Ä‘Ã³.</li></ul><p><strong>(2) Thu gom tháº¿ há»‡ giÃ  - xÃ³a Ä‘á»“ng thá»i</strong></p><p>CÃ¡c Ä‘á»‘i tÆ°á»£ng chÆ°a Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u sáº½ Ä‘Æ°á»£c giáº£i phÃ³ng táº¡i chá»—. KhÃ´ng nÃ©n trá»« khi cÃ³ FullGC.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide6.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p><strong>LÆ°u Ã½:</strong> Äá»‘i tÆ°á»£ng chÆ°a Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i Ä‘á»‘i tÆ°á»£ng Ä‘Ã£ cháº¿t.</p><p><strong>(3) Thu gom tháº¿ há»‡ giÃ  - sau khi xÃ³a</strong></p><p>Sau giai Ä‘oáº¡n xÃ³a, báº¡n cÃ³ thá»ƒ tháº¥y ráº¥t nhiá»u bá»™ nhá»› Ä‘Æ°á»£c giáº£i phÃ³ng. Báº¡n cÅ©ng cÃ³ thá»ƒ nháº­n tháº¥y khÃ´ng cÃ³ hoáº¡t Ä‘á»™ng nÃ©n.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide7.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>Cuá»‘i cÃ¹ng, bá»™ thu gom rÃ¡c CMS sáº½ tiáº¿p tá»¥c vÃ o giai Ä‘oáº¡n thiáº¿t láº­p láº¡i, chá» Ä‘á»£i thá»i Ä‘iá»ƒm thu gom rÃ¡c tiáº¿p theo.</p><h5 id="Ä‘ac-Ä‘iem-cua-cms" tabindex="-1"><a class="header-anchor" href="#Ä‘ac-Ä‘iem-cua-cms"><span>Äáº·c Ä‘iá»ƒm cá»§a CMS</span></a></h5><p>Bá»™ thu gom rÃ¡c CMS cÃ³ cÃ¡c nhÆ°á»£c Ä‘iá»ƒm sau:</p><ul><li>Thu gom Ä‘á»“ng thá»i - Äá»“ng thá»i cÃ³ nghÄ©a lÃ  cÃ¡c luá»“ng á»©ng dá»¥ng vÃ  luá»“ng GC cÃ³ thá»ƒ cháº¡y song song, khÃ´ng cáº§n táº¡m dá»«ng.</li><li>ThÃ´ng lÆ°á»£ng tháº¥p - Thá»i gian táº¡m dá»«ng tháº¥p Ä‘Æ°á»£c Ä‘Ã¡nh Ä‘á»•i báº±ng cÃ¡ch hy sinh thÃ´ng lÆ°á»£ng, dáº«n Ä‘áº¿n tá»· lá»‡ sá»­ dá»¥ng CPU khÃ´ng cao.</li><li>KhÃ´ng thá»ƒ xá»­ lÃ½ rÃ¡c lÆ°u Ä‘á»™ng - CÃ³ thá»ƒ xáº£y ra <code>Concurrent Mode Failure</code>. RÃ¡c lÆ°u Ä‘á»™ng lÃ  rÃ¡c Ä‘Æ°á»£c táº¡o ra trong giai Ä‘oáº¡n xÃ³a Ä‘á»“ng thá»i do luá»“ng á»©ng dá»¥ng tiáº¿p tá»¥c cháº¡y, pháº§n rÃ¡c nÃ y chá»‰ cÃ³ thá»ƒ Ä‘Æ°á»£c thu gom láº¡i trong láº§n GC tiáº¿p theo. VÃ¬ cÃ³ rÃ¡c lÆ°u Ä‘á»™ng, cáº§n dÃ nh má»™t pháº§n bá»™ nhá»› trá»‘ng, Ä‘iá»u nÃ y cÃ³ nghÄ©a lÃ  bá»™ thu gom CMS khÃ´ng thá»ƒ chá» tháº¿ há»‡ giÃ  gáº§n Ä‘áº§y má»›i thu gom nhÆ° nhá»¯ng bá»™ thu gom khÃ¡c. <ul><li>CÃ³ thá»ƒ sá»­ dá»¥ng <code>-XX:CMSInitiatingOccupancyFraction</code> Ä‘á»ƒ thay Ä‘á»•i ngÆ°á»¡ng sá»­ dá»¥ng bá»™ nhá»› Ä‘á»ƒ kÃ­ch hoáº¡t CMS, náº¿u giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c Ä‘áº·t quÃ¡ lá»›n, dáº«n Ä‘áº¿n khÃ´ng Ä‘á»§ bá»™ nhá»› dá»± phÃ²ng Ä‘á»ƒ chá»©a rÃ¡c lÆ°u Ä‘á»™ng, sáº½ xáº£y ra <code>Concurrent Mode Failure</code> vÃ  JVM sáº½ táº¡m thá»i sá»­ dá»¥ng Serial Old Ä‘á»ƒ thay tháº¿ CMS Ä‘á»ƒ lÃ m sáº¡ch rÃ¡c lÆ°u Ä‘á»™ng.</li></ul></li><li>ÄÃ¡nh dáº¥u - XÃ³a gÃ¢y ra sá»± phÃ¢n máº£nh, thÆ°á»ng xuyÃªn xáº£y ra tÃ¬nh tráº¡ng khÃ´ng gian tháº¿ há»‡ giÃ  cÃ²n trá»‘ng nhÆ°ng khÃ´ng tÃ¬m tháº¥y khÃ´ng gian liÃªn tá»¥c Ä‘á»§ lá»›n Ä‘á»ƒ cáº¥p phÃ¡t cho Ä‘á»‘i tÆ°á»£ng hiá»‡n táº¡i, pháº£i sá»›m kÃ­ch hoáº¡t má»™t láº§n Full GC. <ul><li>CÃ³ thá»ƒ sá»­ dá»¥ng <code>-XX:+UseCMSCompactAtFullCollection</code> Ä‘á»ƒ kÃ­ch hoáº¡t viá»‡c nÃ©n máº£nh vá»¥n khi CMS cáº§n thá»±c hiá»‡n Full GC, quÃ¡ trÃ¬nh nÃ©n khÃ´ng thá»ƒ Ä‘á»“ng thá»i, váº¥n Ä‘á» máº£nh vá»¥n Ä‘Æ°á»£c giáº£i quyáº¿t, nhÆ°ng thá»i gian táº¡m dá»«ng sáº½ tÄƒng lÃªn.</li><li>CÃ³ thá»ƒ sá»­ dá»¥ng <code>-XX:CMSFullGCsBeforeCompaction</code> Ä‘á»ƒ thiáº¿t láº­p sá»‘ láº§n Full GC khÃ´ng nÃ©n trÆ°á»›c khi thá»±c hiá»‡n má»™t láº§n nÃ©n (máº·c Ä‘á»‹nh lÃ  0, cÃ³ nghÄ©a lÃ  má»—i khi thá»±c hiá»‡n Full GC Ä‘á»u pháº£i thá»±c hiá»‡n nÃ©n máº£nh vá»¥n).</li></ul></li></ul><h4 id="bo-thu-gom-parnew" tabindex="-1"><a class="header-anchor" href="#bo-thu-gom-parnew"><span>Bá»™ thu gom ParNew</span></a></h4><blockquote><p>TÃ¹y chá»n kÃ­ch hoáº¡t: <code>-XX:+UseParNewGC</code></p></blockquote><p>Bá»™ thu gom ParNew thá»±c cháº¥t lÃ  phiÃªn báº£n Ä‘a luá»“ng cá»§a bá»™ thu gom Serial.</p><p>ParNew lÃ  bá»™ thu gom tháº¿ há»‡ tráº» Ä‘Æ°á»£c Æ°u tiÃªn sá»­ dá»¥ng trong cháº¿ Ä‘á»™ Server cá»§a mÃ¡y áº£o Java. NgoÃ i lÃ½ do hiá»‡u suáº¥t, chÃ­nh lÃ  do nÃ³ lÃ  bá»™ thu gom duy nháº¥t cÃ³ thá»ƒ hoáº¡t Ä‘á»™ng cÃ¹ng vá»›i bá»™ thu gom CMS.</p><p>Bá»™ thu gom ParNew cÅ©ng lÃ  bá»™ thu gom máº·c Ä‘á»‹nh cho tháº¿ há»‡ tráº» khi sá»­ dá»¥ng <code>-XX:+UseConcMarkSweepGC</code>.</p><p>Sá»‘ luá»“ng máº·c Ä‘á»‹nh cá»§a bá»™ thu gom ParNew lÃ  báº±ng sá»‘ lÆ°á»£ng CPU, cÃ³ thá»ƒ sá»­ dá»¥ng tham sá»‘ <code>-XX:ParallelGCThreads</code> Ä‘á»ƒ thiáº¿t láº­p sá»‘ luá»“ng.</p><h3 id="bo-thu-gom-g1" tabindex="-1"><a class="header-anchor" href="#bo-thu-gom-g1"><span>Bá»™ thu gom G1</span></a></h3><blockquote><p>TÃ¹y chá»n kÃ­ch hoáº¡t: <code>-XX:+UseG1GC</code></p></blockquote><p>CÃ¡c bá»™ thu gom rÃ¡c Ä‘Ã£ Ä‘Æ°á»£c Ä‘á» cáº­p trÆ°á»›c Ä‘Ã¢y thÆ°á»ng táº­p trung vÃ o hiá»‡u suáº¥t hoáº·c thá»i gian táº¡m dá»«ng. Tuy nhiÃªn, G1 lÃ  má»™t bá»™ thu gom rÃ¡c káº¿t há»£p cáº£ hiá»‡u suáº¥t vÃ  thá»i gian táº¡m dá»«ng. G1 lÃ  bá»™ thu gom rÃ¡c máº·c Ä‘á»‹nh tá»« Oracle JDK 9 trá»Ÿ Ä‘i. G1 cÃ³ thá»ƒ thiáº¿t láº­p má»¥c tiÃªu thá»i gian táº¡m dá»«ng má»™t cÃ¡ch trá»±c quan. So vá»›i bá»™ thu gom CMS, G1 cÃ³ thá»ƒ khÃ´ng Ä‘áº¡t Ä‘Æ°á»£c thá»i gian táº¡m dá»«ng tá»‘i Æ°u nhÆ°ng cÅ©ng tá»‘t hÆ¡n trong trÆ°á»ng há»£p xáº¥u nháº¥t.</p><p>Äiá»ƒm Ä‘áº·c biá»‡t lá»›n nháº¥t cá»§a G1 lÃ  sá»± giá»›i thiá»‡u cá»§a khÃ¡i niá»‡m phÃ¢n vÃ¹ng, lÃ m má» khÃ¡i niá»‡m theo tháº¿ há»‡ vÃ  táº­n dá»¥ng tÃ i nguyÃªn cá»§a cÃ¡c chu ká»³ thu gom rÃ¡c khÃ¡c nhau, giáº£i quyáº¿t nhiá»u khuyáº¿t Ä‘iá»ƒm cá»§a cÃ¡c bá»™ thu gom khÃ¡c, ká»ƒ cáº£ CMS.</p><h4 id="the-he-va-phan-vung" tabindex="-1"><a class="header-anchor" href="#the-he-va-phan-vung"><span>Tháº¿ há»‡ vÃ  phÃ¢n vÃ¹ng</span></a></h4><p>CÃ¡c bá»™ thu gom rÃ¡c cÅ© thÃ´ng thÆ°á»ng thá»±c hiá»‡n thu gom theo tháº¿ há»‡, trong Ä‘Ã³ Java Heap Ä‘Æ°á»£c chia thÃ nh tháº¿ há»‡ tráº», tháº¿ há»‡ giÃ  vÃ  tháº¿ há»‡ vÄ©nh cá»­u. Pháº¡m vi thu gom lÃ  toÃ n bá»™ tháº¿ há»‡ tráº» hoáº·c toÃ n bá»™ tháº¿ há»‡ giÃ .</p><p>G1 loáº¡i bá» tháº¿ há»‡ vÄ©nh cá»­u vÃ  chia tháº¿ há»‡ tráº» vÃ  tháº¿ há»‡ giÃ  thÃ nh nhiá»u vÃ¹ng Ä‘á»™c láº­p cÃ³ kÃ­ch thÆ°á»›c báº±ng nhau, tháº¿ há»‡ tráº» vÃ  tháº¿ há»‡ giÃ  khÃ´ng cÃ²n Ä‘Æ°á»£c cÃ¡ch ly váº­t lÃ½. G1 cÃ³ thá»ƒ thu gom trá»±c tiáº¿p tháº¿ há»‡ tráº» vÃ  tháº¿ há»‡ giÃ  cÃ¹ng má»™t lÃºc.</p><div align="center"><img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/java/javacore/jvm/jvm-gc-g1-heap-allocation.png"></div><p>Báº±ng cÃ¡ch giá»›i thiá»‡u khÃ¡i niá»‡m vÃ¹ng, má»™t khá»‘i bá»™ nhá»› Ä‘Æ°á»£c chia thÃ nh nhiá»u khá»‘i nhá», má»—i khá»‘i nhá» cÃ³ thá»ƒ Ä‘Æ°á»£c thu gom rÃ¡c Ä‘á»™c láº­p. PhÆ°Æ¡ng phÃ¡p chia nÃ y mang láº¡i tÃ­nh linh hoáº¡t lá»›n, cho phÃ©p mÃ´ hÃ¬nh thá»i gian táº¡m dá»«ng cÃ³ thá»ƒ dá»± Ä‘oÃ¡n Ä‘Æ°á»£c. Báº±ng cÃ¡ch ghi láº¡i thá»i gian thu gom rÃ¡c cá»§a má»—i vÃ¹ng vÃ  khÃ´ng gian thu Ä‘Æ°á»£c tá»« viá»‡c thu gom rÃ¡c trÆ°á»›c Ä‘Ã³, vÃ  duy trÃ¬ má»™t danh sÃ¡ch Æ°u tiÃªn, má»—i láº§n dá»±a trÃªn thá»i gian thu gom cho phÃ©p, Æ°u tiÃªn thu gom vÃ¹ng cÃ³ giÃ¡ trá»‹ cao nháº¥t.</p><p>Má»—i vÃ¹ng Ä‘á»u cÃ³ má»™t Remembered Set Ä‘á»ƒ ghi láº¡i cÃ¡c vÃ¹ng mÃ  cÃ¡c Ä‘á»‘i tÆ°á»£ng tham chiáº¿u Ä‘áº¿n. Báº±ng cÃ¡ch sá»­ dá»¥ng Remembered Set, khÃ´ng cáº§n quÃ©t toÃ n bá»™ heap Ä‘á»ƒ phÃ¢n tÃ­ch kháº£ nÄƒng tiáº¿p cáº­n.</p><h4 id="co-che-thu-gom-cua-g1" tabindex="-1"><a class="header-anchor" href="#co-che-thu-gom-cua-g1"><span>CÆ¡ cháº¿ thu gom cá»§a G1</span></a></h4><p>Náº¿u khÃ´ng tÃ­nh toÃ¡n viá»‡c duy trÃ¬ Remembered Set, quÃ¡ trÃ¬nh hoáº¡t Ä‘á»™ng cá»§a bá»™ thu gom G1 cÃ³ thá»ƒ chia thÃ nh cÃ¡c bÆ°á»›c sau:</p><ol><li><strong>ÄÃ¡nh dáº¥u ban Ä‘áº§u</strong></li><li><strong>ÄÃ¡nh dáº¥u Ä‘á»“ng thá»i</strong></li><li><strong>ÄÃ¡nh dáº¥u cuá»‘i cÃ¹ng</strong> - Äá»ƒ sá»­a chá»¯a pháº§n Ä‘Ã¡nh dáº¥u bá»‹ thay Ä‘á»•i trong quÃ¡ trÃ¬nh Ä‘Ã¡nh dáº¥u Ä‘á»“ng thá»i do hoáº¡t Ä‘á»™ng cá»§a chÆ°Æ¡ng trÃ¬nh ngÆ°á»i dÃ¹ng, mÃ¡y áº£o ghi láº¡i cÃ¡c thay Ä‘á»•i nÃ y trong Remembered Set Logs cá»§a cÃ¡c luá»“ng vÃ  sau Ä‘Ã³ há»£p nháº¥t dá»¯ liá»‡u Remembered Set Logs vÃ o Remembered Set. BÆ°á»›c nÃ y yÃªu cáº§u táº¡m dá»«ng luá»“ng, nhÆ°ng cÃ³ thá»ƒ thá»±c hiá»‡n song song.</li><li><strong>Thu gom lá»±a chá»n</strong> - Äáº§u tiÃªn, sáº¯p xáº¿p giÃ¡ trá»‹ thu gom vÃ  chi phÃ­ cá»§a má»—i vÃ¹ng, dá»±a trÃªn thá»i gian táº¡m dá»«ng GC mÃ  ngÆ°á»i dÃ¹ng mong muá»‘n. Thá»±c táº¿, bÆ°á»›c nÃ y cÅ©ng cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n song song vá»›i chÆ°Æ¡ng trÃ¬nh ngÆ°á»i dÃ¹ng, nhÆ°ng vÃ¬ chá»‰ thu gom má»™t pháº§n vÃ¹ng, thá»i gian táº¡m dá»«ng lÃ  do ngÆ°á»i dÃ¹ng kiá»ƒm soÃ¡t vÃ  tÄƒng hiá»‡u suáº¥t thu gom.</li></ol><p>CÃ³ nhá»¯ng Ä‘áº·c Ä‘iá»ƒm sau:</p><ul><li>TÃ­ch há»£p khÃ´ng gian: Tá»•ng thá»ƒ lÃ  má»™t bá»™ thu gom dá»±a trÃªn thuáº­t toÃ¡n &quot;Ä‘Ã¡nh dáº¥u - sáº¯p xáº¿p&quot;, tá»« má»™t gÃ³c nhÃ¬n cá»¥c bá»™ (giá»¯a hai vÃ¹ng) dá»±a trÃªn thuáº­t toÃ¡n &quot;sao chÃ©p&quot;. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  khÃ´ng cÃ³ máº£nh khÃ´ng gian bá»‹ phÃ¢n máº£nh Ä‘Æ°á»£c táº¡o ra trong quÃ¡ trÃ¬nh cháº¡y.</li><li>Thá»i gian táº¡m dá»«ng cÃ³ thá»ƒ dá»± Ä‘oÃ¡n Ä‘Æ°á»£c: Cho phÃ©p ngÆ°á»i dÃ¹ng chá»‰ Ä‘á»‹nh rÃµ rÃ ng ráº±ng trong má»™t khoáº£ng thá»i gian M mili giÃ¢y, thá»i gian tiÃªu tá»‘n cho GC khÃ´ng Ä‘Æ°á»£c vÆ°á»£t quÃ¡ N mili giÃ¢y.</li></ul><h4 id="quy-trinh-thu-gom-the-he-tre-chi-tiet-cua-g1" tabindex="-1"><a class="header-anchor" href="#quy-trinh-thu-gom-the-he-tre-chi-tiet-cua-g1"><span>Quy trÃ¬nh thu gom tháº¿ há»‡ tráº» chi tiáº¿t cá»§a G1</span></a></h4><p><strong>ï¼ˆ1ï¼‰G1 khá»Ÿi táº¡o khÃ´ng gian heap</strong></p><p>Heap lÃ  má»™t khá»‘i bá»™ nhá»› Ä‘Æ°á»£c chia thÃ nh nhiá»u vÃ¹ng cÃ³ kÃ­ch thÆ°á»›c cá»‘ Ä‘á»‹nh.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide8.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>Khi mÃ¡y áº£o Java khá»Ÿi Ä‘á»™ng, kÃ­ch thÆ°á»›c vÃ¹ng Ä‘Æ°á»£c chá»n. ThÃ´ng thÆ°á»ng, mÃ¡y áº£o Java sáº½ chá»n khoáº£ng 2000 vÃ¹ng cÃ³ kÃ­ch thÆ°á»›c tÆ°Æ¡ng Ä‘Æ°Æ¡ng, má»—i vÃ¹ng cÃ³ kÃ­ch thÆ°á»›c tá»« 1 Ä‘áº¿n 32M.</p><p><strong>ï¼ˆ2ï¼‰PhÃ¢n vÃ¹ng khÃ´ng gian heap cá»§a G1</strong></p><p>Thá»±c táº¿, cÃ¡c vÃ¹ng nÃ y Ä‘Æ°á»£c Ã¡nh xáº¡ thÃ nh cÃ¡c vÃ¹ng Eden, Survivor vÃ  Old logic.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide9.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>MÃ u sáº¯c trong hÃ¬nh chá»‰ ra vÃ¹ng nÃ o Ä‘Æ°á»£c liÃªn káº¿t vá»›i vai trÃ² gÃ¬. Äá»‘i tÆ°á»£ng hoáº¡t Ä‘á»™ng Ä‘Æ°á»£c phÃ¢n tÃ¡n (sao chÃ©p, di chuyá»ƒn) tá»« má»™t vÃ¹ng sang má»™t vÃ¹ng khÃ¡c. CÃ¡c vÃ¹ng Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ thu gom theo cÃ¡ch song song, cÃ³ thá»ƒ táº¡m dá»«ng hoáº·c khÃ´ng táº¡m dá»«ng táº¥t cáº£ cÃ¡c luá»“ng ngÆ°á»i dÃ¹ng khÃ¡c.</p><p>CÃ³ thá»ƒ phÃ¢n vÃ¹ng rÃµ rÃ ng thÃ nh Eden, Survivor vÃ  Old. NgoÃ i ra, cÃ³ má»™t loáº¡i vÃ¹ng thá»© tÆ° Ä‘Æ°á»£c gá»i lÃ  <em>vÃ¹ng cá»±c lá»›n (Humongous regions)</em>. CÃ¡c vÃ¹ng nÃ y Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ giá»¯ 50% hoáº·c nhiá»u hÆ¡n kÃ­ch thÆ°á»›c vÃ¹ng tiÃªu chuáº©n. ChÃºng Ä‘Æ°á»£c lÆ°u trá»¯ trong má»™t táº­p há»£p cÃ¡c vÃ¹ng liÃªn tá»¥c. Cuá»‘i cÃ¹ng, loáº¡i vÃ¹ng cuá»‘i cÃ¹ng lÃ  cÃ¡c vÃ¹ng khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng trong khÃ´ng gian heap.</p><p><strong>LÆ°u Ã½:</strong> Khi viáº¿t bÃ i nÃ y, viá»‡c thu gom Ä‘á»‘i tÆ°á»£ng cá»±c lá»›n váº«n chÆ°a Ä‘Æ°á»£c tá»‘i Æ°u hÃ³a. Do Ä‘Ã³, báº¡n nÃªn trÃ¡nh táº¡o Ä‘á»‘i tÆ°á»£ng cÃ³ kÃ­ch thÆ°á»›c lá»›n nhÆ° váº­y.</p><p><strong>ï¼ˆ3ï¼‰Tháº¿ há»‡ tráº» cá»§a G1</strong></p><p>KhÃ´ng gian heap Ä‘Æ°á»£c chia thÃ nh khoáº£ng 2000 vÃ¹ng. Tá»‘i thiá»ƒu lÃ  1M, tá»‘i Ä‘a lÃ  32M. VÃ¹ng mÃ u xanh lÃ¡ cÃ¢y giá»¯ cÃ¡c Ä‘á»‘i tÆ°á»£ng tháº¿ há»‡ giÃ , vÃ¹ng mÃ u xanh lam giá»¯ cÃ¡c Ä‘á»‘i tÆ°á»£ng tháº¿ há»‡ tráº».</p><p><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide10.png" alt="img" loading="lazy"><br><strong>LÆ°u Ã½:</strong> KhÃ´ng cáº§n pháº£i lÃ  cÃ¡c vÃ¹ng liÃªn tá»¥c nhÆ° cÃ¡c bá»™ thu gom cÅ©.</p><p><strong>ï¼ˆ4ï¼‰Thu gom tháº¿ há»‡ tráº» cá»§a G1</strong></p><p>CÃ¡c Ä‘á»‘i tÆ°á»£ng hoáº¡t Ä‘á»™ng Ä‘Æ°á»£c sao chÃ©p (di chuyá»ƒn) sang má»™t hoáº·c nhiá»u vÃ¹ng Survivor. Náº¿u Ä‘áº¡t Ä‘áº¿n ngÆ°á»¡ng thÄƒng cáº¥p tá»•ng, Ä‘á»‘i tÆ°á»£ng sáº½ Ä‘Æ°á»£c thÄƒng cáº¥p vÃ o vÃ¹ng Old.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide11.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>ÄÃ¢y lÃ  má»™t sá»± táº¡m dá»«ng stop the world. TÃ­nh toÃ¡n láº¡i kÃ­ch thÆ°á»›c Eden vÃ  Survivor cho láº§n thu gom rÃ¡c tháº¿ há»‡ tráº» tiáº¿p theo. Viá»‡c giá»¯ láº¡i thÃ´ng tin kiá»ƒm tra giÃºp tÃ­nh toÃ¡n kÃ­ch thÆ°á»›c. CÃ¡c váº¥n Ä‘á» tÆ°Æ¡ng tá»± thá»i gian táº¡m dá»«ng má»¥c tiÃªu sáº½ Ä‘Æ°á»£c xem xÃ©t.</p><p>PhÆ°Æ¡ng phÃ¡p nÃ y lÃ m cho viá»‡c Ä‘iá»u chá»‰nh kÃ­ch thÆ°á»›c vÃ¹ng trá»Ÿ nÃªn dá»… dÃ ng, tÄƒng hoáº·c giáº£m theo nhu cáº§u.</p><p><strong>ï¼ˆ5ï¼‰Káº¿t thÃºc thu gom tháº¿ há»‡ tráº» cá»§a G1</strong></p><p>CÃ¡c Ä‘á»‘i tÆ°á»£ng hoáº¡t Ä‘á»™ng Ä‘Æ°á»£c sao chÃ©p vÃ o vÃ¹ng Survivor hoáº·c vÃ¹ng Old.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide12.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>CÃ¡c Ä‘á»‘i tÆ°á»£ng má»›i Ä‘Æ°á»£c thÄƒng cáº¥p gáº§n Ä‘Ã¢y Ä‘Æ°á»£c hiá»ƒn thá»‹ dÆ°á»›i dáº¡ng mÃ u xanh Ä‘áº­m. CÃ¡c vÃ¹ng Survivor Ä‘Æ°á»£c hiá»ƒn thá»‹ dÆ°á»›i dáº¡ng mÃ u xanh lÃ¡ cÃ¢y.</p><p>TÃ³m láº¡i quÃ¡ trÃ¬nh thu gom tháº¿ há»‡ tráº» cá»§a G1:</p><ul><li>KhÃ´ng gian heap lÃ  má»™t khá»‘i bá»™ nhá»› Ä‘á»™c láº­p Ä‘Æ°á»£c chia thÃ nh nhiá»u vÃ¹ng.</li><li>Tháº¿ há»‡ tráº» cá»§a bá»™ nhá»› Ä‘Æ°á»£c táº¡o thÃ nh tá»« má»™t nhÃ³m cÃ¡c vÃ¹ng khÃ´ng liÃªn tá»¥c. Äiá»u nÃ y lÃ m cho viá»‡c Ä‘iá»u chá»‰nh kÃ­ch thÆ°á»›c trá»Ÿ nÃªn dá»… dÃ ng.</li><li>Thu gom rÃ¡c tháº¿ há»‡ tráº» lÃ  má»™t sá»± kiá»‡n stop the world, táº¥t cáº£ cÃ¡c luá»“ng á»©ng dá»¥ng Ä‘á»u táº¡m dá»«ng trong quÃ¡ trÃ¬nh nÃ y.</li><li>Thu gom rÃ¡c tháº¿ há»‡ tráº» sá»­ dá»¥ng nhiá»u luá»“ng Ä‘á»ƒ thu gom song song.</li><li>CÃ¡c Ä‘á»‘i tÆ°á»£ng hoáº¡t Ä‘á»™ng Ä‘Æ°á»£c sao chÃ©p vÃ o vÃ¹ng Survivor hoáº·c vÃ¹ng Old.</li></ul><h4 id="qua-trinh-thu-gom-the-he-gia-cua-g1" tabindex="-1"><a class="header-anchor" href="#qua-trinh-thu-gom-the-he-gia-cua-g1"><span>QuÃ¡ trÃ¬nh thu gom tháº¿ há»‡ giÃ  cá»§a G1</span></a></h4><p><strong>BÆ°á»›c 1: Gáº¯n nhÃ£n ban Ä‘áº§u (Initial Mark)</strong></p><p>Thu gom rÃ¡c trong tháº¿ há»‡ giÃ  cá»§a G1 Ä‘áº£m nhiá»‡m viá»‡c gáº¯n nhÃ£n cho cÃ¡c Ä‘á»‘i tÆ°á»£ng hoáº¡t Ä‘á»™ng. ÄÆ°á»£c ghi láº¡i trong tá»‡p nháº­t kÃ½ vá»›i tÃªn <em>GC pause (young)(inital-mark)</em>.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide13.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p><strong>BÆ°á»›c 2: Gáº¯n nhÃ£n song song (Concurrent Mark)</strong></p><p>Náº¿u cÃ³ cÃ¡c vÃ¹ng trá»‘ng (Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u báº±ng &quot;X&quot;), chÃºng sáº½ Ä‘Æ°á»£c xÃ³a ngay trong giai Ä‘oáº¡n gáº¯n nhÃ£n láº¡i. Äá»“ng thá»i, thÃ´ng tin kiá»ƒm tra sá»± sá»‘ng cÅ©ng Ä‘Æ°á»£c tÃ­nh toÃ¡n táº¡i giai Ä‘oáº¡n nÃ y.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide14.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p><strong>BÆ°á»›c 3: Gáº¯n nhÃ£n láº¡i (Remark)</strong></p><p>CÃ¡c vÃ¹ng trá»‘ng Ä‘Æ°á»£c xÃ³a vÃ  thu gom. TÃ­nh toÃ¡n sá»± sá»‘ng cá»§a táº¥t cáº£ cÃ¡c vÃ¹ng trong quÃ¡ trÃ¬nh nÃ y.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide15.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p><strong>BÆ°á»›c 4: Sao chÃ©p/Thu dá»n (Copy/Cleanup)</strong></p><p>G1 chá»n cÃ¡c vÃ¹ng cÃ³ Ä‘á»™ sá»‘ng tháº¥p nháº¥t Ä‘á»ƒ thu gom, nhá»¯ng vÃ¹ng nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c thu gom nhanh nháº¥t. Sau Ä‘Ã³, cÃ¡c vÃ¹ng nÃ y sáº½ Ä‘Æ°á»£c thu gom trong quÃ¡ trÃ¬nh thu gom rÃ¡c trong tháº¿ há»‡ giÃ . ÄÆ°á»£c ghi láº¡i trong nháº­t kÃ½ vá»›i tÃªn <em>[GC pause (mixed)]</em>. VÃ¬ váº­y, cáº£ tháº¿ há»‡ giÃ  vÃ  Ä‘a tháº¿ há»‡ cÃ¹ng Ä‘Æ°á»£c thu gom cÃ¹ng má»™t lÃºc.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide16.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p><strong>BÆ°á»›c 5: Sau quÃ¡ trÃ¬nh sao chÃ©p/Thu dá»n</strong></p><p>CÃ¡c vÃ¹ng Ä‘Æ°á»£c chá»n Ä‘Ã£ Ä‘Æ°á»£c thu gom vÃ  nÃ©n vÃ o cÃ¡c vÃ¹ng mÃ u xanh Ä‘áº­m vÃ  mÃ u xanh lÃ¡ cÃ¢y Ä‘Æ°á»£c hiá»ƒn thá»‹ trong hÃ¬nh.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/slide17.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h3 id="tong-ket" tabindex="-1"><a class="header-anchor" href="#tong-ket"><span>Tá»•ng káº¿t</span></a></h3><table><thead><tr><th style="text-align:center;">Bá»™ thu gom</th><th style="text-align:center;">Tuáº§n tá»±/Äá»“ng thá»i/PhÃ¢n tÃ¡n</th><th style="text-align:center;">Tháº¿ há»‡ tráº»/Tháº¿ há»‡ giÃ </th><th style="text-align:center;">Thu gom thuáº­t toÃ¡n</th><th style="text-align:center;">Má»¥c tiÃªu</th><th style="text-align:center;">á»¨ng dá»¥ng phÃ¹ há»£p</th></tr></thead><tbody><tr><td style="text-align:center;"><strong>Serial</strong></td><td style="text-align:center;">Tuáº§n tá»±</td><td style="text-align:center;">Tháº¿ há»‡ tráº»</td><td style="text-align:center;">Sao chÃ©p</td><td style="text-align:center;">Æ¯u tiÃªn tá»‘c Ä‘á»™ Ä‘Ã¡p á»©ng</td><td style="text-align:center;">MÃ´i trÆ°á»ng Client vá»›i má»™t CPU trong cháº¿ Ä‘á»™ Client</td></tr><tr><td style="text-align:center;"><strong>Serial Old</strong></td><td style="text-align:center;">Tuáº§n tá»±</td><td style="text-align:center;">Tháº¿ há»‡ giÃ </td><td style="text-align:center;">ÄÃ¡nh dáº¥u-Ä‘Ã³ng gÃ³i</td><td style="text-align:center;">Æ¯u tiÃªn tá»‘c Ä‘á»™ Ä‘Ã¡p á»©ng</td><td style="text-align:center;">MÃ´i trÆ°á»ng Client vá»›i má»™t CPU, dá»± phÃ²ng cho CMS</td></tr><tr><td style="text-align:center;"><strong>ParNew</strong></td><td style="text-align:center;">Tuáº§n tá»± + Äá»“ng thá»i</td><td style="text-align:center;">Tháº¿ há»‡ tráº»</td><td style="text-align:center;">Sao chÃ©p</td><td style="text-align:center;">Æ¯u tiÃªn tá»‘c Ä‘á»™ Ä‘Ã¡p á»©ng</td><td style="text-align:center;">MÃ´i trÆ°á»ng Server vá»›i nhiá»u CPU, káº¿t há»£p vá»›i CMS</td></tr><tr><td style="text-align:center;"><strong>Parallel Scavenge</strong></td><td style="text-align:center;">Tuáº§n tá»± + Äá»“ng thá»i</td><td style="text-align:center;">Tháº¿ há»‡ tráº»</td><td style="text-align:center;">Sao chÃ©p</td><td style="text-align:center;">Æ¯u tiÃªn hiá»‡u suáº¥t</td><td style="text-align:center;">CÃ¡c tÃ¡c vá»¥ cháº¡y ná»n khÃ´ng cáº§n nhiá»u tÆ°Æ¡ng tÃ¡c</td></tr><tr><td style="text-align:center;"><strong>Parallel Old</strong></td><td style="text-align:center;">Tuáº§n tá»± + Äá»“ng thá»i</td><td style="text-align:center;">Tháº¿ há»‡ giÃ </td><td style="text-align:center;">ÄÃ¡nh dáº¥u-Ä‘Ã³ng gÃ³i</td><td style="text-align:center;">Æ¯u tiÃªn hiá»‡u suáº¥t</td><td style="text-align:center;">CÃ¡c tÃ¡c vá»¥ cháº¡y ná»n khÃ´ng cáº§n nhiá»u tÆ°Æ¡ng tÃ¡c</td></tr><tr><td style="text-align:center;"><strong>CMS</strong></td><td style="text-align:center;">Äá»“ng thá»i + Äá»“ng thá»i</td><td style="text-align:center;">Tháº¿ há»‡ giÃ </td><td style="text-align:center;">ÄÃ¡nh dáº¥u-xÃ³a</td><td style="text-align:center;">Æ¯u tiÃªn tá»‘c Ä‘á»™ Ä‘Ã¡p á»©ng</td><td style="text-align:center;">á»¨ng dá»¥ng Java táº­p trung trÃªn cÃ¡c trang web hoáº·c dá»‹ch vá»¥ mÃ¡y chá»§ B/S</td></tr><tr><td style="text-align:center;"><strong>G1</strong></td><td style="text-align:center;">Äá»“ng thá»i + Äá»“ng thá»i</td><td style="text-align:center;">Tháº¿ há»‡ tráº» + Tháº¿ há»‡ giÃ </td><td style="text-align:center;">ÄÃ¡nh dáº¥u-Ä‘Ã³ng gÃ³i + Sao chÃ©p</td><td style="text-align:center;">Æ¯u tiÃªn tá»‘c Ä‘á»™ Ä‘Ã¡p á»©ng</td><td style="text-align:center;">á»¨ng dá»¥ng dÃ nh cho mÃ¡y chá»§, thay tháº¿ CMS trong tÆ°Æ¡ng lai</td></tr></tbody></table><h2 id="chien-luoc-cap-phat-va-thu-gom-bo-nho" tabindex="-1"><a class="header-anchor" href="#chien-luoc-cap-phat-va-thu-gom-bo-nho"><span>Chiáº¿n lÆ°á»£c cáº¥p phÃ¡t vÃ  thu gom bá»™ nhá»›</span></a></h2><p>cáº¥p phÃ¡t bá»™ nhá»› cho Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c thá»±c hiá»‡n trÃªn heap. Äa pháº§n cÃ¡c Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c cáº¥p phÃ¡t trÃªn khu vá»±c Eden cá»§a tháº¿ há»‡ tráº», trong má»™t sá»‘ trÆ°á»ng há»£p cÅ©ng cÃ³ thá»ƒ Ä‘Æ°á»£c cáº¥p phÃ¡t trá»±c tiáº¿p trÃªn khu vá»±c cá»§a tháº¿ há»‡ giÃ .</p><h3 id="minor-gc" tabindex="-1"><a class="header-anchor" href="#minor-gc"><span>Minor GC</span></a></h3><p><strong>Khi khÃ´ng gian trong khu vá»±c Eden khÃ´ng Ä‘á»§, Minor GC sáº½ Ä‘Æ°á»£c kÃ­ch hoáº¡t</strong>.</p><p><strong>Minor GC xáº£y ra trÃªn tháº¿ há»‡ tráº»</strong>, vÃ¬ thá»i gian sá»‘ng cá»§a cÃ¡c Ä‘á»‘i tÆ°á»£ng trÃªn tháº¿ há»‡ tráº» ngáº¯n, nÃªn Minor GC thÆ°á»ng xuyÃªn xáº£y ra vÃ  thá»±c hiá»‡n nhanh chÃ³ng.</p><p>Quy trÃ¬nh cá»§a Minor GC:</p><ol><li>á»¨ng dá»¥ng Java liÃªn tá»¥c táº¡o ra cÃ¡c Ä‘á»‘i tÆ°á»£ng, thÆ°á»ng Ä‘Æ°á»£c cáº¥p phÃ¡t trÃªn khu vá»±c Eden. Khi khÃ´ng gian trong Eden khÃ´ng Ä‘á»§ (Ä‘áº¡t Ä‘áº¿n ngÆ°á»¡ng Ä‘Ã£ Ä‘á»‹nh), Minor GC sáº½ Ä‘Æ°á»£c kÃ­ch hoáº¡t. CÃ¡c Ä‘á»‘i tÆ°á»£ng váº«n cÃ²n Ä‘Æ°á»£c tham chiáº¿u (hÃ¬nh vuÃ´ng mÃ u xanh lÃ¡ cÃ¢y) sáº½ Ä‘Æ°á»£c sao chÃ©p vÃ o khu vá»±c Survivor mÃ  JVM chá»n, trong khi cÃ¡c Ä‘á»‘i tÆ°á»£ng khÃ´ng cÃ²n Ä‘Æ°á»£c tham chiáº¿u (hÃ¬nh vuÃ´ng mÃ u vÃ ng) sáº½ Ä‘Æ°á»£c thu gom.</li><li>Sau má»™t láº§n Minor GC, khu vá»±c Eden sáº½ trá»Ÿ thÃ nh trá»‘ng rá»—ng cho Ä‘áº¿n khi Ä‘áº¡t Ä‘áº¿n Ä‘iá»u kiá»‡n kÃ­ch hoáº¡t Minor GC láº§n tiáº¿p theo. LÃºc nÃ y, khu vá»±c Survivor khÃ¡c sáº½ trá»Ÿ thÃ nh khu vá»±c <code>To</code>, cÃ¡c Ä‘á»‘i tÆ°á»£ng cÃ²n sá»‘ng trong khu vá»±c Eden vÃ  khu vá»±c <code>From</code> sáº½ Ä‘Æ°á»£c sao chÃ©p vÃ o khu vá»±c <code>To</code>, vÃ  Ä‘á»™ tuá»•i cá»§a Ä‘á»‘i tÆ°á»£ng sá»‘ng sáº½ Ä‘Æ°á»£c tÄƒng thÃªm 1.</li><li>QuÃ¡ trÃ¬nh tÆ°Æ¡ng tá»± nhÆ° bÆ°á»›c 2 sáº½ xáº£y ra nhiá»u láº§n, cho Ä‘áº¿n khi má»™t sá»‘ Ä‘á»‘i tÆ°á»£ng Ä‘áº¡t Ä‘áº¿n ngÆ°á»¡ng tuá»•i, khi Ä‘Ã³ quÃ¡ trÃ¬nh &quot;thÄƒng cáº¥p&quot; (Promotion) sáº½ xáº£y ra, cÃ¡c Ä‘á»‘i tÆ°á»£ng vÆ°á»£t quÃ¡ ngÆ°á»¡ng sáº½ Ä‘Æ°á»£c thÄƒng cáº¥p vÃ o tháº¿ há»‡ giÃ . NgÆ°á»¡ng nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh báº±ng tham sá»‘ <code>-XX:MaxTenuringThreshold</code>.</li></ol><h3 id="full-gc" tabindex="-1"><a class="header-anchor" href="#full-gc"><span>Full GC</span></a></h3><p><strong>Full GC xáº£y ra trÃªn tháº¿ há»‡ giÃ </strong>, Ä‘á»‘i tÆ°á»£ng trÃªn tháº¿ há»‡ giÃ  cÃ³ tuá»•i sá»‘ng lÃ¢u hÆ¡n tháº¿ há»‡ tráº», do Ä‘Ã³ Full GC xáº£y ra Ã­t vÃ  tá»‘c Ä‘á»™ thá»±c hiá»‡n cÅ©ng cháº­m hÆ¡n Minor GC nhiá»u.</p><h4 id="chien-luoc-cap-phat-bo-nho" tabindex="-1"><a class="header-anchor" href="#chien-luoc-cap-phat-bo-nho"><span>Chiáº¿n lÆ°á»£c cáº¥p phÃ¡t bá»™ nhá»›</span></a></h4><p><strong>(1) Æ¯u tiÃªn cáº¥p phÃ¡t Ä‘á»‘i tÆ°á»£ng trÃªn Eden</strong></p><p>Trong háº§u háº¿t cÃ¡c trÆ°á»ng há»£p, Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c cáº¥p phÃ¡t trÃªn khu vá»±c Eden cá»§a tháº¿ há»‡ tráº». Khi khÃ´ng gian trong Eden khÃ´ng Ä‘á»§, Minor GC sáº½ Ä‘Æ°á»£c kÃ­ch hoáº¡t. Äiá»u nÃ y Ä‘áº£m báº£o ráº±ng Ä‘á»‘i tÆ°á»£ng cÃ³ tuá»•i sá»‘ng ngáº¯n Ä‘Æ°á»£c thu gom nhanh chÃ³ng.</p><p><strong>(2) Äá»‘i tÆ°á»£ng lá»›n trá»±c tiáº¿p vÃ o tháº¿ há»‡ giÃ </strong></p><p>Äá»‘i tÆ°á»£ng lá»›n lÃ  nhá»¯ng Ä‘á»‘i tÆ°á»£ng cáº§n cÃ³ khÃ´ng gian liÃªn tá»¥c, vÃ­ dá»¥ nhÆ° chuá»—i dÃ i vÃ  máº£ng lá»›n.</p><p>Viá»‡c cáº¥p phÃ¡t Ä‘á»‘i tÆ°á»£ng lá»›n sáº½ kÃ­ch hoáº¡t thu gom rÃ¡c trÆ°á»›c Ä‘á»ƒ cÃ³ Ä‘á»§ khÃ´ng gian liÃªn tá»¥c Ä‘á»ƒ cáº¥p phÃ¡t cho Ä‘á»‘i tÆ°á»£ng lá»›n.</p><p><code>-XX:PretenureSizeThreshold</code> Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘á»‹nh nghÄ©a kÃ­ch thÆ°á»›c ngÆ°á»¡ng, náº¿u Ä‘á»‘i tÆ°á»£ng lá»›n hÆ¡n ngÆ°á»¡ng nÃ y, nÃ³ sáº½ Ä‘Æ°á»£c cáº¥p phÃ¡t trá»±c tiáº¿p trÃªn tháº¿ há»‡ giÃ , trÃ¡nh viá»‡c sao chÃ©p nhiá»u bá»™ nhá»› giá»¯a khu vá»±c Eden vÃ  khu vá»±c Survivor.</p><p><strong>(3) Äá»‘i tÆ°á»£ng tá»“n táº¡i lÃ¢u vÃ o tháº¿ há»‡ giÃ </strong></p><p>Äá»‘i tÆ°á»£ng Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a vá»›i bá»™ Ä‘áº¿m tuá»•i, Ä‘á»‘i tÆ°á»£ng sinh ra trong Eden vÃ  sá»‘ng sÃ³t qua Minor GC sáº½ Ä‘Æ°á»£c chuyá»ƒn sang khu vá»±c Survivor, vÃ  tuá»•i Ä‘á»‘i tÆ°á»£ng sáº½ tÄƒng lÃªn 1.</p><p><code>-XX:MaxTenuringThreshold</code> Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘á»‹nh nghÄ©a ngÆ°á»¡ng tuá»•i.</p><p><strong>(4) XÃ¡c Ä‘á»‹nh tuá»•i cá»§a Ä‘á»‘i tÆ°á»£ng Ä‘á»™ng</strong></p><p>MÃ¡y áº£o khÃ´ng yÃªu cáº§u tuá»•i cá»§a Ä‘á»‘i tÆ°á»£ng pháº£i Ä‘áº¡t Ä‘áº¿n <code>MaxTenuringThreshold</code> má»›i cÃ³ thá»ƒ thÄƒng cáº¥p vÃ o tháº¿ há»‡ giÃ . Náº¿u tá»•ng kÃ­ch thÆ°á»›c cá»§a táº¥t cáº£ cÃ¡c Ä‘á»‘i tÆ°á»£ng cÃ¹ng tuá»•i trong khu vá»±c Survivor lá»›n hÆ¡n má»™t ná»­a khÃ´ng gian cá»§a Survivor, cÃ¡c Ä‘á»‘i tÆ°á»£ng cÃ³ tuá»•i lá»›n hÆ¡n hoáº·c báº±ng tuá»•i nÃ y cÃ³ thá»ƒ trá»±c tiáº¿p thÄƒng cáº¥p vÃ o tháº¿ há»‡ giÃ  mÃ  khÃ´ng cáº§n Ä‘á»£i Ä‘áº¿n tuá»•i yÃªu cáº§u.</p><p><strong>(5) Báº£o Ä‘áº£m cáº¥p phÃ¡t khÃ´ng gian</strong></p><p>TrÆ°á»›c khi thá»±c hiá»‡n Minor GC, mÃ¡y áº£o sáº½ kiá»ƒm tra xem khÃ´ng gian liÃªn tá»¥c lá»›n nháº¥t cÃ³ sáºµn trong tháº¿ há»‡ giÃ  cÃ³ lá»›n hÆ¡n tá»•ng khÃ´ng gian cá»§a táº¥t cáº£ cÃ¡c Ä‘á»‘i tÆ°á»£ng trong tháº¿ há»‡ tráº» hay khÃ´ng. Náº¿u Ä‘iá»u kiá»‡n nÃ y Ä‘Ãºng, Minor GC cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n má»™t cÃ¡ch an toÃ n. Náº¿u khÃ´ng Ä‘Ãºng, mÃ¡y áº£o sáº½ kiá»ƒm tra xem cÃ i Ä‘áº·t <code>HandlePromotionFailure</code> cÃ³ cho phÃ©p tháº¥t báº¡i báº£o Ä‘áº£m khÃ´ng. Náº¿u cho phÃ©p, mÃ¡y áº£o sáº½ kiá»ƒm tra xem khÃ´ng gian liÃªn tá»¥c lá»›n nháº¥t cÃ³ sáºµn trong tháº¿ há»‡ giÃ  cÃ³ lá»›n hÆ¡n kÃ­ch thÆ°á»›c trung bÃ¬nh cá»§a cÃ¡c Ä‘á»‘i tÆ°á»£ng Ä‘Ã£ thÄƒng cáº¥p vÃ o tháº¿ há»‡ giÃ  trÆ°á»›c Ä‘Ã³ hay khÃ´ng. Náº¿u lá»›n hÆ¡n, mÃ¡y áº£o sáº½ thá»­ thá»±c hiá»‡n má»™t láº§n Minor GC, máº·c dÃ¹ Ä‘iá»u nÃ y cÃ³ rá»§i ro. Náº¿u nhá» hÆ¡n hoáº·c <code>HandlePromotionFailure</code> khÃ´ng cho phÃ©p rá»§i ro, mÃ¡y áº£o sáº½ thá»±c hiá»‡n Full GC.</p><h4 id="Ä‘ieu-kien-kich-hoat-full-gc" tabindex="-1"><a class="header-anchor" href="#Ä‘ieu-kien-kich-hoat-full-gc"><span>Äiá»u kiá»‡n kÃ­ch hoáº¡t Full GC</span></a></h4><p>Äá»‘i vá»›i Minor GC, Ä‘iá»u kiá»‡n kÃ­ch hoáº¡t ráº¥t Ä‘Æ¡n giáº£n, khi khÃ´ng gian trong khu vá»±c Eden Ä‘áº§y, má»™t Minor GC sáº½ Ä‘Æ°á»£c kÃ­ch hoáº¡t. Trong khi Ä‘Ã³, Full GC phá»©c táº¡p hÆ¡n vÃ  cÃ³ cÃ¡c Ä‘iá»u kiá»‡n sau:</p><p><strong>(1) Gá»i <code>System.gc()</code></strong></p><p>Viá»‡c gá»i phÆ°Æ¡ng thá»©c nÃ y Ä‘á» nghá»‹ mÃ¡y áº£o thá»±c hiá»‡n Full GC, máº·c dÃ¹ chá»‰ lÃ  Ä‘á» nghá»‹ vÃ  khÃ´ng cháº¯c cháº¯n, nhÆ°ng trong nhiá»u trÆ°á»ng há»£p nÃ³ sáº½ kÃ­ch hoáº¡t Full GC, tÄƒng táº§n suáº¥t Full GC vÃ  táº¡o ra nhiá»u láº§n táº¡m dá»«ng khÃ´ng Ä‘á»u. Do Ä‘Ã³, ráº¥t khuyáº¿n khÃ­ch khÃ´ng sá»­ dá»¥ng phÆ°Æ¡ng thá»©c nÃ y náº¿u khÃ´ng cáº§n thiáº¿t, Ä‘á»ƒ mÃ¡y áº£o tá»± quáº£n lÃ½ bá»™ nhá»› cá»§a nÃ³. CÃ³ thá»ƒ vÃ´ hiá»‡u hÃ³a viá»‡c gá»i <code>System.gc()</code> báº±ng cÃ¡ch sá»­ dá»¥ng <code>-XX:DisableExplicitGC</code>.</p><p><strong>(2) KhÃ´ng gian trong tháº¿ há»‡ giÃ  khÃ´ng Ä‘á»§</strong></p><p>TrÆ°á»ng há»£p phá»• biáº¿n lÃ  khi Ä‘á»‘i tÆ°á»£ng lá»›n trá»±c tiáº¿p vÃ o tháº¿ há»‡ giÃ , Ä‘á»‘i tÆ°á»£ng trÆ°á»ng há»£p lÃ¢u dÃ i vÃ o tháº¿ há»‡ giÃ , khi thá»±c hiá»‡n Full GC sau khi khÃ´ng gian váº«n khÃ´ng Ä‘á»§, sáº½ nÃ©m ra <code>java.lang.OutOfMemoryError: Java heap space</code>. Äá»ƒ trÃ¡nh Full GC do cÃ¡c nguyÃªn nhÃ¢n trÃªn, khi tá»‘i Æ°u hÃ³a, hÃ£y cá»‘ gáº¯ng Ä‘á»ƒ Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c thu gom trong giai Ä‘oáº¡n Minor GC, Ä‘á»ƒ Ä‘á»‘i tÆ°á»£ng sá»‘ng lÃ¢u hÆ¡n trong tháº¿ há»‡ tráº» vÃ  khÃ´ng táº¡o ra Ä‘á»‘i tÆ°á»£ng hoáº·c máº£ng quÃ¡ lá»›n.</p><p><strong>(3) KhÃ´ng gian trong vÃ¹ng phÆ°Æ¡ng thá»©c khÃ´ng Ä‘á»§</strong></p><p>VÃ¹ng phÆ°Æ¡ng thá»©c trong khu vá»±c dá»¯ liá»‡u cháº¡y thá»i gian (Runtime Data Area) cá»§a JVM, trong HotSpot JVM thÆ°á»ng Ä‘Æ°á»£c gá»i lÃ  <strong>vÃ¹ng khÃ´ng thay Ä‘á»•i</strong> (PermGen), vÃ¹ng khÃ´ng thay Ä‘á»•i chá»©a thÃ´ng tin mÃ´ táº£ lá»›p, háº±ng sá»‘, biáº¿n tÄ©nh, v.v. Khi cÃ³ nhiá»u lá»›p Ä‘Æ°á»£c táº£i, lá»›p pháº£n chiáº¿u vÃ  phÆ°Æ¡ng thá»©c Ä‘Æ°á»£c gá»i, vÃ¹ng khÃ´ng thay Ä‘á»•i cÃ³ thá»ƒ bá»‹ Ä‘áº§y, náº¿u khÃ´ng Ä‘Æ°á»£c cáº¥u hÃ¬nh Ä‘á»ƒ sá»­ dá»¥ng CMS GC, Full GC cÅ©ng sáº½ Ä‘Æ°á»£c thá»±c hiá»‡n. Náº¿u Full GC váº«n khÃ´ng thá»ƒ thu gom Ä‘Æ°á»£c, JVM sáº½ nÃ©m ra lá»—i <code>java.lang.OutOfMemoryError: PermGen space</code>. Äá»ƒ trÃ¡nh tÃ¬nh tráº¡ng vÃ¹ng khÃ´ng thay Ä‘á»•i bá»‹ Ä‘áº§y gÃ¢y ra Full GC, cÃ³ thá»ƒ tÄƒng kÃ­ch thÆ°á»›c cá»§a Perm Gen hoáº·c chuyá»ƒn sang sá»­ dá»¥ng CMS GC.</p><p><strong>(4) KÃ­ch thÆ°á»›c trung bÃ¬nh cá»§a Minor GC vÆ°á»£t quÃ¡ khÃ´ng gian cÃ²n láº¡i trong tháº¿ há»‡ giÃ </strong></p><p>Náº¿u sá»‘ liá»‡u thá»‘ng kÃª cho tháº¥y kÃ­ch thÆ°á»›c trung bÃ¬nh cá»§a Minor GC trÆ°á»›c Ä‘Ã³ lá»›n hÆ¡n khÃ´ng gian cÃ²n láº¡i trong tháº¿ há»‡ giÃ , thÃ¬ khÃ´ng sáº½ kÃ­ch hoáº¡t Minor GC mÃ  sáº½ chuyá»ƒn sang kÃ­ch hoáº¡t Full GC.</p><p><strong>(5) KÃ­ch thÆ°á»›c Ä‘á»‘i tÆ°á»£ng lá»›n hÆ¡n khÃ´ng gian trá»‘ng cá»§a khu vá»±c To vÃ  tháº¿ há»‡ giÃ </strong></p><p>Khi sao chÃ©p tá»« khu vá»±c <code>Eden</code> vÃ  khu vá»±c <code>From</code> sang khu vá»±c <code>To</code>, náº¿u kÃ­ch thÆ°á»›c Ä‘á»‘i tÆ°á»£ng lá»›n hÆ¡n bá»™ nhá»› kháº£ dá»¥ng cá»§a khu vá»±c <code>To</code>, thÃ¬ Ä‘á»‘i tÆ°á»£ng sáº½ Ä‘Æ°á»£c chuyá»ƒn vÃ o tháº¿ há»‡ giÃ , vÃ  bá»™ nhá»› kháº£ dá»¥ng cá»§a tháº¿ há»‡ giÃ  nhá» hÆ¡n kÃ­ch thÆ°á»›c cá»§a Ä‘á»‘i tÆ°á»£ng.</p></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/vanhung4499/my-wiki/edit/main/src/programming/java/JVM/JVM Garbage Collection.md" aria-label="Edit this page on GitHub" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page on GitHub<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">Last update: </span><!----></div><div class="contributors"><span class="vp-meta-label">Contributors: </span><!--[--><!--[--><span class="vp-meta-info" title="email: vanhung4499@gmail.com">Hung Nguyen Van</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/programming/java/JVM/JVM%20Command%20Line%20Tools.html" aria-label="JVM Command Line Tools"><div class="hint"><span class="arrow start"></span>Prev</div><div class="link"><!---->JVM Command Line Tools</div></a><a class="route-link auto-link next" href="/programming/java/JVM/JVM%20GUI%20Tools.html" aria-label="JVM GUI Tools"><div class="hint">Next<span class="arrow end"></span></div><div class="link">JVM GUI Tools<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper" style="display:none;--1ea755b8:;"><div class="footer-content"><div class="footer">Made with â¤ï¸ by Hung Nguyen</div><div class="copyright">Copyright Â© 2016-2024 Hung Nguyen</div></div><span id="runtime_span"></span></footer></div><!--]--><!--[--><!----><!----><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-BG8AAbz2.js" defer></script>
  </body>
</html>
