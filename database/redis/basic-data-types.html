<!doctype html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.15" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.52" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://vanhung4499.github.io/database/redis/basic-data-types.html"><meta property="og:site_name" content="VanHung4499"><meta property="og:title" content="Redis Basic Data Types"><meta property="og:description" content="Redis Basic Data Types Redis cung c·∫•p nhi·ªÅu lo·∫°i d·ªØ li·ªáu, m·ªói lo·∫°i d·ªØ li·ªáu ƒë·ªÅu c√≥ c√°c l·ªánh h·ªó tr·ª£ phong ph√∫. Khi s·ª≠ d·ª•ng Redis, kh√¥ng ch·ªâ c·∫ßn hi·ªÉu c√°c ƒë·∫∑c ƒëi·ªÉm c·ªßa c√°c lo·∫°i d·ªØ l..."><meta property="og:type" content="article"><meta property="og:image" content="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624195542.png"><meta property="og:locale" content="en-US"><meta property="og:updated_time" content="2024-06-28T15:54:38.000Z"><meta property="article:author" content="Hung Nguyen"><meta property="article:tag" content="redis"><meta property="article:tag" content="nosql"><meta property="article:modified_time" content="2024-06-28T15:54:38.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Redis Basic Data Types","image":["https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624195542.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230724115329.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624200410.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230724122757.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230724122821.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624201754.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624201852.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230724122943.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624203635.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624203650.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230724123002.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624210536.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200225143038.jpg","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200225145742.jpg","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200225150105.jpg","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200225150138.jpg","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200225214210.jpg","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624212030.png"],"dateModified":"2024-06-28T15:54:38.000Z","author":[{"@type":"Person","name":"Hung Nguyen","url":"https://vanhung4499.github.io"}]}</script><meta name="referrer" content="no-referrer-when-downgrade"><link rel="alternate" type="application/rss+xml" href="https://vanhung4499.github.io/rss.xml" title="VanHung4499 RSS Feed"><title>Redis Basic Data Types | VanHung4499</title><meta name="description" content="Redis Basic Data Types Redis cung c·∫•p nhi·ªÅu lo·∫°i d·ªØ li·ªáu, m·ªói lo·∫°i d·ªØ li·ªáu ƒë·ªÅu c√≥ c√°c l·ªánh h·ªó tr·ª£ phong ph√∫. Khi s·ª≠ d·ª•ng Redis, kh√¥ng ch·ªâ c·∫ßn hi·ªÉu c√°c ƒë·∫∑c ƒëi·ªÉm c·ªßa c√°c lo·∫°i d·ªØ l...">
    <link rel="preload" href="/assets/style-DFXXOFfS.css" as="style"><link rel="stylesheet" href="/assets/style-DFXXOFfS.css">
    <link rel="modulepreload" href="/assets/app-CIGQMwlz.js"><link rel="modulepreload" href="/assets/basic-data-types.html-D6bbADpL.js">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">Skip to main content</a><!--]--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo" src="/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">VanHung4499</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="Home"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:home" width="1em" height="1em"></iconify-icon><!--]-->Home<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/wiki.html" aria-label="Wiki"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="carbon:wikis" width="1em" height="1em"></iconify-icon><!--]-->Wiki<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/dsa/" aria-label="Algorithms"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="hugeicons:algorithm" width="1em" height="1em"></iconify-icon><!--]-->Algorithms<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Programming"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:code" width="1em" height="1em"></iconify-icon>Programming<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/java/" aria-label="Java"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:java" width="1em" height="1em"></iconify-icon><!--]-->Java<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/golang/" aria-label="Golang"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:go" width="1em" height="1em"></iconify-icon><!--]-->Golang<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/js/" aria-label="JavaScript"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:javascript" width="1em" height="1em"></iconify-icon><!--]-->JavaScript<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/ts/" aria-label="TypeScript"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:typescript" width="1em" height="1em"></iconify-icon><!--]-->TypeScript<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/python/" aria-label="Python"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:python" width="1em" height="1em"></iconify-icon><!--]-->Python<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Database"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:database" width="1em" height="1em"></iconify-icon>Database<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/sql/" aria-label="SQL"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:sql-query" width="1em" height="1em"></iconify-icon><!--]-->SQL<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/mysql/" aria-label="MySQL"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:mysql" width="1em" height="1em"></iconify-icon><!--]-->MySQL<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/mongodb/" aria-label="MongoDB"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:mongodb" width="1em" height="1em"></iconify-icon><!--]-->MongoDB<!----></a></li><li class="vp-dropdown-item"><a class="route-link route-link-active auto-link" href="/database/redis/" aria-label="Redis"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/elasticsearch/" aria-label="Elasticsearch"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:elasticsearch" width="1em" height="1em"></iconify-icon><!--]-->Elasticsearch<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/elastic/" aria-label="Elastic Stack"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="cib:elastic-stack" width="1em" height="1em"></iconify-icon><!--]-->Elastic Stack<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Framework"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="simple-icons:framework" width="1em" height="1em"></iconify-icon>Framework<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/spring/" aria-label="Spring"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->Spring<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/spring-boot/" aria-label="Spring Boot"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->Spring Boot<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/nestjs/" aria-label="NestJS"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:nestjs" width="1em" height="1em"></iconify-icon><!--]-->NestJS<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/gin/" aria-label="Gin"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="logos:gin" width="1em" height="1em"></iconify-icon><!--]-->Gin<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="DevOps"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon-plain:azuredevops" width="1em" height="1em"></iconify-icon>DevOps<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/docker/" aria-label="Docker"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:docker" width="1em" height="1em"></iconify-icon><!--]-->Docker<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/kubernetes/" aria-label="Kubernetes"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:kubernetes" width="1em" height="1em"></iconify-icon><!--]-->Kubernetes<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/jenkins/" aria-label="Jenkins"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:jenkins" width="1em" height="1em"></iconify-icon><!--]-->Jenkins<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/git/" aria-label="Git"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:git" width="1em" height="1em"></iconify-icon><!--]-->Git<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/linux/" aria-label="Linux"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:linux" width="1em" height="1em"></iconify-icon><!--]-->Linux<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Design"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="tdesign:system-sum" width="1em" height="1em"></iconify-icon>Design<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/design/design-pattern/" aria-label="Design Pattern"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="tabler:grid-pattern" width="1em" height="1em"></iconify-icon><!--]-->Design Pattern<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/design/system-design/" aria-label="System Design"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="icon-park-outline:system" width="1em" height="1em"></iconify-icon><!--]-->System Design<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Project"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="ant-design:project-outlined" width="1em" height="1em"></iconify-icon>Project<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/project/rouyi-vue-pro/" aria-label="Rouyi Vue Pro"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->Rouyi Vue Pro<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/project/yudao-cloud/" aria-label="Yudao Cloud"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->Yudao Cloud<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/interview/" aria-label="Interview"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:account-tie" width="1em" height="1em"></iconify-icon><!--]-->Interview<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="About"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:about" width="1em" height="1em"></iconify-icon>About<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/about-me.html" aria-label="About me"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="cib:about-me" width="1em" height="1em"></iconify-icon><!--]-->About me<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/about.html" aria-label="About"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:about" width="1em" height="1em"></iconify-icon><!--]-->About<!----></a></li></ul></button></div></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/vanhung4499/my-wiki" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><!--[--><button type="button" class="search-pro-button" aria-label="Search"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon" name="search"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">Search</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:sql-query" width="1em" height="1em"></iconify-icon><span class="vp-sidebar-title">SQL</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:mysql" width="1em" height="1em"></iconify-icon><span class="vp-sidebar-title">MySQL</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><span class="vp-sidebar-title">Redis</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/database/redis/overview.html" aria-label="Redis Overview"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Overview<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/database/redis/guide.html" aria-label="Redis Guide"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Guide<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/database/redis/basic-data-types.html" aria-label="Redis Basic Data Types"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Basic Data Types<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/database/redis/advanced-data-types.html" aria-label="Redis Advanced Data Types"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Advanced Data Types<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/database/redis/data-structures.html" aria-label="Redis Data Structures"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Data Structures<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/database/redis/expire.html" aria-label="Redis Expire Delete"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Expire Delete<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/database/redis/persistence.html" aria-label="Redis Persistence"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Persistence<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/database/redis/event.html" aria-label="Redis Event"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Event<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/database/redis/replication.html" aria-label="Redis Replication"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Replication<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/database/redis/sentinel.html" aria-label="Redis Sentinel"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Sentinel<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/database/redis/cluster.html" aria-label="Redis Cluster"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Cluster<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/database/redis/pub-sub.html" aria-label="Redis Publish and Subcribe"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Publish and Subcribe<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/database/redis/transaction.html" aria-label="Redis Transaction"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Transaction<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/database/redis/pipeline.html" aria-label="Redis Pipeline"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Pipeline<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/database/redis/operations.html" aria-label="Redis Operations"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Operations<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/database/redis/action.html" aria-label="Redis In Action"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis In Action<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/database/redis/interview.html" aria-label="Redis Interview"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Interview<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:mongodb" width="1em" height="1em"></iconify-icon><span class="vp-sidebar-title">MongoDB</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:elasticsearch" width="1em" height="1em"></iconify-icon><span class="vp-sidebar-title">Elasticsearch</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><iconify-icon class="font-icon icon" style="" mode="style" inline icon="cib:elastic-stack" width="1em" height="1em"></iconify-icon><span class="vp-sidebar-title">Elastic Stack</span><span class="vp-arrow end"></span></button><!----></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon>Redis Basic Data Types</h1><div class="page-info"><span class="page-author-info" aria-label="Authorüñä" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://vanhung4499.github.io" target="_blank" rel="noopener noreferrer">Hung Nguyen</a></span><span property="author" content="Hung Nguyen"></span></span><!----><span class="page-date-info" aria-label="Writing DateüìÖ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-06-28T15:54:38.000Z"></span><!----><span class="page-reading-time-info" aria-label="Reading Time‚åõ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 57 min</span><meta property="timeRequired" content="PT57M"></span><span class="page-category-info" aria-label="Categoryüåà" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color8 clickable" role="navigation">redis</span><!--]--><meta property="articleSection" content="redis"></span><span class="page-tag-info" aria-label="Tagüè∑" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color8 clickable" role="navigation">redis</span><span class="page-tag-item color7 clickable" role="navigation">nosql</span><!--]--><meta property="keywords" content="redis,nosql"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">On This Page<button type="button" class="print-button" title="Print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cac-kieu-du-lieu-co-ban-cua-redis">C√°c ki·ªÉu d·ªØ li·ªáu c∆° b·∫£n c·ªßa Redis</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#string">STRING</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gioi-thieu-ve-string">Gi·ªõi thi·ªáu v·ªÅ String</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#cach-trien-khai-string">C√°ch tri·ªÉn khai String</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#lenh-string">L·ªánh String</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ung-dung-string">·ª®ng d·ª•ng String</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#hash">HASH</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gioi-thieu-ve-hash">Gi·ªõi thi·ªáu v·ªÅ Hash</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#cau-truc-hash">C·∫•u tr√∫c Hash</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#cac-lenh-cua-hash">C√°c l·ªánh c·ªßa Hash</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ung-dung-cua-hash">·ª®ng d·ª•ng c·ªßa Hash</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#list">LIST</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gioi-thieu-ve-list">Gi·ªõi thi·ªáu v·ªÅ List</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#cach-trien-khai-list">C√°ch tri·ªÉn khai List</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#lenh-list">L·ªánh List</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ung-dung-list">·ª®ng d·ª•ng List</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#set">SET</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gioi-thieu-ve-set">Gi·ªõi thi·ªáu v·ªÅ Set</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#trien-khai-set">Tri·ªÉn khai Set</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#cac-lenh-set">C√°c l·ªánh Set</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ung-dung-set">·ª®ng d·ª•ng Set</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#zset-sorted-set">ZSET (Sorted Set)</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gioi-thieu-ve-zset">Gi·ªõi thi·ªáu v·ªÅ Zset</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#trien-khai-zset">Tri·ªÉn khai Zset</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#zset-commands">Zset Commands</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ung-dung-cua-zset">·ª®ng d·ª•ng c·ªßa Zset</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#bang-xep-hang">B·∫£ng x·∫øp h·∫°ng</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#sap-xep-theo-tien-to">S·∫Øp x·∫øp theo ti·ªÅn t·ªë</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ung-dung-thuc-te">·ª®ng d·ª•ng th·ª±c t√™</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#case-study-bai-viet-pho-bien-nhat">Case study - B√†i vi·∫øt ph·ªï bi·∫øn nh·∫•t</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#case-study-quan-ly-token">Case study - Qu·∫£n l√Ω token</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#case-study-gio-hang">Case study - Gi·ªè h√†ng</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#case-study-bo-nho-cache-trang-web">Case study - B·ªô nh·ªõ cache trang web</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#case-study-bo-nho-cache-dong-du-lieu">Case study - B·ªô nh·ªõ cache d√≤ng d·ªØ li·ªáu</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#case-study-phan-tich-trang-web">Case study - Ph√¢n t√≠ch trang web</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#case-study-ghi-log">Case study - Ghi log</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#case-study-thong-ke-du-lieu">Case study - Th·ªëng k√™ d·ªØ li·ªáu</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#case-study-tim-ƒëia-chi-ip-thuoc-ve-ƒëau">Case study - T√¨m ƒë·ªãa ch·ªâ IP thu·ªôc v·ªÅ ƒë√¢u</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#case-study-phat-hien-va-cau-hinh-dich-vu">Case study - Ph√°t hi·ªán v√† c·∫•u h√¨nh d·ªãch v·ª•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#case-study-tu-ƒëong-hoan-chinh">Case study - T·ª± ƒë·ªông ho√†n ch·ªânh</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#case-study-ƒëinh-huong-quang-cao">Case study - ƒê·ªãnh h∆∞·ªõng qu·∫£ng c√°o</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#case-study-tim-kiem-vi-tri-cong-viec">Case study - T√¨m ki·∫øm v·ªã tr√≠ c√¥ng vi·ªác</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h1 id="redis-basic-data-types" tabindex="-1"><a class="header-anchor" href="#redis-basic-data-types"><span>Redis Basic Data Types</span></a></h1><p>Redis cung c·∫•p nhi·ªÅu lo·∫°i d·ªØ li·ªáu, m·ªói lo·∫°i d·ªØ li·ªáu ƒë·ªÅu c√≥ c√°c l·ªánh h·ªó tr·ª£ phong ph√∫.</p><p>Khi s·ª≠ d·ª•ng Redis, kh√¥ng ch·ªâ c·∫ßn hi·ªÉu c√°c ƒë·∫∑c ƒëi·ªÉm c·ªßa c√°c lo·∫°i d·ªØ li·ªáu, m√† c√≤n c·∫ßn linh ho·∫°t v√† hi·ªáu qu·∫£ trong vi·ªác s·ª≠ d·ª•ng c√°c lo·∫°i d·ªØ li·ªáu n√†y ƒë·ªÉ x√¢y d·ª±ng m√¥ h√¨nh d·ªØ li·ªáu ph√π h·ª£p v·ªõi k·ªãch b·∫£n nghi·ªáp v·ª•.</p><p>C√°c lo·∫°i d·ªØ li·ªáu c∆° b·∫£n m√† Redis h·ªó tr·ª£:</p><ul><li><strong>STRING</strong>: Chu·ªói</li><li><strong>HASH</strong>: B·∫£ng bƒÉm</li><li><strong>LIST</strong>: List</li><li><strong>SET</strong>: T·∫≠p h·ª£p</li><li><strong>ZSET</strong>: T·∫≠p h·ª£p c√≥ th·ª© t·ª±</li></ul><p>C√°c lo·∫°i d·ªØ li·ªáu n√¢ng cao m√† Redis h·ªó tr·ª£:</p><ul><li><strong>BitMap</strong>: B·∫£n ƒë·ªì bit</li><li><strong>HyperLogLog</strong>: ƒê·∫øm d·ªØ li·ªáu kh·ªïng l·ªì</li><li><strong>GEO</strong>: D·ªØ li·ªáu v·ªã tr√≠ ƒë·ªãa l√Ω</li><li><strong>Stream</strong>: D·ªØ li·ªáu lu·ªìng</li></ul><p>S·ª≠ d·ª•ng Redis, kh√¥ng ch·ªâ c·∫ßn hi·ªÉu c√°c ƒë·∫∑c t√≠nh c·ªßa c√°c lo·∫°i d·ªØ li·ªáu m√† c√≤n c·∫ßn linh ho·∫°t v√† hi·ªáu qu·∫£ trong vi·ªác s·ª≠ d·ª•ng c√°c lo·∫°i d·ªØ li·ªáu n√†y ƒë·ªÉ x√¢y d·ª±ng m√¥ h√¨nh theo t·ª´ng t√¨nh hu·ªëng c·ª• th·ªÉ c·ªßa nghi·ªáp v·ª•.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624195542.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><h2 id="cac-kieu-du-lieu-co-ban-cua-redis" tabindex="-1"><a class="header-anchor" href="#cac-kieu-du-lieu-co-ban-cua-redis"><span>C√°c ki·ªÉu d·ªØ li·ªáu c∆° b·∫£n c·ªßa Redis</span></a></h2><table><thead><tr><th>Ki·ªÉu d·ªØ li·ªáu</th><th>Gi√° tr·ªã c√≥ th·ªÉ l∆∞u tr·ªØ</th><th>C√°c ho·∫°t ƒë·ªông</th></tr></thead><tbody><tr><td>STRING</td><td>Chu·ªói, s·ªë nguy√™n ho·∫∑c s·ªë th·ª±c</td><td>Th·ª±c hi·ªán c√°c ho·∫°t ƒë·ªông tr√™n to√†n b·ªô chu·ªói ho·∫∑c m·ªôt ph·∫ßn c·ªßa chu·ªói <br>Th·ª±c hi·ªán tƒÉng ho·∫∑c gi·∫£m gi√° tr·ªã s·ªë nguy√™n ho·∫∑c s·ªë th·ª±c</td></tr><tr><td>LIST</td><td>List</td><td>Th√™m ho·∫∑c l·∫•y ra ph·∫ßn t·ª≠ t·ª´ hai ƒë·∫ßu <br>ƒê·ªçc m·ªôt ho·∫∑c nhi·ªÅu ph·∫ßn t·ª≠ <br>Th·ª±c hi·ªán c·∫Øt t·ªâa, ch·ªâ gi·ªØ l·∫°i m·ªôt ph·∫°m vi ph·∫ßn t·ª≠</td></tr><tr><td>SET</td><td>T·∫≠p h·ª£p kh√¥ng th·ª© t·ª±</td><td>Th√™m, l·∫•y v√† x√≥a m·ªôt ph·∫ßn t·ª≠ <br>Ki·ªÉm tra xem m·ªôt ph·∫ßn t·ª≠ c√≥ t·ªìn t·∫°i trong t·∫≠p h·ª£p hay kh√¥ng <br>T√≠nh to√°n giao, h·ª£p, hi·ªáu <br>L·∫•y ng·∫´u nhi√™n m·ªôt ph·∫ßn t·ª≠ t·ª´ t·∫≠p h·ª£p</td></tr><tr><td>HASH</td><td>B·∫£ng bƒÉm kh√¥ng th·ª© t·ª±</td><td>Th√™m, l·∫•y v√† x√≥a m·ªôt c·∫∑p kh√≥a-gi√° tr·ªã <br>L·∫•y t·∫•t c·∫£ c√°c c·∫∑p kh√≥a-gi√° tr·ªã <br>Ki·ªÉm tra xem m·ªôt kh√≥a c√≥ t·ªìn t·∫°i trong b·∫£ng hay kh√¥ng</td></tr><tr><td>ZSET</td><td>T·∫≠p h·ª£p c√≥ th·ª© t·ª±</td><td>Th√™m, l·∫•y v√† x√≥a ph·∫ßn t·ª≠ <br>L·∫•y ph·∫ßn t·ª≠ d·ª±a tr√™n ph·∫°m vi ho·∫∑c th√†nh vi√™n <br>T√≠nh h·∫°ng c·ªßa m·ªôt kh√≥a</td></tr></tbody></table><blockquote><p><a href="https://redislabs.com/ebook/part-1-getting-started/chapter-1-getting-to-know-redis/1-2-what-redis-data-structures-look-like/" target="_blank" rel="noopener noreferrer">What Redis data structures look like</a></p></blockquote><h2 id="string" tabindex="-1"><a class="header-anchor" href="#string"><span>STRING</span></a></h2><h3 id="gioi-thieu-ve-string" tabindex="-1"><a class="header-anchor" href="#gioi-thieu-ve-string"><span>Gi·ªõi thi·ªáu v·ªÅ String</span></a></h3><p>Ki·ªÉu d·ªØ li·ªáu String l√† m·ªôt c·∫•u tr√∫c d·∫°ng c·∫∑p kh√≥a-gi√° tr·ªã.</p><p>String l√† lo·∫°i d·ªØ li·ªáu <strong>an to√†n nh·ªã ph√¢n</strong>. An to√†n nh·ªã ph√¢n c√≥ nghƒ©a l√† ki·ªÉu d·ªØ li·ªáu String kh√¥ng ch·ªâ c√≥ th·ªÉ l∆∞u tr·ªØ d·ªØ li·ªáu vƒÉn b·∫£n m√† c√≤n c√≥ th·ªÉ l∆∞u tr·ªØ b·∫•t k·ª≥ ƒë·ªãnh d·∫°ng d·ªØ li·ªáu nh·ªã ph√¢n n√†o, ch·∫≥ng h·∫°n nh∆∞: h√¨nh ·∫£nh, √¢m thanh, video, t·ªáp n√©n, v.v.</p><p>Theo m·∫∑c ƒë·ªãnh, gi√° tr·ªã c·ªßa ki·ªÉu d·ªØ li·ªáu String c√≥ th·ªÉ l√™n ƒë·∫øn <strong>512 MB</strong>.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230724115329.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><h3 id="cach-trien-khai-string" tabindex="-1"><a class="header-anchor" href="#cach-trien-khai-string"><span>C√°ch tri·ªÉn khai String</span></a></h3><p>C·∫•u tr√∫c d·ªØ li·ªáu c∆° b·∫£n c·ªßa ki·ªÉu String ch·ªß y·∫øu l√† <code>int</code> v√† <code>SDS</code> (Simple Dynamic String - Chu·ªói ƒë·ªông ƒë∆°n gi·∫£n).</p><p>SDS kh√°c v·ªõi chu·ªói C m√† ch√∫ng ta th∆∞·ªùng bi·∫øt. L√Ω do kh√¥ng s·ª≠ d·ª•ng chu·ªói C v√¨ SDS so v·ªõi chu·ªói g·ªëc c·ªßa C c√≥ nh·ªØng ∆∞u ƒëi·ªÉm sau:</p><ul><li><strong>SDS kh√¥ng ch·ªâ l∆∞u tr·ªØ d·ªØ li·ªáu vƒÉn b·∫£n m√† c√≤n l∆∞u tr·ªØ d·ªØ li·ªáu nh·ªã ph√¢n</strong>. SDS s·ª≠ d·ª•ng thu·ªôc t√≠nh <code>len</code> ƒë·ªÉ x√°c ƒë·ªãnh ƒë·ªô d√†i chu·ªói thay v√¨ s·ª≠ d·ª•ng k√Ω t·ª± k·∫øt th√∫c null, v√† t·∫•t c·∫£ c√°c API c·ªßa SDS ƒë·ªÅu x·ª≠ l√Ω d·ªØ li·ªáu trong m·∫£ng <code>buf[]</code> nh∆∞ l√† d·ªØ li·ªáu nh·ªã ph√¢n. Do ƒë√≥, SDS kh√¥ng ch·ªâ c√≥ th·ªÉ l∆∞u tr·ªØ d·ªØ li·ªáu vƒÉn b·∫£n m√† c√≤n c√≥ th·ªÉ l∆∞u tr·ªØ d·ªØ li·ªáu nh·ªã ph√¢n nh∆∞ h√¨nh ·∫£nh, √¢m thanh, video, t·ªáp n√©n.</li><li><strong>Th·ªùi gian ph·ª©c t·∫°p ƒë·ªÉ l·∫•y ƒë·ªô d√†i chu·ªói c·ªßa SDS l√† O(1)</strong>. V√¨ chu·ªói C kh√¥ng ghi l·∫°i ƒë·ªô d√†i c·ªßa ch√≠nh n√≥, n√™n th·ªùi gian ph·ª©c t·∫°p ƒë·ªÉ l·∫•y ƒë·ªô d√†i l√† O(n); trong khi c·∫•u tr√∫c SDS s·ª≠ d·ª•ng thu·ªôc t√≠nh <code>len</code> ƒë·ªÉ ghi l·∫°i ƒë·ªô d√†i chu·ªói, do ƒë√≥ th·ªùi gian ph·ª©c t·∫°p l√† <code>O(1)</code>.</li><li><strong>API c·ªßa SDS trong Redis l√† an to√†n, vi·ªác n·ªëi chu·ªói s·∫Ω kh√¥ng g√¢y ra tr√†n b·ªô ƒë·ªám</strong>. SDS ki·ªÉm tra kh√¥ng gian tr∆∞·ªõc khi n·ªëi chu·ªói, n·∫øu kh√¥ng ƒë·ªß kh√¥ng gian s·∫Ω t·ª± ƒë·ªông m·ªü r·ªông, do ƒë√≥ s·∫Ω kh√¥ng g√¢y ra v·∫•n ƒë·ªÅ tr√†n b·ªô ƒë·ªám.</li></ul><p><strong>M√£ h√≥a c·ªßa ƒë·ªëi t∆∞·ª£ng chu·ªói c√≥ th·ªÉ l√† <code>int</code>, <code>raw</code> ho·∫∑c <code>embstr</code></strong>.</p><p>C√°c ph∆∞∆°ng ph√°p m√£ h√≥a gi√° tr·ªã c·ªßa ƒë·ªëi t∆∞·ª£ng chu·ªói:</p><table><thead><tr><th style="text-align:left;">Gi√° tr·ªã</th><th style="text-align:left;">M√£ h√≥a</th></tr></thead><tbody><tr><td style="text-align:left;">S·ªë nguy√™n c√≥ th·ªÉ ƒë∆∞·ª£c l∆∞u b·∫±ng ki·ªÉu <code>long</code>.</td><td style="text-align:left;"><code>int</code></td></tr><tr><td style="text-align:left;">S·ªë th·ª±c c√≥ th·ªÉ ƒë∆∞·ª£c l∆∞u b·∫±ng ki·ªÉu <code>long double</code>.</td><td style="text-align:left;"><code>embstr</code> ho·∫∑c <code>raw</code></td></tr><tr><td style="text-align:left;">Gi√° tr·ªã chu·ªói ho·∫∑c s·ªë nguy√™n qu√° l·ªõn kh√¥ng th·ªÉ bi·ªÉu di·ªÖn b·∫±ng <code>long</code>.</td><td style="text-align:left;"><code>embstr</code> ho·∫∑c <code>raw</code></td></tr></tbody></table><p>N·∫øu m·ªôt ƒë·ªëi t∆∞·ª£ng chu·ªói l∆∞u tr·ªØ gi√° tr·ªã s·ªë nguy√™n v√† gi√° tr·ªã n√†y c√≥ th·ªÉ bi·ªÉu di·ªÖn b·∫±ng ki·ªÉu <code>long</code>, th√¨ ƒë·ªëi t∆∞·ª£ng chu·ªói s·∫Ω l∆∞u tr·ªØ gi√° tr·ªã s·ªë nguy√™n trong thu·ªôc t√≠nh <code>ptr</code> c·ªßa c·∫•u tr√∫c ƒë·ªëi t∆∞·ª£ng chu·ªói (chuy·ªÉn <code>void*</code> th√†nh <code>long</code>), v√† s·∫Ω ƒë·∫∑t m√£ h√≥a c·ªßa ƒë·ªëi t∆∞·ª£ng chu·ªói th√†nh <code>int</code>.</p><p><strong>V√≠ d·ª•</strong></p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; SET number 10086</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">OK</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; OBJECT ENCODING number</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">&quot;int&quot;</span></span></code></pre></div><p>N·∫øu ƒë·ªëi t∆∞·ª£ng chu·ªói l∆∞u tr·ªØ m·ªôt gi√° tr·ªã chu·ªói v√† ƒë·ªô d√†i c·ªßa chu·ªói n√†y l·ªõn h∆°n <code>39</code> byte, th√¨ ƒë·ªëi t∆∞·ª£ng chu·ªói s·∫Ω s·ª≠ d·ª•ng m·ªôt chu·ªói ƒë·ªông ƒë∆°n gi·∫£n (SDS) ƒë·ªÉ l∆∞u tr·ªØ gi√° tr·ªã chu·ªói n√†y v√† m√£ h√≥a ƒë·ªëi t∆∞·ª£ng s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t l√† <code>raw</code>.</p><div class="language-c" data-highlighter="shiki" data-ext="c" data-title="c" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">&gt;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> SET story </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;Long, long, long ago there lived a king ...&quot;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">OK</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">&gt;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> STRLEN story</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(integer) </span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">43</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">&gt;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> OBJECT ENCODING story</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;raw&quot;</span></span></code></pre></div><p>N·∫øu ƒë·ªëi t∆∞·ª£ng chu·ªói l∆∞u tr·ªØ m·ªôt gi√° tr·ªã chu·ªói v√† ƒë·ªô d√†i c·ªßa chu·ªói n√†y nh·ªè h∆°n ho·∫∑c b·∫±ng <code>39</code> byte, th√¨ ƒë·ªëi t∆∞·ª£ng chu·ªói s·∫Ω s·ª≠ d·ª•ng m√£ h√≥a <code>embstr</code> ƒë·ªÉ l∆∞u tr·ªØ gi√° tr·ªã chu·ªói n√†y. M√£ h√≥a <code>embstr</code> l√† m·ªôt c√°ch m√£ h√≥a t·ªëi ∆∞u ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·∫∑c bi·ªát ƒë·ªÉ l∆∞u tr·ªØ c√°c chu·ªói ng·∫Øn.</p><p><strong>V√≠ d·ª•</strong></p><div class="language-c" data-highlighter="shiki" data-ext="c" data-title="c" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">&gt;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> SET msg </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;hello&quot;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">OK</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">&gt;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> OBJECT ENCODING msg</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;embstr&quot;</span></span></code></pre></div><h3 id="lenh-string" tabindex="-1"><a class="header-anchor" href="#lenh-string"><span>L·ªánh String</span></a></h3><table><thead><tr><th>L·ªánh</th><th>M√¥ t·∫£</th></tr></thead><tbody><tr><td><code>SET</code></td><td>L∆∞u tr·ªØ m·ªôt gi√° tr·ªã chu·ªói</td></tr><tr><td><code>SETNX</code></td><td>L∆∞u tr·ªØ gi√° tr·ªã chu·ªói ch·ªâ khi kh√≥a kh√¥ng t·ªìn t·∫°i</td></tr><tr><td><code>GET</code></td><td>L·∫•y gi√° tr·ªã c·ªßa kh√≥a c·ª• th·ªÉ</td></tr><tr><td><code>MGET</code></td><td>L·∫•y gi√° tr·ªã c·ªßa m·ªôt ho·∫∑c nhi·ªÅu kh√≥a c·ª• th·ªÉ</td></tr><tr><td><code>INCRBY</code></td><td>TƒÉng gi√° tr·ªã s·ªë l∆∞u tr·ªØ trong kh√≥a l√™n m·ªôt gi√° tr·ªã nh·∫•t ƒë·ªãnh</td></tr><tr><td><code>DECRBY</code></td><td>Gi·∫£m gi√° tr·ªã s·ªë l∆∞u tr·ªØ trong kh√≥a xu·ªëng m·ªôt gi√° tr·ªã nh·∫•t ƒë·ªãnh</td></tr></tbody></table><blockquote><p>Tham kh·∫£o th√™m c√°c l·ªánh kh√°c t·∫°i: <a href="https://redis.io/commands#string" target="_blank" rel="noopener noreferrer">T√†i li·ªáu ch√≠nh th·ª©c v·ªÅ l·ªánh String c·ªßa Redis</a></p></blockquote><p><strong>V√≠ d·ª• v·ªÅ c√°c thao t√°c SET, GET, v√† DEL</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># L∆∞u gi√° tr·ªã &#39;hung&#39; cho kh√≥a &#39;name&#39;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; set name hung</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">OK</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># L·∫•y gi√° tr·ªã c·ªßa kh√≥a &#39;name&#39;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; get name</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">&quot;hung&quot;</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># L∆∞u gi√° tr·ªã &#39;unknown&#39; cho kh√≥a &#39;name&#39; (ghi ƒë√® gi√° tr·ªã c≈©)</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; set name unknown</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">OK</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; get name</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">&quot;unknown&quot;</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Ki·ªÉm tra xem kh√≥a &#39;name&#39; c√≥ t·ªìn t·∫°i hay kh√¥ng</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; exists name</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># X√≥a kh√≥a &#39;name&#39;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; del name</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Ki·ªÉm tra xem kh√≥a &#39;name&#39; c√≥ t·ªìn t·∫°i hay kh√¥ng</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; exists name</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">0</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># L·∫•y gi√° tr·ªã c·ªßa kh√≥a &#39;name&#39;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; get name</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">nil</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>V√≠ d·ª• v·ªÅ thao t√°c SETNX</strong></p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Ki·ªÉm tra xem kh√≥a &#39;lock&#39; c√≥ t·ªìn t·∫°i hay kh√¥ng</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; exists lock</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">0</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># L∆∞u gi√° tr·ªã &#39;1&#39; cho kh√≥a &#39;lock&#39;, l∆∞u th√†nh c√¥ng</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; setnx lock 1</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># C·ªë g·∫Øng l∆∞u gi√° tr·ªã &#39;2&#39; cho kh√≥a &#39;lock&#39;, l∆∞u th·∫•t b·∫°i do kh√≥a ƒë√£ t·ªìn t·∫°i</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; setnx lock 2</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">0</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># L·∫•y gi√° tr·ªã c·ªßa kh√≥a &#39;lock&#39;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; get lock</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">&quot;1&quot;</span></span></code></pre></div><p><strong>V√≠ d·ª• v·ªÅ thao t√°c MSET, MGET</strong></p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># L∆∞u tr·ªØ h√†ng lo·∫°t gi√° tr·ªã cho c√°c kh√≥a &#39;one&#39;, &#39;two&#39;, &#39;three&#39;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; mset one 1 two 2 three 3</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">OK</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># L·∫•y gi√° tr·ªã c·ªßa c√°c kh√≥a &#39;one&#39;, &#39;two&#39;, &#39;three&#39;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; mget one two three</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;1&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;2&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">3</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;3&quot;</span></span></code></pre></div><p><strong>V√≠ d·ª• v·ªÅ c√°c thao t√°c INCR, DECR, INCRBY, DECRBY</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># L∆∞u gi√° tr·ªã &#39;0&#39; cho kh√≥a &#39;counter&#39;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; set counter 0</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">OK</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># TƒÉng gi√° tr·ªã c·ªßa kh√≥a &#39;counter&#39; l√™n 1</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; incr counter</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># TƒÉng gi√° tr·ªã c·ªßa kh√≥a &#39;counter&#39; l√™n 9</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; incrby counter 9</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">10</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Gi·∫£m gi√° tr·ªã c·ªßa kh√≥a &#39;counter&#39; xu·ªëng 1</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; decr counter</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">9</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Gi·∫£m gi√° tr·ªã c·ªßa kh√≥a &#39;counter&#39; xu·ªëng 9</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; decrby counter 9</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ung-dung-string" tabindex="-1"><a class="header-anchor" href="#ung-dung-string"><span>·ª®ng d·ª•ng String</span></a></h3><p><strong>C√°c k·ªãch b·∫£n ph√π h·ª£p: Cache, B·ªô ƒë·∫øm, Chia s·∫ª Session</strong></p><h4 id="cache-ƒëoi-tuong" tabindex="-1"><a class="header-anchor" href="#cache-ƒëoi-tuong"><span>Cache ƒë·ªëi t∆∞·ª£ng</span></a></h4><p>C√≥ hai c√°ch s·ª≠ d·ª•ng String ƒë·ªÉ cache ƒë·ªëi t∆∞·ª£ng:</p><ol><li>Cache gi√° tr·ªã JSON c·ªßa ƒë·ªëi t∆∞·ª£ng</li></ol><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; set user:1 {</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">&quot;name&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">&quot;hung&quot;</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">,</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">&quot;sex&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">&quot;man&quot;</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">}</span></span></code></pre></div><ol start="2"><li>Chia key th√†nh d·∫°ng <code>user:ID:attribute</code>, s·ª≠ d·ª•ng MSET ƒë·ªÉ l∆∞u tr·ªØ, d√πng MGET ƒë·ªÉ l·∫•y gi√° tr·ªã c√°c thu·ªôc t√≠nh</li></ol><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; mset user:1:name hung user:1:sex man</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">OK</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; mget user:1:name user:1:sex</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;hung&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;man&quot;</span></span></code></pre></div><h4 id="bo-ƒëem" tabindex="-1"><a class="header-anchor" href="#bo-ƒëem"><span>B·ªô ƒë·∫øm</span></a></h4><p><strong>K·ªãch b·∫£n y√™u c·∫ßu</strong></p><p>Th·ªëng k√™ s·ªë l∆∞·ª£t truy c·∫≠p, l∆∞·ª£t y√™u th√≠ch, l∆∞·ª£t th√≠ch, v.v. c·ªßa n·ªôi dung tr√™n trang web.</p><p><strong>Gi·∫£i ph√°p</strong></p><blockquote><p>S·ª≠ d·ª•ng ki·ªÉu String c·ªßa Redis ƒë·ªÉ l∆∞u tr·ªØ m·ªôt b·ªô ƒë·∫øm.</p></blockquote><p>C√°c thao t√°c ph·ªï bi·∫øn ƒë·ªÉ duy tr√¨ b·ªô ƒë·∫øm:</p><ul><li>TƒÉng gi√° tr·ªã th·ªëng k√™ - s·ª≠ d·ª•ng l·ªánh <code>INCR</code>, <code>INCRBY</code></li><li>Gi·∫£m gi√° tr·ªã th·ªëng k√™ - s·ª≠ d·ª•ng l·ªánh <code>DECR</code>, <code>DECRBY</code></li></ul><p><strong>V√≠ d·ª• m√£</strong></p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Kh·ªüi t·∫°o s·ªë l∆∞·ª£t truy c·∫≠p c·ªßa b√†i vi·∫øt ID l√† 1024 l√† 0</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; set blog:view:1024 0</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">OK</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># TƒÉng s·ªë l∆∞·ª£t truy c·∫≠p c·ªßa b√†i vi·∫øt ID l√† 1024 l√™n 1</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; incr blog:view:1024</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># TƒÉng s·ªë l∆∞·ª£t truy c·∫≠p c·ªßa b√†i vi·∫øt ID l√† 1024 l√™n 1</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; incr blog:view:1024</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">2</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Xem s·ªë l∆∞·ª£t truy c·∫≠p c·ªßa b√†i vi·∫øt ID l√† 1024</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; get blog:view:1024</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">&quot;2&quot;</span></span></code></pre></div><h4 id="khoa-phan-tan" tabindex="-1"><a class="header-anchor" href="#khoa-phan-tan"><span>Kh√≥a ph√¢n t√°n</span></a></h4><ol><li>Y√™u c·∫ßu kh√≥a</li></ol><p>L·ªánh SET c√≥ tham s·ªë NX c√≥ th·ªÉ th·ª±c hi·ªán &quot;ch·ªâ ch√®n khi key kh√¥ng t·ªìn t·∫°i&quot;, c√≥ th·ªÉ d√πng n√≥ ƒë·ªÉ th·ª±c hi·ªán kh√≥a ph√¢n t√°n:</p><ul><li>N·∫øu key kh√¥ng t·ªìn t·∫°i, ch√®n th√†nh c√¥ng, c√≥ th·ªÉ coi l√† kh√≥a th√†nh c√¥ng.</li><li>N·∫øu key ƒë√£ t·ªìn t·∫°i, ch√®n th·∫•t b·∫°i, c√≥ th·ªÉ coi l√† kh√≥a th·∫•t b·∫°i.</li></ul><p>Th√¥ng th∆∞·ªùng, kh√≥a ph√¢n t√°n c≈©ng s·∫Ω ƒë∆∞·ª£c thi·∫øt l·∫≠p th·ªùi gian h·∫øt h·∫°n, l·ªánh kh√≥a ph√¢n t√°n nh∆∞ sau:</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SET</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> value</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> NX</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> PX</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 30000</span></span></code></pre></div><ul><li>key - l√† t·ª´ kh√≥a c·ªßa kh√≥a ph√¢n t√°n.</li><li>value - l√† gi√° tr·ªã duy nh·∫•t ƒë∆∞·ª£c t·∫°o b·ªüi client.</li><li>NX - ch·ªâ th·ª±c hi·ªán SET n·∫øu key kh√¥ng t·ªìn t·∫°i. (N·∫øu Redis ƒë√£ c√≥ key n√†y, thi·∫øt l·∫≠p th·∫•t b·∫°i v√† tr·∫£ v·ªÅ <code>nil</code>)</li><li>PX 30000 - ch·ªâ ƒë·ªãnh key s·∫Ω b·ªã x√≥a sau 30 gi√¢y (nghƒ©a l√† kh√≥a s·∫Ω ƒë∆∞·ª£c gi·∫£i ph√≥ng). Thi·∫øt l·∫≠p th·ªùi gian h·∫øt h·∫°n ƒë·ªÉ tr√°nh kh√≥a kh√¥ng ƒë∆∞·ª£c gi·∫£i ph√≥ng do c√°c t√¨nh hu·ªëng b·∫•t ng·ªù.</li></ul><ol start="2"><li>Gi·∫£i ph√≥ng kh√≥a</li></ol><p>Gi·∫£i ph√≥ng kh√≥a b·∫±ng c√°ch x√≥a key, nh∆∞ng th√¥ng th∆∞·ªùng c√≥ th·ªÉ s·ª≠ d·ª•ng script <code>lua</code> ƒë·ªÉ x√≥a, so s√°nh gi√° tr·ªã tr∆∞·ªõc khi x√≥a, ƒë·∫£m b·∫£o r·∫±ng ch·ªâ client n√†o t·∫°o ra kh√≥a m·ªõi c√≥ th·ªÉ x√≥a kh√≥a ƒë√≥. ƒê·ªÉ ƒë·∫£m b·∫£o t√≠nh nguy√™n t·ª≠, c√≥ th·ªÉ s·ª≠ d·ª•ng script lua:</p><div class="language-lua" data-highlighter="shiki" data-ext="lua" data-title="lua" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">-- X√≥a kh√≥a n·∫øu gi√° tr·ªã c·ªßa key tr√πng kh·ªõp v·ªõi gi√° tr·ªã truy·ªÅn v√†o</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> redis</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">call</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;get&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">KEYS</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">]) == </span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">ARGV</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> redis</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">call</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;del&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">KEYS</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">])</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">else</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">end</span></span></code></pre></div><h4 id="chia-se-thong-tin-session" tabindex="-1"><a class="header-anchor" href="#chia-se-thong-tin-session"><span>Chia s·∫ª th√¥ng tin Session</span></a></h4><p>Trong m√¥i tr∆∞·ªùng ph√¢n t√°n, n·∫øu m·ªôt Session c·ªßa ng∆∞·ªùi d√πng ch·ªâ ƒë∆∞·ª£c l∆∞u tr√™n m·ªôt m√°y ch·ªß, khi b·ªô c√¢n b·∫±ng t·∫£i chuy·ªÉn y√™u c·∫ßu ti·∫øp theo c·ªßa ng∆∞·ªùi d√πng t·ªõi m√°y ch·ªß kh√°c, m√°y ch·ªß n√†y kh√¥ng c√≥ Session c·ªßa ng∆∞·ªùi d√πng, c√≥ th·ªÉ d·∫´n ƒë·∫øn vi·ªác ng∆∞·ªùi d√πng ph·∫£i ƒëƒÉng nh·∫≠p l·∫°i.</p><p>C√°c chi·∫øn l∆∞·ª£c ƒë·ªÉ th·ª±c hi·ªán Session ph√¢n t√°n:</p><ol><li>Session d√≠nh</li><li>Sao ch√©p v√† chia s·∫ª session gi·ªØa c√°c m√°y ch·ªß ·ª©ng d·ª•ng</li><li>Chia s·∫ª session d·ª±a tr√™n cache ‚úÖ</li></ol><p>Th·ª±c hi·ªán chia s·∫ª session d·ª±a tr√™n cache</p><blockquote><p><strong>S·ª≠ d·ª•ng m·ªôt m√°y ch·ªß l∆∞u tr·ªØ ri√™ng bi·ªát ƒë·ªÉ l∆∞u tr·ªØ d·ªØ li·ªáu Session</strong>, c√≥ th·ªÉ l√† MySQL, Redis ho·∫∑c Memcached.</p><p>Nh∆∞·ª£c ƒëi·ªÉm: C·∫ßn tri·ªÉn khai m√£ ƒë·ªÉ truy xu·∫•t Session.</p></blockquote><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624200410.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><h2 id="hash" tabindex="-1"><a class="header-anchor" href="#hash"><span>HASH</span></a></h2><h3 id="gioi-thieu-ve-hash" tabindex="-1"><a class="header-anchor" href="#gioi-thieu-ve-hash"><span>Gi·ªõi thi·ªáu v·ªÅ Hash</span></a></h3><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230724122757.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>Hash l√† m·ªôt t·∫≠p h·ª£p c√°c c·∫∑p kh√≥a-gi√° tr·ªã (key-value), trong ƒë√≥ gi√° tr·ªã c√≥ d·∫°ng: <code>value=[{field1, value1}, ...{fieldN, valueN}]</code>. Hash ƒë·∫∑c bi·ªát ph√π h·ª£p ƒë·ªÉ l∆∞u tr·ªØ c√°c ƒë·ªëi t∆∞·ª£ng.</p><h3 id="cau-truc-hash" tabindex="-1"><a class="header-anchor" href="#cau-truc-hash"><span>C·∫•u tr√∫c Hash</span></a></h3><p>M√£ h√≥a c·ªßa ƒë·ªëi t∆∞·ª£ng Hash c√≥ th·ªÉ l√† <code>ziplist</code> ho·∫∑c <code>hashtable</code>.</p><ul><li><code>ziplist</code>: M√£ h√≥a ƒë·ªëi t∆∞·ª£ng Hash b·∫±ng List n√©n l√†m c·∫•u tr√∫c n·ªÅn t·∫£ng. M·ªói khi c√≥ m·ªôt c·∫∑p kh√≥a-gi√° tr·ªã m·ªõi ƒë∆∞·ª£c th√™m v√†o ƒë·ªëi t∆∞·ª£ng Hash, ch∆∞∆°ng tr√¨nh s·∫Ω ƒë·∫©y n√∫t ch·ª©a kh√≥a v√†o cu·ªëi List n√©n, sau ƒë√≥ ƒë·∫©y n√∫t ch·ª©a gi√° tr·ªã v√†o cu·ªëi List n√©n.</li><li><code>hashtable</code>: M√£ h√≥a ƒë·ªëi t∆∞·ª£ng Hash b·∫±ng b·∫£ng bƒÉm l√†m c·∫•u tr√∫c n·ªÅn t·∫£ng. M·ªói c·∫∑p kh√≥a-gi√° tr·ªã trong ƒë·ªëi t∆∞·ª£ng Hash ƒë·ªÅu ƒë∆∞·ª£c l∆∞u tr·ªØ d∆∞·ªõi d·∫°ng m·ªôt c·∫∑p kh√≥a-gi√° tr·ªã c·ªßa b·∫£ng bƒÉm.</li></ul><p>ƒê·ªëi t∆∞·ª£ng Hash s·∫Ω s·ª≠ d·ª•ng m√£ h√≥a <code>ziplist</code> khi ƒë·ªìng th·ªùi th·ªèa m√£n hai ƒëi·ªÅu ki·ªán sau; ng∆∞·ª£c l·∫°i, s·∫Ω s·ª≠ d·ª•ng m√£ h√≥a <code>hashtable</code>:</p><ol><li>ƒê·ªô d√†i c·ªßa t·∫•t c·∫£ c√°c kh√≥a v√† gi√° tr·ªã c·ªßa c√°c c·∫∑p kh√≥a-gi√° tr·ªã trong ƒë·ªëi t∆∞·ª£ng Hash ƒë·ªÅu nh·ªè h∆°n <code>64</code> byte (c√≥ th·ªÉ ƒë∆∞·ª£c c·∫•u h√¨nh b·∫±ng <code>hash-max-ziplist-value</code>).</li><li>S·ªë l∆∞·ª£ng c·∫∑p kh√≥a-gi√° tr·ªã trong ƒë·ªëi t∆∞·ª£ng Hash nh·ªè h∆°n <code>512</code> (c√≥ th·ªÉ ƒë∆∞·ª£c c·∫•u h√¨nh b·∫±ng <code>hash-max-ziplist-entries</code>).</li></ol><blockquote><p>L∆∞u √Ω: Gi√° tr·ªã gi·ªõi h·∫°n c·ªßa hai ƒëi·ªÅu ki·ªán n√†y c√≥ th·ªÉ ƒë∆∞·ª£c thay ƒë·ªïi, c·ª• th·ªÉ h√£y xem ph·∫ßn m√¥ t·∫£ trong t·ªáp c·∫•u h√¨nh v·ªÅ t√πy ch·ªçn <code>hash-max-ziplist-value</code> v√† <code>hash-max-ziplist-entries</code>.</p></blockquote><h3 id="cac-lenh-cua-hash" tabindex="-1"><a class="header-anchor" href="#cac-lenh-cua-hash"><span>C√°c l·ªánh c·ªßa Hash</span></a></h3><table><thead><tr><th>L·ªánh</th><th>M√¥ t·∫£</th></tr></thead><tbody><tr><td><code>HSET</code></td><td>Thi·∫øt l·∫≠p gi√° tr·ªã c·ªßa tr∆∞·ªùng ƒë√£ ch·ªâ ƒë·ªãnh</td></tr><tr><td><code>HGET</code></td><td>L·∫•y gi√° tr·ªã c·ªßa tr∆∞·ªùng ƒë√£ ch·ªâ ƒë·ªãnh</td></tr><tr><td><code>HGETALL</code></td><td>L·∫•y t·∫•t c·∫£ c√°c c·∫∑p kh√≥a-gi√° tr·ªã</td></tr><tr><td><code>HMSET</code></td><td>Thi·∫øt l·∫≠p nhi·ªÅu c·∫∑p kh√≥a-gi√° tr·ªã</td></tr><tr><td><code>HMGET</code></td><td>L·∫•y gi√° tr·ªã c·ªßa nhi·ªÅu tr∆∞·ªùng ƒë√£ ch·ªâ ƒë·ªãnh</td></tr><tr><td><code>HDEL</code></td><td>X√≥a tr∆∞·ªùng ƒë√£ ch·ªâ ƒë·ªãnh</td></tr><tr><td><code>HINCRBY</code></td><td>TƒÉng gi√° tr·ªã s·ªë nguy√™n c·ªßa tr∆∞·ªùng ƒë√£ ch·ªâ ƒë·ªãnh</td></tr><tr><td><code>HKEYS</code></td><td>L·∫•y t·∫•t c·∫£ c√°c tr∆∞·ªùng</td></tr></tbody></table><blockquote><p>Xem th√™m c√°c l·ªánh t·∫°i <a href="https://redis.io/commands#hash" target="_blank" rel="noopener noreferrer">T√†i li·ªáu ch√≠nh th·ª©c v·ªÅ c√°c l·ªánh c·ªßa Redis Hash</a></p></blockquote><p>V√≠ d·ª• v·ªÅ c√°c l·ªánh Hash:</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># L∆∞u tr·ªØ m·ªôt gi√° tr·ªã c·ªßa b·∫£ng bƒÉm</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">HSET</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> field</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> value</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># L·∫•y gi√° tr·ªã c·ªßa tr∆∞·ªùng trong b·∫£ng bƒÉm</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">HGET</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> field</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># L∆∞u tr·ªØ nhi·ªÅu c·∫∑p kh√≥a-gi√° tr·ªã trong b·∫£ng bƒÉm</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">HMSET</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> field</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> value</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> [field </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">value...]</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># L·∫•y gi√° tr·ªã c·ªßa nhi·ªÅu tr∆∞·ªùng trong b·∫£ng bƒÉm</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">HMGET</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> field</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> [field </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">...]</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># X√≥a tr∆∞·ªùng trong b·∫£ng bƒÉm</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">HDEL</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> field</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> [field </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">...]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Tr·∫£ v·ªÅ s·ªë l∆∞·ª£ng tr∆∞·ªùng trong b·∫£ng bƒÉm</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">HLEN</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Tr·∫£ v·ªÅ t·∫•t c·∫£ c√°c c·∫∑p kh√≥a-gi√° tr·ªã trong b·∫£ng bƒÉm</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">HGETALL</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># TƒÉng gi√° tr·ªã c·ªßa tr∆∞·ªùng trong b·∫£ng bƒÉm l√™n n</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">HINCRBY</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> field</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> n</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ung-dung-cua-hash" tabindex="-1"><a class="header-anchor" href="#ung-dung-cua-hash"><span>·ª®ng d·ª•ng c·ªßa Hash</span></a></h3><blockquote><p><strong>Hash ph√π h·ª£p ƒë·ªÉ l∆∞u tr·ªØ d·ªØ li·ªáu c√≥ c·∫•u tr√∫c.</strong></p></blockquote><h4 id="cache-ƒëoi-tuong-1" tabindex="-1"><a class="header-anchor" href="#cache-ƒëoi-tuong-1"><span>Cache ƒë·ªëi t∆∞·ª£ng</span></a></h4><p>C·∫•u tr√∫c (key, field, value) c·ªßa Hash gi·ªëng v·ªõi c·∫•u tr√∫c (id ƒë·ªëi t∆∞·ª£ng, thu·ªôc t√≠nh, gi√° tr·ªã) c·ªßa ƒë·ªëi t∆∞·ª£ng, n√™n c≈©ng c√≥ th·ªÉ d√πng ƒë·ªÉ l∆∞u tr·ªØ ƒë·ªëi t∆∞·ª£ng.</p><p>V√≠ d·ª•, v·ªõi th√¥ng tin ng∆∞·ªùi d√πng trong c∆° s·ªü d·ªØ li·ªáu quan h·ªá:</p><p>Ch√∫ng ta c√≥ th·ªÉ s·ª≠ d·ª•ng c√°c l·ªánh sau ƒë·ªÉ l∆∞u tr·ªØ th√¥ng tin ƒë·ªëi t∆∞·ª£ng ng∆∞·ªùi d√πng v√†o Hash:</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># L∆∞u tr·ªØ m·ªôt b·∫£ng bƒÉm v·ªõi id ng∆∞·ªùi d√πng l√† 1</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; HMSET uid:1 name Tom age 15</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">2</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># L∆∞u tr·ªØ m·ªôt b·∫£ng bƒÉm v·ªõi id ng∆∞·ªùi d√πng l√† 2</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; HMSET uid:2 name Jerry age 13</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">2</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># L·∫•y t·∫•t c·∫£ c√°c c·∫∑p kh√≥a-gi√° tr·ªã c·ªßa ng∆∞·ªùi d√πng c√≥ id l√† 1</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; HGETALL uid:1</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;name&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;Tom&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">3</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;age&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">4</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;15&quot;</span></span></code></pre></div><p>C·∫•u tr√∫c l∆∞u tr·ªØ Hash c·ªßa Redis:</p><p>Trong c√°c k·ªãch b·∫£n ·ª©ng d·ª•ng c·ªßa ki·ªÉu String ƒë√£ ƒë∆∞·ª£c gi·ªõi thi·ªáu tr∆∞·ªõc ƒë√≥, vi·ªác s·ª≠ d·ª•ng String + JSON c≈©ng l√† m·ªôt c√°ch ƒë·ªÉ l∆∞u tr·ªØ ƒë·ªëi t∆∞·ª£ng. V·∫≠y khi l∆∞u tr·ªØ ƒë·ªëi t∆∞·ª£ng, n√™n d√πng String + JSON hay Hash?</p><p>Th√¥ng th∆∞·ªùng, ƒë·ªëi t∆∞·ª£ng ƒë∆∞·ª£c l∆∞u tr·ªØ b·∫±ng String + JSON. ƒê·ªëi v·ªõi nh·ªØng thu·ªôc t√≠nh thay ƒë·ªïi th∆∞·ªùng xuy√™n c·ªßa ƒë·ªëi t∆∞·ª£ng, c√≥ th·ªÉ t√°ch ra v√† l∆∞u tr·ªØ b·∫±ng Hash.</p><h4 id="gio-hang" tabindex="-1"><a class="header-anchor" href="#gio-hang"><span>Gi·ªè h√†ng</span></a></h4><p><strong>K·ªãch b·∫£n y√™u c·∫ßu</strong></p><p>Ng∆∞·ªùi d√πng duy·ªát trang web th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠, th√™m s·∫£n ph·∫©m v√†o gi·ªè h√†ng v√† h·ªó tr·ª£ xem gi·ªè h√†ng. C·∫ßn xem x√©t tr∆∞·ªùng h·ª£p ch∆∞a ƒëƒÉng nh·∫≠p.</p><p><strong>Gi·∫£i ph√°p</strong></p><blockquote><p>C√≥ th·ªÉ s·ª≠ d·ª•ng ki·ªÉu HASH ƒë·ªÉ th·ª±c hi·ªán ch·ª©c nƒÉng gi·ªè h√†ng.</p><p>S·ª≠ d·ª•ng session c·ªßa ng∆∞·ªùi d√πng l√†m kh√≥a, l∆∞u tr·ªØ √°nh x·∫° gi·ªØa ID s·∫£n ph·∫©m v√† s·ªë l∆∞·ª£ng s·∫£n ph·∫©m. Trong ƒë√≥, ID s·∫£n ph·∫©m l√† tr∆∞·ªùng, s·ªë l∆∞·ª£ng s·∫£n ph·∫©m l√† gi√° tr·ªã.</p><p>T·∫°i sao kh√¥ng s·ª≠ d·ª•ng ID ng∆∞·ªùi d√πng?</p><p>V√¨ trong nhi·ªÅu tr∆∞·ªùng h·ª£p, c·∫ßn h·ªó tr·ª£ ng∆∞·ªùi d√πng s·ª≠ d·ª•ng gi·ªè h√†ng m√† kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p, do ƒë√≥ kh√¥ng bi·∫øt ID ng∆∞·ªùi d√πng. Trong tr∆∞·ªùng h·ª£p n√†y, vi·ªác s·ª≠ d·ª•ng session c·ªßa ng∆∞·ªùi d√πng ph√π h·ª£p h∆°n. Ngo√†i ra, khi x√≥a session, c√≥ th·ªÉ ti·ªán l·ª£i x√≥a lu√¥n cache gi·ªè h√†ng.</p></blockquote><p>C√°c thao t√°c ph·ªï bi·∫øn ƒë·ªÉ duy tr√¨ gi·ªè h√†ng:</p><ul><li>Th√™m s·∫£n ph·∫©m - <code>HSET cart:{session} {productID} 1</code></li><li>Th√™m s·ªë l∆∞·ª£ng - <code>HINCRBY cart:{session} {productID} 1</code></li><li>T·ªïng s·ªë s·∫£n ph·∫©m - <code>HLEN cart:{session}</code></li><li>X√≥a s·∫£n ph·∫©m - <code>HDEL cart:{session} {productID}</code></li><li>L·∫•y t·∫•t c·∫£ s·∫£n ph·∫©m trong gi·ªè h√†ng - <code>HGETALL cart:{session}</code></li></ul><p>Hi·ªán t·∫°i, ch·ªâ l∆∞u tr·ªØ ID s·∫£n ph·∫©m v√†o Redis, khi hi·ªÉn th·ªã th√¥ng tin chi ti·∫øt c·ªßa s·∫£n ph·∫©m, c·∫ßn truy v·∫•n th√™m c∆° s·ªü d·ªØ li·ªáu ƒë·ªÉ l·∫•y th√¥ng tin ƒë·∫ßy ƒë·ªß c·ªßa s·∫£n ph·∫©m.</p><h2 id="list" tabindex="-1"><a class="header-anchor" href="#list"><span>LIST</span></a></h2><p>Lo·∫°i List trong Redis l√† m·ªôt danh s√°ch c√≥ th·ª© t·ª±.</p><h3 id="gioi-thieu-ve-list" tabindex="-1"><a class="header-anchor" href="#gioi-thieu-ve-list"><span>Gi·ªõi thi·ªáu v·ªÅ List</span></a></h3><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230724122821.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>List l√† m·ªôt danh s√°ch c√°c chu·ªói ƒë∆°n gi·∫£n, <strong>ƒë∆∞·ª£c s·∫Øp x·∫øp theo th·ª© t·ª± ch√®n v√†o</strong>, c√≥ th·ªÉ th√™m ph·∫ßn t·ª≠ v√†o List t·ª´ ƒë·∫ßu ho·∫∑c cu·ªëi.</p><p>List c√≥ ƒë·ªô d√†i t·ªëi ƒëa l√† <code>2^32 - 1</code>, t·ª©c l√† m·ªói List h·ªó tr·ª£ h∆°n <code>4 t·ª∑</code> ph·∫ßn t·ª≠.</p><h3 id="cach-trien-khai-list" tabindex="-1"><a class="header-anchor" href="#cach-trien-khai-list"><span>C√°ch tri·ªÉn khai List</span></a></h3><p>M√£ h√≥a ƒë·ªëi t∆∞·ª£ng List c√≥ th·ªÉ l√† <code>ziplist</code> ho·∫∑c <code>linkedlist</code>.</p><p>List m√£ h√≥a b·∫±ng <code>ziplist</code> s·ª≠ d·ª•ng List n√©n l√†m c∆° s·ªü, m·ªói n√∫t trong List n√©n (entry) l∆∞u tr·ªØ m·ªôt ph·∫ßn t·ª≠ trong List.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624201754.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>List m√£ h√≥a b·∫±ng <code>linkedlist</code> s·ª≠ d·ª•ng List li√™n k·∫øt ƒë√¥i l√†m c∆° s·ªü.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624201852.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>Khi ƒë·ªëi t∆∞·ª£ng List th·ªèa m√£n ƒë·ªìng th·ªùi hai ƒëi·ªÅu ki·ªán sau, ƒë·ªëi t∆∞·ª£ng List s·ª≠ d·ª•ng m√£ h√≥a <code>ziplist</code>; ng∆∞·ª£c l·∫°i, s·ª≠ d·ª•ng m√£ h√≥a <code>linkedlist</code>:</p><ol><li>ƒê·ªô d√†i c·ªßa t·∫•t c·∫£ c√°c chu·ªói trong List nh·ªè h∆°n <code>64</code> byte.</li><li>S·ªë l∆∞·ª£ng ph·∫ßn t·ª≠ trong List nh·ªè h∆°n <code>512</code>.</li></ol><blockquote><p>L∆∞u √Ω:</p><p>Hai gi√° tr·ªã gi·ªõi h·∫°n tr√™n c·ªßa hai ƒëi·ªÅu ki·ªán n√†y c√≥ th·ªÉ ƒë∆∞·ª£c thay ƒë·ªïi, chi ti·∫øt xem trong file c·∫•u h√¨nh v·ªÅ c√°c t√πy ch·ªçn <code>list-max-ziplist-value</code> v√† <code>list-max-ziplist-entries</code>.</p></blockquote><h3 id="lenh-list" tabindex="-1"><a class="header-anchor" href="#lenh-list"><span>L·ªánh List</span></a></h3><table><thead><tr><th>L·ªánh</th><th>H√†nh vi</th></tr></thead><tbody><tr><td><code>LPUSH</code></td><td>Th√™m gi√° tr·ªã v√†o ƒë·∫ßu List.</td></tr><tr><td><code>RPUSH</code></td><td>Th√™m gi√° tr·ªã v√†o cu·ªëi List.</td></tr><tr><td><code>LPOP</code></td><td>X√≥a v√† tr·∫£ v·ªÅ gi√° tr·ªã ƒë·∫ßu ti√™n c·ªßa List.</td></tr><tr><td><code>RPOP</code></td><td>X√≥a v√† tr·∫£ v·ªÅ gi√° tr·ªã cu·ªëi c√πng c·ªßa List.</td></tr><tr><td><code>LRANGE</code></td><td>L·∫•y t·∫•t c·∫£ c√°c gi√° tr·ªã trong kho·∫£ng cho tr∆∞·ªõc.</td></tr><tr><td><code>LINDEX</code></td><td>L·∫•y gi√° tr·ªã t·∫°i v·ªã tr√≠ cho tr∆∞·ªõc trong List.</td></tr><tr><td><code>LREM</code></td><td>X√≥a gi√° tr·ªã ƒë·∫ßu ti√™n trong List.</td></tr><tr><td><code>LTRIM</code></td><td>Ch·ªâ gi·ªØ l·∫°i c√°c ph·∫ßn t·ª≠ trong kho·∫£ng cho tr∆∞·ªõc, x√≥a c√°c ph·∫ßn t·ª≠ kh√°c.</td></tr></tbody></table><blockquote><p>Tham kh·∫£o th√™m c√°c l·ªánh t·∫°i: <a href="https://redis.io/commands#list" target="_blank" rel="noopener noreferrer">T√†i li·ªáu ch√≠nh th·ª©c v·ªÅ l·ªánh List c·ªßa Redis</a></p></blockquote><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Th√™m m·ªôt ho·∫∑c nhi·ªÅu gi√° tr·ªã v√†o ƒë·∫ßu List key</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">LPUSH</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> value</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> [value </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">...]</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Th√™m m·ªôt ho·∫∑c nhi·ªÅu gi√° tr·ªã v√†o cu·ªëi List key</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">RPUSH</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> value</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> [value </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">...]</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># X√≥a v√† tr·∫£ v·ªÅ gi√° tr·ªã ƒë·∫ßu ti√™n c·ªßa List key</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">LPOP</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># X√≥a v√† tr·∫£ v·ªÅ gi√° tr·ªã cu·ªëi c√πng c·ªßa List key</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">RPOP</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Tr·∫£ v·ªÅ c√°c ph·∫ßn t·ª≠ trong List key trong kho·∫£ng start v√† stop, b·∫Øt ƒë·∫ßu t·ª´ 0</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">LRANGE</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> stop</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># X√≥a ph·∫ßn t·ª≠ ƒë·∫ßu ti√™n trong List key, n·∫øu kh√¥ng c√≥ ph·∫ßn t·ª≠ n√†o th√¨ ch·ªù timeout gi√¢y, n·∫øu timeout=0 th√¨ ch·ªù m√£i m√£i</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">BLPOP</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> [key </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">...]</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> timeout</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># X√≥a ph·∫ßn t·ª≠ cu·ªëi c√πng trong List key, n·∫øu kh√¥ng c√≥ ph·∫ßn t·ª≠ n√†o th√¨ ch·ªù timeout gi√¢y, n·∫øu timeout=0 th√¨ ch·ªù m√£i m√£i</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">BRPOP</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> [key </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">...]</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> timeout</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ung-dung-list" tabindex="-1"><a class="header-anchor" href="#ung-dung-list"><span>·ª®ng d·ª•ng List</span></a></h3><h4 id="hang-ƒëoi-tin-nhan" tabindex="-1"><a class="header-anchor" href="#hang-ƒëoi-tin-nhan"><span>H√†ng ƒë·ª£i tin nh·∫Øn</span></a></h4><p>H√†ng ƒë·ª£i tin nh·∫Øn c·∫ßn th·ªèa m√£n ba y√™u c·∫ßu khi l∆∞u tr·ªØ v√† truy xu·∫•t tin nh·∫Øn: <strong>duy tr√¨ th·ª© t·ª± tin nh·∫Øn, x·ª≠ l√Ω tin nh·∫Øn l·∫∑p l·∫°i v√† ƒë·∫£m b·∫£o ƒë·ªô tin c·∫≠y c·ªßa tin nh·∫Øn</strong>.</p><p>Lo·∫°i List v√† Stream trong Redis c√≥ th·ªÉ th·ªèa m√£n ba y√™u c·∫ßu n√†y. Tr∆∞·ªõc ti√™n, ch√∫ng ta s·∫Ω t√¨m hi·ªÉu v·ªÅ c√°ch th·ª±c hi·ªán h√†ng ƒë·ª£i tin nh·∫Øn d·ª±a tr√™n List, sau ƒë√≥ s·∫Ω t√¨m hi·ªÉu v·ªÅ Stream.</p><p><em>1. L√†m th·∫ø n√†o ƒë·ªÉ duy tr√¨ th·ª© t·ª± tin nh·∫Øn?</em></p><p>List t·ª± th√¢n l√† List l∆∞u tr·ªØ d·ªØ li·ªáu theo nguy√™n t·∫Øc v√†o tr∆∞·ªõc ra tr∆∞·ªõc (FIFO), do ƒë√≥, n·∫øu s·ª≠ d·ª•ng List l√†m h√†ng ƒë·ª£i tin nh·∫Øn, s·∫Ω t·ª± nhi√™n th·ªèa m√£n y√™u c·∫ßu n√†y.</p><p>List c√≥ th·ªÉ s·ª≠ d·ª•ng l·ªánh LPUSH + RPOP (ho·∫∑c ng∆∞·ª£c l·∫°i, RPUSH+LPOP) ƒë·ªÉ th·ª±c hi·ªán h√†ng ƒë·ª£i tin nh·∫Øn.</p><ul><li><p>Nh√† s·∫£n xu·∫•t s·ª≠ d·ª•ng l·ªánh <code>LPUSH key value[value...]</code> ƒë·ªÉ ch√®n tin nh·∫Øn v√†o ƒë·∫ßu List, n·∫øu key kh√¥ng t·ªìn t·∫°i, n√≥ s·∫Ω t·∫°o m·ªôt List tr·ªëng tr∆∞·ªõc khi ch√®n tin nh·∫Øn.</p></li><li><p>Ng∆∞·ªùi ti√™u th·ª• s·ª≠ d·ª•ng l·ªánh <code>RPOP key</code> ƒë·ªÉ l·∫ßn l∆∞·ª£t ƒë·ªçc tin nh·∫Øn t·ª´ List, theo th·ª© t·ª± v√†o tr∆∞·ªõc ra tr∆∞·ªõc.</p></li></ul><p>Tuy nhi√™n, khi ng∆∞·ªùi ti√™u th·ª• ƒë·ªçc d·ªØ li·ªáu, c√≥ m·ªôt nguy c∆° ti·ªÅm ·∫©n v·ªÅ hi·ªáu su·∫•t.</p><p>Khi nh√† s·∫£n xu·∫•t ch√®n d·ªØ li·ªáu v√†o List, List s·∫Ω kh√¥ng t·ª± ƒë·ªông th√¥ng b√°o cho ng∆∞·ªùi ti√™u th·ª• r·∫±ng c√≥ tin nh·∫Øn m·ªõi, n·∫øu ng∆∞·ªùi ti√™u th·ª• mu·ªën x·ª≠ l√Ω tin nh·∫Øn k·ªãp th·ªùi, h·ªç c·∫ßn ph·∫£i li√™n t·ª•c g·ªçi l·ªánh <code>RPOP</code> (v√≠ d·ª• s·ª≠ d·ª•ng v√≤ng l·∫∑p while(1)). N·∫øu c√≥ tin nh·∫Øn m·ªõi, l·ªánh RPOP s·∫Ω tr·∫£ v·ªÅ k·∫øt qu·∫£, ng∆∞·ª£c l·∫°i, l·ªánh RPOP s·∫Ω tr·∫£ v·ªÅ gi√° tr·ªã tr·ªëng v√† ti·∫øp t·ª•c v√≤ng l·∫∑p.</p><p>V√¨ v·∫≠y, ngay c·∫£ khi kh√¥ng c√≥ tin nh·∫Øn m·ªõi ch√®n v√†o List, ng∆∞·ªùi ti√™u th·ª• c≈©ng ph·∫£i li√™n t·ª•c g·ªçi l·ªánh RPOP, d·∫´n ƒë·∫øn vi·ªác ti√™u th·ª• CPU kh√¥ng c·∫ßn thi·∫øt.</p><p>ƒê·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ n√†y, Redis cung c·∫•p l·ªánh BRPOP. <strong>L·ªánh BRPOP c√≤n g·ªçi l√† ƒë·ªçc ch·∫∑n, khi kh√¥ng ƒë·ªçc ƒë∆∞·ª£c d·ªØ li·ªáu t·ª´ List, kh√°ch h√†ng s·∫Ω t·ª± ƒë·ªông ch·∫∑n, ƒë·ª£i ƒë·∫øn khi c√≥ d·ªØ li·ªáu m·ªõi ch√®n v√†o List, sau ƒë√≥ m·ªõi b·∫Øt ƒë·∫ßu ƒë·ªçc d·ªØ li·ªáu</strong>. So v·ªõi vi·ªác ch∆∞∆°ng tr√¨nh ng∆∞·ªùi ti√™u th·ª• t·ª± m√¨nh li√™n t·ª•c g·ªçi l·ªánh RPOP, c√°ch n√†y gi√∫p ti·∫øt ki·ªám t√†i nguy√™n CPU.</p><p><em>2. L√†m th·∫ø n√†o ƒë·ªÉ x·ª≠ l√Ω tin nh·∫Øn l·∫∑p l·∫°i?</em></p><p>Ng∆∞·ªùi ti√™u th·ª• c·∫ßn th·ª±c hi·ªán x√°c ƒë·ªãnh tin nh·∫Øn l·∫∑p l·∫°i t·ª´ hai kh√≠a c·∫°nh:</p><ul><li>M·ªói tin nh·∫Øn c·∫ßn c√≥ m·ªôt ID duy nh·∫•t to√†n c·ª•c.</li><li>Ng∆∞·ªùi ti√™u th·ª• c·∫ßn ghi l·∫°i c√°c ID tin nh·∫Øn ƒë√£ ƒë∆∞·ª£c x·ª≠ l√Ω. Khi nh·∫≠n ƒë∆∞·ª£c m·ªôt tin nh·∫Øn, ch∆∞∆°ng tr√¨nh ng∆∞·ªùi ti√™u th·ª• c√≥ th·ªÉ so s√°nh ID tin nh·∫Øn nh·∫≠n ƒë∆∞·ª£c v·ªõi ID tin nh·∫Øn ƒë√£ ƒë∆∞·ª£c x·ª≠ l√Ω ƒë·ªÉ x√°c ƒë·ªãnh li·ªáu tin nh·∫Øn hi·ªán t·∫°i ƒë√£ ƒë∆∞·ª£c x·ª≠ l√Ω ch∆∞a. N·∫øu ƒë√£ ƒë∆∞·ª£c x·ª≠ l√Ω, ch∆∞∆°ng tr√¨nh ng∆∞·ªùi ti√™u th·ª• s·∫Ω kh√¥ng x·ª≠ l√Ω l·∫°i.</li></ul><p>Nh∆∞ng <strong>List kh√¥ng t·ª± ƒë·ªông t·∫°o ID cho m·ªói tin nh·∫Øn</strong>, v√¨ v·∫≠y ch√∫ng ta c·∫ßn t·ª± t·∫°o m·ªôt ID duy nh·∫•t to√†n c·ª•c cho m·ªói tin nh·∫Øn, sau ƒë√≥ khi s·ª≠ d·ª•ng l·ªánh LPUSH ƒë·ªÉ ch√®n tin nh·∫Øn v√†o List, ch√∫ng ta c·∫ßn bao g·ªìm ID duy nh·∫•t n√†y trong tin nh·∫Øn.</p><p>V√≠ d·ª•, ch√∫ng ta c√≥ th·ªÉ th·ª±c hi·ªán l·ªánh sau ƒë·ªÉ ch√®n m·ªôt tin nh·∫Øn v·ªõi ID duy nh·∫•t to√†n c·ª•c l√† 111000102 v√† s·ªë l∆∞·ª£ng kho l√† 99 v√†o h√†ng ƒë·ª£i tin nh·∫Øn:</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; LPUSH mq </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;111000102:stock:99&quot;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span></span></code></pre></div><p><em>3. L√†m th·∫ø n√†o ƒë·ªÉ ƒë·∫£m b·∫£o ƒë·ªô tin c·∫≠y c·ªßa tin nh·∫Øn?</em></p><p>Khi ch∆∞∆°ng tr√¨nh ng∆∞·ªùi ti√™u th·ª• ƒë·ªçc m·ªôt tin nh·∫Øn t·ª´ List, tin nh·∫Øn s·∫Ω kh√¥ng c√≤n l∆∞u tr·ªØ trong List. V√¨ v·∫≠y, n·∫øu ch∆∞∆°ng tr√¨nh ng∆∞·ªùi ti√™u th·ª• g·∫∑p s·ª± c·ªë ho·∫∑c t·∫Øt m√°y trong qu√° tr√¨nh x·ª≠ l√Ω tin nh·∫Øn, tin nh·∫Øn s·∫Ω kh√¥ng ƒë∆∞·ª£c x·ª≠ l√Ω xong v√† ch∆∞∆°ng tr√¨nh ng∆∞·ªùi ti√™u th·ª• kh·ªüi ƒë·ªông l·∫°i s·∫Ω kh√¥ng th·ªÉ ƒë·ªçc l·∫°i tin nh·∫Øn t·ª´ List.</p><p>ƒê·ªÉ l∆∞u tr·ªØ tin nh·∫Øn, List cung c·∫•p l·ªánh <code>BRPOPLPUSH</code>. <strong>L·ªánh n√†y cho ph√©p ch∆∞∆°ng tr√¨nh ng∆∞·ªùi ti√™u th·ª• ƒë·ªçc tin nh·∫Øn t·ª´ m·ªôt List, ƒë·ªìng th·ªùi Redis s·∫Ω ch√®n tin nh·∫Øn ƒë√≥ v√†o m·ªôt List kh√°c (c√≥ th·ªÉ g·ªçi l√† List sao l∆∞u) ƒë·ªÉ l∆∞u tr·ªØ</strong>.</p><p>Nh·ªù v·∫≠y, n·∫øu ch∆∞∆°ng tr√¨nh ng∆∞·ªùi ti√™u th·ª• ƒë·ªçc tin nh·∫Øn nh∆∞ng kh√¥ng x·ª≠ l√Ω th√†nh c√¥ng, khi kh·ªüi ƒë·ªông l·∫°i, n√≥ c√≥ th·ªÉ ƒë·ªçc l·∫°i tin nh·∫Øn t·ª´ List sao l∆∞u v√† ti·∫øp t·ª•c x·ª≠ l√Ω.</p><p>Nh∆∞ v·∫≠y, ch√∫ng ta c√≥ th·ªÉ th·∫•y r·∫±ng d·ª±a tr√™n List, h√†ng ƒë·ª£i tin nh·∫Øn c√≥ th·ªÉ ƒë√°p ·ª©ng ba y√™u c·∫ßu ch√≠nh (duy tr√¨ th·ª© t·ª± tin nh·∫Øn, x·ª≠ l√Ω tin nh·∫Øn l·∫∑p l·∫°i v√† ƒë·∫£m b·∫£o ƒë·ªô tin c·∫≠y c·ªßa tin nh·∫Øn).</p><ul><li>Duy tr√¨ th·ª© t·ª± tin nh·∫Øn: s·ª≠ d·ª•ng LPUSH + RPOP.</li><li>Ch·∫∑n ƒë·ªçc: s·ª≠ d·ª•ng BRPOP.</li><li>X·ª≠ l√Ω tin nh·∫Øn tr√πng l·∫∑p: nh√† s·∫£n xu·∫•t t·ª± tri·ªÉn khai m·ªôt ID duy nh·∫•t tr√™n to√†n c·∫ßu.</li><li>ƒê·ªô tin c·∫≠y c·ªßa tin nh·∫Øn: S·ª≠ d·ª•ng BRPOPLPUSH</li></ul><blockquote><p>H·∫°n ch·∫ø c·ªßa List d∆∞·ªõi d·∫°ng h√†ng ƒë·ª£i tin nh·∫Øn l√† g√¨?</p></blockquote><p>List kh√¥ng h·ªó tr·ª£ nhi·ªÅu ng∆∞·ªùi ti√™u th·ª• s·ª≠ d·ª•ng c√πng m·ªôt tin nh·∫Øn**¬†, v√¨ khi m·ªôt ng∆∞·ªùi ti√™u th·ª• l·∫•y m·ªôt tin nh·∫Øn, tin nh·∫Øn s·∫Ω b·ªã x√≥a kh·ªèi Danh s√°ch v√† nh·ªØng ng∆∞·ªùi ti√™u th·ª• kh√°c kh√¥ng th·ªÉ s·ª≠ d·ª•ng l·∫°i.</p><p>ƒê·ªÉ nh·∫≠n ra r·∫±ng m·ªôt tin nh·∫Øn c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng b·ªüi nhi·ªÅu ng∆∞·ªùi ti√™u th·ª•, nhi·ªÅu ng∆∞·ªùi ti√™u th·ª• ph·∫£i ƒë∆∞·ª£c h·ª£p th√†nh m·ªôt nh√≥m ng∆∞·ªùi ti√™u th·ª• ƒë·ªÉ nhi·ªÅu ng∆∞·ªùi ti√™u th·ª• c√≥ th·ªÉ s·ª≠ d·ª•ng c√πng m·ªôt th√¥ng b√°o. Tuy nhi√™n,¬†<strong>lo·∫°i List kh√¥ng h·ªó tr·ª£ vi·ªác tri·ªÉn khai c√°c nh√≥m ng∆∞·ªùi ti√™u th·ª•</strong>.</p><p>ƒê√¢y l√† v·ªÅ ki·ªÉu d·ªØ li·ªáu Stream do Redis cung c·∫•p b·∫Øt ƒë·∫ßu t·ª´ phi√™n b·∫£n 5.0. Stream c≈©ng c√≥ th·ªÉ ƒë√°p ·ª©ng ba y√™u c·∫ßu ch√≠nh c·ªßa h√†ng ƒë·ª£i tin nh·∫Øn v√† n√≥ c≈©ng h·ªó tr·ª£ ƒë·ªçc tin nh·∫Øn d∆∞·ªõi d·∫°ng &quot;nh√≥m ng∆∞·ªùi ti√™u th·ª•&quot;.</p><h4 id="tu-ƒëong-nhap-du-lieu" tabindex="-1"><a class="header-anchor" href="#tu-ƒëong-nhap-du-lieu"><span>T·ª± ƒë·ªông nh·∫≠p d·ªØ li·ªáu</span></a></h4><p>„ÄêK·ªãch b·∫£n nhu c·∫ßu„Äë</p><p>D·ª±a v√†o th√¥ng tin nh·∫≠p t·ª´ ng∆∞·ªùi d√πng, t·ª± ƒë·ªông ho√†n th√†nh th√¥ng tin, nh∆∞: danh s√°ch li√™n l·∫°c, t√™n h√†ng h√≥a,...</p><ul><li>T√¨nh hu·ªëng ƒëi·ªÉn h√¨nh 1 - Backend website m·∫°ng x√£ h·ªôi ghi l·∫°i 100 ng∆∞·ªùi b·∫°n m√† ng∆∞·ªùi d√πng ƒë√£ li√™n h·ªá g·∫ßn ƒë√¢y. Khi ng∆∞·ªùi d√πng t√¨m ki·∫øm b·∫°n b√®, t√™n s·∫Ω t·ª± ƒë·ªông ƒë∆∞·ª£c ƒëi·ªÅn d·ª±a tr√™n t·ª´ kh√≥a ƒë√£ nh·∫≠p.</li><li>T√¨nh hu·ªëng ƒëi·ªÉn h√¨nh 2 - Ph·∫ßn backend c·ªßa website th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠ ghi l·∫°i 10 s·∫£n ph·∫©m m√† ng∆∞·ªùi d√πng ƒë√£ xem g·∫ßn ƒë√¢y. Khi ng∆∞·ªùi d√πng t√¨m ki·∫øm m·ªôt s·∫£n ph·∫©m, t√™n s·∫£n ph·∫©m s·∫Ω t·ª± ƒë·ªông ƒë∆∞·ª£c ƒëi·ªÅn d·ª±a tr√™n t·ª´ kh√≥a ƒë√£ nh·∫≠p.</li></ul><p>„ÄêGi·∫£i ph√°p„Äë</p><blockquote><p>S·ª≠ d·ª•ng ki·ªÉu List c·ªßa Redis ƒë·ªÉ l∆∞u tr·ªØ danh s√°ch th√¥ng tin g·∫ßn ƒë√¢y, sau ƒë√≥ t·∫°i th·ªùi ƒëi·ªÉm c·∫ßn t·ª± ƒë·ªông ho√†n th√†nh th√¥ng tin, hi·ªÉn th·ªã s·ªë l∆∞·ª£ng d·ªØ li·ªáu t∆∞∆°ng ·ª©ng.</p></blockquote><p>C√°c thao t√°c ph·ªï bi·∫øn ƒë·ªÉ duy tr√¨ danh s√°ch c√°c tin nh·∫Øn g·∫ßn ƒë√¢y nh∆∞ sau:</p><ul><li>N·∫øu tin nh·∫Øn ƒë∆∞·ª£c ch·ªâ ƒë·ªãnh ƒë√£ t·ªìn t·∫°i trong danh s√°ch tin nh·∫Øn g·∫ßn ƒë√¢y th√¨ n√≥ s·∫Ω b·ªã x√≥a kh·ªèi danh s√°ch. S·ª≠ d·ª•ng¬†<code>LREM</code>l·ªánh.</li><li>Th√™m tin nh·∫Øn ƒë∆∞·ª£c ch·ªâ ƒë·ªãnh v√†o ƒë·∫ßu danh s√°ch tin nh·∫Øn g·∫ßn ƒë√¢y. S·ª≠ d·ª•ng¬†<code>LPUSH</code>l·ªánh.</li><li>Sau khi thao t√°c th√™m ho√†n t·∫•t, n·∫øu s·ªë trong danh s√°ch th√¥ng tin g·∫ßn ƒë√¢y v∆∞·ª£t qu√° gi·ªõi h·∫°n tr√™n N th√¨ thao t√°c c·∫Øt b·ªõt s·∫Ω ƒë∆∞·ª£c th·ª±c hi·ªán. S·ª≠ d·ª•ng¬†<code>LTRIM</code>l·ªánh.</li></ul><h2 id="set" tabindex="-1"><a class="header-anchor" href="#set"><span>SET</span></a></h2><p>Lo·∫°i Set trong Redis l√† m·ªôt t·∫≠p h·ª£p kh√¥ng c√≥ th·ª© t·ª± v√† lo·∫°i b·ªè tr√πng l·∫∑p.</p><h3 id="gioi-thieu-ve-set" tabindex="-1"><a class="header-anchor" href="#gioi-thieu-ve-set"><span>Gi·ªõi thi·ªáu v·ªÅ Set</span></a></h3><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230724122943.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>Set trong Redis l√† m·ªôt t·∫≠p h·ª£p c√°c c·∫∑p key - value kh√¥ng c√≥ th·ª© t·ª± v√† c√°c gi√° tr·ªã l√† duy nh·∫•t, t·ª©c l√† m·ªói gi√° tr·ªã trong Set l√† duy nh·∫•t v√† kh√¥ng th·ª© t·ª± v·ªÅ th·ªùi gian.</p><p>M·ªôt Set c√≥ th·ªÉ l∆∞u tr·ªØ t·ªëi ƒëa <code>2^32-1</code> ph·∫ßn t·ª≠. Set trong Redis gi·ªëng nh∆∞ t·∫≠p h·ª£p trong to√°n h·ªçc, cho ph√©p th·ª±c hi·ªán c√°c ph√©p to√°n nh∆∞ giao, h·ª£p, hi·ªáu, v√† c√°c ho·∫°t ƒë·ªông kh√°c tr√™n c√°c t·∫≠p h·ª£p. V√¨ v·∫≠y, Set kh√¥ng ch·ªâ h·ªó tr·ª£ th√™m, x√≥a, s·ª≠a v√† truy v·∫•n c√°c ph·∫ßn t·ª≠ trong t·∫≠p h·ª£p m√† c√≤n h·ªó tr·ª£ c√°c ph√©p to√°n v·ªõi nhi·ªÅu t·∫≠p h·ª£p nh∆∞ giao, h·ª£p, hi·ªáu.</p><p>S·ª± kh√°c bi·ªát gi·ªØa Set v√† List trong Redis nh∆∞ sau:</p><ul><li>List c√≥ th·ªÉ l∆∞u tr·ªØ c√°c ph·∫ßn t·ª≠ tr√πng l·∫∑p, trong khi Set ch·ªâ c√≥ th·ªÉ l∆∞u tr·ªØ c√°c ph·∫ßn t·ª≠ duy nh·∫•t.</li><li>List l∆∞u tr·ªØ c√°c ph·∫ßn t·ª≠ theo th·ª© t·ª± ch√®n, trong khi Set l∆∞u tr·ªØ c√°c ph·∫ßn t·ª≠ m√† kh√¥ng c√≥ th·ª© t·ª± nh·∫•t ƒë·ªãnh.</li></ul><p>Set trong Redis l√† m·ªôt c·∫•u tr√∫c d·ªØ li·ªáu m·∫°nh m·∫Ω ƒë·ªÉ l∆∞u tr·ªØ v√† x·ª≠ l√Ω c√°c t·∫≠p h·ª£p c√°c ph·∫ßn t·ª≠ ƒë·ªôc l·∫≠p m·ªôt c√°ch hi·ªáu qu·∫£.</p><h3 id="trien-khai-set" tabindex="-1"><a class="header-anchor" href="#trien-khai-set"><span>Tri·ªÉn khai Set</span></a></h3><p>C√°c ƒë·ªëi t∆∞·ª£ng Set trong Redis c√≥ th·ªÉ ƒë∆∞·ª£c m√£ h√≥a d∆∞·ªõi hai d·∫°ng: <code>intset</code> ho·∫∑c <code>hashtable</code>.</p><h4 id="ma-hoa-intset" tabindex="-1"><a class="header-anchor" href="#ma-hoa-intset"><span>M√£ h√≥a <code>intset</code></span></a></h4><p>Set ƒë∆∞·ª£c m√£ h√≥a b·∫±ng <code>intset</code> s·ª≠ d·ª•ng m·ªôt t·∫≠p h·ª£p s·ªë nguy√™n l√†m c·∫•u tr√∫c d·ªØ li·ªáu c∆° s·ªü. T·∫•t c·∫£ c√°c ph·∫ßn t·ª≠ trong Set ƒë∆∞·ª£c l∆∞u tr·ªØ trong t·∫≠p h·ª£p s·ªë nguy√™n n√†y.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624203635.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><h4 id="ma-hoa-hashtable" tabindex="-1"><a class="header-anchor" href="#ma-hoa-hashtable"><span>M√£ h√≥a <code>hashtable</code></span></a></h4><p>Set ƒë∆∞·ª£c m√£ h√≥a b·∫±ng <code>hashtable</code> s·ª≠ d·ª•ng m·ªôt t·ª´ ƒëi·ªÉn l√†m c·∫•u tr√∫c d·ªØ li·ªáu c∆° s·ªü. M·ªói kh√≥a c·ªßa t·ª´ ƒëi·ªÉn l√† m·ªôt ƒë·ªëi t∆∞·ª£ng chu·ªói, m·ªói ƒë·ªëi t∆∞·ª£ng chu·ªói n√†y ch·ª©a m·ªôt ph·∫ßn t·ª≠ c·ªßa Set v√† c√°c gi√° tr·ªã c·ªßa t·ª´ ƒëi·ªÉn ƒë∆∞·ª£c ƒë·∫∑t l√† <code>NULL</code>.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624203650.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><h4 id="ƒëieu-kien-su-dung-intset-hoac-hashtable" tabindex="-1"><a class="header-anchor" href="#ƒëieu-kien-su-dung-intset-hoac-hashtable"><span>ƒêi·ªÅu ki·ªán s·ª≠ d·ª•ng <code>intset</code> ho·∫∑c <code>hashtable</code></span></a></h4><p>Set s·∫Ω s·ª≠ d·ª•ng m√£ h√≥a <code>intset</code> khi ƒë√°p ·ª©ng c√πng l√∫c hai ƒëi·ªÅu ki·ªán sau; n·∫øu kh√¥ng, n√≥ s·∫Ω s·ª≠ d·ª•ng m√£ h√≥a <code>hashtable</code>:</p><ol><li>T·∫•t c·∫£ c√°c ph·∫ßn t·ª≠ trong Set l√† gi√° tr·ªã s·ªë nguy√™n.</li><li>S·ªë l∆∞·ª£ng ph·∫ßn t·ª≠ trong Set kh√¥ng v∆∞·ª£t qu√° <code>512</code>.</li></ol><blockquote><p>L∆∞u √Ω: Gi√° tr·ªã tr·∫ßn c·ªßa ƒëi·ªÅu ki·ªán th·ª© hai c√≥ th·ªÉ ƒë∆∞·ª£c thay ƒë·ªïi. Xem th√™m th√¥ng tin trong t√†i li·ªáu c·∫•u h√¨nh v·ªÅ t√πy ch·ªçn <code>set-max-intset-entries</code>.</p></blockquote><p>M√£ h√≥a <code>intset</code> v√† <code>hashtable</code> cung c·∫•p cho Redis s·ª± linh ho·∫°t trong vi·ªác l∆∞u tr·ªØ v√† qu·∫£n l√Ω c√°c t·∫≠p h·ª£p d·ªØ li·ªáu, t·ªëi ∆∞u h√≥a hi·ªáu su·∫•t d·ª±a tr√™n c√°c ƒë·∫∑c t√≠nh c·ªßa d·ªØ li·ªáu trong Set.</p><h3 id="cac-lenh-set" tabindex="-1"><a class="header-anchor" href="#cac-lenh-set"><span>C√°c l·ªánh Set</span></a></h3><p>Redis Set h·ªó tr·ª£ nhi·ªÅu l·ªánh ƒë·ªÉ thao t√°c v√† th·ª±c hi·ªán c√°c ph√©p to√°n tr√™n t·∫≠p h·ª£p. D∆∞·ªõi ƒë√¢y l√† m·ªôt s·ªë l·ªánh ph·ªï bi·∫øn:</p><table><thead><tr><th>L·ªánh</th><th>H√†nh vi</th></tr></thead><tbody><tr><td><code>SADD</code></td><td>Th√™m m·ªôt ho·∫∑c nhi·ªÅu th√†nh vi√™n v√†o t·∫≠p h·ª£p.</td></tr><tr><td><code>SMEMBERS</code></td><td>Tr·∫£ v·ªÅ t·∫•t c·∫£ c√°c th√†nh vi√™n c·ªßa t·∫≠p h·ª£p.</td></tr><tr><td><code>SISMEMBER</code></td><td>Ki·ªÉm tra xem m·ªôt th√†nh vi√™n c√≥ t·ªìn t·∫°i trong t·∫≠p h·ª£p hay kh√¥ng.</td></tr><tr><td><code>SREM</code></td><td>Xo√° m·ªôt ho·∫∑c nhi·ªÅu th√†nh vi√™n kh·ªèi t·∫≠p h·ª£p.</td></tr><tr><td><code>SCARD</code></td><td>L·∫•y s·ªë l∆∞·ª£ng th√†nh vi√™n trong t·∫≠p h·ª£p.</td></tr><tr><td><code>SRANDMEMBER</code></td><td>L·∫•y m·ªôt ho·∫∑c nhi·ªÅu th√†nh vi√™n ng·∫´u nhi√™n t·ª´ t·∫≠p h·ª£p.</td></tr><tr><td><code>SPOP</code></td><td>Xo√° v√† tr·∫£ v·ªÅ m·ªôt ho·∫∑c nhi·ªÅu th√†nh vi√™n ng·∫´u nhi√™n t·ª´ t·∫≠p h·ª£p.</td></tr></tbody></table><table><thead><tr><th>L·ªánh</th><th>H√†nh vi</th></tr></thead><tbody><tr><td><code>SINTER</code></td><td>T√≠nh giao c·ªßa nhi·ªÅu t·∫≠p h·ª£p.</td></tr><tr><td><code>SINTERSTORE</code></td><td>T√≠nh giao c·ªßa nhi·ªÅu t·∫≠p h·ª£p v√† l∆∞u k·∫øt qu·∫£ v√†o m·ªôt t·∫≠p h·ª£p m·ªõi.</td></tr><tr><td><code>SUNION</code></td><td>T√≠nh h·ª£p c·ªßa nhi·ªÅu t·∫≠p h·ª£p.</td></tr><tr><td><code>SUNIONSTORE</code></td><td>T√≠nh h·ª£p c·ªßa nhi·ªÅu t·∫≠p h·ª£p v√† l∆∞u k·∫øt qu·∫£ v√†o m·ªôt t·∫≠p h·ª£p m·ªõi.</td></tr><tr><td><code>SDIFF</code></td><td>T√≠nh hi·ªáu c·ªßa hai t·∫≠p h·ª£p.</td></tr><tr><td><code>SDIFFSTORE</code></td><td>T√≠nh hi·ªáu c·ªßa hai t·∫≠p h·ª£p v√† l∆∞u k·∫øt qu·∫£ v√†o m·ªôt t·∫≠p h·ª£p m·ªõi.</td></tr></tbody></table><p>ƒê·ªÉ bi·∫øt th√™m chi ti·∫øt v√† c√°c l·ªánh kh√°c, b·∫°n c√≥ th·ªÉ tham kh·∫£o <a href="https://redis.io/commands#set" target="_blank" rel="noopener noreferrer">t√†i li·ªáu l·ªánh Set c·ªßa Redis</a>.</p><h4 id="cac-thao-tac-pho-bien-tren-set" tabindex="-1"><a class="header-anchor" href="#cac-thao-tac-pho-bien-tren-set"><span>C√°c Thao T√°c Ph·ªï Bi·∫øn tr√™n Set:</span></a></h4><h5 id="them-va-xoa-thanh-vien" tabindex="-1"><a class="header-anchor" href="#them-va-xoa-thanh-vien"><span>Th√™m v√† Xo√° Th√†nh Vi√™n:</span></a></h5><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Th√™m c√°c th√†nh vi√™n v√†o m·ªôt t·∫≠p h·ª£p</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SADD</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> member</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> [member </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">...]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Xo√° c√°c th√†nh vi√™n kh·ªèi m·ªôt t·∫≠p h·ª£p</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SREM</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> member</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> [member </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">...]</span></span></code></pre></div><h5 id="lay-thanh-vien" tabindex="-1"><a class="header-anchor" href="#lay-thanh-vien"><span>L·∫•y Th√†nh Vi√™n:</span></a></h5><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># L·∫•y t·∫•t c·∫£ c√°c th√†nh vi√™n c·ªßa m·ªôt t·∫≠p h·ª£p</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SMEMBERS</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Ki·ªÉm tra xem m·ªôt th√†nh vi√™n c√≥ t·ªìn t·∫°i trong t·∫≠p h·ª£p hay kh√¥ng</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SISMEMBER</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> member</span></span></code></pre></div><h5 id="ƒëem-so-luong-thanh-vien" tabindex="-1"><a class="header-anchor" href="#ƒëem-so-luong-thanh-vien"><span>ƒê·∫øm S·ªë L∆∞·ª£ng Th√†nh Vi√™n:</span></a></h5><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># L·∫•y s·ªë l∆∞·ª£ng th√†nh vi√™n trong m·ªôt t·∫≠p h·ª£p</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SCARD</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span></span></code></pre></div><h5 id="thao-tac-ngau-nhien-tren-tap-hop" tabindex="-1"><a class="header-anchor" href="#thao-tac-ngau-nhien-tren-tap-hop"><span>Thao T√°c Ng·∫´u Nhi√™n tr√™n T·∫≠p H·ª£p:</span></a></h5><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># L·∫•y m·ªôt ho·∫∑c nhi·ªÅu th√†nh vi√™n ng·∫´u nhi√™n t·ª´ t·∫≠p h·ª£p (kh√¥ng xo√° ch√∫ng)</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SRANDMEMBER</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> [count]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Xo√° v√† l·∫•y m·ªôt ho·∫∑c nhi·ªÅu th√†nh vi√™n ng·∫´u nhi√™n t·ª´ t·∫≠p h·ª£p</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SPOP</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> [count]</span></span></code></pre></div><h5 id="cac-phep-toan-tren-tap-hop-giao-hop-hieu" tabindex="-1"><a class="header-anchor" href="#cac-phep-toan-tren-tap-hop-giao-hop-hieu"><span>C√°c Ph√©p To√°n tr√™n T·∫≠p H·ª£p (Giao, H·ª£p, Hi·ªáu):</span></a></h5><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># T√≠nh giao c·ªßa nhi·ªÅu t·∫≠p h·ª£p</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SINTER</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> [key </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">...]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># T√≠nh giao c·ªßa nhi·ªÅu t·∫≠p h·ª£p v√† l∆∞u k·∫øt qu·∫£ v√†o m·ªôt t·∫≠p h·ª£p m·ªõi</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SINTERSTORE</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> destination</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> [key </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">...]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># T√≠nh h·ª£p c·ªßa nhi·ªÅu t·∫≠p h·ª£p</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SUNION</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> [key </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">...]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># T√≠nh h·ª£p c·ªßa nhi·ªÅu t·∫≠p h·ª£p v√† l∆∞u k·∫øt qu·∫£ v√†o m·ªôt t·∫≠p h·ª£p m·ªõi</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SUNIONSTORE</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> destination</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> [key </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">...]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># T√≠nh hi·ªáu c·ªßa hai t·∫≠p h·ª£p</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SDIFF</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> [key </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">...]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># T√≠nh hi·ªáu c·ªßa hai t·∫≠p h·ª£p v√† l∆∞u k·∫øt qu·∫£ v√†o m·ªôt t·∫≠p h·ª£p m·ªõi</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SDIFFSTORE</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> destination</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> [key </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">...]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ung-dung-set" tabindex="-1"><a class="header-anchor" href="#ung-dung-set"><span>·ª®ng d·ª•ng Set</span></a></h3><p>Set trong Redis c√≥ c√°c ƒë·∫∑c t√≠nh ch√≠nh l√† kh√¥ng c√≥ th·ª© t·ª±, duy nh·∫•t v√† h·ªó tr·ª£ c√°c ph√©p to√°n nh∆∞ giao, h·ª£p, hi·ªáu, ...</p><p>Do ƒë√≥, Set r·∫•t ph√π h·ª£p ƒë·ªÉ lo·∫°i b·ªè d·ªØ li·ªáu tr√πng l·∫∑p v√† ƒë·∫£m b·∫£o t√≠nh duy nh·∫•t c·ªßa d·ªØ li·ªáu. Ngo√†i ra, n√≥ c≈©ng c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ th·ªëng k√™ c√°c ph√©p giao, h·ª£p v√† hi·ªáu c·ªßa nhi·ªÅu t·∫≠p h·ª£p. Khi l∆∞u tr·ªØ d·ªØ li·ªáu kh√¥ng c√≥ th·ª© t·ª± v√† c·∫ßn lo·∫°i b·ªè c√°c gi√° tr·ªã tr√πng l·∫∑p, Set l√† l·ª±a ch·ªçn l√Ω t∆∞·ªüng.</p><p>Tuy nhi√™n, t√¥i mu·ªën nh·∫Øc b·∫°n r·∫±ng c√≥ m·ªôt nguy c∆° ti·ªÅm ·∫©n ·ªü ƒë√¢y. <strong>Vi·ªác t√≠nh to√°n c√°c ph√©p hi·ªáu, giao v√† h·ª£p c·ªßa Set c√≥ ƒë·ªô ph·ª©c t·∫°p cao. Trong tr∆∞·ªùng h·ª£p d·ªØ li·ªáu l·ªõn, vi·ªác th·ª±c hi·ªán c√°c ph√©p to√°n n√†y tr·ª±c ti·∫øp c√≥ th·ªÉ d·∫´n ƒë·∫øn Redis b·ªã ch·∫∑n</strong>.</p><p>Trong m·ªôt c·ª•m sao l∆∞u ch√≠nh, ƒë·ªÉ tr√°nh vi·ªác m√°y ch·ªß ch√≠nh b·ªã ch·∫∑n do th·ª±c hi·ªán c√°c ph√©p to√°n t·ªïng h·ª£p (giao, hi·ªáu, h·ª£p) tr√™n Set, ch√∫ng ta c√≥ th·ªÉ ch·ªçn m·ªôt m√°y ch·ªß sao l∆∞u ƒë·ªÉ ho√†n th√†nh c√°c th·ªëng k√™ t·ªïng h·ª£p, ho·∫∑c tr·∫£ d·ªØ li·ªáu v·ªÅ cho kh√°ch h√†ng ƒë·ªÉ h·ªç th·ª±c hi·ªán c√°c th·ªëng k√™ t·ªïng h·ª£p.</p><h4 id="luot-thich-ƒëanh-gia-tich-cuc" tabindex="-1"><a class="header-anchor" href="#luot-thich-ƒëanh-gia-tich-cuc"><span>L∆∞·ª£t th√≠ch (ƒê√°nh gi√° t√≠ch c·ª±c)</span></a></h4><p>Set trong Redis cho ph√©p ƒë·∫£m b·∫£o r·∫±ng m·ªói ng∆∞·ªùi d√πng ch·ªâ c√≥ th·ªÉ th·ª±c hi·ªán m·ªôt l·∫ßn ƒë√°nh gi√° t√≠ch c·ª±c cho m·ªôt m·ª•c, v√≠ d·ª• nh∆∞ m·ªôt b√†i vi·∫øt. Trong v√≠ d·ª• sau, key l√† id c·ªßa b√†i vi·∫øt v√† value l√† id c·ªßa ng∆∞·ªùi d√πng.</p><p>Ba ng∆∞·ªùi d√πng <code>uid:1</code>, <code>uid:2</code>, <code>uid:3</code> ƒë√£ th·ª±c hi·ªán ƒë√°nh gi√° t√≠ch c·ª±c cho b√†i vi·∫øt <code>article:1</code>.</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Ng∆∞·ªùi d√πng uid:1 ƒë√°nh gi√° t√≠ch c·ª±c cho b√†i vi·∫øt article:1</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; SADD article:1 uid:1</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Ng∆∞·ªùi d√πng uid:2 ƒë√°nh gi√° t√≠ch c·ª±c cho b√†i vi·∫øt article:1</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; SADD article:1 uid:2</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Ng∆∞·ªùi d√πng uid:3 ƒë√°nh gi√° t√≠ch c·ª±c cho b√†i vi·∫øt article:1</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; SADD article:1 uid:3</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span></span></code></pre></div><p>Ng∆∞·ªùi d√πng <code>uid:1</code> h·ªßy ƒë√°nh gi√° t√≠ch c·ª±c cho b√†i vi·∫øt <code>article:1</code>.</p><div class="language-plain" data-highlighter="shiki" data-ext="plain" data-title="plain" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span>&gt; SREM article:1 uid:1</span></span>
<span class="line"><span>(integer) 1</span></span></code></pre></div><p>L·∫•y danh s√°ch t·∫•t c·∫£ ng∆∞·ªùi d√πng ƒë√£ ƒë√°nh gi√° t√≠ch c·ª±c cho b√†i vi·∫øt <code>article:1</code>:</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; SMEMBERS article:1</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;uid:3&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;uid:2&quot;</span></span></code></pre></div><p>L·∫•y s·ªë l∆∞·ª£ng ng∆∞·ªùi d√πng ƒë√£ ƒë√°nh gi√° t√≠ch c·ª±c cho b√†i vi·∫øt <code>article:1</code>:</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; SCARD article:1</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">2</span></span></code></pre></div><p>Ki·ªÉm tra xem ng∆∞·ªùi d√πng <code>uid:1</code> ƒë√£ ƒë√°nh gi√° t√≠ch c·ª±c cho b√†i vi·∫øt <code>article:1</code> hay ch∆∞a:</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; SISMEMBER article:1 uid:1</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">0</span><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">  # Tr·∫£ v·ªÅ 0 c√≥ nghƒ©a l√† ch∆∞a ƒë√°nh gi√° t√≠ch c·ª±c, tr·∫£ v·ªÅ 1 c√≥ nghƒ©a l√† ƒë√£ ƒë√°nh gi√° t√≠ch c·ª±c</span></span></code></pre></div><h4 id="chia-se-lua-chon" tabindex="-1"><a class="header-anchor" href="#chia-se-lua-chon"><span>Chia s·∫ª l·ª±a ch·ªçn</span></a></h4><p>Set trong Redis h·ªó tr·ª£ ph√©p to√°n giao c·ªßa n√≥, v√¨ v·∫≠y n√≥ c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ t√≠nh to√°n nh·ªØng g√¨ m√† nhi·ªÅu ng∆∞·ªùi d√πng c√πng quan t√¢m nh∆∞ b·∫°n b√® chung, c√°c t√†i kho·∫£n c√¥ng c·ªông v√† nhi·ªÅu h∆°n n·ªØa.</p><p>Key c√≥ th·ªÉ l√† ID ng∆∞·ªùi d√πng, gi√° tr·ªã l√† ID c·ªßa t√†i kho·∫£n c√¥ng c·ªông m√† h·ªç ƒë√£ theo d√µi.</p><p>Ng∆∞·ªùi d√πng <code>uid:1</code> theo d√µi t√†i kho·∫£n c√¥ng c·ªông v·ªõi ID l√† 5, 6, 7, 8, 9; ng∆∞·ªùi d√πng <code>uid:2</code> theo d√µi t√†i kho·∫£n c√¥ng c·ªông v·ªõi ID l√† 7, 8, 9, 10, 11.</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Ng∆∞·ªùi d√πng uid:1 theo d√µi c√°c t√†i kho·∫£n c√¥ng c·ªông v·ªõi ID l√† 5, 6, 7, 8, 9</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; SADD uid:1 5 6 7 8 9</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">5</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Ng∆∞·ªùi d√πng uid:2 theo d√µi c√°c t√†i kho·∫£n c√¥ng c·ªông v·ªõi ID l√† 7, 8, 9, 10, 11</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; SADD uid:2 7 8 9 10 11</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">5</span></span></code></pre></div><p>C√°c t√†i kho·∫£n c√¥ng c·ªông m√† <code>uid:1</code> v√† <code>uid:2</code> c√πng theo d√µi:</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># L·∫•y giao c·ªßa chung</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; SINTER uid:1 uid:2</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;7&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;8&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">3</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;9&quot;</span></span></code></pre></div><p>G·ª£i √Ω cho <code>uid:2</code> c√°c t√†i kho·∫£n c√¥ng c·ªông m√† <code>uid:1</code> ƒë√£ theo d√µi:</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; SDIFF uid:1 uid:2</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;5&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;6&quot;</span></span></code></pre></div><p>X√°c minh xem m·ªôt t√†i kho·∫£n c√¥ng c·ªông c·ª• th·ªÉ c√≥ ƒë∆∞·ª£c theo d√µi b·ªüi <code>uid:1</code> ho·∫∑c <code>uid:2</code> hay kh√¥ng:</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; SISMEMBER uid:1 5</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> # Tr·∫£ v·ªÅ 1, t·ª©c l√† ƒë√£ theo d√µi</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; SISMEMBER uid:2 5</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">0</span><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> # Tr·∫£ v·ªÅ 0, t·ª©c l√† ch∆∞a theo d√µi</span></span></code></pre></div><h4 id="hoat-ƒëong-rut-tham-may-man" tabindex="-1"><a class="header-anchor" href="#hoat-ƒëong-rut-tham-may-man"><span>Ho·∫°t ƒë·ªông r√∫t thƒÉm may m·∫Øn</span></a></h4><p>Set trong Redis r·∫•t h·ªØu √≠ch ƒë·ªÉ l∆∞u tr·ªØ t√™n ng∆∞·ªùi d√πng ƒë√£ tr√∫ng th∆∞·ªüng trong m·ªôt ho·∫°t ƒë·ªông r√∫t thƒÉm may m·∫Øn, v·ªõi t√≠nh nƒÉng lo·∫°i b·ªè c√°c gi√° tr·ªã tr√πng l·∫∑p, ƒë·∫£m b·∫£o r·∫±ng m·ªói ng∆∞·ªùi d√πng ch·ªâ c√≥ th·ªÉ tr√∫ng th∆∞·ªüng m·ªôt l·∫ßn.</p><p>Key l√† t√™n c·ªßa ho·∫°t ƒë·ªông r√∫t thƒÉm, value l√† t√™n c·ªßa nh√¢n vi√™n. ƒê∆∞a t·∫•t c·∫£ t√™n nh√¢n vi√™n v√†o h·ªôp r√∫t thƒÉm:</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;SADD lucky Tom Jerry John Sean Marry Lindy Sary Mark</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">7</span></span></code></pre></div><p>N·∫øu cho ph√©p tr√∫ng th∆∞·ªüng l·∫∑p l·∫°i, b·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng l·ªánh SRANDMEMBER.</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># R√∫t 1 gi·∫£i nh·∫•t:</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; SRANDMEMBER lucky 1</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;Tom&quot;</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># R√∫t 2 gi·∫£i nh√¨:</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; SRANDMEMBER lucky 2</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;Mark&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;Jerry&quot;</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># R√∫t 3 gi·∫£i ba:</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; SRANDMEMBER lucky 3</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;Sary&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;Tom&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">3</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;Jerry&quot;</span></span></code></pre></div><p>N·∫øu kh√¥ng cho ph√©p tr√πng l·∫∑p, b·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng l·ªánh SPOP.</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># R√∫t 1 gi·∫£i nh·∫•t:</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; SPOP lucky 1</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;Sary&quot;</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># R√∫t 2 gi·∫£i nh√¨:</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; SPOP lucky 2</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;Jerry&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;Mark&quot;</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># R√∫t 3 gi·∫£i ba:</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; SPOP lucky 3</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;John&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;Sean&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">3</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;Lindy&quot;</span></span></code></pre></div><p>ƒê√¢y l√† c√°ch s·ª≠ d·ª•ng Set trong Redis ƒë·ªÉ th·ª±c hi·ªán ho·∫°t ƒë·ªông r√∫t thƒÉm may m·∫Øn, ƒë·∫£m b·∫£o t√≠nh duy nh·∫•t c·ªßa c√°c gi·∫£i th∆∞·ªüng v√† ng∆∞·ªùi d√πng ch·ªâ c√≥ th·ªÉ tr√∫ng th∆∞·ªüng m·ªôt l·∫ßn.</p><h2 id="zset-sorted-set" tabindex="-1"><a class="header-anchor" href="#zset-sorted-set"><span>ZSET (Sorted Set)</span></a></h2><p>Lo·∫°i Zset trong Redis l√† m·ªôt t·∫≠p h·ª£p ƒë∆∞·ª£c s·∫Øp x·∫øp v√† lo·∫°i b·ªè tr√πng l·∫∑p.</p><h3 id="gioi-thieu-ve-zset" tabindex="-1"><a class="header-anchor" href="#gioi-thieu-ve-zset"><span>Gi·ªõi thi·ªáu v·ªÅ Zset</span></a></h3><p>Zset (t·∫≠p h·ª£p c√≥ th·ª© t·ª±) l√† m·ªôt lo·∫°i d·ªØ li·ªáu ƒë·∫∑c bi·ªát trong Redis, so v·ªõi lo·∫°i Set, n√≥ c√≥ th√™m m·ªôt thu·ªôc t√≠nh s·∫Øp x·∫øp g·ªçi l√† ƒëi·ªÉm (score). ƒê·ªëi v·ªõi t·∫≠p h·ª£p c√≥ th·ª© t·ª± Zset, m·ªói ph·∫ßn t·ª≠ l∆∞u tr·ªØ bao g·ªìm hai gi√° tr·ªã: m·ªôt l√† gi√° tr·ªã th√†nh vi√™n c·ªßa t·∫≠p h·ª£p v√† hai l√† gi√° tr·ªã s·∫Øp x·∫øp (score).</p><p>T·∫≠p h·ª£p c√≥ th·ª© t·ª± gi·ªØ nguy√™n t√≠nh ch·∫•t th√†nh vi√™n kh√¥ng th·ªÉ tr√πng l·∫∑p nh∆∞ Set, nh∆∞ng kh√°c bi·ªát ·ªü ch·ªó c√°c th√†nh vi√™n trong t·∫≠p h·ª£p c√≥ th·ª© t·ª± c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp theo th·ª© t·ª±.<br><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230724123002.png" alt="image.png" loading="lazy"></p><h3 id="trien-khai-zset" tabindex="-1"><a class="header-anchor" href="#trien-khai-zset"><span>Tri·ªÉn khai Zset</span></a></h3><p>Lo·∫°i d·ªØ li·ªáu t·∫≠p h·ª£p c√≥ th·ª© t·ª± (Zset) c√≥ th·ªÉ ƒë∆∞·ª£c m√£ h√≥a b·∫±ng <code>ziplist</code> ho·∫∑c <code>skiplist</code>.</p><p>ƒê·ªëi t∆∞·ª£ng Zset m√£ h√≥a b·∫±ng <code>ziplist</code> s·ª≠ d·ª•ng danh s√°ch n√©n l√†m c∆° ch·∫ø l∆∞u tr·ªØ c∆° s·ªü. M·ªói ph·∫ßn t·ª≠ c·ªßa t·∫≠p h·ª£p ƒë∆∞·ª£c l∆∞u tr·ªØ b·∫±ng hai n√∫t danh s√°ch n√©n k·ªÅ nhau. N√∫t ƒë·∫ßu ti√™n l∆∞u tr·ªØ th√†nh vi√™n c·ªßa ph·∫ßn t·ª≠ (member), trong khi n√∫t th·ª© hai l∆∞u tr·ªØ gi√° tr·ªã ƒëi·ªÉm (score) c·ªßa ph·∫ßn t·ª≠. C√°c ph·∫ßn t·ª≠ trong danh s√°ch n√©n ƒë∆∞·ª£c s·∫Øp x·∫øp theo th·ª© t·ª± t·ª´ ƒëi·ªÉm th·∫•p ƒë·∫øn cao, t·ª©c l√† c√°c ph·∫ßn t·ª≠ c√≥ ƒëi·ªÉm th·∫•p h∆°n ƒë∆∞·ª£c ƒë·∫∑t g·∫ßn ƒë·∫ßu danh s√°ch, v√† c√°c ph·∫ßn t·ª≠ c√≥ ƒëi·ªÉm cao h∆°n ƒë∆∞·ª£c ƒë·∫∑t g·∫ßn cu·ªëi danh s√°ch.</p><p>ƒê·ªëi t∆∞·ª£ng Zset m√£ h√≥a b·∫±ng <code>skiplist</code> s·ª≠ d·ª•ng c·∫•u tr√∫c <code>zset</code> nh∆∞ l√† c∆° ch·∫ø l∆∞u tr·ªØ c∆° s·ªü. M·ªói <code>zset</code> bao g·ªìm ƒë·ªìng th·ªùi m·ªôt t·ª´ ƒëi·ªÉn (dictionary) v√† m·ªôt b·∫£ng b·ªè qua (skiplist).</p><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" data-title="cpp" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">typedef</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> struct</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> zset</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">    zskiplist </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">zsl;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">    dict </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">dict;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">zset</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span></code></pre></div><ul><li><p><strong>zskiplist</strong>: Skiplist s·∫Øp x·∫øp t·ª´ ƒëi·ªÉm th·∫•p ƒë·∫øn cao c√°c ph·∫ßn t·ª≠ c·ªßa t·∫≠p h·ª£p. M·ªói n√∫t skiplist l∆∞u tr·ªØ m·ªôt ph·∫ßn t·ª≠ c·ªßa t·∫≠p h·ª£p: thu·ªôc t√≠nh <code>object</code> c·ªßa n√∫t skiplist l∆∞u tr·ªØ th√†nh vi√™n c·ªßa ph·∫ßn t·ª≠, trong khi thu·ªôc t√≠nh <code>score</code> c·ªßa n√∫t skiplist l∆∞u tr·ªØ ƒëi·ªÉm c·ªßa ph·∫ßn t·ª≠. B·∫±ng c√°ch n√†y, Redis c√≥ th·ªÉ th·ª±c hi·ªán c√°c ph√©p to√°n ph·∫°m vi tr√™n t·∫≠p h·ª£p c√≥ th·ª© t·ª± nh∆∞ ZRANK, ZRANGE d·ª±a tr√™n API c·ªßa skiplist.</p></li><li><p><strong>dict</strong>: T·ª´ ƒëi·ªÉn t·∫°o m·ªôt √°nh x·∫° t·ª´ th√†nh vi√™n ƒë·∫øn ƒëi·ªÉm c·ªßa t·∫≠p h·ª£p c√≥ th·ª© t·ª±. M·ªói c·∫∑p kh√≥a-gi√° tr·ªã trong t·ª´ ƒëi·ªÉn l∆∞u tr·ªØ m·ªôt ph·∫ßn t·ª≠ c·ªßa t·∫≠p h·ª£p: kh√≥a c·ªßa t·ª´ ƒëi·ªÉn l∆∞u tr·ªØ th√†nh vi√™n c·ªßa ph·∫ßn t·ª≠, trong khi gi√° tr·ªã c·ªßa t·ª´ ƒëi·ªÉn l∆∞u tr·ªØ ƒëi·ªÉm c·ªßa ph·∫ßn t·ª≠. Redis c√≥ th·ªÉ truy v·∫•n ƒëi·ªÉm c·ªßa m·ªôt th√†nh vi√™n c·ª• th·ªÉ v·ªõi ƒë·ªô ph·ª©c t·∫°p O(1) b·∫±ng l·ªánh ZSCORE, v√† nhi·ªÅu l·ªánh kh√°c c·ªßa t·∫≠p h·ª£p c√≥ th·ª© t·ª± d·ª±a tr√™n t√≠nh nƒÉng n√†y.</p></li></ul><p>M·ªói th√†nh vi√™n c·ªßa t·∫≠p h·ª£p c√≥ th·ª© t·ª± l√† m·ªôt ƒë·ªëi t∆∞·ª£ng chu·ªói, v√† m·ªói ƒëi·ªÉm c·ªßa th√†nh vi√™n l√† m·ªôt s·ªë th·ª±c lo·∫°i double. ƒê√°ng ch√∫ √Ω l√†, m·∫∑c d√π <code>zset</code> s·ª≠ d·ª•ng c·∫£ skiplist v√† t·ª´ ƒëi·ªÉn ƒë·ªÉ l∆∞u tr·ªØ c√°c ph·∫ßn t·ª≠ c·ªßa t·∫≠p h·ª£p c√≥ th·ª© t·ª±, nh∆∞ng c·∫£ hai c·∫•u tr√∫c d·ªØ li·ªáu n√†y s·∫Ω chia s·∫ª c√πng m·ªôt con tr·ªè cho c√°c th√†nh vi√™n v√† ƒëi·ªÉm t∆∞∆°ng t·ª± nhau. Do ƒë√≥, vi·ªác s·ª≠ d·ª•ng ƒë·ªìng th·ªùi skiplist v√† t·ª´ ƒëi·ªÉn ƒë·ªÉ l∆∞u tr·ªØ c√°c ph·∫ßn t·ª≠ c·ªßa t·∫≠p h·ª£p c√≥ th·ª© t·ª± kh√¥ng t·∫°o ra b·∫•t k·ª≥ th√†nh vi√™n ho·∫∑c ƒëi·ªÉm l·∫∑p l·∫°i n√†o v√† c≈©ng kh√¥ng l√£ng ph√≠ b·ªô nh·ªõ th·ª´a.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624210536.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>Khi ƒë·ªëi t∆∞·ª£ng t·∫≠p h·ª£p c√≥ th·ª© t·ª± c√≥ th·ªÉ ƒë√°p ·ª©ng ƒë·ªìng th·ªùi hai ƒëi·ªÅu ki·ªán sau ƒë√¢y, n√≥ s·∫Ω s·ª≠ d·ª•ng m√£ h√≥a <code>ziplist</code>; ng∆∞·ª£c l·∫°i, n√≥ s·∫Ω s·ª≠ d·ª•ng m√£ h√≥a <code>skiplist</code>:</p><ul><li>S·ªë l∆∞·ª£ng ph·∫ßn t·ª≠ c·ªßa t·∫≠p h·ª£p c√≥ th·ª© t·ª± nh·ªè h∆°n <code>128</code>.</li><li>ƒê·ªô d√†i c·ªßa t·∫•t c·∫£ c√°c th√†nh vi√™n c·ªßa t·∫≠p h·ª£p c√≥ th·ª© t·ª± nh·ªè h∆°n <code>64</code> byte.</li></ul><blockquote><p>L∆∞u √Ω: C√°c gi·ªõi h·∫°n tr√™n ƒë·ªÅu c√≥ th·ªÉ ƒë∆∞·ª£c ƒëi·ªÅu ch·ªânh, vui l√≤ng xem trong t√†i li·ªáu c·∫•u h√¨nh v·ªÅ c√°c t√πy ch·ªçn <code>zset-max-ziplist-entries</code> v√† <code>zset-max-ziplist-value</code> ƒë·ªÉ bi·∫øt th√™m chi ti·∫øt.</p></blockquote><p><strong>Trong Redis 7.0, c·∫•u tr√∫c d·ªØ li·ªáu ziplist ƒë√£ b·ªã lo·∫°i b·ªè v√† ƒë∆∞·ª£c tri·ªÉn khai b·∫±ng c·∫•u tr√∫c d·ªØ li·ªáu listpack.</strong></p><h3 id="zset-commands" tabindex="-1"><a class="header-anchor" href="#zset-commands"><span>Zset Commands</span></a></h3><table><thead><tr><th>Command</th><th>Behavior</th></tr></thead><tbody><tr><td><code>ZADD</code></td><td>Th√™m m·ªôt th√†nh vi√™n v·ªõi ƒëi·ªÉm x·∫øp h·∫°ng ƒë√£ cho v√†o t·∫≠p h·ª£p c√≥ th·ª© t·ª±</td></tr><tr><td><code>ZRANGE</code></td><td>S·∫Øp x·∫øp theo th·ª© t·ª± v√† tr·∫£ v·ªÅ c√°c th√†nh vi√™n trong kho·∫£ng x·∫øp h·∫°ng ch·ªâ ƒë·ªãnh</td></tr><tr><td><code>ZREVRANGE</code></td><td>S·∫Øp x·∫øp theo th·ª© t·ª± ng∆∞·ª£c v√† tr·∫£ v·ªÅ c√°c th√†nh vi√™n trong kho·∫£ng x·∫øp h·∫°ng ch·ªâ ƒë·ªãnh</td></tr><tr><td><code>ZRANGEBYSCORE</code></td><td>S·∫Øp x·∫øp theo th·ª© t·ª± v√† tr·∫£ v·ªÅ c√°c th√†nh vi√™n trong kho·∫£ng x·∫øp h·∫°ng ch·ªâ ƒë·ªãnh c√πng v·ªõi ƒëi·ªÉm x·∫øp h·∫°ng</td></tr><tr><td><code>ZREVRANGEBYSCORE</code></td><td>S·∫Øp x·∫øp theo th·ª© t·ª± ng∆∞·ª£c v√† tr·∫£ v·ªÅ c√°c th√†nh vi√™n trong kho·∫£ng x·∫øp h·∫°ng ch·ªâ ƒë·ªãnh c√πng v·ªõi ƒëi·ªÉm x·∫øp h·∫°ng</td></tr><tr><td><code>ZREM</code></td><td>X√≥a c√°c th√†nh vi√™n ƒë∆∞·ª£c ch·ªâ ƒë·ªãnh kh·ªèi t·∫≠p h·ª£p c√≥ th·ª© t·ª±</td></tr><tr><td><code>ZSCORE</code></td><td>L·∫•y ƒëi·ªÉm x·∫øp h·∫°ng c·ªßa m·ªôt th√†nh vi√™n ƒë∆∞·ª£c ch·ªâ ƒë·ªãnh</td></tr><tr><td><code>ZCARD</code></td><td>L·∫•y s·ªë l∆∞·ª£ng th√†nh vi√™n trong t·∫≠p h·ª£p c√≥ th·ª© t·ª±</td></tr></tbody></table><h4 id="cac-hoat-ƒëong-pho-bien-cua-zset" tabindex="-1"><a class="header-anchor" href="#cac-hoat-ƒëong-pho-bien-cua-zset"><span>C√°c ho·∫°t ƒë·ªông ph·ªï bi·∫øn c·ªßa Zset:</span></a></h4><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Th√™m th√†nh vi√™n v·ªõi ƒëi·ªÉm x·∫øp h·∫°ng v√†o t·∫≠p h·ª£p c√≥ th·ª© t·ª±</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">ZADD</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> score</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> member</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> [[score </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">member]...]</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># X√≥a th√†nh vi√™n t·ª´ t·∫≠p h·ª£p c√≥ th·ª© t·ª±</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">ZREM</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> member</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> [member...]</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># L·∫•y ƒëi·ªÉm x·∫øp h·∫°ng c·ªßa th√†nh vi√™n</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">ZSCORE</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> member</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># L·∫•y s·ªë l∆∞·ª£ng th√†nh vi√™n trong t·∫≠p h·ª£p</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">ZCARD</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># TƒÉng ƒëi·ªÉm x·∫øp h·∫°ng c·ªßa th√†nh vi√™n trong t·∫≠p h·ª£p c√≥ th·ª© t·ª±</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">ZINCRBY</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> increment</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> member</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># L·∫•y c√°c th√†nh vi√™n theo th·ª© t·ª± t·ª´ v·ªã tr√≠ start ƒë·∫øn stop</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">ZRANGE</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> stop</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> [WITHSCORES]</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># L·∫•y c√°c th√†nh vi√™n theo th·ª© t·ª± ng∆∞·ª£c t·ª´ v·ªã tr√≠ start ƒë·∫øn stop</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">ZREVRANGE</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> stop</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> [WITHSCORES]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># L·∫•y c√°c th√†nh vi√™n trong kho·∫£ng ƒëi·ªÉm x·∫øp h·∫°ng t·ª´ min ƒë·∫øn max, s·∫Øp x·∫øp theo th·ª© t·ª±</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">ZRANGEBYSCORE</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> min</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> max</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> [WITHSCORES] [LIMIT offset count]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># L·∫•y c√°c th√†nh vi√™n trong kho·∫£ng t·ª´ min ƒë·∫øn max theo th·ª© t·ª± t·ª´ ƒëi·ªÉn, v·ªõi ƒëi·ªÉm x·∫øp h·∫°ng gi·ªëng nhau</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">ZRANGEBYLEX</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> min</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> max</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> [LIMIT </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">offset</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> count]</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># L·∫•y c√°c th√†nh vi√™n trong kho·∫£ng t·ª´ max ƒë·∫øn min theo th·ª© t·ª± t·ª´ ƒëi·ªÉn, v·ªõi ƒëi·ªÉm x·∫øp h·∫°ng gi·ªëng nhau</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">ZREVRANGEBYLEX</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> max</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> min</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> [LIMIT </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">offset</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> count]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="cac-phep-toan-zset-so-voi-loai-set-loai-zset-khong-ho-tro-phep-toan-hieu" tabindex="-1"><a class="header-anchor" href="#cac-phep-toan-zset-so-voi-loai-set-loai-zset-khong-ho-tro-phep-toan-hieu"><span>C√°c ph√©p to√°n Zset (so v·ªõi lo·∫°i Set, lo·∫°i Zset kh√¥ng h·ªó tr·ª£ ph√©p to√°n hi·ªáu):</span></a></h4><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Ph√©p to√°n h·ª£p nh·∫•t (t·ªïng h·ª£p ƒëi·ªÉm x·∫øp h·∫°ng cho c√°c th√†nh vi√™n gi·ªëng nhau), numberkeys l√† s·ªë l∆∞·ª£ng key, WEIGHTS l√† t√≠ch ƒëi·ªÉm x·∫øp h·∫°ng cho t·ª´ng key</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">ZUNIONSTORE</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> destkey</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> numberkeys</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> [key...]</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Ph√©p to√°n giao nhau (t·ªïng h·ª£p ƒëi·ªÉm x·∫øp h·∫°ng cho c√°c th√†nh vi√™n gi·ªëng nhau), numberkeys l√† s·ªë l∆∞·ª£ng key, WEIGHTS l√† t√≠ch ƒëi·ªÉm x·∫øp h·∫°ng cho t·ª´ng key</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">ZINTERSTORE</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> destkey</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> numberkeys</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> [key...]</span></span></code></pre></div><h3 id="ung-dung-cua-zset" tabindex="-1"><a class="header-anchor" href="#ung-dung-cua-zset"><span>·ª®ng d·ª•ng c·ªßa Zset</span></a></h3><p>Lo·∫°i d·ªØ li·ªáu Zset (Sorted Set - T·∫≠p h·ª£p c√≥ th·ª© t·ª±) trong Redis cho ph√©p s·∫Øp x·∫øp c√°c ph·∫ßn t·ª≠ d·ª±a tr√™n tr·ªçng s·ªë c·ªßa ch√∫ng, m√† ta c√≥ th·ªÉ t·ª± ƒë·ªãnh nghƒ©a. V√≠ d·ª•, ch√∫ng ta c√≥ th·ªÉ s·ª≠ d·ª•ng th·ªùi gian ch√®n c√°c ph·∫ßn t·ª≠ v√†o Sorted Set ƒë·ªÉ x√°c ƒë·ªãnh gi√° tr·ªã tr·ªçng s·ªë, c√°c ph·∫ßn t·ª≠ ch√®n tr∆∞·ªõc s·∫Ω c√≥ gi√° tr·ªã tr·ªçng s·ªë nh·ªè h∆°n v√† c√°c ph·∫ßn t·ª≠ ch√®n sau s·∫Ω c√≥ gi√° tr·ªã tr·ªçng s·ªë l·ªõn h∆°n.</p><p>Trong c√°c t√¨nh hu·ªëng c·∫ßn hi·ªÉn th·ªã danh s√°ch m·ªõi nh·∫•t, b·∫£ng x·∫øp h·∫°ng v√† c√°c ·ª©ng d·ª•ng c·∫ßn c·∫≠p nh·∫≠t d·ªØ li·ªáu th∆∞·ªùng xuy√™n ho·∫∑c c·∫ßn hi·ªÉn th·ªã theo trang, th√¨ s·ª≠ d·ª•ng Sorted Set l√† l·ª±a ch·ªçn h√†ng ƒë·∫ßu.</p><h3 id="bang-xep-hang" tabindex="-1"><a class="header-anchor" href="#bang-xep-hang"><span>B·∫£ng x·∫øp h·∫°ng</span></a></h3><p><strong>[C√°c t√¨nh hu·ªëng c·∫ßn thi·∫øt]</strong></p><p>C√°c lo·∫°i b·∫£ng x·∫øp h·∫°ng kh√°c nhau nh∆∞: b·∫£ng x·∫øp h·∫°ng l∆∞·ª£t xem/ƒë√°nh gi√°/b√¨nh lu·∫≠n c·ªßa n·ªôi dung (video, b√†i h√°t, b√†i vi·∫øt) tr√™n c√°c n·ªÅn t·∫£ng n·ªôi dung; b·∫£ng x·∫øp h·∫°ng doanh s·ªë b√°n h√†ng c·ªßa c√°c s·∫£n ph·∫©m tr√™n c√°c trang th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠.</p><p><strong>[Gi·∫£i ph√°p]</strong></p><p>Sorted Set (T·∫≠p h·ª£p c√≥ th·ª© t·ª±) l√† m·ªôt trong nh·ªØng gi·∫£i ph√°p ph·ªï bi·∫øn cho c√°c b·∫£ng x·∫øp h·∫°ng. V√≠ d·ª• nh∆∞ b·∫£ng x·∫øp h·∫°ng ƒëi·ªÉm s·ªë h·ªçc sinh, b·∫£ng x·∫øp h·∫°ng ƒëi·ªÉm trong game, b·∫£ng x·∫øp h·∫°ng video ph√°t s√≥ng, b·∫£ng x·∫øp h·∫°ng doanh s·ªë s·∫£n ph·∫©m tr√™n h·ªá th·ªëng th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠.</p><p>Ch√∫ng ta l·∫•y v√≠ d·ª• v·ªÅ b·∫£ng x·∫øp h·∫°ng c√°c b√†i vi·∫øt ƒë∆∞·ª£c th√≠ch c·ªßa ng∆∞·ªùi d√πng c√≥ t√™n l√† Xiaolin, Xiaolin ƒë√£ ƒëƒÉng nƒÉm b√†i vi·∫øt v√† c√≥ s·ªë l∆∞·ª£ng l∆∞·ª£t th√≠ch l√† 200, 40, 100, 50 v√† 150 l∆∞·ª£t l·∫ßn l∆∞·ª£t.</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># B√†i vi·∫øt arcticle:1 c√≥ 200 l∆∞·ª£t th√≠ch</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; ZADD user:xiaolin:ranking 200 arcticle:1</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># B√†i vi·∫øt arcticle:2 c√≥ 40 l∆∞·ª£t th√≠ch</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; ZADD user:xiaolin:ranking 40 arcticle:2</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># B√†i vi·∫øt arcticle:3 c√≥ 100 l∆∞·ª£t th√≠ch</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; ZADD user:xiaolin:ranking 100 arcticle:3</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># B√†i vi·∫øt arcticle:4 c√≥ 50 l∆∞·ª£t th√≠ch</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; ZADD user:xiaolin:ranking 50 arcticle:4</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># B√†i vi·∫øt arcticle:5 c√≥ 150 l∆∞·ª£t th√≠ch</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; ZADD user:xiaolin:ranking 150 arcticle:5</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>N·∫øu b√†i vi·∫øt arcticle:4 c√≥ th√™m m·ªôt l∆∞·ª£t th√≠ch m·ªõi, ta c√≥ th·ªÉ s·ª≠ d·ª•ng l·ªánh ZINCRBY (tƒÉng gi√° tr·ªã ƒëi·ªÉm s·ªë cho th√†nh vi√™n trong Sorted Set):</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; ZINCRBY user:xiaolin:ranking 1 arcticle:4</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">&quot;51&quot;</span></span></code></pre></div><p>ƒê·ªÉ xem s·ªë l∆∞·ª£t th√≠ch c·ªßa m·ªôt b√†i vi·∫øt c·ª• th·ªÉ, ta c√≥ th·ªÉ s·ª≠ d·ª•ng l·ªánh ZSCORE (tr·∫£ v·ªÅ gi√° tr·ªã ƒëi·ªÉm s·ªë c·ªßa th√†nh vi√™n trong Sorted Set):</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; ZSCORE user:xiaolin:ranking arcticle:4</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">&quot;50&quot;</span></span></code></pre></div><p>ƒê·ªÉ l·∫•y danh s√°ch 3 b√†i vi·∫øt c·ªßa Xiaolin c√≥ s·ªë l∆∞·ª£t th√≠ch cao nh·∫•t, ta s·ª≠ d·ª•ng l·ªánh ZREVRANGE (l·∫•y danh s√°ch c√°c th√†nh vi√™n t·ª´ cao ƒë·∫øn th·∫•p trong Sorted Set):</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># WITHSCORES cho bi·∫øt c·∫£ ƒëi·ªÉm s·ªë</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; ZREVRANGE user:xiaolin:ranking 0 2 WITHSCORES</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;arcticle:1&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;200&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">3</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;arcticle:5&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">4</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;150&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">5</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;arcticle:3&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">6</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;100&quot;</span></span></code></pre></div><p>ƒê·ªÉ l·∫•y danh s√°ch c√°c b√†i vi·∫øt c·ªßa Xiaolin c√≥ t·ª´ 100 ƒë·∫øn 200 l∆∞·ª£t th√≠ch, ta s·ª≠ d·ª•ng l·ªánh ZRANGEBYSCORE (l·∫•y danh s√°ch c√°c th√†nh vi√™n trong m·ªôt kho·∫£ng ƒëi·ªÉm s·ªë t·ª´ th·∫•p ƒë·∫øn cao trong Sorted Set):</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; ZRANGEBYSCORE user:xiaolin:ranking 100 200 WITHSCORES</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;arcticle:3&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;100&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">3</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;arcticle:5&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">4</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;150&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">5</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;arcticle:1&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">6</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;200&quot;</span></span></code></pre></div><h3 id="sap-xep-theo-tien-to" tabindex="-1"><a class="header-anchor" href="#sap-xep-theo-tien-to"><span>S·∫Øp x·∫øp theo ti·ªÅn t·ªë</span></a></h3><p>S·ª≠ d·ª•ng c√°c l·ªánh <code>ZRANGEBYLEX</code> ho·∫∑c <code>ZREVRANGEBYLEX</code> tr√™n t·∫≠p h·ª£p c√≥ th·ª© t·ª± (Sorted Set) cho ph√©p ch√∫ng ta s·∫Øp x·∫øp s·ªë ƒëi·ªán tho·∫°i ho·∫∑c t√™n theo th·ª© t·ª±. Ch√∫ng ta s·∫Ω l·∫•y v√≠ d·ª• v·ªÅ l·ªánh <code>ZRANGEBYLEX</code> (tr·∫£ v·ªÅ c√°c th√†nh vi√™n trong m·ªôt kho·∫£ng nh·∫•t ƒë·ªãnh theo th·ª© t·ª± t·ª´ ƒëi·ªÉn).</p><p><strong>1. S·∫Øp x·∫øp s·ªë ƒëi·ªán tho·∫°i</strong></p><p>Ch√∫ng ta c√≥ th·ªÉ l∆∞u tr·ªØ c√°c s·ªë ƒëi·ªán tho·∫°i trong Sorted Set v√† l·∫•y c√°c s·ªë ƒëi·ªán tho·∫°i trong m·ªôt d√£y c·ª• th·ªÉ:</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; ZADD phone 0 13100111100 0 13110114300 0 13132110901</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">3</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; ZADD phone 0 13200111100 0 13210414300 0 13252110901</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">3</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; ZADD phone 0 13300111100 0 13310414300 0 13352110901</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">3</span></span></code></pre></div><p>L·∫•y t·∫•t c·∫£ c√°c s·ªë ƒëi·ªán tho·∫°i:</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; ZRANGEBYLEX phone - +</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;13100111100&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;13110114300&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">3</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;13132110901&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">4</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;13200111100&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">5</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;13210414300&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">6</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;13252110901&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">7</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;13300111100&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">8</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;13310414300&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">9</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;13352110901&quot;</span></span></code></pre></div><p>L·∫•y c√°c s·ªë ƒëi·ªán tho·∫°i trong d√£y 132:</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; ZRANGEBYLEX phone [</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">132</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">133</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">1) &quot;13200111100&quot;</span></span>
<span class="line"><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;13210414300&quot;</span></span>
<span class="line"><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;13252110901&quot;</span></span></code></pre></div><p>L·∫•y c√°c s·ªë ƒëi·ªán tho·∫°i trong d√£y 132 v√† 133:</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; ZRANGEBYLEX phone [</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">132</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">134</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">1) &quot;13200111100&quot;</span></span>
<span class="line"><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;13210414300&quot;</span></span>
<span class="line"><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;13252110901&quot;</span></span>
<span class="line"><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;13300111100&quot;</span></span>
<span class="line"><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;13310414300&quot;</span></span>
<span class="line"><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">6</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;13352110901&quot;</span></span></code></pre></div><p><strong>2. S·∫Øp x·∫øp theo t√™n</strong></p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; zadd names 0 Toumas 0 Jake 0 Bluetuo 0 Gaodeng 0 Aimini 0 Aidehua</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">6</span></span></code></pre></div><p>L·∫•y t·∫•t c·∫£ c√°c t√™n:</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; ZRANGEBYLEX names - +</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;Aidehua&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;Aimini&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">3</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;Bluetuo&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">4</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;Gaodeng&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">5</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;Jake&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">6</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;Toumas&quot;</span></span></code></pre></div><p>L·∫•y c√°c t√™n b·∫Øt ƒë·∫ßu b·∫±ng ch·ªØ c√°i A:</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; ZRANGEBYLEX names [A (</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">B</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">1) &quot;Aidehua&quot;</span></span>
<span class="line"><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;Aimini&quot;</span></span></code></pre></div><p>L·∫•y c√°c t√™n t·ª´ ch·ªØ c√°i C ƒë·∫øn Z:</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; ZRANGEBYLEX names [C [Z</span></span>
<span class="line"><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;Gaodeng&quot;</span></span>
<span class="line"><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;Jake&quot;</span></span>
<span class="line"><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;Toumas&quot;</span></span></code></pre></div><p>ƒê√≥ l√† c√°c v√≠ d·ª• v·ªÅ c√°ch s·ª≠ d·ª•ng <code>ZRANGEBYLEX</code> ƒë·ªÉ s·∫Øp x·∫øp c√°c th√†nh vi√™n trong Sorted Set theo th·ª© t·ª± t·ª´ ƒëi·ªÉn.</p><h2 id="ung-dung-thuc-te" tabindex="-1"><a class="header-anchor" href="#ung-dung-thuc-te"><span>·ª®ng d·ª•ng th·ª±c t√™</span></a></h2><h3 id="case-study-bai-viet-pho-bien-nhat" tabindex="-1"><a class="header-anchor" href="#case-study-bai-viet-pho-bien-nhat"><span>Case study - B√†i vi·∫øt ph·ªï bi·∫øn nh·∫•t</span></a></h3><p>ƒê·ªÉ ch·ªçn ra c√°c b√†i vi·∫øt ph·ªï bi·∫øn nh·∫•t, c·∫ßn h·ªó tr·ª£ vi·ªác ƒë√°nh gi√° b√†i vi·∫øt.</p><h4 id="binh-chon-cho-bai-viet" tabindex="-1"><a class="header-anchor" href="#binh-chon-cho-bai-viet"><span>B√¨nh ch·ªçn cho b√†i vi·∫øt</span></a></h4><p>(1) L∆∞u tr·ªØ b√†i vi·∫øt b·∫±ng HASH</p><p>S·ª≠ d·ª•ng ki·ªÉu d·ªØ li·ªáu HASH ƒë·ªÉ l∆∞u tr·ªØ th√¥ng tin c·ªßa b√†i vi·∫øt. Trong ƒë√≥: key l√† ID c·ªßa b√†i vi·∫øt; field l√† kh√≥a thu·ªôc t√≠nh c·ªßa b√†i vi·∫øt; value l√† gi√° tr·ªã t∆∞∆°ng ·ª©ng c·ªßa thu·ªôc t√≠nh.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200225143038.jpg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>C√°c thao t√°c:</p><ul><li>L∆∞u tr·ªØ th√¥ng tin b√†i vi·∫øt - S·ª≠ d·ª•ng l·ªánh HSET ho·∫∑c HMSET</li><li>Truy v·∫•n th√¥ng tin b√†i vi·∫øt - S·ª≠ d·ª•ng l·ªánh HGETALL</li><li>Th√™m phi·∫øu b√¨nh ch·ªçn - S·ª≠ d·ª•ng l·ªánh HINCRBY</li></ul><p>(2) S·ª≠ d·ª•ng ZSET ƒë·ªÉ s·∫Øp x·∫øp t·∫≠p h·ª£p b√†i vi·∫øt theo c√°c ti√™u ch√≠ kh√°c nhau</p><p>S·ª≠ d·ª•ng ki·ªÉu d·ªØ li·ªáu ZSET ƒë·ªÉ l∆∞u tr·ªØ t·∫≠p h·ª£p c√°c ID b√†i vi·∫øt ƒë∆∞·ª£c s·∫Øp x·∫øp theo th·ªùi gian v√† ƒëi·ªÉm s·ªë.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200225145742.jpg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>C√°c thao t√°c:</p><ul><li>Th√™m b·∫£n ghi - S·ª≠ d·ª•ng l·ªánh ZADD</li><li>Th√™m ƒëi·ªÉm - S·ª≠ d·ª•ng l·ªánh ZINCRBY</li><li>L·∫•y ra nhi·ªÅu b√†i vi·∫øt - S·ª≠ d·ª•ng l·ªánh ZREVRANGE</li></ul><p>(3) ƒê·ªÉ tr√°nh vi·ªác b√¨nh ch·ªçn tr√πng l·∫∑p, s·ª≠ d·ª•ng ki·ªÉu d·ªØ li·ªáu SET ƒë·ªÉ ghi l·∫°i t·∫≠p h·ª£p c√°c b√†i vi·∫øt ƒë√£ ƒë∆∞·ª£c b√¨nh ch·ªçn.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200225150105.jpg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>C√°c thao t√°c:</p><ul><li>Th√™m ng∆∞·ªùi b√¨nh ch·ªçn - S·ª≠ d·ª•ng l·ªánh SADD</li><li>ƒê·∫∑t th·ªùi gian hi·ªáu l·ª±c - S·ª≠ d·ª•ng l·ªánh EXPIRE</li></ul><p>(4) Gi·∫£ s·ª≠ user:115423 b√¨nh ch·ªçn cho article:100408, c·∫ßn c·∫≠p nh·∫≠t c·∫£ t·∫≠p h·ª£p s·∫Øp x·∫øp theo ƒëi·ªÉm s·ªë v√† t·∫≠p h·ª£p b√¨nh ch·ªçn.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200225150138.jpg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>Khi c·∫ßn b√¨nh ch·ªçn cho m·ªôt b√†i vi·∫øt, ch∆∞∆°ng tr√¨nh c·∫ßn s·ª≠ d·ª•ng l·ªánh ZSCORE ƒë·ªÉ ki·ªÉm tra t·∫≠p h·ª£p s·∫Øp x·∫øp theo th·ªùi gian ƒëƒÉng b√†i vi·∫øt v√† x√°c ƒë·ªãnh xem th·ªùi gian ƒëƒÉng b√†i vi·∫øt c√≥ v∆∞·ª£t qu√° th·ªùi gian hi·ªáu l·ª±c c·ªßa b√¨nh ch·ªçn (v√≠ d·ª•: m·ªôt tu·∫ßn) hay kh√¥ng.</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> articleVote</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Jedis</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> user</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> article) {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // T√≠nh to√°n th·ªùi gian k·∫øt th√∫c b√¨nh ch·ªçn c·ªßa b√†i vi·∫øt.</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        long</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> cutoff </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">System</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">currentTimeMillis</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> /</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 1000</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> ONE_WEEK_IN_SECONDS</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // Ki·ªÉm tra xem c√≥ th·ªÉ b√¨nh ch·ªçn cho b√†i vi·∫øt hay kh√¥ng</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // (M·∫∑c d√π c√≥ th·ªÉ l·∫•y th·ªùi gian ƒëƒÉng b√†i vi·∫øt t·ª´ HASH,</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // nh∆∞ng t·∫≠p h·ª£p s·∫Øp x·∫øp tr·∫£ v·ªÅ th·ªùi gian ƒëƒÉng b√†i vi·∫øt d∆∞·ªõi d·∫°ng s·ªë th·ª±c,</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // n√™n c√≥ th·ªÉ s·ª≠ d·ª•ng tr·ª±c ti·∫øp m√† kh√¥ng c·∫ßn chuy·ªÉn ƒë·ªïi).</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">zscore</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;time:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, article)</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> &lt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> cutoff) {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            return</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // L·∫•y ID c·ªßa b√†i vi·∫øt t·ª´ ƒë·ªãnh danh article:id.</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> articleId </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> article</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">substring</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">article</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">indexOf</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&#39;:&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // N·∫øu ng∆∞·ªùi d√πng ch∆∞a b√¨nh ch·ªçn cho b√†i vi·∫øt n√†y, tƒÉng s·ªë l∆∞·ª£ng b√¨nh ch·ªçn v√† ƒëi·ªÉm s·ªë c·ªßa b√†i vi·∫øt.</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">sadd</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;voted:&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> articleId, user)</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">zincrby</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;score:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, VOTE_SCORE, article);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">hincrBy</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(article, </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;votes&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">        }</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">    }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ƒëang-va-lay-bai-viet" tabindex="-1"><a class="header-anchor" href="#ƒëang-va-lay-bai-viet"><span>ƒêƒÉng v√† l·∫•y b√†i vi·∫øt</span></a></h4><p>ƒêƒÉng b√†i vi·∫øt:</p><ul><li>Th√™m b√†i vi·∫øt - S·ª≠ d·ª•ng l·ªánh <code>INCR</code> ƒë·ªÉ t√≠nh to√°n ID m·ªõi cho b√†i vi·∫øt, ƒëi·ªÅn th√¥ng tin b√†i vi·∫øt v√† s·ª≠ d·ª•ng l·ªánh <code>HSET</code> ho·∫∑c <code>HMSET</code> ƒë·ªÉ ghi v√†o c·∫•u tr√∫c <code>HASH</code>.</li><li>Th√™m ID t√°c gi·∫£ v√†o List b√¨nh ch·ªçn - S·ª≠ d·ª•ng l·ªánh <code>SADD</code> ƒë·ªÉ th√™m v√†o c·∫•u tr√∫c <code>SET</code> ƒë·∫°i di·ªán cho List b√¨nh ch·ªçn.</li><li>ƒê·∫∑t th·ªùi gian hi·ªáu l·ª±c c·ªßa b√¨nh ch·ªçn - S·ª≠ d·ª•ng l·ªánh <code>EXPIRE</code> ƒë·ªÉ ƒë·∫∑t th·ªùi gian hi·ªáu l·ª±c c·ªßa b√¨nh ch·ªçn.</li></ul><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> postArticle</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Jedis</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> user</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> title</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> link) {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // T·∫°o m·ªôt ID m·ªõi cho b√†i vi·∫øt.</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> articleId </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">valueOf</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">incr</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;article:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> voted </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> &quot;voted:&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> articleId</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // Th√™m ng∆∞·ªùi d√πng ƒëƒÉng b√†i v√†o List ƒë√£ b√¨nh ch·ªçn c·ªßa b√†i vi·∫øt,</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">sadd</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(voted, user);</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // ƒê·∫∑t th·ªùi gian t·ªìn t·∫°i c·ªßa List n√†y l√† m·ªôt tu·∫ßn (Ch∆∞∆°ng 3 s·∫Ω gi·∫£i th√≠ch chi ti·∫øt h∆°n v·ªÅ th·ªùi gian t·ªìn t·∫°i).</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">expire</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(voted, ONE_WEEK_IN_SECONDS);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        long</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> now </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> System</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">currentTimeMillis</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> /</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 1000</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> article </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> &quot;article:&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> articleId</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // L∆∞u th√¥ng tin b√†i vi·∫øt v√†o m·ªôt hash.</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        HashMap</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> articleData </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> HashMap</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">()</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        articleData</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">put</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;title&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, title);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        articleData</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">put</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;link&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, link);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        articleData</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">put</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;user&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, user);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        articleData</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">put</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;now&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">valueOf</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(now));</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        articleData</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">put</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;votes&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;1&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">hmset</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(article, articleData);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // Th√™m b√†i vi·∫øt v√†o t·∫≠p h·ª£p s·∫Øp x·∫øp theo th·ªùi gian ƒëƒÉng v√† t·∫≠p h·ª£p s·∫Øp x·∫øp theo ƒëi·ªÉm s·ªë.</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">zadd</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;score:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, now </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> VOTE_SCORE, article);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">zadd</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;time:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, now, article);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> articleId</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">    }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Truy v·∫•n ph√¢n trang cho c√°c b√†i vi·∫øt ph·ªï bi·∫øn:</p><p>S·ª≠ d·ª•ng l·ªánh <code>ZINTERSTORE</code> ƒë·ªÉ truy v·∫•n List ID b√†i vi·∫øt theo trang, s·ªë b√†i vi·∫øt tr√™n m·ªói trang v√† s·ªë th·ª© t·ª± s·∫Øp x·∫øp theo ƒëi·ªÉm s·ªë t·ª´ cao xu·ªëng th·∫•p.</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> List</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Map</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> String</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;&gt;</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> getArticles</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Jedis</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> page</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> order) {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // ƒê·∫∑t ch·ªâ m·ª•c b·∫Øt ƒë·∫ßu v√† k·∫øt th√∫c ƒë·ªÉ l·∫•y b√†i vi·∫øt.</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        int</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> start </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (page </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">*</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> ARTICLES_PER_PAGE</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        int</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> end </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> start </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> ARTICLES_PER_PAGE </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // L·∫•y List ID b√†i vi·∫øt.</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        Set</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> ids </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">zrevrange</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(order, start, end);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        List</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Map</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;&gt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> articles </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> ArrayList</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;&gt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">()</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // L·∫•y th√¥ng tin chi ti·∫øt c·ªßa b√†i vi·∫øt d·ª±a tr√™n ID b√†i vi·∫øt.</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        for</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> id </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">:</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> ids) {</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            Map</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> articleData </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">hgetAll</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(id);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            articleData</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">put</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;id&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, id);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            articles</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">add</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(articleData);</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> articles</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">    }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="phan-nhom-bai-viet" tabindex="-1"><a class="header-anchor" href="#phan-nhom-bai-viet"><span>Ph√¢n nh√≥m b√†i vi·∫øt</span></a></h4><p>N·∫øu b√†i vi·∫øt c·∫ßn ƒë∆∞·ª£c ph√¢n nh√≥m, ch·ª©c nƒÉng s·∫Ω ƒë∆∞·ª£c chia th√†nh hai ph·∫ßn:</p><ul><li>Ghi nh·∫≠n b√†i vi·∫øt thu·ªôc nh√≥m n√†o</li><li>Tr√≠ch xu·∫•t c√°c b√†i vi·∫øt trong nh√≥m</li></ul><p>Th√™m v√† x√≥a nh√≥m cho b√†i vi·∫øt:</p><div class="language-java" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> addRemoveGroups</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Jedis</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> articleId</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">[] toAdd</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">[] toRemove) {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // X√¢y d·ª±ng t√™n kh√≥a ƒë·ªÉ l∆∞u th√¥ng tin b√†i vi·∫øt.</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> article </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> &quot;article:&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> articleId</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // Th√™m b√†i vi·∫øt v√†o c√°c nh√≥m m√† n√≥ thu·ªôc v·ªÅ.</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        for</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> group </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">:</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> toAdd) {</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">sadd</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;group:&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> group, article);</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">        }</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // X√≥a b√†i vi·∫øt kh·ªèi c√°c nh√≥m.</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        for</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> group </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">:</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> toRemove) {</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">srem</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;group:&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> group, article);</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">        }</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">    }</span></span></code></pre></div><p>Tr√≠ch xu·∫•t c√°c b√†i vi·∫øt trong nh√≥m:</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200225214210.jpg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><ul><li>B·∫±ng c√°ch th·ª±c hi·ªán l·ªánh¬†<code>ZINTERSTORE</code>¬†tr√™n t·∫≠p h·ª£p c√°c b√†i vi·∫øt trong nh√≥m v√† t·∫≠p h·ª£p s·∫Øp x·∫øp theo ƒëi·ªÉm s·ªë c·ªßa b√†i vi·∫øt, ch√∫ng ta c√≥ th·ªÉ nh·∫≠n ƒë∆∞·ª£c c√°c b√†i vi·∫øt trong nh√≥m ƒë∆∞·ª£c s·∫Øp x·∫øp theo ƒëi·ªÉm s·ªë.</li><li>B·∫±ng c√°ch th·ª±c hi·ªán l·ªánh¬†<code>ZINTERSTORE</code>¬†tr√™n t·∫≠p h·ª£p c√°c b√†i vi·∫øt trong nh√≥m v√† t·∫≠p h·ª£p s·∫Øp x·∫øp theo th·ªùi gian ƒëƒÉng b√†i vi·∫øt, ch√∫ng ta c√≥ th·ªÉ nh·∫≠n ƒë∆∞·ª£c c√°c b√†i vi·∫øt trong nh√≥m ƒë∆∞·ª£c s·∫Øp x·∫øp theo th·ªùi gian ƒëƒÉng.</li></ul><div class="language-java" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> List</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Map</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> String</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;&gt;</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> getGroupArticles</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Jedis</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> group</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> page</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> order) {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // T·∫°o m·ªôt kh√≥a cho m·ªói th·ª© t·ª± s·∫Øp x·∫øp c·ªßa m·ªói nh√≥m.</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> key </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> order </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> group</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // Ki·ªÉm tra xem c√≥ k·∫øt qu·∫£ s·∫Øp x·∫øp ƒë√£ ƒë∆∞·ª£c l∆∞u tr·ªØ trong b·ªô nh·ªõ cache ch∆∞a, n·∫øu ch∆∞a th√¨ ti·∫øn h√†nh s·∫Øp x·∫øp.</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">exists</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(key)</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            // S·∫Øp x·∫øp c√°c b√†i vi·∫øt trong nh√≥m theo ƒëi·ªÉm s·ªë ho·∫∑c th·ªùi gian ƒëƒÉng b√†i vi·∫øt.</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            ZParams</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> params </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> ZParams</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">()</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">aggregate</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">ZParams</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Aggregate</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">MAX</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">zinterstore</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(key, params, </span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;group:&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> group, order);</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            // ƒê·∫∑t th·ªùi gian t·ªìn t·∫°i c·ªßa t·∫≠p h·ª£p s·∫Øp x·∫øp n√†y l√† 60 gi√¢y.</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">expire</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(key, </span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">60</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">        }</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // G·ªçi h√†m getArticles ƒë√£ ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a tr∆∞·ªõc ƒë√≥ ƒë·ªÉ ph√¢n trang v√† l·∫•y d·ªØ li·ªáu b√†i vi·∫øt.</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> getArticles</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> page</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> key)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">    }</span></span></code></pre></div><h3 id="case-study-quan-ly-token" tabindex="-1"><a class="header-anchor" href="#case-study-quan-ly-token"><span>Case study - Qu·∫£n l√Ω token</span></a></h3><p>Trang web th∆∞·ªùng l∆∞u tr·ªØ th√¥ng tin x√°c th·ª±c ng∆∞·ªùi d√πng d∆∞·ªõi d·∫°ng Cookie, Session, Token v√† c√°c th√¥ng tin t∆∞∆°ng t·ª±.</p><p>C√≥ th·ªÉ l∆∞u tr·ªØ mappinng gi·ªØa Cookie/Session/Token v√† ng∆∞·ªùi d√πng trong c·∫•u tr√∫c HASH.</p><p>D∆∞·ªõi ƒë√¢y l√† v√≠ d·ª• v·ªõi Token.</p><h4 id="kiem-tra-token" tabindex="-1"><a class="header-anchor" href="#kiem-tra-token"><span>Ki·ªÉm tra Token</span></a></h4><div class="language-java" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> checkToken</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Jedis</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> token) {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // Th·ª≠ l·∫•y v√† tr·∫£ v·ªÅ ng∆∞·ªùi d√πng t∆∞∆°ng ·ª©ng v·ªõi token.</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">hget</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;login:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, token);</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">    }</span></span></code></pre></div><h4 id="cap-nhat-token" tabindex="-1"><a class="header-anchor" href="#cap-nhat-token"><span>C·∫≠p nh·∫≠t Token</span></a></h4><ul><li>M·ªói l·∫ßn ng∆∞·ªùi d√πng truy c·∫≠p trang, c√≥ th·ªÉ ghi l·∫°i mapping gi·ªØa token v√† timestamp hi·ªán t·∫°i, l∆∞u v√†o m·ªôt c·∫•u tr√∫c ZSET ƒë·ªÉ ph√¢n t√≠ch xem ng∆∞·ªùi d√πng c√≥ ho·∫°t ƒë·ªông hay kh√¥ng, sau ƒë√≥ c√≥ th·ªÉ ƒë·ªãnh k·ª≥ x√≥a c√°c token c≈© nh·∫•t, th·ªëng k√™ s·ªë ng∆∞·ªùi d√πng ƒëang tr·ª±c tuy·∫øn, v.v.</li><li>N·∫øu ng∆∞·ªùi d√πng ƒëang xem s·∫£n ph·∫©m, c√≥ th·ªÉ ghi l·∫°i c√°c s·∫£n ph·∫©m ƒë√£ xem g·∫ßn ƒë√¢y v√†o m·ªôt c·∫•u tr√∫c ZSET (c√≥ th·ªÉ gi·ªõi h·∫°n s·ªë l∆∞·ª£ng, v∆∞·ª£t qu√° s·ªë l∆∞·ª£ng s·∫Ω b·ªã c·∫Øt b·ªè), l∆∞u v√†o m·ªôt c·∫•u tr√∫c ZSET ƒë·ªÉ ph√¢n t√≠ch xem ng∆∞·ªùi d√πng c√≥ th·ªÉ quan t√¢m ƒë·∫øn s·∫£n ph·∫©m n√†o g·∫ßn ƒë√¢y, t·ª´ ƒë√≥ c√≥ th·ªÉ g·ª£i √Ω s·∫£n ph·∫©m.</li></ul><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> updateToken</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Jedis</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> token</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> user</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> item) {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // L·∫•y timestamp hi·ªán t·∫°i.</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        long</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> timestamp </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> System</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">currentTimeMillis</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> /</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 1000</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // L∆∞u mapping gi·ªØa token v√† ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p.</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">hset</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;login:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, token, user);</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // Ghi l·∫°i th·ªùi gian xu·∫•t hi·ªán cu·ªëi c√πng c·ªßa token.</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">zadd</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;recent:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, timestamp, token);</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (item </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">!=</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            // Ghi l·∫°i c√°c s·∫£n ph·∫©m ng∆∞·ªùi d√πng ƒë√£ xem.</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">zadd</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;viewed:&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> token, timestamp, item);</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            // X√≥a c√°c b·∫£n ghi c≈©, ch·ªâ gi·ªØ l·∫°i 25 s·∫£n ph·∫©m ng∆∞·ªùi d√πng ƒë√£ xem g·∫ßn ƒë√¢y nh·∫•t.</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">zremrangeByRank</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;viewed:&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> token, </span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">26</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">zincrby</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;viewed:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, item);</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">        }</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">    }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="xoa-token" tabindex="-1"><a class="header-anchor" href="#xoa-token"><span>X√≥a Token</span></a></h4><p>Nh∆∞ ƒë√£ ƒë·ªÅ c·∫≠p ·ªü ph·∫ßn tr∆∞·ªõc, khi c·∫≠p nh·∫≠t token, mapping gi·ªØa token v√† timestamp hi·ªán t·∫°i ƒë∆∞·ª£c l∆∞u v√†o c·∫•u tr√∫c ZSET. Do ƒë√≥, c√≥ th·ªÉ bi·∫øt ƒë∆∞·ª£c nh·ªØng token n√†o l√† c≈© nh·∫•t. N·∫øu kh√¥ng x√≥a, vi·ªác c·∫≠p nh·∫≠t token s·∫Ω ti·∫øp t·ª•c chi·∫øm d·ª•ng b·ªô nh·ªõ cho ƒë·∫øn khi g√¢y ra s·ª± c·ªë.</p><p>V√≠ d·ª•: Cho ph√©p l∆∞u tr·ªØ t·ªëi ƒëa 10 tri·ªáu th√¥ng tin token, ki·ªÉm tra ƒë·ªãnh k·ª≥, n·∫øu s·ªë l∆∞·ª£ng token v∆∞·ª£t qu√° 10 tri·ªáu, s·∫Øp x·∫øp ZSET t·ª´ m·ªõi ƒë·∫øn c≈© v√† x√≥a c√°c th√¥ng tin v∆∞·ª£t qu√° 10 tri·ªáu.</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> CleanSessionsThread</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> extends</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> Thread</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> Jedis</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> limit</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> volatile</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> boolean</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> quit</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> CleanSessionsThread</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> limit</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        this</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">conn</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> Jedis</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;localhost&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        this</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">select</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">15</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        this</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">limit</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> limit;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> quit</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">        quit </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Override</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> run</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        while</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">quit) {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            // L·∫•y s·ªë l∆∞·ª£ng token hi·ªán c√≥.</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            long</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> size</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">zcard</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;recent:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            // N·∫øu s·ªë l∆∞·ª£ng token kh√¥ng v∆∞·ª£t qu√° gi·ªõi h·∫°n, ng·ªß v√† ki·ªÉm tra l·∫°i sau.</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            if</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> (size </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;=</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> limit) {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">                try</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">                    sleep</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">                } </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">InterruptedException</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> ie</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">                    Thread</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">currentThread</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">interrupt</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">                }</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">                continue</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">            }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            // L·∫•y c√°c token c·∫ßn x√≥a.</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            long</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> endIndex</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> Math</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">min</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(size </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> limit, </span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">100</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            Set</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">tokenSet</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">zrange</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;recent:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, endIndex </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[] </span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">tokens</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> tokenSet</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">toArray</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">tokenSet</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">size</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">()]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            // X√¢y d·ª±ng c√°c key cho c√°c token s·∫Ω b·ªã x√≥a.</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            ArrayList</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">sessionKeys</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> ArrayList</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;();</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            for</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> token</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> :</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> tokens) {</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">                sessionKeys</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">add</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;viewed:&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> token);</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">            }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            // X√≥a c√°c token c≈© nh·∫•t.</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">del</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">sessionKeys</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">toArray</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">sessionKeys</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">size</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">()]));</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">hdel</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;login:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, tokens);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">zrem</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;recent:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, tokens);</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="case-study-gio-hang" tabindex="-1"><a class="header-anchor" href="#case-study-gio-hang"><span>Case study - Gi·ªè h√†ng</span></a></h3><p>C√≥ th·ªÉ s·ª≠ d·ª•ng c·∫•u tr√∫c HASH ƒë·ªÉ tri·ªÉn khai ch·ª©c nƒÉng gi·ªè h√†ng.</p><p>M·ªói gi·ªè h√†ng c·ªßa ng∆∞·ªùi d√πng l∆∞u tr·ªØ √°nh x·∫° gi·ªØa ID s·∫£n ph·∫©m v√† s·ªë l∆∞·ª£ng s·∫£n ph·∫©m.</p><h4 id="them-va-xoa-san-pham-trong-gio-hang" tabindex="-1"><a class="header-anchor" href="#them-va-xoa-san-pham-trong-gio-hang"><span>Th√™m v√† x√≥a s·∫£n ph·∫©m trong gi·ªè h√†ng</span></a></h4><div class="language-java" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> addToCart</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Jedis</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> session</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> item</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> count) {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (count </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;=</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            // X√≥a s·∫£n ph·∫©m c·ª• th·ªÉ kh·ªèi gi·ªè h√†ng.</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">hdel</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;cart:&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> session, item);</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">        } </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            // Th√™m s·∫£n ph·∫©m c·ª• th·ªÉ v√†o gi·ªè h√†ng.</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">hset</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;cart:&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> session, item, </span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">valueOf</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(count));</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">        }</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">    }</span></span></code></pre></div><h4 id="xoa-toan-bo-gio-hang" tabindex="-1"><a class="header-anchor" href="#xoa-toan-bo-gio-hang"><span>X√≥a to√†n b·ªô gi·ªè h√†ng</span></a></h4><p>D·ª±a tr√™n <a href="#x%C3%B3a-token">X√≥a Token</a>, khi x√≥a phi√™n l√†m vi·ªác, c≈©ng x√≥a lu√¥n gi·ªè h√†ng.</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">   while</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">quit) {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        long</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> size </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">zcard</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;recent:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (size </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;=</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> limit) {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            try</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> {</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">                sleep</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">            } </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">InterruptedException</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> ie</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">                Thread</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">currentThread</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">interrupt</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">            }</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            continue</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        long</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> endIndex </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> Math</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">min</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(size </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> limit, </span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">100</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        Set</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> sessionSet </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">zrange</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;recent:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, endIndex </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">[] sessions </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> sessionSet</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">toArray</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">sessionSet</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">size</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">()]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        ArrayList</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> sessionKeys </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> ArrayList</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">()</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        for</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> sess </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">:</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> sessions) {</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            sessionKeys</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">add</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;viewed:&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> sess);</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            // D√≤ng code m·ªõi ƒë∆∞·ª£c th√™m v√†o ƒë·ªÉ x√≥a gi·ªè h√†ng c·ªßa ng∆∞·ªùi d√πng t∆∞∆°ng ·ª©ng v·ªõi phi√™n l√†m vi·ªác c≈©.</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            sessionKeys</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">add</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;cart:&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> sess);</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">del</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">sessionKeys</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">toArray</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">sessionKeys</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">size</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">()]));</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">hdel</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;login:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, sessions);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">zrem</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;recent:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, sessions);</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">    }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="case-study-bo-nho-cache-trang-web" tabindex="-1"><a class="header-anchor" href="#case-study-bo-nho-cache-trang-web"><span>Case study - B·ªô nh·ªõ cache trang web</span></a></h3><p>H·∫ßu h·∫øt n·ªôi dung trang web kh√¥ng thay ƒë·ªïi th∆∞·ªùng xuy√™n, nh∆∞ng khi truy c·∫≠p, ph√≠a m√°y ch·ªß c·∫ßn t√≠nh to√°n ƒë·ªông, ƒëi·ªÅu n√†y c√≥ th·ªÉ t·ªën th·ªùi gian. Trong tr∆∞·ªùng h·ª£p n√†y, c√≥ th·ªÉ s·ª≠ d·ª•ng c·∫•u tr√∫c <code>STRING</code> ƒë·ªÉ l∆∞u tr·ªØ b·ªô nh·ªõ cache trang web.</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> cacheRequest</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Jedis</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> request</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> Callback</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> callback) {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // ƒê·ªëi v·ªõi c√°c y√™u c·∫ßu kh√¥ng th·ªÉ ƒë∆∞·ª£c l∆∞u v√†o b·ªô nh·ªõ cache, g·ªçi h√†m callback tr·ª±c ti·∫øp.</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">canCache</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> request)) {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            return</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> callback </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">!=</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> ?</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> callback</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">call</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(request)</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> :</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // Chuy·ªÉn ƒë·ªïi y√™u c·∫ßu th√†nh m·ªôt kh√≥a chu·ªói ƒë∆°n gi·∫£n ƒë·ªÉ d·ªÖ d√†ng t√¨m ki·∫øm sau n√†y.</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> pageKey </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> &quot;cache:&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> hashRequest</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(request)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // Th·ª≠ t√¨m trang web ƒë√£ ƒë∆∞·ª£c l∆∞u trong b·ªô nh·ªõ cache.</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> content </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(pageKey);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (content </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> &amp;&amp;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> callback </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">!=</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            // N·∫øu trang web ch∆∞a ƒë∆∞·ª£c l∆∞u trong b·ªô nh·ªõ cache, t·∫°o trang web.</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">            content </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> callback</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">call</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(request);</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            // L∆∞u trang web m·ªõi t·∫°o v√†o b·ªô nh·ªõ cache.</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">setex</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(pageKey, </span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">300</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, content);</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // Tr·∫£ v·ªÅ n·ªôi dung trang web.</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> content</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">    }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="case-study-bo-nho-cache-dong-du-lieu" tabindex="-1"><a class="header-anchor" href="#case-study-bo-nho-cache-dong-du-lieu"><span>Case study - B·ªô nh·ªõ cache d√≤ng d·ªØ li·ªáu</span></a></h3><p>C√°c trang web th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠ c√≥ th·ªÉ c√≥ c√°c ho·∫°t ƒë·ªông khuy·∫øn m√£i, gi·∫£m gi√°, r√∫t thƒÉm may m·∫Øn, v.v. Nh·ªØng trang web n√†y ch·ªâ c·∫ßn t·∫£i v√†i d√≤ng d·ªØ li·ªáu t·ª´ c∆° s·ªü d·ªØ li·ªáu, ch·∫≥ng h·∫°n nh∆∞ th√¥ng tin ng∆∞·ªùi d√πng, th√¥ng tin s·∫£n ph·∫©m.</p><p>C√≥ th·ªÉ s·ª≠ d·ª•ng c·∫•u tr√∫c STRING ƒë·ªÉ l∆∞u tr·ªØ b·ªô nh·ªõ cache cho c√°c d√≤ng d·ªØ li·ªáu n√†y, s·ª≠ d·ª•ng JSON ƒë·ªÉ l∆∞u tr·ªØ th√¥ng tin c√≥ c·∫•u tr√∫c.</p><p>Ngo√†i ra, c·∫ßn c√≥ hai c·∫•u tr√∫c ZSET ƒë·ªÉ ghi l·∫°i th·ªùi ƒëi·ªÉm c·∫≠p nh·∫≠t b·ªô nh·ªõ cache:</p><ul><li>C·∫•u tr√∫c ZSET th·ª© nh·∫•t l√† t·∫≠p h·ª£p l·ªãch tr√¨nh;</li><li>C·∫•u tr√∫c ZSET th·ª© hai l√† t·∫≠p h·ª£p tr·ªÖ.</li></ul><p>Ghi l·∫°i th·ªùi ƒëi·ªÉm c·∫≠p nh·∫≠t b·ªô nh·ªõ cache:</p><div class="language-java" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> scheduleRowCache</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Jedis</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> rowId</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> delay) {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // ƒê·∫∑t gi√° tr·ªã tr·ªÖ cho d√≤ng d·ªØ li·ªáu.</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">zadd</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;delay:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, delay, rowId);</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // L·∫≠p l·ªãch c·∫≠p nh·∫≠t b·ªô nh·ªõ cache cho d√≤ng d·ªØ li·ªáu.</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">zadd</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;schedule:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">System</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">currentTimeMillis</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 1000</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, rowId);</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">    }</span></span></code></pre></div><p>C·∫≠p nh·∫≠t b·ªô nh·ªõ cache d√≤ng d·ªØ li·ªáu theo ƒë·ªãnh k·ª≥:</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> CacheRowsThread</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> extends</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> Thread</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> Jedis</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> boolean</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> quit</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> CacheRowsThread</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        this</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">conn</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> Jedis</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;localhost&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        this</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">select</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">15</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> quit</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">        quit </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Override</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> run</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        Gson</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> gson</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> Gson</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        while</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">quit) {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            // Th·ª≠ l·∫•y d√≤ng d·ªØ li·ªáu ti·∫øp theo c·∫ßn ƒë∆∞·ª£c c·∫≠p nh·∫≠t v√† th·ªùi ƒëi·ªÉm l√™n l·ªãch c·ªßa n√≥,</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            // L·ªánh s·∫Ω tr·∫£ v·ªÅ m·ªôt List ch·ª©a m·ªôt ho·∫∑c kh√¥ng c√≥ c·∫∑p (tuple).</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            Set</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Tuple</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">range</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">zrangeWithScores</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;schedule:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            Tuple</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> next</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> range</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">size</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> ?</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> range</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">iterator</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">next</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">:</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            long</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> now</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> System</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">currentTimeMillis</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 1000</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            if</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> (next </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> ||</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> next</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">getScore</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> now) {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">                try</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">                    // T·∫°m th·ªùi kh√¥ng c√≥ d√≤ng d·ªØ li·ªáu c·∫ßn ƒë∆∞·ª£c c·∫≠p nh·∫≠t, ng·ªß 50ms v√† th·ª≠ l·∫°i.</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">                    sleep</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">50</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">                } </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">InterruptedException</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> ie</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">                    Thread</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">currentThread</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">interrupt</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">                }</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">                continue</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">            }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> rowId</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> next</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">getElement</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            // L·∫•y th·ªùi gian tr·ªÖ tr∆∞·ªõc l·∫ßn c·∫≠p nh·∫≠t ti·∫øp theo.</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            double</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> delay</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">zscore</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;delay:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, rowId);</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            if</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> (delay </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;=</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">                // Kh√¥ng c·∫ßn c·∫≠p nh·∫≠t d√≤ng d·ªØ li·ªáu n√†y n·ªØa, x√≥a n√≥ kh·ªèi b·ªô nh·ªõ cache.</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">                conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">zrem</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;delay:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, rowId);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">                conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">zrem</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;schedule:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, rowId);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">                conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">del</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;inv:&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> rowId);</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">                continue</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">            }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            // ƒê·ªçc d√≤ng d·ªØ li·ªáu.</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            Inventory</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> row</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> Inventory</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(rowId);</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            // C·∫≠p nh·∫≠t th·ªùi gian l√™n l·ªãch v√† ƒë·∫∑t gi√° tr·ªã b·ªô nh·ªõ cache.</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">zadd</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;schedule:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, now </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> delay, rowId);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">set</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;inv:&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> rowId, </span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">gson</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">toJson</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(row));</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="case-study-phan-tich-trang-web" tabindex="-1"><a class="header-anchor" href="#case-study-phan-tich-trang-web"><span>Case study - Ph√¢n t√≠ch trang web</span></a></h3><p>Trang web c√≥ th·ªÉ thu th·∫≠p h√†nh vi truy c·∫≠p, t∆∞∆°ng t√°c v√† mua h√†ng c·ªßa ng∆∞·ªùi d√πng, sau ƒë√≥ ph√¢n t√≠ch th√≥i quen v√† s·ªü th√≠ch c·ªßa ng∆∞·ªùi d√πng ƒë·ªÉ ƒë√°nh gi√° t√¨nh h√¨nh th·ªã tr∆∞·ªùng v√† c∆° h·ªôi nghi·ªáp v·ª• ti·ªÅm nƒÉng.</p><p>V·∫≠y l√†m th·∫ø n√†o ƒë·ªÉ ghi l·∫°i c√°c trang s·∫£n ph·∫©m m√† ng∆∞·ªùi d√πng ƒë√£ truy c·∫≠p trong m·ªôt kho·∫£ng th·ªùi gian nh·∫•t ƒë·ªãnh?</p><p>Tham kh·∫£o v√≠ d·ª• m√£ code <a href="#c%E1%BA%ADp-nh%E1%BA%ADt-token">C·∫≠p nh·∫≠t Token</a>, ghi l·∫°i s·ªë l·∫ßn truy c·∫≠p c·ªßa ng∆∞·ªùi d√πng v√†o c√°c trang s·∫£n ph·∫©m kh√°c nhau v√† s·∫Øp x·∫øp ch√∫ng.</p><p>ƒê·ªÉ x√°c ƒë·ªãnh xem trang c√≥ c·∫ßn ƒë∆∞·ª£c l∆∞u v√†o b·ªô nh·ªõ cache hay kh√¥ng, d·ª±a tr√™n ƒëi·ªÉm ƒë√°nh gi√° ƒë·ªÉ x√°c ƒë·ªãnh xem trang s·∫£n ph·∫©m c√≥ ph·ªï bi·∫øn hay kh√¥ng:</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> boolean</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> canCache</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Jedis</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> request) {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        try</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> {</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            URL</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> url </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> URL</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(request)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            HashMap</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> params </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> HashMap</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;&gt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">()</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            if</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">url</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">getQuery</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> !=</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">                for</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> param </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">:</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> url</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">getQuery</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">split</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;&amp;&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">                    String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">[] pair </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> param</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">split</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;=&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">                    params</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">put</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(pair[</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">pair</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">length</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> ?</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> pair[</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">:</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">                }</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">            }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            // Th·ª≠ l·∫•y ID s·∫£n ph·∫©m t·ª´ trang.</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> itemId </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> extractItemId</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(params)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            // Ki·ªÉm tra xem trang n√†y c√≥ th·ªÉ ƒë∆∞·ª£c l∆∞u v√†o b·ªô nh·ªõ cache v√† c√≥ ph·∫£i l√† trang s·∫£n ph·∫©m hay kh√¥ng.</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            if</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (itemId </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> ||</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> isDynamic</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(params)) {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">                return</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> false</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">            }</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            // L·∫•y x·∫øp h·∫°ng s·ªë l·∫ßn xem c·ªßa s·∫£n ph·∫©m.</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            Long</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> rank </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">zrank</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;viewed:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, itemId);</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            // D·ª±a tr√™n x·∫øp h·∫°ng s·ªë l·∫ßn xem c·ªßa s·∫£n ph·∫©m ƒë·ªÉ x√°c ƒë·ªãnh xem trang n√†y c√≥ c·∫ßn ƒë∆∞·ª£c l∆∞u v√†o b·ªô nh·ªõ cache hay kh√¥ng.</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            return</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> rank </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">!=</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> &amp;&amp;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> rank </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 10000</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">        } </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">MalformedURLException</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> mue</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            return</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> false</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">        }</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">    }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="case-study-ghi-log" tabindex="-1"><a class="header-anchor" href="#case-study-ghi-log"><span>Case study - Ghi log</span></a></h3><p>C√≥ th·ªÉ s·ª≠ d·ª•ng c·∫•u tr√∫c LIST ƒë·ªÉ l∆∞u tr·ªØ d·ªØ li·ªáu nh·∫≠t k√Ω (log).</p><div class="language-java" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> logRecent</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Jedis</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> name</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> message</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> severity) {</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> destination </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> &quot;recent:&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> name </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> &#39;:&#39;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> severity</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        Pipeline</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> pipe </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">pipelined</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        pipe</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">lpush</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(destination, </span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">TIMESTAMP</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">format</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> Date</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">()) </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> &#39; &#39;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> message);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        pipe</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">ltrim</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(destination, </span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">99</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        pipe</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">sync</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">    }</span></span></code></pre></div><h3 id="case-study-thong-ke-du-lieu" tabindex="-1"><a class="header-anchor" href="#case-study-thong-ke-du-lieu"><span>Case study - Th·ªëng k√™ d·ªØ li·ªáu</span></a></h3><p>C·∫≠p nh·∫≠t b·ªô ƒë·∫øm:</p><div class="language-java" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> final</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">[] PRECISION </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">[] { </span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 5</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 60</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 300</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 3600</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 18000</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 86400</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> }</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> updateCounter</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Jedis</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> name</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> count</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> long</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> now) {</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        Transaction</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> trans </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">multi</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        for</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> prec </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">:</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> PRECISION) {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            long</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> pnow </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (now </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> prec) </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">*</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> prec</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> hash </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">valueOf</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(prec)</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> &#39;:&#39;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> name</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            trans</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">zadd</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;known:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, hash);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            trans</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">hincrBy</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;count:&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> hash, </span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">valueOf</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(pnow), count);</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">        }</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        trans</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">exec</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">    }</span></span></code></pre></div><p>Xem d·ªØ li·ªáu b·ªô ƒë·∫øm:</p><div class="language-java" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> List</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Pair</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">Integer</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;&gt;</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> getCounter</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        Jedis</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> name</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> precision) {</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> hash </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">valueOf</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(precision)</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> &#39;:&#39;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> name</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        Map</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> data </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">hgetAll</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;count:&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> hash);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        List</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Pair</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;&gt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> results </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> ArrayList</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;&gt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">()</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        for</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Map</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Entry</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> entry </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">:</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">entrySet</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            results</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">add</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> Pair</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;&gt;(</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">                entry</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">getKey</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(),</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">                Integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">parseInt</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">entry</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">getValue</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">())));</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">        }</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        Collections</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">sort</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(results);</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> results</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">    }</span></span></code></pre></div><h3 id="case-study-tim-ƒëia-chi-ip-thuoc-ve-ƒëau" tabindex="-1"><a class="header-anchor" href="#case-study-tim-ƒëia-chi-ip-thuoc-ve-ƒëau"><span>Case study - T√¨m ƒë·ªãa ch·ªâ IP thu·ªôc v·ªÅ ƒë√¢u</span></a></h3><p>T√¨m ƒë·ªãa ch·ªâ IP thu·ªôc v·ªÅ ƒë√¢u b·∫±ng c√°ch s·ª≠ d·ª•ng Redis nhanh h∆°n so v·ªõi c√°ch th·ª±c hi·ªán tr√™n c∆° s·ªü d·ªØ li·ªáu quan h·ªá.</p><h4 id="tai-du-lieu-ip" tabindex="-1"><a class="header-anchor" href="#tai-du-lieu-ip"><span>T·∫£i d·ªØ li·ªáu IP</span></a></h4><p>Chuy·ªÉn ƒë·ªïi ƒë·ªãa ch·ªâ IP th√†nh gi√° tr·ªã s·ªë nguy√™n:</p><div class="language-java" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> ipToScore</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> ipAddress) {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        int</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> score </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        for</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> v </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">:</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> ipAddress</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">split</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">\\</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">.&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">            score </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> score </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">*</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 256</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> Integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">parseInt</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(v, </span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">        }</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> score</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">    }</span></span></code></pre></div><p>T·∫°o √°nh x·∫° gi·ªØa ƒë·ªãa ch·ªâ IP v√† ID th√†nh ph·ªë:</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> importIpsToRedis</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Jedis</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> File</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> file) {</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        FileReader</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> reader </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        try</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            // T·∫£i d·ªØ li·ªáu t·ª´ t·ªáp csv</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">            reader </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> FileReader</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(file)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            CSVFormat</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> csvFormat </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> CSVFormat</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">DEFAULT</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">withRecordSeparator</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            CSVParser</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> csvParser </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> csvFormat</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">parse</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(reader);</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            int</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> count </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            List</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">CSVRecord</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> records </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> csvParser</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">getRecords</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            for</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">CSVRecord</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> line </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">:</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> records) {</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">                String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> startIp </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> line</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">                if</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">startIp</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">toLowerCase</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">indexOf</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&#39;i&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> !=</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">                    continue</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">                }</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">                // Chuy·ªÉn ƒë·ªïi ƒë·ªãa ch·ªâ IP th√†nh gi√° tr·ªã s·ªë nguy√™n</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">                int</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> score </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">                if</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">startIp</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">indexOf</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&#39;.&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> !=</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">                    score </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> ipToScore</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(startIp)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">                } </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">                    try</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> {</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">                        score </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> Integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">parseInt</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(startIp, </span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">                    } </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">NumberFormatException</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> nfe</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">                        // B·ªè qua d√≤ng ƒë·∫ßu ti√™n c·ªßa t·ªáp v√† c√°c m·ª•c kh√¥ng ƒë√∫ng ƒë·ªãnh d·∫°ng</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">                        continue</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">                    }</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">                }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">                // X√¢y d·ª±ng ID th√†nh ph·ªë duy nh·∫•t</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">                String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> cityId </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> line</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> &#39;_&#39;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> count</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">                // Th√™m ID th√†nh ph·ªë v√† gi√° tr·ªã s·ªë nguy√™n t∆∞∆°ng ·ª©ng c·ªßa ƒë·ªãa ch·ªâ IP v√†o ZSET</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">                conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">zadd</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;ip2cityid:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, score, cityId);</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">                count</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">++;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">            }</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">        } </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Exception</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> e</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            throw</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> RuntimeException</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(e)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">        } </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">finally</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            try</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> {</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">                reader</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">close</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">            } </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Exception</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> e</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">                // b·ªè qua</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">            }</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">        }</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">    }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>L∆∞u tr·ªØ th√¥ng tin th√†nh ph·ªë:</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> importCitiesToRedis</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Jedis</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> File</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> file) {</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        Gson</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> gson </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> Gson</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">()</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        FileReader</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> reader </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        try</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            // T·∫£i th√¥ng tin t·ª´ t·ªáp csv</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">            reader </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> FileReader</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(file)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            CSVFormat</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> csvFormat </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> CSVFormat</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">DEFAULT</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">withRecordSeparator</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            CSVParser</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> parser </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> CSVParser</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(reader</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> csvFormat)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            // String[] line;</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            List</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">CSVRecord</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> records </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> parser</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">getRecords</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            for</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">CSVRecord</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> record </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">:</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> records) {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">                if</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">record</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">size</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> &lt;</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> ||</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> !</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Character</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">isDigit</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">record</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">charAt</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">))</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">                    continue</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">                }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">                // Chuy·ªÉn ƒë·ªïi th√¥ng tin ƒë·ªãa l√Ω th√†nh c·∫•u tr√∫c json v√† l∆∞u v√†o HASH</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">                String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> cityId </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> record</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">                String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> country </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> record</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">                String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> region </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> record</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">                String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> city </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> record</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">                String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> json </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> gson</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">toJson</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[] { city, region, country });</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">                conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">hset</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;cityid2city:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, cityId, json);</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">            }</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">        } </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Exception</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> e</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            throw</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> RuntimeException</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(e)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">        } </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">finally</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            try</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> {</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">                reader</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">close</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">            } </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Exception</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> e</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">                // b·ªè qua</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">            }</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">        }</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">    }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="tim-ƒëia-chi-ip-thuoc-ve-thanh-pho-nao" tabindex="-1"><a class="header-anchor" href="#tim-ƒëia-chi-ip-thuoc-ve-thanh-pho-nao"><span>T√¨m ƒë·ªãa ch·ªâ IP thu·ªôc v·ªÅ th√†nh ph·ªë n√†o</span></a></h4><p>C√°c b∆∞·ªõc th·ª±c hi·ªán:</p><ol><li>Chuy·ªÉn ƒë·ªïi ƒë·ªãa ch·ªâ IP c·∫ßn t√¨m th√†nh gi√° tr·ªã s·ªë nguy√™n;</li><li>T√¨m t·∫•t c·∫£ c√°c ƒë·ªãa ch·ªâ c√≥ ƒëi·ªÉm s·ªë nh·ªè h∆°n ho·∫∑c b·∫±ng ƒë·ªãa ch·ªâ IP c·∫ßn t√¨m, l·∫•y ra b·∫£n ghi c√≥ ƒëi·ªÉm s·ªë l·ªõn nh·∫•t;</li><li>S·ª≠ d·ª•ng ID th√†nh ph·ªë t√¨m th·∫•y ƒë·ªÉ truy v·∫•n th√¥ng tin th√†nh ph·ªë.</li></ol><div class="language-java" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">[] </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">findCityByIp</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Jedis</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> ipAddress) {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        int</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> score </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> ipToScore</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(ipAddress)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        Set</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> results </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">zrevrangeByScore</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;ip2cityid:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, score, </span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">results</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">size</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            return</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> cityId </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> results</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">iterator</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">next</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">        cityId </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> cityId</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">substring</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">cityId</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">indexOf</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&#39;_&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> Gson</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">()</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">fromJson</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">conn</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">hget</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;cityid2city:&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, cityId), </span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[].</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">class</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">    }</span></span></code></pre></div><h3 id="case-study-phat-hien-va-cau-hinh-dich-vu" tabindex="-1"><a class="header-anchor" href="#case-study-phat-hien-va-cau-hinh-dich-vu"><span>Case study - Ph√°t hi·ªán v√† c·∫•u h√¨nh d·ªãch v·ª•</span></a></h3><h3 id="case-study-tu-ƒëong-hoan-chinh" tabindex="-1"><a class="header-anchor" href="#case-study-tu-ƒëong-hoan-chinh"><span>Case study - T·ª± ƒë·ªông ho√†n ch·ªânh</span></a></h3><p>Y√™u c·∫ßu: T·ª± ƒë·ªông ho√†n ch·ªânh th√¥ng tin d·ª±a tr√™n ƒë·∫ßu v√†o c·ªßa ng∆∞·ªùi d√πng, v√≠ d·ª•: t√™n li√™n l·∫°c, t√™n s·∫£n ph·∫©m, v.v.</p><ul><li>T√¨nh hu·ªëng ƒëi·ªÉn h√¨nh 1: H·ªá th·ªëng m·∫°ng x√£ h·ªôi ghi l·∫°i 100 ng∆∞·ªùi b·∫°n g·∫ßn ƒë√¢y nh·∫•t m√† ng∆∞·ªùi d√πng ƒë√£ li√™n l·∫°c, khi ng∆∞·ªùi d√πng t√¨m ki·∫øm b·∫°n b√®, t·ª± ƒë·ªông ho√†n ch·ªânh t√™n d·ª±a tr√™n t·ª´ kh√≥a nh·∫≠p v√†o.</li><li>T√¨nh hu·ªëng ƒëi·ªÉn h√¨nh 2: H·ªá th·ªëng th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠ ghi l·∫°i 10 s·∫£n ph·∫©m m√† ng∆∞·ªùi d√πng ƒë√£ xem g·∫ßn ƒë√¢y, khi ng∆∞·ªùi d√πng t√¨m ki·∫øm s·∫£n ph·∫©m, t·ª± ƒë·ªông ho√†n ch·ªânh t√™n s·∫£n ph·∫©m d·ª±a tr√™n t·ª´ kh√≥a nh·∫≠p v√†o.</li></ul><p>M√¥ h√¨nh d·ªØ li·ªáu: S·ª≠ d·ª•ng ki·ªÉu d·ªØ li·ªáu LIST c·ªßa Redis ƒë·ªÉ l∆∞u tr·ªØ List li√™n l·∫°c g·∫ßn ƒë√¢y.</p><p>X√¢y d·ª±ng List ho√†n ch·ªânh t·ª± ƒë·ªông th∆∞·ªùng bao g·ªìm c√°c ho·∫°t ƒë·ªông sau:</p><ul><li>N·∫øu ng∆∞·ªùi li√™n h·ªá ƒë√£ ƒë∆∞·ª£c ch·ªâ ƒë·ªãnh t·ªìn t·∫°i trong List li√™n l·∫°c g·∫ßn ƒë√¢y, h√£y lo·∫°i b·ªè n√≥ kh·ªèi List. T∆∞∆°ng ·ª©ng v·ªõi l·ªánh¬†<code>LREM</code>.</li><li>Th√™m ng∆∞·ªùi li√™n h·ªá ƒë√£ ch·ªâ ƒë·ªãnh v√†o ƒë·∫ßu List li√™n l·∫°c g·∫ßn ƒë√¢y. T∆∞∆°ng ·ª©ng v·ªõi l·ªánh¬†<code>LPUSH</code>.</li><li>Sau khi ho·∫°t ƒë·ªông th√™m ƒë√£ ho√†n th√†nh, n·∫øu s·ªë l∆∞·ª£ng ng∆∞·ªùi li√™n h·ªá trong List v∆∞·ª£t qu√° 100, th·ª±c hi·ªán c·∫Øt t·ªâa. T∆∞∆°ng ·ª©ng v·ªõi l·ªánh¬†<code>LTRIM</code>.</li></ul><h3 id="case-study-ƒëinh-huong-quang-cao" tabindex="-1"><a class="header-anchor" href="#case-study-ƒëinh-huong-quang-cao"><span>Case study - ƒê·ªãnh h∆∞·ªõng qu·∫£ng c√°o</span></a></h3><h3 id="case-study-tim-kiem-vi-tri-cong-viec" tabindex="-1"><a class="header-anchor" href="#case-study-tim-kiem-vi-tri-cong-viec"><span>Case study - T√¨m ki·∫øm v·ªã tr√≠ c√¥ng vi·ªác</span></a></h3><p>Y√™u c·∫ßu: Tr√™n m·ªôt trang web tuy·ªÉn d·ª•ng, ng∆∞·ªùi t√¨m vi·ªác c√≥ m·ªôt List k·ªπ nƒÉng c·ªßa ri√™ng m√¨nh; c√°c c√¥ng ty tuy·ªÉn d·ª•ng c√≥ m·ªôt List k·ªπ nƒÉng c·∫ßn thi·∫øt cho v·ªã tr√≠ c√¥ng vi·ªác. C√°c c√¥ng ty tuy·ªÉn d·ª•ng c·∫ßn t√¨m ki·∫øm ng∆∞·ªùi t√¨m vi·ªác ph√π h·ª£p v·ªõi y√™u c·∫ßu c√¥ng vi·ªác c·ªßa m√¨nh; ng∆∞·ªùi t√¨m vi·ªác c·∫ßn t√¨m ki·∫øm c√°c v·ªã tr√≠ c√¥ng vi·ªác m√† m√¨nh c√≥ th·ªÉ n·ªôp ƒë∆°n.</p><p>M√¥ h√¨nh d·ªØ li·ªáu quan tr·ªçng: S·ª≠ d·ª•ng ki·ªÉu d·ªØ li·ªáu <code>SET</code> ƒë·ªÉ l∆∞u tr·ªØ List k·ªπ nƒÉng c·ªßa ng∆∞·ªùi t√¨m vi·ªác v√† List k·ªπ nƒÉng c·ªßa v·ªã tr√≠ c√¥ng vi·ªác.</p><p>Ho·∫°t ƒë·ªông quan tr·ªçng: S·ª≠ d·ª•ng l·ªánh <code>SDIFF</code> ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa hai <code>SET</code>, tr·∫£ v·ªÅ <code>empty</code> n·∫øu ƒë√°p ·ª©ng y√™u c·∫ßu.</p><p>V√≠ d·ª• s·ª≠ d·ª•ng Redis CLI:</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># -----------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># M√¥ h√¨nh d·ªØ li·ªáu t√¨m ki·∫øm v·ªã tr√≠ c√¥ng vi·ªác trong Redis</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># -----------------------------------------------------------</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># (1) B·∫£ng k·ªπ nƒÉng v·ªã tr√≠ c√¥ng vi·ªác: L∆∞u tr·ªØ b·∫±ng ki·ªÉu d·ªØ li·ªáu SET</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># C√¥ng vi·ªác job:001 y√™u c·∫ßu 4 k·ªπ nƒÉng</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SADD</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> job:001</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> skill:001</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SADD</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> job:001</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> skill:002</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SADD</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> job:001</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> skill:003</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SADD</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> job:001</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> skill:004</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># C√¥ng vi·ªác job:002 y√™u c·∫ßu 3 k·ªπ nƒÉng</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SADD</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> job:002</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> skill:001</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SADD</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> job:002</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> skill:002</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SADD</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> job:002</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> skill:003</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># C√¥ng vi·ªác job:003 y√™u c·∫ßu 2 k·ªπ nƒÉng</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SADD</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> job:003</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> skill:001</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SADD</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> job:003</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> skill:003</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Xem List k·ªπ nƒÉng</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SMEMBERS</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> job:001</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SMEMBERS</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> job:002</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SMEMBERS</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> job:003</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># (2) B·∫£ng k·ªπ nƒÉng c·ªßa ng∆∞·ªùi t√¨m vi·ªác: L∆∞u tr·ªØ b·∫±ng ki·ªÉu d·ªØ li·ªáu SET</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SADD</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> interviewee:001</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> skill:001</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SADD</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> interviewee:001</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> skill:003</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SADD</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> interviewee:002</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> skill:001</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SADD</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> interviewee:002</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> skill:002</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SADD</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> interviewee:002</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> skill:003</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SADD</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> interviewee:002</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> skill:004</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SADD</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> interviewee:002</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> skill:005</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Xem List k·ªπ nƒÉng</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SMEMBERS</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> interviewee:001</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SMEMBERS</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> interviewee:002</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># (3) Ng∆∞·ªùi t√¨m vi·ªác t√¨m ki·∫øm c√°c v·ªã tr√≠ c√¥ng vi·ªác ph√π h·ª£p v·ªõi y√™u c·∫ßu c·ªßa m√¨nh (tr·∫£ v·ªÅ empty n·∫øu t·∫•t c·∫£ c√°c k·ªπ nƒÉng y√™u c·∫ßu ƒë·ªÅu ƒë∆∞·ª£c ƒë√°p ·ª©ng)</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># So s√°nh s·ª± kh√°c bi·ªát gi·ªØa List k·ªπ nƒÉng c·ªßa v·ªã tr√≠ c√¥ng vi·ªác v√† List k·ªπ nƒÉng c·ªßa ng∆∞·ªùi t√¨m vi·ªác</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SDIFF</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> job:001</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> interviewee:001</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SDIFF</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> job:002</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> interviewee:001</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SDIFF</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> job:003</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> interviewee:001</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SDIFF</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> job:001</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> interviewee:002</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SDIFF</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> job:002</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> interviewee:002</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SDIFF</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> job:003</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> interviewee:002</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># (4) C√¥ng ty tuy·ªÉn d·ª•ng t√¨m ki·∫øm ng∆∞·ªùi t√¨m vi·ªác ph√π h·ª£p v·ªõi y√™u c·∫ßu c√¥ng vi·ªác c·ªßa m√¨nh (tr·∫£ v·ªÅ empty n·∫øu t·∫•t c·∫£ c√°c k·ªπ nƒÉng y√™u c·∫ßu ƒë·ªÅu ƒë∆∞·ª£c ƒë√°p ·ª©ng)</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># So s√°nh s·ª± kh√°c bi·ªát gi·ªØa List k·ªπ nƒÉng c·ªßa ng∆∞·ªùi t√¨m vi·ªác v√† List k·ªπ nƒÉng c·ªßa v·ªã tr√≠ c√¥ng vi·ªác</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SDIFF</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> interviewee:001</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> job:001</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SDIFF</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> interviewee:002</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> job:001</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SDIFF</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> interviewee:001</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> job:002</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SDIFF</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> interviewee:002</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> job:002</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SDIFF</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> interviewee:001</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> job:003</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">SDIFF</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> interviewee:002</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> job:003</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Redis c√≥ nƒÉm lo·∫°i d·ªØ li·ªáu ph·ªï bi·∫øn: <strong>String (chu·ªói), Hash (b·∫£ng bƒÉm), List (danh s√°ch), Set (t·∫≠p h·ª£p) v√† Zset (t·∫≠p h·ª£p c√≥ th·ª© t·ª±)</strong>.</p><p>C√°c lo·∫°i d·ªØ li·ªáu n√†y ƒë∆∞·ª£c tri·ªÉn khai v·ªõi nhi·ªÅu c·∫•u tr√∫c d·ªØ li·ªáu kh√°c nhau, ch·ªß y·∫øu l√† ƒë·ªÉ t·ªëi ∆∞u th·ªùi gian v√† kh√¥ng gian l∆∞u tr·ªØ. Khi t·∫≠p d·ªØ li·ªáu nh·ªè, vi·ªác s·ª≠ d·ª•ng c·∫•u tr√∫c ƒë∆°n gi·∫£n h∆°n c√≥ l·ª£i ƒë·ªÉ ti·∫øt ki·ªám b·ªô nh·ªõ v√† c·∫£i thi·ªán hi·ªáu su·∫•t.</p><p>C·∫•u tr√∫c d·ªØ li·ªáu d∆∞·ªõi c√πng cho c√°c lo·∫°i d·ªØ li·ªáu Redis c√≥ s·ª± kh√°c bi·ªát theo t·ª´ng phi√™n b·∫£n, v√≠ d·ª• nh∆∞:</p><ul><li>Trong phi√™n b·∫£n Redis 3.0, c·∫•u tr√∫c d·ªØ li·ªáu c·ªßa ƒë·ªëi t∆∞·ª£ng List ƒë∆∞·ª£c tri·ªÉn khai b·∫±ng &quot;danh s√°ch li√™n k·∫øt hai chi·ªÅu&quot; ho·∫∑c &quot;ziplist&quot;. Tuy nhi√™n, t·ª´ phi√™n b·∫£n 3.2 tr·ªü ƒëi, List s·ª≠ d·ª•ng c·∫•u tr√∫c d·ªØ li·ªáu quicklist.</li><li>Trong m√£ ngu·ªìn Redis m·ªõi nh·∫•t, c·∫•u tr√∫c d·ªØ li·ªáu ziplist ƒë√£ b·ªã lo·∫°i b·ªè v√† thay th·∫ø b·∫±ng listpack.</li></ul><p><strong>·ª®ng d·ª•ng c·ªßa c√°c lo·∫°i d·ªØ li·ªáu Redis:</strong></p><ul><li><strong>String</strong>: L∆∞u tr·ªØ cache, ƒë·∫øm t·ªïng, kh√≥a ph√¢n t√°n, chia s·∫ª th√¥ng tin phi√™n, v.v.</li><li><strong>List</strong>: H√†ng ƒë·ª£i tin nh·∫Øn (tuy nhi√™n c√≥ hai v·∫•n ƒë·ªÅ: 1. Nh√† s·∫£n xu·∫•t ph·∫£i t·ª± tri·ªÉn khai ID duy nh·∫•t to√†n c·∫ßu; 2. Kh√¥ng h·ªó tr·ª£ vi·ªác ti√™u th·ª• d·ªØ li·ªáu theo nh√≥m).</li><li><strong>Hash</strong>: L∆∞u tr·ªØ cache, gi·ªè h√†ng mua s·∫Øm, v.v.</li><li><strong>Set</strong>: T√≠nh to√°n t·ªï h·ª£p (h·ª£p, giao, kh√°c), ch·∫≥ng h·∫°n nh∆∞ th√≠ch, theo d√µi chung, ho·∫°t ƒë·ªông r√∫t thƒÉm, v.v.</li><li><strong>Zset (Sorted Set)</strong>: S·∫Øp x·∫øp d·ªØ li·ªáu, ch·∫≥ng h·∫°n nh∆∞ b·∫£ng x·∫øp h·∫°ng, s·∫Øp x·∫øp s·ªë ƒëi·ªán tho·∫°i v√† t√™n.</li></ul><p><strong>C√°c lo·∫°i d·ªØ li·ªáu m·ªõi trong Redis v√† ·ª©ng d·ª•ng c·ªßa ch√∫ng:</strong></p><ul><li><strong>Bitmap (th√™m t·ª´ phi√™n b·∫£n 2.2)</strong>: Th·ªëng k√™ tr·∫°ng th√°i nh·ªã ph√¢n, ch·∫≥ng h·∫°n nh∆∞ ƒë√°nh d·∫•u tham gia, x√°c ƒë·ªãnh tr·∫°ng th√°i ƒëƒÉng nh·∫≠p c·ªßa ng∆∞·ªùi d√πng, t·ªïng s·ªë ng∆∞·ªùi d√πng li√™n t·ª•c ƒëƒÉng k√Ω, v.v.</li><li><strong>HyperLogLog (th√™m t·ª´ phi√™n b·∫£n 2.8)</strong>: Th·ªëng k√™ s·ªë l∆∞·ª£ng c∆° s·ªü d·ªØ li·ªáu l·ªõn, ch·∫≥ng h·∫°n nh∆∞ s·ªë l∆∞·ª£t truy c·∫≠p trang web h√†ng tri·ªáu.</li><li><strong>GEO (th√™m t·ª´ phi√™n b·∫£n 3.2)</strong>: L∆∞u tr·ªØ th√¥ng tin v·ªã tr√≠ ƒë·ªãa l√Ω, ch·∫≥ng h·∫°n nh∆∞ d·ªãch v·ª• g·ªçi xe Didi.</li><li><strong>Stream (th√™m t·ª´ phi√™n b·∫£n 5.0)</strong>: H√†ng ƒë·ª£i tin nh·∫Øn, c√≥ hai t√≠nh nƒÉng ƒë·∫∑c bi·ªát so v·ªõi h√†ng ƒë·ª£i tin nh·∫Øn tri·ªÉn khai d·ª±a tr√™n List: t·ª± ƒë·ªông t·∫°o ID tin nh·∫Øn duy nh·∫•t to√†n c·∫ßu, h·ªó tr·ª£ ti√™u th·ª• d·ªØ li·ªáu theo nh√≥m.</li></ul><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624212030.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>Vi·ªác s·ª≠ d·ª•ng Redis l√†m h·ªá th·ªëng h√†ng ƒë·ª£i tin nh·∫Øn ph·ª• thu·ªôc v√†o t√¨nh hu·ªëng nghi·ªáp v·ª• c·ªßa b·∫°n:</p><ul><li>N·∫øu k·ªãch b·∫£n nghi·ªáp v·ª• c·ªßa b·∫°n ƒë∆°n gi·∫£n, kh√¥ng nh·∫°y c·∫£m v·ªõi vi·ªác m·∫•t d·ªØ li·ªáu v√† kh·∫£ nƒÉng ch·∫•t ƒë·ªëng th√¥ng tin √≠t, Redis c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng nh∆∞ m·ªôt h√†ng ƒë·ª£i ho√†n to√†n.</li><li>N·∫øu k·ªãch b·∫£n nghi·ªáp v·ª• c·ªßa b·∫°n c√≥ s·ªë l∆∞·ª£ng tin nh·∫Øn l·ªõn, t·ª∑ l·ªá ch·∫•t ƒë·ªëng th√¥ng tin cao v√† kh√¥ng th·ªÉ ch·∫•p nh·∫≠n m·∫•t d·ªØ li·ªáu, h√£y s·ª≠ d·ª•ng ph·∫ßn m·ªÅm trung gian h√†ng ƒë·ª£i chuy√™n nghi·ªáp.</li></ul></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/vanhung4499/my-wiki/edit/main/src/database/redis/basic-data-types.md" aria-label="Edit this page on GitHub" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page on GitHub<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">Last update: </span><!----></div><div class="contributors"><span class="vp-meta-label">Contributors: </span><!--[--><!--[--><span class="vp-meta-info" title="email: vanhung4499@gmail.com">Hung Nguyen Van</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/database/redis/guide.html" aria-label="Redis Guide"><div class="hint"><span class="arrow start"></span>Prev</div><div class="link"><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon>Redis Guide</div></a><a class="route-link auto-link next" href="/database/redis/advanced-data-types.html" aria-label="Redis Advanced Data Types"><div class="hint">Next<span class="arrow end"></span></div><div class="link">Redis Advanced Data Types<iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper" style="display:none;--1ea755b8:;"><div class="footer-content"><div class="footer">Made with ‚ù§Ô∏è by Hung Nguyen</div><div class="copyright">Copyright ¬© 2016-2024 Hung Nguyen</div></div><span id="runtime_span"></span></footer></div><!--]--><!--[--><!----><!----><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-CIGQMwlz.js" defer></script>
  </body>
</html>
