<!doctype html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.12" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.46" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://vanhung4499.github.io/database/redis/data-structures.html"><meta property="og:site_name" content="VanHung4499"><meta property="og:title" content="Redis Data Structures"><meta property="og:description" content="Redis Data Structures SDS Giá»›i thiá»‡u vá» SDS SDS lÃ  viáº¿t táº¯t cá»§a Simple Dynamic String, tá»©c lÃ  Chuá»—i Äá»™ng ÄÆ¡n Giáº£n. Redis Ä‘Ã£ tá»‘i Æ°u SDS Ä‘á»ƒ thay tháº¿ chuá»—i C trong viá»‡c biá»ƒu diá»…n n..."><meta property="og:type" content="article"><meta property="og:image" content="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624213746.png"><meta property="og:locale" content="en-US"><meta property="og:updated_time" content="2024-06-28T15:54:38.000Z"><meta property="article:author" content="Hung Nguyen"><meta property="article:tag" content="redis"><meta property="article:tag" content="nosql"><meta property="article:modified_time" content="2024-06-28T15:54:38.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Redis Data Structures","image":["https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624213746.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624201754.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624201852.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624215302.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624215319.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624215336.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624215524.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624215901.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624215909.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624215917.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624215924.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624215931.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624215938.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624220250.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624221034.png","https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624221123.png"],"dateModified":"2024-06-28T15:54:38.000Z","author":[{"@type":"Person","name":"Hung Nguyen","url":"https://vanhung4499.github.io"}]}</script><meta name="referrer" content="no-referrer-when-downgrade"><link rel="alternate" type="application/rss+xml" href="https://vanhung4499.github.io/rss.xml" title="VanHung4499 RSS Feed"><title>Redis Data Structures | VanHung4499</title><meta name="description" content="Redis Data Structures SDS Giá»›i thiá»‡u vá» SDS SDS lÃ  viáº¿t táº¯t cá»§a Simple Dynamic String, tá»©c lÃ  Chuá»—i Äá»™ng ÄÆ¡n Giáº£n. Redis Ä‘Ã£ tá»‘i Æ°u SDS Ä‘á»ƒ thay tháº¿ chuá»—i C trong viá»‡c biá»ƒu diá»…n n...">
    <link rel="preload" href="/assets/style-BqjKxtxe.css" as="style"><link rel="stylesheet" href="/assets/style-BqjKxtxe.css">
    <link rel="modulepreload" href="/assets/app-BeMIqZkJ.js"><link rel="modulepreload" href="/assets/data-structures.html-lg9Gj0Or.js">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">Skip to main content</a><!--]--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo" src="/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">VanHung4499</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="Home"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:home" width="1em" height="1em"></iconify-icon><!--]-->Home<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/wiki.html" aria-label="Wiki"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="carbon:wikis" width="1em" height="1em"></iconify-icon><!--]-->Wiki<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/dsa/" aria-label="Algorithms"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="hugeicons:algorithm" width="1em" height="1em"></iconify-icon><!--]-->Algorithms<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Programming"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:code" width="1em" height="1em"></iconify-icon>Programming<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/java/" aria-label="Java"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:java" width="1em" height="1em"></iconify-icon><!--]-->Java<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/golang/" aria-label="Golang"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:go" width="1em" height="1em"></iconify-icon><!--]-->Golang<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/js/" aria-label="JavaScript"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:javascript" width="1em" height="1em"></iconify-icon><!--]-->JavaScript<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/ts/" aria-label="TypeScript"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:typescript" width="1em" height="1em"></iconify-icon><!--]-->TypeScript<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/programming/python/" aria-label="Python"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:python" width="1em" height="1em"></iconify-icon><!--]-->Python<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Database"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:database" width="1em" height="1em"></iconify-icon>Database<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/sql/" aria-label="SQL"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:sql-query" width="1em" height="1em"></iconify-icon><!--]-->SQL<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/mysql/" aria-label="MySQL"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:mysql" width="1em" height="1em"></iconify-icon><!--]-->MySQL<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/mongodb/" aria-label="MongoDB"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:mongodb" width="1em" height="1em"></iconify-icon><!--]-->MongoDB<!----></a></li><li class="vp-dropdown-item"><a class="route-link route-link-active auto-link" href="/database/redis/" aria-label="Redis"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/elasticsearch/" aria-label="Elasticsearch"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:elasticsearch" width="1em" height="1em"></iconify-icon><!--]-->Elasticsearch<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/elastic/" aria-label="Elastic Stack"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="cib:elastic-stack" width="1em" height="1em"></iconify-icon><!--]-->Elastic Stack<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Framework"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="simple-icons:framework" width="1em" height="1em"></iconify-icon>Framework<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/spring/" aria-label="Spring"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->Spring<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/spring-boot/" aria-label="Spring Boot"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->Spring Boot<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/nestjs/" aria-label="NestJS"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:nestjs" width="1em" height="1em"></iconify-icon><!--]-->NestJS<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/gin/" aria-label="Gin"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="logos:gin" width="1em" height="1em"></iconify-icon><!--]-->Gin<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="DevOps"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon-plain:azuredevops" width="1em" height="1em"></iconify-icon>DevOps<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/docker/" aria-label="Docker"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:docker" width="1em" height="1em"></iconify-icon><!--]-->Docker<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/kubernetes/" aria-label="Kubernetes"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:kubernetes" width="1em" height="1em"></iconify-icon><!--]-->Kubernetes<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/jenkins/" aria-label="Jenkins"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:jenkins" width="1em" height="1em"></iconify-icon><!--]-->Jenkins<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/git/" aria-label="Git"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:git" width="1em" height="1em"></iconify-icon><!--]-->Git<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/devops/linux/" aria-label="Linux"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:linux" width="1em" height="1em"></iconify-icon><!--]-->Linux<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Design"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="tdesign:system-sum" width="1em" height="1em"></iconify-icon>Design<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/design/design-pattern/" aria-label="Design Pattern"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="tabler:grid-pattern" width="1em" height="1em"></iconify-icon><!--]-->Design Pattern<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/design/system-design/" aria-label="System Design"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="icon-park-outline:system" width="1em" height="1em"></iconify-icon><!--]-->System Design<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/project/" aria-label="Project"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="ant-design:project-outlined" width="1em" height="1em"></iconify-icon><!--]-->Project<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/interview/" aria-label="Interview"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:account-tie" width="1em" height="1em"></iconify-icon><!--]-->Interview<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="About"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:about" width="1em" height="1em"></iconify-icon>About<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/about-me.html" aria-label="About me"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="cib:about-me" width="1em" height="1em"></iconify-icon><!--]-->About me<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/about.html" aria-label="About"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:about" width="1em" height="1em"></iconify-icon><!--]-->About<!----></a></li></ul></button></div></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/vanhung4499/my-wiki" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><!--[--><button type="button" class="search-pro-button" aria-label="Search"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon" name="search"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">Search</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:sql-query" width="1em" height="1em"></iconify-icon><span class="vp-sidebar-title">SQL</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:mysql" width="1em" height="1em"></iconify-icon><span class="vp-sidebar-title">MySQL</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><span class="vp-sidebar-title">Redis</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/database/redis/overview.html" aria-label="Redis Overview"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Overview<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/database/redis/guide.html" aria-label="Redis Guide"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Guide<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/database/redis/basic-data-types.html" aria-label="Redis Basic Data Types"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Basic Data Types<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/database/redis/advanced-data-types.html" aria-label="Redis Advanced Data Types"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Advanced Data Types<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link vp-sidebar-page active" href="/database/redis/data-structures.html" aria-label="Redis Data Structures"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Data Structures<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/database/redis/expire.html" aria-label="Redis Expire Delete"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Expire Delete<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/database/redis/persistence.html" aria-label="Redis Persistence"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Persistence<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/database/redis/event.html" aria-label="Redis Event"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Event<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/database/redis/replication.html" aria-label="Redis Replication"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Replication<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/database/redis/sentinel.html" aria-label="Redis Sentinel"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Sentinel<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/database/redis/cluster.html" aria-label="Redis Cluster"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Cluster<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/database/redis/pub-sub.html" aria-label="Redis Publish and Subcribe"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Publish and Subcribe<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/database/redis/transaction.html" aria-label="Redis Transaction"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Transaction<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/database/redis/pipeline.html" aria-label="Redis Pipeline"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Pipeline<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/database/redis/operations.html" aria-label="Redis Operations"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Operations<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/database/redis/action.html" aria-label="Redis In Action"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis In Action<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/database/redis/interview.html" aria-label="Redis Interview"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis Interview<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:mongodb" width="1em" height="1em"></iconify-icon><span class="vp-sidebar-title">MongoDB</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:elasticsearch" width="1em" height="1em"></iconify-icon><span class="vp-sidebar-title">Elasticsearch</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><iconify-icon class="font-icon icon" style="" mode="style" inline icon="cib:elastic-stack" width="1em" height="1em"></iconify-icon><span class="vp-sidebar-title">Elastic Stack</span><span class="vp-arrow end"></span></button><!----></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon>Redis Data Structures</h1><div class="page-info"><span class="page-author-info" aria-label="AuthorğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://vanhung4499.github.io" target="_blank" rel="noopener noreferrer">Hung Nguyen</a></span><span property="author" content="Hung Nguyen"></span></span><!----><span class="page-date-info" aria-label="Writing DateğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-06-28T15:54:38.000Z"></span><!----><span class="page-reading-time-info" aria-label="Reading TimeâŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 32 min</span><meta property="timeRequired" content="PT32M"></span><span class="page-category-info" aria-label="CategoryğŸŒˆ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color8 clickable" role="navigation">redis</span><!--]--><meta property="articleSection" content="redis"></span><span class="page-tag-info" aria-label="TagğŸ·" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color8 clickable" role="navigation">redis</span><span class="page-tag-item color7 clickable" role="navigation">nosql</span><!--]--><meta property="keywords" content="redis,nosql"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">On This Page<button type="button" class="print-button" title="Print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#sds">SDS</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gioi-thieu-ve-sds">Giá»›i thiá»‡u vá» SDS</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#trien-khai-sds">Triá»ƒn khai SDS</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#tinh-nang-cua-sds">TÃ­nh nÄƒng cá»§a SDS</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#lay-Ä‘o-dai-chuoi-voi-Ä‘o-phuc-tap-hang-so">Láº¥y Ä‘á»™ dÃ i chuá»—i vá»›i Ä‘á»™ phá»©c táº¡p háº±ng sá»‘</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ngan-chan-tran-bo-Ä‘em">NgÄƒn cháº·n trÃ n bá»™ Ä‘á»‡m</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#giam-so-lan-phan-bo-lai-bo-nho-khi-thay-Ä‘oi-Ä‘o-dai-chuoi">Giáº£m sá»‘ láº§n phÃ¢n bá»• láº¡i bá»™ nhá»› khi thay Ä‘á»•i Ä‘á»™ dÃ i chuá»—i</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#an-toan-cho-du-lieu-nhi-phan">An toÃ n cho dá»¯ liá»‡u nhá»‹ phÃ¢n</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#tuong-thich-voi-mot-so-ham-chuoi-c">TÆ°Æ¡ng thÃ­ch vá»›i má»™t sá»‘ hÃ m chuá»—i C</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#danh-sach-lien-ket">Danh sÃ¡ch liÃªn káº¿t</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gioi-thieu-ve-danh-sach-lien-ket">Giá»›i thiá»‡u vá» Danh sÃ¡ch liÃªn káº¿t</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#trien-khai-cua-danh-sach-lien-ket">Triá»ƒn khai cá»§a Danh sÃ¡ch liÃªn káº¿t</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#tu-Ä‘ien">Tá»« Ä‘iá»ƒn</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gioi-thieu-ve-tu-Ä‘ien">Giá»›i thiá»‡u vá» Tá»« Ä‘iá»ƒn</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#trien-khai-cua-tu-Ä‘ien">Triá»ƒn khai cá»§a Tá»« Ä‘iá»ƒn</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#thuat-toan-bam">Thuáº­t toÃ¡n bÄƒm</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#xu-ly-va-cham">Xá»­ lÃ½ va cháº¡m</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#rehash">rehash</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#skip-list">Skip List</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gioi-thieu-ve-skip-list">Giá»›i thiá»‡u vá» Skip List</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#trien-khai-skip-list">Triá»ƒn khai Skip List</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#tap-hop-so-nguyen">Táº­p há»£p sá»‘ nguyÃªn</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gioi-thieu-ve-tap-hop-so-nguyen">Giá»›i thiá»‡u vá» táº­p há»£p sá»‘ nguyÃªn</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#trien-khai-tap-hop-so-nguyen">Triá»ƒn khai táº­p há»£p sá»‘ nguyÃªn</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#nang-cap-tap-hop-so-nguyen">NÃ¢ng cáº¥p táº­p há»£p sá»‘ nguyÃªn</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#danh-sach-nen">Danh sÃ¡ch nÃ©n</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Ä‘inh-nghia-ve-danh-sach-nen">Äá»‹nh nghÄ©a vá» Danh sÃ¡ch nÃ©n</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#trien-khai-cua-danh-sach-nen">Triá»ƒn khai cá»§a Danh sÃ¡ch nÃ©n</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#Ä‘oi-tuong-object">Äá»‘i tÆ°á»£ng (Object)</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gioi-thieu-ve-Ä‘oi-tuong">Giá»›i thiá»‡u vá» Äá»‘i tÆ°á»£ng</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#kieu-Ä‘oi-tuong-trong-redis">Kiá»ƒu Ä‘á»‘i tÆ°á»£ng trong Redis</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ma-hoa-cua-Ä‘oi-tuong">MÃ£ hÃ³a cá»§a Äá»‘i tÆ°á»£ng</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#kiem-tra-loai-va-Ä‘a-hinh-lenh">Kiá»ƒm tra loáº¡i vÃ  Ä‘a hÃ¬nh lá»‡nh</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#xu-ly-thu-gom-rac">Xá»­ lÃ½ thu gom rÃ¡c</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#chia-se-Ä‘oi-tuong">Chia sáº» Ä‘á»‘i tÆ°á»£ng</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#thoi-gian-ranh-cua-Ä‘oi-tuong">Thá»i gian ráº£nh cá»§a Ä‘á»‘i tÆ°á»£ng</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h1 id="redis-data-structures" tabindex="-1"><a class="header-anchor" href="#redis-data-structures"><span>Redis Data Structures</span></a></h1><h2 id="sds" tabindex="-1"><a class="header-anchor" href="#sds"><span>SDS</span></a></h2><h3 id="gioi-thieu-ve-sds" tabindex="-1"><a class="header-anchor" href="#gioi-thieu-ve-sds"><span>Giá»›i thiá»‡u vá» SDS</span></a></h3><p>SDS lÃ  viáº¿t táº¯t cá»§a Simple Dynamic String, tá»©c lÃ  <strong>Chuá»—i Äá»™ng ÄÆ¡n Giáº£n</strong>. Redis Ä‘Ã£ tá»‘i Æ°u SDS Ä‘á»ƒ thay tháº¿ chuá»—i C trong viá»‡c biá»ƒu diá»…n ná»™i dung chuá»—i. NgoÃ i ra, SDS cÃ²n Ä‘Æ°á»£c Redis sá»­ dá»¥ng nhÆ° lÃ  vÃ¹ng Ä‘á»‡m (buffer), cháº³ng háº¡n nhÆ° vÃ¹ng Ä‘á»‡m AOF trong mÃ´ Ä‘un AOF vÃ  vÃ¹ng Ä‘á»‡m Ä‘áº§u vÃ o trong tráº¡ng thÃ¡i cá»§a khÃ¡ch hÃ ng.</p><p>So vá»›i chuá»—i C, SDS cÃ³ nhá»¯ng Æ°u Ä‘iá»ƒm sau:</p><table><thead><tr><th style="text-align:left;">Chuá»—i C</th><th style="text-align:left;">SDS</th></tr></thead><tbody><tr><td style="text-align:left;">Äá»™ phá»©c táº¡p Ä‘á»ƒ láº¥y Ä‘á»™ dÃ i chuá»—i lÃ  O(N).</td><td style="text-align:left;">Äá»™ phá»©c táº¡p Ä‘á»ƒ láº¥y Ä‘á»™ dÃ i chuá»—i lÃ  O(1).</td></tr><tr><td style="text-align:left;">API khÃ´ng an toÃ n, cÃ³ thá»ƒ gÃ¢y trÃ n bá»™ Ä‘á»‡m.</td><td style="text-align:left;">API an toÃ n, khÃ´ng gÃ¢y trÃ n bá»™ Ä‘á»‡m.</td></tr><tr><td style="text-align:left;">Äá»•i Ä‘á»™ dÃ i chuá»—i <code>N</code> láº§n sáº½ cáº§n pháº£i cáº¥p phÃ¡t láº¡i <code>N</code> láº§n bá»™ nhá»›.</td><td style="text-align:left;">Äá»•i Ä‘á»™ dÃ i chuá»—i <code>N</code> láº§n tá»‘i Ä‘a chá»‰ cáº§n cáº¥p phÃ¡t láº¡i <code>N</code> láº§n bá»™ nhá»›.</td></tr><tr><td style="text-align:left;">Chá»‰ cÃ³ thá»ƒ lÆ°u trá»¯ dá»¯ liá»‡u vÄƒn báº£n.</td><td style="text-align:left;">CÃ³ thá»ƒ lÆ°u trá»¯ cáº£ dá»¯ liá»‡u vÄƒn báº£n vÃ  dá»¯ liá»‡u nhá»‹ phÃ¢n.</td></tr><tr><td style="text-align:left;">CÃ³ thá»ƒ sá»­ dá»¥ng táº¥t cáº£ cÃ¡c hÃ m trong thÆ° viá»‡n <code>&lt;string.h&gt;</code>.</td><td style="text-align:left;">Chá»‰ cÃ³ thá»ƒ sá»­ dá»¥ng má»™t pháº§n hÃ m trong thÆ° viá»‡n <code>&lt;string.h&gt;</code>.</td></tr></tbody></table><h3 id="trien-khai-sds" tabindex="-1"><a class="header-anchor" href="#trien-khai-sds"><span>Triá»ƒn khai SDS</span></a></h3><p>Má»—i cáº¥u trÃºc <code>sds.h/sdshdr</code> Ä‘áº¡i diá»‡n cho má»™t giÃ¡ trá»‹ SDS:</p><div class="language-c" data-ext="c" data-title="c"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">struct</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> sdshdr {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Ghi láº¡i sá»‘ lÆ°á»£ng byte Ä‘Ã£ sá»­ dá»¥ng trong máº£ng buf</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Báº±ng vá»›i Ä‘á»™ dÃ i cá»§a chuá»—i Ä‘Æ°á»£c lÆ°u bá»Ÿi SDS</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    int</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> len;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Ghi láº¡i sá»‘ lÆ°á»£ng byte chÆ°a sá»­ dá»¥ng trong máº£ng buf</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    int</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> free;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Máº£ng byte Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ lÆ°u trá»¯ chuá»—i</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    char</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> buf</span><span style="color:#C678DD;--shiki-dark:#C678DD;">[]</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">};</span></span></code></pre></div><p>SDS tuÃ¢n thá»§ quy Æ°á»›c chuá»—i C vá»›i kÃ½ tá»± null káº¿t thÃºc, trong Ä‘Ã³ khÃ´ng tÃ­nh <code>1</code> byte Ä‘Æ°á»£c cáº¥p phÃ¡t cho kÃ½ tá»± null trong thuá»™c tÃ­nh <code>len</code> cá»§a SDS. NgoÃ i ra, cÃ¡c thao tÃ¡c nhÆ° cáº¥p phÃ¡t thÃªm <code>1</code> byte cho kÃ½ tá»± null á»Ÿ cuá»‘i chuá»—i Ä‘Æ°á»£c xá»­ lÃ½ tá»± Ä‘á»™ng bá»Ÿi cÃ¡c hÃ m SDS, lÃ m cho kÃ½ tá»± null nÃ y hoÃ n toÃ n trong suá»‘t Ä‘á»‘i vá»›i ngÆ°á»i dÃ¹ng SDS.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624213746.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><h2 id="tinh-nang-cua-sds" tabindex="-1"><a class="header-anchor" href="#tinh-nang-cua-sds"><span>TÃ­nh nÄƒng cá»§a SDS</span></a></h2><p>SDS so vá»›i chuá»—i C, cÃ³ nhá»¯ng tá»‘i Æ°u hÃ³a sau Ä‘Ã¢y:</p><h3 id="lay-Ä‘o-dai-chuoi-voi-Ä‘o-phuc-tap-hang-so" tabindex="-1"><a class="header-anchor" href="#lay-Ä‘o-dai-chuoi-voi-Ä‘o-phuc-tap-hang-so"><span>Láº¥y Ä‘á»™ dÃ i chuá»—i vá»›i Ä‘á»™ phá»©c táº¡p háº±ng sá»‘</span></a></h3><ul><li>Chuá»—i C: VÃ¬ chuá»—i C khÃ´ng ghi nháº­n thÃ´ng tin Ä‘á»™ dÃ i cá»§a chÃ­nh nÃ³, Ä‘á»ƒ láº¥y Ä‘á»™ dÃ i cá»§a má»™t chuá»—i C, chÆ°Æ¡ng trÃ¬nh pháº£i duyá»‡t qua toÃ n bá»™ chuá»—i, Ä‘áº¿m tá»«ng kÃ½ tá»± cho Ä‘áº¿n khi gáº·p kÃ½ tá»± null Ä‘Ã¡nh dáº¥u káº¿t thÃºc chuá»—i. Äá»™ phá»©c táº¡p cá»§a thao tÃ¡c nÃ y lÃ  <code>O(N)</code>.</li><li>SDS: SDS ghi nháº­n Ä‘á»™ dÃ i cá»§a chÃ­nh nÃ³ trong thuá»™c tÃ­nh <code>len</code>, do Ä‘Ã³ Ä‘á»ƒ láº¥y Ä‘á»™ dÃ i cá»§a SDS chá»‰ máº¥t Ä‘á»™ phá»©c táº¡p <code>O(1)</code>. CÃ´ng viá»‡c thiáº¿t láº­p vÃ  cáº­p nháº­t Ä‘á»™ dÃ i SDS Ä‘Æ°á»£c thá»±c hiá»‡n tá»± Ä‘á»™ng bá»Ÿi API cá»§a SDS khi thá»±c thi, khÃ´ng cáº§n pháº£i chá»‰nh sá»­a Ä‘á»™ dÃ i báº±ng tay.</li></ul><h3 id="ngan-chan-tran-bo-Ä‘em" tabindex="-1"><a class="header-anchor" href="#ngan-chan-tran-bo-Ä‘em"><span>NgÄƒn cháº·n trÃ n bá»™ Ä‘á»‡m</span></a></h3><ul><li>Chuá»—i C: VÃ¬ chuá»—i C khÃ´ng ghi nháº­n Ä‘á»™ dÃ i cá»§a chÃ­nh nÃ³, Ä‘iá»u nÃ y dá»… dáº«n Ä‘áº¿n váº¥n Ä‘á» trÃ n bá»™ Ä‘á»‡m (buffer overflow).</li><li>SDS: Khi API cá»§a SDS cáº§n thay Ä‘á»•i SDS, nÃ³ trÆ°á»›c tiÃªn kiá»ƒm tra xem khÃ´ng gian SDS cÃ³ Ä‘Ã¡p á»©ng yÃªu cáº§u thay Ä‘á»•i hay khÃ´ng. Náº¿u khÃ´ng Ä‘á»§, API sáº½ tá»± Ä‘á»™ng má»Ÿ rá»™ng khÃ´ng gian SDS Ä‘áº¿n kÃ­ch thÆ°á»›c cáº§n thiáº¿t trÆ°á»›c khi thá»±c hiá»‡n thay Ä‘á»•i thá»±c táº¿. Do Ä‘Ã³, viá»‡c sá»­ dá»¥ng SDS khÃ´ng cáº§n pháº£i Ä‘iá»u chá»‰nh kÃ­ch thÆ°á»›c khÃ´ng gian SDS thá»§ cÃ´ng vÃ  khÃ´ng gáº·p váº¥n Ä‘á» trÃ n bá»™ Ä‘á»‡m nhÆ° chuá»—i C.</li></ul><h3 id="giam-so-lan-phan-bo-lai-bo-nho-khi-thay-Ä‘oi-Ä‘o-dai-chuoi" tabindex="-1"><a class="header-anchor" href="#giam-so-lan-phan-bo-lai-bo-nho-khi-thay-Ä‘oi-Ä‘o-dai-chuoi"><span>Giáº£m sá»‘ láº§n phÃ¢n bá»• láº¡i bá»™ nhá»› khi thay Ä‘á»•i Ä‘á»™ dÃ i chuá»—i</span></a></h3><ul><li>Chuá»—i C: Vá»›i má»™t chuá»—i C cÃ³ <code>N</code> kÃ½ tá»±, triá»ƒn khai dÆ°á»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a chuá»—i C luÃ´n cÃ³ máº£ng dÃ i <code>N+1</code> kÃ½ tá»± (bao gá»“m má»™t kÃ½ tá»± thÃªm Ä‘á»ƒ lÆ°u kÃ½ tá»± null). Bá»Ÿi vÃ¬ cÃ³ sá»± tÆ°Æ¡ng quan giá»¯a Ä‘á»™ dÃ i chuá»—i vÃ  Ä‘á»™ dÃ i cá»§a máº£ng cÆ¡ sá»Ÿ, má»—i láº§n tÄƒng hoáº·c giáº£m Ä‘á»™ dÃ i cá»§a má»™t chuá»—i C Ä‘á»u yÃªu cáº§u má»™t phÃ©p phÃ¢n bá»• láº¡i bá»™ nhá»› cho máº£ng lÆ°u trá»¯ chuá»—i nÃ y. <ul><li>Khi tÄƒng Ä‘á»™ dÃ i chuá»—i mÃ  khÃ´ng phÃ¢n bá»• láº¡i bá»™ nhá»›, cÃ³ nguy cÆ¡ trÃ n bá»™ Ä‘á»‡m.</li><li>Khi giáº£m Ä‘á»™ dÃ i chuá»—i mÃ  khÃ´ng phÃ¢n bá»• láº¡i bá»™ nhá»›, cÃ³ nguy cÆ¡ rÃ² rá»‰ bá»™ nhá»›.</li></ul></li><li>SDS: Báº±ng cÃ¡ch sá»­ dá»¥ng khÃ´ng gian chÆ°a sá»­ dá»¥ng, SDS loáº¡i bá» sá»± phá»¥ thuá»™c giá»¯a Ä‘á»™ dÃ i chuá»—i vÃ  Ä‘á»™ dÃ i cá»§a máº£ng cÆ¡ sá»Ÿ: Ä‘á»™ dÃ i máº£ng <code>buf</code> trong SDS khÃ´ng nháº¥t thiáº¿t pháº£i báº±ng sá»‘ lÆ°á»£ng kÃ½ tá»± cá»™ng má»™t. Thay vÃ o Ä‘Ã³, máº£ng nÃ y cÃ³ thá»ƒ chá»©a cÃ¡c byte chÆ°a sá»­ dá»¥ng, vÃ  sá»‘ lÆ°á»£ng byte nÃ y Ä‘Æ°á»£c ghi nháº­n bá»Ÿi thuá»™c tÃ­nh <code>free</code> cá»§a SDS. SDS thá»±c hiá»‡n hai chiáº¿n lÆ°á»£c tá»‘i Æ°u hÃ³a sau: <ul><li><strong>Dá»± trá»¯ khÃ´ng gian</strong> - Dá»± trá»¯ khÃ´ng gian Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tá»‘i Æ°u hÃ³a viá»‡c má»Ÿ rá»™ng chuá»—i SDS. Khi API cá»§a SDS sá»­a Ä‘á»•i má»™t SDS vÃ  cáº§n má»Ÿ rá»™ng khÃ´ng gian, chÆ°Æ¡ng trÃ¬nh khÃ´ng chá»‰ cáº¥p phÃ¡t khÃ´ng gian cáº§n thiáº¿t cho sá»­a Ä‘á»•i, mÃ  cÃ²n cáº¥p phÃ¡t khÃ´ng gian chÆ°a sá»­ dá»¥ng thÃªm. Báº±ng cÃ¡ch nÃ y, SDS giáº£m sá»‘ láº§n phÃ¢n bá»• láº¡i bá»™ nhá»› cáº§n thiáº¿t khi chuá»—i tÄƒng dáº§n liÃªn tá»¥c <code>N</code> láº§n tá»« báº¯t buá»™c xuá»‘ng tá»‘i Ä‘a <code>N</code> láº§n.</li><li><strong>Giáº£i phÃ³ng khÃ´ng gian má»™t cÃ¡ch lÆ°á»i biáº¿ng</strong> - Chiáº¿n lÆ°á»£c giáº£i phÃ³ng khÃ´ng gian má»™t cÃ¡ch lÆ°á»i biáº¿ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tá»‘i Æ°u hÃ³a viá»‡c rÃºt ngáº¯n chuá»—i SDS. Khi API cá»§a SDS cáº§n rÃºt ngáº¯n chuá»—i SDS, chÆ°Æ¡ng trÃ¬nh khÃ´ng sá»­ dá»¥ng ngay láº­p tá»©c phÃ¢n bá»• láº¡i bá»™ nhá»› Ä‘á»ƒ thu há»“i cÃ¡c byte dÆ° thá»«a sau khi rÃºt ngáº¯n. Thay vÃ o Ä‘Ã³, nÃ³ sá»­ dá»¥ng thuá»™c tÃ­nh <code>free</code> Ä‘á»ƒ ghi nháº­n sá»‘ lÆ°á»£ng byte nÃ y vÃ  chá» Ä‘á»£i sá»­ dá»¥ng trong tÆ°Æ¡ng lai. Báº±ng cÃ¡ch nÃ y, SDS trÃ¡nh pháº£i thá»±c hiá»‡n phÃ¢n bá»• láº¡i bá»™ nhá»› khi rÃºt ngáº¯n chuá»—i vÃ  tá»‘i Æ°u hÃ³a cho cÃ¡c thao tÃ¡c tÄƒng dáº§n cÃ³ thá»ƒ xáº£y ra trong tÆ°Æ¡ng lai.</li></ul></li></ul><h3 id="an-toan-cho-du-lieu-nhi-phan" tabindex="-1"><a class="header-anchor" href="#an-toan-cho-du-lieu-nhi-phan"><span>An toÃ n cho dá»¯ liá»‡u nhá»‹ phÃ¢n</span></a></h3><ul><li>Chuá»—i C: KÃ½ tá»± trong chuá»—i C pháº£i tuÃ¢n thá»§ má»™t mÃ£ hÃ³a nháº¥t Ä‘á»‹nh (vÃ­ dá»¥: ASCII), vÃ  ngoÃ i kÃ½ tá»± null á»Ÿ cuá»‘i chuá»—i, chuá»—i khÃ´ng thá»ƒ chá»©a kÃ½ tá»± null. Náº¿u cÃ³, kÃ½ tá»± null Ä‘áº§u tiÃªn Ä‘Æ°á»£c chÆ°Æ¡ng trÃ¬nh Ä‘á»c sáº½ bá»‹ hiá»ƒu láº§m lÃ  káº¿t thÃºc chuá»—i â€” nhá»¯ng háº¡n cháº¿ nÃ y khiáº¿n <strong>chuá»—i C chá»‰ cÃ³ thá»ƒ lÆ°u trá»¯ dá»¯ liá»‡u vÄƒn báº£n</strong> vÃ  khÃ´ng thá»ƒ lÆ°u trá»¯ cÃ¡c dáº¡ng dá»¯ liá»‡u nhá»‹ phÃ¢n nhÆ° hÃ¬nh áº£nh, Ã¢m thanh, video, tá»‡p nÃ©n.</li><li>SDS: CÃ¡c API cá»§a SDS Ä‘á»u an toÃ n cho dá»¯ liá»‡u nhá»‹ phÃ¢n (binary-safe): Táº¥t cáº£ cÃ¡c API cá»§a SDS xá»­ lÃ½ dá»¯ liá»‡u trong máº£ng <code>buf</code> theo cÃ¡ch xá»­ lÃ½ dá»¯ liá»‡u nhá»‹ phÃ¢n, chÆ°Æ¡ng trÃ¬nh khÃ´ng giá»›i háº¡n, lá»c, hoáº·c giáº£ Ä‘á»‹nh vá» dá»¯ liá»‡u trong Ä‘Ã³ â€” dá»¯ liá»‡u Ä‘Æ°á»£c viáº¿t vÃ o lÃ  gÃ¬, thÃ¬ khi Ä‘á»c ra sáº½ váº«n lÃ  nhÆ° váº­y. <strong>Báº±ng cÃ¡ch sá»­ dá»¥ng SDS an toÃ n cho dá»¯ liá»‡u nhá»‹ phÃ¢n</strong>, Redis khÃ´ng chá»‰ cÃ³ thá»ƒ lÆ°u trá»¯ dá»¯ liá»‡u vÄƒn báº£n, mÃ  cÃ²n cÃ³ thá»ƒ lÆ°u trá»¯ báº¥t ká»³ Ä‘á»‹nh dáº¡ng dá»¯ liá»‡u nhá»‹ phÃ¢n nÃ o.</li></ul><h3 id="tuong-thich-voi-mot-so-ham-chuoi-c" tabindex="-1"><a class="header-anchor" href="#tuong-thich-voi-mot-so-ham-chuoi-c"><span>TÆ°Æ¡ng thÃ­ch vá»›i má»™t sá»‘ hÃ m chuá»—i C</span></a></h3><p>Máº·c dÃ¹ cÃ¡c API cá»§a SDS an toÃ n cho dá»¯ liá»‡u nhá»‹ phÃ¢n, SDS váº«n tuÃ¢n thá»§ quy Æ°á»›c chuá»—i C báº±ng cÃ¡ch thiáº¿t láº­p kÃ½ tá»± null á»Ÿ cuá»‘i dá»¯ liá»‡u Ä‘Æ°á»£c lÆ°u trá»¯ vÃ  luÃ´n cáº¥p phÃ¡t thÃªm má»™t byte cho máº£ng <code>buf</code> Ä‘á»ƒ chá»©a kÃ½ tá»± null nÃ y â€” Ä‘iá»u nÃ y giÃºp cÃ¡c SDS lÆ°u trá»¯ dá»¯ liá»‡u vÄƒn báº£n cÃ³ thá»ƒ sá»­ dá»¥ng láº¡i má»™t pháº§n cÃ¡c hÃ m Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong thÆ° viá»‡n <code>&lt;string.h&gt;</code> cá»§a C. Do Ä‘Ã³, SDS cÃ³ thá»ƒ tÆ°Æ¡ng thÃ­ch vá»›i má»™t sá»‘ hÃ m chuá»—i C.</p><h2 id="danh-sach-lien-ket" tabindex="-1"><a class="header-anchor" href="#danh-sach-lien-ket"><span>Danh sÃ¡ch liÃªn káº¿t</span></a></h2><h3 id="gioi-thieu-ve-danh-sach-lien-ket" tabindex="-1"><a class="header-anchor" href="#gioi-thieu-ve-danh-sach-lien-ket"><span>Giá»›i thiá»‡u vá» Danh sÃ¡ch liÃªn káº¿t</span></a></h3><p>Danh sÃ¡ch liÃªn káº¿t Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i trong Redis Ä‘á»ƒ thá»±c hiá»‡n nhiá»u chá»©c nÄƒng nhÆ° cÃ¡c khÃ³a Danh sÃ¡ch (List), Ä‘Äƒng kÃ½ vÃ  phÃ¡t hÃ nh (publish-subscribe), truy váº¥n cháº­m, trÃ¬nh giÃ¡m sÃ¡t vÃ  nhiá»u chá»©c nÄƒng khÃ¡c. NgoÃ i ra, Redis cÃ²n sá»­ dá»¥ng danh sÃ¡ch liÃªn káº¿t Ä‘á»ƒ lÆ°u trá»¯ thÃ´ng tin tráº¡ng thÃ¡i cá»§a nhiá»u khÃ¡ch hÃ ng vÃ  xÃ¢y dá»±ng bá»™ Ä‘á»‡m Ä‘áº§u ra (output buffer) cho khÃ¡ch hÃ ng.</p><p>Bá»Ÿi vÃ¬ ngÃ´n ngá»¯ láº­p trÃ¬nh C khÃ´ng tÃ­ch há»£p sáºµn danh sÃ¡ch liÃªn káº¿t, Redis Ä‘Ã£ tá»± triá»ƒn khai má»™t danh sÃ¡ch liÃªn káº¿t cá»§a riÃªng mÃ¬nh: <strong>Danh sÃ¡ch liÃªn káº¿t trong Redis thá»±c táº¿ lÃ  má»™t danh sÃ¡ch liÃªn káº¿t hai chiá»u</strong>.</p><ul><li>Má»—i danh sÃ¡ch liÃªn káº¿t Ä‘Æ°á»£c biá»ƒu diá»…n báº±ng má»™t cáº¥u trÃºc <code>list</code>, cáº¥u trÃºc nÃ y bao gá»“m con trá» Ä‘áº¿n nÃºt Ä‘áº§u danh sÃ¡ch, con trá» Ä‘áº¿n nÃºt cuá»‘i danh sÃ¡ch vÃ  thÃ´ng tin vá» Ä‘á»™ dÃ i cá»§a danh sÃ¡ch.</li><li>VÃ¬ nÃºt trÆ°á»›c nÃºt Ä‘áº§u danh sÃ¡ch vÃ  nÃºt sau nÃºt cuá»‘i danh sÃ¡ch Ä‘á»u trá» Ä‘áº¿n <code>NULL</code>, do Ä‘Ã³, cÃ i Ä‘áº·t danh sÃ¡ch liÃªn káº¿t trong Redis lÃ  danh sÃ¡ch liÃªn káº¿t khÃ´ng cÃ³ vÃ²ng láº·p.</li><li>Báº±ng cÃ¡ch thiáº¿t láº­p cÃ¡c hÃ m Ä‘áº·c thÃ¹ cho tá»«ng loáº¡i, danh sÃ¡ch liÃªn káº¿t trong Redis cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ lÆ°u trá»¯ cÃ¡c giÃ¡ trá»‹ khÃ¡c nhau.</li></ul><p>Danh sÃ¡ch liÃªn káº¿t trong Redis cung cáº¥p cÃ¡c tÃ­nh nÄƒng chÃ¨n, xÃ³a vÃ  tÃ¬m kiáº¿m hiá»‡u quáº£, lÃ m cho nÃ³ ráº¥t há»¯u Ã­ch vÃ  linh hoáº¡t trong viá»‡c triá»ƒn khai nhiá»u cáº¥u trÃºc dá»¯ liá»‡u vÃ  chá»©c nÄƒng khÃ¡c nhau trong Redis.</p><h3 id="trien-khai-cua-danh-sach-lien-ket" tabindex="-1"><a class="header-anchor" href="#trien-khai-cua-danh-sach-lien-ket"><span>Triá»ƒn khai cá»§a Danh sÃ¡ch liÃªn káº¿t</span></a></h3><p>Má»—i nÃºt trong danh sÃ¡ch liÃªn káº¿t Ä‘Æ°á»£c biá»ƒu diá»…n báº±ng cáº¥u trÃºc <code>adlist.h/listNode</code>. Má»—i nÃºt nÃ y cÃ³ má»™t con trá» trá» Ä‘áº¿n nÃºt phÃ­a trÆ°á»›c vÃ  nÃºt phÃ­a sau, do Ä‘Ã³, danh sÃ¡ch liÃªn káº¿t trong Redis Ä‘Æ°á»£c triá»ƒn khai nhÆ° lÃ  má»™t danh sÃ¡ch liÃªn káº¿t hai chiá»u.</p><div class="language-c" data-ext="c" data-title="c"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">typedef</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> struct</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> listNode {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Con trá» Ä‘áº¿n nÃºt phÃ­a trÆ°á»›c</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    struct</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> listNode </span><span style="color:#C678DD;--shiki-dark:#C678DD;">*</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">prev;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Con trá» Ä‘áº¿n nÃºt phÃ­a sau</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    struct</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> listNode </span><span style="color:#C678DD;--shiki-dark:#C678DD;">*</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">next;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // GiÃ¡ trá»‹ cá»§a nÃºt</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    void</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> *</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">value;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">} listNode;</span></span></code></pre></div><p>Nhiá»u <code>listNode</code> cÃ³ thá»ƒ Ä‘Æ°á»£c sáº¯p xáº¿p láº¡i vá»›i nhau báº±ng cÃ¡ch sá»­ dá»¥ng cÃ¡c con trá» <code>prev</code> vÃ  <code>next</code>, hÃ¬nh thÃ nh má»™t danh sÃ¡ch liÃªn káº¿t hai chiá»u.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624201754.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Máº·c dÃ¹ chá»‰ cáº§n sá»­ dá»¥ng nhiá»u cáº¥u trÃºc <code>listNode</code> lÃ  cÃ³ thá»ƒ táº¡o thÃ nh danh sÃ¡ch liÃªn káº¿t, nhÆ°ng viá»‡c sá»­ dá»¥ng <code>adlist.h/list</code> Ä‘á»ƒ lÆ°u giá»¯ danh sÃ¡ch liÃªn káº¿t sáº½ lÃ m cho viá»‡c thao tÃ¡c dá»… dÃ ng hÆ¡n:</p><div class="language-c line-numbers-mode" data-ext="c" data-title="c"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">typedef</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> struct</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> list {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Con trá» Ä‘áº¿n nÃºt Ä‘áº§u danh sÃ¡ch</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    listNode </span><span style="color:#C678DD;--shiki-dark:#C678DD;">*</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">head;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Con trá» Ä‘áº¿n nÃºt cuá»‘i danh sÃ¡ch</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    listNode </span><span style="color:#C678DD;--shiki-dark:#C678DD;">*</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">tail;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Sá»‘ lÆ°á»£ng nÃºt trong danh sÃ¡ch</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    unsigned</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> long</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> len;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // HÃ m sao chÃ©p giÃ¡ trá»‹ cá»§a nÃºt</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    void</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> *</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#C678DD;--shiki-dark:#C678DD;">*</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">dup)(</span><span style="color:#C678DD;--shiki-dark:#C678DD;">void</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> *</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">ptr);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // HÃ m giáº£i phÃ³ng giÃ¡ trá»‹ cá»§a nÃºt</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    void</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#C678DD;--shiki-dark:#C678DD;">*</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">free)(</span><span style="color:#C678DD;--shiki-dark:#C678DD;">void</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> *</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">ptr);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // HÃ m so sÃ¡nh giÃ¡ trá»‹ cá»§a nÃºt</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    int</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#C678DD;--shiki-dark:#C678DD;">*</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">match)(</span><span style="color:#C678DD;--shiki-dark:#C678DD;">void</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> *</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">ptr, </span><span style="color:#C678DD;--shiki-dark:#C678DD;">void</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> *</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">key);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">} list;</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Cáº¥u trÃºc <code>list</code> cung cáº¥p con trá» <code>head</code> (Ä‘áº§u danh sÃ¡ch), <code>tail</code> (cuá»‘i danh sÃ¡ch) vÃ  <code>len</code> (Ä‘á»™ dÃ i danh sÃ¡ch). CÃ¡c thÃ nh viÃªn <code>dup</code>, <code>free</code> vÃ  <code>match</code> Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ triá»ƒn khai cÃ¡c hÃ m Ä‘áº·c thÃ¹ cho tá»«ng loáº¡i dá»¯ liá»‡u cá»§a danh sÃ¡ch:</p><ul><li>HÃ m <code>dup</code> - dÃ¹ng Ä‘á»ƒ sao chÃ©p giÃ¡ trá»‹ cá»§a nÃºt trong danh sÃ¡ch.</li><li>HÃ m <code>free</code> - dÃ¹ng Ä‘á»ƒ giáº£i phÃ³ng giÃ¡ trá»‹ cá»§a nÃºt trong danh sÃ¡ch.</li><li>HÃ m <code>match</code> - dÃ¹ng Ä‘á»ƒ so sÃ¡nh giÃ¡ trá»‹ cá»§a nÃºt vá»›i má»™t giÃ¡ trá»‹ khÃ¡c.</li></ul><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624201852.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="tu-Ä‘ien" tabindex="-1"><a class="header-anchor" href="#tu-Ä‘ien"><span>Tá»« Ä‘iá»ƒn</span></a></h2><h3 id="gioi-thieu-ve-tu-Ä‘ien" tabindex="-1"><a class="header-anchor" href="#gioi-thieu-ve-tu-Ä‘ien"><span>Giá»›i thiá»‡u vá» Tá»« Ä‘iá»ƒn</span></a></h3><p>Tá»« Ä‘iá»ƒn (Dictionary) lÃ  má»™t cáº¥u trÃºc dá»¯ liá»‡u trá»«u tÆ°á»£ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ lÆ°u trá»¯ cÃ¡c cáº·p khÃ³a-giÃ¡ trá»‹ (key-value pairs). Má»—i khÃ³a trong tá»« Ä‘iá»ƒn lÃ  duy nháº¥t, cho phÃ©p chÆ°Æ¡ng trÃ¬nh tÃ¬m kiáº¿m, cáº­p nháº­t hoáº·c xÃ³a giÃ¡ trá»‹ liÃªn quan dá»±a trÃªn khÃ³a, cÃ¹ng vá»›i cÃ¡c thao tÃ¡c khÃ¡c.</p><p>Redis Ä‘Ã£ tá»± triá»ƒn khai má»™t cáº¥u trÃºc tá»« Ä‘iá»ƒn do ngÃ´n ngá»¯ láº­p trÃ¬nh C khÃ´ng há»— trá»£ cáº¥u trÃºc tá»« Ä‘iá»ƒn sáºµn cÃ³.</p><p>Tá»« Ä‘iá»ƒn Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i trong Redis Ä‘á»ƒ triá»ƒn khai cÃ¡c chá»©c nÄƒng khÃ¡c nhau, bao gá»“m cáº£ cÆ¡ sá»Ÿ dá»¯ liá»‡u vÃ  cÃ¡c khÃ³a bÄƒm (Hash Keys).</p><h3 id="trien-khai-cua-tu-Ä‘ien" tabindex="-1"><a class="header-anchor" href="#trien-khai-cua-tu-Ä‘ien"><span>Triá»ƒn khai cá»§a Tá»« Ä‘iá»ƒn</span></a></h3><p>Redis sá»­ dá»¥ng báº£ng bÄƒm (hash table) lÃ m cáº¥u trÃºc dá»¯ liá»‡u cÆ¡ sá»Ÿ cho tá»« Ä‘iá»ƒn, trong Ä‘Ã³ má»—i báº£ng bÄƒm cÃ³ thá»ƒ chá»©a nhiá»u nÃºt báº£ng bÄƒm, vÃ  má»—i nÃºt nÃ y lÆ°u trá»¯ má»™t cáº·p khÃ³a-giÃ¡ trá»‹ trong tá»« Ä‘iá»ƒn.</p><p>Cáº¥u trÃºc <code>dictht</code> trong Redis Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a nhÆ° sau:</p><div class="language-c line-numbers-mode" data-ext="c" data-title="c"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">typedef</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> struct</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> dictht {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Máº£ng cá»§a báº£ng bÄƒm</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    dictEntry </span><span style="color:#C678DD;--shiki-dark:#C678DD;">**</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">table;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // KÃ­ch thÆ°á»›c cá»§a báº£ng bÄƒm</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    unsigned</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> long</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> size;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Máº·t náº¡ kÃ­ch thÆ°á»›c cá»§a báº£ng bÄƒm, dÃ¹ng Ä‘á»ƒ tÃ­nh chá»‰ sá»‘</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // LuÃ´n luÃ´n báº±ng size - 1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    unsigned</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> long</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> sizemask;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Sá»‘ lÆ°á»£ng nÃºt hiá»‡n cÃ³ trong báº£ng bÄƒm</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    unsigned</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> long</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> used;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">} dictht;</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Thuá»™c tÃ­nh <code>table</code> lÃ  má»™t máº£ng cÃ¡c con trá» tá»›i cáº¥u trÃºc <code>dictEntry</code>, má»—i <code>dictEntry</code> lÆ°u trá»¯ má»™t cáº·p khÃ³a-giÃ¡ trá»‹.</li><li>Thuá»™c tÃ­nh <code>size</code> lÃ  kÃ­ch thÆ°á»›c cá»§a báº£ng bÄƒm, tá»©c lÃ  kÃ­ch thÆ°á»›c cá»§a máº£ng <code>table</code>.</li><li>Thuá»™c tÃ­nh <code>sizemask</code> lÃ  máº·t náº¡ kÃ­ch thÆ°á»›c cá»§a báº£ng bÄƒm, Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ­nh chá»‰ sá»‘ cá»§a khÃ³a.</li><li>Thuá»™c tÃ­nh <code>used</code> lÃ  sá»‘ lÆ°á»£ng nÃºt (cáº·p khÃ³a-giÃ¡ trá»‹) Ä‘Ã£ Ä‘Æ°á»£c thÃªm vÃ o báº£ng bÄƒm.</li></ul><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624215302.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>Cáº¥u trÃºc <code>dictEntry</code> Ä‘áº¡i diá»‡n cho má»™t nÃºt trong báº£ng bÄƒm, lÆ°u trá»¯ má»™t cáº·p khÃ³a-giÃ¡ trá»‹ nhÆ° sau:</p><div class="language-c line-numbers-mode" data-ext="c" data-title="c"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">typedef</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> struct</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> dictEntry {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // KhÃ³a</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    void</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> *</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">key;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // GiÃ¡ trá»‹</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    union</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        void</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> *</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">val;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        uint64_t</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> u64;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        int64_t</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> s64;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    } v;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Con trá» Ä‘áº¿n nÃºt báº£ng bÄƒm tiáº¿p theo, táº¡o thÃ nh danh sÃ¡ch liÃªn káº¿t</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    struct</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> dictEntry </span><span style="color:#C678DD;--shiki-dark:#C678DD;">*</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">next;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">} dictEntry;</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Thuá»™c tÃ­nh <code>key</code> lÆ°u trá»¯ khÃ³a cá»§a cáº·p khÃ³a-giÃ¡ trá»‹.</li><li>Thuá»™c tÃ­nh <code>v</code> lÆ°u trá»¯ giÃ¡ trá»‹ tÆ°Æ¡ng á»©ng vá»›i khÃ³a. GiÃ¡ trá»‹ cÃ³ thá»ƒ lÃ  má»™t con trá», hoáº·c má»™t sá»‘ nguyÃªn <code>uint64_t</code> hoáº·c <code>int64_t</code>.</li><li>Thuá»™c tÃ­nh <code>next</code> lÃ  con trá» Ä‘áº¿n nÃºt báº£ng bÄƒm káº¿ tiáº¿p trong trÆ°á»ng há»£p xáº£y ra va cháº¡m (collision), Ä‘á»ƒ táº¡o thÃ nh má»™t danh sÃ¡ch liÃªn káº¿t.</li></ul><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624215319.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>Cáº¥u trÃºc <code>dict</code> trong Redis Ä‘áº¡i diá»‡n cho tá»« Ä‘iá»ƒn:</p><div class="language-c line-numbers-mode" data-ext="c" data-title="c"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">typedef</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> struct</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> dict {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // HÃ m Ä‘áº·c thÃ¹ cho tá»«ng loáº¡i</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    dictType </span><span style="color:#C678DD;--shiki-dark:#C678DD;">*</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">type;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Dá»¯ liá»‡u riÃªng tÆ°</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    void</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> *</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">privdata;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Báº£ng bÄƒm</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    dictht </span><span style="color:#E06C75;--shiki-dark:#E06C75;">ht</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[</span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Chá»‰ sá»‘ tÃ¡i bÄƒm</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Náº¿u khÃ´ng tÃ¡i bÄƒm thÃ¬ giÃ¡ trá»‹ lÃ  -1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    int</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> rehashidx;</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;"> /* rehashing not in progress if rehashidx == -1 */</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">} dict;</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Thuá»™c tÃ­nh <code>type</code> vÃ  <code>privdata</code> Ä‘Æ°á»£c sá»­ dá»¥ng cho cÃ¡c hÃ m Ä‘áº·c thÃ¹ cá»§a tá»«ng loáº¡i, cho phÃ©p Redis triá»ƒn khai tá»« Ä‘iá»ƒn Ä‘a hÃ¬nh.</li><li>Thuá»™c tÃ­nh <code>ht</code> lÃ  má»™t máº£ng cÃ³ 2 pháº§n tá»­, má»—i pháº§n tá»­ lÃ  má»™t cáº¥u trÃºc <code>dictht</code> báº£ng bÄƒm. ThÃ´ng thÆ°á»ng, tá»« Ä‘iá»ƒn chá»‰ sá»­ dá»¥ng <code>ht[0]</code>, <code>ht[1]</code> Ä‘Æ°á»£c sá»­ dá»¥ng chá»‰ khi tÃ¡i bÄƒm (rehashing).</li><li>Thuá»™c tÃ­nh <code>rehashidx</code> lÃ  chá»‰ sá»‘ tÃ¡i bÄƒm, ghi nháº­n tiáº¿n Ä‘á»™ tÃ¡i bÄƒm hiá»‡n táº¡i. Náº¿u khÃ´ng cÃ³ tÃ¡i bÄƒm nÃ o Ä‘ang diá»…n ra, giÃ¡ trá»‹ sáº½ lÃ  <code>-1</code>.</li></ul><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624215336.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><h3 id="thuat-toan-bam" tabindex="-1"><a class="header-anchor" href="#thuat-toan-bam"><span>Thuáº­t toÃ¡n bÄƒm</span></a></h3><p>Khi tá»« Ä‘iá»ƒn Ä‘Æ°á»£c sá»­ dá»¥ng lÃ m cÃ i Ä‘áº·t cÆ¡ sá»Ÿ dá»¯ liá»‡u hoáº·c cÃ i Ä‘áº·t cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a cÃ¡c khÃ³a bÄƒm, Redis sá»­ dá»¥ng thuáº­t toÃ¡n <a href="http://code.google.com/p/smhasher/" target="_blank" rel="noopener noreferrer">MurmurHash2</a> Ä‘á»ƒ tÃ­nh toÃ¡n giÃ¡ trá»‹ bÄƒm cá»§a khÃ³a.</p><p>Redis tÃ­nh toÃ¡n giÃ¡ trá»‹ bÄƒm vÃ  chá»‰ má»¥c nhÆ° sau:</p><div class="language-c" data-ext="c" data-title="c"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">// Sá»­ dá»¥ng hÃ m bÄƒm Ä‘Æ°á»£c thiáº¿t láº­p cho tá»« Ä‘iá»ƒn, tÃ­nh toÃ¡n giÃ¡ trá»‹ bÄƒm cá»§a khÃ³a key</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">hash </span><span style="color:#C678DD;--shiki-dark:#C678DD;">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> dict</span><span style="color:#C678DD;--shiki-dark:#C678DD;">-&gt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">type</span><span style="color:#C678DD;--shiki-dark:#C678DD;">-&gt;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">hashFunction</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E06C75;--shiki-dark:#E06C75;">key</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">// Sá»­ dá»¥ng thuá»™c tÃ­nh sizemask cá»§a báº£ng bÄƒm vÃ  giÃ¡ trá»‹ bÄƒm Ä‘á»ƒ tÃ­nh chá»‰ má»¥c</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">// TÃ¹y vÃ o hoÃ n cáº£nh, ht[x] cÃ³ thá»ƒ lÃ  ht[0] hoáº·c ht[1]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">index </span><span style="color:#C678DD;--shiki-dark:#C678DD;">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> hash </span><span style="color:#C678DD;--shiki-dark:#C678DD;">&amp;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> dict</span><span style="color:#C678DD;--shiki-dark:#C678DD;">-&gt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">ht</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[x].sizemask;</span></span></code></pre></div><h3 id="xu-ly-va-cham" tabindex="-1"><a class="header-anchor" href="#xu-ly-va-cham"><span>Xá»­ lÃ½ va cháº¡m</span></a></h3><p>Khi hai hoáº·c nhiá»u hÆ¡n hai khÃ³a Ä‘Æ°á»£c gÃ¡n vÃ o cÃ¹ng má»™t chá»‰ má»¥c cá»§a máº£ng báº£ng bÄƒm, chÃºng ta gá»i lÃ  xáº£y ra va cháº¡m (collision).</p><p>Redis sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p xá»­ lÃ½ va cháº¡m dÃ¹ng chuá»—i riÃªng (separate chaining) Ä‘á»ƒ giáº£i quyáº¿t cÃ¡c va cháº¡m: Má»—i nÃºt báº£ng bÄƒm cÃ³ má»™t con trá» <code>next</code>, nhiá»u nÃºt báº£ng bÄƒm cÃ³ thá»ƒ Ä‘Æ°á»£c káº¿t ná»‘i vá»›i nhau Ä‘á»ƒ táº¡o thÃ nh má»™t danh sÃ¡ch liÃªn káº¿t Ä‘Æ¡n hÆ°á»›ng, cÃ¡c nÃºt nÃ y Ä‘Æ°á»£c gÃ¡n vÃ o cÃ¹ng má»™t chá»‰ má»¥c sáº½ Ä‘Æ°á»£c káº¿t ná»‘i vá»›i nhau qua danh sÃ¡ch liÃªn káº¿t nÃ y, tá»« Ä‘Ã³ giáº£i quyáº¿t Ä‘Æ°á»£c váº¥n Ä‘á» cá»§a va cháº¡m.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624215524.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><h3 id="rehash" tabindex="-1"><a class="header-anchor" href="#rehash"><span>rehash</span></a></h3><h4 id="cac-buoc-cua-rehash" tabindex="-1"><a class="header-anchor" href="#cac-buoc-cua-rehash"><span>CÃ¡c bÆ°á»›c cá»§a rehash</span></a></h4><ol><li><p><strong>PhÃ¢n bá»• khÃ´ng gian cho <code>ht[1]</code>:</strong></p><ul><li>Táº¡o khÃ´ng gian cho báº£ng bÄƒm <code>ht[1]</code> cá»§a tá»« Ä‘iá»ƒn, kÃ­ch thÆ°á»›c cá»§a báº£ng nÃ y phá»¥ thuá»™c vÃ o hoáº¡t Ä‘á»™ng cá»¥ thá»ƒ vÃ  sá»‘ lÆ°á»£ng cáº·p khÃ³a-giÃ¡ trá»‹ hiá»‡n cÃ³ trong <code>ht[0]</code> (Ä‘Æ°á»£c biá»ƒu diá»…n bá»Ÿi thuá»™c tÃ­nh <code>ht[0].used</code>).</li></ul></li><li><p><strong>Di chuyá»ƒn táº¥t cáº£ cÃ¡c cáº·p khÃ³a-giÃ¡ trá»‹ tá»« <code>ht[0]</code> sang <code>ht[1]</code>:</strong></p><ul><li>Rehashing Ä‘á» cáº­p Ä‘áº¿n viá»‡c tÃ­nh toÃ¡n láº¡i giÃ¡ trá»‹ bÄƒm cá»§a khÃ³a vÃ  chá»‰ má»¥c cá»§a nÃ³, sau Ä‘Ã³ Ä‘áº·t cáº·p khÃ³a-giÃ¡ trá»‹ vÃ o vá»‹ trÃ­ xÃ¡c Ä‘á»‹nh trong báº£ng bÄƒm <code>ht[1]</code>.</li></ul></li><li><p><strong>Khi táº¥t cáº£ cÃ¡c cáº·p khÃ³a-giÃ¡ trá»‹ tá»« <code>ht[0]</code> Ä‘Ã£ Ä‘Æ°á»£c di chuyá»ƒn sang <code>ht[1]</code>:</strong></p><ul><li><code>ht[0]</code> sáº½ trá»Ÿ thÃ nh báº£ng rá»—ng, Ä‘Æ°á»£c giáº£i phÃ³ng, vÃ  <code>ht[1]</code> sáº½ Ä‘Æ°á»£c thiáº¿t láº­p lÃ  <code>ht[0]</code>.</li><li>Má»™t báº£ng bÄƒm má»›i trá»‘ng sáº½ Ä‘Æ°á»£c táº¡o cho <code>ht[1]</code>, chuáº©n bá»‹ cho láº§n rehash tiáº¿p theo.</li></ul></li></ol><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624215901.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624215909.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624215917.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624215924.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624215931.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624215938.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><h4 id="cac-Ä‘ieu-kien-Ä‘e-thuc-hien-rehash" tabindex="-1"><a class="header-anchor" href="#cac-Ä‘ieu-kien-Ä‘e-thuc-hien-rehash"><span>CÃ¡c Ä‘iá»u kiá»‡n Ä‘á»ƒ thá»±c hiá»‡n rehash</span></a></h4><ul><li><p>Khi má»™t trong nhá»¯ng Ä‘iá»u kiá»‡n sau Ä‘Æ°á»£c Ä‘Ã¡p á»©ng, Redis sáº½ tá»± Ä‘á»™ng báº¯t Ä‘áº§u má»Ÿ rá»™ng báº£ng bÄƒm:</p><ol><li>Server hiá»‡n khÃ´ng thá»±c thi lá»‡nh BGSAVE hoáº·c BGREWRITEAOF vÃ  há»‡ sá»‘ táº£i cá»§a báº£ng bÄƒm (<code>load factor</code>) lá»›n hÆ¡n hoáº·c báº±ng <code>1</code>.</li><li>Server Ä‘ang thá»±c thi lá»‡nh BGSAVE hoáº·c BGREWRITEAOF vÃ  há»‡ sá»‘ táº£i cá»§a báº£ng bÄƒm lá»›n hÆ¡n hoáº·c báº±ng <code>5</code>.</li></ol><p>Há»‡ sá»‘ táº£i cá»§a báº£ng bÄƒm cÃ³ thá»ƒ tÃ­nh theo cÃ´ng thá»©c sau:</p><div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span>load_factor = ht[0].used / ht[0].size</span></span></code></pre></div></li></ul><h4 id="rehash-tung-buoc-progressive-rehash" tabindex="-1"><a class="header-anchor" href="#rehash-tung-buoc-progressive-rehash"><span>Rehash tá»«ng bÆ°á»›c (Progressive rehash)</span></a></h4><ul><li>BÆ°á»›c chi tiáº¿t cá»§a rehash tiáº¿n bá»™ nhÆ° sau: <ol><li>PhÃ¢n bá»• khÃ´ng gian cho <code>ht[1]</code>, cho phÃ©p tá»« Ä‘iá»ƒn giá»¯ cáº£ hai báº£ng bÄƒm <code>ht[0]</code> vÃ  <code>ht[1]</code>.</li><li>Duy trÃ¬ má»™t biáº¿n Ä‘áº¿m chá»‰ má»¥c rehash <code>rehashidx</code> trong tá»« Ä‘iá»ƒn vÃ  thiáº¿t láº­p nÃ³ báº±ng <code>0</code> Ä‘á»ƒ báº¯t Ä‘áº§u cÃ´ng viá»‡c rehash.</li><li>Trong suá»‘t quÃ¡ trÃ¬nh rehash, má»—i láº§n thá»±c hiá»‡n thÃªm, xÃ³a, tÃ¬m kiáº¿m hoáº·c cáº­p nháº­t trong tá»« Ä‘iá»ƒn, chÆ°Æ¡ng trÃ¬nh sáº½ thá»±c hiá»‡n rehash táº¥t cáº£ cÃ¡c cáº·p khÃ³a-giÃ¡ trá»‹ cá»§a <code>ht[0]</code> táº¡i chá»‰ má»¥c <code>rehashidx</code> sang <code>ht[1]</code>.</li><li>Sau khi cÃ´ng viá»‡c rehash hoÃ n táº¥t, giÃ¡ trá»‹ cá»§a <code>rehashidx</code> sáº½ tÄƒng lÃªn má»™t.</li><li>Khi má»i cáº·p khÃ³a-giÃ¡ trá»‹ tá»« <code>ht[0]</code> Ä‘Ã£ Ä‘Æ°á»£c rehash sang <code>ht[1]</code>, Redis sáº½ Ä‘áº·t giÃ¡ trá»‹ cá»§a <code>rehashidx</code> thÃ nh <code>-1</code>, chá»‰ ra ráº±ng cÃ´ng viá»‡c rehash Ä‘Ã£ hoÃ n thÃ nh.</li></ol></li></ul><p>Qua viá»‡c sá»­ dá»¥ng MurmurHash2 vÃ  phÆ°Æ¡ng phÃ¡p xá»­ lÃ½ va cháº¡m báº±ng chuá»—i riÃªng, Redis Ä‘áº£m báº£o hiá»‡u quáº£ vÃ  hiá»‡u suáº¥t cá»§a tá»« Ä‘iá»ƒn trong viá»‡c lÆ°u trá»¯ vÃ  truy xuáº¥t cÃ¡c cáº·p khÃ³a-giÃ¡ trá»‹ má»™t cÃ¡ch hiá»‡u quáº£.</p><h2 id="skip-list" tabindex="-1"><a class="header-anchor" href="#skip-list"><span>Skip List</span></a></h2><h3 id="gioi-thieu-ve-skip-list" tabindex="-1"><a class="header-anchor" href="#gioi-thieu-ve-skip-list"><span>Giá»›i thiá»‡u vá» Skip List</span></a></h3><p>Skip List (hay cÃ²n gá»i lÃ  skiplist) lÃ  má»™t cáº¥u trÃºc dá»¯ liá»‡u sáº¯p xáº¿p, Ä‘Æ°á»£c xÃ¢y dá»±ng dá»±a trÃªn cÃ¡c con trá» ná»‘i Ä‘áº¿n cÃ¡c nÃºt khÃ¡c nhau trong má»—i nÃºt Ä‘á»ƒ thá»±c hiá»‡n viá»‡c truy cáº­p nhanh chÃ³ng vÃ o cÃ¡c nÃºt. Skip List há»— trá»£ viá»‡c tÃ¬m kiáº¿m cÃ¡c nÃºt vá»›i Ä‘á»™ phá»©c táº¡p trung bÃ¬nh lÃ  O(log N), trong trÆ°á»ng há»£p xáº¥u nháº¥t lÃ  O(N), vÃ  cÅ©ng há»— trá»£ cÃ¡c thao tÃ¡c tuáº§n tá»± Ä‘á»ƒ xá»­ lÃ½ cÃ¡c nÃºt má»™t cÃ¡ch nhanh chÃ³ng.</p><p>Trong háº§u háº¿t cÃ¡c trÆ°á»ng há»£p, hiá»‡u suáº¥t cá»§a Skip List cÃ³ thá»ƒ sÃ¡nh ngang vá»›i cÃ¢y cÃ¢n báº±ng vÃ  vÃ¬ cÃ¡ch thá»©c triá»ƒn khai Ä‘Æ¡n giáº£n hÆ¡n, nÃªn cÃ³ nhiá»u chÆ°Æ¡ng trÃ¬nh sá»­ dá»¥ng Skip List Ä‘á»ƒ thay tháº¿ cho cÃ¢y cÃ¢n báº±ng.</p><p>Redis sá»­ dá»¥ng Skip List lÃ m má»™t trong cÃ¡c triá»ƒn khai cÆ¡ sá»Ÿ cá»§a cÃ¡c khÃ³a táº­p há»£p cÃ³ thá»© tá»±: náº¿u má»™t táº­p há»£p cÃ³ thá»© tá»± chá»©a má»™t sá»‘ lÆ°á»£ng pháº§n tá»­ lá»›n, hoáº·c cÃ¡c thÃ nh viÃªn trong táº­p há»£p cÃ³ thá»© tá»± lÃ  cÃ¡c chuá»—i dÃ i, Redis sáº½ sá»­ dá»¥ng Skip List lÃ m cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a khÃ³a táº­p há»£p cÃ³ thá»© tá»±.</p><p>BÃªn cáº¡nh Ä‘Ã³, Redis cÅ©ng sá»­ dá»¥ng Skip List trong cÃ¡c nÃºt cá»¥m cá»§a máº¡ng lÆ°á»›i.</p><h3 id="trien-khai-skip-list" tabindex="-1"><a class="header-anchor" href="#trien-khai-skip-list"><span>Triá»ƒn khai Skip List</span></a></h3><p>Triá»ƒn khai Skip List trong Redis bao gá»“m hai cáº¥u trÃºc: <code>zskiplist</code> vÃ  <code>zskiplistNode</code>, trong Ä‘Ã³ <code>zskiplist</code> Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ lÆ°u trá»¯ thÃ´ng tin cá»§a Skip List (vÃ­ dá»¥ nhÆ° nÃºt Ä‘áº§u tiÃªn vÃ  nÃºt cuá»‘i cÃ¹ng cá»§a Skip List, Ä‘á»™ dÃ i), vÃ  <code>zskiplistNode</code> Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘áº¡i diá»‡n cho tá»«ng nÃºt trong Skip List.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624220250.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>Cáº¥u trÃºc cá»§a <code>zskiplist</code> Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a nhÆ° sau:</p><div class="language-c" data-ext="c" data-title="c"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">typedef</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> struct</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> zskiplist {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Con trá» Ä‘áº¿n nÃºt Ä‘áº§u tiÃªn vÃ  nÃºt cuá»‘i cÃ¹ng cá»§a Skip List</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    struct</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> zskiplistNode </span><span style="color:#C678DD;--shiki-dark:#C678DD;">*</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">header, </span><span style="color:#C678DD;--shiki-dark:#C678DD;">*</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">tail;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Sá»‘ lÆ°á»£ng nÃºt trong Skip List</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    unsigned</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> long</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> length;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Sá»‘ lá»›p cá»§a nÃºt cÃ³ sá»‘ lÆ°á»£ng lá»›n nháº¥t trong Skip List</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    int</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> level;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">} zskiplist;</span></span></code></pre></div><ul><li>Con trá» <code>header</code> vÃ  <code>tail</code> láº§n lÆ°á»£t trá» tá»›i nÃºt Ä‘áº§u tiÃªn vÃ  nÃºt cuá»‘i cÃ¹ng cá»§a Skip List, cho phÃ©p viá»‡c xÃ¡c Ä‘á»‹nh nÃºt Ä‘áº§u vÃ  nÃºt cuá»‘i cá»§a Skip List vá»›i Ä‘á»™ phá»©c táº¡p O(1).</li><li>Thuá»™c tÃ­nh <code>length</code> lÆ°u trá»¯ sá»‘ lÆ°á»£ng nÃºt trong Skip List, cho phÃ©p tráº£ vá» Ä‘á»™ dÃ i cá»§a Skip List vá»›i Ä‘á»™ phá»©c táº¡p O(1).</li><li>Thuá»™c tÃ­nh <code>level</code> Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh sá»‘ lá»›p cá»§a nÃºt cÃ³ sá»‘ lÆ°á»£ng lá»›n nháº¥t trong Skip List, vá»›i má»—i nÃºt trong Skip List cÃ³ sá»‘ lá»›p tá»« 1 Ä‘áº¿n 32 Ä‘Æ°á»£c chá»n ngáº«u nhiÃªn.</li></ul><p>Cáº¥u trÃºc cá»§a nÃºt Skip List <code>zskiplistNode</code> Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a nhÆ° sau:</p><div class="language-c line-numbers-mode" data-ext="c" data-title="c"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">typedef</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> struct</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> zskiplistNode {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Con trá» lÃ¹i</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    struct</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> zskiplistNode </span><span style="color:#C678DD;--shiki-dark:#C678DD;">*</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">backward;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Äiá»ƒm sá»‘</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    double</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> score;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Äá»‘i tÆ°á»£ng thÃ nh viÃªn</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    robj </span><span style="color:#C678DD;--shiki-dark:#C678DD;">*</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">obj;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // CÃ¡c lá»›p</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    struct</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> zskiplistLevel {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">        // Con trá» tiáº¿n</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        struct</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> zskiplistNode </span><span style="color:#C678DD;--shiki-dark:#C678DD;">*</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">forward;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">        // Khoáº£ng cÃ¡ch</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        unsigned</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> int</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> span;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    } level</span><span style="color:#C678DD;--shiki-dark:#C678DD;">[]</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">} zskiplistNode;</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>CÃ¡c cáº¥p (level)</strong>: Má»—i cáº¥p bao gá»“m má»™t con trá» tiáº¿n vÃ  má»™t khoáº£ng cÃ¡ch. Con trá» tiáº¿n Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ truy cáº­p cÃ¡c nÃºt khÃ¡c á»Ÿ phÃ­a cuá»‘i cá»§a Skip List vÃ  khoáº£ng cÃ¡ch ghi láº¡i sá»± khÃ¡c biá»‡t giá»¯a nÃºt tiáº¿n vÃ  nÃºt hiá»‡n táº¡i trong Skip List. Trong hÃ¬nh áº£nh trÃªn, cÃ¡c mÅ©i tÃªn cÃ³ sá»‘ thá»ƒ hiá»‡n con trá» tiáº¿n vÃ  sá»‘ lÆ°á»£ng thá»ƒ hiá»‡n khoáº£ng cÃ¡ch. Khi báº¡n Ä‘i qua tá»« nÃºt Ä‘áº§u Ä‘áº¿n nÃºt cuá»‘i, hÃ nh vi duyá»‡t theo cáº¥p sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng.</li><li><strong>Con trá» lÃ¹i (backward)</strong>: Con trá» lÃ¹i chá»‰ Ä‘áº¿n nÃºt trÆ°á»›c nÃºt hiá»‡n táº¡i. Khi duyá»‡t tá»« cuá»‘i Ä‘áº¿n Ä‘áº§u cá»§a Skip List, báº¡n sá»­ dá»¥ng con trá» lÃ¹i.</li><li><strong>Äiá»ƒm sá»‘ (score)</strong>: Trong Skip List, cÃ¡c nÃºt Ä‘Æ°á»£c sáº¯p xáº¿p theo Ä‘iá»ƒm sá»‘ tá»« tháº¥p Ä‘áº¿n cao. Trong cÃ¹ng má»™t Skip List, nhiá»u nÃºt cÃ³ thá»ƒ chá»©a cÃ¹ng má»™t Ä‘iá»ƒm sá»‘, nhÆ°ng Ä‘á»‘i tÆ°á»£ng thÃ nh viÃªn cá»§a má»—i nÃºt pháº£i lÃ  duy nháº¥t. CÃ¡c nÃºt trong Skip List Ä‘Æ°á»£c sáº¯p xáº¿p theo Ä‘iá»ƒm sá»‘ vÃ  khi Ä‘iá»ƒm sá»‘ giá»‘ng nhau, cÃ¡c nÃºt Ä‘Æ°á»£c sáº¯p xáº¿p theo kÃ­ch thÆ°á»›c cá»§a thÃ nh viÃªn.</li><li><strong>Äá»‘i tÆ°á»£ng thÃ nh viÃªn (obj)</strong>: Trong má»—i nÃºt, <code>o1</code>, <code>o2</code> vÃ  <code>o3</code> lÃ  cÃ¡c thÃ nh viÃªn cá»§a nÃºt.</li></ul><h2 id="tap-hop-so-nguyen" tabindex="-1"><a class="header-anchor" href="#tap-hop-so-nguyen"><span>Táº­p há»£p sá»‘ nguyÃªn</span></a></h2><h3 id="gioi-thieu-ve-tap-hop-so-nguyen" tabindex="-1"><a class="header-anchor" href="#gioi-thieu-ve-tap-hop-so-nguyen"><span>Giá»›i thiá»‡u vá» táº­p há»£p sá»‘ nguyÃªn</span></a></h3><p><strong>Táº­p há»£p sá»‘ nguyÃªn (intset)</strong> lÃ  má»™t trong nhá»¯ng cÃ¡ch thá»©c lÆ°u trá»¯ dá»¯ liá»‡u cá»§a Redis cho cÃ¡c táº­p há»£p cÃ³ cÃ¡c pháº§n tá»­ lÃ  sá»‘ nguyÃªn. Khi má»™t táº­p há»£p chá»‰ bao gá»“m cÃ¡c pháº§n tá»­ sá»‘ nguyÃªn vÃ  sá»‘ lÆ°á»£ng pháº§n tá»­ khÃ´ng nhiá»u, Redis sáº½ sá»­ dá»¥ng cáº¥u trÃºc dá»¯ liá»‡u táº­p há»£p sá»‘ nguyÃªn Ä‘á»ƒ lÃ m cÆ¡ sá»Ÿ dá»¯ liá»‡u.</p><p><strong>Cáº¥u trÃºc dÆ°á»›i cá»§a táº­p há»£p sá»‘ nguyÃªn lÃ  má»™t máº£ng, máº£ng nÃ y lÆ°u trá»¯ cÃ¡c pháº§n tá»­ cá»§a táº­p há»£p theo cÃ¡ch sáº¯p xáº¿p khÃ´ng trÃ¹ng láº·p</strong>.</p><p><strong>Hoáº¡t Ä‘á»™ng nÃ¢ng cáº¥p mang láº¡i tÃ­nh linh hoáº¡t cho táº­p há»£p sá»‘ nguyÃªn vÃ  cÅ©ng tiáº¿t kiá»‡m bá»™ nhá»› cÃ ng nhiá»u cÃ ng tá»‘t</strong>.</p><p><strong>Táº­p há»£p sá»‘ nguyÃªn chá»‰ há»— trá»£ hoáº¡t Ä‘á»™ng nÃ¢ng cáº¥p, khÃ´ng há»— trá»£ hoáº¡t Ä‘á»™ng háº¡ cáº¥p</strong>.</p><h3 id="trien-khai-tap-hop-so-nguyen" tabindex="-1"><a class="header-anchor" href="#trien-khai-tap-hop-so-nguyen"><span>Triá»ƒn khai táº­p há»£p sá»‘ nguyÃªn</span></a></h3><p>Táº­p há»£p sá»‘ nguyÃªn lÃ  cáº¥u trÃºc dá»¯ liá»‡u trá»«u tÆ°á»£ng cá»§a Redis Ä‘á»ƒ lÆ°u trá»¯ cÃ¡c giÃ¡ trá»‹ sá»‘ nguyÃªn dÆ°á»›i dáº¡ng <code>int16_t</code>, <code>int32_t</code>, hoáº·c <code>int64_t</code>, Ä‘áº£m báº£o ráº±ng khÃ´ng cÃ³ cÃ¡c pháº§n tá»­ trÃ¹ng láº·p trong táº­p há»£p.</p><p>Má»—i cáº¥u trÃºc <code>intset</code> trong <code>intset.h/intset</code> biá»ƒu thá»‹ má»™t táº­p há»£p sá»‘ nguyÃªn:</p><div class="language-c" data-ext="c" data-title="c"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">typedef</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> struct</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> intset {</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // PhÆ°Æ¡ng thá»©c mÃ£ hÃ³a</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    uint32_t</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> encoding;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Sá»‘ lÆ°á»£ng pháº§n tá»­ trong táº­p há»£p</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    uint32_t</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> length;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Máº£ng lÆ°u trá»¯ cÃ¡c pháº§n tá»­</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    int8_t</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> contents</span><span style="color:#C678DD;--shiki-dark:#C678DD;">[]</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">} intset;</span></span></code></pre></div><ul><li>Máº£ng <code>contents</code> lÃ  triá»ƒn khai cÆ¡ sá»Ÿ cá»§a táº­p há»£p sá»‘ nguyÃªn: Má»—i pháº§n tá»­ cá»§a táº­p há»£p sá»‘ nguyÃªn lÃ  má»™t pháº§n tá»­ máº£ng (<code>item</code>) cá»§a <code>contents</code>, cÃ¡c pháº§n tá»­ Ä‘Æ°á»£c sáº¯p xáº¿p theo thá»© tá»± tá»« bÃ© Ä‘áº¿n lá»›n vÃ  khÃ´ng chá»©a báº¥t ká»³ pháº§n tá»­ nÃ o lÃ m láº·p láº¡i.</li><li>Thuá»™c tÃ­nh <code>length</code> ghi láº¡i sá»‘ lÆ°á»£ng pháº§n tá»­ hiá»‡n táº¡i trong táº­p há»£p sá»‘ nguyÃªn, tá»©c lÃ  Ä‘á»™ dÃ i cá»§a máº£ng <code>contents</code>.</li><li>Máº·c dÃ¹ cáº¥u trÃºc <code>intset</code> khai bÃ¡o thuá»™c tÃ­nh <code>contents</code> lÃ  má»™t máº£ng kiá»ƒu <code>int8_t</code>, thá»±c táº¿ máº£ng <code>contents</code> khÃ´ng lÆ°u trá»¯ báº¥t ká»³ giÃ¡ trá»‹ kiá»ƒu <code>int8_t</code> nÃ o â€” kiá»ƒu thá»±c sá»± cá»§a máº£ng <code>contents</code> phá»¥ thuá»™c vÃ o giÃ¡ trá»‹ cá»§a thuá»™c tÃ­nh <code>encoding</code>: <ul><li>Náº¿u thuá»™c tÃ­nh <code>encoding</code> cÃ³ giÃ¡ trá»‹ lÃ  <code>INTSET_ENC_INT16</code>, thÃ¬ <code>contents</code> lÃ  má»™t máº£ng kiá»ƒu <code>int16_t</code> vá»›i má»—i pháº§n tá»­ lÃ  má»™t sá»‘ nguyÃªn kiá»ƒu <code>int16_t</code> (giÃ¡ trá»‹ nhá» nháº¥t lÃ  <code>-32,768</code>, lá»›n nháº¥t lÃ  <code>32,767</code>).</li><li>Náº¿u thuá»™c tÃ­nh <code>encoding</code> cÃ³ giÃ¡ trá»‹ lÃ  <code>INTSET_ENC_INT32</code>, thÃ¬ <code>contents</code> lÃ  má»™t máº£ng kiá»ƒu <code>int32_t</code> vá»›i má»—i pháº§n tá»­ lÃ  má»™t sá»‘ nguyÃªn kiá»ƒu <code>int32_t</code> (giÃ¡ trá»‹ nhá» nháº¥t lÃ  <code>-2,147,483,648</code>, lá»›n nháº¥t lÃ  <code>2,147,483,647</code>).</li><li>Náº¿u thuá»™c tÃ­nh <code>encoding</code> cÃ³ giÃ¡ trá»‹ lÃ  <code>INTSET_ENC_INT64</code>, thÃ¬ <code>contents</code> lÃ  má»™t máº£ng kiá»ƒu <code>int64_t</code> vá»›i má»—i pháº§n tá»­ lÃ  má»™t sá»‘ nguyÃªn kiá»ƒu <code>int64_t</code> (giÃ¡ trá»‹ nhá» nháº¥t lÃ  <code>-9,223,372,036,854,775,808</code>, lá»›n nháº¥t lÃ  <code>9,223,372,036,854,775,807</code>).</li></ul></li></ul><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624221034.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624221123.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><h3 id="nang-cap-tap-hop-so-nguyen" tabindex="-1"><a class="header-anchor" href="#nang-cap-tap-hop-so-nguyen"><span>NÃ¢ng cáº¥p táº­p há»£p sá»‘ nguyÃªn</span></a></h3><p>Má»—i khi báº¡n thÃªm má»™t pháº§n tá»­ má»›i vÃ o táº­p há»£p sá»‘ nguyÃªn vÃ  kiá»ƒu dá»¯ liá»‡u cá»§a pháº§n tá»­ má»›i dÃ i hÆ¡n so vá»›i táº¥t cáº£ cÃ¡c pháº§n tá»­ hiá»‡n cÃ³ trong táº­p há»£p sá»‘ nguyÃªn, táº­p há»£p sá»‘ nguyÃªn sáº½ cáº§n pháº£i thá»±c hiá»‡n má»™t hoáº¡t Ä‘á»™ng nÃ¢ng cáº¥p trÆ°á»›c khi thÃªm pháº§n tá»­ má»›i vÃ o.</p><p>Hoáº¡t Ä‘á»™ng nÃ¢ng cáº¥p vÃ  thÃªm pháº§n tá»­ má»›i vÃ o táº­p há»£p sá»‘ nguyÃªn Ä‘Æ°á»£c thá»±c hiá»‡n theo ba bÆ°á»›c:</p><ol><li>Má»Ÿ rá»™ng kÃ­ch thÆ°á»›c cá»§a máº£ng cÆ¡ sá»Ÿ cá»§a táº­p há»£p sá»‘ nguyÃªn dá»±a trÃªn kiá»ƒu dá»¯ liá»‡u cá»§a pháº§n tá»­ má»›i.</li><li>Chuyá»ƒn Ä‘á»•i táº¥t cáº£ cÃ¡c pháº§n tá»­ hiá»‡n cÃ³ trong máº£ng cÆ¡ sá»Ÿ sang kiá»ƒu dá»¯ liá»‡u giá»‘ng nhau vá»›i pháº§n tá»­ má»›i vÃ  sáº¯p xáº¿p cÃ¡c pháº§n tá»­ Ä‘Ã£ Ä‘Æ°á»£c chuyá»ƒn Ä‘á»•i nÃ y theo thá»© tá»±.</li><li>ThÃªm pháº§n tá»­ má»›i vÃ o máº£ng cÆ¡ sá»Ÿ.</li></ol><p>Bá»Ÿi vÃ¬ má»—i láº§n thÃªm pháº§n tá»­ má»›i vÃ o táº­p há»£p sá»‘ nguyÃªn cÃ³ thá»ƒ dáº«n Ä‘áº¿n viá»‡c nÃ¢ng cáº¥p, vÃ  má»—i láº§n nÃ¢ng cáº¥p Ä‘á»u pháº£i chuyá»ƒn Ä‘á»•i láº¡i táº¥t cáº£ cÃ¡c pháº§n tá»­ hiá»‡n cÃ³ trong máº£ng cÆ¡ sá»Ÿ, do Ä‘Ã³ thá»i gian phá»¥c vá»¥ thÃªm pháº§n tá»­ má»›i vÃ o táº­p há»£p sá»‘ nguyÃªn lÃ  O(N).</p><h2 id="danh-sach-nen" tabindex="-1"><a class="header-anchor" href="#danh-sach-nen"><span>Danh sÃ¡ch nÃ©n</span></a></h2><h3 id="Ä‘inh-nghia-ve-danh-sach-nen" tabindex="-1"><a class="header-anchor" href="#Ä‘inh-nghia-ve-danh-sach-nen"><span>Äá»‹nh nghÄ©a vá» Danh sÃ¡ch nÃ©n</span></a></h3><p><strong>Danh sÃ¡ch nÃ©n (ziplist)</strong> lÃ  má»™t cáº¥u trÃºc dá»¯ liá»‡u tuáº§n tá»± Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ tiáº¿t kiá»‡m bá»™ nhá»›.</p><p><strong>Danh sÃ¡ch nÃ©n Ä‘Æ°á»£c sá»­ dá»¥ng nhÆ° má»™t trong cÃ¡c triá»ƒn khai dÆ°á»›i cÃ¹ng cá»§a khÃ³a danh sÃ¡ch vÃ  khÃ³a bÄƒm trong Redis</strong>.</p><ul><li>Khi má»™t khÃ³a danh sÃ¡ch chá»‰ chá»©a má»™t sá»‘ lÆ°á»£ng Ã­t cÃ¡c má»¥c danh sÃ¡ch vÃ  má»—i má»¥c danh sÃ¡ch lÃ  giÃ¡ trá»‹ sá»‘ nguyÃªn nhá» hoáº·c chuá»—i cÃ³ Ä‘á»™ dÃ i ngáº¯n, Redis sáº½ sá»­ dá»¥ng danh sÃ¡ch nÃ©n lÃ m triá»ƒn khai dÆ°á»›i cÃ¹ng cá»§a khÃ³a danh sÃ¡ch.</li><li>Khi má»™t khÃ³a bÄƒm chá»‰ chá»©a má»™t sá»‘ lÆ°á»£ng Ã­t cÃ¡c cáº·p khÃ³a-giÃ¡ trá»‹ vÃ  má»—i cáº·p khÃ³a-giÃ¡ trá»‹ cÃ³ khÃ³a vÃ  giÃ¡ trá»‹ lÃ  sá»‘ nguyÃªn nhá» hoáº·c chuá»—i cÃ³ Ä‘á»™ dÃ i ngáº¯n, Redis sáº½ sá»­ dá»¥ng danh sÃ¡ch nÃ©n lÃ m triá»ƒn khai dÆ°á»›i cÃ¹ng cá»§a khÃ³a bÄƒm.</li></ul><p><strong>Danh sÃ¡ch nÃ©n cÃ³ thá»ƒ chá»©a nhiá»u nÃºt, má»—i nÃºt cÃ³ thá»ƒ lÆ°u trá»¯ má»™t máº£ng byte hoáº·c giÃ¡ trá»‹ sá»‘ nguyÃªn</strong>.</p><p>ThÃªm má»™t nÃºt má»›i vÃ o danh sÃ¡ch nÃ©n, hoáº·c xÃ³a nÃºt tá»« danh sÃ¡ch nÃ©n, cÃ³ thá»ƒ gÃ¢y ra cÃ¡c hoáº¡t Ä‘á»™ng cáº­p nháº­t chuá»—i, nhÆ°ng kháº£ nÄƒng xáº£y ra Ä‘iá»u nÃ y khÃ´ng cao.</p><h3 id="trien-khai-cua-danh-sach-nen" tabindex="-1"><a class="header-anchor" href="#trien-khai-cua-danh-sach-nen"><span>Triá»ƒn khai cá»§a Danh sÃ¡ch nÃ©n</span></a></h3><p><strong>CÃ¡c thÃ nh pháº§n chi tiáº¿t cá»§a danh sÃ¡ch nÃ©n</strong></p><table><thead><tr><th style="text-align:left;">Thuá»™c tÃ­nh</th><th style="text-align:left;">Kiá»ƒu dá»¯ liá»‡u</th><th style="text-align:left;">Äá»™ dÃ i</th><th style="text-align:left;">Má»¥c Ä‘Ã­ch</th></tr></thead><tbody><tr><td style="text-align:left;"><code>zlbytes</code></td><td style="text-align:left;"><code>uint32_t</code></td><td style="text-align:left;"><code>4</code> byte</td><td style="text-align:left;">Ghi láº¡i sá»‘ byte bá»™ nhá»› chiáº¿m dá»¥ng cá»§a toÃ n bá»™ danh sÃ¡ch nÃ©n: Ä‘Æ°á»£c sá»­ dá»¥ng trong viá»‡c phÃ¢n bá»• láº¡i bá»™ nhá»› cá»§a danh sÃ¡ch nÃ©n hoáº·c khi tÃ­nh vá»‹ trÃ­ <code>zlend</code>.</td></tr><tr><td style="text-align:left;"><code>zltail</code></td><td style="text-align:left;"><code>uint32_t</code></td><td style="text-align:left;"><code>4</code> byte</td><td style="text-align:left;">Ghi láº¡i khoáº£ng cÃ¡ch tá»« nÃºt Ä‘uÃ´i cá»§a danh sÃ¡ch nÃ©n Ä‘áº¿n Ä‘á»‹a chá»‰ báº¯t Ä‘áº§u cá»§a danh sÃ¡ch nÃ©n: thÃ´ng qua lá»‡nh lá»‡nh nÃ y, chÆ°Æ¡ng trÃ¬nh khÃ´ng cáº§n duyá»‡t qua toÃ n bá»™ danh sÃ¡ch nÃ©n mÃ  váº«n cÃ³ thá»ƒ xÃ¡c Ä‘á»‹nh vá»‹ trÃ­ cá»§a nÃºt Ä‘uÃ´i.</td></tr><tr><td style="text-align:left;"><code>zllen</code></td><td style="text-align:left;"><code>uint16_t</code></td><td style="text-align:left;"><code>2</code> byte</td><td style="text-align:left;">Ghi láº¡i sá»‘ lÆ°á»£ng nÃºt cÃ³ trong danh sÃ¡ch nÃ©n: khi giÃ¡ trá»‹ thuá»™c tÃ­nh nÃ y nhá» hÆ¡n <code>UINT16_MAX</code> (<code>65535</code>), nÃ³ biá»ƒu thá»‹ sá»‘ lÆ°á»£ng nÃºt trong danh sÃ¡ch nÃ©n; khi giÃ¡ trá»‹ nÃ y báº±ng <code>UINT16_MAX</code>, sá»‘ lÆ°á»£ng thá»±c sá»± pháº£i Ä‘Æ°á»£c tÃ­nh toÃ¡n báº±ng cÃ¡ch duyá»‡t qua toÃ n bá»™ danh sÃ¡ch nÃ©n.</td></tr><tr><td style="text-align:left;"><code>entryX</code></td><td style="text-align:left;">NÃºt danh sÃ¡ch</td><td style="text-align:left;">KhÃ´ng xÃ¡c Ä‘á»‹nh</td><td style="text-align:left;">CÃ¡c nÃºt Ä‘ang chá»©a trong danh sÃ¡ch nÃ©n, chiá»u dÃ i cá»§a nÃºt phá»¥ thuá»™c vÃ o ná»™i dung mÃ  nÃ³ lÆ°u trá»¯.</td></tr><tr><td style="text-align:left;"><code>zlend</code></td><td style="text-align:left;"><code>uint8_t</code></td><td style="text-align:left;"><code>1</code> byte</td><td style="text-align:left;">GiÃ¡ trá»‹ Ä‘áº·c biá»‡t <code>0xFF</code> (255 trong há»‡ tháº­p phÃ¢n), Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘Ã¡nh dáº¥u káº¿t thÃºc cá»§a danh sÃ¡ch nÃ©n.</td></tr></tbody></table><h2 id="Ä‘oi-tuong-object" tabindex="-1"><a class="header-anchor" href="#Ä‘oi-tuong-object"><span>Äá»‘i tÆ°á»£ng (Object)</span></a></h2><p>Redis khÃ´ng sá»­ dá»¥ng cÃ¡c cáº¥u trÃºc dá»¯ liá»‡u trá»±c tiáº¿p Ä‘á»ƒ triá»ƒn khai cÆ¡ sá»Ÿ dá»¯ liá»‡u khÃ³a-giÃ¡ trá»‹, mÃ  dá»±a trÃªn cÃ¡c cáº¥u trÃºc dá»¯ liá»‡u nÃ y Ä‘á»ƒ táº¡o ra má»™t há»‡ thá»‘ng Ä‘á»‘i tÆ°á»£ng. Há»‡ thá»‘ng nÃ y bao gá»“m nÄƒm loáº¡i Ä‘á»‘i tÆ°á»£ng: chuá»—i, danh sÃ¡ch, báº£ng bÄƒm (hash), táº­p há»£p vÃ  táº­p há»£p cÃ³ thá»© tá»±, má»—i loáº¡i Ä‘á»u sá»­ dá»¥ng Ã­t nháº¥t má»™t trong cÃ¡c cáº¥u trÃºc dá»¯ liá»‡u mÃ  chÃºng ta Ä‘Ã£ giá»›i thiá»‡u trÆ°á»›c Ä‘Ã³.</p><h3 id="gioi-thieu-ve-Ä‘oi-tuong" tabindex="-1"><a class="header-anchor" href="#gioi-thieu-ve-Ä‘oi-tuong"><span>Giá»›i thiá»‡u vá» Äá»‘i tÆ°á»£ng</span></a></h3><p>Má»—i cáº·p khÃ³a-giÃ¡ trá»‹ trong cÆ¡ sá»Ÿ dá»¯ liá»‡u Redis Ä‘á»u lÃ  má»™t Ä‘á»‘i tÆ°á»£ng.</p><p>Redis bao gá»“m nÄƒm loáº¡i Ä‘á»‘i tÆ°á»£ng: chuá»—i (string), danh sÃ¡ch (list), báº£ng bÄƒm (hash), táº­p há»£p (set), vÃ  táº­p há»£p cÃ³ thá»© tá»± (sorted set). Má»—i loáº¡i Ä‘á»‘i tÆ°á»£ng nÃ y Ä‘á»u cÃ³ Ã­t nháº¥t hai cÃ¡ch mÃ£ hÃ³a khÃ¡c nhau hoáº·c nhiá»u hÆ¡n, tá»« Ä‘Ã³ tá»‘i Æ°u hÃ³a hiá»‡u suáº¥t sá»­ dá»¥ng Ä‘á»‘i tÆ°á»£ng trong cÃ¡c tÃ¬nh huá»‘ng khÃ¡c nhau.</p><p>TrÆ°á»›c khi thá»±c hiá»‡n má»™t sá»‘ lá»‡nh nháº¥t Ä‘á»‹nh, mÃ¡y chá»§ sáº½ kiá»ƒm tra xem kiá»ƒu cá»§a khÃ³a cá»¥ thá»ƒ cÃ³ thá»ƒ thá»±c hiá»‡n lá»‡nh Ä‘Ã³ hay khÃ´ng, vÃ  viá»‡c kiá»ƒm tra kiá»ƒu cá»§a má»™t khÃ³a lÃ  kiá»ƒm tra kiá»ƒu Ä‘á»‘i tÆ°á»£ng cá»§a giÃ¡ trá»‹ khÃ³a.</p><p><strong>CÆ¡ cháº¿ thu há»“i bá»™ nhá»› dá»±a trÃªn Ä‘áº¿m tham chiáº¿u</strong> - Há»‡ thá»‘ng Ä‘á»‘i tÆ°á»£ng cá»§a Redis Ä‘i kÃ¨m vá»›i cÆ¡ cháº¿ tá»± Ä‘á»™ng thu há»“i bá»™ nhá»› dá»±a trÃªn Ä‘áº¿m tham chiáº¿u. Khi má»™t Ä‘á»‘i tÆ°á»£ng khÃ´ng cÃ²n Ä‘Æ°á»£c sá»­ dá»¥ng ná»¯a, bá»™ nhá»› cá»§a Ä‘á»‘i tÆ°á»£ng Ä‘Ã³ sáº½ tá»± Ä‘á»™ng Ä‘Æ°á»£c giáº£i phÃ³ng.</p><p><strong>CÆ¡ cháº¿ chia sáº» Ä‘á»‘i tÆ°á»£ng dá»±a trÃªn Ä‘áº¿m tham chiáº¿u</strong> - Redis chia sáº» cÃ¡c Ä‘á»‘i tÆ°á»£ng chuá»—i cÃ³ giÃ¡ trá»‹ tá»« <code>0</code> Ä‘áº¿n <code>9999</code>.</p><p><strong>Thá»i gian chá» rá»—ng cá»§a khÃ³a cÆ¡ sá»Ÿ dá»¯ liá»‡u</strong> - Äá»‘i tÆ°á»£ng ghi láº¡i thá»i gian cuá»‘i cÃ¹ng mÃ  nÃ³ Ä‘Æ°á»£c truy cáº­p, thá»i gian nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ­nh toÃ¡n thá»i gian chá» rá»—ng cá»§a Ä‘á»‘i tÆ°á»£ng.</p><h3 id="kieu-Ä‘oi-tuong-trong-redis" tabindex="-1"><a class="header-anchor" href="#kieu-Ä‘oi-tuong-trong-redis"><span>Kiá»ƒu Ä‘á»‘i tÆ°á»£ng trong Redis</span></a></h3><p>Trong Redis, Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘áº¡i diá»‡n cho cÃ¡c cáº·p khÃ³a vÃ  giÃ¡ trá»‹ trong cÆ¡ sá»Ÿ dá»¯ liá»‡u. Má»—i khi táº¡o má»™t cáº·p khÃ³a giÃ¡ trá»‹ má»›i trong Redis, Ã­t nháº¥t hai Ä‘á»‘i tÆ°á»£ng sáº½ Ä‘Æ°á»£c táº¡o ra: má»™t Ä‘á»‘i tÆ°á»£ng Ä‘á»ƒ lÃ m khÃ³a (Ä‘Æ°á»£c gá»i lÃ  Ä‘á»‘i tÆ°á»£ng khÃ³a), vÃ  má»™t Ä‘á»‘i tÆ°á»£ng Ä‘á»ƒ lÃ m giÃ¡ trá»‹ (Ä‘Æ°á»£c gá»i lÃ  Ä‘á»‘i tÆ°á»£ng giÃ¡ trá»‹).</p><p>Má»—i Ä‘á»‘i tÆ°á»£ng trong Redis Ä‘Æ°á»£c biá»ƒu diá»…n báº±ng má»™t cáº¥u trÃºc <code>redisObject</code>, trong Ä‘Ã³ cÃ³ ba thuá»™c tÃ­nh liÃªn quan Ä‘áº¿n dá»¯ liá»‡u:</p><div class="language-c" data-ext="c" data-title="c"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">typedef</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> struct</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> redisObject {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Kiá»ƒu Ä‘á»‘i tÆ°á»£ng</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    unsigned</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> type:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // MÃ£ hÃ³a</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    unsigned</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> encoding:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Con trá» Ä‘áº¿n cáº¥u trÃºc dá»¯ liá»‡u thá»±c</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    void</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> *</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">ptr;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">} robj;</span></span></code></pre></div><p>Thuá»™c tÃ­nh <code>type</code> cá»§a Ä‘á»‘i tÆ°á»£ng lÆ°u trá»¯ loáº¡i cá»§a Ä‘á»‘i tÆ°á»£ng, vÃ  Redis cÃ³ nhá»¯ng loáº¡i Ä‘á»‘i tÆ°á»£ng sau:</p><table><thead><tr><th style="text-align:left;">Äá»‘i tÆ°á»£ng</th><th style="text-align:left;">GiÃ¡ trá»‹ cá»§a <code>type</code></th><th style="text-align:left;">Káº¿t quáº£ cá»§a lá»‡nh TYPE</th></tr></thead><tbody><tr><td style="text-align:left;">Äá»‘i tÆ°á»£ng chuá»—i</td><td style="text-align:left;"><code>REDIS_STRING</code></td><td style="text-align:left;"><code>&quot;string&quot;</code></td></tr><tr><td style="text-align:left;">Äá»‘i tÆ°á»£ng danh sÃ¡ch</td><td style="text-align:left;"><code>REDIS_LIST</code></td><td style="text-align:left;"><code>&quot;list&quot;</code></td></tr><tr><td style="text-align:left;">Äá»‘i tÆ°á»£ng bÄƒm</td><td style="text-align:left;"><code>REDIS_HASH</code></td><td style="text-align:left;"><code>&quot;hash&quot;</code></td></tr><tr><td style="text-align:left;">Äá»‘i tÆ°á»£ng táº­p há»£p</td><td style="text-align:left;"><code>REDIS_SET</code></td><td style="text-align:left;"><code>&quot;set&quot;</code></td></tr><tr><td style="text-align:left;">Äá»‘i tÆ°á»£ng táº­p cÃ³ thá»© tá»±</td><td style="text-align:left;"><code>REDIS_ZSET</code></td><td style="text-align:left;"><code>&quot;zset&quot;</code></td></tr></tbody></table><p>Trong Redis, khÃ³a cá»§a cáº·p khÃ³a giÃ¡ trá»‹ luÃ´n lÃ  má»™t Ä‘á»‘i tÆ°á»£ng chuá»—i, trong khi giÃ¡ trá»‹ cÃ³ thá»ƒ lÃ  má»™t trong nhá»¯ng loáº¡i Ä‘á»‘i tÆ°á»£ng nhÆ° trÃªn: chuá»—i, danh sÃ¡ch, bÄƒm, táº­p há»£p, hoáº·c táº­p cÃ³ thá»© tá»±.</p><p><strong>VÃ­ dá»¥</strong>: Sá»­ dá»¥ng lá»‡nh <code>TYPE</code> Ä‘á»ƒ xÃ¡c Ä‘á»‹nh loáº¡i Ä‘á»‘i tÆ°á»£ng cá»§a giÃ¡ trá»‹ cho má»—i khÃ³a trong cÆ¡ sá»Ÿ dá»¯ liá»‡u Redis:</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;"># KhÃ³a lÃ  Ä‘á»‘i tÆ°á»£ng chuá»—i, giÃ¡ trá»‹ lÃ  Ä‘á»‘i tÆ°á»£ng chuá»—i</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; SET msg </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Xin chÃ o&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">OK</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; TYPE msg</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">string</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;"># KhÃ³a lÃ  Ä‘á»‘i tÆ°á»£ng chuá»—i, giÃ¡ trá»‹ lÃ  Ä‘á»‘i tÆ°á»£ng danh sÃ¡ch</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; RPUSH numbers 1 3 5</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">3</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; TYPE numbers</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">list</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;"># KhÃ³a lÃ  Ä‘á»‘i tÆ°á»£ng chuá»—i, giÃ¡ trá»‹ lÃ  Ä‘á»‘i tÆ°á»£ng bÄƒm</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; HMSET user id 100 name </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Nguyen&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> age 30</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">OK</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; TYPE user</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">hash</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;"># KhÃ³a lÃ  Ä‘á»‘i tÆ°á»£ng chuá»—i, giÃ¡ trá»‹ lÃ  Ä‘á»‘i tÆ°á»£ng táº­p há»£p</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; SADD cities </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Hanoi&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Ho Chi Minh&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Danang&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">3</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; TYPE cities</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">set</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;"># KhÃ³a lÃ  Ä‘á»‘i tÆ°á»£ng chuá»—i, giÃ¡ trá»‹ lÃ  Ä‘á»‘i tÆ°á»£ng táº­p cÃ³ thá»© tá»±</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; ZADD salary 3000 </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Alice&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 4000 </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Bob&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 2500 </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Carol&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">3</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; TYPE salary</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">zset</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ma-hoa-cua-Ä‘oi-tuong" tabindex="-1"><a class="header-anchor" href="#ma-hoa-cua-Ä‘oi-tuong"><span>MÃ£ hÃ³a cá»§a Äá»‘i tÆ°á»£ng</span></a></h3><p>Con trá» <code>ptr</code> cá»§a Ä‘á»‘i tÆ°á»£ng trong Redis trá» Ä‘áº¿n cáº¥u trÃºc dá»¯ liá»‡u cá»¥ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ triá»ƒn khai Ä‘á»‘i tÆ°á»£ng, vÃ  cáº¥u trÃºc nÃ y Ä‘Æ°á»£c quyáº¿t Ä‘á»‹nh bá»Ÿi thuá»™c tÃ­nh <code>encoding</code> cá»§a Ä‘á»‘i tÆ°á»£ng.</p><p>Thuá»™c tÃ­nh <code>encoding</code> ghi nháº­n phÆ°Æ¡ng thá»©c mÃ£ hÃ³a Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ triá»ƒn khai Ä‘á»‘i tÆ°á»£ng, tá»©c lÃ  Ä‘á»‘i tÆ°á»£ng sá»­ dá»¥ng cáº¥u trÃºc dá»¯ liá»‡u nÃ o lÃ m ná»n táº£ng.</p><p>Redis há»— trá»£ cÃ¡c phÆ°Æ¡ng thá»©c mÃ£ hÃ³a sau:</p><table><thead><tr><th style="text-align:left;">Loáº¡i Ä‘á»‘i tÆ°á»£ng</th><th style="text-align:left;">MÃ£ hÃ³a</th><th style="text-align:left;">Äá»‘i tÆ°á»£ng</th><th>Káº¿t quáº£ cá»§a lá»‡nh <strong>OBJECT ENCODING</strong></th></tr></thead><tbody><tr><td style="text-align:left;"><code>REDIS_STRING</code></td><td style="text-align:left;"><code>REDIS_ENCODING_INT</code></td><td style="text-align:left;">Äá»‘i tÆ°á»£ng chuá»—i Ä‘Æ°á»£c triá»ƒn khai báº±ng giÃ¡ trá»‹ sá»‘ nguyÃªn.</td><td>&quot;int&quot;</td></tr><tr><td style="text-align:left;"><code>REDIS_STRING</code></td><td style="text-align:left;"><code>REDIS_ENCODING_EMBSTR</code></td><td style="text-align:left;">Äá»‘i tÆ°á»£ng chuá»—i Ä‘á»™ng Ä‘Æ¡n giáº£n Ä‘Æ°á»£c triá»ƒn khai báº±ng <code>embstr</code>.</td><td>&quot;embstr&quot;</td></tr><tr><td style="text-align:left;"><code>REDIS_STRING</code></td><td style="text-align:left;"><code>REDIS_ENCODING_RAW</code></td><td style="text-align:left;">Äá»‘i tÆ°á»£ng chuá»—i Ä‘á»™ng Ä‘Æ¡n giáº£n Ä‘Æ°á»£c triá»ƒn khai báº±ng chuá»—i Ä‘á»™ng.</td><td>&quot;raw&quot;</td></tr><tr><td style="text-align:left;"><code>REDIS_LIST</code></td><td style="text-align:left;"><code>REDIS_ENCODING_ZIPLIST</code></td><td style="text-align:left;">Äá»‘i tÆ°á»£ng danh sÃ¡ch Ä‘Æ°á»£c triá»ƒn khai báº±ng danh sÃ¡ch nÃ©n (ziplist).</td><td>&quot;ziplist&quot;</td></tr><tr><td style="text-align:left;"><code>REDIS_LIST</code></td><td style="text-align:left;"><code>REDIS_ENCODING_LINKEDLIST</code></td><td style="text-align:left;">Äá»‘i tÆ°á»£ng danh sÃ¡ch Ä‘Æ°á»£c triá»ƒn khai báº±ng danh sÃ¡ch liÃªn káº¿t (linkedlist).</td><td>&quot;linkedlist&quot;</td></tr><tr><td style="text-align:left;"><code>REDIS_HASH</code></td><td style="text-align:left;"><code>REDIS_ENCODING_ZIPLIST</code></td><td style="text-align:left;">Äá»‘i tÆ°á»£ng báº£ng bÄƒm Ä‘Æ°á»£c triá»ƒn khai báº±ng báº£ng bÄƒm nÃ©n (ziplist).</td><td>&quot;ziplist&quot;</td></tr><tr><td style="text-align:left;"><code>REDIS_HASH</code></td><td style="text-align:left;"><code>REDIS_ENCODING_HT</code></td><td style="text-align:left;">Äá»‘i tÆ°á»£ng báº£ng bÄƒm Ä‘Æ°á»£c triá»ƒn khai báº±ng tá»« Ä‘iá»ƒn (hashtable).</td><td>&quot;hashtable&quot;</td></tr><tr><td style="text-align:left;"><code>REDIS_SET</code></td><td style="text-align:left;"><code>REDIS_ENCODING_INTSET</code></td><td style="text-align:left;">Äá»‘i tÆ°á»£ng táº­p há»£p Ä‘Æ°á»£c triá»ƒn khai báº±ng táº­p há»£p sá»‘ nguyÃªn (intset).</td><td>&quot;intset&quot;</td></tr><tr><td style="text-align:left;"><code>REDIS_SET</code></td><td style="text-align:left;"><code>REDIS_ENCODING_HT</code></td><td style="text-align:left;">Äá»‘i tÆ°á»£ng táº­p há»£p Ä‘Æ°á»£c triá»ƒn khai báº±ng tá»« Ä‘iá»ƒn (hashtable).</td><td>&quot;hashtable&quot;</td></tr><tr><td style="text-align:left;"><code>REDIS_ZSET</code></td><td style="text-align:left;"><code>REDIS_ENCODING_ZIPLIST</code></td><td style="text-align:left;">Äá»‘i tÆ°á»£ng táº­p há»£p cÃ³ thá»© tá»± Ä‘Æ°á»£c triá»ƒn khai báº±ng danh sÃ¡ch nÃ©n (ziplist).</td><td>&quot;ziplist&quot;</td></tr><tr><td style="text-align:left;"><code>REDIS_ZSET</code></td><td style="text-align:left;"><code>REDIS_ENCODING_SKIPLIST</code></td><td style="text-align:left;">Äá»‘i tÆ°á»£ng táº­p há»£p cÃ³ thá»© tá»± Ä‘Æ°á»£c triá»ƒn khai báº±ng skip list vÃ  tá»« Ä‘iá»ƒn (skiplist).</td><td>&quot;skiplist&quot;</td></tr></tbody></table><p><strong>VÃ­ dá»¥</strong></p><p>Sá»­ dá»¥ng lá»‡nh <code>OBJECT ENCODING</code> Ä‘á»ƒ xem mÃ£ hÃ³a cá»§a Ä‘á»‘i tÆ°á»£ng giÃ¡ trá»‹ cá»§a cÃ¡c khÃ³a trong cÆ¡ sá»Ÿ dá»¯ liá»‡u Redis:</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; SET msg </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Xin chÃ o&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">OK</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; OBJECT ENCODING msg</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;embstr&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; SET story </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Ráº¥t lÃ¢u rá»“i...&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">OK</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; OBJECT ENCODING story</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;raw&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; SADD numbers 1 3 5</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">3</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; OBJECT ENCODING numbers</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;intset&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; SADD numbers </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;báº£y&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; OBJECT ENCODING numbers</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;hashtable&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="kiem-tra-loai-va-Ä‘a-hinh-lenh" tabindex="-1"><a class="header-anchor" href="#kiem-tra-loai-va-Ä‘a-hinh-lenh"><span>Kiá»ƒm tra loáº¡i vÃ  Ä‘a hÃ¬nh lá»‡nh</span></a></h3><p>Trong Redis, cÃ¡c lá»‡nh cÃ³ thá»ƒ Ä‘Æ°á»£c chia thÃ nh hai loáº¡i chÃ­nh:</p><ul><li><p><strong>Lá»‡nh Ä‘a hÃ¬nh</strong>: CÃ¡c lá»‡nh nÃ y cÃ³ thá»ƒ thá»±c hiá»‡n trÃªn báº¥t ká»³ loáº¡i khÃ³a nÃ o, cháº³ng háº¡n nhÆ° <code>DEL</code>, <code>EXPIRE</code>, <code>RENAME</code>, <code>TYPE</code>, <code>OBJECT</code>, vv.</p></li><li><p><strong>Lá»‡nh Ä‘áº·c biá»‡t cho tá»«ng loáº¡i</strong>: ÄÃ¢y lÃ  nhá»¯ng lá»‡nh chá»‰ cÃ³ thá»ƒ thá»±c hiá»‡n trÃªn má»™t loáº¡i cá»¥ thá»ƒ cá»§a khÃ³a, nhÆ° sau:</p><ul><li>Lá»‡nh liÃªn quan Ä‘áº¿n khÃ³a chuá»—i: <code>SET</code>, <code>GET</code>, <code>APPEND</code>, <code>STRLEN</code>, vv.</li><li>Lá»‡nh liÃªn quan Ä‘áº¿n khÃ³a bÄƒm: <code>HDEL</code>, <code>HSET</code>, <code>HGET</code>, <code>HLEN</code>, vv.</li><li>Lá»‡nh liÃªn quan Ä‘áº¿n khÃ³a danh sÃ¡ch: <code>RPUSH</code>, <code>LPOP</code>, <code>LINSERT</code>, <code>LLEN</code>, vv.</li><li>Lá»‡nh liÃªn quan Ä‘áº¿n khÃ³a táº­p há»£p: <code>SADD</code>, <code>SPOP</code>, <code>SINTER</code>, <code>SCARD</code>, vv.</li><li>Lá»‡nh liÃªn quan Ä‘áº¿n khÃ³a táº­p há»£p cÃ³ thá»© tá»±: <code>ZADD</code>, <code>ZCARD</code>, <code>ZRANK</code>, <code>ZSCORE</code>, vv.</li></ul></li></ul><p>TrÆ°á»›c khi thá»±c hiá»‡n má»™t lá»‡nh Ä‘áº·c biá»‡t cho tá»«ng loáº¡i, Redis sáº½ kiá»ƒm tra xem loáº¡i Ä‘á»‘i tÆ°á»£ng cá»§a khÃ³a Ä‘áº§u vÃ o cÃ³ phÃ¹ há»£p khÃ´ng, vÃ  sau Ä‘Ã³ quyáº¿t Ä‘á»‹nh liá»‡u nÃªn thá»±c hiá»‡n lá»‡nh cá»¥ thá»ƒ cho khÃ³a Ä‘Ã£ cho hay khÃ´ng. Viá»‡c kiá»ƒm tra loáº¡i Ä‘á»‘i tÆ°á»£ng trÆ°á»›c khi thá»±c hiá»‡n lá»‡nh Ä‘áº·c biá»‡t cho tá»«ng loáº¡i Ä‘Æ°á»£c thá»±c hiá»‡n dá»±a trÃªn thuá»™c tÃ­nh <code>type</code> cá»§a cáº¥u trÃºc <code>redisObject</code>:</p><ul><li>TrÆ°á»›c khi thá»±c hiá»‡n lá»‡nh Ä‘áº·c biá»‡t cho tá»«ng loáº¡i, mÃ¡y chá»§ sáº½ kiá»ƒm tra xem Ä‘á»‘i tÆ°á»£ng giÃ¡ trá»‹ cá»§a khÃ³a Ä‘áº§u vÃ o cÃ³ pháº£i lÃ  loáº¡i cáº§n thiáº¿t cho lá»‡nh Ä‘Ã³ hay khÃ´ng.</li><li>Náº¿u Ä‘Ãºng nhÆ° váº­y, mÃ¡y chá»§ sáº½ thá»±c hiá»‡n lá»‡nh cá»¥ thá»ƒ cho khÃ³a.</li><li>Náº¿u khÃ´ng, mÃ¡y chá»§ sáº½ tá»« chá»‘i thá»±c hiá»‡n lá»‡nh vÃ  tráº£ vá» lá»—i loáº¡i khÃ´ng phÃ¹ há»£p cho khÃ¡ch hÃ ng.</li></ul><p>Redis khÃ´ng chá»‰ dá»±a vÃ o loáº¡i Ä‘á»‘i tÆ°á»£ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh liá»‡u khÃ³a cÃ³ thá»ƒ thá»±c hiá»‡n lá»‡nh cá»¥ thá»ƒ cho tá»«ng loáº¡i hay khÃ´ng, mÃ  cÃ²n dá»±a vÃ o cÃ¡ch mÃ£ hÃ³a cá»§a Ä‘á»‘i tÆ°á»£ng giÃ¡ trá»‹ Ä‘á»ƒ chá»n mÃ£ lá»‡nh thÃ­ch há»£p Ä‘á»ƒ thá»±c hiá»‡n lá»‡nh.</p><h3 id="xu-ly-thu-gom-rac" tabindex="-1"><a class="header-anchor" href="#xu-ly-thu-gom-rac"><span>Xá»­ lÃ½ thu gom rÃ¡c</span></a></h3><p>Do ngÃ´n ngá»¯ C khÃ´ng há»— trá»£ tá»± Ä‘á»™ng thu gom rÃ¡c, Redis Ä‘Ã£ triá»ƒn khai má»™t cÆ¡ cháº¿ thu gom rÃ¡c dá»±a trÃªn Ä‘áº¿m sá»‘ tham chiáº¿u.</p><p>ThÃ´ng tin Ä‘áº¿m tham chiáº¿u cá»§a má»—i Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c ghi nháº­n trong cáº¥u trÃºc <code>redisObject</code> báº±ng thuá»™c tÃ­nh <code>refcount</code>:</p><div class="language-c" data-ext="c" data-title="c"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">typedef</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> struct</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> redisObject {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Sá»‘ tham chiáº¿u</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    int</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> refcount;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">} robj;</span></span></code></pre></div><p>ThÃ´ng tin Ä‘áº¿m tham chiáº¿u cá»§a Ä‘á»‘i tÆ°á»£ng sáº½ thay Ä‘á»•i theo tráº¡ng thÃ¡i sá»­ dá»¥ng cá»§a Ä‘á»‘i tÆ°á»£ng:</p><ul><li>Khi táº¡o má»™t Ä‘á»‘i tÆ°á»£ng má»›i, giÃ¡ trá»‹ Ä‘áº¿m tham chiáº¿u sáº½ Ä‘Æ°á»£c khá»Ÿi táº¡o lÃ  <code>1</code>.</li><li>Khi má»™t Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi má»™t chÆ°Æ¡ng trÃ¬nh má»›i, giÃ¡ trá»‹ Ä‘áº¿m tham chiáº¿u sáº½ Ä‘Æ°á»£c tÄƒng lÃªn.</li><li>Khi má»™t Ä‘á»‘i tÆ°á»£ng khÃ´ng cÃ²n Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi báº¥t ká»³ chÆ°Æ¡ng trÃ¬nh nÃ o ná»¯a, giÃ¡ trá»‹ Ä‘áº¿m tham chiáº¿u sáº½ giáº£m Ä‘i.</li><li>Khi giÃ¡ trá»‹ Ä‘áº¿m tham chiáº¿u cá»§a má»™t Ä‘á»‘i tÆ°á»£ng xuá»‘ng <code>0</code>, bá»™ nhá»› mÃ  Ä‘á»‘i tÆ°á»£ng Ä‘Ã³ chiáº¿m dá»¥ng sáº½ Ä‘Æ°á»£c giáº£i phÃ³ng.</li></ul><h3 id="chia-se-Ä‘oi-tuong" tabindex="-1"><a class="header-anchor" href="#chia-se-Ä‘oi-tuong"><span>Chia sáº» Ä‘á»‘i tÆ°á»£ng</span></a></h3><p>Trong Redis, nhiá»u khÃ³a cÃ³ thá»ƒ chia sáº» cÃ¹ng má»™t Ä‘á»‘i tÆ°á»£ng giÃ¡ trá»‹ báº±ng cÃ¡ch thá»±c hiá»‡n hai bÆ°á»›c sau:</p><ol><li><strong>Chá»‰ Ä‘á»‹nh Ä‘áº¿n Ä‘á»‘i tÆ°á»£ng hiá»‡n táº¡i</strong>: Chá»‰ Ä‘á»‹nh con trá» giÃ¡ trá»‹ cá»§a nhiá»u khÃ³a trong cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘áº¿n cÃ¹ng má»™t Ä‘á»‘i tÆ°á»£ng giÃ¡ trá»‹ hiá»‡n táº¡i.</li><li><strong>TÄƒng sá»‘ lÆ°á»£ng tham chiáº¿u</strong>: TÄƒng sá»‘ lÆ°á»£ng tham chiáº¿u cá»§a Ä‘á»‘i tÆ°á»£ng giÃ¡ trá»‹ Ä‘Æ°á»£c chia sáº» lÃªn má»™t.</li></ol><p>CÆ¡ cháº¿ chia sáº» Ä‘á»‘i tÆ°á»£ng giÃºp tiáº¿t kiá»‡m ráº¥t nhiá»u bá»™ nhá»›. Khi nhiá»u khÃ³a trong cÆ¡ sá»Ÿ dá»¯ liá»‡u lÆ°u trá»¯ cÃ¹ng má»™t giÃ¡ trá»‹ Ä‘á»‘i tÆ°á»£ng, viá»‡c sá»­ dá»¥ng cÆ¡ cháº¿ chia sáº» Ä‘á»‘i tÆ°á»£ng cÃ³ thá»ƒ giáº£m Ä‘Ã¡ng ká»ƒ lÆ°á»£ng bá»™ nhá»› sá»­ dá»¥ng.</p><p>Redis sáº½ tá»± Ä‘á»™ng chia sáº» cÃ¡c Ä‘á»‘i tÆ°á»£ng chuá»—i cÃ³ giÃ¡ trá»‹ tá»« <code>0</code> Ä‘áº¿n <code>9999</code> khi khá»Ÿi táº¡o mÃ¡y chá»§.</p><h3 id="thoi-gian-ranh-cua-Ä‘oi-tuong" tabindex="-1"><a class="header-anchor" href="#thoi-gian-ranh-cua-Ä‘oi-tuong"><span>Thá»i gian ráº£nh cá»§a Ä‘á»‘i tÆ°á»£ng</span></a></h3><p>Thuá»™c tÃ­nh <code>lru</code> cá»§a <code>redisObject</code> ghi láº¡i thá»i Ä‘iá»ƒm láº§n cuá»‘i cÃ¹ng mÃ  Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c truy cáº­p bá»Ÿi cÃ¡c lá»‡nh trong chÆ°Æ¡ng trÃ¬nh:</p><div class="language-c" data-ext="c" data-title="c"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">typedef</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> struct</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> redisObject {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    unsigned</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> lru:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">22</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">} robj;</span></span></code></pre></div><p>Lá»‡nh <code>OBJECT IDLETIME</code> cÃ³ thá»ƒ in ra thá»i gian ráº£nh cá»§a má»™t khÃ³a Ä‘Ã£ cho, thá»i gian ráº£nh nÃ y Ä‘Æ°á»£c tÃ­nh báº±ng cÃ¡ch láº¥y thá»i gian hiá»‡n táº¡i trá»« Ä‘i thá»i Ä‘iá»ƒm <code>lru</code> cá»§a Ä‘á»‘i tÆ°á»£ng giÃ¡ trá»‹ cá»§a khÃ³a:</p><div class="language- line-numbers-mode" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span>&gt; SET msg &quot;hello world&quot;</span></span>
<span class="line"><span>OK</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Chá» má»™t khoáº£ng thá»i gian ngáº¯n</span></span>
<span class="line"><span>&gt; OBJECT IDLETIME msg</span></span>
<span class="line"><span>(integer) 20</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Chá» lÃ¢u hÆ¡n</span></span>
<span class="line"><span>&gt; OBJECT IDLETIME msg</span></span>
<span class="line"><span>(integer) 180</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Truy cáº­p giÃ¡ trá»‹ cá»§a khÃ³a msg</span></span>
<span class="line"><span>&gt; GET msg</span></span>
<span class="line"><span>&quot;hello world&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># KhÃ³a hiá»‡n Ä‘ang hoáº¡t Ä‘á»™ng, thá»i gian ráº£nh lÃ  0</span></span>
<span class="line"><span>&gt; OBJECT IDLETIME msg</span></span>
<span class="line"><span>(integer) 0</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>LÆ°u Ã½</p><p>Lá»‡nh OBJECT IDLETIME cÃ³ cÃ¡ch triá»ƒn khai Ä‘áº·c biá»‡t, lá»‡nh nÃ y khÃ´ng thay Ä‘á»•i thuá»™c tÃ­nh <code>lru</code> cá»§a Ä‘á»‘i tÆ°á»£ng giÃ¡ trá»‹ khi truy cáº­p.</p></blockquote><p>NgoÃ i viá»‡c cÃ³ thá»ƒ in ra bá»Ÿi lá»‡nh OBJECT IDLETIME, thá»i gian ráº£nh cá»§a má»™t khÃ³a cÅ©ng cÃ³ tÃ¡c dá»¥ng khÃ¡c: náº¿u mÃ¡y chá»§ Redis báº­t tÃ¹y chá»n <code>maxmemory</code> vÃ  sá»­ dá»¥ng thuáº­t toÃ¡n <code>volatile-lru</code> hoáº·c <code>allkeys-lru</code> Ä‘á»ƒ thu há»“i bá»™ nhá»›, khi lÆ°á»£ng bá»™ nhá»› mÃ¡y chá»§ vÆ°á»£t quÃ¡ giÃ¡ trá»‹ tá»‘i Ä‘a Ä‘Æ°á»£c thiáº¿t láº­p bá»Ÿi <code>maxmemory</code>, cÃ¡c khÃ³a cÃ³ thá»i gian ráº£nh cao sáº½ Ä‘Æ°á»£c Æ°u tiÃªn giáº£i phÃ³ng bá»Ÿi mÃ¡y chá»§ Ä‘á»ƒ giáº£m bá»™ nhá»›.</p></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/vanhung4499/my-wiki/edit/main/src/database/redis/data-structures.md" aria-label="Edit this page on GitHub" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page on GitHub<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">Last update: </span><!----></div><div class="contributors"><span class="vp-meta-label">Contributors: </span><!--[--><!--[--><span class="vp-meta-info" title="email: vanhung4499@gmail.com">Hung Nguyen Van</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/database/redis/advanced-data-types.html" aria-label="Redis Advanced Data Types"><div class="hint"><span class="arrow start"></span>Prev</div><div class="link"><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon>Redis Advanced Data Types</div></a><a class="route-link auto-link next" href="/database/redis/expire.html" aria-label="Redis Expire Delete"><div class="hint">Next<span class="arrow end"></span></div><div class="link">Redis Expire Delete<iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper" style="display:none;--1ea755b8:;"><div class="footer-content"><div class="footer">Made with â¤ï¸ by Hung Nguyen</div><div class="copyright">Copyright Â© 2016-2024 Hung Nguyen</div></div><span id="runtime_span"></span></footer></div><!--]--><!--[--><!----><!----><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-BeMIqZkJ.js" defer></script>
  </body>
</html>
