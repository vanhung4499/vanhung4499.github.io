import{_ as n,o as s,c as a,a as t}from"./app-5QVbWi7Z.js";const h={};function l(g,i){return s(),a("div",null,i[0]||(i[0]=[t(`<h1 id="pmhub-distributed-monitoring-tracing-with-skywalking" tabindex="-1"><a class="header-anchor" href="#pmhub-distributed-monitoring-tracing-with-skywalking"><span>PmHub - Distributed monitoring &amp; tracing with Skywalking</span></a></h1><p>Bài viết này chủ yếu hướng dẫn cách sử dụng <strong>Skywalking</strong> trong <strong>PmHub</strong> để giám sát hiệu suất và truy vết phân tán. Nội dung sẽ bắt đầu từ những kiến thức cơ bản, đến dự án thực tế và hướng dẫn tích hợp từ 0-1. Bài viết cũng sẽ chỉ ra cách dùng <strong>traceid</strong> để xác định các vấn đề trong chuỗi dịch vụ phân tán. Cuối cùng, sẽ có các câu hỏi giúp bạn <strong>nắm vững cách sử dụng thực tế Skywalking</strong>.</p><div class="hint-container info"><p class="hint-container-title">Info</p><p>Đã triển khai Skywalking để giám sát hiệu suất và truy vết phân tán cho PmHub, tích hợp các kênh thông báo qua email, v.v., giúp giảm khoảng 30% thời gian phản hồi của hệ thống, đảm bảo tính ổn định và dễ bảo trì.</p></div><h2 id="tong-quan-ve-truy-vet-chuoi-dich-vu-phan-tan" tabindex="-1"><a class="header-anchor" href="#tong-quan-ve-truy-vet-chuoi-dich-vu-phan-tan"><span>Tổng quan về truy vết chuỗi dịch vụ phân tán</span></a></h2><p>Trong hệ thống microservice, dịch vụ A gọi dịch vụ B, B lại gọi dịch vụ C, và C tiếp tục gọi D, điều này làm chuỗi dịch vụ trở nên rất phức tạp.</p><p>Một request từ client sẽ đi qua nhiều node dịch vụ khác nhau trong hệ thống để tạo ra kết quả cuối cùng. Mỗi yêu cầu như vậy sẽ hình thành một chuỗi dịch vụ phân tán phức tạp. Bất kỳ sự chậm trễ hoặc lỗi nào trong một node của chuỗi cũng có thể khiến request cuối cùng thất bại.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240917182929.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>Trong hệ thống phân tán, cần có một cơ chế chuyên biệt để theo dõi các chuỗi này.</p><p>Hiện nay, các công cụ phổ biến cho việc này bao gồm <strong>Sleuth</strong>, <strong>Skywalking</strong>, và <strong>Zipkin</strong>. Tuy nhiên, <a href="https://spring.io/projects/spring-cloud-sleuth" target="_blank" rel="noopener noreferrer">Sleuth</a> đã thông báo sẽ thay đổi cấu trúc. 😂</p><blockquote><p>Spring Cloud Sleuth’s last minor version is 3.1. You can check the <a href="https://github.com/spring-cloud/spring-cloud-sleuth/tree/3.1.x" target="_blank" rel="noopener noreferrer">3.1.x</a> branch for the latest commits. The core of this project got moved to <a href="https://micrometer.io/docs/tracing" target="_blank" rel="noopener noreferrer">Micrometer Tracing</a> project and the instrumentations will be moved to <a href="https://micrometer.io/" target="_blank" rel="noopener noreferrer">Micrometer</a> and all respective projects (no longer all instrumentations will be done in a single repository).</p></blockquote><p>Dưới đây là một số giải pháp truy vết chuỗi dịch vụ phân tán đã phát triển trong ngành.</p><table><thead><tr><th>Tech</th><th>Mô tả</th></tr></thead><tbody><tr><td>Cat</td><td>Nguồn mở của Dianping, một nền tảng giám sát ứng dụng thời gian thực được phát triển dựa trên Java, bao gồm giám sát ứng dụng thời gian thực và giám sát kinh doanh. Giải pháp tích hợp là triển khai giám sát thông qua các điểm chôn mã, chẳng hạn như bộ chặn, bộ lọc, v.v. Nó rất xâm phạm vào mã và chi phí tích hợp cao. Rủi ro lớn hơn.</td></tr><tr><td>Zipkin</td><td>Được mã nguồn mở bởi Twitter, hệ thống theo dõi phân tán mã nguồn mở được sử dụng để thu thập dữ liệu thời gian của các dịch vụ nhằm giải quyết vấn đề độ trễ trong kiến ​​trúc microservice, bao gồm: thu thập, lưu trữ, tìm kiếm và hiển thị dữ liệu, kết hợp với spring-cloud-sleuth tương đối đơn giản dễ sử dụng và dễ tích hợp, nhưng chức năng của nó tương đối đơn giản.</td></tr><tr><td>Pinpoint</td><td>Pinpoint là một công cụ phân tích giám sát ứng dụng và phân tích chuỗi cuộc gọi nguồn mở dựa trên việc tiêm mã byte. Nó được đặc trưng bởi việc hỗ trợ nhiều plug-in khác nhau, các chức năng giao diện người dùng mạnh mẽ và không có sự xâm nhập mã ở đầu truy cập.</td></tr><tr><td>Skywalking</td><td>SkyWalking là một công cụ phân tích giám sát ứng dụng và phân tích chuỗi cuộc gọi mã nguồn mở của Trung Quốc dựa trên việc tiêm bytecode. Nó có đặc điểm là hỗ trợ nhiều plug-in khác nhau, chức năng giao diện người dùng mạnh mẽ và không có sự xâm nhập mã ở đầu truy cập.</td></tr></tbody></table><h2 id="nguyen-ly-truy-vet-chuoi-dich-vu-phan-tan" tabindex="-1"><a class="header-anchor" href="#nguyen-ly-truy-vet-chuoi-dich-vu-phan-tan"><span>Nguyên lý truy vết chuỗi dịch vụ phân tán</span></a></h2><p>Giả sử một chuỗi dịch vụ microservice có ba thành phần như hình dưới đây: <strong>Service 1</strong> gọi <strong>Service 2</strong>, <strong>Service 2</strong> gọi <strong>Service 3</strong> và <strong>Service 4</strong>.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240917183735.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>Một chuỗi truy vết sẽ thêm <strong>Trace ID</strong> và <strong>Span ID</strong> vào mỗi lần gọi dịch vụ.</p><p>Chuỗi truy vết được xác định duy nhất qua <strong>Trace ID</strong>.</p><p><strong>Span</strong> xác định thông tin về mỗi lần yêu cầu, các <strong>span</strong> được liên kết với nhau qua <strong>Parent ID</strong>. <strong>Span</strong> đại diện cho một lần yêu cầu, và có thể hiểu đơn giản nó là thông tin của một lần gọi.</p><p>Một chuỗi truy vết được xác định qua <strong>Trace ID</strong>, mỗi <strong>Span</strong> đại diện cho thông tin của một lần yêu cầu và được liên kết với <strong>Parent ID</strong>.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240917192542.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>1</td><td>Nút đầu tiên: Span ID = A, Parent ID = null, Service 1 nhận yêu cầu.</td></tr><tr><td>2</td><td>Nút thứ hai: Span ID = B, Parent ID = A, Service 1 gửi yêu cầu tới Service 2 và nhận phản hồi từ Service 2.</td></tr><tr><td>3</td><td>Nút thứ ba: Span ID = C, Parent ID = B, quá trình xử lý tại Service 2.</td></tr><tr><td>4</td><td>Nút thứ tư: Span ID = D, Parent ID = C, Service 2 gửi yêu cầu đến Service 3 và nhận phản hồi từ Service 3.</td></tr><tr><td>5</td><td>Nút thứ năm: Span ID = E, Parent ID = D, quá trình xử lý tại Service 3.</td></tr><tr><td>6</td><td>Nút thứ sáu: Span ID = F, Parent ID = C, Service 3 gửi yêu cầu đến Service 4 và nhận phản hồi từ Service 4.</td></tr><tr><td>7</td><td>Nút thứ bảy: Span ID = G, Parent ID = F, quá trình xử lý tại Service 4.</td></tr><tr><td>8</td><td>Qua Parent ID, có thể xác định được nút cha, giúp truy vết toàn bộ chuỗi dịch vụ.</td></tr></tbody></table><h3 id="skywalking-la-gi" tabindex="-1"><a class="header-anchor" href="#skywalking-la-gi"><span>Skywalking là gì?</span></a></h3><p><strong>Skywalking</strong> là một <strong>khung mã nguồn mở</strong> tuyệt vời, được open source vào năm 2015 và gia nhập Apache Incubator vào năm 2017. Chỉ trong hai năm ngắn ngủi, Skywalking đã được Apache đón nhận, chứng minh sức mạnh của nó. 👍</p><p>Skywalking hỗ trợ tích hợp với <strong>Dubbo</strong>, <strong>SpringCloud</strong>, <strong>SpringBoot</strong> mà <strong>không xâm phạm mã</strong>. Nó sử dụng <strong>GRPC</strong> cho giao tiếp, đảm bảo hiệu suất tốt. Skywalking được triển khai dưới dạng Java agent, hỗ trợ cảnh báo, giám sát JVM, và cung cấp các thống kê gọi toàn cục, cùng nhiều tính năng khác. Ngoài ra, cộng đồng phát triển của Skywalking cũng khá sôi động.</p><p>Trang web chính thức: <a href="https://skywalking.apache.org/" target="_blank" rel="noopener noreferrer">https://skywalking.apache.org/</a><br> Mã nguồn mở: <a href="https://github.com/apache/skywalking" target="_blank" rel="noopener noreferrer">https://github.com/apache/skywalking</a></p><h3 id="tai-sao-chon-skywalking" tabindex="-1"><a class="header-anchor" href="#tai-sao-chon-skywalking"><span>Tại sao chọn Skywalking?</span></a></h3><div class="hint-container info"><p class="hint-container-title">Info</p><p>Skywalking có nhiều ưu điểm so với Zipkin, chẳng hạn như:</p><ul><li>Skywalking sử dụng công nghệ tăng cường bytecode, không xâm phạm mã, trong khi Zipkin có tính xâm phạm cao.</li><li>Skywalking có nhiều tính năng phong phú hơn, các báo cáo thống kê và giao diện người dùng (UI) thân thiện hơn.</li></ul></div><h3 id="kien-truc-cua-skywalking" tabindex="-1"><a class="header-anchor" href="#kien-truc-cua-skywalking"><span>Kiến trúc của Skywalking</span></a></h3><p>Skywalking chủ yếu chia thành hai phần: <strong>máy chủ</strong> và <strong>máy khách</strong>. Máy chủ chạy độc lập, còn máy khách chính là các dịch vụ microservice của bạn. Chỉ cần thêm các gói jar và cấu hình là có thể sử dụng.</p><figure><img src="https://skywalking.apache.org/images/home/architecture_2160x720.png" alt="Sơ đồ kiến trúc" tabindex="0" loading="lazy"><figcaption>Sơ đồ kiến trúc</figcaption></figure><p>Sơ đồ kiến trúc cụ thể như sau:</p><figure><img src="https://skywalking.apache.org/blog/2018-12-12-skywalking-service-mesh-ready/0081Kckwly1gl2ctge1g5j31pc0s8h04.jpg" alt="arch" tabindex="0" loading="lazy"><figcaption>arch</figcaption></figure><p>Cụ thể, kiến trúc bao gồm bốn phần chính:</p><ol><li><strong>Agent</strong>: Thu thập dữ liệu log và gửi tới máy chủ OAP.</li><li><strong>OAP Server</strong>: Nhận dữ liệu về truy vết (Tracing) và số liệu (Metric) từ Agent, sau đó phân tích (Analysis Core), lưu trữ vào cơ sở dữ liệu ngoài (Storage), và cung cấp chức năng truy vấn (Query).</li><li><strong>UI</strong>: Cung cấp bảng điều khiển web để xem chuỗi dịch vụ, các chỉ số, hiệu suất, v.v.</li><li><strong>Storage</strong>: Lưu trữ dữ liệu, hỗ trợ nhiều loại cơ sở dữ liệu khác nhau.</li></ol><p>Sau khi hiểu sơ đồ kiến trúc, ta thấy rằng Agent chịu trách nhiệm thu thập log và truyền dữ liệu qua GRPC đến OAP để phân tích và lưu trữ vào cơ sở dữ liệu. Cuối cùng, UI sẽ hiển thị các báo cáo thống kê, quan hệ phụ thuộc dịch vụ và sơ đồ topology.</p><h3 id="cai-đat-may-chu" tabindex="-1"><a class="header-anchor" href="#cai-đat-may-chu"><span>Cài đặt máy chủ</span></a></h3><p>Tải xuống tại: <a href="https://skywalking.apache.org/downloads/" target="_blank" rel="noopener noreferrer">https://skywalking.apache.org/downloads/</a></p><p>Bạn có thể chọn phiên bản mới nhất để tải về, nhưng lưu ý:</p><div class="hint-container info"><p class="hint-container-title">Info</p><p>Vì PmHub hiện vẫn sử dụng <strong>JDK 8</strong>, trong khi <strong>Skywalking</strong> yêu cầu JDK 11 trở lên, nên để tránh các vấn đề không tương thích, khuyến nghị sử dụng phiên bản Skywalking thấp hơn. Ở đây, tôi sử dụng <strong>8.3.0</strong>. Sau này, nếu nâng cấp lên phiên bản JDK mới hơn, các vấn đề tương thích sẽ được giải quyết.</p></div><div class="hint-container info"><p class="hint-container-title">Info</p><p>Từ phiên bản <strong>Skywalking 8.7.0</strong> trở đi, mã của agent đã được tách khỏi Skywalking, bạn cần tự tải agent tương ứng từ trang web chính thức: <a href="https://skywalking.apache.org/downloads/" target="_blank" rel="noopener noreferrer">https://skywalking.apache.org/downloads/</a>.</p><p>Cách chọn phiên bản agent phù hợp có thể tìm thấy tại: <a href="https://skywalking.apache.org/docs/skywalking-java/v9.0.0/en/setup/service-agent/java-agent/readme/" target="_blank" rel="noopener noreferrer">https://skywalking.apache.org/docs/skywalking-java/v9.0.0/en/setup/service-agent/java-agent/readme/</a></p><p>Vì phiên bản máy chủ là <strong>9.5.0</strong>, agent tương ứng sẽ là <strong>9.0.0</strong>.</p></div><h3 id="_1-sua-cau-hinh-config-application-yml" tabindex="-1"><a class="header-anchor" href="#_1-sua-cau-hinh-config-application-yml"><span>1. Sửa cấu hình <code>config/application.yml</code></span></a></h3><p>Đây là tệp cấu hình của dịch vụ OAP, cần chỉnh sửa trung tâm đăng ký thành Nacos.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240917201418.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>Chỉnh sửa cấu hình Nacos:</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240917201438.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><h3 id="_2-sua-cau-hinh-webapp-webapp-yml-hoac-application-yml" tabindex="-1"><a class="header-anchor" href="#_2-sua-cau-hinh-webapp-webapp-yml-hoac-application-yml"><span>2. Sửa cấu hình <code>webapp/webapp.yml</code> (hoặc <code>application.yml</code>)</span></a></h3><p>Đây là tệp cấu hình của dịch vụ UI, trong đó có một cấu hình <code>server.port</code>, đây là cổng của dịch vụ UI, mặc định là 8080. Hãy thay đổi thành 8888 để tránh xung đột cổng, như sau:</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240917201449.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>Khởi động:</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">sh</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> startup.sh</span></span></code></pre></div><p>Tắt:</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">lsof</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> :8888</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">kill</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> -9</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;"> pid</span></span></code></pre></div><p>Sau khi khởi động hoàn tất và không có lỗi, bạn có thể truy cập bằng trình duyệt qua địa chỉ: <a href="http://localhost:8888/" target="_blank" rel="noopener noreferrer">http://localhost:8888/</a></p><div class="hint-container warning"><p class="hint-container-title">Warning</p><p>Phiên bản mới cần ít nhất JDK 11 hỗ trợ.</p><p>Bạn cần quản lý nhiều phiên bản java trên một máy (linux/mac), bạn có thể sử dụng <a href="https://github.com/jenv/jenv" target="_blank" rel="noopener noreferrer">jenv</a>. Hãy tìm hiểu nó!</p></div><h2 id="thuc-chien-du-an" tabindex="-1"><a class="header-anchor" href="#thuc-chien-du-an"><span>Thực chiến dự án</span></a></h2><h3 id="cai-đat-phia-client" tabindex="-1"><a class="header-anchor" href="#cai-đat-phia-client"><span>Cài đặt phía Client</span></a></h3><p>Phía client, tức là cách một microservice tích hợp với Skywalking. Vì Skywalking sử dụng công nghệ tăng cường mã byte, nên nó không xâm nhập mã của microservice. Chỉ cần một microservice bình thường, không cần thêm bất kỳ phụ thuộc nào.</p><p>Để truyền dữ liệu, cần sử dụng agent do Skywalking cung cấp. Bạn chỉ cần chỉ định trong tham số khởi động như sau:</p><div class="language-java" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">javaagent</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">:</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">Users</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">canghe</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">tools</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">skywalking</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">apache</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">skywalking</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">apm</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">bin</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">agent</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">skywalking</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">agent</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">jar</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Dskywalking</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">agent</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">service_name</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">pmhub</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">gateway</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Dskywalking</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">collector</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">backend_service</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">127.0</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#FFFFFF;--shiki-dark:#FFFFFF;">0</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#FFFFFF;--shiki-dark:#FFFFFF;">1</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">:</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">11800</span></span></code></pre></div><div class="hint-container info"><p class="hint-container-title">Info</p><ul><li><code>-javaagent</code>: Chỉ định đường dẫn đến tệp skywalking-agent.jar trong thư mục agent của Skywalking.</li><li><code>-Dskywalking.agent.service_name</code>: Chỉ định tên dịch vụ trong Skywalking, thông thường là <code>spring.application.name</code> của microservice.</li><li><code>-Dskywalking.collector.backend_service</code>: Chỉ định địa chỉ của dịch vụ OAP, nếu là local, cổng mặc định của dịch vụ OAP là 11800, vì vậy chỉ cần cấu hình thành <code>127.0.0.1:11800</code>.</li></ul><p>Lưu ý: Đường dẫn đến tệp jar của agent không được chứa ký tự đặc biệt hoặc khoảng trắng, nếu không sẽ không thể chạy thành công.</p></div><p>Lưu ý: Trong phiên bản mới của IntelliJ IDEA, bạn thêm VM options như sau:</p><p><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240917212727.png" alt="image.png" loading="lazy"><br><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240917212750.png" alt="image.png" loading="lazy"></p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240917212849.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>Sau khi cấu hình xong, bạn có thể thấy dịch vụ đã được agent theo dõi.</p><h3 id="giam-sat-log" tabindex="-1"><a class="header-anchor" href="#giam-sat-log"><span>Giám sát log</span></a></h3><p>Trong giao diện người dùng của Skywalking có một module dành cho log, được sử dụng để thu thập log từ phía client. Mặc định, không có dữ liệu trong module này, vậy làm thế nào để truyền dữ liệu log vào Skywalking?</p><p>Có rất nhiều loại framework log, nổi tiếng như log4j, logback, log4j2. Sau đây là cách cấu hình với logback làm ví dụ.</p><p><strong>Chỉnh sửa mức độ log của agent:</strong></p><p>Để tránh việc in quá nhiều log info trên console, cần thay đổi mức độ log. Tệp cấu hình log của SkyWalking thường nằm trong <code>agent/config/agent.config</code>. Tìm và mở tệp này.</p><p>Tìm cấu hình sau và đặt mức độ log phù hợp, chẳng hạn như <code>ERROR</code> hoặc <code>WARN</code>, để giảm lượng log được ghi lại:</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240917220047.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p><strong>Thêm phụ thuộc:</strong></p><blockquote><p><strong>Vì mỗi microservice đều cần dùng đến cấu hình này, nên có thể đặt trong module chung để các dịch vụ khác chỉ cần tham chiếu.</strong></p></blockquote><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;!</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">--</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> Nếu</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> bạn muốn lấy </span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">TraceId</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> trong mã dự án</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> cần thêm phụ thuộc này </span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">--</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">    &lt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">org</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">apache</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">skywalking</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;/</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">    &lt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">apm</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">toolkit</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">trace</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;/</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">    &lt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">version</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">8.8</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#FFFFFF;--shiki-dark:#FFFFFF;">0</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;/</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">version</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;/</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;!</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">--</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> Chức</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> năng tùy chỉnh liên quan</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> chẳng hạn như thẻ tùy chỉnh </span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">--</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">    &lt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">org</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">apache</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">skywalking</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;/</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">    &lt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">apm</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">toolkit</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">opentracing</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;/</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">    &lt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">version</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">8.8</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#FFFFFF;--shiki-dark:#FFFFFF;">0</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;/</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">version</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;/</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;!</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">--</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> plugin logback ghi log skywalking </span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">--</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">    &lt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">org</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">apache</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">skywalking</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;/</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">    &lt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">apm</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">toolkit</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">logback</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">x</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;/</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">    &lt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">version</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">8.8</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#FFFFFF;--shiki-dark:#FFFFFF;">0</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;/</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">version</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;/</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Thêm cấu hình thu thập log vào logback.xml:</strong></p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">?</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">xml version</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;1.0&quot;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> encoding</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;UTF-8&quot;</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">?</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">configuration scan</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;true&quot;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> scanPeriod</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;5 seconds&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">    &lt;!</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">--</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> Thu</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> thập log skywalking </span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">--</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">    &lt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">appender name</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;grpc-log&quot;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> class</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;org.apache.skywalking.apm.toolkit.log.logback.v1.x.log.GRPCLogClientAppender&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">        &lt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">encoder class</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;ch.qos.logback.core.encoder.LayoutWrappingEncoder&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">            &lt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">layout class</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;org.apache.skywalking.apm.toolkit.log.logback.v1.x.mdc.TraceIdMDCPatternLogbackLayout&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">                &lt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">Pattern</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;%</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">d{yyyy</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">MM</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">dd HH</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">:</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">mm</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">:</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">ss</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">SSS</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">} [</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">X{tid}] [</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">thread] </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">%-</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">5level </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">logger{</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">36</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">} </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">-%</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">msg</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">n</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;/</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">Pattern</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">            &lt;/</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">layout</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">        &lt;/</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">encoder</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">    &lt;/</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">appender</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">    &lt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">root level</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;INFO&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">        &lt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">appender</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">ref ref</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;grpc-log&quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">    &lt;/</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">root</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&lt;/</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">configuration</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Sau khi cấu hình xong, log sẽ hiển thị trực tiếp trên giao diện người dùng. Bạn có thể nhấp vào các trang như theo dõi chuỗi, phân tích hiệu năng để trải nghiệm công cụ mạnh mẽ này. Ngoài ra, có thể cấu hình cảnh báo tùy chỉnh, liên kết với email, việc này khá dễ dàng.</p><h2 id="cau-hoi-phong-van" tabindex="-1"><a class="header-anchor" href="#cau-hoi-phong-van"><span>Câu hỏi phỏng vấn</span></a></h2><p>Dưới đây là các câu hỏi phỏng vấn phổ biến mà nhà tuyển dụng có thể hỏi liên quan đến Skywalking và dự án PmHub.</p><p><strong>Q:</strong> Hãy giải thích Skywalking là gì? Nó đóng vai trò gì trong giám sát hiệu năng và theo dõi phân tán?</p><p><strong>A:</strong> Skywalking là một hệ thống mã nguồn mở APM (Application Performance Monitoring) và theo dõi phân tán. Nó giúp chúng ta giám sát hiệu năng của hệ thống phân tán, theo dõi toàn bộ chuỗi request, xác định các điểm nghẽn hiệu năng và điểm lỗi.</p><p><strong>Q:</strong> Khi chọn Skywalking làm công cụ giám sát hiệu năng, bạn đã xem xét những công cụ nào khác và tại sao lại chọn Skywalking?</p><p><strong>A:</strong> Chúng tôi đã xem xét Zipkin và Jaeger. Chúng tôi chọn Skywalking vì nó tích hợp cả giám sát hiệu năng và theo dõi phân tán, hỗ trợ nhiều ngôn ngữ và ít xâm phạm vào mã nguồn, phù hợp với dự án của chúng tôi.</p><p><strong>Q:</strong> Bạn đã tích hợp Skywalking để giám sát hiệu năng của PmHub như thế nào? Hãy mô tả quá trình thực hiện.</p><p><strong>A:</strong> Chúng tôi đã tích hợp agent của Skywalking vào PmHub, sử dụng Skywalking OAP để thu thập và lưu trữ dữ liệu. Các chỉ số như thời gian phản hồi, lưu lượng và tỷ lệ lỗi được cấu hình để theo dõi hiệu năng hệ thống.</p><p><strong>Q:</strong> Những chỉ số giám sát nào bạn sử dụng để đánh giá hiệu năng của PmHub?</p><p><strong>A:</strong> Chúng tôi theo dõi thời gian phản hồi, lưu lượng, tỷ lệ lỗi, chuỗi gọi và thời gian truy vấn cơ sở dữ liệu để hiểu rõ tình trạng và các điểm nghẽn hiệu năng.</p><p><strong>Q:</strong> Skywalking đã giúp bạn phân tích và giải quyết vấn đề hiệu năng như thế nào trong theo dõi phân tán?</p><p><strong>A:</strong> Skywalking giúp theo dõi toàn bộ chuỗi gọi của từng yêu cầu, từ đó xác định điểm nghẽn hiệu năng và lỗi. Qua phân tích chuỗi gọi, chúng tôi có thể tìm ra vấn đề ở microservice nào và xử lý nhanh chóng.</p><p><strong>Q:</strong> Bạn có thể kể một ví dụ về việc phát hiện và giải quyết vấn đề hiệu năng thông qua theo dõi phân tán không?</p><p><strong>A:</strong> Chúng tôi phát hiện một yêu cầu có thời gian phản hồi dài bất thường. Qua phân tích chuỗi gọi, chúng tôi nhận thấy vấn đề nằm ở truy vấn cơ sở dữ liệu thiếu chỉ mục. Sau khi tối ưu chỉ mục, hiệu năng truy vấn được cải thiện đáng kể.</p><p>Câu hỏi và câu trả lời này giúp đánh giá kinh nghiệm thực tế của ứng viên về tích hợp Skywalking, giám sát hiệu năng, theo dõi phân tán và tối ưu hóa hệ thống.</p>`,92)]))}const p=n(h,[["render",l],["__file","monitoring.html.vue"]]),k=JSON.parse('{"path":"/project/pmhub/monitoring.html","title":"Skywalking Monitoring","lang":"en-US","frontmatter":{"title":"Skywalking Monitoring","tags":["java","microservice"],"categories":["project"],"order":7,"description":"PmHub - Distributed monitoring & tracing with Skywalking Bài viết này chủ yếu hướng dẫn cách sử dụng Skywalking trong PmHub để giám sát hiệu suất và truy vết phân tán. Nội dung ...","head":[["meta",{"property":"og:url","content":"https://vanhung4499.github.io/project/pmhub/monitoring.html"}],["meta",{"property":"og:site_name","content":"VanHung4499"}],["meta",{"property":"og:title","content":"Skywalking Monitoring"}],["meta",{"property":"og:description","content":"PmHub - Distributed monitoring & tracing with Skywalking Bài viết này chủ yếu hướng dẫn cách sử dụng Skywalking trong PmHub để giám sát hiệu suất và truy vết phân tán. Nội dung ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240917182929.png"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-10-02T17:20:50.000Z"}],["meta",{"property":"article:author","content":"Hung Nguyen"}],["meta",{"property":"article:tag","content":"java"}],["meta",{"property":"article:tag","content":"microservice"}],["meta",{"property":"article:modified_time","content":"2024-10-02T17:20:50.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Skywalking Monitoring\\",\\"image\\":[\\"https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240917182929.png\\",\\"https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240917183735.png\\",\\"https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240917192542.png\\",\\"https://skywalking.apache.org/images/home/architecture_2160x720.png\\",\\"https://skywalking.apache.org/blog/2018-12-12-skywalking-service-mesh-ready/0081Kckwly1gl2ctge1g5j31pc0s8h04.jpg\\",\\"https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240917201418.png\\",\\"https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240917201438.png\\",\\"https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240917201449.png\\",\\"https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240917212727.png\\",\\"https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240917212750.png\\",\\"https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240917212849.png\\",\\"https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240917220047.png\\"],\\"dateModified\\":\\"2024-10-02T17:20:50.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Hung Nguyen\\",\\"url\\":\\"https://vanhung4499.github.io\\"}]}"]]},"headers":[{"level":2,"title":"Tổng quan về truy vết chuỗi dịch vụ phân tán","slug":"tong-quan-ve-truy-vet-chuoi-dich-vu-phan-tan","link":"#tong-quan-ve-truy-vet-chuoi-dich-vu-phan-tan","children":[]},{"level":2,"title":"Nguyên lý truy vết chuỗi dịch vụ phân tán","slug":"nguyen-ly-truy-vet-chuoi-dich-vu-phan-tan","link":"#nguyen-ly-truy-vet-chuoi-dich-vu-phan-tan","children":[{"level":3,"title":"Skywalking là gì?","slug":"skywalking-la-gi","link":"#skywalking-la-gi","children":[]},{"level":3,"title":"Tại sao chọn Skywalking?","slug":"tai-sao-chon-skywalking","link":"#tai-sao-chon-skywalking","children":[]},{"level":3,"title":"Kiến trúc của Skywalking","slug":"kien-truc-cua-skywalking","link":"#kien-truc-cua-skywalking","children":[]},{"level":3,"title":"Cài đặt máy chủ","slug":"cai-đat-may-chu","link":"#cai-đat-may-chu","children":[]},{"level":3,"title":"1. Sửa cấu hình config/application.yml","slug":"_1-sua-cau-hinh-config-application-yml","link":"#_1-sua-cau-hinh-config-application-yml","children":[]},{"level":3,"title":"2. Sửa cấu hình webapp/webapp.yml (hoặc application.yml)","slug":"_2-sua-cau-hinh-webapp-webapp-yml-hoac-application-yml","link":"#_2-sua-cau-hinh-webapp-webapp-yml-hoac-application-yml","children":[]}]},{"level":2,"title":"Thực chiến dự án","slug":"thuc-chien-du-an","link":"#thuc-chien-du-an","children":[{"level":3,"title":"Cài đặt phía Client","slug":"cai-đat-phia-client","link":"#cai-đat-phia-client","children":[]},{"level":3,"title":"Giám sát log","slug":"giam-sat-log","link":"#giam-sat-log","children":[]}]},{"level":2,"title":"Câu hỏi phỏng vấn","slug":"cau-hoi-phong-van","link":"#cau-hoi-phong-van","children":[]}],"git":{"createdTime":1727889650000,"updatedTime":1727889650000,"contributors":[{"name":"Hung Nguyen Van","email":"vanhung4499@gmail.com","commits":1}]},"readingTime":{"minutes":11.88,"words":3563},"filePathRelative":"project/pmhub/monitoring.md","localizedDate":"October 2, 2024","excerpt":"\\n<p>Bài viết này chủ yếu hướng dẫn cách sử dụng <strong>Skywalking</strong> trong <strong>PmHub</strong> để giám sát hiệu suất và truy vết phân tán. Nội dung sẽ bắt đầu từ những kiến thức cơ bản, đến dự án thực tế và hướng dẫn tích hợp từ 0-1. Bài viết cũng sẽ chỉ ra cách dùng <strong>traceid</strong> để xác định các vấn đề trong chuỗi dịch vụ phân tán. Cuối cùng, sẽ có các câu hỏi giúp bạn <strong>nắm vững cách sử dụng thực tế Skywalking</strong>.</p>","autoDesc":true}');export{p as comp,k as data};
