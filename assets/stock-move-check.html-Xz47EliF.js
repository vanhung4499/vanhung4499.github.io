import{_ as e,g as i,o as c,c as p,e as n,h as a,f as d,w as l,a as o}from"./app-BRTHG7K9.js";const t={},r=n("h1",{id:"【库存】库存调拨、库存盘点",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#【库存】库存调拨、库存盘点"},[n("span",null,"【库存】库存调拨、库存盘点")])],-1),u=o('<figure><img src="https://cloud.iocoder.cn/img/ERP手册/库存模块03/表关系.png" alt="表关系" tabindex="0" loading="lazy"><figcaption>表关系</figcaption></figure><h2 id="_1-库存调拨" tabindex="-1"><a class="header-anchor" href="#_1-库存调拨"><span><a href="#_1-%E5%BA%93%E5%AD%98%E8%B0%83%E6%8B%A8">#</a> 1. 库存调拨</span></a></h2><p>库存调拨，由 ErpStockMoveController 提供接口，将产品从一个仓库调拨到另一个仓库，<strong>减少</strong> 来源仓库的库存，<strong>增加</strong> 目标仓库的库存。</p><h3 id="_1-表结构" tabindex="-1"><a class="header-anchor" href="#_1-表结构"><span><a href="#_1-%E8%A1%A8%E7%BB%93%E6%9E%84">#</a> 1. 表结构</span></a></h3><p><code>erp_stock_move</code> 表和 <code>erp_stock_move_item</code> 表，分别对应调拨单和调拨项。</p><blockquote><p>省略 creator/create_time/updater/update_time/deleted/tenant_id 等通用字段</p></blockquote><div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span>CREATE TABLE `erp_stock_move` (</span></span>\n<span class="line"><span>  `id` bigint NOT NULL AUTO_INCREMENT COMMENT &#39;调拨编号&#39;,</span></span>\n<span class="line"><span>  `no` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL COMMENT &#39;调拨单号&#39;,</span></span>\n<span class="line"><span>  `move_time` datetime NOT NULL COMMENT &#39;调拨时间&#39;,</span></span>\n<span class="line"><span>  </span></span>\n<span class="line"><span>  `total_count` decimal(24,6) NOT NULL COMMENT &#39;合计数量&#39;,</span></span>\n<span class="line"><span>  `total_price` decimal(24,6) NOT NULL COMMENT &#39;合计金额，单位：元&#39;,</span></span>\n<span class="line"><span>  `status` tinyint NOT NULL COMMENT &#39;状态&#39;,</span></span>\n<span class="line"><span>  </span></span>\n<span class="line"><span>  `remark` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT &#39;备注&#39;,</span></span>\n<span class="line"><span>  `file_url` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT &#39;附件 URL&#39;,</span></span>\n<span class="line"><span>  PRIMARY KEY (`id`)</span></span>\n<span class="line"><span>) ENGINE=InnoDB AUTO_INCREMENT=11 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT=&#39;ERP 库存调拨单表&#39;;</span></span></code></pre></div><p>① <code>no</code>：调拨单号，一般是系统自动生成的，目前格式是 <code>{prefix}{yyyyMMdd}{6 位自增}</code>。具体可见 ErpNoRedisDAO 类。</p><p>② <code>total_count</code> 和 <code>total_price</code>：合计数量和金额，目前只是记录，并无特殊逻辑。</p><p>③ <code>status</code>：状态，统一使用 ErpAuditStatus 枚举类，只有“未审批”、“已审批”两个状态。</p><hr><div class="language- line-numbers-mode" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span>CREATE TABLE `erp_stock_move_item` (</span></span>\n<span class="line"><span>  `id` bigint NOT NULL AUTO_INCREMENT COMMENT &#39;调拨项编号&#39;,</span></span>\n<span class="line"><span>  </span></span>\n<span class="line"><span>  `move_id` bigint NOT NULL COMMENT &#39;调拨编号&#39;,</span></span>\n<span class="line"><span> </span></span>\n<span class="line"><span>  `from_warehouse_id` bigint NOT NULL COMMENT &#39;调出仓库编号&#39;,</span></span>\n<span class="line"><span>  `to_warehouse_id` bigint NOT NULL COMMENT &#39;调入仓库编号&#39;,</span></span>\n<span class="line"><span>   </span></span>\n<span class="line"><span>  `product_id` bigint NOT NULL COMMENT &#39;产品编号&#39;,</span></span>\n<span class="line"><span>  `product_unit_id` bigint NOT NULL COMMENT &#39;产品单位编号&#39;,</span></span>\n<span class="line"><span>  `product_price` decimal(24,6) DEFAULT NULL COMMENT &#39;产品单价&#39;,</span></span>\n<span class="line"><span>  `count` decimal(24,6) NOT NULL COMMENT &#39;产品数量&#39;,</span></span>\n<span class="line"><span>  `total_price` decimal(24,6) DEFAULT NULL COMMENT &#39;合计金额，单位：元&#39;,</span></span>\n<span class="line"><span>  </span></span>\n<span class="line"><span>  `remark` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT &#39;备注&#39;,</span></span>\n<span class="line"><span>  PRIMARY KEY (`id`)</span></span>\n<span class="line"><span>) ENGINE=InnoDB AUTO_INCREMENT=11 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT=&#39;ERP 库存调拨项表&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>① <code>move_id</code>：调拨编号，关联到上面的 <code>erp_stock_move</code> 表。</p><p>② <code>from_warehouse_id</code> 和 <code>to_warehouse_id</code>：调出（来源）仓库编号和调入（目标）仓库编号。</p><p>③ <code>product_id</code>、<code>product_unit_id</code>、<code>product_price</code>、<code>count</code> 和 <code>total_price</code>：产品编号、产品单位编号、产品单价、数量和金额。</p><p>其中 <code>total_price</code> 等于 <code>product_price * count</code>。</p><h3 id="_2-管理后台" tabindex="-1"><a class="header-anchor" href="#_2-管理后台"><span><a href="#_2-%E7%AE%A1%E7%90%86%E5%90%8E%E5%8F%B0">#</a> 2. 管理后台</span></a></h3><p>对应 [ERP 系统 -&gt; 库存管理 -&gt; 库存调拨] 菜单，对应 <code>yudao-ui-admin-vue3</code> 项目的 <code>@/views/erp/stock/move</code> 目录。</p><figure><img src="https://cloud.iocoder.cn/img/ERP手册/库存模块03/库存调拨.png" alt="管理后台 - 库存调拨" tabindex="0" loading="lazy"><figcaption>管理后台 - 库存调拨</figcaption></figure><p>① 点击「新增」按钮，随便填写一些信息，点击「确认」按钮，即可新增一条调拨单。</p><figure><img src="https://cloud.iocoder.cn/img/ERP手册/库存模块03/库存调拨-新增.png" alt="新增库存调拨" tabindex="0" loading="lazy"><figcaption>新增库存调拨</figcaption></figure><p>② 点击该调拨单的「审批」按钮，审批通过该出库单，此时状态会变成“已审批”，同时会减少来源仓库的库存、增加目标仓库的库存、新增 <code>2n</code> 条库存变动记录。如下图所示：</p><figure><img src="https://cloud.iocoder.cn/img/ERP手册/库存模块03/库存调拨-审批.png" alt="审批库存调拨" tabindex="0" loading="lazy"><figcaption>审批库存调拨</figcaption></figure><p>③ 点击该调拨单的「反审批」按钮，反审批该调拨单，此时状态会变成“未审批”，同时会增加来源仓库的库存、减少目标仓库的库存、新增 <code>2n</code> 条库存变动记录。如下图所示：</p><figure><img src="https://cloud.iocoder.cn/img/ERP手册/库存模块03/库存调拨-反审批.png" alt="反审批库存调拨" tabindex="0" loading="lazy"><figcaption>反审批库存调拨</figcaption></figure><h2 id="_2-库存盘点" tabindex="-1"><a class="header-anchor" href="#_2-库存盘点"><span><a href="#_2-%E5%BA%93%E5%AD%98%E7%9B%98%E7%82%B9">#</a> 2. 库存盘点</span></a></h2><p>库存盘点，由 ErpStockCheckController 提供接口，盘点产品在仓库的具体库存，<strong>修改</strong> 它在该仓库的库存。</p><h3 id="_2-1-表结构" tabindex="-1"><a class="header-anchor" href="#_2-1-表结构"><span><a href="#_2-1-%E8%A1%A8%E7%BB%93%E6%9E%84">#</a> 2.1 表结构</span></a></h3><p><code>erp_stock_check</code> 表和 <code>erp_stock_check_item</code> 表，分别对应盘点单和盘点项。</p><blockquote><p>省略 creator/create_time/updater/update_time/deleted/tenant_id 等通用字段</p></blockquote><div class="language- line-numbers-mode" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span>CREATE TABLE `erp_stock_check` (</span></span>\n<span class="line"><span>  `id` bigint NOT NULL AUTO_INCREMENT COMMENT &#39;盘点编号&#39;,</span></span>\n<span class="line"><span>  </span></span>\n<span class="line"><span>  `no` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL COMMENT &#39;盘点单号&#39;,</span></span>\n<span class="line"><span>  `check_time` datetime NOT NULL COMMENT &#39;盘点时间&#39;,</span></span>\n<span class="line"><span>  </span></span>\n<span class="line"><span>  `total_count` decimal(24,6) NOT NULL COMMENT &#39;合计数量&#39;,</span></span>\n<span class="line"><span>  `total_price` decimal(24,6) NOT NULL COMMENT &#39;合计金额，单位：元&#39;,</span></span>\n<span class="line"><span>  </span></span>\n<span class="line"><span>  `status` tinyint NOT NULL COMMENT &#39;状态&#39;,</span></span>\n<span class="line"><span>  </span></span>\n<span class="line"><span>  `remark` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT &#39;备注&#39;,</span></span>\n<span class="line"><span>  `file_url` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT &#39;附件 URL&#39;,</span></span>\n<span class="line"><span>  PRIMARY KEY (`id`)</span></span>\n<span class="line"><span>) ENGINE=InnoDB AUTO_INCREMENT=13 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT=&#39;ERP 库存盘点单表&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>① <code>no</code>：盘点单号，一般是系统自动生成的，目前格式是 <code>{prefix}{yyyyMMdd}{6 位自增}</code>。具体可见 ErpNoRedisDAO 类。</p><p>② <code>total_count</code> 和 <code>total_price</code>：合计数量和金额，目前只是记录，并无特殊逻辑。</p><p>③ <code>status</code>：状态，统一使用 ErpAuditStatus 枚举类，只有“未审批”、“已审批”两个状态。</p><hr><div class="language- line-numbers-mode" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span>CREATE TABLE `erp_stock_check_item` (</span></span>\n<span class="line"><span>  `id` bigint NOT NULL AUTO_INCREMENT COMMENT &#39;调拨项编号&#39;,</span></span>\n<span class="line"><span>  </span></span>\n<span class="line"><span>  `check_id` bigint NOT NULL COMMENT &#39;调拨编号&#39;,</span></span>\n<span class="line"><span>  </span></span>\n<span class="line"><span>  `warehouse_id` bigint NOT NULL COMMENT &#39;仓库编号&#39;,</span></span>\n<span class="line"><span>  `product_id` bigint NOT NULL COMMENT &#39;产品编号&#39;,</span></span>\n<span class="line"><span>  </span></span>\n<span class="line"><span>  `product_unit_id` bigint NOT NULL COMMENT &#39;产品单位编号&#39;,</span></span>\n<span class="line"><span>  `product_price` decimal(24,6) DEFAULT NULL COMMENT &#39;产品单价&#39;,</span></span>\n<span class="line"><span>  `count` decimal(24,6) NOT NULL COMMENT &#39;盈亏数量&#39;,</span></span>\n<span class="line"><span>  `total_price` decimal(24,6) DEFAULT NULL COMMENT &#39;合计金额，单位：元&#39;,</span></span>\n<span class="line"><span>  </span></span>\n<span class="line"><span>  `stock_count` decimal(24,6) NOT NULL COMMENT &#39;账面数量（当前库存）&#39;,</span></span>\n<span class="line"><span>  `actual_count` decimal(24,6) NOT NULL COMMENT &#39;实际数量（实际库存）&#39;,</span></span>\n<span class="line"><span>  </span></span>\n<span class="line"><span>  `remark` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT &#39;备注&#39;,</span></span>\n<span class="line"><span>  PRIMARY KEY (`id`)</span></span>\n<span class="line"><span>) ENGINE=InnoDB AUTO_INCREMENT=14 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT=&#39;ERP 库存盘点项表&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>① <code>check_id</code>：盘点编号，关联到上面的 <code>erp_stock_check</code> 表。</p><p>② <code>warehouse_id</code> 和 <code>product_id</code>：仓库编号和产品编号，表示被盘点的产品在该仓库的库存。</p><p>③ <code>product_unit_id</code>、<code>product_price</code>、<code>count</code> 和 <code>total_price</code>：产品单位编号、产品单价、盈亏数量和金额。</p><p>其中 <code>total_price</code> 等于 <code>product_price * count</code>。</p><p>④ <code>stock_count</code> 和 <code>actual_count</code>：账面数量（当前库存）和实际数量（实际库存），这 2 个字段的差值就是盈亏数量 <code>count</code>。</p><p>不过也要注意，这 2 个字段更多是冗余，核心还是 <code>count</code> 表示盈亏。如果 <code>count</code> 是正数则库存增加（入库），<code>count</code> 是负数则库存减少（出库）。</p><h3 id="_2-2-管理后台" tabindex="-1"><a class="header-anchor" href="#_2-2-管理后台"><span><a href="#_2-2-%E7%AE%A1%E7%90%86%E5%90%8E%E5%8F%B0">#</a> 2.2 管理后台</span></a></h3><p>对应 [ERP 系统 -&gt; 库存管理 -&gt; 库存盘点] 菜单，对应 <code>yudao-ui-admin-vue3</code> 项目的 <code>@/views/erp/stock/check</code> 目录。</p><p>① 点击「新增」按钮，随便填写一些信息，点击「确认」按钮，即可新增一条盘点单。</p><figure><img src="https://cloud.iocoder.cn/img/ERP手册/库存模块03/库存盘点-新增.png" alt="新增库存盘点" tabindex="0" loading="lazy"><figcaption>新增库存盘点</figcaption></figure><p>② 点击该盘点单的「审批」按钮，审批通过该盘点单，此时状态会变成“已审批”，同时会修改对应的库存、新增库存明细。如下图所示：</p><figure><img src="https://cloud.iocoder.cn/img/ERP手册/库存模块03/库存盘点-审批.png" alt="审批库存盘点" tabindex="0" loading="lazy"><figcaption>审批库存盘点</figcaption></figure><p>③ 点击该盘点单的「反审批」按钮，反审批该盘点单，此时状态会变成“未审批”，同时会修改对应的库存、新增库存明细。如下图所示：</p><figure><img src="https://cloud.iocoder.cn/img/ERP手册/库存模块03/库存盘点-反审批.png" alt="反审批库存盘点" tabindex="0" loading="lazy"><figcaption>反审批库存盘点</figcaption></figure>',50);function E(m,_){const s=i("RouteLink");return c(),p("div",null,[r,n("p",null,[a("本文接 "),d(s,{to:"/erp/stock-in-out/"},{default:l(()=>[a("《【库存】其它入库、其它出库》")]),_:1}),a("，主要讲解库存管理的库存调拨、库存盘点。它们的表关系如下图所示：")]),u])}const b=e(t,[["render",E],["__file","stock-move-check.html.vue"]]),T=JSON.parse('{"path":"/project/yudao-cloud/erp/stock-move-check.html","title":"【库存】库存调拨、库存盘点","lang":"en-US","frontmatter":{"title":"【库存】库存调拨、库存盘点","tags":["project","java","spring-boot","spring-cloud"],"categories":["project"],"order":118,"feed":false,"seo":false,"head":[]},"headers":[{"level":2,"title":"# 1. 库存调拨","slug":"_1-库存调拨","link":"#_1-库存调拨","children":[{"level":3,"title":"# 1. 表结构","slug":"_1-表结构","link":"#_1-表结构","children":[]},{"level":3,"title":"# 2. 管理后台","slug":"_2-管理后台","link":"#_2-管理后台","children":[]}]},{"level":2,"title":"# 2. 库存盘点","slug":"_2-库存盘点","link":"#_2-库存盘点","children":[{"level":3,"title":"# 2.1 表结构","slug":"_2-1-表结构","link":"#_2-1-表结构","children":[]},{"level":3,"title":"# 2.2 管理后台","slug":"_2-2-管理后台","link":"#_2-2-管理后台","children":[]}]}],"git":{"createdTime":1720365235000,"updatedTime":1720365235000,"contributors":[{"name":"Hung Nguyen Van","email":"vanhung4499@gmail.com","commits":1}]},"readingTime":{"minutes":6.13,"words":1839},"filePathRelative":"project/yudao-cloud/erp/stock-move-check.md","localizedDate":"July 7, 2024"}');export{b as comp,T as data};
