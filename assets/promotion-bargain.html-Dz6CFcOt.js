import{_ as n,o as s,c as e,a as i}from"./app-5QVbWi7Z.js";const p={};function l(d,a){return s(),e("div",null,a[0]||(a[0]=[i('<h1 id="【营销】砍价活动" tabindex="-1"><a class="header-anchor" href="#【营销】砍价活动"><span>【营销】砍价活动</span></a></h1><p>友情提示：</p><p>uni-app Vue3 版本，砍价暂未迁移完成，预计 2024 年 Q2 完成。目前缺两部分：</p><ul><li>砍价商品详情页</li></ul><p>如果你着急的话，可以参考 <a href="https://gitee.com/yudaocode/yudao-mall-uniapp/tree/master-vue2/" target="_blank" rel="noopener noreferrer">uni-app Vue2 版本</a> 迁移过来，相关的后端接口都已经完成。</p><p>砍价功能，主要由 <code>yudao-module-promotion-biz</code> 后端模块的 <code>bargain</code> 实现，包括三部分：砍价活动、砍价助力。如下图所示：</p><figure><img src="https://doc.iocoder.cn/img/商城手册/砍价活动/表关系.png" alt="表关系" tabindex="0" loading="lazy"><figcaption>表关系</figcaption></figure><h2 id="_1-砍价活动" tabindex="-1"><a class="header-anchor" href="#_1-砍价活动"><span><a href="#_1-%E7%A0%8D%E4%BB%B7%E6%B4%BB%E5%8A%A8">#</a> 1. 砍价活动</span></a></h2><p>砍价活动，由卖家在管理后台配置，提供给买家参与砍价，由 BargainActivityService 类实现。</p><h3 id="_1-1-表结构" tabindex="-1"><a class="header-anchor" href="#_1-1-表结构"><span><a href="#_1-1-%E8%A1%A8%E7%BB%93%E6%9E%84">#</a> 1.1 表结构</span></a></h3><p>不同于砍价、砍价活动，一个砍价活动，只对应一个商品 SKU。</p><blockquote><p>省略 creator/create_time/updater/update_time/deleted/tenant_id 等通用字段</p></blockquote><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span>CREATE TABLE `promotion_bargain_activity` (</span></span>\n<span class="line"><span>  `id` bigint NOT NULL AUTO_INCREMENT COMMENT &#39;砍价活动编号&#39;,</span></span>\n<span class="line"><span>  `name` varchar(200) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL DEFAULT &#39;&#39; COMMENT &#39;砍价活动名称&#39;,</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>  `spu_id` bigint NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;商品 SPU 编号&#39;,</span></span>\n<span class="line"><span>  `sku_id` bigint NOT NULL COMMENT &#39;商品 SKU 编号&#39;,</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>  `status` int NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;活动状态&#39;,</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>  `total_limit_count` int NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;总限购数量&#39;,</span></span>\n<span class="line"><span>  `start_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT &#39;活动开始时间&#39;,</span></span>\n<span class="line"><span>  `end_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT &#39;活动结束时间&#39;,</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>  `bargain_first_price` int NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;砍价起始价格，单位分&#39;,</span></span>\n<span class="line"><span>  `bargain_min_price` int NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;砍价底价，单位：分&#39;,</span></span>\n<span class="line"><span>  `help_max_count` int NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;砍价人数&#39;,</span></span>\n<span class="line"><span>  `bargain_count` int NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;最大帮砍次数&#39;,</span></span>\n<span class="line"><span>  `random_min_price` int NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;用户每次砍价的最小金额，单位：分&#39;,</span></span>\n<span class="line"><span>  `random_max_price` int NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;用户每次砍价的最大金额，单位：分&#39;,</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>  `stock` int NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;砍价库存&#39;,</span></span>\n<span class="line"><span>  `total_stock` int NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;砍价总库存&#39;,</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>  PRIMARY KEY (`id`) USING BTREE</span></span>\n<span class="line"><span>) ENGINE=InnoDB AUTO_INCREMENT=26 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci COMMENT=&#39;砍价活动&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>① <code>spu_id</code>、<code>sku_id</code> 字段：对应的商品 SPU 编号、商品 SKU 编号。</p><p>注意：一个砍价活动，只能对应一个商品 SKU，不能对应多个商品 SPU 或者 SKU！！！</p><p>② <code>status</code> 字段：活动状态，由 CommonStatusEnum 枚举，只有开启、禁用两个状态。禁用时，无法参与砍价。</p><p>③ <code>stock</code>、<code>total_stock</code> 字段：砍价库存，自定义参与砍价的数量。</p><p>④ <code>bargain_first_price</code>、<code>bargain_min_price</code> 字段：砍价起始价格、砍价最低价格。比如商品原价 100 元，砍价起始价格 80 元，砍价底价 50 元，那么用户发起砍价时的价格为 80 元，最多邀请好友砍价到 50 元。</p><p><code>help_max_count</code> 字段：砍价人数，需要多少人，砍价才能成功。如果不砍价成功，则该砍价记录不允许下单支付。</p><p><code>help_max_count</code> 字段：单个活动，用户可以帮砍的次数。例如说：帮砍次数为 1 时，A 和 B 同时将该活动链接发给 C，C 只能帮其中一个人砍价。</p><p><code>random_min_price</code>、<code>random_max_price</code> 字段：用户每次砍价的最小金额、最大金额。比如用户每次砍价的金额为 1 元到 10 元之间的随机数。</p><h3 id="_1-2-管理后台" tabindex="-1"><a class="header-anchor" href="#_1-2-管理后台"><span><a href="#_1-2-%E7%AE%A1%E7%90%86%E5%90%8E%E5%8F%B0">#</a> 1.2 管理后台</span></a></h3><p>对应 [商城系统 -&gt; 营销中心 -&gt; 砍价活动 -&gt; 砍价商品] 菜单，对应 <code>yudao-ui-admin-vue3</code> 项目的 <code>views/mall/promotion/combination/activity</code> 目录。如下图所示：</p><figure><img src="https://doc.iocoder.cn/img/商城手册/砍价活动/砍价活动-管理后台.png" alt="管理后台" tabindex="0" loading="lazy"><figcaption>管理后台</figcaption></figure><h3 id="_1-3-移动端" tabindex="-1"><a class="header-anchor" href="#_1-3-移动端"><span><a href="#_1-3-%E7%A7%BB%E5%8A%A8%E7%AB%AF">#</a> 1.3 移动端</span></a></h3><p>TODO 界面迁移后，补充</p><h2 id="_2-砍价记录" tabindex="-1"><a class="header-anchor" href="#_2-砍价记录"><span><a href="#_2-%E7%A0%8D%E4%BB%B7%E8%AE%B0%E5%BD%95">#</a> 2. 砍价记录</span></a></h2><p>砍价记录，由买家发起砍价时生成，后续可邀请好友助力（砍价），由 BargainRecordService 类实现。</p><h3 id="_2-1-表结构" tabindex="-1"><a class="header-anchor" href="#_2-1-表结构"><span><a href="#_2-1-%E8%A1%A8%E7%BB%93%E6%9E%84">#</a> 2.1 表结构</span></a></h3><blockquote><p>省略 creator/create_time/updater/update_time/deleted/tenant_id 等通用字段</p></blockquote><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span>CREATE TABLE `promotion_bargain_record` (</span></span>\n<span class="line"><span>  `id` bigint NOT NULL AUTO_INCREMENT COMMENT &#39;砍价记录编号&#39;,</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>  `activity_id` bigint NOT NULL COMMENT &#39;砍价活动名称&#39;,</span></span>\n<span class="line"><span>  `spu_id` bigint NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;商品 SPU 编号&#39;,</span></span>\n<span class="line"><span>  `sku_id` bigint NOT NULL COMMENT &#39;商品 SKU 编号&#39;,</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>  `user_id` bigint NOT NULL COMMENT &#39;用户编号&#39;,</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>  `status` int NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;砍价状态&#39;,</span></span>\n<span class="line"><span>  `bargain_first_price` int NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;砍价起始价格，单位：分&#39;,</span></span>\n<span class="line"><span>  `bargain_price` int NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;当前砍价，单位：分&#39;,</span></span>\n<span class="line"><span>  `end_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT &#39;结束时间&#39;,</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>  `order_id` bigint DEFAULT NULL COMMENT &#39;订单编号&#39;,</span></span>\n<span class="line"><span>  PRIMARY KEY (`id`) USING BTREE</span></span>\n<span class="line"><span>) ENGINE=InnoDB AUTO_INCREMENT=33 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci COMMENT=&#39;砍价记录表&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>① 【活动信息】<code>activity_id</code> 字段：砍价活动编号，对应 <code>promotion_bargain_activity</code> 表的 <code>id</code> 字段。其它 <code>spu_id</code>、<code>sku_id</code> 字段，都是冗余字段，方便查询。</p><p>② 【用户信息】<code>user_id</code> 字段：用户编号，就是砍价发起的买家。</p><p>③ 【砍价信息】<code>status</code> 字段：砍价状态，由 BargainRecordStatusEnum 枚举，分成 3 种情况：砍价中、砍价成功、砍价失败。</p><p><code>bargain_first_price</code>、<code>bargain_price</code> 字段：砍价起始价格、当前砍价。</p><p>④ 【订单信息】<code>order_id</code> 字段：订单编号，对应订单表的 <code>id</code> 字段。砍价记录的 <code>status</code> 为砍价成功时，才可以创建并支付订单。</p><h3 id="_2-2-管理后台" tabindex="-1"><a class="header-anchor" href="#_2-2-管理后台"><span><a href="#_2-2-%E7%AE%A1%E7%90%86%E5%90%8E%E5%8F%B0">#</a> 2.2 管理后台</span></a></h3><p>对应 [商城系统 -&gt; 营销中心 -&gt; 砍价活动 -&gt; 砍价记录] 菜单，对应 <code>yudao-ui-admin-vue3</code> 项目的 <code>views/mall/promotion/bargain/record</code> 目录。如下图所示：</p><figure><img src="https://doc.iocoder.cn/img/商城手册/砍价活动/砍价记录-管理后台.png" alt="砍价记录" tabindex="0" loading="lazy"><figcaption>砍价记录</figcaption></figure><h3 id="_2-3-移动端" tabindex="-1"><a class="header-anchor" href="#_2-3-移动端"><span><a href="#_2-3-%E7%A7%BB%E5%8A%A8%E7%AB%AF">#</a> 2.3 移动端</span></a></h3><p>TODO 界面迁移后，补充</p><h2 id="_3-砍价助力" tabindex="-1"><a class="header-anchor" href="#_3-砍价助力"><span><a href="#_3-%E7%A0%8D%E4%BB%B7%E5%8A%A9%E5%8A%9B">#</a> 3. 砍价助力</span></a></h2><p>砍价助力，给好友的砍价记录助力（砍价）时生成，由 BargainHelpService 类实现。</p><h3 id="_3-1-表结构" tabindex="-1"><a class="header-anchor" href="#_3-1-表结构"><span><a href="#_3-1-%E8%A1%A8%E7%BB%93%E6%9E%84">#</a> 3.1 表结构</span></a></h3><blockquote><p>省略 creator/create_time/updater/update_time/deleted/tenant_id 等通用字段</p></blockquote><div class="language-" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span>CREATE TABLE `promotion_bargain_help` (</span></span>\n<span class="line"><span>  `id` bigint NOT NULL AUTO_INCREMENT COMMENT &#39;砍价助力编号&#39;,</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>  `user_id` bigint NOT NULL COMMENT &#39;用户编号&#39;,</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>  `activity_id` bigint NOT NULL COMMENT &#39;砍价活动名称&#39;,</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>  `record_id` bigint NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;砍价记录编号&#39;,</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>  `reduce_price` int NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;减少砍价，单位：分&#39;,</span></span>\n<span class="line"><span>  PRIMARY KEY (`id`) USING BTREE</span></span>\n<span class="line"><span>) ENGINE=InnoDB AUTO_INCREMENT=37 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci COMMENT=&#39;砍价助力表&#39;;</span></span></code></pre></div><p>比较简单，主要是一些关联的字段，自己瞅瞅就好。</p><h3 id="_3-2-管理后台" tabindex="-1"><a class="header-anchor" href="#_3-2-管理后台"><span><a href="#_3-2-%E7%AE%A1%E7%90%86%E5%90%8E%E5%8F%B0">#</a> 3.2 管理后台</span></a></h3><p>点击某个砍价记录后面的「助力」按钮，可以查看它的助力列表。如下图所示：</p><figure><img src="https://doc.iocoder.cn/img/商城手册/砍价活动/砍价助力-管理后台.png" alt="砍价助力" tabindex="0" loading="lazy"><figcaption>砍价助力</figcaption></figure><h3 id="_3-3-移动端" tabindex="-1"><a class="header-anchor" href="#_3-3-移动端"><span><a href="#_3-3-%E7%A7%BB%E5%8A%A8%E7%AB%AF">#</a> 3.3 移动端</span></a></h3><p>TODO 界面迁移后，补充</p>',52)]))}const r=n(p,[["render",l],["__file","promotion-bargain.html.vue"]]),t=JSON.parse('{"path":"/project/rouyi-vue-pro/mall/promotion-bargain.html","title":"【营销】砍价活动","lang":"en-US","frontmatter":{"title":"【营销】砍价活动","tags":["project","java","spring-boot","spring-cloud"],"categories":["project"],"order":104,"feed":false,"seo":false,"head":[]},"headers":[{"level":2,"title":"# 1. 砍价活动","slug":"_1-砍价活动","link":"#_1-砍价活动","children":[{"level":3,"title":"# 1.1 表结构","slug":"_1-1-表结构","link":"#_1-1-表结构","children":[]},{"level":3,"title":"# 1.2 管理后台","slug":"_1-2-管理后台","link":"#_1-2-管理后台","children":[]},{"level":3,"title":"# 1.3 移动端","slug":"_1-3-移动端","link":"#_1-3-移动端","children":[]}]},{"level":2,"title":"# 2. 砍价记录","slug":"_2-砍价记录","link":"#_2-砍价记录","children":[{"level":3,"title":"# 2.1 表结构","slug":"_2-1-表结构","link":"#_2-1-表结构","children":[]},{"level":3,"title":"# 2.2 管理后台","slug":"_2-2-管理后台","link":"#_2-2-管理后台","children":[]},{"level":3,"title":"# 2.3 移动端","slug":"_2-3-移动端","link":"#_2-3-移动端","children":[]}]},{"level":2,"title":"# 3. 砍价助力","slug":"_3-砍价助力","link":"#_3-砍价助力","children":[{"level":3,"title":"# 3.1 表结构","slug":"_3-1-表结构","link":"#_3-1-表结构","children":[]},{"level":3,"title":"# 3.2 管理后台","slug":"_3-2-管理后台","link":"#_3-2-管理后台","children":[]},{"level":3,"title":"# 3.3 移动端","slug":"_3-3-移动端","link":"#_3-3-移动端","children":[]}]}],"git":{"createdTime":1720365235000,"updatedTime":1720365235000,"contributors":[{"name":"Hung Nguyen Van","email":"vanhung4499@gmail.com","commits":1}]},"readingTime":{"minutes":5.45,"words":1634},"filePathRelative":"project/rouyi-vue-pro/mall/promotion-bargain.md","localizedDate":"July 7, 2024"}');export{r as comp,t as data};
