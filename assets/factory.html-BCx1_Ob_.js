import{_ as s,o as a,c as n,d as i}from"./app-B-9Tvu0g.js";const l={},o=i(`<h1 id="factory-method-pattern-xay-dung-dich-vu-phat-thuong-thong-nhat-cho-nhieu-loai-hang-hoa-khac-nhau" tabindex="-1"><a class="header-anchor" href="#factory-method-pattern-xay-dung-dich-vu-phat-thuong-thong-nhat-cho-nhieu-loai-hang-hoa-khac-nhau"><span>Factory Method Pattern: Xây dựng dịch vụ phát thưởng thống nhất cho nhiều loại hàng hóa khác nhau</span></a></h1><h2 id="gioi-thieu" tabindex="-1"><a class="header-anchor" href="#gioi-thieu"><span>Giới thiệu</span></a></h2><p>&quot;Code đẹp như nhau, nhưng chương trình kinh tởm thì được thăng chức và tăng lương.&quot;</p><p>Việc nói hay không nói, hầu hết các lập trình viên đều biết hoặc hiểu về mẫu thiết kế, nhưng hầu hết các bạn viết mã vẫn có thói quen tự do. Dù có bao nhiêu business logic cũng chỉ là một lớp với hàng nghìn dòng code, quá trình phát triển như vậy có thể tóm gọn trong ba bước: xác định thuộc tính, tạo phương thức, gọi interface, Done! Chỉ là việc phát triển ngắn hạn, nhưng tái cấu trúc là đập đi xây lại.</p><p>Mã nguồn tốt không chỉ để hoàn thành chức năng hiện tại, mà còn xem xét mở rộng sau này. Trên cấu trúc thiết kế là mềm dẻo, dễ đọc, dễ mở rộng, trong thực thi lĩnh vực cao độ gắn kết không để lộ chi tiết thực hiện không bị làm phiền bởi bên ngoài. Và điều này giống như trang trí nhà bạn với các loại nhà ba phòng ngủ (MVC), bốn phòng ngủ (DDD), bạn sẽ không cho phép một ngôi nhà giá hàng trăm nghìn đô la để dây cáp ống nước lộ ra ngoài, cũng như không cho phép đặt bồn cầu trong phòng bếp, bếp nướng lắp đặt trong phòng tắm.</p><p><strong>Ai phát minh ra mẫu thiết kế?</strong> Khái niệm về mẫu thiết kế ban đầu được <code>Christopher Alexander</code> đề xuất trong tác phẩm của ông, <code>Ngôn ngữ mẫu kiến trúc</code>. Cuốn sách này giới thiệu &quot;ngôn ngữ&quot; của thiết kế đô thị, cung cấp 253 mẫu mô tả về thành phố, khu phố, nhà ở, khu vườn, phòng và cấu trúc phương Tây, và đơn vị cơ bản của &quot;ngôn ngữ&quot; như vậy là mẫu. Sau đó, <code>Erich Gamma</code>, <code>John Vlissides</code>, <code>Ralph Johnson</code> và <code>Richard Helm</code> bốn tác giả đã chấp nhận khái niệm về mẫu. Vào năm 1994, họ đã xuất bản cuốn sách <code>Mẫu thiết kế: Cơ sở của phần mềm hướng đối tượng có thể tái sử dụng</code>.</p><p>Thực ra, một phần của người không đọc kỹ sách và tài liệu liên quan đến mẫu thiết kế, nhưng vẫn có thể viết code tốt. Điều này chủ yếu là do sau nhiều dự án trải qua và sự theo đuổi liên tục của thiết kế chương trình, đã trích xuất ra được kinh nghiệm. Và kinh nghiệm này cuối cùng sẽ gần như giống như nội dung được đề cập trong mẫu thiết kế, đòi hỏi sự kết hợp cao, kết hợp thấp, có thể mở rộng, có thể tái sử dụng. Bạn có thể gặp phải một số trải nghiệm tương tự, khi nghiên cứu mã nguồn của một số framework, bạn phát hiện ra rằng một số thiết kế trong đó giống như khi bạn phát triển.</p><p><strong>Tôi không học được mẫu thiết kế làm sao?</strong> Tiền đã bỏ ra, sách đã mua. Code vẫn là một chùm! Mẫu thiết kế được rút ra từ kinh nghiệm nhiều năm và trở thành tư duy hướng dẫn phát triển. Giống như tôi nói với bạn làm thế nào để đi xe đạp, lái xe, nhưng chỉ cần bạn không chạy hàng nghìn dặm, bạn chỉ có thể nhớ lý thuyết, muốn tham gia giao thông vẫn cảm thấy hoang mang!</p><p><strong>Vì vậy</strong>, ở phần đầu của loạt chủ đề mẫu thiết kế này, chúng tôi sẽ đưa bạn sử dụng ý tưởng về mẫu thiết kế để tối ưu hóa mã. Điều này giúp bạn học hỏi và tích lũy kinh nghiệm cho bản thân. Tất nhiên, ở đây cần phải thực hành nhiều hơn, chỉ khi <em>con người và phương tiện hoà hợp,</em> chúng ta mới có thể xây dựng được code hợp lý hơn dựa trên các mẫu thiết kế.</p><h2 id="moi-truong-phat-trien" tabindex="-1"><a class="header-anchor" href="#moi-truong-phat-trien"><span>Môi trường phát triển</span></a></h2><ol><li>JDK 1.8</li><li>Idea + Maven</li><li>Code: <a href="https://github.com/vanhung4499/practical-java-design" target="_blank" rel="noopener noreferrer">vanhung4499/practical-java-design</a></li></ol><table><thead><tr><th>Dự án</th><th>Mô tả</th></tr></thead><tbody><tr><td>demo-design-1-00</td><td>Dự án mô phỏng, cung cấp interface phát thưởng cho ba nhóm sản phẩm khác nhau</td></tr><tr><td>demo-design-1-01</td><td>Sử dụng mã nguồn lồng nhau để triển khai business requiremetnt, cũng là việc sử dụng ifelse</td></tr><tr><td>idemo-design-1-02</td><td>Tối ưu mã nguồn thông qua mấu thiết kể, tạo ra sự so sánh để học hỏi</td></tr></tbody></table><blockquote><p>[!info] Cách đánh thứ tự</p><ul><li>1-00, 1 đại diện cho mấu thiết kể đầu tiên, Factory Method Pattern</li><li>1-00, 00 đại diện cho tình huống mô phỏng</li><li>1-01, 01 đại diện cho phương pháp triển khai đầu tiên, tiếp theo là 02 03 và cứ thế</li></ul></blockquote><h2 id="gioi-thieu-ve-mau-thiet-ke-factory-method" tabindex="-1"><a class="header-anchor" href="#gioi-thieu-ve-mau-thiet-ke-factory-method"><span>## Giới thiệu về Mẫu thiết kế Factory Method</span></a></h2><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240326130012.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>Factory Pattern, còn được gọi là Factory Method Pattern, là một mẫu thiết kế tạo đối tượng, trong đó phương thức tạo đối tượng được cung cấp trong lớp cha, cho phép lớp con quyết định loại đối tượng được khởi tạo.</p><p>Mẫu thiết kế này cũng là một trong những mẫu thiết kế phổ biến nhất trong phát triển Java. Mục đích chính của nó là xác định một interface tạo đối tượng, để cho phép các lớp con tự quyết định khởi tạo đối tượng nào, mẫu thiết kế factory cho phép quá trình tạo ra trì hoãn cho lớp con.</p><p>Nói một cách đơn giản, mục đích của nó là cung cấp tính mở rộng của cấu trúc mã nguồn và che giấu logic cụ thể của từng lớp chức năng. Điều này giúp việc gọi từ bên ngoài trở nên đơn giản hơn, đồng thời cũng là cách loại bỏ nhiều trường hợp <code>ifelse</code>. Tất nhiên, điều này cũng có thể có một số nhược điểm, như số lượng lớp cần triển khai rất nhiều, cách thức quản lý như thế nào, làm thế nào để giảm thiểu chi phí phát triển. Tuy nhiên, những vấn đề này có thể được giảm bớt thông qua việc sử dụng kết hợp mẫu thiết kế sau này.</p><h2 id="mo-phong-viec-phat-thuong-nhieu-loai-hang-hoa" tabindex="-1"><a class="header-anchor" href="#mo-phong-viec-phat-thuong-nhieu-loai-hang-hoa"><span>Mô phỏng việc phát thưởng nhiều loại hàng hóa</span></a></h2><p>Để làm cho các ví dụ học tập trở nên gần gũi hơn với việc phát triển thực tế, ở đây chúng ta mô phỏng một doanh nghiệp trực tuyến trong một tình huống tiếp thị. Do tính phức tạp, thay đổi và tạm thời của tình huống tiếp thị, việc thiết kế yêu cầu sự chuyên sâu hơn, nếu không sẽ thường xuyên đối mặt với các hoạt động CRUD khẩn cấp, dẫn đến cấu trúc mã nguồn lộn xộn và khó bảo trì.</p><p>Trong tình huống tiếp thị, thường xuyên có người dùng thực hiện một số thao tác: đăng ký, chia sẻ, đánh giá, mời đăng ký, v.v, để nhận điểm thưởng và cuối cùng sử dụng điểm thưởng để đổi hàng hoá, từ đó thúc đẩy buôn bán và thu hút người dùng mới.</p><p>Vì vậy, ở đây chúng ta mô phỏng việc phát thưởng nhiều loại hàng hóa trong quá trình đổi điểm thưởng, giả sử bây giờ chúng ta có ba loại interface hàng hóa sau:</p><table><thead><tr><th>STT</th><th>Loại</th><th>Interface</th></tr></thead><tbody><tr><td>1</td><td>Phiếu giảm giá</td><td><code>CouponResult sendCoupon(String uId, String couponNumber, String uuid)</code></td></tr><tr><td>2</td><td>Hàng hóa thực</td><td><code>Boolean deliverGoods(DeliverReq req)</code></td></tr><tr><td>3</td><td>Thẻ đổi Iqiyi của bên thứ ba</td><td><code>void grantToken(String bindMobileNumber, String cardId)</code></td></tr></tbody></table><p><strong>Từ các interface trên, ta có các thông tin sau:</strong></p><ul><li>Ba interface trả về khác nhau, có kiểu đối tượng, kiểu boolean và một kiểu rỗng.</li><li>Các tham số đầu vào khác nhau, việc gửi phiếu giảm giá cần thông tin khách hàng, số phiếu giảm giá, uuid; việc đổi thẻ cần ID thẻ, hàng hóa thực cần thông tin về địa chỉ giao hàng (chứa trong đối tượng).</li><li>Ngoài ra, có thể sẽ có thêm loại hàng hóa khác được thêm vào sau này do yêu cầu phát triển kinh doanh của bạn. Bởi vì mọi nhu cầu phát triển của bạn đều điều chỉnh theo sự mở rộng của doanh nghiệp đối với thị trường.</li></ul><h2 id="trien-khai-bang-cach-viet-code-long-nhau" tabindex="-1"><a class="header-anchor" href="#trien-khai-bang-cach-viet-code-long-nhau"><span>Triển khai bằng cách viết code lồng nhau</span></a></h2><p>Nếu không xem xét đến tính mở rộng, chỉ để đáp ứng yêu cầu một cách nhanh chóng, thì việc phát thưởng cho các loại như vậy chỉ cần sử dụng câu lệnh if-else để kiểm tra và gọi các interface khác nhau là đủ. Điều này có thể là cách thường được sử dụng bởi một số bạn mới bắt đầu lập trình. Tiếp theo, chúng ta sẽ triển khai business requirement theo cách này trước.</p><h3 id="cau-truc-du-an" tabindex="-1"><a class="header-anchor" href="#cau-truc-du-an"><span>Cấu trúc dự án</span></a></h3><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">design-demo-1-01/</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">├──</span><span style="color:#98C379;--shiki-dark:#98C379;"> pom.xml</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">└──</span><span style="color:#98C379;--shiki-dark:#98C379;"> src</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    ├──</span><span style="color:#98C379;--shiki-dark:#98C379;"> main</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    │  </span><span style="color:#98C379;--shiki-dark:#98C379;"> └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> java</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    │  </span><span style="color:#98C379;--shiki-dark:#98C379;">     └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> com</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    │  </span><span style="color:#98C379;--shiki-dark:#98C379;">         └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> hnv99</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    │  </span><span style="color:#98C379;--shiki-dark:#98C379;">             └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> design</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    │  </span><span style="color:#98C379;--shiki-dark:#98C379;">                 ├──</span><span style="color:#98C379;--shiki-dark:#98C379;"> AwardReq.java</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    │  </span><span style="color:#98C379;--shiki-dark:#98C379;">                 ├──</span><span style="color:#98C379;--shiki-dark:#98C379;"> AwardRes.java</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    │  </span><span style="color:#98C379;--shiki-dark:#98C379;">                 └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> PrizeController.java</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> test</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> java</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">            └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> com</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> hnv99</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                    └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> design</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                        └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> ApiTest.java</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Cấu trúc dự án rất đơn giản, bao gồm một đối tượng đầu vào <code>AwardReq</code>, một đối tượng đầu ra <code>AwardRes</code>, và một lớp interface <code>PrizeController</code>.</li></ul><h3 id="trien-khai-bang-if-else" tabindex="-1"><a class="header-anchor" href="#trien-khai-bang-if-else"><span>Triển khai bằng if-else</span></a></h3><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> PrizeController</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Logger</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> logger </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> LoggerFactory</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getLogger</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">PrizeController</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">class</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> AwardRes</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> awardToUser</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">AwardReq</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> req</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        String</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> reqJson</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> JSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">toJSONString</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(req);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        AwardRes</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> awardRes</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        try</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">            logger</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">info</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Bắt đầu phát thưởng cho {}。req:{}&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">req</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getUId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(), reqJson);  </span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">            // Dựa vào loại phần thưởng khác nhau [1 phiếu giảm giá, 2 hàng hóa thực tế, 3 thẻ đổi thưởng bên thứ ba (ví dụ  Garena)]  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">            if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">req</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getAwardType</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">() </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">==</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) {  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">                CouponService</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> couponService</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> CouponService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">                CouponResult</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> couponResult</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> couponService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sendCoupon</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">req</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getUId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(), </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">req</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getAwardNumber</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(), </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">req</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getBizId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">());  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;0000&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">equals</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">couponResult</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getCode</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">())) {  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                    awardRes </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> AwardRes</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;0000&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Phát thành công&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                } </span><span style="color:#C678DD;--shiki-dark:#C678DD;">else</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                    awardRes </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> AwardRes</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;0001&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">couponResult</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getInfo</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">());  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                }            } </span><span style="color:#C678DD;--shiki-dark:#C678DD;">else</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">req</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getAwardType</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">() </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">==</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) {  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">                GoodsService</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> goodsService</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> GoodsService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">                DeliveryReq</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> deliverReq</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> DeliveryReq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">                deliverReq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setUserName</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">queryUserName</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">req</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getUId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">()));  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">                deliverReq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setUserPhone</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">queryUserPhoneNumber</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">req</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getUId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">()));  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">                deliverReq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setSku</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">req</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getAwardNumber</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">());  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">                deliverReq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setOrderId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">req</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getBizId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">());  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">                deliverReq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setConsigneeUserName</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">req</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getExtMap</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">().</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">get</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;consigneeUserName&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">));  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">                deliverReq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setConsigneeUserPhone</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">req</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getExtMap</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">().</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">get</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;consigneeUserPhone&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">));  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">                deliverReq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setConsigneeUserAddress</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">req</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getExtMap</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">().</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">get</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;consigneeUserAddress&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">));  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">                Boolean</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> isSuccess</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> goodsService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">deliverGoods</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(deliverReq);  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (isSuccess) {  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                    awardRes </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> AwardRes</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;0000&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Phát thành công&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                } </span><span style="color:#C678DD;--shiki-dark:#C678DD;">else</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                    awardRes </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> AwardRes</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;0001&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Phát thất bại&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                }            } </span><span style="color:#C678DD;--shiki-dark:#C678DD;">else</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">req</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getAwardType</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">() </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">==</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) {  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">                String</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> bindMobileNumber</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> queryUserPhoneNumber</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">req</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getUId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">());  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">                GarenaCardService</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> garenaCardService</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> GarenaCardService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">                garenaCardService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grantToken</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(bindMobileNumber, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">req</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getAwardNumber</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">());  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                awardRes </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> AwardRes</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;0000&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Phát thành công&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">            }            </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">logger</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">info</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Hoàn tất việc phát thưởng cho {}。&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">req</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getUId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">());  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">        } </span><span style="color:#C678DD;--shiki-dark:#C678DD;">catch</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Exception</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> e</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) {  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">            logger</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">error</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Phát thưởng thất bại {}。req:{}&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">req</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getUId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(), reqJson, e);  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">            awardRes </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> AwardRes</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;0001&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">e</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getMessage</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">());  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">        }  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> awardRes;  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> queryUserName</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> uId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Hung Nguyen&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> queryUserPhoneNumber</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> uId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;012345678&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Trên đây là một đoạn code trực tiếp sử dụng if-else để triển khai business requirement. Nếu chỉ xem xét từ góc độ business, việc triển khai cũng như dự kiến đã thực hiện được.</p><p>Code này trong tình hình hiện tại không có vấn đề gì đáng lo ngại. Tuy nhiên nếu sau này code này phải trải qua một vài lần phát triển và mở rộng, việc phát triển code sẽ trở nên khó khăn. Chi phí tái cấu trúc cao, cần phải sửa lại các interface trước đó, thời gian kiểm tra dài, cần phải kiểm tra lại toàn bộ một lần. Đây cũng là lý do tại sao nhiều người không muốn tiếp nhận mã nguồn của người khác, và nếu nhận, họ sẽ bị ép buộc về thời gian phát triển. Do đó, có thể thấy rằng số lần sử dụng if-else như vậy sẽ tiếp tục tăng lên.</p><h3 id="kiem-thu" tabindex="-1"><a class="header-anchor" href="#kiem-thu"><span>Kiểm thử</span></a></h3><p>Viết một bài unit test để kiểm tra phương pháp xử lý trên. Phát triển thói quen viết unit test sẽ giúp bạn nâng cao chất lượng code.</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> ApiTest</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Logger</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> logger </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> LoggerFactory</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getLogger</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">ApiTest</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">class</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    @</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Test</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> test_awardToUser</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        PrizeController</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> prizeController</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> PrizeController</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        System</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">out</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">println</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\r\\n</span><span style="color:#98C379;--shiki-dark:#98C379;">Kiểm tra phát phiếu giảm giá</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\r\\n</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">        // Kiểm tra phát phiếu giảm giá  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        AwardReq</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> req01</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> AwardReq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        req01</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setUId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;10001&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        req01</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setAwardType</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        req01</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setAwardNumber</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;EGM1023938910232121323432&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        req01</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setBizId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;791098764902132&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        AwardRes</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> awardRes01</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> prizeController</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awardToUser</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(req01);  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        logger</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">info</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Tham số yêu cầu: {}&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">JSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">toJSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(req01));  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        logger</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">info</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Kết quả kiểm tra: {}&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">JSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">toJSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(awardRes01));  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        System</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">out</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">println</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\r\\n</span><span style="color:#98C379;--shiki-dark:#98C379;">Kiểm tra việc giao dịch hàng hoá thực</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\r\\n</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">        // Kiểm tra giao dịch hàng hoá thực  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        AwardReq</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> req02</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> AwardReq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        req02</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setUId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;10001&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        req02</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setAwardType</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        req02</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setAwardNumber</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;9820198721311&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        req02</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setBizId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;1023000020112221113&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        req02</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setExtMap</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#C678DD;--shiki-dark:#C678DD;">new</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> HashMap</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;() {{  
            put(&quot;consigneeUserName&quot;, &quot;Hung Nguyen&quot;);  
            put(&quot;consigneeUserPhone&quot;, &quot;012345678&quot;);  
            put(&quot;consigneeUserAddress&quot;, &quot;Thu Duc, HCMC&quot;);  
        }});  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        AwardRes</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> awardRes02</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> prizeController</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awardToUser</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(req02);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        logger</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">info</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Tham số yêu cầu: {}&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">JSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">toJSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(req02));  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        logger</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">info</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Kết quả kiểm tra: {}&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">JSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">toJSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(awardRes02));  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        System</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">out</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">println</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\r\\n</span><span style="color:#98C379;--shiki-dark:#98C379;">Thẻ đổi thưởng bên thứ ba (Garena)</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\r\\n</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        AwardReq</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> req03</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> AwardReq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        req03</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setUId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;10001&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        req03</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setAwardType</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#D19A66;--shiki-dark:#D19A66;">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        req03</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setAwardNumber</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;AQY1xjkUodl8LO975GdfrYUio&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        AwardRes</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> awardRes03</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> prizeController</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awardToUser</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(req03);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        logger</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">info</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Tham số yêu cầu: {}&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">JSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">toJSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(req03));  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        logger</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">info</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Kết quả kiểm tra: {}&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">JSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">toJSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(awardRes03));    </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Kết quả:</strong></p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Kiểm</span><span style="color:#98C379;--shiki-dark:#98C379;"> tra</span><span style="color:#98C379;--shiki-dark:#98C379;"> phát</span><span style="color:#98C379;--shiki-dark:#98C379;"> phiếu</span><span style="color:#98C379;--shiki-dark:#98C379;"> giảm</span><span style="color:#98C379;--shiki-dark:#98C379;"> giá</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2024-03-25</span><span style="color:#98C379;--shiki-dark:#98C379;"> 20:58:32.171</span><span style="color:#98C379;--shiki-dark:#98C379;">	INFO</span><span style="color:#98C379;--shiki-dark:#98C379;">	main</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">		(PrizeController.java:21)	|	</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Bắt</span><span style="color:#98C379;--shiki-dark:#98C379;"> đầu</span><span style="color:#98C379;--shiki-dark:#98C379;"> phát</span><span style="color:#98C379;--shiki-dark:#98C379;"> thưởng</span><span style="color:#98C379;--shiki-dark:#98C379;"> cho</span><span style="color:#98C379;--shiki-dark:#98C379;"> 10001。req:{&quot;awardNumber&quot;:&quot;EGM1023938910232121323432&quot;,&quot;awardType&quot;:1,&quot;bizId&quot;:&quot;791098764902132&quot;,&quot;uId&quot;:&quot;10001&quot;}</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Mô</span><span style="color:#98C379;--shiki-dark:#98C379;"> phỏng</span><span style="color:#98C379;--shiki-dark:#98C379;"> việc</span><span style="color:#98C379;--shiki-dark:#98C379;"> phát</span><span style="color:#98C379;--shiki-dark:#98C379;"> phiếu</span><span style="color:#98C379;--shiki-dark:#98C379;"> giảm</span><span style="color:#98C379;--shiki-dark:#98C379;"> giá:</span><span style="color:#98C379;--shiki-dark:#98C379;"> 10001,</span><span style="color:#98C379;--shiki-dark:#98C379;"> EGM1023938910232121323432,</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 791098764902132</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2024-03-25</span><span style="color:#98C379;--shiki-dark:#98C379;"> 20:58:32.175</span><span style="color:#98C379;--shiki-dark:#98C379;">	INFO</span><span style="color:#98C379;--shiki-dark:#98C379;">	main</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">		(PrizeController.java:53)	|	</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Hoàn</span><span style="color:#98C379;--shiki-dark:#98C379;"> tất</span><span style="color:#98C379;--shiki-dark:#98C379;"> việc</span><span style="color:#98C379;--shiki-dark:#98C379;"> phát</span><span style="color:#98C379;--shiki-dark:#98C379;"> thưởng</span><span style="color:#98C379;--shiki-dark:#98C379;"> cho</span><span style="color:#98C379;--shiki-dark:#98C379;"> 10001。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2024-03-25</span><span style="color:#98C379;--shiki-dark:#98C379;"> 20:58:32.176</span><span style="color:#98C379;--shiki-dark:#98C379;">	INFO</span><span style="color:#98C379;--shiki-dark:#98C379;">	main</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">		(ApiTest.java:27)	|	</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Tham</span><span style="color:#98C379;--shiki-dark:#98C379;"> số</span><span style="color:#98C379;--shiki-dark:#98C379;"> yêu</span><span style="color:#98C379;--shiki-dark:#98C379;"> cầu:</span><span style="color:#98C379;--shiki-dark:#98C379;"> {&quot;uId&quot;:&quot;10001&quot;,&quot;bizId&quot;:&quot;791098764902132&quot;,&quot;awardNumber&quot;:&quot;EGM1023938910232121323432&quot;,&quot;awardType&quot;:1}</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2024-03-25</span><span style="color:#98C379;--shiki-dark:#98C379;"> 20:58:32.178</span><span style="color:#98C379;--shiki-dark:#98C379;">	INFO</span><span style="color:#98C379;--shiki-dark:#98C379;">	main</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">		(ApiTest.java:28)	|	</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Kết</span><span style="color:#98C379;--shiki-dark:#98C379;"> quả</span><span style="color:#98C379;--shiki-dark:#98C379;"> kiểm</span><span style="color:#98C379;--shiki-dark:#98C379;"> tra:</span><span style="color:#98C379;--shiki-dark:#98C379;"> {&quot;code&quot;:&quot;0000&quot;,&quot;info&quot;:&quot;Phát thành công&quot;}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Kiểm</span><span style="color:#98C379;--shiki-dark:#98C379;"> tra</span><span style="color:#98C379;--shiki-dark:#98C379;"> việc</span><span style="color:#98C379;--shiki-dark:#98C379;"> giao</span><span style="color:#98C379;--shiki-dark:#98C379;"> dịch</span><span style="color:#98C379;--shiki-dark:#98C379;"> hàng</span><span style="color:#98C379;--shiki-dark:#98C379;"> hoá</span><span style="color:#98C379;--shiki-dark:#98C379;"> thực</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2024-03-25</span><span style="color:#98C379;--shiki-dark:#98C379;"> 20:58:32.179</span><span style="color:#98C379;--shiki-dark:#98C379;">	INFO</span><span style="color:#98C379;--shiki-dark:#98C379;">	main</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">		(PrizeController.java:21)	|	</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Bắt</span><span style="color:#98C379;--shiki-dark:#98C379;"> đầu</span><span style="color:#98C379;--shiki-dark:#98C379;"> phát</span><span style="color:#98C379;--shiki-dark:#98C379;"> thưởng</span><span style="color:#98C379;--shiki-dark:#98C379;"> cho</span><span style="color:#98C379;--shiki-dark:#98C379;"> 10001。req:{&quot;awardNumber&quot;:&quot;9820198721311&quot;,&quot;awardType&quot;:2,&quot;bizId&quot;:&quot;1023000020112221113&quot;,&quot;extMap&quot;:{&quot;consigneeUserName&quot;:&quot;Hung Nguyen&quot;,&quot;consigneeUserPhone&quot;:&quot;012345678&quot;,&quot;consigneeUserAddress&quot;:&quot;Thu Duc, HCMC&quot;},&quot;uId&quot;:&quot;10001&quot;}</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Mô</span><span style="color:#98C379;--shiki-dark:#98C379;"> phỏng</span><span style="color:#98C379;--shiki-dark:#98C379;"> việc</span><span style="color:#98C379;--shiki-dark:#98C379;"> giao</span><span style="color:#98C379;--shiki-dark:#98C379;"> hàng</span><span style="color:#98C379;--shiki-dark:#98C379;"> hàng</span><span style="color:#98C379;--shiki-dark:#98C379;"> hoá</span><span style="color:#98C379;--shiki-dark:#98C379;"> thực:</span><span style="color:#98C379;--shiki-dark:#98C379;"> {&quot;consigneeUserAddress&quot;:&quot;Thu Duc, HCMC&quot;,&quot;consigneeUserName&quot;:&quot;Hung Nguyen&quot;,&quot;consigneeUserPhone&quot;:&quot;012345678&quot;,&quot;orderId&quot;:&quot;1023000020112221113&quot;,&quot;sku&quot;:&quot;9820198721311&quot;,&quot;userName&quot;:&quot;Hung Nguyen&quot;,&quot;userPhone&quot;:&quot;012345678&quot;}</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2024-03-25</span><span style="color:#98C379;--shiki-dark:#98C379;"> 20:58:32.183</span><span style="color:#98C379;--shiki-dark:#98C379;">	INFO</span><span style="color:#98C379;--shiki-dark:#98C379;">	main</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">		(PrizeController.java:53)	|	</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Hoàn</span><span style="color:#98C379;--shiki-dark:#98C379;"> tất</span><span style="color:#98C379;--shiki-dark:#98C379;"> việc</span><span style="color:#98C379;--shiki-dark:#98C379;"> phát</span><span style="color:#98C379;--shiki-dark:#98C379;"> thưởng</span><span style="color:#98C379;--shiki-dark:#98C379;"> cho</span><span style="color:#98C379;--shiki-dark:#98C379;"> 10001。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2024-03-25</span><span style="color:#98C379;--shiki-dark:#98C379;"> 20:58:32.183</span><span style="color:#98C379;--shiki-dark:#98C379;">	INFO</span><span style="color:#98C379;--shiki-dark:#98C379;">	main</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">		(ApiTest.java:44)	|	</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Tham</span><span style="color:#98C379;--shiki-dark:#98C379;"> số</span><span style="color:#98C379;--shiki-dark:#98C379;"> yêu</span><span style="color:#98C379;--shiki-dark:#98C379;"> cầu:</span><span style="color:#98C379;--shiki-dark:#98C379;"> {&quot;extMap&quot;:{&quot;consigneeUserName&quot;:&quot;Hung Nguyen&quot;,&quot;consigneeUserAddress&quot;:&quot;Thu Duc, HCMC&quot;,&quot;consigneeUserPhone&quot;:&quot;012345678&quot;},&quot;uId&quot;:&quot;10001&quot;,&quot;bizId&quot;:&quot;1023000020112221113&quot;,&quot;awardNumber&quot;:&quot;9820198721311&quot;,&quot;awardType&quot;:2}</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2024-03-25</span><span style="color:#98C379;--shiki-dark:#98C379;"> 20:58:32.183</span><span style="color:#98C379;--shiki-dark:#98C379;">	INFO</span><span style="color:#98C379;--shiki-dark:#98C379;">	main</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">		(ApiTest.java:45)	|	</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Kết</span><span style="color:#98C379;--shiki-dark:#98C379;"> quả</span><span style="color:#98C379;--shiki-dark:#98C379;"> kiểm</span><span style="color:#98C379;--shiki-dark:#98C379;"> tra:</span><span style="color:#98C379;--shiki-dark:#98C379;"> {&quot;code&quot;:&quot;0000&quot;,&quot;info&quot;:&quot;Phát thành công&quot;}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Thẻ</span><span style="color:#98C379;--shiki-dark:#98C379;"> đổi</span><span style="color:#98C379;--shiki-dark:#98C379;"> thưởng</span><span style="color:#98C379;--shiki-dark:#98C379;"> bên</span><span style="color:#98C379;--shiki-dark:#98C379;"> thứ</span><span style="color:#98C379;--shiki-dark:#98C379;"> ba</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (Garena)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2024-03-25</span><span style="color:#98C379;--shiki-dark:#98C379;"> 20:58:32.183</span><span style="color:#98C379;--shiki-dark:#98C379;">	INFO</span><span style="color:#98C379;--shiki-dark:#98C379;">	main</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">		(PrizeController.java:21)	|	</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Bắt</span><span style="color:#98C379;--shiki-dark:#98C379;"> đầu</span><span style="color:#98C379;--shiki-dark:#98C379;"> phát</span><span style="color:#98C379;--shiki-dark:#98C379;"> thưởng</span><span style="color:#98C379;--shiki-dark:#98C379;"> cho</span><span style="color:#98C379;--shiki-dark:#98C379;"> 10001。req:{&quot;awardNumber&quot;:&quot;AQY1xjkUodl8LO975GdfrYUio&quot;,&quot;awardType&quot;:3,&quot;uId&quot;:&quot;10001&quot;}</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Mô</span><span style="color:#98C379;--shiki-dark:#98C379;"> phỏng</span><span style="color:#98C379;--shiki-dark:#98C379;"> việc</span><span style="color:#98C379;--shiki-dark:#98C379;"> phát</span><span style="color:#98C379;--shiki-dark:#98C379;"> thẻ</span><span style="color:#98C379;--shiki-dark:#98C379;"> game</span><span style="color:#98C379;--shiki-dark:#98C379;"> Garena:</span><span style="color:#98C379;--shiki-dark:#98C379;"> 012345678,</span><span style="color:#98C379;--shiki-dark:#98C379;"> AQY1xjkUodl8LO975GdfrYUio</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2024-03-25</span><span style="color:#98C379;--shiki-dark:#98C379;"> 20:58:32.184</span><span style="color:#98C379;--shiki-dark:#98C379;">	INFO</span><span style="color:#98C379;--shiki-dark:#98C379;">	main</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">		(PrizeController.java:53)	|	</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Hoàn</span><span style="color:#98C379;--shiki-dark:#98C379;"> tất</span><span style="color:#98C379;--shiki-dark:#98C379;"> việc</span><span style="color:#98C379;--shiki-dark:#98C379;"> phát</span><span style="color:#98C379;--shiki-dark:#98C379;"> thưởng</span><span style="color:#98C379;--shiki-dark:#98C379;"> cho</span><span style="color:#98C379;--shiki-dark:#98C379;"> 10001。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2024-03-25</span><span style="color:#98C379;--shiki-dark:#98C379;"> 20:58:32.184</span><span style="color:#98C379;--shiki-dark:#98C379;">	INFO</span><span style="color:#98C379;--shiki-dark:#98C379;">	main</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">		(ApiTest.java:54)	|	</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Tham</span><span style="color:#98C379;--shiki-dark:#98C379;"> số</span><span style="color:#98C379;--shiki-dark:#98C379;"> yêu</span><span style="color:#98C379;--shiki-dark:#98C379;"> cầu:</span><span style="color:#98C379;--shiki-dark:#98C379;"> {&quot;uId&quot;:&quot;10001&quot;,&quot;awardNumber&quot;:&quot;AQY1xjkUodl8LO975GdfrYUio&quot;,&quot;awardType&quot;:3}</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2024-03-25</span><span style="color:#98C379;--shiki-dark:#98C379;"> 20:58:32.184</span><span style="color:#98C379;--shiki-dark:#98C379;">	INFO</span><span style="color:#98C379;--shiki-dark:#98C379;">	main</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">		(ApiTest.java:55)	|	</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Kết</span><span style="color:#98C379;--shiki-dark:#98C379;"> quả</span><span style="color:#98C379;--shiki-dark:#98C379;"> kiểm</span><span style="color:#98C379;--shiki-dark:#98C379;"> tra:</span><span style="color:#98C379;--shiki-dark:#98C379;"> {&quot;code&quot;:&quot;0000&quot;,&quot;info&quot;:&quot;Phát thành công&quot;}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Kết quả chạy bình thường, đáp ứng mọi business requirement hiện tại và viết rất nhanh. Nhưng! Thực sự rất khó để bảo trì!</li></ul><h2 id="tai-cau-truc-factory-method-pattern" tabindex="-1"><a class="header-anchor" href="#tai-cau-truc-factory-method-pattern"><span>Tái cấu trúc: Factory Method Pattern</span></a></h2><p>Tiếp theo, chúng ta sẽ sử dụng Factory Method Pattern để tối ưu hóa mã, đây cũng được coi là một ví dụ nhỏ về <strong>Refactoring</strong>. Sau khi Refactoring, bạn sẽ thấy cấu trúc mã rõ ràng hơn và có khả năng mở rộng cho các yêu cầu nghiệp vụ mới trong tương lai. Tuy nhiên, trong thực tế, chúng ta sẽ tiếp tục hoàn thiện nó, phần hiện tại chỉ tóm tắt phần cốt lõi nhất để bạn dễ dàng học tập.</p><h3 id="cau-truc-du-an-1" tabindex="-1"><a class="header-anchor" href="#cau-truc-du-an-1"><span>Cấu trúc dự án</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">design-demo-1-02/</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">├──</span><span style="color:#98C379;--shiki-dark:#98C379;"> pom.xml</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">└──</span><span style="color:#98C379;--shiki-dark:#98C379;"> src</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    ├──</span><span style="color:#98C379;--shiki-dark:#98C379;"> main</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    │  </span><span style="color:#98C379;--shiki-dark:#98C379;"> └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> java</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    │  </span><span style="color:#98C379;--shiki-dark:#98C379;">     └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> com</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    │  </span><span style="color:#98C379;--shiki-dark:#98C379;">         └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> hnv99</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    │  </span><span style="color:#98C379;--shiki-dark:#98C379;">             └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> design</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    │  </span><span style="color:#98C379;--shiki-dark:#98C379;">                 ├──</span><span style="color:#98C379;--shiki-dark:#98C379;"> StoreFactory.java</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    │  </span><span style="color:#98C379;--shiki-dark:#98C379;">                 └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> store</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    │  </span><span style="color:#98C379;--shiki-dark:#98C379;">                     ├──</span><span style="color:#98C379;--shiki-dark:#98C379;"> ICommodity.java</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    │  </span><span style="color:#98C379;--shiki-dark:#98C379;">                     └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> impl</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    │  </span><span style="color:#98C379;--shiki-dark:#98C379;">                         ├──</span><span style="color:#98C379;--shiki-dark:#98C379;"> CardCommodityService.java</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    │  </span><span style="color:#98C379;--shiki-dark:#98C379;">                         ├──</span><span style="color:#98C379;--shiki-dark:#98C379;"> CouponCommodityService.java</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    │  </span><span style="color:#98C379;--shiki-dark:#98C379;">                         └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> GoodsCommodityService.java</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> test</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> java</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">            └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> com</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> hnv99</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                    └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> design</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                        └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> ApiTest.java</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Đầu tiên, hãy nhìn vào cấu trúc dự án trên, bạn có cảm nhận gì? Ví dụ: <ul><li>Nó có vẻ rõ ràng hơn.</li><li>Việc phân chia tầng lớp như vậy giúp mở rộng dễ dàng hơn.</li><li>Có thể tưởng tượng mỗi lớp thực hiện chức năng gì.</li></ul></li><li>Nếu bạn vẫn chưa hiểu tại sao cần sửa đổi như vậy, cũng không sao cả. Bởi vì bạn đang học hỏi sức mạnh của Factory Pattern thông qua bài viết này. Đồng thời, sau khi xem mã nguồn và thực hành vài lần, bạn sẽ dần dần nắm vững kỹ thuật của Factory Pattern.</li></ul><h3 id="trien-khai-code" tabindex="-1"><a class="header-anchor" href="#trien-khai-code"><span>Triển khai code</span></a></h3><h4 id="đinh-nghia-interface-phat-thuong" tabindex="-1"><a class="header-anchor" href="#đinh-nghia-interface-phat-thuong"><span>Định nghĩa Interface phát thưởng</span></a></h4><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> interface</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> ICommodity</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    void</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> sendCommodity</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> uId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> commodityId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> bizId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Map</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;">extMap</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> throws</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Exception</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><ul><li>Tất cả các giải thưởng, dù là vật lý, ảo hay bên thứ ba, đều cần được xử lý thông qua chương trình của chúng tôi để triển khai interface này nhằm đảm bảo tính thống nhất của đầu vào và đầu ra sau cùng.</li><li>Các thông số đầu vào của interface bao gồm: <code>User ID</code>, <code>Prize ID</code>, <code>Business ID</code> và <code>Extra Field</code> được sử dụng để xử lý địa chỉ thu hoạch khi phát thưởng hàng hóa vật lý.</li></ul><h4 id="implement-icommodity-interface" tabindex="-1"><a class="header-anchor" href="#implement-icommodity-interface"><span>Implement ICommodity Interface</span></a></h4><h5 id="coupon-phieu-giam-gia" tabindex="-1"><a class="header-anchor" href="#coupon-phieu-giam-gia"><span><strong>Coupon (Phiếu giảm giá)</strong></span></a></h5><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> CouponCommodityService</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> implements</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> ICommodity</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Logger</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> logger </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> LoggerFactory</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getLogger</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">CouponCommodityService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">class</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> CouponService</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> couponService </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> CouponService</span><span style="color:#E06C75;--shiki-dark:#E06C75;">()</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> sendCommodity</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> uId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> commodityId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> bizId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Map</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;">extMap</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> throws</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Exception</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        CouponResult</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> couponResult</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> couponService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sendCoupon</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(uId, commodityId, bizId);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        logger</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">info</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Tham số yêu cầu[Phiếu giảm giá] =&gt; uId：{} commodityId：{} bizId：{} extMap：{}&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, uId, commodityId, bizId, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">JSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">toJSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(extMap));  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        logger</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">info</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Kết quả kiểm thử[Phiếu giảm giá]：{}&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">JSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">toJSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(couponResult));  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">!</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;0000&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">equals</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">couponResult</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getCode</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">())) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">throw</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> RuntimeException</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">couponResult</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getInfo</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">());  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><h5 id="goods-hang-hoa" tabindex="-1"><a class="header-anchor" href="#goods-hang-hoa"><span><strong>Goods (Hàng hóa)</strong></span></a></h5><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> GoodsCommodityService</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> implements</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> ICommodity</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Logger</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> logger </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> LoggerFactory</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getLogger</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">GoodsCommodityService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">class</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> GoodsService</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> goodsService </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> GoodsService</span><span style="color:#E06C75;--shiki-dark:#E06C75;">()</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> sendCommodity</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> uId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> commodityId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> bizId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Map</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;">extMap</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> throws</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Exception</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        DeliveryReq</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> deliveryReq</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> DeliveryReq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        deliveryReq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setUserName</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">queryUserName</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(uId));  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        deliveryReq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setUserPhone</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">queryUserPhoneNumber</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(uId));  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        deliveryReq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setSku</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(commodityId);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        deliveryReq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setOrderId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(bizId);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        deliveryReq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setConsigneeUserName</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">extMap</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">get</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;consigneeUserName&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">));  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        deliveryReq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setConsigneeUserPhone</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">extMap</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">get</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;consigneeUserPhone&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">));  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        deliveryReq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setConsigneeUserAddress</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">extMap</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">get</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;consigneeUserAddress&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">));  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        Boolean</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> isSuccess</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> goodsService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">deliverGoods</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(deliveryReq);  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        logger</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">info</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Tham số yêu cầu[Phiếu giảm giá] =&gt; uId：{} commodityId：{} bizId：{} extMap：{}&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, uId, commodityId, bizId, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">JSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">toJSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(extMap));  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        logger</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">info</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Kết quả kiểm thử[Phiếu giảm giá]：{}&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, isSuccess);  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">!</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">isSuccess) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">throw</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> RuntimeException</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Phát hàng hóa thất bại&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> queryUserName</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> uId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Hung Nguyen&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> queryUserPhoneNumber</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> uId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;012345678&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="card-the" tabindex="-1"><a class="header-anchor" href="#card-the"><span><strong>Card (Thẻ)</strong></span></a></h5><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> CardCommodityService</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> implements</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> ICommodity</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Logger</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> logger </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> LoggerFactory</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getLogger</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">CardCommodityService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">class</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Giả lập việc chèn  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> GarenaCardService</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> garenaCardService </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> GarenaCardService</span><span style="color:#E06C75;--shiki-dark:#E06C75;">()</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> sendCommodity</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> uId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> commodityId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> bizId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Map</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;">extMap</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> throws</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Exception</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        String</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> mobile</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> queryUserMobile</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(uId);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        garenaCardService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grantToken</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(mobile, bizId);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        logger</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">info</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Tham số yêu cầu[Thẻ đổi thưởng Garena] =&gt; uId：{} commodityId：{} bizId：{} extMap：{}&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, uId, commodityId, bizId, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">JSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">toJSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(extMap));  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        logger</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">info</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Kết quả kiểm thử[Thẻ đổi thưởng Garena]：Thành công&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> queryUserMobile</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> uId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;012345678&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Có thể thấy mỗi loại phần thưởng được triển khai trong lớp riêng của nó, việc thêm, sửa đổi hoặc xóa sẽ không ảnh hưởng đến chức năng kiểm thử của các phần thưởng khác.</li><li>Các giải thưởng bổ sung sau đó chỉ cần điền theo cấu trúc này, rất dễ duy trì và mở rộng.</li><li>Sau khi thống nhất các tham số đầu vào và tham số đầu ra, người gọi không còn cần quan tâm đến logic bên trong của việc phân phối giải thưởng và có thể xử lý nó một cách thống nhất.</li></ul><h4 id="tao-storefactory" tabindex="-1"><a class="header-anchor" href="#tao-storefactory"><span>Tạo StoreFactory</span></a></h4><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> StoreFactory</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> ICommodity</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> getCommodityService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Integer</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> commodityType</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#D19A66;--shiki-dark:#D19A66;">null</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> ==</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> commodityType) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">return</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> ==</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> commodityType) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">return</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> CouponCommodityService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> ==</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> commodityType) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">return</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> GoodsCommodityService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#D19A66;--shiki-dark:#D19A66;">3</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> ==</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> commodityType) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">return</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> CardCommodityService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">		throw</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> RuntimeException</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Product or service type not found.&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">); </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><ul><li>Ở đây, chúng ta đã định nghĩa một lớp Factory cho cửa hàng, trong đó thực hiện các dịch vụ phát thưởng theo loại. Điều này giúp code của bạn trở nên sạch và dễ hiểu, và các mặt hàng mới sẽ được mở rộng ở đây. Nếu bạn không thích câu lệnh <code>if</code>, bạn cũng có thể sử dụng <code>switch</code> hoặc cấu trúc cấu hình <code>map</code> để làm cho mã nguồn sạch sẽ hơn.</li><li>Ngoài ra, nhiều phần mềm kiểm tra mã nguồn và yêu cầu viết mở rộng sau câu lệnh <code>if</code>, tuy nhiên ở đây chúng tôi không làm như vậy để làm cho logic trở nên sạch sẽ hơn. Trong thực tế, bạn có thể thêm dấu ngoặc vào sau câu lệnh <code>if</code> trong code thực tế.</li></ul><h3 id="kiem-thu-1" tabindex="-1"><a class="header-anchor" href="#kiem-thu-1"><span>Kiểm thử</span></a></h3><p><strong>Viết unit test:</strong></p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">@</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Test</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> test_commodity</span><span style="color:#E06C75;--shiki-dark:#E06C75;">() throws Exception {</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    StoreFactory</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> storeFactory </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> StoreFactory</span><span style="color:#E06C75;--shiki-dark:#E06C75;">()</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // 1. Phiếu giảm giá</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    ICommodity</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> commodityService_1 </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> storeFactory</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getCommodityService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    commodityService_1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sendCommodity</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;10001&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;EGM1023938910232121323432&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;791098764902132&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">null</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // 2. Hàng hóa thực</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    ICommodity</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> commodityService_2 </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> storeFactory</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getCommodityService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    Map</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> extMap </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> HashMap</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">()</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    extMap</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">put</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;consigneeUserName&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Hung Nguyen&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    extMap</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">put</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;consigneeUserPhone&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;15200292123&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    extMap</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">put</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;consigneeUserAddress&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Thu Duc, HCM&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    commodityService_2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sendCommodity</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;10001&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;9820198721311&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;1023000020112221113&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, extMap);</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // 3. Thẻ đổi thưởng của bên thứ ba (Garena)</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    ICommodity</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> commodityService_3 </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> storeFactory</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getCommodityService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#D19A66;--shiki-dark:#D19A66;">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    commodityService_3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sendCommodity</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;10001&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;AQY1xjkUodl8LO975GdfrYUio&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#D19A66;--shiki-dark:#D19A66;">null</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#D19A66;--shiki-dark:#D19A66;">null</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Kết quả:</strong></p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Mô</span><span style="color:#98C379;--shiki-dark:#98C379;"> phỏng</span><span style="color:#98C379;--shiki-dark:#98C379;"> việc</span><span style="color:#98C379;--shiki-dark:#98C379;"> phát</span><span style="color:#98C379;--shiki-dark:#98C379;"> phiếu</span><span style="color:#98C379;--shiki-dark:#98C379;"> giảm</span><span style="color:#98C379;--shiki-dark:#98C379;"> giá:</span><span style="color:#98C379;--shiki-dark:#98C379;"> 10001,</span><span style="color:#98C379;--shiki-dark:#98C379;"> EGM1023938910232121323432,</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 791098764902132</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2024-03-25</span><span style="color:#98C379;--shiki-dark:#98C379;"> 23:35:26.176</span><span style="color:#98C379;--shiki-dark:#98C379;">	INFO</span><span style="color:#98C379;--shiki-dark:#98C379;">	main</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">		(CouponCommodityService.java:20)	|	</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Tham</span><span style="color:#98C379;--shiki-dark:#98C379;"> số</span><span style="color:#98C379;--shiki-dark:#98C379;"> yêu</span><span style="color:#98C379;--shiki-dark:#98C379;"> cầu[Phiếu</span><span style="color:#98C379;--shiki-dark:#98C379;"> giảm</span><span style="color:#98C379;--shiki-dark:#98C379;"> giá]</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">uId：10001</span><span style="color:#98C379;--shiki-dark:#98C379;"> commodityId：EGM1023938910232121323432</span><span style="color:#98C379;--shiki-dark:#98C379;"> bizId：791098764902132</span><span style="color:#98C379;--shiki-dark:#98C379;"> extMap：null</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2024-03-25</span><span style="color:#98C379;--shiki-dark:#98C379;"> 23:35:26.205</span><span style="color:#98C379;--shiki-dark:#98C379;">	INFO</span><span style="color:#98C379;--shiki-dark:#98C379;">	main</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">		(CouponCommodityService.java:21)	|	</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Kết</span><span style="color:#98C379;--shiki-dark:#98C379;"> quả</span><span style="color:#98C379;--shiki-dark:#98C379;"> kiểm</span><span style="color:#98C379;--shiki-dark:#98C379;"> thử[Phiếu</span><span style="color:#98C379;--shiki-dark:#98C379;"> giảm</span><span style="color:#98C379;--shiki-dark:#98C379;"> giá]：{&quot;code&quot;:&quot;0000&quot;,&quot;info&quot;:&quot;Phát thành công&quot;}</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Mô</span><span style="color:#98C379;--shiki-dark:#98C379;"> phỏng</span><span style="color:#98C379;--shiki-dark:#98C379;"> việc</span><span style="color:#98C379;--shiki-dark:#98C379;"> giao</span><span style="color:#98C379;--shiki-dark:#98C379;"> hàng</span><span style="color:#98C379;--shiki-dark:#98C379;"> hàng</span><span style="color:#98C379;--shiki-dark:#98C379;"> hoá</span><span style="color:#98C379;--shiki-dark:#98C379;"> thực:</span><span style="color:#98C379;--shiki-dark:#98C379;"> {&quot;consigneeUserAddress&quot;:&quot;Thu Duc, HCM&quot;,&quot;consigneeUserName&quot;:&quot;Hung Nguyen&quot;,&quot;consigneeUserPhone&quot;:&quot;012345678&quot;,&quot;orderId&quot;:&quot;1023000020112221113&quot;,&quot;sku&quot;:&quot;9820198721311&quot;,&quot;userName&quot;:&quot;Hung Nguyen&quot;,&quot;userPhone&quot;:&quot;012345678&quot;}</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2024-03-25</span><span style="color:#98C379;--shiki-dark:#98C379;"> 23:35:26.209</span><span style="color:#98C379;--shiki-dark:#98C379;">	INFO</span><span style="color:#98C379;--shiki-dark:#98C379;">	main</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">		(GoodsCommodityService.java:30)	|	</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Tham</span><span style="color:#98C379;--shiki-dark:#98C379;"> số</span><span style="color:#98C379;--shiki-dark:#98C379;"> yêu</span><span style="color:#98C379;--shiki-dark:#98C379;"> cầu[Phiếu</span><span style="color:#98C379;--shiki-dark:#98C379;"> giảm</span><span style="color:#98C379;--shiki-dark:#98C379;"> giá]</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">uId：10001</span><span style="color:#98C379;--shiki-dark:#98C379;"> commodityId：9820198721311</span><span style="color:#98C379;--shiki-dark:#98C379;"> bizId：1023000020112221113</span><span style="color:#98C379;--shiki-dark:#98C379;"> extMap：{&quot;consigneeUserName&quot;:&quot;Hung Nguyen&quot;,&quot;consigneeUserAddress&quot;:&quot;Thu Duc, HCM&quot;,&quot;consigneeUserPhone&quot;:&quot;012345678&quot;}</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2024-03-25</span><span style="color:#98C379;--shiki-dark:#98C379;"> 23:35:26.210</span><span style="color:#98C379;--shiki-dark:#98C379;">	INFO</span><span style="color:#98C379;--shiki-dark:#98C379;">	main</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">		(GoodsCommodityService.java:31)	|	</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Kết</span><span style="color:#98C379;--shiki-dark:#98C379;"> quả</span><span style="color:#98C379;--shiki-dark:#98C379;"> kiểm</span><span style="color:#98C379;--shiki-dark:#98C379;"> thử[Phiếu</span><span style="color:#98C379;--shiki-dark:#98C379;"> giảm</span><span style="color:#98C379;--shiki-dark:#98C379;"> giá]：</span><span style="color:#D19A66;--shiki-dark:#D19A66;">true</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Mô</span><span style="color:#98C379;--shiki-dark:#98C379;"> phỏng</span><span style="color:#98C379;--shiki-dark:#98C379;"> việc</span><span style="color:#98C379;--shiki-dark:#98C379;"> phát</span><span style="color:#98C379;--shiki-dark:#98C379;"> thẻ</span><span style="color:#98C379;--shiki-dark:#98C379;"> game</span><span style="color:#98C379;--shiki-dark:#98C379;"> Garena:</span><span style="color:#98C379;--shiki-dark:#98C379;"> 012345678,</span><span style="color:#98C379;--shiki-dark:#98C379;"> null</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2024-03-25</span><span style="color:#98C379;--shiki-dark:#98C379;"> 23:35:26.210</span><span style="color:#98C379;--shiki-dark:#98C379;">	INFO</span><span style="color:#98C379;--shiki-dark:#98C379;">	main</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">		(CardCommodityService.java:21)	|	</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Tham</span><span style="color:#98C379;--shiki-dark:#98C379;"> số</span><span style="color:#98C379;--shiki-dark:#98C379;"> yêu</span><span style="color:#98C379;--shiki-dark:#98C379;"> cầu[Thẻ</span><span style="color:#98C379;--shiki-dark:#98C379;"> đổi</span><span style="color:#98C379;--shiki-dark:#98C379;"> thưởng</span><span style="color:#98C379;--shiki-dark:#98C379;"> Garena]</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">uId：10001</span><span style="color:#98C379;--shiki-dark:#98C379;"> commodityId：AQY1xjkUodl8LO975GdfrYUio</span><span style="color:#98C379;--shiki-dark:#98C379;"> bizId：null</span><span style="color:#98C379;--shiki-dark:#98C379;"> extMap：null</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2024-03-25</span><span style="color:#98C379;--shiki-dark:#98C379;"> 23:35:26.210</span><span style="color:#98C379;--shiki-dark:#98C379;">	INFO</span><span style="color:#98C379;--shiki-dark:#98C379;">	main</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">		(CardCommodityService.java:22)	|	</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Kết</span><span style="color:#98C379;--shiki-dark:#98C379;"> quả</span><span style="color:#98C379;--shiki-dark:#98C379;"> kiểm</span><span style="color:#98C379;--shiki-dark:#98C379;"> thử[Thẻ</span><span style="color:#98C379;--shiki-dark:#98C379;"> đổi</span><span style="color:#98C379;--shiki-dark:#98C379;"> thưởng</span><span style="color:#98C379;--shiki-dark:#98C379;"> Garena]：Thành</span><span style="color:#98C379;--shiki-dark:#98C379;"> công</span></span></code></pre></div><ul><li>Kết quả chạy bình thường, đáp ứng yêu cầu business requirement và đáp ứng tiêu chí của riêng tôi. Mã nguồn như vậy khi triển khai và chạy trực tuyến sẽ không khiến bạn lo lắng, không cảm thấy lo sợ có thể nhận cuộc gọi vào nửa đêm.</li><li>Ngoài ra, từ kết quả chạy thử nghiệm cũng có thể thấy rằng sau khi đóng gói, có thể thấy rõ sự hoàn thiện của toàn bộ bộ dịch vụ phân phối giải thưởng, đầu vào và kết quả là thống nhất.</li></ul><h2 id="tong-ket" tabindex="-1"><a class="header-anchor" href="#tong-ket"><span>Tổng kết</span></a></h2><ul><li>Từ việc tối ưu từ trên xuống dưới, có thể thấy rằng Factory Method Pattern không phức tạp, thậm chí sau khi bạn hiểu rõ, bạn sẽ thấy nó càng đơn giản hơn.</li><li>Về lợi ích của việc phát triển như vậy, bạn cũng có thể tổng kết ra các ưu điểm; <code>Tránh sự ràng buộc giữa người tạo và logic cụ thể của sản phẩm</code>, <code>Đáp ứng nguyên tắc trách nhiệm đơn lẻ, business logic được thực hiện trong lớp tương ứng của nó</code>, <code>Đáp ứng nguyên tắc mở và đóng, không cần thay đổi, người gọi có thể thêm các loại sản phẩm mới vào chương trình mà không cần sửa đổi</code>.</li><li>Tuy nhiên, điều này cũng có thể mang lại một số vấn đề, ví dụ: Nếu có rất nhiều loại sản phẩm, số lượng lớp con sẽ mở rộng rất nhanh. Do đó, cũng cần sử dụng các mẫu khác để tối ưu hóa, những điều này sẽ được đề cập dần dần trong các mẫu thiết kế sau này.</li><li>Bằng cách bắt đầu từ các ví dụ, việc hiểu về mẫu thiết kế thường dễ dàng hơn so với việc học lý thuyết, vì ví dụ là cách tốt nhất để rút ngắn khoảng cách từ lý thuyết đến thực hành. Nếu bạn đã có một số kiến thức, hãy thử áp dụng vào thực tế.</li></ul>`,68),r=[o];function p(e,t){return a(),n("div",null,r)}const B=s(l,[["render",p],["__file","factory.html.vue"]]),c=JSON.parse('{"path":"/design/design-pattern/practical/creational/factory.html","title":"Factory Pattern Practice","lang":"en-US","frontmatter":{"title":"Factory Pattern Practice","tags":["design-pattern"],"categories":null,"date created":"2024-03-25T00:00:00.000Z","date modified":"2024-03-27T00:00:00.000Z","description":"Factory Method Pattern: Xây dựng dịch vụ phát thưởng thống nhất cho nhiều loại hàng hóa khác nhau Giới thiệu \\"Code đẹp như nhau, nhưng chương trình kinh tởm thì được thăng chức ...","head":[["meta",{"property":"og:url","content":"https://vanhung4499.github.io/design/design-pattern/practical/creational/factory.html"}],["meta",{"property":"og:site_name","content":"VanHung4499"}],["meta",{"property":"og:title","content":"Factory Pattern Practice"}],["meta",{"property":"og:description","content":"Factory Method Pattern: Xây dựng dịch vụ phát thưởng thống nhất cho nhiều loại hàng hóa khác nhau Giới thiệu \\"Code đẹp như nhau, nhưng chương trình kinh tởm thì được thăng chức ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240326130012.png"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-06-28T15:54:38.000Z"}],["meta",{"property":"article:author","content":"Hung Nguyen"}],["meta",{"property":"article:tag","content":"design-pattern"}],["meta",{"property":"article:modified_time","content":"2024-06-28T15:54:38.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Factory Pattern Practice\\",\\"image\\":[\\"https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240326130012.png\\"],\\"dateModified\\":\\"2024-06-28T15:54:38.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Hung Nguyen\\",\\"url\\":\\"https://vanhung4499.github.io\\"}]}"]]},"headers":[{"level":2,"title":"Giới thiệu","slug":"gioi-thieu","link":"#gioi-thieu","children":[]},{"level":2,"title":"Môi trường phát triển","slug":"moi-truong-phat-trien","link":"#moi-truong-phat-trien","children":[]},{"level":2,"title":"## Giới thiệu về Mẫu thiết kế Factory Method","slug":"gioi-thieu-ve-mau-thiet-ke-factory-method","link":"#gioi-thieu-ve-mau-thiet-ke-factory-method","children":[]},{"level":2,"title":"Mô phỏng việc phát thưởng nhiều loại hàng hóa","slug":"mo-phong-viec-phat-thuong-nhieu-loai-hang-hoa","link":"#mo-phong-viec-phat-thuong-nhieu-loai-hang-hoa","children":[]},{"level":2,"title":"Triển khai bằng cách viết code lồng nhau","slug":"trien-khai-bang-cach-viet-code-long-nhau","link":"#trien-khai-bang-cach-viet-code-long-nhau","children":[{"level":3,"title":"Cấu trúc dự án","slug":"cau-truc-du-an","link":"#cau-truc-du-an","children":[]},{"level":3,"title":"Triển khai bằng if-else","slug":"trien-khai-bang-if-else","link":"#trien-khai-bang-if-else","children":[]},{"level":3,"title":"Kiểm thử","slug":"kiem-thu","link":"#kiem-thu","children":[]}]},{"level":2,"title":"Tái cấu trúc: Factory Method Pattern","slug":"tai-cau-truc-factory-method-pattern","link":"#tai-cau-truc-factory-method-pattern","children":[{"level":3,"title":"Cấu trúc dự án","slug":"cau-truc-du-an-1","link":"#cau-truc-du-an-1","children":[]},{"level":3,"title":"Triển khai code","slug":"trien-khai-code","link":"#trien-khai-code","children":[]},{"level":3,"title":"Kiểm thử","slug":"kiem-thu-1","link":"#kiem-thu-1","children":[]}]},{"level":2,"title":"Tổng kết","slug":"tong-ket","link":"#tong-ket","children":[]}],"git":{"createdTime":1719590078000,"updatedTime":1719590078000,"contributors":[{"name":"Hung Nguyen Van","email":"vanhung4499@gmail.com","commits":1}]},"readingTime":{"minutes":16.83,"words":5048},"filePathRelative":"design/design-pattern/practical/creational/factory.md","localizedDate":"June 28, 2024","excerpt":"\\n<h2>Giới thiệu</h2>\\n<p>\\"Code đẹp như nhau, nhưng chương trình kinh tởm thì được thăng chức và tăng lương.\\"</p>\\n<p>Việc nói hay không nói, hầu hết các lập trình viên đều biết hoặc hiểu về mẫu thiết kế, nhưng hầu hết các bạn viết mã vẫn có thói quen tự do. Dù có bao nhiêu business logic cũng chỉ là một lớp với hàng nghìn dòng code, quá trình phát triển như vậy có thể tóm gọn trong ba bước: xác định thuộc tính, tạo phương thức, gọi interface, Done! Chỉ là việc phát triển ngắn hạn, nhưng tái cấu trúc là đập đi xây lại.</p>","autoDesc":true}');export{B as comp,c as data};
