import{_ as a,o as i,c as s,a as e}from"./app-5QVbWi7Z.js";const l={};function c(p,n){return i(),s("div",null,n[0]||(n[0]=[e('<h1 id="【营销】秒杀活动" tabindex="-1"><a class="header-anchor" href="#【营销】秒杀活动"><span>【营销】秒杀活动</span></a></h1><p>秒杀功能，主要由 <code>yudao-module-promotion-biz</code> 后端模块的 <code>seckill</code> 实现，包括两部分：秒杀配置（场次）、秒杀活动。如下图所示：</p><figure><img src="https://doc.iocoder.cn/img/商城手册/秒杀活动/表关系.png" alt="表关系" tabindex="0" loading="lazy"><figcaption>表关系</figcaption></figure><h2 id="_1-秒杀配置" tabindex="-1"><a class="header-anchor" href="#_1-秒杀配置"><span><a href="#_1-%E7%A7%92%E6%9D%80%E9%85%8D%E7%BD%AE">#</a> 1. 秒杀配置</span></a></h2><p>秒杀配置，由卖家在管理后台配置，设置可参与秒杀的时间段（场次），由 SeckillConfigService 类实现。</p><h3 id="_1-1-表结构" tabindex="-1"><a class="header-anchor" href="#_1-1-表结构"><span><a href="#_1-1-%E8%A1%A8%E7%BB%93%E6%9E%84">#</a> 1.1 表结构</span></a></h3><blockquote><p>省略 creator/create_time/updater/update_time/deleted/tenant_id 等通用字段</p></blockquote><div class="language-" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span>CREATE TABLE `promotion_seckill_config` (</span></span>\n<span class="line"><span>  `id` bigint NOT NULL AUTO_INCREMENT COMMENT &#39;编号&#39;,</span></span>\n<span class="line"><span>  `name` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL COMMENT &#39;秒杀时段名称&#39;,</span></span>\n<span class="line"><span>  `start_time` varchar(25) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL COMMENT &#39;开始时间点&#39;,</span></span>\n<span class="line"><span>  `end_time` varchar(25) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL COMMENT &#39;结束时间点&#39;,</span></span>\n<span class="line"><span>  `slider_pic_urls` varchar(1024) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL COMMENT &#39;秒杀主图&#39;,</span></span>\n<span class="line"><span>  `status` tinyint NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;活动状态&#39;,</span></span>\n<span class="line"><span>  PRIMARY KEY (`id`) USING BTREE</span></span>\n<span class="line"><span>) ENGINE=InnoDB AUTO_INCREMENT=38 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci COMMENT=&#39;秒杀时段&#39;;</span></span></code></pre></div><h3 id="_1-2-管理后台" tabindex="-1"><a class="header-anchor" href="#_1-2-管理后台"><span><a href="#_1-2-%E7%AE%A1%E7%90%86%E5%90%8E%E5%8F%B0">#</a> 1.2 管理后台</span></a></h3><p>对应 [商城系统 -&gt; 营销中心 -&gt; 秒杀活动 -&gt; 秒杀时段] 菜单，对应 <code>yudao-ui-admin-vue3</code> 项目的 <code>views/mall/promotion/seckill/config</code> 目录。如下图所示：</p><figure><img src="https://doc.iocoder.cn/img/商城手册/秒杀活动/秒杀配置-管理后台.png" alt="管理后台" tabindex="0" loading="lazy"><figcaption>管理后台</figcaption></figure><h2 id="_2-秒杀活动" tabindex="-1"><a class="header-anchor" href="#_2-秒杀活动"><span><a href="#_2-%E7%A7%92%E6%9D%80%E6%B4%BB%E5%8A%A8">#</a> 2. 秒杀活动</span></a></h2><p>秒杀活动，由卖家在管理后台配置，提供给买家参与秒杀，由 SeckillActivityService 类实现。</p><h3 id="_2-1-表结构" tabindex="-1"><a class="header-anchor" href="#_2-1-表结构"><span><a href="#_2-1-%E8%A1%A8%E7%BB%93%E6%9E%84">#</a> 2.1 表结构</span></a></h3><p>一个秒杀活动，对应一条 <code>promotion_seckill_activity</code> 表记录，对应一个商品 SPU。而每个商品 SKU 在该秒杀下可以单独配置秒杀价格、库存，所以会有多条 <code>promotion_seckill_product</code> 子表记录。</p><blockquote><p>省略 creator/create_time/updater/update_time/deleted/tenant_id 等通用字段</p></blockquote><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span>CREATE TABLE `promotion_seckill_activity` (</span></span>\n<span class="line"><span>  `id` bigint NOT NULL AUTO_INCREMENT COMMENT &#39;秒杀活动编号&#39;,</span></span>\n<span class="line"><span>  `name` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL DEFAULT &#39;&#39; COMMENT &#39;秒杀活动名称&#39;,</span></span>\n<span class="line"><span>  `sort` int NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;排序&#39;,</span></span>\n<span class="line"><span>  `remark` varchar(1000) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci DEFAULT &#39;&#39; COMMENT &#39;备注&#39;,</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>  `config_ids` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;秒杀时段 id 数组&#39;,</span></span>\n<span class="line"><span>  </span></span>\n<span class="line"><span>  `spu_id` bigint NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;秒杀活动商品&#39;,</span></span>\n<span class="line"><span>  </span></span>\n<span class="line"><span>  `status` tinyint NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;活动状态&#39;,</span></span>\n<span class="line"><span>  </span></span>\n<span class="line"><span>  `total_limit_count` int DEFAULT &#39;0&#39; COMMENT &#39;总限购数量&#39;,  </span></span>\n<span class="line"><span>  `single_limit_count` int DEFAULT &#39;0&#39; COMMENT &#39;单次限够数量&#39;,</span></span>\n<span class="line"><span>  `start_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT &#39;活动开始时间&#39;,</span></span>\n<span class="line"><span>  `end_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT &#39;活动结束时间&#39;,</span></span>\n<span class="line"><span>  </span></span>\n<span class="line"><span>  `stock` int DEFAULT &#39;0&#39; COMMENT &#39;秒杀库存&#39;,</span></span>\n<span class="line"><span>  `total_stock` int DEFAULT &#39;0&#39; COMMENT &#39;秒杀总库存&#39;,  </span></span>\n<span class="line"><span>  </span></span>\n<span class="line"><span>  PRIMARY KEY (`id`) USING BTREE</span></span>\n<span class="line"><span>) ENGINE=InnoDB AUTO_INCREMENT=42 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci COMMENT=&#39;秒杀活动&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>① <code>config_ids</code> 字段：秒杀时段 id 数组，由 <code>promotion_seckill_config</code> 表的 <code>id</code> 字段组成的数组。</p><p>② <code>spu_id</code> 字段：商品 SPU ID，对应商品 SPU 表的 <code>id</code> 字段。</p><p>注意：一个秒杀活动，只能对应一个商品 SPU，不能对应多个商品 SPU！！！</p><p>③ <code>status</code> 字段：活动状态，由 CommonStatusEnum 枚举，只有开启、禁用两个状态。禁用时，无法参与秒杀。</p><p>④ <code>stock</code>、<code>total_stock</code> 字段：秒杀库存、秒杀总库存。业务上考虑秒杀价格可能较低，一般少量库存参与秒杀。</p><hr><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span>CREATE TABLE `promotion_seckill_product` (</span></span>\n<span class="line"><span>  `id` bigint NOT NULL AUTO_INCREMENT COMMENT &#39;秒杀参与商品编号&#39;,</span></span>\n<span class="line"><span>  </span></span>\n<span class="line"><span>  `activity_id` bigint NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;秒杀活动 id&#39;,</span></span>\n<span class="line"><span>  `config_ids` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;秒杀时段 id 数组&#39;,</span></span>\n<span class="line"><span>  `activity_status` tinyint NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;秒杀商品状态&#39;,</span></span>\n<span class="line"><span>  `activity_start_time` datetime NOT NULL COMMENT &#39;活动开始时间点&#39;,</span></span>\n<span class="line"><span>  `activity_end_time` datetime NOT NULL COMMENT &#39;活动结束时间点&#39;,</span></span>\n<span class="line"><span>  `spu_id` bigint NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;商品 spu_id&#39;,</span></span>\n<span class="line"><span>  </span></span>\n<span class="line"><span>  `sku_id` bigint NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;商品 sku_id&#39;,</span></span>\n<span class="line"><span>  </span></span>\n<span class="line"><span>  `seckill_price` int NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;秒杀金额，单位：分&#39;,</span></span>\n<span class="line"><span>  `stock` int NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;秒杀库存&#39;,</span></span>\n<span class="line"><span>  </span></span>\n<span class="line"><span>  PRIMARY KEY (`id`) USING BTREE</span></span>\n<span class="line"><span>) ENGINE=InnoDB AUTO_INCREMENT=81 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci COMMENT=&#39;秒杀参与商品&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>① 【活动信息】<code>activity_id</code> 字段：秒杀活动编号，对应 <code>promotion_seckill_activity</code> 表的 <code>id</code> 字段。其它 <code>activity_*</code> + <code>spu_id</code> 字段，都是冗余字段，方便查询。</p><p>② 【SKU 信息】<code>sku_id</code> 字段：商品 SKU 编号，对应商品 SKU 表的 <code>id</code> 字段。<code>seckill_price</code> 字段：秒杀价格，单位分。<code>stock</code> 字段：秒杀库存。</p><h3 id="_2-2-管理后台" tabindex="-1"><a class="header-anchor" href="#_2-2-管理后台"><span><a href="#_2-2-%E7%AE%A1%E7%90%86%E5%90%8E%E5%8F%B0">#</a> 2.2 管理后台</span></a></h3><p>对应 [商城系统 -&gt; 营销中心 -&gt; 秒杀活动 -&gt; 秒杀商品] 菜单，对应 <code>yudao-ui-admin-vue3</code> 项目的 <code>views/mall/promotion/seckill/activity</code> 目录。如下图所示：</p><figure><img src="https://doc.iocoder.cn/img/商城手册/秒杀活动/秒杀活动-管理后台.png" alt="管理后台" tabindex="0" loading="lazy"><figcaption>管理后台</figcaption></figure><h3 id="_2-3-移动端" tabindex="-1"><a class="header-anchor" href="#_2-3-移动端"><span><a href="#_2-3-%E7%A7%BB%E5%8A%A8%E7%AB%AF">#</a> 2.3 移动端</span></a></h3><p>① 点击 uni-app 首页的 [秒杀] 菜单，进入秒杀列表页，对应 <code>pages/activity/seckill/list.vue</code> 目录。如下图所示：</p><figure><img src="https://doc.iocoder.cn/img/商城手册/秒杀活动/秒杀活动-移动端-列表.png" alt="秒杀列表" tabindex="0" loading="lazy"><figcaption>秒杀列表</figcaption></figure><p>② 点击某个秒杀，进入秒杀详情页，对应 <code>pages/goods/seckill.vue</code> 目录。如下图所示：</p><figure><img src="https://doc.iocoder.cn/img/商城手册/秒杀活动/秒杀活动-移动端-详情.png" alt="秒杀详情" tabindex="0" loading="lazy"><figcaption>秒杀详情</figcaption></figure><p>③ 点击「立即购买」按钮，选择商品后，进入确认订单页，如下图所示：</p><figure><img src="https://doc.iocoder.cn/img/商城手册/秒杀活动/秒杀活动-订单确认页.png" alt="确认订单" tabindex="0" loading="lazy"><figcaption>确认订单</figcaption></figure><p>点击「提交订单」按钮后，会创建一条 <code>trade_order</code> 订单记录：</p><ul><li><code>trade_order</code> 的 <code>type</code> 字段为秒杀类型，<code>seckill_activity_id</code> 字段为秒杀活动编号</li><li>秒杀优惠金额的计算，由 TradeSeckillActivityPriceCalculator 类实现</li><li>秒杀在订单的自定义处理逻辑，由 TradeSeckillOrderHandler 类实现</li></ul><p>后续的逻辑，就是普通订单的流程，就不重复赘述了~</p>',39)]))}const t=a(l,[["render",c],["__file","promotion-seckill.html.vue"]]),o=JSON.parse('{"path":"/project/rouyi-vue-pro/mall/promotion-seckill.html","title":"【营销】秒杀活动","lang":"en-US","frontmatter":{"title":"【营销】秒杀活动","tags":["project","java","spring-boot","spring-cloud"],"categories":["project"],"order":103,"feed":false,"seo":false,"head":[]},"headers":[{"level":2,"title":"# 1. 秒杀配置","slug":"_1-秒杀配置","link":"#_1-秒杀配置","children":[{"level":3,"title":"# 1.1 表结构","slug":"_1-1-表结构","link":"#_1-1-表结构","children":[]},{"level":3,"title":"# 1.2 管理后台","slug":"_1-2-管理后台","link":"#_1-2-管理后台","children":[]}]},{"level":2,"title":"# 2. 秒杀活动","slug":"_2-秒杀活动","link":"#_2-秒杀活动","children":[{"level":3,"title":"# 2.1 表结构","slug":"_2-1-表结构","link":"#_2-1-表结构","children":[]},{"level":3,"title":"# 2.2 管理后台","slug":"_2-2-管理后台","link":"#_2-2-管理后台","children":[]},{"level":3,"title":"# 2.3 移动端","slug":"_2-3-移动端","link":"#_2-3-移动端","children":[]}]}],"git":{"createdTime":1720365235000,"updatedTime":1720365235000,"contributors":[{"name":"Hung Nguyen Van","email":"vanhung4499@gmail.com","commits":1}]},"readingTime":{"minutes":4.91,"words":1474},"filePathRelative":"project/rouyi-vue-pro/mall/promotion-seckill.md","localizedDate":"July 7, 2024"}');export{t as comp,o as data};
