import{_ as s,o as a,c as n,a as t}from"./app-5QVbWi7Z.js";const h={};function l(e,i){return a(),n("div",null,i[0]||(i[0]=[t(`<h1 id="sac-xuat-trong-chien-luoc-xo-so" tabindex="-1"><a class="header-anchor" href="#sac-xuat-trong-chien-luoc-xo-so"><span>Sác xuất trong chiến lược xổ số</span></a></h1><h2 id="i-yeu-cau-cua-chuong-nay" tabindex="-1"><a class="header-anchor" href="#i-yeu-cau-cua-chuong-nay"><span><strong>I. Yêu cầu của chương này</strong></span></a></h2><p>Trong phân hệ rút thăm của nền tảng tiếp thị lớn, cần đáp ứng yêu cầu rằng sau khi người dùng rút thăm N điểm, phạm vi giải thưởng có thể trúng phải được thiết lập. Nói cách khác, nếu bạn đã tiêu tốn tổng cộng 6000 điểm để rút thăm, thì trong lần rút thăm tiếp theo, phạm vi giải thưởng sẽ được xác định trước, không cho phép người dùng nhận được giải thưởng có giá trị thấp hơn. Do đó, khi thiết kế và thực hiện hệ thống, chúng ta cần xử lý việc cài đặt các quy tắc trọng số khác nhau.</p><h2 id="ii-thiet-ke-quy-trinh" tabindex="-1"><a class="header-anchor" href="#ii-thiet-ke-quy-trinh"><span><strong>II. Thiết kế quy trình</strong></span></a></h2><p>Trong quá trình thực hiện, chúng ta cần kết hợp lắp ráp xác suất tổng thể từ phần trước, tiến hành phân tách thành lắp ráp và sử dụng theo nguyên tắc đơn lẻ của giao diện. Sau đó, trong giao diện lắp ráp, tái cấu trúc các thao tác lắp ráp để đáp ứng việc xử lý lắp ráp cho các chiến lược trọng số. — Tại đây, các phương thức được bổ sung vào đối tượng thực thể.</p><figure><img src="https://article-images.zsxq.com/FuevrtGsf5ERuujYm9ncJHMMNoL9" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ol><li>Thu thập và sắp xếp quy trình thiết kế hệ thống, thực hiện xử lý lắp ráp trước cho các quy tắc rút thăm có trọng số sẽ được sử dụng sau này.</li><li>Tất cả dữ liệu lắp ráp sẽ được lưu trữ trong cấu trúc dữ liệu Redis Map. Chiến lược lắp ráp trọng số là sự kết hợp giữa ID chiến lược và giá trị trọng số.</li><li>Khi người dùng thực hiện rút thăm từ nhà máy lắp ráp, họ có thể rút thăm bằng cách sử dụng ID chiến lược hoặc kết hợp giữa ID chiến lược và giá trị trọng số.</li></ol><h2 id="iii-thuc-hien-chuc-nang" tabindex="-1"><a class="header-anchor" href="#iii-thuc-hien-chuc-nang"><span><strong>III. Thực hiện chức năng</strong></span></a></h2><h3 id="_1-cau-truc-du-an" tabindex="-1"><a class="header-anchor" href="#_1-cau-truc-du-an"><span><strong>1. Cấu trúc dự án</strong></span></a></h3><figure><img src="https://article-images.zsxq.com/FmvyNh6Gw67qZTL_Rpl06wQfcAvj" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ol><li>Đầu tiên, tách giao diện lắp ráp thành hai phần: giao diện lắp ráp và giao diện điều phối. Điều này giúp duy trì nguyên tắc đơn lẻ của giao diện và tránh việc phía sử dụng gọi các thao tác lắp ráp. Lắp ráp là thao tác được khởi tạo khi tạo hoặc kiểm tra hoạt động.</li><li>Phần này sẽ bổ sung các chức năng thuộc về thực thể vào đối tượng thực thể, giúp mã nguồn sạch hơn và thể hiện vai trò của đối tượng thực thể.</li></ol><h3 id="_2-thuc-hien-lap-rap" tabindex="-1"><a class="header-anchor" href="#_2-thuc-hien-lap-rap"><span><strong>2. Thực hiện lắp ráp</strong></span></a></h3><p>Lắp ráp từ việc lắp ráp toàn bộ chiến lược ban đầu mở rộng để hỗ trợ lắp ráp trọng số.</p><p><strong>Mã nguồn:</strong> <a href="http://cn.bugstack.domain.strategy.service.armory.StrategyArmoryDispatch" target="_blank" rel="noopener noreferrer">cn.bugstack.domain.strategy.service.armory.StrategyArmoryDispatch</a></p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Override</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> boolean</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> assembleLotteryStrategy</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Long</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> strategyId) {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">    // 1. Truy vấn cấu hình chiến lược</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">    List</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">StrategyAwardEntity</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> strategyAwardEntities </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> repository</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">queryStrategyAwardList</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(strategyId);</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">    assembleLotteryStrategy</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">valueOf</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(strategyId),</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> strategyAwardEntities)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">    // 2. Cấu hình chiến lược trọng số - áp dụng cho cấu hình quy tắc rule_weight</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">    StrategyEntity</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> strategyEntity </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> repository</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">queryStrategyEntityByStrategyId</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(strategyId);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">    String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> ruleWeight </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> strategyEntity</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">getRuleWeight</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">null</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> ruleWeight) </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">return</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">    StrategyRuleEntity</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> strategyRuleEntity </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> repository</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">queryStrategyRule</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(strategyId, ruleWeight);</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">null</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> strategyRuleEntity) {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        throw</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> AppException</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">ResponseCode</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">STRATEGY_RULE_WEIGHT_IS_NULL</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">getCode</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(),</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> ResponseCode</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">STRATEGY_RULE_WEIGHT_IS_NULL</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">getInfo</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">    Map</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> List</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;&gt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> ruleWeightValueMap </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> strategyRuleEntity</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">getRuleWeightValues</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">    Set</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> keys </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> ruleWeightValueMap</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">keySet</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    for</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> key </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">:</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> keys) {</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        List</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> ruleWeightValues </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> ruleWeightValueMap</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(key);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        ArrayList</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">StrategyAwardEntity</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> strategyAwardEntitiesClone </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> ArrayList</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;&gt;</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(strategyAwardEntities)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        strategyAwardEntitiesClone</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">removeIf</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(entity </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">-&gt;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> !</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">ruleWeightValues</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">contains</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">entity</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">getAwardId</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">()));</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">        assembleLotteryStrategy</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">valueOf</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(strategyId).</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">concat</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;_&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">concat</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(key),</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> strategyAwardEntitiesClone)</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://article-images.zsxq.com/FvApq9uRi_T0NAJfXes9F3Vptw_4" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ol><li>Như hình, đối với <strong><a href="https://t.zsxq.com/153HMmsaI" target="_blank" rel="noopener noreferrer">Phần 3: Xử lý lắp ráp xác suất chiến lược</a></strong>, phần này đã tái cấu trúc mã nguồn của StrategyArmoryDispatch#assembleLotteryStrategy để hỗ trợ lắp ráp chiến lược có trọng số.</li><li>Lắp ráp chiến lược có trọng số đọc các giá trị cấu hình trọng số từ bảng cơ sở dữ liệu tương ứng với chiến lược: 4000:102,103,104,105, 5000:102,103,104,105,106,107, 6000:102,103,104,105,106,107,108,109. Tách các cấu hình này thành ba nhóm 4000, 5000, 6000, mỗi nhóm cấu hình chứa ID giải thưởng cần tạo ra giá trị xác suất rút thăm.</li><li>Cuối cùng, người dùng có thể rút thăm bằng cách sử dụng kết hợp ID chiến lược và giá trị trọng số. — Bạn có thể xem chi tiết trong bài kiểm tra đơn vị StrategyTest#test_getRandomAwardId_ruleWeightValue.</li></ol><h3 id="_3-đoi-tuong-thuc-the" tabindex="-1"><a class="header-anchor" href="#_3-đoi-tuong-thuc-the"><span><strong>3. Đối tượng thực thể</strong></span></a></h3><p>Trong quá trình lắp ráp rút thăm có trọng số, cần bổ sung phương thức tương ứng vào đối tượng thực thể, để tập hợp phương thức thuộc về thực thể với đối tượng thực thể, đồng thời tập trung hành vi và logic vào một đối tượng.</p><p><strong>Mã nguồn:</strong> <a href="http://org.apache.commons.lang3.StringUtils.StrategyEntity" target="_blank" rel="noopener noreferrer">org.apache.commons.lang3.StringUtils.StrategyEntity</a></p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> StrategyEntity</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">    /** ID chiến lược rút thăm */</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> Long</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> strategyId</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">    /** Mô tả chiến lược rút thăm */</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> strategyDesc</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">    /** Mô hình quy tắc rút thăm rule_weight, rule_blacklist */</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> ruleModels</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">[] ruleModels</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">StringUtils</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">isBlank</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(ruleModels)) </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">return</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> ruleModels</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">split</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Constants</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">SPLIT</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> getRuleWeight</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[] </span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">ruleModels</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> this</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">ruleModels</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        for</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> ruleModel</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> :</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> ruleModels) {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            if</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;rule_weight&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">equals</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(ruleModel)) </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">return</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> ruleModel;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Mã nguồn:</strong> <a href="http://org.apache.commons.lang3.StringUtils.StrategyRuleEntity" target="_blank" rel="noopener noreferrer">org.apache.commons.lang3.StringUtils.StrategyRuleEntity</a></p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> StrategyRuleEntity</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">    /** ID chiến lược rút thăm */</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> Long</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> strategyId</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">    /** ID giải thưởng rút thăm [nếu loại quy tắc là chiến lược, không cần ID giải thưởng] */</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> Integer</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> awardId</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">    /** Loại quy tắc trừu tượng; 1- Quy tắc chiến lược, 2- Quy tắc giải thưởng */</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> Integer</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> ruleType</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">    /** Loại quy tắc rút thăm [rule_random - Tính toán giá trị ngẫu nhiên, rule_lock - Giải khóa sau vài lần rút thăm, rule_luck_award - Giải thưởng may mắn (giải thưởng dự phòng)] */</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> ruleModel</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">    /** Tỷ lệ quy tắc rút thăm */</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> ruleValue</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">    /** Mô tả quy tắc rút thăm */</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> ruleDesc</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">    /**</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">     * Lấy giá trị trọng số</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">     * Dữ liệu mẫu: 4000:102,103,104,105 5000:102,103,104,105,106,107 6000:102,103,104,105,106,107,108,109</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">     */</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> Map</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> List</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;&gt;</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> getRuleWeightValues</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;rule_weight&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">equals</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(ruleModel)) </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">return</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[] </span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">ruleValueGroups</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> ruleValue</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">split</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Constants</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">SPACE</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">        Map</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">List</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;&gt; </span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">resultMap</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> HashMap</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;&gt;();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        for</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> ruleValueGroup</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> :</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> ruleValueGroups) {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            if</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> (ruleValueGroup </span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> ||</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> ruleValueGroup</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">isEmpty</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">()) {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">                return</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> resultMap;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">            }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[] </span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">parts</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> ruleValueGroup</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">split</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Constants</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">COLON</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            if</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">parts</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">length</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> !=</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">                throw</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> IllegalArgumentException</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&quot;Đầu vào định dạng không hợp lệ cho rule_weight: &quot;</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> ruleValueGroup);</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">            }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            String</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">[] </span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">valueStrings</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> parts[</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">].</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">split</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Constants</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">SPLIT</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            List</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">values</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> ArrayList</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;&gt;();</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">            for</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;"> valueString</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> :</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> valueStrings) {</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">                values</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">add</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">parseInt</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(valueString));</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">            }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">            resultMap</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">put</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(ruleValueGroup, values);</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> resultMap;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Để đơn giản hóa việc gọi hàm, ngoài các phương thức thuộc về thực thể, bạn cũng có thể mở rộng thêm một số chức năng khác. Điều này giúp quy trình trở nên đơn giản hơn.</p><h2 id="iv-kiem-tra-va-xac-nhan" tabindex="-1"><a class="header-anchor" href="#iv-kiem-tra-va-xac-nhan"><span><strong>IV. Kiểm tra và xác nhận</strong></span></a></h2><ol><li>Trước khi kiểm tra, hãy cài đặt môi trường Docker và đảm bảo rằng MySQL và Redis hoạt động bình thường.</li><li>Nếu xảy ra lỗi <strong>java.lang.OutOfMemoryError: GC overhead limit exceeded</strong> trong quá trình lắp ráp 100001, bạn</li></ol><p>có thể thêm tham số vào JVM để khắc phục.</p><p><strong>Kiểm tra đơn vị:</strong> <a href="http://cn.bugstack.middleware.lottery.test.infrastructure.LotteryContextTest" target="_blank" rel="noopener noreferrer">cn.bugstack.middleware.lottery.test.infrastructure.LotteryContextTest</a></p><p><strong>Lưu ý:</strong> Đối với việc phát triển và kiểm tra, có thể sử dụng các công cụ như JUnit hoặc TestNG để thực hiện các kiểm tra đơn vị nhằm xác nhận tính chính xác của chức năng.</p>`,29)]))}const p=s(h,[["render",l],["__file","06-lottery-strategy-rule-weight.html.vue"]]),r=JSON.parse('{"path":"/project/big-market/06-lottery-strategy-rule-weight.html","title":"Raffle Strategy Rule Weight","lang":"en-US","frontmatter":{"title":"Raffle Strategy Rule Weight","tags":["project"],"categories":["project"],"order":8,"description":"Sác xuất trong chiến lược xổ số I. Yêu cầu của chương này Trong phân hệ rút thăm của nền tảng tiếp thị lớn, cần đáp ứng yêu cầu rằng sau khi người dùng rút thăm N điểm, phạm vi ...","head":[["meta",{"property":"og:url","content":"https://vanhung4499.github.io/project/big-market/06-lottery-strategy-rule-weight.html"}],["meta",{"property":"og:site_name","content":"VanHung4499"}],["meta",{"property":"og:title","content":"Raffle Strategy Rule Weight"}],["meta",{"property":"og:description","content":"Sác xuất trong chiến lược xổ số I. Yêu cầu của chương này Trong phân hệ rút thăm của nền tảng tiếp thị lớn, cần đáp ứng yêu cầu rằng sau khi người dùng rút thăm N điểm, phạm vi ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://article-images.zsxq.com/FuevrtGsf5ERuujYm9ncJHMMNoL9"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-10-02T17:20:50.000Z"}],["meta",{"property":"article:author","content":"Hung Nguyen"}],["meta",{"property":"article:tag","content":"project"}],["meta",{"property":"article:modified_time","content":"2024-10-02T17:20:50.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Raffle Strategy Rule Weight\\",\\"image\\":[\\"https://article-images.zsxq.com/FuevrtGsf5ERuujYm9ncJHMMNoL9\\",\\"https://article-images.zsxq.com/FmvyNh6Gw67qZTL_Rpl06wQfcAvj\\",\\"https://article-images.zsxq.com/FvApq9uRi_T0NAJfXes9F3Vptw_4\\"],\\"dateModified\\":\\"2024-10-02T17:20:50.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Hung Nguyen\\",\\"url\\":\\"https://vanhung4499.github.io\\"}]}"]]},"headers":[{"level":2,"title":"I. Yêu cầu của chương này","slug":"i-yeu-cau-cua-chuong-nay","link":"#i-yeu-cau-cua-chuong-nay","children":[]},{"level":2,"title":"II. Thiết kế quy trình","slug":"ii-thiet-ke-quy-trinh","link":"#ii-thiet-ke-quy-trinh","children":[]},{"level":2,"title":"III. Thực hiện chức năng","slug":"iii-thuc-hien-chuc-nang","link":"#iii-thuc-hien-chuc-nang","children":[{"level":3,"title":"1. Cấu trúc dự án","slug":"_1-cau-truc-du-an","link":"#_1-cau-truc-du-an","children":[]},{"level":3,"title":"2. Thực hiện lắp ráp","slug":"_2-thuc-hien-lap-rap","link":"#_2-thuc-hien-lap-rap","children":[]},{"level":3,"title":"3. Đối tượng thực thể","slug":"_3-đoi-tuong-thuc-the","link":"#_3-đoi-tuong-thuc-the","children":[]}]},{"level":2,"title":"IV. Kiểm tra và xác nhận","slug":"iv-kiem-tra-va-xac-nhan","link":"#iv-kiem-tra-va-xac-nhan","children":[]}],"git":{"createdTime":1727889650000,"updatedTime":1727889650000,"contributors":[{"name":"Hung Nguyen Van","email":"vanhung4499@gmail.com","commits":1}]},"readingTime":{"minutes":5.25,"words":1576},"filePathRelative":"project/big-market/06-lottery-strategy-rule-weight.md","localizedDate":"October 2, 2024","excerpt":"\\n<h2><strong>I. Yêu cầu của chương này</strong></h2>\\n<p>Trong phân hệ rút thăm của nền tảng tiếp thị lớn, cần đáp ứng yêu cầu rằng sau khi người dùng rút thăm N điểm, phạm vi giải thưởng có thể trúng phải được thiết lập. Nói cách khác, nếu bạn đã tiêu tốn tổng cộng 6000 điểm để rút thăm, thì trong lần rút thăm tiếp theo, phạm vi giải thưởng sẽ được xác định trước, không cho phép người dùng nhận được giải thưởng có giá trị thấp hơn. Do đó, khi thiết kế và thực hiện hệ thống, chúng ta cần xử lý việc cài đặt các quy tắc trọng số khác nhau.</p>","autoDesc":true}');export{p as comp,r as data};
