import{_ as n,o as t,c as a,d as i}from"./app-BsgpqssW.js";const s={},c=i(`<h1 id="ngan-xep-ngu-canh-thuc-thi" tabindex="-1"><a class="header-anchor" href="#ngan-xep-ngu-canh-thuc-thi"><span>Ngăn xếp ngữ cảnh thực thi</span></a></h1><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/JS%20Excution%20Context%20Lifecycle.excalidraw.png" alt="JS Excution Context Lifecycle.excalidraw" tabindex="0" loading="lazy"><figcaption>JS Excution Context Lifecycle.excalidraw</figcaption></figure><p>Khi chúng ta gọi một hàm (kích hoạt), một ngữ cảnh thực thi mới sẽ được tạo ra.</p><p>Vòng đời của một ngữ cảnh thực thi có thể chia thành hai giai đoạn: <strong>giai đoạn tạo</strong> và <strong>giai đoạn thực thi mã</strong>.</p><p><strong>Giai đoạn khởi tạo</strong>: Trong giai đoạn này, ngữ cảnh thực thi sẽ thực hiện các hoạt động sau đây:</p><ul><li>Tạo đối tượng biến</li><li>Thiết lập chuỗi phạm vi</li><li>Xác định đối tượng <code>this</code> trỏ đến</li></ul><p><strong>Giai đoạn thực thi mã</strong>: Sau khi hoàn thành giai đoạn tạo, mã sẽ được thực thi và hoàn thành các bước sau đây:</p><ul><li>Gán giá trị biến</li><li>Tham chiếu hàm</li><li>Thực thi mã khác</li></ul><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/Excution Context.excalidraw.png" alt="Excution Context.excalidraw" tabindex="0" loading="lazy"><figcaption>Excution Context.excalidraw</figcaption></figure><h2 id="ma-co-the-thuc-thi-excutable-code" tabindex="-1"><a class="header-anchor" href="#ma-co-the-thuc-thi-excutable-code"><span>Mã có thể thực thi (Excutable Code)</span></a></h2><p>Mỗi khi bộ điều khiển chuyển đến mã có thể thực thi, một ngữ cảnh thực thi sẽ được tạo ra.</p><p>Ngữ cảnh thực thi có thể hiểu là môi trường thực thi của mã hiện tại, nó sẽ tạo thành một phạm vi.</p><p>Môi trường chạy JavaScript chủ yếu bao gồm ba trường hợp:</p><ul><li><strong>Môi trường toàn cục</strong>: Mã JavaScript sẽ trước tiên đi vào môi trường này khi chạy</li><li><strong>Môi trường hàm</strong>: Khi hàm được gọi để thực thi, nó sẽ vào môi trường hàm hiện tại để thực thi mã</li><li><strong>eval</strong> (Không khuyến nghị sử dụng, có thể bỏ qua)</li></ul><p>Do đó, trong một chương trình JavaScript, sẽ tạo ra nhiều ngữ cảnh thực thi và Trình thông dịch JavaScript sẽ xử lý chúng theo cách của một ngăn xếp, ngăn xếp này được gọi là <strong>ngăn xếp gọi hàm (Call Stack)</strong>. Đáy ngăn xếp luôn là ngữ cảnh toàn cục và đỉnh ngăn xếp là ngữ cảnh đang thực thi hiện tại.</p><p>Khi mã đang thực thi, gặp ba trường hợp trên, sẽ tạo ra một ngữ cảnh thực thi và đẩy vào ngăn xếp, và khi ngữ cảnh đang ở đỉnh ngăn xếp hoàn thành, nó sẽ tự động bị đẩy ra khỏi ngăn xếp.</p><h2 id="phan-tich-cai-đat-ngan-xep-va-heap" tabindex="-1"><a class="header-anchor" href="#phan-tich-cai-đat-ngan-xep-va-heap"><span>Phân tích cài đặt ngăn xếp và heap</span></a></h2><p>Trình thông dịch JavaScript sử dụng <strong>ngăn xếp ngữ cảnh thực thi (Execution Context Stack, ECS)</strong> để quản lý các ngữ cảnh thực thi.</p><p>🎯 Để mô phỏng hành vi của ngăn xếp ngữ cảnh thực thi, hãy tưởng tượng rằng nó là một mảng.</p><div class="language-js" data-ext="js" data-title="js"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">ECStack</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [];</span></span></code></pre></div><p>Khi JavaScript bắt đầu thực thi mã, điều đầu tiên gặp phải là mã toàn cục, vì vậy khi khởi tạo, một ngữ cảnh thực thi toàn cục sẽ được đẩy vào ngăn xếp ngữ cảnh thực thi, chúng ta sử dụng <code>globalContext</code> để đại diện cho nó, và chỉ khi toàn bộ ứng dụng kết thúc, ECStack mới được xóa, vì vậy <strong>trước khi chương trình kết thúc</strong>, ECStack luôn có một <code>globalContext</code> ở đáy.</p><div class="language-js" data-ext="js" data-title="js"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">ECStack</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [</span><span style="color:#E06C75;--shiki-dark:#E06C75;">globalContext</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">];</span></span></code></pre></div><p>Bây giờ JavaScript gặp mã dưới đây:</p><div class="language-js" data-ext="js" data-title="js"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">function</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> fun3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">  console</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">log</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;fun3&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">function</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> fun2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">  fun3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">function</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> fun1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">  fun2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">fun1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span></code></pre></div><p>Khi thực thi một hàm, một ngữ cảnh thực thi sẽ được tạo ra và đẩy vào ngăn xếp ngữ cảnh thực thi, khi hàm thực thi xong, ngữ cảnh thực thi của hàm đó sẽ được loại bỏ khỏi ngăn xếp.</p><p>Sau khi hiểu được quá trình này, chúng ta hãy xem cách xử lý mã trên:</p><div class="language-js line-numbers-mode" data-ext="js" data-title="js"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">// fun1()</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">ECStack</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">push</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(&lt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">fun1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; functionContext);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">// fun1 gọi fun2, nên cần tạo ngữ cảnh thực thi cho fun2</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">ECStack.push(&lt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">fun2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; functionContext);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">// Wow, fun2 còn gọi fun3 nữa!</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">ECStack.push(&lt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">fun3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; functionContext);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">// fun3 thực thi xong</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">ECStack.pop();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">// fun2 thực thi xong</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">ECStack.pop();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">// fun1 thực thi xong</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">ECStack.pop();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">// JavaScript tiếp tục thực thi mã dưới đây, nhưng ECStack luôn có một globalContext ở đáy</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Sau khi hiểu rõ quá trình này, chúng ta có thể rút ra một số kết luận về <strong>ngăn xếp ngữ cảnh thực thi</strong>.</p><ul><li>Trình thông dịch JavaScript là đơn luồng</li><li>Thực thi đồng bộ, chỉ có ngữ cảnh thực thi đang ở đỉnh ngăn xếp mới được thực thi, các ngữ cảnh khác phải chờ đợi</li><li>Chỉ có một ngữ cảnh thực thi toàn cục, nó được loại bỏ khỏi ngăn xếp khi trình thông dịch kết thúc</li><li>Số lượng ngữ cảnh thực thi của hàm không có giới hạn</li><li>Mỗi lần gọi một hàm, một ngữ cảnh thực thi mới được tạo ra cho nó, ngay cả khi gọi đệ quy cũng vậy</li></ul>`,29),e=[c];function h(o,l){return t(),a("div",null,e)}const r=n(s,[["render",h],["__file","excution-context-stack.html.vue"]]),g=JSON.parse('{"path":"/programming/js/core/excute-and-contexts/excution/excution-context-stack.html","title":"Excution Context Stack","lang":"en-US","frontmatter":{"title":"Excution Context Stack","tags":["js","programming"],"categories":["js","programming"],"date created":"2023-08-01T00:00:00.000Z","date modified":"2023-08-01T00:00:00.000Z","order":1,"description":"Ngăn xếp ngữ cảnh thực thi JS Excution Context Lifecycle.excalidrawJS Excution Context Lifecycle.excalidraw Khi chúng ta gọi một hàm (kích hoạt), một ngữ cảnh thực thi mới sẽ đư...","head":[["meta",{"property":"og:url","content":"https://vanhung4499.github.io/programming/js/core/excute-and-contexts/excution/excution-context-stack.html"}],["meta",{"property":"og:site_name","content":"VanHung4499"}],["meta",{"property":"og:title","content":"Excution Context Stack"}],["meta",{"property":"og:description","content":"Ngăn xếp ngữ cảnh thực thi JS Excution Context Lifecycle.excalidrawJS Excution Context Lifecycle.excalidraw Khi chúng ta gọi một hàm (kích hoạt), một ngữ cảnh thực thi mới sẽ đư..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://raw.githubusercontent.com/vanhung4499/images/master/snap/JS%2520Excution%2520Context%2520Lifecycle.excalidraw.png"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-06-28T15:54:38.000Z"}],["meta",{"property":"article:author","content":"Hung Nguyen"}],["meta",{"property":"article:tag","content":"js"}],["meta",{"property":"article:tag","content":"programming"}],["meta",{"property":"article:modified_time","content":"2024-06-28T15:54:38.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Excution Context Stack\\",\\"image\\":[\\"https://raw.githubusercontent.com/vanhung4499/images/master/snap/JS%2520Excution%2520Context%2520Lifecycle.excalidraw.png\\",\\"https://raw.githubusercontent.com/vanhung4499/images/master/snap/Excution%20Context.excalidraw.png\\"],\\"dateModified\\":\\"2024-06-28T15:54:38.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Hung Nguyen\\",\\"url\\":\\"https://vanhung4499.github.io\\"}]}"]]},"headers":[{"level":2,"title":"Mã có thể thực thi (Excutable Code)","slug":"ma-co-the-thuc-thi-excutable-code","link":"#ma-co-the-thuc-thi-excutable-code","children":[]},{"level":2,"title":"Phân tích cài đặt ngăn xếp và heap","slug":"phan-tich-cai-đat-ngan-xep-va-heap","link":"#phan-tich-cai-đat-ngan-xep-va-heap","children":[]}],"git":{"createdTime":1719590078000,"updatedTime":1719590078000,"contributors":[{"name":"Hung Nguyen Van","email":"vanhung4499@gmail.com","commits":1}]},"readingTime":{"minutes":3.46,"words":1039},"filePathRelative":"programming/js/core/excute-and-contexts/excution/excution-context-stack.md","localizedDate":"June 28, 2024","excerpt":"\\n<figure><img src=\\"https://raw.githubusercontent.com/vanhung4499/images/master/snap/JS%20Excution%20Context%20Lifecycle.excalidraw.png\\" alt=\\"JS Excution Context Lifecycle.excalidraw\\" tabindex=\\"0\\" loading=\\"lazy\\"><figcaption>JS Excution Context Lifecycle.excalidraw</figcaption></figure>\\n<p>Khi chúng ta gọi một hàm (kích hoạt), một ngữ cảnh thực thi mới sẽ được tạo ra.</p>","autoDesc":true}');export{r as comp,g as data};
