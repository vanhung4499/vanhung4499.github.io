import{_ as s,o as a,c as n,d as i}from"./app-BVzepGwQ.js";const r={},o=i(`<h1 id="jvm-thuc-hanh" tabindex="-1"><a class="header-anchor" href="#jvm-thuc-hanh"><span>JVM Th·ª±c h√†nh</span></a></h1><h2 id="tong-quan-ve-tinh-chinh-jvm" tabindex="-1"><a class="header-anchor" href="#tong-quan-ve-tinh-chinh-jvm"><span>T·ªïng quan v·ªÅ Tinh ch·ªânh JVM</span></a></h2><h3 id="cac-chi-so-hieu-suat-gc" tabindex="-1"><a class="header-anchor" href="#cac-chi-so-hieu-suat-gc"><span>C√°c ch·ªâ s·ªë hi·ªáu su·∫•t GC</span></a></h3><p>Trong qu√° tr√¨nh tinh ch·ªânh JVM, c·∫ßn x√°c ƒë·ªãnh m·ª•c ti√™u tinh ch·ªânh tr∆∞·ªõc. T·ª´ g√≥c ƒë·ªô hi·ªáu su·∫•t, th∆∞·ªùng quan t√¢m ƒë·∫øn ba ch·ªâ s·ªë sau:</p><ul><li><code>Th√¥ng l∆∞·ª£ng (throughput)</code> - ƒê√¢y l√† ch·ªâ s·ªë hi·ªáu su·∫•t cao nh·∫•t m√† b·ªô thu gom r√°c c√≥ th·ªÉ h·ªó tr·ª£ cho ·ª©ng d·ª•ng m√† kh√¥ng t√≠nh ƒë·∫øn th·ªùi gian t·∫°m d·ª´ng ho·∫∑c ti√™u th·ª• b·ªô nh·ªõ.</li><li><code>Th·ªùi gian t·∫°m d·ª´ng (latency)</code> - ƒê√¢y l√† th∆∞·ªõc ƒëo ƒë·ªÉ r√∫t ng·∫Øn th·ªùi gian t·∫°m d·ª´ng do thu gom r√°c g√¢y ra ho·∫∑c lo·∫°i b·ªè ho√†n to√†n th·ªùi gian t·∫°m d·ª´ng do thu gom r√°c, t·ª´ ƒë√≥ tr√°nh rung l·∫Øc khi ·ª©ng d·ª•ng ƒëang ch·∫°y.</li><li><code>T·∫ßn su·∫•t thu gom r√°c</code> - Bao l√¢u m·ªôt l·∫ßn thu gom r√°c x·∫£y ra? Th∆∞·ªùng th√¨ t·∫ßn su·∫•t thu gom r√°c c√†ng th·∫•p c√†ng t·ªët, tuy nhi√™n, tƒÉng k√≠ch th∆∞·ªõc b·ªô nh·ªõ heap c√≥ th·ªÉ gi·∫£m t·∫ßn su·∫•t thu gom r√°c nh∆∞ng ƒë·ªìng th·ªùi c≈©ng tƒÉng s·ªë l∆∞·ª£ng ƒë·ªëi t∆∞·ª£ng c·∫ßn thu gom, d·∫´n ƒë·∫øn tƒÉng th·ªùi gian t·∫°m d·ª´ng. Do ƒë√≥, ch·ªâ c·∫ßn tƒÉng k√≠ch th∆∞·ªõc b·ªô nh·ªõ heap m·ªôt c√°ch ph√π h·ª£p ƒë·ªÉ ƒë·∫£m b·∫£o t·∫ßn su·∫•t thu gom r√°c b√¨nh th∆∞·ªùng l√† ƒë·ªß.</li></ul><p>Trong h·∫ßu h·∫øt c√°c tr∆∞·ªùng h·ª£p, tinh ch·ªânh s·∫Ω t·∫≠p trung v√†o m·ªôt ho·∫∑c hai m·ª•c ti√™u, hi·∫øm khi c√≥ th·ªÉ ƒë·∫°t ƒë∆∞·ª£c c·∫£ ba m·ª•c ti√™u t·ª´ c√°c g√≥c nh√¨n kh√°c nhau.</p><h3 id="nguyen-tac-tinh-chinh" tabindex="-1"><a class="header-anchor" href="#nguyen-tac-tinh-chinh"><span>Nguy√™n t·∫Øc tinh ch·ªânh</span></a></h3><p>C√≥ hai m·ª•c ti√™u t·ªëi ∆∞u h√≥a GC:</p><ul><li><strong>Gi·∫£m t·∫ßn su·∫•t Full GC</strong></li><li><strong>Gi·∫£m th·ªùi gian th·ª±c hi·ªán Full GC</strong></li></ul><p>Nguy√™n t·∫Øc c∆° b·∫£n c·ªßa tinh ch·ªânh GC l√†: √°p d·ª•ng c√°c tham s·ªë GC kh√°c nhau cho hai m√°y ch·ªß tr·ªü l√™n, sau ƒë√≥ so s√°nh hi·ªáu su·∫•t c·ªßa ch√∫ng v√† √°p d·ª•ng c√°c tham s·ªë ƒë√£ ƒë∆∞·ª£c ch·ª©ng minh c√≥ th·ªÉ c·∫£i thi·ªán hi·ªáu su·∫•t ho·∫∑c gi·∫£m th·ªùi gian th·ª±c hi·ªán GC cho m√°y ch·ªß l√†m vi·ªác cu·ªëi c√πng.</p><h4 id="giam-tan-suat-minor-gc" tabindex="-1"><a class="header-anchor" href="#giam-tan-suat-minor-gc"><span>Gi·∫£m t·∫ßn su·∫•t Minor GC</span></a></h4><p>N·∫øu kh√¥ng gian th·∫ø h·ªá tr·∫ª nh·ªè, khu v·ª±c Eden nhanh ch√≥ng b·ªã l·∫•p ƒë·∫ßy, d·∫´n ƒë·∫øn t·∫ßn su·∫•t Minor GC th∆∞·ªùng xuy√™n. Do ƒë√≥, b·∫°n c√≥ th·ªÉ gi·∫£m t·∫ßn su·∫•t Minor GC b·∫±ng c√°ch tƒÉng k√≠ch th∆∞·ªõc kh√¥ng gian th·∫ø h·ªá tr·∫ª.</p><p>C√≥ th·ªÉ b·∫°n s·∫Ω c√≥ c√¢u h·ªèi: N·∫øu m·ªü r·ªông khu v·ª±c Eden, li·ªáu th·ªùi gian m·ªôt l·∫ßn Minor GC c√≥ tƒÉng l√™n kh√¥ng? N·∫øu th·ªùi gian m·ªôt l·∫ßn Minor GC tƒÉng l√™n, th√¨ kh√≥ c√≥ th·ªÉ ƒë·∫°t ƒë∆∞·ª£c hi·ªáu qu·∫£ t·ªëi ∆∞u m√† ch√∫ng ta mong ƒë·ª£i.</p><p>Ch√∫ng ta bi·∫øt r·∫±ng th·ªùi gian m·ªôt l·∫ßn Minor GC bao g·ªìm hai ph·∫ßn: T1 (qu√©t th·∫ø h·ªá tr·∫ª) v√† T2 (sao ch√©p c√°c ƒë·ªëi t∆∞·ª£ng s·ªëng). Gi·∫£ s·ª≠ m·ªôt ƒë·ªëi t∆∞·ª£ng s·ªëng trong khu v·ª±c Eden trong 500ms v√† th·ªùi gian gi·ªØa c√°c l·∫ßn Minor GC l√† 300ms, th√¨ th·ªùi gian m·ªôt l·∫ßn Minor GC l√†: T1 + T2.</p><p>Khi ch√∫ng ta m·ªü r·ªông kh√¥ng gian th·∫ø h·ªá tr·∫ª, th·ªùi gian gi·ªØa c√°c l·∫ßn Minor GC c√≥ th·ªÉ m·ªü r·ªông l√™n 600ms, ƒëi·ªÅu n√†y c√≥ nghƒ©a l√† m·ªôt ƒë·ªëi t∆∞·ª£ng s·ªëng trong 500ms s·∫Ω b·ªã thu gom trong khu v·ª±c Eden, kh√¥ng c√≤n ƒë·ªëi t∆∞·ª£ng s·ªëng ƒë·ªÉ sao ch√©p, do ƒë√≥ th·ªùi gian cho l·∫ßn Minor GC ti·∫øp theo l√†: hai l·∫ßn qu√©t th·∫ø h·ªá tr·∫ª, t·ª©c l√† 2T1.</p><p>Nh∆∞ v·∫≠y, vi·ªác m·ªü r·ªông kh√¥ng gian th·∫ø h·ªá tr·∫ª s·∫Ω tƒÉng th·ªùi gian T1, nh∆∞ng gi·∫£m th·ªùi gian T2. Th√¥ng th∆∞·ªùng, trong m√°y ·∫£o Java, chi ph√≠ sao ch√©p ƒë·ªëi t∆∞·ª£ng cao h∆°n chi ph√≠ qu√©t.</p><p>N·∫øu c√≥ nhi·ªÅu ƒë·ªëi t∆∞·ª£ng s·ªëng ng·∫Øn h·∫°n trong b·ªô nh·ªõ heap, vi·ªác m·ªü r·ªông kh√¥ng gian th·∫ø h·ªá tr·∫ª s·∫Ω kh√¥ng l√†m tƒÉng ƒë√°ng k·ªÉ th·ªùi gian m·ªôt l·∫ßn Minor GC. Do ƒë√≥, th·ªùi gian m·ªôt l·∫ßn Minor GC ph·ª• thu·ªôc nhi·ªÅu v√†o s·ªë l∆∞·ª£ng ƒë·ªëi t∆∞·ª£ng s·ªëng sau GC, ch·ª© kh√¥ng ph·∫£i k√≠ch th∆∞·ªõc c·ªßa khu v·ª±c Eden.</p><h4 id="giam-tan-suat-full-gc" tabindex="-1"><a class="header-anchor" href="#giam-tan-suat-full-gc"><span>Gi·∫£m t·∫ßn su·∫•t Full GC</span></a></h4><p>So v·ªõi Minor GC, Full GC t·ªën nhi·ªÅu th·ªùi gian h∆°n. Gi·∫£m s·ªë l∆∞·ª£ng ƒë·ªëi t∆∞·ª£ng v√†o th·∫ø h·ªá gi√† c√≥ th·ªÉ gi·∫£m ƒë√°ng k·ªÉ t·∫ßn su·∫•t Full GC.</p><p><strong>Gi·∫£m s·ªë l∆∞·ª£ng ƒë·ªëi t∆∞·ª£ng l·ªõn:</strong> N·∫øu m·ªôt ƒë·ªëi t∆∞·ª£ng chi·∫øm nhi·ªÅu b·ªô nh·ªõ, sau khi ƒë∆∞·ª£c t·∫°o trong khu v·ª±c Eden, n√≥ s·∫Ω ƒë∆∞·ª£c chuy·ªÉn tr·ª±c ti·∫øp v√†o th·∫ø h·ªá gi√†. Trong c√°c k·ªãch b·∫£n kinh doanh th√¥ng th∆∞·ªùng, ch√∫ng ta th∆∞·ªùng l·∫•y m·ªôt ƒë·ªëi t∆∞·ª£ng l·ªõn t·ª´ c∆° s·ªü d·ªØ li·ªáu ƒë·ªÉ hi·ªÉn th·ªã tr√™n giao di·ªán web. V√≠ d·ª•, t√¥i ƒë√£ g·∫∑p m·ªôt tr∆∞·ªùng h·ª£p n∆°i m·ªôt ho·∫°t ƒë·ªông kinh doanh truy v·∫•n c√πng l√∫c 60 tr∆∞·ªùng d·ªØ li·ªáu, ƒë·ªëi t∆∞·ª£ng l·ªõn nh∆∞ v·∫≠y n·∫øu v∆∞·ª£t qu√° ng∆∞·ª°ng ƒë·ªëi t∆∞·ª£ng l·ªõn t·ªëi ƒëa c·ªßa th·∫ø h·ªá tr·∫ª, s·∫Ω ƒë∆∞·ª£c t·∫°o tr·ª±c ti·∫øp trong th·∫ø h·ªá gi√†; ngay c·∫£ khi n√≥ ƒë∆∞·ª£c t·∫°o trong th·∫ø h·ªá tr·∫ª, do kh√¥ng gian th·∫ø h·ªá tr·∫ª c√≥ gi·ªõi h·∫°n, sau khi tr·∫£i qua Minor GC, n√≥ c≈©ng s·∫Ω ƒë∆∞·ª£c chuy·ªÉn v√†o th·∫ø h·ªá gi√†. ƒêi·ªÅu n√†y d·ªÖ d·∫´n ƒë·∫øn t√¨nh tr·∫°ng Full GC nhi·ªÅu.</p><p>Ch√∫ng ta c√≥ th·ªÉ t√°ch ƒë·ªëi t∆∞·ª£ng l·ªõn n√†y ra, ch·ªâ truy v·∫•n c√°c tr∆∞·ªùng quan tr·ªçng ban ƒë·∫ßu, n·∫øu c·∫ßn xem c√°c tr∆∞·ªùng kh√°c ƒë·ªÉ h·ªó tr·ª£, th·ª±c hi·ªán truy v·∫•n th·ª© hai ƒë·ªÉ hi·ªÉn th·ªã c√°c tr∆∞·ªùng c√≤n l·∫°i.</p><p><strong>M·ªü r·ªông kh√¥ng gian heap:</strong> Trong tr∆∞·ªùng h·ª£p kh√¥ng ƒë·ªß b·ªô nh·ªõ heap, vi·ªác m·ªü r·ªông kh√¥ng gian heap v√† ƒë·∫∑t k√≠ch th∆∞·ªõc heap kh·ªüi t·∫°o l√† k√≠ch th∆∞·ªõc heap t·ªëi ƒëa c≈©ng c√≥ th·ªÉ gi·∫£m t·∫ßn su·∫•t Full GC.</p><h4 id="giam-thoi-gian-thuc-hien-full-gc" tabindex="-1"><a class="header-anchor" href="#giam-thoi-gian-thuc-hien-full-gc"><span>Gi·∫£m th·ªùi gian th·ª±c hi·ªán Full GC</span></a></h4><p>Th·ªùi gian th·ª±c hi·ªán Full GC d√†i h∆°n nhi·ªÅu so v·ªõi Minor GC. Do ƒë√≥, n·∫øu th·ªùi gian th·ª±c hi·ªán Full GC qu√° l√¢u (h∆°n 1 gi√¢y), c√≥ th·ªÉ g√¢y ra l·ªói v∆∞·ª£t qu√° th·ªùi gian ch·ªù.</p><ul><li>N·∫øu <strong>gi·∫£m k√≠ch th∆∞·ªõc th·∫ø h·ªá gi√† ƒë·ªÉ gi·∫£m th·ªùi gian th·ª±c hi·ªán Full GC</strong>, c√≥ th·ªÉ g√¢y ra l·ªói <code>OutOfMemoryError</code> ho·∫∑c l√†m tƒÉng t·∫ßn su·∫•t Full GC.</li><li>Ngo√†i ra, n·∫øu <strong>tƒÉng k√≠ch th∆∞·ªõc th·∫ø h·ªá gi√† ƒë·ªÉ gi·∫£m t·∫ßn su·∫•t Full GC</strong>, th·ªùi gian th·ª±c hi·ªán Full GC c√≥ th·ªÉ tƒÉng.</li></ul><p>Do ƒë√≥, b·∫°n c·∫ßn ƒë·∫∑t k√≠ch th∆∞·ªõc th·∫ø h·ªá gi√† th√†nh m·ªôt gi√° tr·ªã &quot;ph√π h·ª£p&quot;.</p><p><strong>C√°c tham s·ªë JVM c·∫ßn xem x√©t trong tinh ch·ªânh GC</strong></p><table><thead><tr><th><strong>Lo·∫°i</strong></th><th><strong>Tham s·ªë</strong></th><th><strong>M√¥ t·∫£</strong></th></tr></thead><tbody><tr><td>K√≠ch th∆∞·ªõc heap</td><td><code>-Xms</code></td><td>K√≠ch th∆∞·ªõc heap khi kh·ªüi ƒë·ªông</td></tr><tr><td></td><td><code>-Xmx</code></td><td>Gi·ªõi h·∫°n k√≠ch th∆∞·ªõc heap</td></tr><tr><td>K√≠ch th∆∞·ªõc th·∫ø h·ªá tr·∫ª</td><td><code>-XX:NewRatio</code></td><td>T·ª∑ l·ªá k√≠ch th∆∞·ªõc th·∫ø h·ªá tr·∫ª v√† th·∫ø h·ªá gi√†</td></tr><tr><td></td><td><code>-XX:NewSize</code></td><td>K√≠ch th∆∞·ªõc th·∫ø h·ªá tr·∫ª</td></tr><tr><td></td><td><code>-XX:SurvivorRatio</code></td><td>T·ª∑ l·ªá k√≠ch th∆∞·ªõc Eden v√† Survivor</td></tr></tbody></table><p>C√°c tham s·ªë ph·ªï bi·∫øn nh·∫•t trong tinh ch·ªânh GC l√† <code>-Xms</code>, <code>-Xmx</code> v√† <code>-XX:NewRatio</code>. Th√¥ng th∆∞·ªùng, <code>-Xms</code> v√† <code>-Xmx</code> l√† b·∫Øt bu·ªôc, v√¨ v·∫≠y gi√° tr·ªã c·ªßa <code>NewRatio</code> s·∫Ω ·∫£nh h∆∞·ªüng ƒë√°ng k·ªÉ ƒë·∫øn hi·ªáu su·∫•t GC.</p><p>C√≥ th·ªÉ b·∫°n s·∫Ω h·ªèi <strong>l√†m th·∫ø n√†o ƒë·ªÉ ƒë·∫∑t k√≠ch th∆∞·ªõc c·ªßa Permanent Generation</strong>. B·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng c√°c tham s·ªë <code>-XX:PermSize</code> v√† <code>-XX:MaxPermSize</code> ƒë·ªÉ ƒë·∫∑t k√≠ch th∆∞·ªõc c·ªßa Permanent Generation, nh∆∞ng h√£y nh·ªõ ch·ªâ ƒë·∫∑t k√≠ch th∆∞·ªõc Permanent Generation khi g·∫∑p l·ªói <code>OutOfMemoryError</code>.</p><h3 id="qua-trinh-tinh-chinh-gc" tabindex="-1"><a class="header-anchor" href="#qua-trinh-tinh-chinh-gc"><span>Qu√° tr√¨nh tinh ch·ªânh GC</span></a></h3><p>Qu√° tr√¨nh tinh ch·ªânh GC c√≥ th·ªÉ ƒë∆∞·ª£c chia th√†nh c√°c b∆∞·ªõc sau:</p><h4 id="_1-giam-sat-trang-thai-gc" tabindex="-1"><a class="header-anchor" href="#_1-giam-sat-trang-thai-gc"><span>(1) Gi√°m s√°t tr·∫°ng th√°i GC</span></a></h4><p>B·∫°n c·∫ßn gi√°m s√°t tr·∫°ng th√°i GC ƒë·ªÉ ki·ªÉm tra c√°c tr·∫°ng th√°i GC ƒëang ch·∫°y trong h·ªá th·ªëng.</p><h4 id="_2-phan-tich-nhat-ky-gc" tabindex="-1"><a class="header-anchor" href="#_2-phan-tich-nhat-ky-gc"><span>(2) Ph√¢n t√≠ch nh·∫≠t k√Ω GC</span></a></h4><p>Sau khi ki·ªÉm tra tr·∫°ng th√°i GC, b·∫°n c·∫ßn ph√¢n t√≠ch d·ªØ li·ªáu gi√°m s√°t v√† quy·∫øt ƒë·ªãnh xem c√≥ c·∫ßn tinh ch·ªânh GC hay kh√¥ng. N·∫øu k·∫øt qu·∫£ ph√¢n t√≠ch cho th·∫•y th·ªùi gian ch·∫°y GC ch·ªâ t·ª´ 0,1 ƒë·∫øn 0,3 gi√¢y, th√¨ kh√¥ng c·∫ßn t·ªën th·ªùi gian tinh ch·ªânh GC, nh∆∞ng n·∫øu th·ªùi gian ch·∫°y GC l√† t·ª´ 1 ƒë·∫øn 3 gi√¢y, th·∫≠m ch√≠ l·ªõn h∆°n 10 gi√¢y, th√¨ tinh ch·ªânh GC l√† c·∫ßn thi·∫øt.</p><p>Tuy nhi√™n, n·∫øu b·∫°n ƒë√£ c·∫•p ph√°t kho·∫£ng 10GB b·ªô nh·ªõ cho Java v√† kh√¥ng th·ªÉ ti·∫øt ki·ªám b·ªô nh·ªõ n√†y, th√¨ b·∫°n kh√¥ng th·ªÉ tinh ch·ªânh GC. Tr∆∞·ªõc khi tinh ch·ªânh GC, b·∫°n c·∫ßn xem x√©t l√Ω do t·∫°i sao b·∫°n c·∫ßn c·∫•p ph√°t nhi·ªÅu b·ªô nh·ªõ n√†y. N·∫øu b·∫°n c·∫•p ph√°t 1GB ho·∫∑c 2GB b·ªô nh·ªõ v√† g·∫∑p l·ªói <code>OutOfMemoryError</code>, th√¨ b·∫°n n√™n th·ª±c hi·ªán <strong>b·ªô nh·ªõ heap (heap dump)</strong> ƒë·ªÉ x√°c ƒë·ªãnh nguy√™n nh√¢n g√¢y ra l·ªói.</p><blockquote><p>üîî L∆∞u √Ω:</p></blockquote><blockquote><p><strong>B·ªô nh·ªõ heap (heap dump)</strong> l√† m·ªôt t·ªáp d√πng ƒë·ªÉ ki·ªÉm tra c√°c ƒë·ªëi t∆∞·ª£ng v√† d·ªØ li·ªáu trong b·ªô nh·ªõ Java. T·ªáp n√†y c√≥ th·ªÉ ƒë∆∞·ª£c t·∫°o b·∫±ng c√°ch ch·∫°y l·ªánh <code>jmap</code> trong JDK. Trong qu√° tr√¨nh t·∫°o t·ªáp, t·∫•t c·∫£ c√°c ch∆∞∆°ng tr√¨nh Java s·∫Ω t·∫°m d·ª´ng, v√¨ v·∫≠y kh√¥ng n√™n t·∫°o t·ªáp trong qu√° tr√¨nh ch·∫°y c·ªßa h·ªá th·ªëng.</p></blockquote><blockquote><p>B·∫°n c√≥ th·ªÉ t√¨m hi·ªÉu chi ti·∫øt v·ªÅ b·ªô nh·ªõ heap tr√™n Internet.</p></blockquote><h4 id="_3-chon-bo-thu-gom-rac-phu-hop" tabindex="-1"><a class="header-anchor" href="#_3-chon-bo-thu-gom-rac-phu-hop"><span>(3) Ch·ªçn b·ªô thu gom r√°c ph√π h·ª£p</span></a></h4><p>N·∫øu quy·∫øt ƒë·ªãnh tinh ch·ªânh GC, b·∫°n c·∫ßn ch·ªçn m·ªôt b·ªô thu gom r√°c v√† ƒë·∫∑t c√°c tham s·ªë JVM ph√π h·ª£p cho n√≥. N·∫øu b·∫°n c√≥ nhi·ªÅu m√°y ch·ªß, h√£y ƒë·∫∑t c√°c tham s·ªë GC kh√°c nhau tr√™n m·ªói m√°y ch·ªß v√† so s√°nh hi·ªáu su·∫•t c·ªßa ch√∫ng.</p><h4 id="_4-phan-tich-ket-qua" tabindex="-1"><a class="header-anchor" href="#_4-phan-tich-ket-qua"><span>(4) Ph√¢n t√≠ch k·∫øt qu·∫£</span></a></h4><p>Sau khi ƒë·∫∑t c√°c tham s·ªë GC, b·∫°n c√≥ th·ªÉ b·∫Øt ƒë·∫ßu thu th·∫≠p d·ªØ li·ªáu v√† ph√¢n t√≠ch k·∫øt qu·∫£. H√£y ph√¢n t√≠ch √≠t nh·∫•t 24 gi·ªù d·ªØ li·ªáu tr∆∞·ªõc khi ti·∫øn h√†nh ph√¢n t√≠ch k·∫øt qu·∫£. N·∫øu b·∫°n may m·∫Øn ƒë·ªß, b·∫°n c√≥ th·ªÉ t√¨m th·∫•y c√°c tham s·ªë GC t·ªët nh·∫•t cho h·ªá th·ªëng c·ªßa m√¨nh. N·∫øu kh√¥ng, b·∫°n c·∫ßn ph√¢n t√≠ch c√°c nh·∫≠t k√Ω ƒë·∫ßu ra v√† ki·ªÉm tra vi·ªác ph√¢n b·ªï b·ªô nh·ªõ, sau ƒë√≥ ƒëi·ªÅu ch·ªânh lo·∫°i GC/k√≠ch th∆∞·ªõc b·ªô nh·ªõ ƒë·ªÉ t√¨m ra c√°c tham s·ªë t·ªët nh·∫•t cho h·ªá th·ªëng c·ªßa b·∫°n.</p><h4 id="_5-ap-dung-cau-hinh-toi-uu" tabindex="-1"><a class="header-anchor" href="#_5-ap-dung-cau-hinh-toi-uu"><span>(5) √Åp d·ª•ng c·∫•u h√¨nh t·ªëi ∆∞u</span></a></h4><p>N·∫øu k·∫øt qu·∫£ tinh ch·ªânh GC l√†m b·∫°n h√†i l√≤ng, b·∫°n c√≥ th·ªÉ √°p d·ª•ng c√°c tham s·ªë cho t·∫•t c·∫£ c√°c m√°y ch·ªß v√† k·∫øt th√∫c qu√° tr√¨nh tinh ch·ªânh GC.</p><p>Trong c√°c ph·∫ßn ti·∫øp theo, b·∫°n s·∫Ω th·∫•y c√°c c√¥ng vi·ªác c·ª• th·ªÉ ƒë∆∞·ª£c th·ª±c hi·ªán trong t·ª´ng b∆∞·ªõc tr√™n.</p><h2 id="nhat-ky-gc" tabindex="-1"><a class="header-anchor" href="#nhat-ky-gc"><span>Nh·∫≠t k√Ω GC</span></a></h2><h3 id="lay-nhat-ky-gc" tabindex="-1"><a class="header-anchor" href="#lay-nhat-ky-gc"><span>L·∫•y nh·∫≠t k√Ω GC</span></a></h3><p>C√≥ hai c√°ch ƒë·ªÉ l·∫•y nh·∫≠t k√Ω GC:</p><ul><li>S·ª≠ d·ª•ng l·ªánh <code>jstat</code> ƒë·ªÉ xem ƒë·ªông</li><li>ƒê·∫∑t c√°c tham s·ªë li√™n quan ƒë·ªÉ in nh·∫≠t k√Ω GC trong container</li></ul><h4 id="xem-gc-bang-lenh-jstat" tabindex="-1"><a class="header-anchor" href="#xem-gc-bang-lenh-jstat"><span>Xem GC b·∫±ng l·ªánh jstat</span></a></h4><p><code>jstat -gc</code> th·ªëng k√™ h√†nh vi c·ªßa b·ªô thu gom r√°c:</p><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">jstat </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="color:#E06C75;--shiki-dark:#E06C75;">gc </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1262</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> S0C</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    S1C</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">     S0U</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">     S1U</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">   EC</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">       EU</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        OC</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">         OU</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        PC</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">       PU</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">         YGC</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    YGCT</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    FGC</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    FGCT</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">     GCT</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">26112.0</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 24064.0</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 6562.5</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  0.0</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   564224.0</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 76274.5</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   434176.0</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   388518.3</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  524288.0</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 42724.7</span><span style="color:#D19A66;--shiki-dark:#D19A66;">    320</span><span style="color:#D19A66;--shiki-dark:#D19A66;">    6.417</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   1</span><span style="color:#D19A66;--shiki-dark:#D19A66;">      0.398</span><span style="color:#D19A66;--shiki-dark:#D19A66;">    6.815</span></span></code></pre></div><p>B·∫°n c≈©ng c√≥ th·ªÉ ƒë·∫∑t m·ªôt kho·∫£ng th·ªùi gian c·ªë ƒë·ªãnh ƒë·ªÉ in:</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">jstat</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -gc</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1262</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2000</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 20</span></span></code></pre></div><p>L·ªánh n√†y c√≥ nghƒ©a l√† in th√¥ng tin gc c·ªßa 1262 m·ªói 2000ms, t·ªïng c·ªông in 20 l·∫ßn.</p><h4 id="ƒëat-tham-so-in-gc" tabindex="-1"><a class="header-anchor" href="#ƒëat-tham-so-in-gc"><span>ƒê·∫∑t tham s·ªë in GC</span></a></h4><p>Tr∆∞·ªõc khi ch·∫°y JVM, b·∫°n c√≥ th·ªÉ ƒë·∫∑t c√°c tham s·ªë ƒë·ªÉ in nh·∫≠t k√Ω GC. Th√¥ng th∆∞·ªùng c√≥ c√°c c√°ch sau ƒë·ªÉ ƒë·∫∑t c√°c tham s·ªë JVM:</p><div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span>-XX:+PrintGC In nh·∫≠t k√Ω GC</span></span>
<span class="line"><span>-XX:+PrintGCDetails In nh·∫≠t k√Ω chi ti·∫øt GC</span></span>
<span class="line"><span>-XX:+PrintGCTimeStamps In nh·∫≠t k√Ω th·ªùi gian GC (d∆∞·ªõi d·∫°ng d·∫•u th·ªùi gian c∆° s·ªü)</span></span>
<span class="line"><span>-XX:+PrintGCDateStamps In nh·∫≠t k√Ω th·ªùi gian GC (d∆∞·ªõi d·∫°ng ng√†y th√°ng, v√≠ d·ª• 2013-05-04T21:53:59.234+0800)</span></span>
<span class="line"><span>-XX:+PrintHeapAtGC In th√¥ng tin heap tr∆∞·ªõc v√† sau khi GC</span></span>
<span class="line"><span>-verbose:gc -Xloggc:../logs/gc.log ƒê∆∞·ªùng d·∫´n ƒë·∫øn t·ªáp nh·∫≠t k√Ω</span></span></code></pre></div><p>N·∫øu nh·∫≠t k√Ω GC k√©o d√†i trong th·ªùi gian d√†i, ch√∫ng ta kh√≥ c√≥ th·ªÉ xem x√©t hi·ªáu su·∫•t GC t·ªïng th·ªÉ d∆∞·ªõi d·∫°ng vƒÉn b·∫£n. Trong tr∆∞·ªùng h·ª£p n√†y, ch√∫ng ta c√≥ th·ªÉ s·ª≠ d·ª•ng c√¥ng c·ª• <a href="https://sourceforge.net/projects/gcviewer/" target="_blank" rel="noopener noreferrer">GCView</a> ƒë·ªÉ m·ªü t·ªáp nh·∫≠t k√Ω v√† xem hi·ªáu su·∫•t GC t·ªïng th·ªÉ d∆∞·ªõi giao di·ªán ƒë·ªì h·ªça.</p><p>„ÄêV√≠ d·ª•„ÄëC√†i ƒë·∫∑t Tomcat</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">JAVA_OPTS</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;-server -Xms2000m -Xmx2000m -Xmn800m -XX:PermSize=64m -XX:MaxPermSize=256m -XX:SurvivorRatio=4</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">-verbose:gc -Xloggc:</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$CATALINA_HOME</span><span style="color:#98C379;--shiki-dark:#98C379;">/logs/gc.log</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">-Djava.awt.headless=true</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">-XX:+PrintGCTimeStamps -XX:+PrintGCDetails</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">-Dsun.rmi.dgc.server.gcInterval=600000 -Dsun.rmi.dgc.client.gcInterval=600000</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">-XX:+UseConcMarkSweepGC -XX:MaxTenuringThreshold=15&quot;</span></span></code></pre></div><ul><li><code>-Xms2000m -Xmx2000m -Xmn800m -XX:PermSize=64m -XX:MaxPermSize=256m</code><br> Xms l√† k√≠ch th∆∞·ªõc heap ban ƒë·∫ßu c·ªßa JVM khi kh·ªüi ƒë·ªông, Xmx l√† k√≠ch th∆∞·ªõc heap t·ªëi ƒëa c·ªßa JVM, xmn l√† k√≠ch th∆∞·ªõc c·ªßa th·∫ø h·ªá tr·∫ª, permsize l√† k√≠ch th∆∞·ªõc ban ƒë·∫ßu c·ªßa permgen, MaxPermSize l√† k√≠ch th∆∞·ªõc t·ªëi ƒëa c·ªßa permgen.</li><li><code>-XX:SurvivorRatio=4</code><br> SurvivorRatio l√† t·ª∑ l·ªá k√≠ch th∆∞·ªõc c·ªßa khu v·ª±c Eden v√† khu v·ª±c Survivor trong kh√¥ng gian m·ªõi, m·∫∑c ƒë·ªãnh l√† 8, t·ª©c l√† t·ª∑ l·ªá gi·ªØa hai khu v·ª±c Survivor v√† m·ªôt khu v·ª±c Eden l√† 2: 8, m·ªôt khu v·ª±c Survivor chi·∫øm 1/10 c·ªßa kh√¥ng gian tr·∫ª. Gi·∫£m tham s·ªë n√†y s·∫Ω l√†m tƒÉng k√≠ch th∆∞·ªõc khu v·ª±c survivor, gi√∫p ƒë·ªëi t∆∞·ª£ng ·ªü l·∫°i khu v·ª±c survivor l√¢u h∆°n, gi·∫£m s·ªë l∆∞·ª£ng ƒë·ªëi t∆∞·ª£ng v√†o th·∫ø h·ªá gi√†. √ù t∆∞·ªüng c·ªßa vi·ªác lo·∫°i b·ªè khu v·ª±c survivor l√† ƒë·ªÉ ƒë∆∞a nhanh ch√≥ng c√°c d·ªØ li·ªáu kh√¥ng th·ªÉ thu gom ƒë∆∞·ª£c v√†o th·∫ø h·ªá gi√†, tƒÉng t·∫ßn su·∫•t thu gom c·ªßa th·∫ø h·ªá gi√†, gi·∫£m kh·∫£ nƒÉng th·∫ø h·ªá gi√† b√πng n·ªï, ƒëi·ªÅu n√†y ƒë∆∞·ª£c th·ª±c hi·ªán b·∫±ng c√°ch ƒë·∫∑t -XX:SurvivorRatio th√†nh m·ªôt gi√° tr·ªã l·ªõn (v√≠ d·ª•: 65536).</li><li><code>-verbose:gc -Xloggc:$CATALINA_HOME/logs/gc.log</code><br> Ghi th√¥ng tin v·ªÅ m·ªói l·∫ßn thu gom r√°c c·ªßa m√°y ·∫£o v√†o t·ªáp nh·∫≠t k√Ω, t√™n t·ªáp ƒë∆∞·ª£c ch·ªâ ƒë·ªãnh b·ªüi file, ƒë·ªãnh d·∫°ng t·ªáp l√† t·ªáp ph·∫≥ng, n·ªôi dung gi·ªëng v·ªõi -verbose:gc.</li><li><code>-Djava.awt.headless=true</code> Ch·∫ø ƒë·ªô Headless l√† m·ªôt ch·∫ø ƒë·ªô c·∫•u h√¨nh c·ªßa h·ªá th·ªëng. Trong ch·∫ø ƒë·ªô n√†y, h·ªá th·ªëng thi·∫øu thi·∫øt b·ªã hi·ªÉn th·ªã, b√†n ph√≠m ho·∫∑c chu·ªôt.</li><li><code>-XX:+PrintGCTimeStamps -XX:+PrintGCDetails</code><br> ƒê·∫∑t ƒë·ªãnh d·∫°ng nh·∫≠t k√Ω GC</li><li><code>-Dsun.rmi.dgc.server.gcInterval=600000 -Dsun.rmi.dgc.client.gcInterval=600000</code><br> X√°c ƒë·ªãnh kho·∫£ng th·ªùi gian gc khi g·ªçi rmi</li><li><code>-XX:+UseConcMarkSweepGC -XX:MaxTenuringThreshold=15</code> S·ª≠ d·ª•ng c√°ch thu gom song song, sau 15 l·∫ßn gc nh·ªè, n√≥ s·∫Ω v√†o th·∫ø h·ªá gi√†</li></ul><h3 id="phan-tich-nhat-ky-gc" tabindex="-1"><a class="header-anchor" href="#phan-tich-nhat-ky-gc"><span>Ph√¢n t√≠ch nh·∫≠t k√Ω GC</span></a></h3><p>Nh·∫≠t k√Ω GC tr·∫ª:</p><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">2016</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="color:#D19A66;--shiki-dark:#D19A66;">07</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="color:#E06C75;--shiki-dark:#E06C75;">05T10</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">43</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">18.093</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">+</span><span style="color:#E06C75;--shiki-dark:#E06C75;">0800</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 25.395</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> [</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">GC</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> [PSYoungGen</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 274931K</span><span style="color:#C678DD;--shiki-dark:#C678DD;">-&gt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">10738</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">K</span><span style="color:#E06C75;--shiki-dark:#E06C75;">(274944K)] 371093K</span><span style="color:#C678DD;--shiki-dark:#C678DD;">-&gt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">147186</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">K</span><span style="color:#E06C75;--shiki-dark:#E06C75;">(450048K)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0.0668480</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> secs] [Times</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> user</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0.17</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> sys</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0.08</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> real</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0.07</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> secs]</span></span></code></pre></div><p>Nh·∫≠t k√Ω GC ƒë·∫ßy ƒë·ªß:</p><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">2016</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="color:#D19A66;--shiki-dark:#D19A66;">07</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="color:#E06C75;--shiki-dark:#E06C75;">05T10</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">43</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">18.160</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">+</span><span style="color:#E06C75;--shiki-dark:#E06C75;">0800</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 25.462</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> [</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Full</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> GC</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> [PSYoungGen</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 10738K</span><span style="color:#C678DD;--shiki-dark:#C678DD;">-&gt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">0</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">K</span><span style="color:#E06C75;--shiki-dark:#E06C75;">(274944K)] [ParOldGen</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 136447K</span><span style="color:#C678DD;--shiki-dark:#C678DD;">-&gt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">140379</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">K</span><span style="color:#E06C75;--shiki-dark:#E06C75;">(302592K)] 147186K</span><span style="color:#C678DD;--shiki-dark:#C678DD;">-&gt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">140379</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">K</span><span style="color:#E06C75;--shiki-dark:#E06C75;">(577536K) [PSPermGen</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 85411K</span><span style="color:#C678DD;--shiki-dark:#C678DD;">-&gt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">85376</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">K</span><span style="color:#E06C75;--shiki-dark:#E06C75;">(171008K)]</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0.6763541</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> secs] [Times</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> user</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">1.75</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> sys</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0.02</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> real</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0.68</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> secs]</span></span></code></pre></div><p>D·ª±a tr√™n nh·∫≠t k√Ω tr√™n, PSYoungGen, ParOldGen, PSPermGen thu·ªôc b·ªô thu gom song song. Trong ƒë√≥, PSYoungGen bi·ªÉu th·ªã s·ª± thay ƒë·ªïi b·ªô nh·ªõ tr·∫ª tr∆∞·ªõc v√† sau khi gc; ParOldGen bi·ªÉu th·ªã s·ª± thay ƒë·ªïi b·ªô nh·ªõ gi√† tr∆∞·ªõc v√† sau khi gc; PSPermGen bi·ªÉu th·ªã s·ª± thay ƒë·ªïi b·ªô nh·ªõ vƒ©nh vi·ªÖn tr∆∞·ªõc v√† sau khi gc. gc tr·∫ª ch·ªß y·∫øu l√† ƒë·ªÉ thu gom b·ªô nh·ªõ tr·∫ª, th·ªùi gian ho·∫°t ƒë·ªông ng·∫Øn; full gc s·∫Ω thu gom to√†n b·ªô b·ªô nh·ªõ heap, th·ªùi gian ho·∫°t ƒë·ªông l√¢u, v√¨ v·∫≠y th∆∞·ªùng c·ªë g·∫Øng gi·∫£m s·ªë l·∫ßn full gc.</p><p>D·ª±a tr√™n hai bi·ªÉu ƒë·ªì tr√™n, r√µ r√†ng th·∫•y nh·∫≠t k√Ω gc ƒë∆∞·ª£c t·∫°o th√†nh b·ªüi:</p><p>GC tr·∫ª</p><figure><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20220107093538.jfif" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>Full GC</p><figure><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20220107093543.jfif" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h4 id="cpu-cao" tabindex="-1"><a class="header-anchor" href="#cpu-cao"><span>CPU cao</span></a></h4><p>B∆∞·ªõc x√°c ƒë·ªãnh:</p><p>(1) Ch·∫°y l·ªánh top -c, t√¨m id c·ªßa ti·∫øn tr√¨nh c√≥ CPU cao nh·∫•t</p><p>(2) Xu·∫•t th√¥ng tin stack c·ªßa ·ª©ng d·ª•ng Java b·∫±ng l·ªánh jstack PID.</p><p>V√≠ d·ª•:</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">jstack </span><span style="color:#D19A66;--shiki-dark:#D19A66;">6795</span></span>
<span class="line"></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Low Memory Detector&quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> daemon prio</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">10</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> tid</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0x081465f8</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> nid</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0x7</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> runnable [0x00000000</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">..</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">0x00000000</span><span style="color:#E06C75;--shiki-dark:#E06C75;">]</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        &quot;CompilerThread0&quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> daemon prio</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">10</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> tid</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0x08143c58</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> nid</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0x6</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> waiting on condition [0x00000000</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">..</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">0xfb5fd798</span><span style="color:#E06C75;--shiki-dark:#E06C75;">]</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        &quot;Signal Dispatcher&quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> daemon prio</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">10</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> tid</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0x08142f08</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> nid</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0x5</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> waiting on condition [0x00000000</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">..</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">0x00000000</span><span style="color:#E06C75;--shiki-dark:#E06C75;">]</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        &quot;Finalizer&quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> daemon prio</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">10</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> tid</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0x08137ca0</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> nid</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0x4</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> in </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Object</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">wait</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> [0xfbeed000</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">..</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">0xfbeeddb8</span><span style="color:#E06C75;--shiki-dark:#E06C75;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        at </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">lang</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Object</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">wait</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Native</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Method)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        -</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> waiting on </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">&lt;</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0xef600848</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> (a </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">lang</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">ref</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">ReferenceQueue$Lock</span><span style="color:#E06C75;--shiki-dark:#E06C75;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        at </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">lang</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">ref</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">ReferenceQueue</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">remove</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">ReferenceQueue</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">116</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        -</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> locked </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">&lt;</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0xef600848</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> (a </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">lang</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">ref</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">ReferenceQueue$Lock</span><span style="color:#E06C75;--shiki-dark:#E06C75;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        at </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">lang</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">ref</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">ReferenceQueue</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">remove</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">ReferenceQueue</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">132</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        at </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">lang</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">ref</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Finalizer$FinalizerThread</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">run</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Finalizer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">159</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        &quot;Reference Handler&quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> daemon prio</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">10</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> tid</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0x081370f0</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> nid</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0x3</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> in </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Object</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">wait</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> [0xfbf4a000</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">..</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">0xfbf4aa38</span><span style="color:#E06C75;--shiki-dark:#E06C75;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        at </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">lang</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Object</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">wait</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Native</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Method)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        -</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> waiting on </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">&lt;</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0xef600758</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> (a </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">lang</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">ref</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Reference$Lock</span><span style="color:#E06C75;--shiki-dark:#E06C75;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        at </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">lang</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Object</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">wait</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Object</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">474</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        at </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">lang</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">ref</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Reference$ReferenceHandler</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">run</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Reference</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">116</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        -</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> locked </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">&lt;</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0xef600758</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> (a </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">lang</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">ref</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Reference$Lock</span><span style="color:#E06C75;--shiki-dark:#E06C75;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        &quot;VM Thread&quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> prio</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">10</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> tid</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0x08134878</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> nid</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0x2</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> runnable</span></span>
<span class="line"></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        &quot;VM Periodic Task Thread&quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> prio</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">10</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> tid</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0x08147768</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> nid</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0x8</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> waiting on condition</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Trong t·ªáp nh·∫≠t k√Ω stack ƒë∆∞·ª£c in, tid v√† nid c√≥ √Ω nghƒ©a nh∆∞ sau:</p><div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span>nid: s·ªë hi·ªáu lu·ªìng Linux t∆∞∆°ng ·ª©ng (tid) trong h·ªá ƒëi·ªÅu h√†nh Linux, t·ª©c l√† s·ªë th·∫≠p l·ª•c ph√¢n ƒë∆∞·ª£c chuy·ªÉn ƒë·ªïi t·ª´ s·ªë th·∫≠p l·ª•c ph√¢n tr∆∞·ªõc ƒë√≥</span></span>
<span class="line"><span>tid: ƒê√¢y n√™n l√† ƒë·ªãa ch·ªâ duy nh·∫•t trong quy t·∫Øc b·ªô nh·ªõ jmm c·ªßa jvm</span></span></code></pre></div><p>Trong tr∆∞·ªùng h·ª£p CPU cao, t√¨m lu·ªìng t∆∞∆°ng ·ª©ng, th∆∞·ªùng ƒë∆∞·ª£c x√°c ƒë·ªãnh b·∫±ng nid. V√† n·∫øu x·∫£y ra v·∫•n ƒë·ªÅ nh∆∞ deadlock, th∆∞·ªùng s·ª≠ d·ª•ng tid ƒë·ªÉ x√°c ƒë·ªãnh.</p><p>(3) In nid c·ªßa lu·ªìng CPU cao</p><p>L·ªánh ƒë·ªÉ xem th√¥ng tin ti·∫øn tr√¨nh c·ª• th·ªÉ c·ªßa lu·ªìng nh∆∞ sau:</p><p>top -H -p 6735</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">top </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 14</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">20</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#E06C75;--shiki-dark:#E06C75;">09 up </span><span style="color:#D19A66;--shiki-dark:#D19A66;">611</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> days</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  2</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">56</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  1</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> user</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  load average</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 13.19</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 7.76</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 7.82</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">Threads</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 6991</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> total</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  17</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> running</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 6974</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> sleeping</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   0</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> stopped</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   0</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> zombie</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">%</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Cpu</span><span style="color:#E06C75;--shiki-dark:#E06C75;">(s)</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 90.4</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> us</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  2.1</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> sy</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  0.0</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> ni</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  7.0</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  0.0</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> wa</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  0.0</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> hi</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  0.4</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> si</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  0.0</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> st</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">KiB</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> Mem</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  32783044</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> total</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 32505008</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> used</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   278036</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> free</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   120304</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> buffers</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">KiB</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> Swap</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">        0</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> total</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#D19A66;--shiki-dark:#D19A66;">        0</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> used</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#D19A66;--shiki-dark:#D19A66;">        0</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> free</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;"> 4497428</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> cached </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Mem</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">  PID</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> USER</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">      PR</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">  NI</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    VIRT</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    RES</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    SHR</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> S </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">%</span><span style="color:#E06C75;--shiki-dark:#E06C75;">CPU </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">%</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">MEM</span><span style="color:#E06C75;--shiki-dark:#E06C75;">     TIME</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">+</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> COMMAND</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;"> 6800</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> root      </span><span style="color:#D19A66;--shiki-dark:#D19A66;">20</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   0</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 27</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">299g</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">021t</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   7172</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> S </span><span style="color:#D19A66;--shiki-dark:#D19A66;">54.7</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 70.1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 187</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">55.61</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> java</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;"> 6803</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> root      </span><span style="color:#D19A66;--shiki-dark:#D19A66;">20</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   0</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 27</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">299g</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">021t</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   7172</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> S </span><span style="color:#D19A66;--shiki-dark:#D19A66;">54.4</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 70.1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 187</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">52.59</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> java</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;"> 6798</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> root      </span><span style="color:#D19A66;--shiki-dark:#D19A66;">20</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   0</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 27</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">299g</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">021t</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   7172</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> S </span><span style="color:#D19A66;--shiki-dark:#D19A66;">53.7</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 70.1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 187</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">55.08</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> java</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;"> 6801</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> root      </span><span style="color:#D19A66;--shiki-dark:#D19A66;">20</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   0</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 27</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">299g</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">021t</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   7172</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> S </span><span style="color:#D19A66;--shiki-dark:#D19A66;">53.7</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 70.1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 187</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">55.25</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> java</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;"> 6797</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> root      </span><span style="color:#D19A66;--shiki-dark:#D19A66;">20</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   0</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 27</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">299g</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">021t</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   7172</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> S </span><span style="color:#D19A66;--shiki-dark:#D19A66;">53.1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 70.1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 187</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">52.78</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> java</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;"> 6804</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> root      </span><span style="color:#D19A66;--shiki-dark:#D19A66;">20</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   0</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 27</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">299g</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">021t</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   7172</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> S </span><span style="color:#D19A66;--shiki-dark:#D19A66;">53.1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 70.1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 187</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">55.76</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> java</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;"> 6802</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> root      </span><span style="color:#D19A66;--shiki-dark:#D19A66;">20</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   0</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 27</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">299g</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">021t</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   7172</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> S </span><span style="color:#D19A66;--shiki-dark:#D19A66;">52.1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 70.1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 187</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">54.79</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> java</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;"> 6799</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> root      </span><span style="color:#D19A66;--shiki-dark:#D19A66;">20</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   0</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 27</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">299g</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">021t</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   7172</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> S </span><span style="color:#D19A66;--shiki-dark:#D19A66;">51.8</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 70.1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 187</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">53.36</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> java</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;"> 6807</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> root      </span><span style="color:#D19A66;--shiki-dark:#D19A66;">20</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   0</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 27</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">299g</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">021t</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   7172</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> S </span><span style="color:#D19A66;--shiki-dark:#D19A66;">13.6</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 70.1</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  48</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">58.60</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> java</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">11014</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> root      </span><span style="color:#D19A66;--shiki-dark:#D19A66;">20</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   0</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 27</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">299g</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">021t</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   7172</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> R  </span><span style="color:#D19A66;--shiki-dark:#D19A66;">8.4</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 70.1</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   8</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">00</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">32</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> java</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">10642</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> root      </span><span style="color:#D19A66;--shiki-dark:#D19A66;">20</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   0</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 27</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">299g</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">021t</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   7172</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> R  </span><span style="color:#D19A66;--shiki-dark:#D19A66;">6.5</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 70.1</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   6</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">32.06</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> java</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;"> 6808</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> root      </span><span style="color:#D19A66;--shiki-dark:#D19A66;">20</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   0</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 27</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">299g</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">021t</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   7172</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> S  </span><span style="color:#D19A66;--shiki-dark:#D19A66;">6.1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 70.1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 159</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">08.40</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> java</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">11315</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> root      </span><span style="color:#D19A66;--shiki-dark:#D19A66;">20</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   0</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 27</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">299g</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">021t</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   7172</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> S  </span><span style="color:#D19A66;--shiki-dark:#D19A66;">3.9</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 70.1</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   5</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">54.10</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> java</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">12545</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> root      </span><span style="color:#D19A66;--shiki-dark:#D19A66;">20</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   0</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 27</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">299g</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">021t</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   7172</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> S  </span><span style="color:#D19A66;--shiki-dark:#D19A66;">3.9</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 70.1</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   6</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">55.48</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> java</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">23353</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> root      </span><span style="color:#D19A66;--shiki-dark:#D19A66;">20</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   0</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 27</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">299g</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">021t</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   7172</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> S  </span><span style="color:#D19A66;--shiki-dark:#D19A66;">3.9</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 70.1</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   2</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">20.55</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> java</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">24868</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> root      </span><span style="color:#D19A66;--shiki-dark:#D19A66;">20</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   0</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 27</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">299g</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">021t</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   7172</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> S  </span><span style="color:#D19A66;--shiki-dark:#D19A66;">3.9</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 70.1</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   2</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">12.46</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> java</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;"> 9146</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> root      </span><span style="color:#D19A66;--shiki-dark:#D19A66;">20</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   0</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 27</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">299g</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">021t</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   7172</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> S  </span><span style="color:#D19A66;--shiki-dark:#D19A66;">3.6</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 70.1</span><span style="color:#D19A66;--shiki-dark:#D19A66;">   7</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">42.72</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> java</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>C√≥ th·ªÉ th·∫•y lu·ªìng chi·∫øm CPU cao, nh∆∞ng ch√∫ng kh√¥ng cao l·∫Øm, kh√¥ng th·ªÉ tr·ª±c ti·∫øp x√°c ƒë·ªãnh l·ªõp c·ª• th·ªÉ. nid l√† s·ªë th·∫≠p l·ª•c ph√¢n, v√¨ v·∫≠y ch√∫ng ta c·∫ßn l·∫•y ID th·∫≠p l·ª•c ph√¢n c·ªßa lu·ªìng:</p><div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span>printf &quot;%x\\n&quot; 6800</span></span></code></pre></div><div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span>K·∫øt qu·∫£ ƒë·∫ßu ra:45cd</span></span></code></pre></div><p>Sau ƒë√≥, t√¨m v·ªã tr√≠ c·ªßa nid trong nh·∫≠t k√Ω stack ƒë∆∞·ª£c in:</p><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">&quot;catalina-exec-5692&quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> daemon prio</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">10</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> tid</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0x00007f3b05013800</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> nid</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0x45cd</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> waiting on condition [</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0x00007f3ae08e3000</span><span style="color:#E06C75;--shiki-dark:#E06C75;">]</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">   java</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">lang</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Thread</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">State</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> TIMED_WAITING</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> (parking)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        at </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">sun</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">misc</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Unsafe</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">park</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Native</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Method)</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        -</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> parking to wait </span><span style="color:#C678DD;--shiki-dark:#C678DD;">for</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">  &lt;</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0x00000006a7800598</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> (a </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">util</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">concurrent</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">locks</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">AbstractQueuedSynchronizer$ConditionObject</span><span style="color:#E06C75;--shiki-dark:#E06C75;">)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        at </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">util</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">concurrent</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">locks</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">LockSupport</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">parkNanos</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">LockSupport</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">226</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        at </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">util</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">concurrent</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">locks</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">AbstractQueuedSynchronizer$ConditionObject</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awaitNanos</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">AbstractQueuedSynchronizer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">2082</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        at </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">util</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">concurrent</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">LinkedBlockingQueue</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">poll</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">LinkedBlockingQueue</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">467</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        at </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">org</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">apache</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">tomcat</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">util</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">threads</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">TaskQueue</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">poll</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">TaskQueue</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">86</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        at </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">org</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">apache</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">tomcat</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">util</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">threads</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">TaskQueue</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">poll</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">TaskQueue</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">32</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        at </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">util</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">concurrent</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">ThreadPoolExecutor</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getTask</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">ThreadPoolExecutor</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">1068</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        at </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">util</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">concurrent</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">ThreadPoolExecutor</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">runWorker</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">ThreadPoolExecutor</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">1130</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        at </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">util</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">concurrent</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">ThreadPoolExecutor$Worker</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">run</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">ThreadPoolExecutor</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">615</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        at </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">org</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">apache</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">tomcat</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">util</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">threads</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">TaskThread$WrappingRunnable</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">run</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">TaskThread</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">61</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        at </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">lang</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Thread</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">run</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Thread</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">745</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span></code></pre></div><h2 id="cau-hinh-gc" tabindex="-1"><a class="header-anchor" href="#cau-hinh-gc"><span>C·∫•u h√¨nh GC</span></a></h2><blockquote><p>Vui l√≤ng tham kh·∫£o t√†i li·ªáu ch√≠nh th·ª©c ƒë·ªÉ bi·∫øt chi ti·∫øt c√°c tham s·ªë: <a href="http://www.oracle.com/technetwork/java/javase/tech/vmoptions-jsp-140102.html" target="_blank" rel="noopener noreferrer">JavaHotSpot VM Options</a>. ·ªû ƒë√¢y ch·ªâ li·ªát k√™ c√°c tham s·ªë th√¥ng d·ª•ng.</p></blockquote><h3 id="cau-hinh-kich-thuoc-heap" tabindex="-1"><a class="header-anchor" href="#cau-hinh-kich-thuoc-heap"><span>C·∫•u h√¨nh k√≠ch th∆∞·ªõc Heap</span></a></h3><p><strong>C·∫•u h√¨nh cho ph·∫ßn Young Generation r·∫•t quan tr·ªçng.</strong></p><p>C√≥ ba gi·ªõi h·∫°n v·ªÅ k√≠ch th∆∞·ªõc Heap trong JVM:</p><ol><li>Gi·ªõi h·∫°n c·ªßa ki·ªÉu d·ªØ li·ªáu c·ªßa h·ªá ƒëi·ªÅu h√†nh li√™n quan (32-bit hay 64-bit).</li><li>Gi·ªõi h·∫°n c·ªßa b·ªô nh·ªõ ·∫£o c√≥ s·∫µn trong h·ªá th·ªëng.</li><li>Gi·ªõi h·∫°n c·ªßa b·ªô nh·ªõ v·∫≠t l√Ω c√≥ s·∫µn trong h·ªá th·ªëng.</li></ol><div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span>T·ªïng k√≠ch th∆∞·ªõc Heap = K√≠ch th∆∞·ªõc Young Generation + K√≠ch th∆∞·ªõc Old Generation + K√≠ch th∆∞·ªõc Permanent Generation</span></span></code></pre></div><ul><li>Th∆∞·ªùng th√¨ Permanent Generation c√≥ k√≠ch th∆∞·ªõc c·ªë ƒë·ªãnh l√† <code>64m</code>. C√≥ th·ªÉ c·∫•u h√¨nh b·∫±ng <code>-XX:PermSize</code>.</li><li>Th∆∞·ªùng th√¨ Young Generation chi·∫øm 3/8 t·ªïng k√≠ch th∆∞·ªõc Heap. C√≥ th·ªÉ c·∫•u h√¨nh b·∫±ng <code>-Xmn</code>.</li></ul><h3 id="cau-hinh-bo-nho-jvm" tabindex="-1"><a class="header-anchor" href="#cau-hinh-bo-nho-jvm"><span>C·∫•u h√¨nh b·ªô nh·ªõ JVM</span></a></h3><table><thead><tr><th>C·∫•u h√¨nh</th><th>M√¥ t·∫£</th></tr></thead><tbody><tr><td><code>-Xss</code></td><td>K√≠ch th∆∞·ªõc Stack c·ªßa JVM.</td></tr><tr><td><code>-Xms</code></td><td>Gi√° tr·ªã kh·ªüi t·∫°o k√≠ch th∆∞·ªõc Heap.</td></tr><tr><td><code>-Xmx</code></td><td>Gi√° tr·ªã t·ªëi ƒëa c·ªßa k√≠ch th∆∞·ªõc Heap.</td></tr><tr><td><code>-Xmn</code></td><td>K√≠ch th∆∞·ªõc Young Generation.</td></tr><tr><td><code>-XX:NewSize</code></td><td>Gi√° tr·ªã kh·ªüi t·∫°o k√≠ch th∆∞·ªõc Young Generation.</td></tr><tr><td><code>-XX:MaxNewSize</code></td><td>Gi√° tr·ªã t·ªëi ƒëa c·ªßa k√≠ch th∆∞·ªõc Young Generation.</td></tr><tr><td><code>-XX:NewRatio</code></td><td>T·ª∑ l·ªá gi·ªØa Young Generation v√† Old Generation. M·∫∑c ƒë·ªãnh l√† 2.</td></tr><tr><td><code>-XX:SurvivorRatio</code></td><td>T·ª∑ l·ªá gi·ªØa Eden Space v√† Survivor Space trong Young Generation. M·∫∑c ƒë·ªãnh l√† 8.</td></tr><tr><td><code>-XX:PermSize</code></td><td>Gi√° tr·ªã kh·ªüi t·∫°o k√≠ch th∆∞·ªõc Permanent Generation.</td></tr><tr><td><code>-XX:MaxPermSize</code></td><td>Gi√° tr·ªã t·ªëi ƒëa c·ªßa k√≠ch th∆∞·ªõc Permanent Generation.</td></tr></tbody></table><h3 id="cau-hinh-gc-1" tabindex="-1"><a class="header-anchor" href="#cau-hinh-gc-1"><span>C·∫•u h√¨nh GC</span></a></h3><table><thead><tr><th>C·∫•u h√¨nh</th><th>M√¥ t·∫£</th></tr></thead><tbody><tr><td><code>-XX:+UseSerialGC</code></td><td>S·ª≠ d·ª•ng Serial + Serial Old garbage collector.</td></tr><tr><td><code>-XX:+UseParallelGC</code></td><td>S·ª≠ d·ª•ng Parallel Scavenge + Parallel Old garbage collector.</td></tr><tr><td><s><code>-XX:+UseParallelOldGC</code></s></td><td><s>S·ª≠ d·ª•ng Parallel Old garbage collector (kh√¥ng c√≤n s·ª≠ d·ª•ng t·ª´ JDK 5 tr·ªü ƒëi)</s></td></tr><tr><td><code>-XX:+UseParNewGC</code></td><td>S·ª≠ d·ª•ng ParNew + Serial Old garbage collector.</td></tr><tr><td><code>-XX:+UseConcMarkSweepGC</code></td><td>S·ª≠ d·ª•ng CMS + ParNew + Serial Old garbage collector.</td></tr><tr><td><code>-XX:+UseG1GC</code></td><td>S·ª≠ d·ª•ng G1 garbage collector.</td></tr><tr><td><code>-XX:ParallelCMSThreads</code></td><td>S·ªë l∆∞·ª£ng lu·ªìng ƒë∆∞·ª£c s·ª≠ d·ª•ng cho Concurrent Mark Sweep garbage collector.</td></tr></tbody></table><h3 id="cac-tham-so-chung-cho-garbage-collector" tabindex="-1"><a class="header-anchor" href="#cac-tham-so-chung-cho-garbage-collector"><span>C√°c tham s·ªë chung cho garbage collector</span></a></h3><table><thead><tr><th>C·∫•u h√¨nh</th><th>M√¥ t·∫£</th></tr></thead><tbody><tr><td><code>PretenureSizeThreshold</code></td><td>K√≠ch th∆∞·ªõc ƒë·ªëi t∆∞·ª£ng ƒë∆∞·ª£c thƒÉng c·∫•p l√™n Old Generation. M·∫∑c ƒë·ªãnh l√† 0. V√≠ d·ª•: <code>-XX:PretenureSizeThreshold=10M</code></td></tr><tr><td><code>MaxTenuringThreshold</code></td><td>Tu·ªïi t·ªëi ƒëa ƒë·ªÉ thƒÉng c·∫•p l√™n Old Generation. M·∫∑c ƒë·ªãnh l√† 15. V√≠ d·ª•: <code>-XX:MaxTenuringThreshold=10</code></td></tr><tr><td><code>DisableExplicitGC</code></td><td>V√¥ hi·ªáu h√≥a <code>System.gc()</code></td></tr></tbody></table><h3 id="jmx" tabindex="-1"><a class="header-anchor" href="#jmx"><span>JMX</span></a></h3><p>Khi b·∫≠t JMX, b·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng <code>jconsole</code> ho·∫∑c <code>jvisualvm</code> ƒë·ªÉ gi√°m s√°t th√¥ng tin c∆° b·∫£n v√† t√¨nh tr·∫°ng ch·∫°y c·ªßa ch∆∞∆°ng tr√¨nh Java.</p><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Dcom</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">sun</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">management</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">jmxremote</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">true</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Dcom</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">sun</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">management</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">jmxremote</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">ssl</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">false</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Dcom</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">sun</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">management</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">jmxremote</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">authenticate</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">false</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Djava</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">rmi</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">server</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">hostname</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">127.0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF;">1</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Dcom</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">sun</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">management</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">jmxremote</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">port</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">18888</span></span></code></pre></div><p><code>-Djava.rmi.server.hostname</code> ch·ªâ ƒë·ªãnh m√°y ch·ªß ch·∫°y ch∆∞∆°ng tr√¨nh Java, <code>-Dcom.sun.management.jmxremote.port</code> ch·ªâ ƒë·ªãnh c·ªïng l·∫Øng nghe d·ªãch v·ª•.</p><h3 id="debug-tu-xa" tabindex="-1"><a class="header-anchor" href="#debug-tu-xa"><span>DEBUG t·ª´ xa</span></a></h3><p>N·∫øu b·∫≠t t√≠nh nƒÉng Debug t·ª´ xa cho ·ª©ng d·ª•ng Java, b·∫°n c·∫ßn ch·ªâ ƒë·ªãnh c√°c tham s·ªë sau:</p><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Xdebug</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Xnoagent</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Djava</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">compiler</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">NONE</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="color:#E06C75;--shiki-dark:#E06C75;">Xrunjdwp</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#E06C75;--shiki-dark:#E06C75;">transport</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#E06C75;--shiki-dark:#E06C75;">dt_socket</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#E06C75;--shiki-dark:#E06C75;">address</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">28888</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#E06C75;--shiki-dark:#E06C75;">server</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#E06C75;--shiki-dark:#E06C75;">y</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#E06C75;--shiki-dark:#E06C75;">suspend</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#E06C75;--shiki-dark:#E06C75;">n</span></span></code></pre></div><p>address l√† c·ªïng l·∫Øng nghe Debug t·ª´ xa.</p><h3 id="heapdump" tabindex="-1"><a class="header-anchor" href="#heapdump"><span>HeapDump</span></a></h3><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="color:#E06C75;--shiki-dark:#E06C75;">XX</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="color:#E06C75;--shiki-dark:#E06C75;">OmitStackTraceInFastThrow </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="color:#E06C75;--shiki-dark:#E06C75;">XX</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">+</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">HeapDumpOnOutOfMemoryError</span></span></code></pre></div><h3 id="cau-hinh-phu-tro" tabindex="-1"><a class="header-anchor" href="#cau-hinh-phu-tro"><span>C·∫•u h√¨nh ph·ª• tr·ª£</span></a></h3><table><thead><tr><th>C·∫•u h√¨nh</th><th>M√¥ t·∫£</th></tr></thead><tbody><tr><td><code>-XX:+PrintGCDetails</code></td><td>In log c·ªßa GC.</td></tr><tr><td><code>-Xloggc:&lt;filename&gt;</code></td><td>Ch·ªâ ƒë·ªãnh t√™n t·ªáp log GC.</td></tr><tr><td><code>-XX:+HeapDumpOnOutOfMemoryError</code></td><td>T·∫°o Heap Dump khi g·∫∑p l·ªói OutOfMemoryError.</td></tr><tr><td><code>-XX:HeapDumpPath=&lt;path&gt;</code></td><td>Ch·ªâ ƒë·ªãnh ƒë∆∞·ªùng d·∫´n l∆∞u Heap Dump.</td></tr><tr><td><code>-XX:+PrintCommandLineFlags</code></td><td>In c√°c c·ªù d√≤ng l·ªánh JVM ƒë√£ ƒë∆∞·ª£c s·ª≠ d·ª•ng.</td></tr><tr><td><code>-XX:+PrintFlagsFinal</code></td><td>In c√°c c·ªù JVM cu·ªëi c√πng ƒë√£ ƒë∆∞·ª£c s·ª≠ d·ª•ng.</td></tr><tr><td><code>-XX:+PrintCompilation</code></td><td>In th√¥ng tin v·ªÅ qu√° tr√¨nh bi√™n d·ªãch JIT.</td></tr><tr><td><code>-XX:+PrintGCApplicationStoppedTime</code></td><td>In th·ªùi gian d·ª´ng ·ª©ng d·ª•ng do GC.</td></tr><tr><td><code>-XX:+PrintGCApplicationConcurrentTime</code></td><td>In th·ªùi gian ch·∫°y ·ª©ng d·ª•ng tr∆∞·ªõc v√† sau khi GC.</td></tr><tr><td><code>-XX:+PrintSafepointStatistics</code></td><td>In th·ªëng k√™ v·ªÅ Safepoint.</td></tr><tr><td><code>-XX:+PrintTenuringDistribution</code></td><td>In th√¥ng tin v·ªÅ ph√¢n ph·ªëi tu·ªïi c·ªßa ƒë·ªëi t∆∞·ª£ng trong Young Generation.</td></tr><tr><td><code>-XX:+PrintAdaptiveSizePolicy</code></td><td>In th√¥ng tin v·ªÅ ch√≠nh s√°ch k√≠ch th∆∞·ªõc th√≠ch ·ª©ng c·ªßa GC.</td></tr><tr><td><code>-XX:+PrintReferenceGC</code></td><td>In th√¥ng tin v·ªÅ vi·ªác thu gom r√°c c·ªßa c√°c tham chi·∫øu.</td></tr><tr><td><code>-XX:+PrintStringDeduplicationStatistics</code></td><td>In th√¥ng tin v·ªÅ th·ªëng k√™ chu·ªói ƒë√£ ƒë∆∞·ª£c gi·∫£m tr√πng.</td></tr><tr><td><code>-XX:+PrintCompilationStatistics</code></td><td>In th√¥ng tin v·ªÅ th·ªëng k√™ bi√™n d·ªãch.</td></tr><tr><td><code>-XX:+PrintNMTStatistics</code></td><td>In th√¥ng tin v·ªÅ th·ªëng k√™ Native Memory Tracking.</td></tr><tr><td><code>-XX:+UnlockDiagnosticVMOptions</code></td><td>M·ªü kh√≥a c√°c t√πy ch·ªçn ch·∫©n ƒëo√°n c·ªßa JVM.</td></tr><tr><td><code>-XX:+UnlockExperimentalVMOptions</code></td><td>M·ªü kh√≥a c√°c t√πy ch·ªçn th·ª≠ nghi·ªám c·ªßa JVM.</td></tr><tr><td><code>-XX:+UnlockCommercialFeatures</code></td><td>M·ªü kh√≥a c√°c t√≠nh nƒÉng th∆∞∆°ng m·∫°i c·ªßa JVM.</td></tr><tr><td><code>-XX:+UseLargePages</code></td><td>S·ª≠ d·ª•ng trang l·ªõn (large pages) cho b·ªô nh·ªõ.</td></tr><tr><td><code>-XX:+UseStringDeduplication</code></td><td>S·ª≠ d·ª•ng gi·∫£m tr√πng chu·ªói (String Deduplication).</td></tr><tr><td><code>-XX:MaxJavaStackTraceDepth=&lt;depth&gt;</code></td><td>Gi·ªõi h·∫°n ƒë·ªô s√¢u c·ªßa Stack Trace khi in log.</td></tr><tr><td><code>-XX:OnError=&quot;&lt;cmd&gt;;&lt;cmd&gt;&quot;</code></td><td>Ch·∫°y c√°c l·ªánh khi g·∫∑p l·ªói.</td></tr><tr><td><code>-XX:OnOutOfMemoryError=&quot;&lt;cmd&gt;;&lt;cmd&gt;&quot;</code></td><td>Ch·∫°y c√°c l·ªánh khi g·∫∑p l·ªói OutOfMemoryError.</td></tr><tr><td><code>-XX:ErrorFile=&lt;file&gt;</code></td><td>Ch·ªâ ƒë·ªãnh t·ªáp ƒë·ªÉ ghi th√¥ng tin l·ªói.</td></tr><tr><td><code>-XX:NativeMemoryTracking=&lt;mode&gt;</code></td><td>B·∫≠t ch·∫ø ƒë·ªô theo d√µi b·ªô nh·ªõ Native. C√°c gi√° tr·ªã mode c√≥ th·ªÉ l√† <code>summary</code>, <code>detail</code>, <code>summary+detail</code>.</td></tr></tbody></table>`,119),l=[o];function t(p,h){return a(),n("div",null,l)}const e=s(r,[["render",t],["__file","JVM In Action.html.vue"]]),k=JSON.parse('{"path":"/programming/java/JVM/JVM%20In%20Action.html","title":"JVM In Action","lang":"en-US","frontmatter":{"title":"JVM In Action","tags":["java","javase","jvm"],"categories":["java","javase","jvm"],"date created":"2023-07-19T00:00:00.000Z","date modified":"2023-07-19T00:00:00.000Z","description":"JVM Th·ª±c h√†nh T·ªïng quan v·ªÅ Tinh ch·ªânh JVM C√°c ch·ªâ s·ªë hi·ªáu su·∫•t GC Trong qu√° tr√¨nh tinh ch·ªânh JVM, c·∫ßn x√°c ƒë·ªãnh m·ª•c ti√™u tinh ch·ªânh tr∆∞·ªõc. T·ª´ g√≥c ƒë·ªô hi·ªáu su·∫•t, th∆∞·ªùng quan t√¢m ƒë·∫ø...","head":[["meta",{"property":"og:url","content":"https://vanhung4499.github.io/programming/java/JVM/JVM%20In%20Action.html"}],["meta",{"property":"og:site_name","content":"VanHung4499"}],["meta",{"property":"og:title","content":"JVM In Action"}],["meta",{"property":"og:description","content":"JVM Th·ª±c h√†nh T·ªïng quan v·ªÅ Tinh ch·ªânh JVM C√°c ch·ªâ s·ªë hi·ªáu su·∫•t GC Trong qu√° tr√¨nh tinh ch·ªânh JVM, c·∫ßn x√°c ƒë·ªãnh m·ª•c ti√™u tinh ch·ªânh tr∆∞·ªõc. T·ª´ g√≥c ƒë·ªô hi·ªáu su·∫•t, th∆∞·ªùng quan t√¢m ƒë·∫ø..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://raw.githubusercontent.com/dunwu/images/dev/snap/20220107093538.jfif"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-06-28T15:54:38.000Z"}],["meta",{"property":"article:author","content":"Hung Nguyen"}],["meta",{"property":"article:tag","content":"java"}],["meta",{"property":"article:tag","content":"javase"}],["meta",{"property":"article:tag","content":"jvm"}],["meta",{"property":"article:modified_time","content":"2024-06-28T15:54:38.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"JVM In Action\\",\\"image\\":[\\"https://raw.githubusercontent.com/dunwu/images/dev/snap/20220107093538.jfif\\",\\"https://raw.githubusercontent.com/dunwu/images/dev/snap/20220107093543.jfif\\"],\\"dateModified\\":\\"2024-06-28T15:54:38.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Hung Nguyen\\",\\"url\\":\\"https://vanhung4499.github.io\\"}]}"]]},"headers":[{"level":2,"title":"T·ªïng quan v·ªÅ Tinh ch·ªânh JVM","slug":"tong-quan-ve-tinh-chinh-jvm","link":"#tong-quan-ve-tinh-chinh-jvm","children":[{"level":3,"title":"C√°c ch·ªâ s·ªë hi·ªáu su·∫•t GC","slug":"cac-chi-so-hieu-suat-gc","link":"#cac-chi-so-hieu-suat-gc","children":[]},{"level":3,"title":"Nguy√™n t·∫Øc tinh ch·ªânh","slug":"nguyen-tac-tinh-chinh","link":"#nguyen-tac-tinh-chinh","children":[]},{"level":3,"title":"Qu√° tr√¨nh tinh ch·ªânh GC","slug":"qua-trinh-tinh-chinh-gc","link":"#qua-trinh-tinh-chinh-gc","children":[]}]},{"level":2,"title":"Nh·∫≠t k√Ω GC","slug":"nhat-ky-gc","link":"#nhat-ky-gc","children":[{"level":3,"title":"L·∫•y nh·∫≠t k√Ω GC","slug":"lay-nhat-ky-gc","link":"#lay-nhat-ky-gc","children":[]},{"level":3,"title":"Ph√¢n t√≠ch nh·∫≠t k√Ω GC","slug":"phan-tich-nhat-ky-gc","link":"#phan-tich-nhat-ky-gc","children":[]}]},{"level":2,"title":"C·∫•u h√¨nh GC","slug":"cau-hinh-gc","link":"#cau-hinh-gc","children":[{"level":3,"title":"C·∫•u h√¨nh k√≠ch th∆∞·ªõc Heap","slug":"cau-hinh-kich-thuoc-heap","link":"#cau-hinh-kich-thuoc-heap","children":[]},{"level":3,"title":"C·∫•u h√¨nh b·ªô nh·ªõ JVM","slug":"cau-hinh-bo-nho-jvm","link":"#cau-hinh-bo-nho-jvm","children":[]},{"level":3,"title":"C·∫•u h√¨nh GC","slug":"cau-hinh-gc-1","link":"#cau-hinh-gc-1","children":[]},{"level":3,"title":"C√°c tham s·ªë chung cho garbage collector","slug":"cac-tham-so-chung-cho-garbage-collector","link":"#cac-tham-so-chung-cho-garbage-collector","children":[]},{"level":3,"title":"JMX","slug":"jmx","link":"#jmx","children":[]},{"level":3,"title":"DEBUG t·ª´ xa","slug":"debug-tu-xa","link":"#debug-tu-xa","children":[]},{"level":3,"title":"HeapDump","slug":"heapdump","link":"#heapdump","children":[]},{"level":3,"title":"C·∫•u h√¨nh ph·ª• tr·ª£","slug":"cau-hinh-phu-tro","link":"#cau-hinh-phu-tro","children":[]}]}],"git":{"createdTime":1719590078000,"updatedTime":1719590078000,"contributors":[{"name":"Hung Nguyen Van","email":"vanhung4499@gmail.com","commits":1}]},"readingTime":{"minutes":17.25,"words":5174},"filePathRelative":"programming/java/JVM/JVM In Action.md","localizedDate":"June 28, 2024","excerpt":"\\n<h2>T·ªïng quan v·ªÅ Tinh ch·ªânh JVM</h2>\\n<h3>C√°c ch·ªâ s·ªë hi·ªáu su·∫•t GC</h3>\\n<p>Trong qu√° tr√¨nh tinh ch·ªânh JVM, c·∫ßn x√°c ƒë·ªãnh m·ª•c ti√™u tinh ch·ªânh tr∆∞·ªõc. T·ª´ g√≥c ƒë·ªô hi·ªáu su·∫•t, th∆∞·ªùng quan t√¢m ƒë·∫øn ba ch·ªâ s·ªë sau:</p>\\n<ul>\\n<li><code>Th√¥ng l∆∞·ª£ng (throughput)</code> - ƒê√¢y l√† ch·ªâ s·ªë hi·ªáu su·∫•t cao nh·∫•t m√† b·ªô thu gom r√°c c√≥ th·ªÉ h·ªó tr·ª£ cho ·ª©ng d·ª•ng m√† kh√¥ng t√≠nh ƒë·∫øn th·ªùi gian t·∫°m d·ª´ng ho·∫∑c ti√™u th·ª• b·ªô nh·ªõ.</li>\\n<li><code>Th·ªùi gian t·∫°m d·ª´ng (latency)</code> - ƒê√¢y l√† th∆∞·ªõc ƒëo ƒë·ªÉ r√∫t ng·∫Øn th·ªùi gian t·∫°m d·ª´ng do thu gom r√°c g√¢y ra ho·∫∑c lo·∫°i b·ªè ho√†n to√†n th·ªùi gian t·∫°m d·ª´ng do thu gom r√°c, t·ª´ ƒë√≥ tr√°nh rung l·∫Øc khi ·ª©ng d·ª•ng ƒëang ch·∫°y.</li>\\n<li><code>T·∫ßn su·∫•t thu gom r√°c</code> - Bao l√¢u m·ªôt l·∫ßn thu gom r√°c x·∫£y ra? Th∆∞·ªùng th√¨ t·∫ßn su·∫•t thu gom r√°c c√†ng th·∫•p c√†ng t·ªët, tuy nhi√™n, tƒÉng k√≠ch th∆∞·ªõc b·ªô nh·ªõ heap c√≥ th·ªÉ gi·∫£m t·∫ßn su·∫•t thu gom r√°c nh∆∞ng ƒë·ªìng th·ªùi c≈©ng tƒÉng s·ªë l∆∞·ª£ng ƒë·ªëi t∆∞·ª£ng c·∫ßn thu gom, d·∫´n ƒë·∫øn tƒÉng th·ªùi gian t·∫°m d·ª´ng. Do ƒë√≥, ch·ªâ c·∫ßn tƒÉng k√≠ch th∆∞·ªõc b·ªô nh·ªõ heap m·ªôt c√°ch ph√π h·ª£p ƒë·ªÉ ƒë·∫£m b·∫£o t·∫ßn su·∫•t thu gom r√°c b√¨nh th∆∞·ªùng l√† ƒë·ªß.</li>\\n</ul>","autoDesc":true}');export{e as comp,k as data};
