import{_ as p,g as r,o as d,c as o,e as a,f as i,w as l,h as n,a as t}from"./app-5QVbWi7Z.js";const c={};function u(m,s){const e=r("RouteLink");return d(),o("div",null,[s[8]||(s[8]=a("h1",{id:"æ¶ˆæ¯é˜Ÿåˆ—-cloud",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#æ¶ˆæ¯é˜Ÿåˆ—-cloud"},[a("span",null,"æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆCloudï¼‰")])],-1)),s[9]||(s[9]=a("p",null,"å‹æƒ…æç¤ºï¼šè¯¥æ–‡æ¡£å·²è¿‡æœŸï¼ï¼ï¼",-1)),s[10]||(s[10]=a("p",null,"è€ƒè™‘åˆ° Spring Cloud Stream å’Œ Spring Cloud Bus çš„å­¦ä¹ æˆæœ¬è¾ƒé«˜ï¼Œé…ç½®è¾ƒä¸ºéº»çƒ¦ï¼Œä¸”ä¸å¤Ÿçµæ´»ï¼Œå› æ­¤é¡¹ç›®å·²ç»ç§»é™¤äº†ç›¸å…³çš„å°è£…ä¸ä½¿ç”¨ã€‚",-1)),s[11]||(s[11]=a("p",null,"ğŸ˜ å»ºè®®é˜…è¯»å¦‚ä¸‹æ–‡æ¡£ï¼ŒæŒ‰éœ€ä½¿ç”¨ï¼š",-1)),a("ul",null,[a("li",null,[i(e,{to:"/message-queue/event/"},{default:l(()=>s[0]||(s[0]=[n("ã€Šæ¶ˆæ¯é˜Ÿåˆ—ï¼ˆå†…å­˜ï¼‰ã€‹")])),_:1})]),a("li",null,[i(e,{to:"/message-queue/redis/"},{default:l(()=>s[1]||(s[1]=[n("ã€Šæ¶ˆæ¯é˜Ÿåˆ—ï¼ˆRedisï¼‰ã€‹")])),_:1})]),a("li",null,[i(e,{to:"/message-queue/rocketmq/"},{default:l(()=>s[2]||(s[2]=[n("ã€Šæ¶ˆæ¯é˜Ÿåˆ—ï¼ˆRocketMQï¼‰ã€‹")])),_:1})]),a("li",null,[i(e,{to:"/message-queue/rabbitmq/"},{default:l(()=>s[3]||(s[3]=[n("ã€Šæ¶ˆæ¯é˜Ÿåˆ—ï¼ˆRabbitMQï¼‰ã€‹")])),_:1})]),a("li",null,[i(e,{to:"/message-queue/kafka/"},{default:l(()=>s[4]||(s[4]=[n("ã€Šæ¶ˆæ¯é˜Ÿåˆ—ï¼ˆKafkaï¼‰ã€‹")])),_:1}),s[5]||(s[5]=a("br",null,null,-1)),s[6]||(s[6]=a("a",{href:"https://github.com/YunaiV/yudao-cloud/blob/master/yudao-framework/yudao-spring-boot-starter-mq/",target:"_blank",rel:"noopener noreferrer"},[a("code",null,"yudao-spring-boot-starter-mq")],-1)),s[7]||(s[7]=n(" æŠ€æœ¯ç»„ä»¶ï¼ŒåŸºäº RocketMQ å®ç°åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ”¯æŒé›†ç¾¤æ¶ˆè´¹ã€å¹¿æ’­æ¶ˆè´¹ã€‚"))])]),s[12]||(s[12]=t(`<p>å‹æƒ…æç¤ºï¼šæˆ‘å¯¹æ¶ˆæ¯é˜Ÿåˆ—ä¸äº†è§£ï¼Œæ€ä¹ˆåŠï¼Ÿ</p><p>â‘  é¡¹ç›®ä¸»è¦ä½¿ç”¨ RocketMQ ä½œä¸ºæ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ‰€ä»¥å¯ä»¥å­¦ä¹ ä¸‹æ–‡ç« ï¼š</p><ul><li><a href="https://www.iocoder.cn/Spring-Cloud-Alibaba/RocketMQ/?yudao" target="_blank" rel="noopener noreferrer">ã€ŠèŠ‹é“ Spring Cloud Alibaba æ¶ˆæ¯é˜Ÿåˆ— RocketMQ å…¥é—¨ã€‹</a></li><li><a href="https://www.iocoder.cn/Spring-Cloud-Alibaba/Bus-RocketMQ/?yudao" target="_blank" rel="noopener noreferrer">ã€ŠèŠ‹é“ Spring Cloud Alibaba äº‹ä»¶æ€»çº¿ Bus RocketMQ å…¥é—¨ã€‹</a></li></ul><p>â‘¡ å¦‚æœä½ æƒ³æ›¿æ¢ä½¿ç”¨ Kafka æˆ–è€… RabbitMQï¼Œå¯ä»¥å‚è€ƒä¸‹æ–‡ç« ï¼š</p><ul><li><a href="https://www.iocoder.cn/Spring-Cloud/Kafka/?yudao" target="_blank" rel="noopener noreferrer">ã€ŠèŠ‹é“ Spring Cloud æ¶ˆæ¯é˜Ÿåˆ— Kafka å…¥é—¨ ã€‹</a></li><li><a href="https://www.iocoder.cn/Spring-Cloud/Bus-Kafka/?yudao" target="_blank" rel="noopener noreferrer">ã€ŠèŠ‹é“ Spring Cloud äº‹ä»¶æ€»çº¿ Bus Kafka å…¥é—¨ã€‹</a></li><li><a href="https://www.iocoder.cn/Spring-Cloud/RabbitMQ/?yudao" target="_blank" rel="noopener noreferrer">ã€ŠèŠ‹é“ Spring Cloud æ¶ˆæ¯é˜Ÿåˆ— RabbitMQ å…¥é—¨ ã€‹</a></li><li><a href="https://www.iocoder.cn/Spring-Cloud/Bus-RabbitMQ/?yudao" target="_blank" rel="noopener noreferrer">ã€ŠèŠ‹é“ Spring Cloud äº‹ä»¶æ€»çº¿ Bus RabbitMQ å…¥é—¨ã€‹</a></li></ul><h2 id="_1-é›†ç¾¤æ¶ˆè´¹" tabindex="-1"><a class="header-anchor" href="#_1-é›†ç¾¤æ¶ˆè´¹"><span><a href="#_1-%E9%9B%86%E7%BE%A4%E6%B6%88%E8%B4%B9">#</a> 1. é›†ç¾¤æ¶ˆè´¹</span></a></h2><p>é›†ç¾¤æ¶ˆè´¹ï¼Œæ˜¯æŒ‡æ¶ˆæ¯å‘é€åˆ° RocketMQ æ—¶ï¼Œæœ‰ä¸”åªä¼šè¢«ä¸€ä¸ªæ¶ˆè´¹è€…ï¼ˆåº”ç”¨ JVM å®ä¾‹ï¼‰æ”¶åˆ°ï¼Œç„¶åæ¶ˆè´¹æˆåŠŸã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><figure><img src="https://cloud.iocoder.cn/img/æ¶ˆæ¯é˜Ÿåˆ—/01-cloud.png" alt="é›†ç¾¤æ¶ˆè´¹" tabindex="0" loading="lazy"><figcaption>é›†ç¾¤æ¶ˆè´¹</figcaption></figure><h3 id="_1-1-ä½¿ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#_1-1-ä½¿ç”¨åœºæ™¯"><span><a href="#_1-1-%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF">#</a> 1.1 ä½¿ç”¨åœºæ™¯</span></a></h3><p>é›†ç¾¤æ¶ˆè´¹åœ¨é¡¹ç›®ä¸­çš„ä½¿ç”¨åœºæ™¯ï¼Œä¸»è¦æ˜¯æä¾›å¯é çš„ã€å¯å †ç§¯çš„å¼‚æ­¥ä»»åŠ¡çš„èƒ½åŠ›ã€‚ä¾‹å¦‚è¯´ï¼š</p><ul><li>çŸ­ä¿¡æ¨¡å—ï¼Œä½¿ç”¨å®ƒ<a href="https://github.com/YunaiV/yudao-cloud/blob/master/yudao-module-system/yudao-module-system-biz/src/main/java/cn/iocoder/yudao/module/system/mq/consumer/sms/SmsSendConsumer.java" target="_blank" rel="noopener noreferrer">å¼‚æ­¥</a>å‘é€çŸ­ä¿¡ã€‚</li><li>é‚®ä»¶æ¨¡å—ï¼Œä½¿ç”¨å®ƒ<a href="https://github.com/YunaiV/yudao-cloud/blob/master/yudao-module-system/yudao-module-system-biz/src/main/java/cn/iocoder/yudao/module/system/mq/consumer/mail/MailSendConsumer.java" target="_blank" rel="noopener noreferrer">å¼‚æ­¥</a>å‘é€é‚®ä»¶ã€‚</li></ul><p>ç›¸æ¯” <a href="/async-task">ã€Šå¼€å‘æŒ‡å— â€”â€” å¼‚æ­¥ä»»åŠ¡ã€‹</a> æ¥è¯´ï¼ŒSpring Async åœ¨ JVM å®ä¾‹é‡å¯æ—¶ï¼Œä¼šå¯¼è‡´æœªæ‰§è¡Œå®Œçš„ä»»åŠ¡ä¸¢å¤±ã€‚è€Œé›†ç¾¤æ¶ˆè´¹ï¼Œå› ä¸ºæ¶ˆæ¯æ˜¯å­˜å‚¨åœ¨ RocketMQ ä¸­ï¼Œæ‰€ä»¥ä¸ä¼šå­˜åœ¨è¯¥é—®é¢˜ã€‚</p><h3 id="_1-2-å®æˆ˜æ¡ˆä¾‹" tabindex="-1"><a class="header-anchor" href="#_1-2-å®æˆ˜æ¡ˆä¾‹"><span><a href="#_1-2-%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B">#</a> 1.2 å®æˆ˜æ¡ˆä¾‹</span></a></h3><p>ä»¥çŸ­ä¿¡æ¨¡å—å¼‚æ­¥å‘é€çŸ­æ¯ä¸ºä¾‹å­ï¼Œè®²è§£é›†ç¾¤æ¶ˆè´¹çš„ä½¿ç”¨ã€‚</p><figure><img src="https://cloud.iocoder.cn/img/æ¶ˆæ¯é˜Ÿåˆ—/06-cloud.png" alt="å®æˆ˜æ¡ˆä¾‹" tabindex="0" loading="lazy"><figcaption>å®æˆ˜æ¡ˆä¾‹</figcaption></figure><h4 id="_1-3-1-å¼•å…¥ä¾èµ–" tabindex="-1"><a class="header-anchor" href="#_1-3-1-å¼•å…¥ä¾èµ–"><span><a href="#_1-3-1-%E5%BC%95%E5%85%A5%E4%BE%9D%E8%B5%96">#</a> 1.3.1 å¼•å…¥ä¾èµ–</span></a></h4><p>åœ¨ <code>yudao-module-system-biz</code> æ¨¡å—çš„ <a href="https://github.com/YunaiV/yudao-cloud/blob/master/yudao-module-system/yudao-module-system-biz/pom.xml" target="_blank" rel="noopener noreferrer"><code>pom.xml</code></a> ä¸­ï¼Œå¼•å…¥ <code>yudao-spring-boot-starter-mq</code> æŠ€æœ¯ç»„ä»¶ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span>&lt;!-- æ¶ˆæ¯é˜Ÿåˆ—ç›¸å…³ --&gt;</span></span>
<span class="line"><span>&lt;dependency&gt;</span></span>
<span class="line"><span>    &lt;groupId&gt;cn.iocoder.cloud&lt;/groupId&gt;</span></span>
<span class="line"><span>    &lt;artifactId&gt;yudao-spring-boot-starter-mq&lt;/artifactId&gt;</span></span>
<span class="line"><span>&lt;/dependency&gt;</span></span></code></pre></div><h4 id="_1-3-2-æ·»åŠ é…ç½®" tabindex="-1"><a class="header-anchor" href="#_1-3-2-æ·»åŠ é…ç½®"><span><a href="#_1-3-2-%E6%B7%BB%E5%8A%A0%E9%85%8D%E7%BD%AE">#</a> 1.3.2 æ·»åŠ é…ç½®</span></a></h4><p>â‘  åœ¨ <a href="https://github.com/YunaiV/yudao-cloud/blob/master/yudao-module-system/yudao-module-system-biz/src/main/resources/application.yaml#L55-L78" target="_blank" rel="noopener noreferrer"><code>application.yaml</code></a> ä¸­ï¼Œæ·»åŠ  <code>spring.cloud.stream</code> é…ç½®ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span>--- #################### MQ æ¶ˆæ¯é˜Ÿåˆ—ç›¸å…³é…ç½® ####################</span></span>
<span class="line"><span></span></span>
<span class="line"><span>spring:</span></span>
<span class="line"><span>  cloud:</span></span>
<span class="line"><span>    # Spring Cloud Stream é…ç½®é¡¹ï¼Œå¯¹åº” BindingServiceProperties ç±»</span></span>
<span class="line"><span>    stream:</span></span>
<span class="line"><span>      function:</span></span>
<span class="line"><span>        definition: smsSendConsumer;</span></span>
<span class="line"><span>      # Binding é…ç½®é¡¹ï¼Œå¯¹åº” BindingProperties Map</span></span>
<span class="line"><span>      bindings:</span></span>
<span class="line"><span>        smsSend-out-0:</span></span>
<span class="line"><span>          destination: system_sms_send</span></span>
<span class="line"><span>        smsSendConsumer-in-0:</span></span>
<span class="line"><span>          destination: system_sms_send</span></span>
<span class="line"><span>          group: system_sms_send_consumer_group</span></span>
<span class="line"><span>      # Spring Cloud Stream RocketMQ é…ç½®é¡¹</span></span>
<span class="line"><span>      rocketmq:</span></span>
<span class="line"><span>        default: # é»˜è®¤ bindings å…¨å±€é…ç½®</span></span>
<span class="line"><span>          producer: # RocketMQ Producer é…ç½®é¡¹ï¼Œå¯¹åº” RocketMQProducerProperties ç±»</span></span>
<span class="line"><span>            group: system_producer_group # ç”Ÿäº§è€…åˆ†ç»„</span></span>
<span class="line"><span>            send-type: SYNC # å‘é€æ¨¡å¼ï¼ŒSYNC åŒæ­¥</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æ³¨æ„ï¼Œå¸¦æœ‰ <code>sms</code> å…³é”®å­—çš„ï¼Œéƒ½æ˜¯å’ŒçŸ­ä¿¡å‘é€ç›¸å…³çš„é…ç½®ã€‚</li></ul><p>â‘¡ åœ¨ <a href="https://github.com/YunaiV/yudao-cloud/blob/master/yudao-module-system/yudao-module-system-biz/src/main/resources/application-local.yaml#L71-L78" target="_blank" rel="noopener noreferrer"><code>application-local.yaml</code></a> ä¸­ï¼Œæ·»åŠ  <code>spring.cloud.stream</code> é…ç½®ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span>--- #################### MQ æ¶ˆæ¯é˜Ÿåˆ—ç›¸å…³é…ç½® ####################</span></span>
<span class="line"><span>spring:</span></span>
<span class="line"><span>  cloud:</span></span>
<span class="line"><span>    stream:</span></span>
<span class="line"><span>      rocketmq:</span></span>
<span class="line"><span>        # RocketMQ Binder é…ç½®é¡¹ï¼Œå¯¹åº” RocketMQBinderConfigurationProperties ç±»</span></span>
<span class="line"><span>        binder:</span></span>
<span class="line"><span>          name-server: 127.0.0.1:9876 # RocketMQ Namesrv åœ°å€</span></span></code></pre></div><h4 id="_1-3-3-smssendmessage" tabindex="-1"><a class="header-anchor" href="#_1-3-3-smssendmessage"><span><a href="#_1-3-3-smssendmessage">#</a> 1.3.3 SmsSendMessage</span></a></h4><p>åœ¨ <code>yudao-module-system-biz</code> çš„ <a href="https://github.com/YunaiV/yudao-cloud/blob/master/yudao-module-system/yudao-module-system-biz/src/main/java/cn/iocoder/yudao/module/system/mq/message/sms/" target="_blank" rel="noopener noreferrer"><code>mq/message/sms</code></a> åŒ…ä¸‹ï¼Œåˆ›å»º <a href="https://github.com/YunaiV/yudao-cloud/blob/master/yudao-module-system/yudao-module-system-biz/src/main/java/cn/iocoder/yudao/module/system/mq/message/sms/SmsSendMessage.java" target="_blank" rel="noopener noreferrer">SmsSendMessage</a> ç±»ï¼ŒçŸ­ä¿¡å‘é€æ¶ˆæ¯ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span>@Data</span></span>
<span class="line"><span>public class SmsSendMessage {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /**</span></span>
<span class="line"><span>     * çŸ­ä¿¡æ—¥å¿—ç¼–å·</span></span>
<span class="line"><span>     */</span></span>
<span class="line"><span>    @NotNull(message = &quot;çŸ­ä¿¡æ—¥å¿—ç¼–å·ä¸èƒ½ä¸ºç©º&quot;)</span></span>
<span class="line"><span>    private Long logId;</span></span>
<span class="line"><span>    /**</span></span>
<span class="line"><span>     * æ‰‹æœºå·</span></span>
<span class="line"><span>     */</span></span>
<span class="line"><span>    @NotNull(message = &quot;æ‰‹æœºå·ä¸èƒ½ä¸ºç©º&quot;)</span></span>
<span class="line"><span>    private String mobile;</span></span>
<span class="line"><span>    /**</span></span>
<span class="line"><span>     * çŸ­ä¿¡æ¸ é“ç¼–å·</span></span>
<span class="line"><span>     */</span></span>
<span class="line"><span>    @NotNull(message = &quot;çŸ­ä¿¡æ¸ é“ç¼–å·ä¸èƒ½ä¸ºç©º&quot;)</span></span>
<span class="line"><span>    private Long channelId;</span></span>
<span class="line"><span>    /**</span></span>
<span class="line"><span>     * çŸ­ä¿¡ API çš„æ¨¡æ¿ç¼–å·</span></span>
<span class="line"><span>     */</span></span>
<span class="line"><span>    @NotNull(message = &quot;çŸ­ä¿¡ API çš„æ¨¡æ¿ç¼–å·ä¸èƒ½ä¸ºç©º&quot;)</span></span>
<span class="line"><span>    private String apiTemplateId;</span></span>
<span class="line"><span>    /**</span></span>
<span class="line"><span>     * çŸ­ä¿¡æ¨¡æ¿å‚æ•°</span></span>
<span class="line"><span>     */</span></span>
<span class="line"><span>    private List&lt;KeyValue&lt;String, Object&gt;&gt; templateParams;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_1-3-4-smsproducer" tabindex="-1"><a class="header-anchor" href="#_1-3-4-smsproducer"><span><a href="#_1-3-4-smsproducer">#</a> 1.3.4 SmsProducer</span></a></h4><p>â‘  åœ¨ <code>yudao-module-system-biz</code> çš„ <a href="https://github.com/YunaiV/yudao-cloud/blob/master/yudao-module-system/yudao-module-system-biz/src/main/java/cn/iocoder/yudao/module/system/mq/producer/sms/" target="_blank" rel="noopener noreferrer"><code>mq/producer/sms</code></a> åŒ…ä¸‹ï¼Œåˆ›å»º <a href="https://github.com/YunaiV/yudao-cloud/blob/master/yudao-module-system/yudao-module-system-biz/src/main/java/cn/iocoder/yudao/module/system/mq/producer/sms/SmsProducer.java" target="_blank" rel="noopener noreferrer">SmsProducer</a> ç±»ï¼ŒSmsSendMessage çš„ Producer ç”Ÿäº§è€…ï¼Œæ ¸å¿ƒæ˜¯ä½¿ç”¨ StreamBridge å‘é€ SmsSendMessage æ¶ˆæ¯ã€‚ä»£ç å¦‚ä¸‹å›¾ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span>@Component</span></span>
<span class="line"><span>public class SmsProducer {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    @Resource</span></span>
<span class="line"><span>    private StreamBridge streamBridge;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /**</span></span>
<span class="line"><span>     * å‘é€ {@link SmsSendMessage} æ¶ˆæ¯</span></span>
<span class="line"><span>     *</span></span>
<span class="line"><span>     * @param logId çŸ­ä¿¡æ—¥å¿—ç¼–å·</span></span>
<span class="line"><span>     * @param mobile æ‰‹æœºå·</span></span>
<span class="line"><span>     * @param channelId æ¸ é“ç¼–å·</span></span>
<span class="line"><span>     * @param apiTemplateId çŸ­ä¿¡æ¨¡æ¿ç¼–å·</span></span>
<span class="line"><span>     * @param templateParams çŸ­ä¿¡æ¨¡æ¿å‚æ•°</span></span>
<span class="line"><span>     */</span></span>
<span class="line"><span>    public void sendSmsSendMessage(Long logId, String mobile,</span></span>
<span class="line"><span>                                   Long channelId, String apiTemplateId, List&lt;KeyValue&lt;String, Object&gt;&gt; templateParams) {</span></span>
<span class="line"><span>        SmsSendMessage message = new SmsSendMessage().setLogId(logId).setMobile(mobile);</span></span>
<span class="line"><span>        message.setChannelId(channelId).setApiTemplateId(apiTemplateId).setTemplateParams(templateParams);</span></span>
<span class="line"><span>        streamBridge.send(&quot;smsSend-out-0&quot;, message);</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æ³¨æ„ï¼Œè¿™é‡Œçš„ <code>smsSend-out-0</code> å’Œä¸Šè¿°çš„é…ç½®æ–‡ä»¶æ˜¯å¯¹åº”çš„å™¢ã€‚</li></ul><p>â‘¡ å‘é€çŸ­ä¿¡æ—¶ï¼Œéœ€è¦ä½¿ç”¨ SmsProducer å‘é€æ¶ˆæ¯ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><figure><img src="https://cloud.iocoder.cn/img/æ¶ˆæ¯é˜Ÿåˆ—/05.png" alt="è°ƒç”¨ SmsProducer ç¤ºä¾‹" tabindex="0" loading="lazy"><figcaption>è°ƒç”¨ SmsProducer ç¤ºä¾‹</figcaption></figure><h4 id="_1-3-4-smssendconsumer" tabindex="-1"><a class="header-anchor" href="#_1-3-4-smssendconsumer"><span><a href="#_1-3-4-smssendconsumer">#</a> 1.3.4 SmsSendConsumer</span></a></h4><p>åœ¨ <code>yudao-module-system-biz</code> çš„ <a href="https://github.com/YunaiV/yudao-cloud/blob/master/yudao-module-system/yudao-module-system-biz/src/main/java/cn/iocoder/yudao/module/system/mq/consumer/sms/" target="_blank" rel="noopener noreferrer"><code>mq/consumer/sms</code></a> åŒ…ä¸‹ï¼Œåˆ›å»º <a href="https://github.com/YunaiV/yudao-cloud/blob/master/yudao-module-system/yudao-module-system-biz/src/main/java/cn/iocoder/yudao/module/system/mq/consumer/sms/SmsSendConsumer.java" target="_blank" rel="noopener noreferrer">SmsSendConsumer</a> ç±»ï¼ŒSmsSendMessage çš„ Consumer æ¶ˆè´¹è€…ã€‚ä»£ç å¦‚ä¸‹å›¾ï¼š</p><div class="language-" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span>@Component</span></span>
<span class="line"><span>@Slf4j</span></span>
<span class="line"><span>public class SmsSendConsumer implements Consumer&lt;SmsSendMessage&gt; {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    @Resource</span></span>
<span class="line"><span>    private SmsSendService smsSendService;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    @Override</span></span>
<span class="line"><span>    public void accept(SmsSendMessage message) {</span></span>
<span class="line"><span>        log.info(&quot;[accept][æ¶ˆæ¯å†…å®¹({})]&quot;, message);</span></span>
<span class="line"><span>        smsSendService.doSendSms(message);</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>}</span></span></code></pre></div><h2 id="_2-å¹¿æ’­æ¶ˆè´¹" tabindex="-1"><a class="header-anchor" href="#_2-å¹¿æ’­æ¶ˆè´¹"><span><a href="#_2-%E5%B9%BF%E6%92%AD%E6%B6%88%E8%B4%B9">#</a> 2. å¹¿æ’­æ¶ˆè´¹</span></a></h2><p>å¹¿æ’­æ¶ˆè´¹ï¼Œæ˜¯æŒ‡æ¶ˆæ¯å‘é€åˆ° RocketMQ æ—¶ï¼Œæ‰€æœ‰æ¶ˆè´¹è€…ï¼ˆåº”ç”¨ JVM å®ä¾‹ï¼‰æ”¶åˆ°ï¼Œç„¶åæ¶ˆè´¹æˆåŠŸã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><figure><img src="https://cloud.iocoder.cn/img/æ¶ˆæ¯é˜Ÿåˆ—/11-cloud.png" alt="é›†ç¾¤æ¶ˆè´¹" tabindex="0" loading="lazy"><figcaption>é›†ç¾¤æ¶ˆè´¹</figcaption></figure><h3 id="_2-1-ä½¿ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#_2-1-ä½¿ç”¨åœºæ™¯"><span><a href="#_2-1-%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF">#</a> 2.1 ä½¿ç”¨åœºæ™¯</span></a></h3><p>ä¾‹å¦‚è¯´ï¼Œåœ¨åº”ç”¨ä¸­ï¼Œç¼“å­˜äº†æ•°æ®å­—å…¸ç­‰é…ç½®è¡¨åœ¨å†…å­˜ä¸­ï¼Œå¯ä»¥é€šè¿‡ RocketMQ å¹¿æ’­æ¶ˆè´¹ï¼Œå®ç°æ¯ä¸ªåº”ç”¨èŠ‚ç‚¹éƒ½æ¶ˆè´¹æ¶ˆæ¯ï¼Œåˆ·æ–°æœ¬åœ°å†…å­˜çš„ç¼“å­˜ã€‚</p><p>åˆä¾‹å¦‚è¯´ï¼Œæˆ‘ä»¬åŸºäº WebSocket å®ç°äº† IM èŠå¤©ï¼Œåœ¨æˆ‘ä»¬ç»™ç”¨æˆ·ä¸»åŠ¨å‘é€æ¶ˆæ¯æ—¶ï¼Œå› ä¸ºæˆ‘ä»¬ä¸çŸ¥é“ç”¨æˆ·è¿æ¥çš„æ˜¯å“ªä¸ªæä¾› WebSocket çš„åº”ç”¨ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ RocketMQ å¹¿æ’­æ¶ˆè´¹ã€‚æ¯ä¸ªåº”ç”¨åˆ¤æ–­å½“å‰ç”¨æˆ·æ˜¯å¦æ˜¯å’Œè‡ªå·±æä¾›çš„ WebSocket æœåŠ¡è¿æ¥ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™æ¨é€æ¶ˆæ¯ç»™ç”¨æˆ·ã€‚</p><h3 id="_2-2-ä½¿ç”¨æ–¹å¼ä¸€-bus" tabindex="-1"><a class="header-anchor" href="#_2-2-ä½¿ç”¨æ–¹å¼ä¸€-bus"><span><a href="#_2-2-%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F%E4%B8%80-bus">#</a> 2.2 ä½¿ç”¨æ–¹å¼ä¸€ï¼šBus</span></a></h3><p>åŸºäº RocketMQ çš„å¹¿æ’­æ¶ˆè´¹ï¼Œå¯ä»¥ä½¿ç”¨ Spring Cloud Bus å®ç°ã€‚</p><p>Spring Cloud Bus æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>Spring Cloud Bus æ˜¯ Spring Cloud çš„ä¸€ä¸ªå­é¡¹ç›®ï¼Œå®ƒçš„ä½œç”¨æ˜¯å°†åˆ†å¸ƒå¼ç³»ç»Ÿçš„èŠ‚ç‚¹ä¸è½»é‡çº§æ¶ˆæ¯ç³»ç»Ÿé“¾æ¥èµ·æ¥ï¼Œç”¨äºå¹¿æ’­çŠ¶æ€å˜åŒ–ï¼Œäº‹ä»¶æ¨é€ç­‰ã€‚</p><p>å®ƒçš„å®ç°åŸç†æ˜¯ï¼Œé€šè¿‡ Spring Cloud Stream å°†æ¶ˆæ¯å‘é€åˆ°æ¶ˆæ¯ä»£ç†ï¼ˆå¦‚ RabbitMQã€Kafkaã€RocketMQï¼‰ï¼Œç„¶åé€šè¿‡ Spring Cloud Bus çš„äº‹ä»¶ç›‘å¬ï¼Œç›‘å¬åˆ°æ¶ˆæ¯åï¼Œè¿›è¡Œå¤„ç†ã€‚</p><p>ä»¥è§’è‰²çš„æœ¬åœ°ç¼“å­˜åˆ·æ–°ä¸ºä¾‹å­ï¼Œè®²è§£ä¸‹ Spring Cloud Bus å¦‚ä½•ä½¿ç”¨ RocketMQ å¹¿æ’­æ¶ˆè´¹ã€‚</p><h4 id="_2-2-1-å¼•å…¥ä¾èµ–" tabindex="-1"><a class="header-anchor" href="#_2-2-1-å¼•å…¥ä¾èµ–"><span><a href="#_2-2-1-%E5%BC%95%E5%85%A5%E4%BE%9D%E8%B5%96">#</a> 2.2.1 å¼•å…¥ä¾èµ–</span></a></h4><p>åœ¨ <code>yudao-module-system-biz</code> æ¨¡å—çš„ <a href="https://github.com/YunaiV/yudao-cloud/blob/master/yudao-module-system/yudao-module-system-biz/pom.xml" target="_blank" rel="noopener noreferrer"><code>pom.xml</code></a> ä¸­ï¼Œå¼•å…¥ <code>yudao-spring-boot-starter-mq</code> æŠ€æœ¯ç»„ä»¶ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span>&lt;!-- æ¶ˆæ¯é˜Ÿåˆ—ç›¸å…³ --&gt;</span></span>
<span class="line"><span>&lt;dependency&gt;</span></span>
<span class="line"><span>    &lt;groupId&gt;cn.iocoder.cloud&lt;/groupId&gt;</span></span>
<span class="line"><span>    &lt;artifactId&gt;yudao-spring-boot-starter-mq&lt;/artifactId&gt;</span></span>
<span class="line"><span>&lt;/dependency&gt;</span></span></code></pre></div><h4 id="_2-2-2-æ·»åŠ é…ç½®" tabindex="-1"><a class="header-anchor" href="#_2-2-2-æ·»åŠ é…ç½®"><span><a href="#_2-2-2-%E6%B7%BB%E5%8A%A0%E9%85%8D%E7%BD%AE">#</a> 2.2.2 æ·»åŠ é…ç½®</span></a></h4><p>åœ¨ <a href="https://github.com/YunaiV/yudao-cloud/blob/master/yudao-module-system/yudao-module-system-biz/src/main/resources/application.yaml#L80-L84" target="_blank" rel="noopener noreferrer"><code>application.yaml</code></a> ä¸­ï¼Œæ·»åŠ  <code>spring.cloud.bus</code> é…ç½®ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span>spring:</span></span>
<span class="line"><span>  cloud:</span></span>
<span class="line"><span>    # Spring Cloud Bus é…ç½®é¡¹ï¼Œå¯¹åº” BusProperties ç±»</span></span>
<span class="line"><span>    bus:</span></span>
<span class="line"><span>      enabled: true # æ˜¯å¦å¼€å¯ï¼Œé»˜è®¤ä¸º true</span></span>
<span class="line"><span>      id: \${spring.application.name}:\${server.port} # ç¼–å·ï¼ŒSpring Cloud Alibaba å»ºè®®ä½¿ç”¨â€œåº”ç”¨:ç«¯å£â€çš„æ ¼å¼</span></span>
<span class="line"><span>      destination: springCloudBus # ç›®æ ‡æ¶ˆæ¯é˜Ÿåˆ—ï¼Œé»˜è®¤ä¸º springCloudBus</span></span></code></pre></div><h4 id="_2-2-3-ç¼–å†™ä»£ç " tabindex="-1"><a class="header-anchor" href="#_2-2-3-ç¼–å†™ä»£ç "><span><a href="#_2-2-3-%E7%BC%96%E5%86%99%E4%BB%A3%E7%A0%81">#</a> 2.2.3 ç¼–å†™ä»£ç </span></a></h4><p>å‚è§ <a href="/local-cache">ã€Šå¼€å‘æŒ‡å— â€”â€” æœ¬åœ°ç¼“å­˜ã€‹</a> æ–‡ç« çš„ã€Œ3. å®æ—¶åˆ·æ–°ç¼“å­˜ã€å°èŠ‚ã€‚</p><h3 id="_2-2-ä½¿ç”¨æ–¹å¼äºŒ-stream" tabindex="-1"><a class="header-anchor" href="#_2-2-ä½¿ç”¨æ–¹å¼äºŒ-stream"><span><a href="#_2-2-%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F%E4%BA%8C-stream">#</a> 2.2 ä½¿ç”¨æ–¹å¼äºŒï¼šStream</span></a></h3><p>åŸºäº RocketMQ çš„å¹¿æ’­æ¶ˆè´¹ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ Spring Cloud Stream å®ç°ã€‚</p><p>Spring Cloud Stream æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>Spring Cloud Stream æ˜¯ Spring Cloud çš„ä¸€ä¸ªå­é¡¹ç›®ï¼Œå®ƒçš„ä½œç”¨æ˜¯ä¸ºå¾®æœåŠ¡åº”ç”¨æ„å»ºæ¶ˆæ¯é©±åŠ¨èƒ½åŠ›ã€‚</p><p>ä½¿ç”¨æ–¹å¼ï¼Œå’Œã€Œ1.2 å®æˆ˜æ¡ˆä¾‹ã€å°èŠ‚æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯éœ€è¦åœ¨ <code>application.yaml</code> é…ç½®æ–‡ä»¶ä¸­ï¼Œæ·»åŠ  <a href="https://github.com/alibaba/spring-cloud-alibaba/wiki/RocketMQ#rocketmq-consumer-properties" target="_blank" rel="noopener noreferrer"><code>spring.cloud.stream.rocketmq.bindings.&lt;channelName&gt;.consumer.broadcasting</code></a> é…ç½®é¡¹ä¸º <code>true</code>ã€‚</p><p>ç”±äºé¡¹ç›®ä¸­æš‚æ—¶ä½¿ç”¨è¯¥æ–¹å¼ï¼Œæ–‡æ¡£åç»­è¡¥å……ã€‚</p>`,62))])}const g=p(c,[["render",u],["__file","cloud.html.vue"]]),h=JSON.parse('{"path":"/project/yudao-cloud/message-queue/cloud.html","title":"æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆCloudï¼‰","lang":"en-US","frontmatter":{"title":"æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆCloudï¼‰","tags":["project","java","spring-boot","spring-cloud"],"categories":["project"],"order":61,"feed":false,"seo":false,"head":[]},"headers":[{"level":2,"title":"# 1. é›†ç¾¤æ¶ˆè´¹","slug":"_1-é›†ç¾¤æ¶ˆè´¹","link":"#_1-é›†ç¾¤æ¶ˆè´¹","children":[{"level":3,"title":"# 1.1 ä½¿ç”¨åœºæ™¯","slug":"_1-1-ä½¿ç”¨åœºæ™¯","link":"#_1-1-ä½¿ç”¨åœºæ™¯","children":[]},{"level":3,"title":"# 1.2 å®æˆ˜æ¡ˆä¾‹","slug":"_1-2-å®æˆ˜æ¡ˆä¾‹","link":"#_1-2-å®æˆ˜æ¡ˆä¾‹","children":[]}]},{"level":2,"title":"# 2. å¹¿æ’­æ¶ˆè´¹","slug":"_2-å¹¿æ’­æ¶ˆè´¹","link":"#_2-å¹¿æ’­æ¶ˆè´¹","children":[{"level":3,"title":"# 2.1 ä½¿ç”¨åœºæ™¯","slug":"_2-1-ä½¿ç”¨åœºæ™¯","link":"#_2-1-ä½¿ç”¨åœºæ™¯","children":[]},{"level":3,"title":"# 2.2 ä½¿ç”¨æ–¹å¼ä¸€ï¼šBus","slug":"_2-2-ä½¿ç”¨æ–¹å¼ä¸€-bus","link":"#_2-2-ä½¿ç”¨æ–¹å¼ä¸€-bus","children":[]},{"level":3,"title":"# 2.2 ä½¿ç”¨æ–¹å¼äºŒï¼šStream","slug":"_2-2-ä½¿ç”¨æ–¹å¼äºŒ-stream","link":"#_2-2-ä½¿ç”¨æ–¹å¼äºŒ-stream","children":[]}]}],"git":{"createdTime":1720365235000,"updatedTime":1720365235000,"contributors":[{"name":"Hung Nguyen Van","email":"vanhung4499@gmail.com","commits":1}]},"readingTime":{"minutes":6.63,"words":1989},"filePathRelative":"project/yudao-cloud/message-queue/cloud.md","localizedDate":"July 7, 2024"}');export{g as comp,h as data};
