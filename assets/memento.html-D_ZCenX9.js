import{_ as n,o as s,c as a,d as i}from"./app-BG8AAbz2.js";const t={},e=i(`<h2 id="y-nghia" tabindex="-1"><a class="header-anchor" href="#y-nghia"><span>Ý nghĩa</span></a></h2><p><strong>Memento Pattern</strong> là một mẫu thiết kế hành vi, cho phép lưu và khôi phục trạng thái trước đó của đối tượng mà không tiết lộ chi tiết cài đặt của đối tượng.</p><h2 id="cac-truong-hop-su-dung" tabindex="-1"><a class="header-anchor" href="#cac-truong-hop-su-dung"><span>Các trường hợp sử dụng</span></a></h2><ul><li>Khi bạn cần tạo bản sao trạng thái của đối tượng để khôi phục trạng thái trước đó.</li><li>Khi truy cập trực tiếp vào biến thành viên, truy cập getter hoặc setter của đối tượng sẽ phá vỡ tính đóng gói, bạn có thể sử dụng Memento Pattern.</li></ul><h2 id="cau-truc" tabindex="-1"><a class="header-anchor" href="#cau-truc"><span>Cấu trúc</span></a></h2><h3 id="mo-ta-cau-truc" tabindex="-1"><a class="header-anchor" href="#mo-ta-cau-truc"><span>Mô tả cấu trúc</span></a></h3><h4 id="cai-đat-dua-tren-lop-long-nhau" tabindex="-1"><a class="header-anchor" href="#cai-đat-dua-tren-lop-long-nhau"><span>Cài đặt dựa trên lớp lồng nhau</span></a></h4><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20210520172952.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><ol><li><strong>Người khởi tạo</strong> (Originator) có thể tạo ra bản sao trạng thái của chính nó và khôi phục trạng thái từ bản sao.</li><li><strong>Bản ghi nhớ</strong> (Memento) là một đối tượng giá trị (value object) lưu trạng thái của nguyên tố. Thông thường, một cách tiếp cận là làm cho Memento không thể thay đổi và truyền dữ liệu thông qua constructor.</li><li><strong>Người chăm sóc</strong> (Caretaker) chỉ biết &quot;khi nào&quot; và &quot;tại sao&quot; lưu trạng thái của nguyên tố và khi nào khôi phục trạng thái.<br> Người chăm sóc ghi lại lịch sử trạng thái của nguyên tố bằng cách lưu trữ Memento trong một ngăn xếp. Khi nguyên tố cần quay lại trạng thái trước đó, người chăm sóc sẽ lấy Memento trên cùng của ngăn xếp và truyền nó cho phương thức khôi phục của nguyên tố.</li><li>Trong cách triển khai này, lớp Memento được lồng vào trong nguyên tố. Điều này cho phép nguyên tố truy cập biến thành viên và phương thức của Memento, ngay cả khi chúng được khai báo là riêng tư. Tuy nhiên, người chăm sóc chỉ có quyền truy cập hạn chế đến biến thành viên và phương thức của Memento: chỉ có thể lưu trữ Memento trong ngăn xếp, không thể thay đổi trạng thái của nó.</li></ol><h4 id="cai-đat-dua-tren-giao-dien-trung-gian" tabindex="-1"><a class="header-anchor" href="#cai-đat-dua-tren-giao-dien-trung-gian"><span>Cài đặt dựa trên giao diện trung gian</span></a></h4><p>Phương pháp triển khai khác phù hợp với các ngôn ngữ lập trình không hỗ trợ lớp lồng nhau (ví dụ: PHP).</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20210520173029.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><ol><li>Trong trường hợp không có lớp lồng nhau, bạn có thể quy định người chăm sóc chỉ có thể tương tác với Memento thông qua giao diện trung gian được khai báo rõ ràng, giao diện chỉ khai báo các phương thức liên quan đến dữ liệu siêu dữ liệu của Memento, giới hạn quyền truy cập trực tiếp vào biến thành viên của Memento.</li><li>Ngược lại, nguyên tố có thể tương tác trực tiếp với đối tượng Memento, truy cập biến thành viên và phương thức được khai báo trong lớp Memento. Nhược điểm của phương pháp này là bạn cần khai báo tất cả các biến thành viên của Memento là công khai.</li></ol><h4 id="cai-đat-nghiem-ngat-hon" tabindex="-1"><a class="header-anchor" href="#cai-đat-nghiem-ngat-hon"><span>Cài đặt nghiêm ngặt hơn</span></a></h4><p>Nếu bạn không muốn cho phép bất kỳ lớp nào khác có cơ hội truy cập vào trạng thái của nguyên tố thông qua Memento, còn một cách triển khai khác có sẵn.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20210520173117.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><ol><li>Cách triển khai này cho phép tồn tại nhiều loại nguyên tố và Memento khác nhau. Mỗi nguyên tố sẽ tương tác với lớp Memento tương ứng của nó. Nguyên tố và Memento đều không tiết lộ trạng thái của chúng cho các lớp khác.</li><li>Người chăm sóc bị cấm sửa đổi trạng thái được lưu trữ trong Memento. Tuy nhiên, lớp người chăm sóc sẽ độc lập với nguyên tố vì phương thức khôi phục được định nghĩa trong lớp Memento.</li><li>Mỗi Memento sẽ được kết nối với nguyên tố đã tạo ra nó. Nguyên tố sẽ chuyển đối tượng và trạng thái của chính nó cho constructor của Memento. Vì các lớp này có mối quan hệ chặt chẽ với nhau, chỉ cần nguyên tố định nghĩa các setter thích hợp, Memento có thể khôi phục trạng thái của nó.</li></ol><h3 id="mau-code-cau-truc" tabindex="-1"><a class="header-anchor" href="#mau-code-cau-truc"><span>Mẫu code cấu trúc</span></a></h3><p><strong>Memento</strong>: Đảm nhận việc lưu trữ trạng thái nội bộ của đối tượng Originator và ngăn chặn các đối tượng khác ngoài Originator truy cập vào Memento.</p><p>Memento có hai giao diện, Caretaker chỉ có thể nhìn thấy giao diện hẹp của Memento và chỉ có thể chuyển Memento cho các đối tượng khác.<br> Originator có thể nhìn thấy một giao diện rộng, cho phép nó truy cập vào tất cả dữ liệu cần thiết để trở lại trạng thái trước đó.</p><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Memento</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> state</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> Memento</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> state</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        this</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">state</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> state;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> GetState</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> state;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><p><strong>Originator</strong>: Đảm nhận việc tạo ra một Memento để ghi lại trạng thái nội bộ hiện tại của nó và có thể sử dụng Memento để khôi phục trạng thái nội bộ.</p><p>Originator có thể quyết định Memento lưu trữ những trạng thái nội bộ nào của Originator theo nhu cầu.</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Originator</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> state</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> SetState</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> state</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        this</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">state</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> state;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> GetState</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> state;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Memento</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> CreateMemento</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#C678DD;--shiki-dark:#C678DD;">new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> Memento</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(state));</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> SetMemento</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Memento</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> memento</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">        state </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> memento</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">GetState</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> Show</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        System</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">out</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">println</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;State = &quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> state);</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Caretaker</strong>: Đảm nhận việc lưu trữ Memento tốt, không thể thực hiện hoặc kiểm tra nội dung của Memento.</p><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Caretaker</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Memento</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> memento</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> SetMemento</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Memento</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> memento</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        this</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">memento</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> memento;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Memento</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> GetMemento</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> memento;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><p>Client</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> MementoPattern</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> static</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> main</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[] </span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;">args</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        Originator</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> o</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> Originator</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        o</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">SetState</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;ON&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        o</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Show</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        Caretaker</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> c</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> Caretaker</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        c</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">SetMemento</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">o</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">CreateMemento</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        o</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">SetState</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;OFF&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        o</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Show</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        o</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">SetMemento</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">c</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">GetMemento</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        o</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Show</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Output</p><div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span>State = ON</span></span>
<span class="line"><span>State = OFF</span></span>
<span class="line"><span>State = ON</span></span></code></pre></div><h2 id="pseudocode" tabindex="-1"><a class="header-anchor" href="#pseudocode"><span>Pseudocode</span></a></h2><p>Trong ví dụ này, kết hợp mẫu thiết kế Command và Memento để lưu trạng thái của một trình chỉnh sửa văn bản phức tạp và khôi phục trạng thái trước đó khi cần.</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20231006210505.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>Đối tượng Command sẽ đóng vai trò là người quản lý và sẽ lấy bản ghi Memento của trình chỉnh sửa trước khi thực hiện các hoạt động liên quan đến lệnh. Khi người dùng cố gắng hoàn tác lệnh gần nhất, trình chỉnh sửa có thể sử dụng Memento đã lưu trong lệnh để quay trở lại trạng thái trước đó.</p><p>Lớp Memento không khai báo bất kỳ biến thành viên công khai, getter hoặc setter nào, do đó không có đối tượng nào có thể thay đổi nội dung của nó. Memento được kết nối với trình chỉnh sửa cụ thể mà nó tạo ra, cho phép Memento truyền dữ liệu thông qua setter của đối tượng trình chỉnh sửa để khôi phục trạng thái của nó. Vì Memento được kết nối với đối tượng trình chỉnh sửa cụ thể, chương trình có thể hỗ trợ nhiều cửa sổ chỉnh sửa độc lập bằng cách sử dụng một ngăn xếp hoàn tác trung tâm.</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">// Trình chỉnh sửa chứa một số dữ liệu quan trọng có thể thay đổi theo thời gian. </span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">// Nó cũng xác định phương thức để lưu trạng thái của chính nó trong Memento </span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">// và phục hồi trạng thái từ Memento.</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Editor</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> is</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> field text, curX, curY, selectionWidth</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    method setText(text) is</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        this.text = text</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    method setCursor(x, y) is</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        this.curX = curX</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        this.curY = curY</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    method setSelectionWidth(width) is</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        this.selectionWidth = width</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Lưu trạng thái hiện tại vào Memento.</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    method createSnapshot(): Snapshot is</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">        // Memento là một đối tượng không thể thay đổi, </span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">        // vì vậy trình chỉnh sửa sẽ truyền trạng thái của chính nó </span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">        // như là đối số cho hàm tạo của Memento.</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        return new Snapshot(this, text, curX, curY, selectionWidth)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">// Lớp Memento lưu trữ trạng thái trước đó của trình chỉnh sửa.</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Snapshot</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> is</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> field editor: Editor</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> field text, curX, curY, selectionWidth</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    constructor Snapshot(editor, text, curX, curY, selectionWidth) is</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        this.editor = editor</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        this.text = text</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        this.curX = curX</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        this.curY = curY</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        this.selectionWidth = selectionWidth</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Tại một thời điểm nào đó, trạng thái trước đó của trình chỉnh sửa </span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // có thể được khôi phục bằng cách sử dụng đối tượng Memento.</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    method restore() is</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        editor.setText(text)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        editor.setCursor(curX, curY)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        editor.setSelectionWidth(selectionWidth)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">// Đối tượng Command có thể là người quản lý. Trong trường hợp này, </span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">// lệnh sẽ lấy Memento của trình chỉnh sửa trước khi sửa đổi trạng thái của nó. </span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">// Khi cần hoàn tác, nó sẽ khôi phục trạng thái của trình chỉnh sửa từ Memento.</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Command</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> is</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> field backup: Snapshot</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    method makeBackup() is</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        backup = editor.createSnapshot()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    method undo() is</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        if (backup != null)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">            backup.restore()</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // ...</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="moi-quan-he-voi-cac-mau-thiet-ke-khac" tabindex="-1"><a class="header-anchor" href="#moi-quan-he-voi-cac-mau-thiet-ke-khac"><span>Mối quan hệ với các mẫu thiết kế khác</span></a></h2><ul><li>Bạn có thể sử dụng cả [[Command Pattern]] và [[Memento Pattern]] để triển khai chức năng &quot;Hoàn tác&quot;. Trong trường hợp này, lệnh được sử dụng để thực hiện các hoạt động khác nhau trên đối tượng mục tiêu, và nhớ lưu được sử dụng để lưu trạng thái của đối tượng trước khi thay đổi.</li><li>Bạn có thể sử dụng cả [[Memento Pattern]] và [[Iterator Pattern]] để lưu trạng thái của trình lặp hiện tại và quay lại trạng thái trước đó khi cần thiết.</li><li>Đôi khi [[Prototype Pattern]] có thể được sử dụng như một phiên bản đơn giản hóa của [[Memento Pattern]], với điều kiện rằng trạng thái của đối tượng cần lưu trong lịch sử là đơn giản và không cần liên kết với các tài nguyên bên ngoài hoặc liên kết có thể được tái tạo một cách dễ dàng.</li></ul><h2 id="vi-du" tabindex="-1"><a class="header-anchor" href="#vi-du"><span>Ví dụ</span></a></h2><p><strong>Ví dụ sử dụng:</strong> Nguyên tắc cơ bản của mẫu nhớ lưu có thể được thực hiện thông qua việc tuân thủ quy tắc serialization, điều này rất phổ biến trong ngôn ngữ Java. Mặc dù mẫu nhớ lưu không phải là phương pháp duy nhất hoặc hiệu quả nhất để tạo bản sao trạng thái của đối tượng, nhưng nó có thể lưu một bản sao dự phòng của trạng thái đối tượng mà không tiết lộ cấu trúc gốc của đối tượng cho các đối tượng khác.</p><p>Dưới đây là một số ví dụ trong thư viện chính của Java:</p><ul><li>Tất cả các lớp triển khai <a href="http://docs.oracle.com/javase/8/docs/api/java/io/Serializable.html" target="_blank" rel="noopener noreferrer"><code>java.io.Serializable</code></a> có thể được coi là một mẫu nhớ lưu.</li><li>Tất cả các lớp triển khai <a href="http://docs.oracle.com/javaee/7/api/javax/faces/component/StateHolder.html" target="_blank" rel="noopener noreferrer"><code>javax.faces.component.StateHolder</code></a>.</li></ul>`,42),l=[e];function r(c,o){return s(),a("div",null,l)}const h=n(t,[["render",r],["__file","memento.html.vue"]]),d=JSON.parse('{"path":"/design/design-pattern/patterns/behavioral/memento.html","title":"Memento Pattern","lang":"en-US","frontmatter":{"title":"Memento Pattern","tags":["design-pattern"],"categories":["design-pattern"],"date created":"2023-10-06T00:00:00.000Z","date modified":"2023-10-06T00:00:00.000Z","description":"Ý nghĩa Memento Pattern là một mẫu thiết kế hành vi, cho phép lưu và khôi phục trạng thái trước đó của đối tượng mà không tiết lộ chi tiết cài đặt của đối tượng. Các trường hợp ...","head":[["meta",{"property":"og:url","content":"https://vanhung4499.github.io/design/design-pattern/patterns/behavioral/memento.html"}],["meta",{"property":"og:site_name","content":"VanHung4499"}],["meta",{"property":"og:title","content":"Memento Pattern"}],["meta",{"property":"og:description","content":"Ý nghĩa Memento Pattern là một mẫu thiết kế hành vi, cho phép lưu và khôi phục trạng thái trước đó của đối tượng mà không tiết lộ chi tiết cài đặt của đối tượng. Các trường hợp ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://raw.githubusercontent.com/vanhung4499/images/master/snap/20210520172952.png"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-06-28T15:54:38.000Z"}],["meta",{"property":"article:author","content":"Hung Nguyen"}],["meta",{"property":"article:tag","content":"design-pattern"}],["meta",{"property":"article:modified_time","content":"2024-06-28T15:54:38.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Memento Pattern\\",\\"image\\":[\\"https://raw.githubusercontent.com/vanhung4499/images/master/snap/20210520172952.png\\",\\"https://raw.githubusercontent.com/vanhung4499/images/master/snap/20210520173029.png\\",\\"https://raw.githubusercontent.com/vanhung4499/images/master/snap/20210520173117.png\\",\\"https://raw.githubusercontent.com/vanhung4499/images/master/snap/20231006210505.png\\"],\\"dateModified\\":\\"2024-06-28T15:54:38.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Hung Nguyen\\",\\"url\\":\\"https://vanhung4499.github.io\\"}]}"]]},"headers":[{"level":2,"title":"Ý nghĩa","slug":"y-nghia","link":"#y-nghia","children":[]},{"level":2,"title":"Các trường hợp sử dụng","slug":"cac-truong-hop-su-dung","link":"#cac-truong-hop-su-dung","children":[]},{"level":2,"title":"Cấu trúc","slug":"cau-truc","link":"#cau-truc","children":[{"level":3,"title":"Mô tả cấu trúc","slug":"mo-ta-cau-truc","link":"#mo-ta-cau-truc","children":[]},{"level":3,"title":"Mẫu code cấu trúc","slug":"mau-code-cau-truc","link":"#mau-code-cau-truc","children":[]}]},{"level":2,"title":"Pseudocode","slug":"pseudocode","link":"#pseudocode","children":[]},{"level":2,"title":"Mối quan hệ với các mẫu thiết kế khác","slug":"moi-quan-he-voi-cac-mau-thiet-ke-khac","link":"#moi-quan-he-voi-cac-mau-thiet-ke-khac","children":[]},{"level":2,"title":"Ví dụ","slug":"vi-du","link":"#vi-du","children":[]}],"git":{"createdTime":1719590078000,"updatedTime":1719590078000,"contributors":[{"name":"Hung Nguyen Van","email":"vanhung4499@gmail.com","commits":1}]},"readingTime":{"minutes":7.67,"words":2301},"filePathRelative":"design/design-pattern/patterns/behavioral/memento.md","localizedDate":"June 28, 2024","excerpt":"<h2>Ý nghĩa</h2>\\n<p><strong>Memento Pattern</strong> là một mẫu thiết kế hành vi, cho phép lưu và khôi phục trạng thái trước đó của đối tượng mà không tiết lộ chi tiết cài đặt của đối tượng.</p>\\n<h2>Các trường hợp sử dụng</h2>\\n<ul>\\n<li>Khi bạn cần tạo bản sao trạng thái của đối tượng để khôi phục trạng thái trước đó.</li>\\n<li>Khi truy cập trực tiếp vào biến thành viên, truy cập getter hoặc setter của đối tượng sẽ phá vỡ tính đóng gói, bạn có thể sử dụng Memento Pattern.</li>\\n</ul>","autoDesc":true}');export{h as comp,d as data};
