import{_ as a,o,c as r,a as t}from"./app-5QVbWi7Z.js";const i={};function l(n,e){return o(),r("div",null,e[0]||(e[0]=[t('<h1 id="公众号素材" tabindex="-1"><a class="header-anchor" href="#公众号素材"><span>公众号素材</span></a></h1><p>本章节，讲解公众号素材的相关内容，包括图片、语音、视频素材，不包括图文素材。对应 [公众号管理 -&gt; 素材管理] 菜单，如下图所示：</p><figure><img src="https://cloud.iocoder.cn/img/公众号手册/公众号素材/界面.png" alt="界面" tabindex="0" loading="lazy"><figcaption>界面</figcaption></figure><p>在配置公众号的自动回复、菜单的自动回复、主动给用户发送消息时，都可以使用素材。</p><h2 id="_1-表结构" tabindex="-1"><a class="header-anchor" href="#_1-表结构"><span><a href="#_1-%E8%A1%A8%E7%BB%93%E6%9E%84">#</a> 1. 表结构</span></a></h2><p>公众号素材对应 <code>mp_material</code> 表，结构如下图所示：</p><figure><img src="https://cloud.iocoder.cn/img/公众号手册/公众号素材/表结构.png" alt="表结构" tabindex="0" loading="lazy"><figcaption>表结构</figcaption></figure><p>① <code>type</code> 字段：素材类型。对应微信的素材类型，包括 <code>image</code> 图片、<code>voice</code> 语音、<code>video</code> 视频。</p><p>② <code>media_id</code> 字段：素材的媒体编号，对应微信公众号的 media_id。</p><p>③ <code>permanent</code> 字段：是否永久。<code>true</code> 代表 <a href="https://developers.weixin.qq.com/doc/offiaccount/Asset_Management/Adding_Permanent_Assets.html" target="_blank" rel="noopener noreferrer">永久素材</a>，<code>false</code> 代表 <a href="https://developers.weixin.qq.com/doc/offiaccount/Asset_Management/New_temporary_materials.html" target="_blank" rel="noopener noreferrer">临时素材</a>。</p><p>④ <code>mp_url</code> 字段：公众号存储素材的 URL 地址，有且仅有永久素材才有。</p><p>⑤ <code>url</code> 字段：存储在自己文件服务器上的 URL 地址，解决临时素材只在微信服务器上保存 3 天的问题，也解决图片素材的 <code>mp_url</code> 无法在自己管理后台显示的问题。</p><h2 id="_2-素材管理界面" tabindex="-1"><a class="header-anchor" href="#_2-素材管理界面"><span><a href="#_2-%E7%B4%A0%E6%9D%90%E7%AE%A1%E7%90%86%E7%95%8C%E9%9D%A2">#</a> 2. 素材管理界面</span></a></h2><ul><li>前端：<a href="https://github.com/yudaocode/yudao-ui-admin-vue2/blob/master/src/views/mp/material/index.vue" target="_blank" rel="noopener noreferrer">/@views/mp/material</a></li><li>后端：<a href="https://github.com/YunaiV/yudao-cloud/blob/master/yudao-module-mp/yudao-module-mp-biz/src/main/java/cn/iocoder/yudao/module/mp/controller/admin/material/MpMaterialController.java" target="_blank" rel="noopener noreferrer">MpMaterialController</a></li></ul><h2 id="_3-永久素材" tabindex="-1"><a class="header-anchor" href="#_3-永久素材"><span><a href="#_3-%E6%B0%B8%E4%B9%85%E7%B4%A0%E6%9D%90">#</a> 3. 永久素材</span></a></h2><blockquote><p>对应 <a href="https://developers.weixin.qq.com/doc/offiaccount/Asset_Management/Adding_Permanent_Assets.html" target="_blank" rel="noopener noreferrer">《微信公众号官方文档 —— 永久素材》</a> 文档。</p></blockquote><p><a href="https://github.com/YunaiV/yudao-cloud/blob/master/yudao-module-mp/yudao-module-mp-biz/src/main/java/cn/iocoder/yudao/module/mp/controller/admin/material/MpMaterialController.java#L40-L47" target="_blank" rel="noopener noreferrer">MpMaterialController</a> 的 <code>uploadPermanentMaterial</code> 方法对应的接口，实现了上传【永久】素材到公众号。如下图所示：</p><figure><img src="https://cloud.iocoder.cn/img/公众号手册/公众号素材/上传永久素材.png" alt="上传永久素材" tabindex="0" loading="lazy"><figcaption>上传永久素材</figcaption></figure><h2 id="_4-临时素材" tabindex="-1"><a class="header-anchor" href="#_4-临时素材"><span><a href="#_4-%E4%B8%B4%E6%97%B6%E7%B4%A0%E6%9D%90">#</a> 4. 临时素材</span></a></h2><blockquote><p>对应 <a href="https://developers.weixin.qq.com/doc/offiaccount/Asset_Management/New_temporary_materials.html" target="_blank" rel="noopener noreferrer">《微信公众号官方文档 —— 临时素材》</a> 文档。</p></blockquote><p>① 来源一：主动发送客服消息给用户时，如果是图片、语音、视频素材，需要先上传到微信服务器，获得到 <code>media_id</code> 后，才能发送给用户。</p><p>此时，可调用 <a href="https://github.com/YunaiV/yudao-cloud/blob/master/yudao-module-mp/yudao-module-mp-biz/src/main/java/cn/iocoder/yudao/module/mp/controller/admin/material/MpMaterialController.java#L31-L38" target="_blank" rel="noopener noreferrer">MpMaterialController</a> 的 <code>uploadTemporaryMaterial</code> 方法对应的接口，实现了上传【临时】素材到公众号。如下图所示：</p><figure><img src="https://cloud.iocoder.cn/img/公众号手册/公众号素材/上传临时素材.png" alt="上传临时素材" tabindex="0" loading="lazy"><figcaption>上传临时素材</figcaption></figure><p>② 来源二：在接收到用户消息时，如果是图片、语音、视频素材，需要先下载到自己的文件服务器上，避免超过 3 天后无法访问的问题。如下图所示：</p><figure><img src="https://cloud.iocoder.cn/img/公众号手册/公众号素材/下载临时素材.png" alt="下载临时素材" tabindex="0" loading="lazy"><figcaption>下载临时素材</figcaption></figure>',25)]))}const c=a(i,[["render",l],["__file","material.html.vue"]]),p=JSON.parse('{"path":"/project/yudao-cloud/mp/material.html","title":"公众号素材","lang":"en-US","frontmatter":{"title":"公众号素材","tags":["project","java","spring-boot","spring-cloud"],"categories":["project"],"order":139,"feed":false,"seo":false,"head":[]},"headers":[{"level":2,"title":"# 1. 表结构","slug":"_1-表结构","link":"#_1-表结构","children":[]},{"level":2,"title":"# 2. 素材管理界面","slug":"_2-素材管理界面","link":"#_2-素材管理界面","children":[]},{"level":2,"title":"# 3. 永久素材","slug":"_3-永久素材","link":"#_3-永久素材","children":[]},{"level":2,"title":"# 4. 临时素材","slug":"_4-临时素材","link":"#_4-临时素材","children":[]}],"git":{"createdTime":1720365235000,"updatedTime":1720365235000,"contributors":[{"name":"Hung Nguyen Van","email":"vanhung4499@gmail.com","commits":1}]},"readingTime":{"minutes":2.73,"words":819},"filePathRelative":"project/yudao-cloud/mp/material.md","localizedDate":"July 7, 2024"}');export{c as comp,p as data};
