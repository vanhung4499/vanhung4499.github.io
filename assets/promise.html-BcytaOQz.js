import{_ as s,o as t,c as n,a}from"./app-CmlOSuIY.js";const h={};function e(l,i){return t(),n("div",null,i[0]||(i[0]=[a(`<h1 id="promise" tabindex="-1"><a class="header-anchor" href="#promise"><span>Promise</span></a></h1><p>Lập trình bất đồng bộ truyền thống thường gặp vấn đề &quot;callback hell&quot; khi mà mức lồng nhau của callback quá sâu, dẫn đến việc khó hiểu và bảo trì mã nguồn. Promise giúp chúng ta giải quyết vấn đề này bằng cách sử dụng phương thức gọi liên tiếp (chaining) để xử lý các callback.</p><p>Promise là một giải pháp cho lập trình bất đồng bộ, cho phép chúng ta xếp hàng các hoạt động bất đồng bộ và thực hiện chúng theo thứ tự mong muốn, trả về kết quả theo dự đoán. Promise có thể được truyền và xử lý giữa các đối tượng, giúp chúng ta quản lý hàng đợi.</p><p>Cú pháp:</p><div class="language-js" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> Promise</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">executor</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span></code></pre></div><p>Tham số <code>executor</code> của Promise là một hàm có hai tham số <code>resolve</code> và <code>reject</code>. Cả hai tham số này cũng là các hàm.</p><ul><li><code>resolve</code>: Được gọi khi hoạt động bất đồng bộ thành công, chuyển trạng thái của Promise từ &quot;đang chờ&quot; (pending) sang &quot;đã thực hiện&quot; (fulfilled) và truyền kết quả của hoạt động bất đồng bộ như là tham số. Tham số của hàm này có thể là một giá trị bình thường hoặc một Promise khác.</li><li><code>reject</code>: Được gọi khi hoạt động bất đồng bộ thất bại, chuyển trạng thái của Promise từ &quot;đang chờ&quot; (pending) sang &quot;bị từ chối&quot; (rejected) và truyền lỗi của hoạt động bất đồng bộ như là tham số. Thông thường, tham số của hàm này là một đối tượng lỗi (Error object).</li></ul><p>Khai báo kiểu:</p><div class="language-ts" data-highlighter="shiki" data-ext="ts" data-title="ts" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">constructor</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">executor</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">: (</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">resolve</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">: (</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">result</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">R</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> void</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">reject</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">: (</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">error</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">any</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> void</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">): </span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Promise</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">constructor</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">executor</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">: (</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">resolve</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">: (</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">thenable</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Thenable</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">R</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;) </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> void</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">reject</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">: (</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">error</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">any</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> void</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">): </span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">Promise</span></span></code></pre></div><h2 id="mo-ta" tabindex="-1"><a class="header-anchor" href="#mo-ta"><span>Mô tả</span></a></h2><ul><li>Khi Promise được khởi tạo, hàm <code>executor</code> được <strong>ngay lập tức gọi</strong>, và hai hàm <code>resolve</code> và <code>reject</code> được truyền vào <code>executor</code> (hàm <code>executor</code> được gọi trước khi Promise trả về đối tượng mới).</li><li>Thông thường, <code>executor</code> sẽ thực hiện một số hoạt động bất đồng bộ và khi hoàn thành, có thể gọi hàm <code>resolve</code> để chuyển trạng thái của Promise sang &quot;đã thực hiện&quot; (fulfilled), hoặc gọi hàm <code>reject</code> để chuyển trạng thái của Promise sang &quot;bị từ chối&quot; (rejected).</li><li>Promise không thể bị hủy bỏ, sau khi được tạo, nó sẽ được thực thi ngay lập tức và không thể hủy giữa chừng.</li><li>Nếu không đặt hàm callback (executor), lỗi trong Promise sẽ không được phản ánh ra bên ngoài.</li><li>Khi ở trạng thái &quot;đang chờ&quot; (pending), không thể biết được tiến trình hiện tại đang ở giai đoạn nào.</li></ul><p>Nếu một sự kiện xảy ra lặp đi lặp lại, thì việc sử dụng <a href="https://nodejs.org/api/stream.html" target="_blank" rel="noopener noreferrer">Stream</a> thường là một lựa chọn tốt hơn so với việc triển khai Promise.</p><p>🌰 <strong>Ví dụ mã</strong></p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> Promise</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">  /* executor */</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">  function</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">resolve</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">reject</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">    // Xử lý bất đồng bộ</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">    // Được gọi sau khi xử lý dữ liệu hoàn tất</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">    resolve</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">    // Được gọi khi xử lý dữ liệu gặp lỗi</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">    reject</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">  function</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> A</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">    /* Thành công, thực hiện bước tiếp theo */</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">  },</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">  function</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> B</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">    /* Thất bại, xử lý tương ứng */</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="quy-trinh-lam-viec-cua-promise" tabindex="-1"><a class="header-anchor" href="#quy-trinh-lam-viec-cua-promise"><span>Quy trình làm việc của Promise</span></a></h2><p>Promise là một đối tượng proxy (đại diện cho một giá trị), giá trị được đại diện có thể không được biết trước khi tạo đối tượng Promise. Nó cho phép bạn gắn kết các phương thức xử lý tương ứng cho các trạng thái <strong>Fulfilled</strong> (thực hiện) và <strong>Rejected</strong> (từ chối) của các hoạt động bất đồng bộ. Điều này cho phép các phương thức bất đồng bộ trả về giá trị giống như các phương thức đồng bộ, nhưng không trả về kết quả thực thi cuối cùng ngay lập tức, mà trả về một đối tượng Promise có thể đại diện cho kết quả xuất hiện trong tương lai.</p><p>Vì phương thức <code>Promise.prototype.then</code> và <code>Promise.prototype.catch</code> trả về đối tượng Promise, nên chúng có thể được [[JS Cascade Function|gọi liên tiếp]].</p><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230808003301.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><h2 id="trang-thai" tabindex="-1"><a class="header-anchor" href="#trang-thai"><span>Trạng thái</span></a></h2><p>Đối tượng Promise được khởi tạo bằng từ khóa <code>new</code> có ba trạng thái sau:</p><table><thead><tr><th>Trạng thái</th><th>Ý nghĩa</th><th>Mô tả</th></tr></thead><tbody><tr><td>Pending</td><td>Đang chờ</td><td>Trạng thái ban đầu</td></tr><tr><td>Fulfilled</td><td>Đã thực hiện</td><td>Thành công, gọi <code>onFulfilled</code></td></tr><tr><td>Rejected</td><td>Bị từ chối</td><td>Thất bại, gọi <code>onRejected</code></td></tr></tbody></table><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230808001210.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>⚠️ <strong>Lưu ý</strong>: Khi trạng thái của Promise chuyển từ <span style="font-weight:bold;color:red;">Pending</span> sang <span style="font-weight:bold;color:red;">Fulfilled</span> hoặc <span style="font-weight:bold;color:red;">Rejected</span>, trạng thái của đối tượng Promise sẽ không thay đổi nữa.</p><p>Khi trạng thái của Promise thay đổi, các hàm phản hồi trong <code>.then()</code> sẽ được gọi để xử lý các bước tiếp theo.</p><p>Tuy nhiên, chỉ có một trong hai hàm trong tham số của <code>.then()</code> sẽ được gọi, hàm nào được gọi phụ thuộc vào trạng thái của Promise.</p><p>Ngoài ra, trạng thái <strong>Fulfilled</strong> và <strong>Rejected</strong> có thể được gọi là <strong>Settled</strong> (ổn định).</p><h2 id="phuong-thuc-tinh" tabindex="-1"><a class="header-anchor" href="#phuong-thuc-tinh"><span>Phương thức tĩnh</span></a></h2><table><thead><tr><th>Phương thức</th><th>Mô tả</th></tr></thead><tbody><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/all" target="_blank" rel="noopener noreferrer">Promise.all(iterable)</a></td><td>Đóng gói nhiều đối tượng Promise thành một đối tượng Promise mới. Gọi lại được kích hoạt khi tất cả các thành viên đều Fulfilled hoặc một thành viên bị Rejected</td></tr><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/race" target="_blank" rel="noopener noreferrer">Promise.race(iterable)</a></td><td>Đóng gói nhiều đối tượng Promise thành một đối tượng Promise mới. Gọi lại được kích hoạt khi một thành viên thay đổi trạng thái</td></tr><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/reject" target="_blank" rel="noopener noreferrer">Promise.reject(reason)</a></td><td>Trả về một đối tượng Promise mới với trạng thái Rejected</td></tr><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/resolve" target="_blank" rel="noopener noreferrer">Promise.resolve(value)</a></td><td>Trả về một đối tượng Promise mới với trạng thái Fulfilled</td></tr></tbody></table><h2 id="đoi-tuong-nguyen-mau" tabindex="-1"><a class="header-anchor" href="#đoi-tuong-nguyen-mau"><span>Đối tượng nguyên mẫu</span></a></h2><h3 id="thuoc-tinh" tabindex="-1"><a class="header-anchor" href="#thuoc-tinh"><span>Thuộc tính</span></a></h3><table><thead><tr><th>Thuộc tính nguyên mẫu</th><th>Mô tả</th></tr></thead><tbody><tr><td><code>Promise.prototype.constructor</code></td><td>Trả về hàm tạo ra đối tượng Promise mặc định</td></tr></tbody></table><h3 id="phuong-thuc" tabindex="-1"><a class="header-anchor" href="#phuong-thuc"><span>Phương thức</span></a></h3><table><thead><tr><th>Phương thức nguyên mẫu</th><th>Mô tả</th></tr></thead><tbody><tr><td><a href="app://obsidian.md/properties-of-the-promise-prototype-object/catch" target="_blank" rel="noopener noreferrer">Promise.prototype.catch(onRejected)</a></td><td>Tương đương với <code>.then(null, rejection)</code> và được sử dụng để chỉ định hàm xử lý khi xảy ra lỗi</td></tr><tr><td><a href="app://obsidian.md/properties-of-the-promise-prototype-object/then" target="_blank" rel="noopener noreferrer">Promise.prototype.then(onFulfilled, onRejected)</a></td><td>Thêm các hàm xử lý <code>fulfillment</code> và <code>rejection</code> vào Promise hiện tại và trả về một Promise mới với giá trị trả về của hàm</td></tr><tr><td><code>Promise.prototype.finally(onFinally)</code></td><td>Được sử dụng để chỉ định một hành động sẽ được thực hiện dù Promise có trạng thái cuối cùng như thế nào</td></tr></tbody></table><h2 id="thuc-hanh-tot-nhat" tabindex="-1"><a class="header-anchor" href="#thuc-hanh-tot-nhat"><span>Thực hành tốt nhất</span></a></h2><h3 id="chuoi-nhieu-tac-vu" tabindex="-1"><a class="header-anchor" href="#chuoi-nhieu-tac-vu"><span>Chuỗi nhiều tác vụ</span></a></h3><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> Task</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">result</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">isSuccess</span><span style="--shiki-light:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> () </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">=&gt;</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">    new</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> Promise</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">resolve</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">reject</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">      setTimeout</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">isSuccess</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">          resolve</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">result</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">        } </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">          reject</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">result</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">      }, </span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">execute</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">Task</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&#39;A&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">Task</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&#39;B&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">Task</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&#39;C&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">false</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">Task</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&#39;D&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">)]).</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">resultList</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">  // làm gì đó</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Lưu ý:</p><ol><li>Mỗi Task, thành công hay thất bại, không thể ngăn chặn việc thực thi Task tiếp theo</li><li><code>then</code> cuối cùng cần <code>resolve</code> kết quả thực thi của mỗi Task</li></ol><p>Ý tưởng thực hiện:</p><ol><li>Bọc mỗi Task trong một Promise để bắt lỗi <code>rejected</code> của Task</li><li>Có thể sử dụng biến trung gian để lưu trữ kết quả đầu ra của mỗi Task, sau đó trong <code>then</code> cuối cùng của Promise, <code>resolve</code> biến trung gian đó</li></ol><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;"> execute</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">tasks</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> tasks</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">reduce</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">    (</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">previousPromise</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">currentPromise</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">=&gt;</span></span>
<span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">      previousPromise</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">resultList</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;"> Promise</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">resolve</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">          currentPromise</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">            .</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">result</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">              resolve</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">resultList</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">concat</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E06C75;--shiki-dark:#E06C75;">result</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">            })</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">            .</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">catch</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">              resolve</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E5C07B;--shiki-dark:#E5C07B;">resultList</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">concat</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">null</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">            });</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">        });</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">      }),</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">    []</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">  );</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="đong-thoi-đong-bo" tabindex="-1"><a class="header-anchor" href="#đong-thoi-đong-bo"><span>Đồng thời đồng bộ</span></a></h3><h3 id="đong-thoi-bat-đong-bo" tabindex="-1"><a class="header-anchor" href="#đong-thoi-bat-đong-bo"><span>Đồng thời bất đồng bộ</span></a></h3>`,43)]))}const k=s(h,[["render",e],["__file","promise.html.vue"]]),p=JSON.parse('{"path":"/programming/js/built-in/control-abstraction-objects/promise.html","title":"Promies","lang":"en-US","frontmatter":{"title":"Promies","tags":["js","programming"],"categories":["js","programming"],"date created":"2023-08-07T00:00:00.000Z","date modified":"2023-08-08T00:00:00.000Z","order":2,"description":"Promise Lập trình bất đồng bộ truyền thống thường gặp vấn đề \\"callback hell\\" khi mà mức lồng nhau của callback quá sâu, dẫn đến việc khó hiểu và bảo trì mã nguồn. Promise giúp c...","head":[["meta",{"property":"og:url","content":"https://vanhung4499.github.io/programming/js/built-in/control-abstraction-objects/promise.html"}],["meta",{"property":"og:site_name","content":"VanHung4499"}],["meta",{"property":"og:title","content":"Promies"}],["meta",{"property":"og:description","content":"Promise Lập trình bất đồng bộ truyền thống thường gặp vấn đề \\"callback hell\\" khi mà mức lồng nhau của callback quá sâu, dẫn đến việc khó hiểu và bảo trì mã nguồn. Promise giúp c..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230808003301.png"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-06-28T15:54:38.000Z"}],["meta",{"property":"article:author","content":"Hung Nguyen"}],["meta",{"property":"article:tag","content":"js"}],["meta",{"property":"article:tag","content":"programming"}],["meta",{"property":"article:modified_time","content":"2024-06-28T15:54:38.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Promies\\",\\"image\\":[\\"https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230808003301.png\\",\\"https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230808001210.png\\"],\\"dateModified\\":\\"2024-06-28T15:54:38.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Hung Nguyen\\",\\"url\\":\\"https://vanhung4499.github.io\\"}]}"]]},"headers":[{"level":2,"title":"Mô tả","slug":"mo-ta","link":"#mo-ta","children":[]},{"level":2,"title":"Quy trình làm việc của Promise","slug":"quy-trinh-lam-viec-cua-promise","link":"#quy-trinh-lam-viec-cua-promise","children":[]},{"level":2,"title":"Trạng thái","slug":"trang-thai","link":"#trang-thai","children":[]},{"level":2,"title":"Phương thức tĩnh","slug":"phuong-thuc-tinh","link":"#phuong-thuc-tinh","children":[]},{"level":2,"title":"Đối tượng nguyên mẫu","slug":"đoi-tuong-nguyen-mau","link":"#đoi-tuong-nguyen-mau","children":[{"level":3,"title":"Thuộc tính","slug":"thuoc-tinh","link":"#thuoc-tinh","children":[]},{"level":3,"title":"Phương thức","slug":"phuong-thuc","link":"#phuong-thuc","children":[]}]},{"level":2,"title":"Thực hành tốt nhất","slug":"thuc-hanh-tot-nhat","link":"#thuc-hanh-tot-nhat","children":[{"level":3,"title":"Chuỗi nhiều tác vụ","slug":"chuoi-nhieu-tac-vu","link":"#chuoi-nhieu-tac-vu","children":[]},{"level":3,"title":"Đồng thời đồng bộ","slug":"đong-thoi-đong-bo","link":"#đong-thoi-đong-bo","children":[]},{"level":3,"title":"Đồng thời bất đồng bộ","slug":"đong-thoi-bat-đong-bo","link":"#đong-thoi-bat-đong-bo","children":[]}]}],"git":{"createdTime":1719590078000,"updatedTime":1719590078000,"contributors":[{"name":"Hung Nguyen Van","email":"vanhung4499@gmail.com","commits":1}]},"readingTime":{"minutes":5.51,"words":1653},"filePathRelative":"programming/js/built-in/control-abstraction-objects/promise.md","localizedDate":"June 28, 2024","excerpt":"\\n<p>Lập trình bất đồng bộ truyền thống thường gặp vấn đề \\"callback hell\\" khi mà mức lồng nhau của callback quá sâu, dẫn đến việc khó hiểu và bảo trì mã nguồn. Promise giúp chúng ta giải quyết vấn đề này bằng cách sử dụng phương thức gọi liên tiếp (chaining) để xử lý các callback.</p>\\n<p>Promise là một giải pháp cho lập trình bất đồng bộ, cho phép chúng ta xếp hàng các hoạt động bất đồng bộ và thực hiện chúng theo thứ tự mong muốn, trả về kết quả theo dự đoán. Promise có thể được truyền và xử lý giữa các đối tượng, giúp chúng ta quản lý hàng đợi.</p>","autoDesc":true}');export{k as comp,p as data};
