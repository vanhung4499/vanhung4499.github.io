import{_ as s,o as a,c as n,d as i}from"./app-C7tm95bn.js";const l={},r=i(`<h1 id="adapter-pattern-practice" tabindex="-1"><a class="header-anchor" href="#adapter-pattern-practice"><span>Adapter Pattern Practice:</span></a></h1><h2 id="gioi-thieu" tabindex="-1"><a class="header-anchor" href="#gioi-thieu"><span>Giới thiệu</span></a></h2><p><strong>80% diện tích của giấy vệ sinh đều được dùng để bảo vệ tay!</strong></p><p>Sau khi làm việc được khoảng vài năm, phần lớn lập trình viên đều muốn nâng cao năng lực kỹ thuật của mình, bắt đầu thử đọc mã nguồn một số thư viện, ví dụ như <code>Spring</code>, <code>Mybatis</code>, <code>Dubbo</code>, vv. Nhưng khi đọc, họ càng thấy khó hiểu hơn, đôi khi từ một nơi này sang một nơi khác. Thậm chí cảm thấy nghi ngờ về kỹ thuật của mình, dần dần không muốn tiếp cận vào kiến thức này nữa.</p><p>Nguyên nhân chính là một framework, theo thời gian phát triển, độ phức tạp của nó càng cao, từ một điểm cốt lõi rất nhỏ cho đến cuối cùng là rất nhiều nhánh lá. Điều này giống như một phần của code doanh nghiệp bạn phát triển hoặc một số thành phần khác, phần lớn đầu tiên của code lõi có thể chỉ chiếm 20%, trong khi các phần khác đều phải đảm bảo rằng luồng lõi hoạt động bình thường. Vì vậy, đây cũng là một phần lý do khiến việc đọc mã nguồn trở nên khó khăn.</p><p><strong>Design Pattern được sử dụng trong framework không?</strong></p><p>Không chỉ có một mà còn nhiều loại design pattern được sử dụng trong framework, đôi khi không phải là việc sử dụng một mẫu duy nhất mà là sự kết hợp của nhiều loại design pattern. Khác biệt hoàn toàn so với việc bạn phát triển CRUD hàng ngày, nếu tất cả chỉ là các câu lệnh if từ trên xuống dưới, đó cũng không thể gọi là một framework. Ví dụ, nếu bạn tìm từ khóa &quot;Adapter&quot; trong mã nguồn của Spring, bạn sẽ thấy nhiều lớp thực hiện, chẳng hạn như <code>UserCredentialsDataSourceAdapter</code>. Và mẫu thiết kế này chính là Adapter Pattern mà chúng ta sẽ giới thiệu trong bài viết này.</p><p><strong>Adapter có mặt ở khắp mọi nơi trong cuộc sống hàng ngày</strong></p><p>Nếu nhắc đến sự tồn tại của nhiều adapter trong cuộc sống hàng ngày, bạn sẽ nghĩ đến điều gì? Trước khi đọc tiếp, hãy suy nghĩ.</p><h2 id="moi-truong-phat-trien" tabindex="-1"><a class="header-anchor" href="#moi-truong-phat-trien"><span>Môi trường phát triển</span></a></h2><ol><li>JDK 1.8</li><li>Idea + Maven</li><li>Code: <a href="https://github.com/vanhung4499/practical-java-design" target="_blank" rel="noopener noreferrer">vanhung4499/practical-java-design</a></li></ol><table><thead><tr><th>Dự án</th><th>Mô tả</th></tr></thead><tbody><tr><td>demo-design-6-00</td><td>Dự án mô phỏng kịch bản, Mô phỏng nhiều cấu trúc thông điệp MQ</td></tr><tr><td>demo-design-6-01</td><td>Triển khai yêu cầu kinh doanh bằng một đống mã</td></tr><tr><td>demo-design-6-02</td><td>Tối ưu và cải thiện mã thông qua mẫu thiết kế để tạo ra so sánh và học hỏi</td></tr></tbody></table><h2 id="gioi-thieu-ve-adapter-pattern" tabindex="-1"><a class="header-anchor" href="#gioi-thieu-ve-adapter-pattern"><span>Giới thiệu về Adapter Pattern</span></a></h2><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240327200238.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><p>Chức năng chính của mẫu Adapter là chuyển đổi giao diện ban đầu không tương thích thành một giao diện đồng nhất thông qua việc điều chỉnh. Điều này giúp người dùng sử dụng một cách thuận tiện, giống như các cục sạc đa năng, dây cáp, đầu chuyển của máy tính MAC, cục sạc chuẩn quốc tế khi đi du lịch nước ngoài, v.v. Tất cả đều là để điều chỉnh các <code>Adapter</code> khác nhau để làm cho chúng tương thích.</p><p><strong>Ngoài các tình huống phổ biến về việc điều chỉnh xuất hiện trong cuộc sống hàng ngày, thì trong phát triển doanh nghiệp thì sao?</strong></p><p>Trong phát triển doanh nghiệp, chúng ta thường cần thích nghi với các giao diện khác nhau, đặc biệt là trong dịch vụ trung tâm, nơi mà trung tâm cần gói các dịch vụ từ nhiều dòng kinh doanh khác nhau và sau đó cung cấp giao diện đồng nhất để sử dụng bên ngoài. Điều này cũng là rất phổ biến trong quá trình phát triển hàng ngày của chúng ta.</p><h2 id="mo-phong-kich-ban" tabindex="-1"><a class="header-anchor" href="#mo-phong-kich-ban"><span>Mô phỏng kịch bản</span></a></h2><p>Khi doanh nghiệp phát triển và các hệ thống cơ bản dần hình thành, hoạt động kinh doanh sẽ bắt đầu thực hiện các hoạt động để thu hút người dùng mới và kích thích họ sử dụng, nhằm đảm bảo tăng trưởng <code>DAU</code> và cuối cùng là chuyển đổi <code>ROI</code>.</p><p>Vào thời điểm này, một hệ thống tiếp thị sẽ cần được tạo ra, phần lớn các hoạt động tiếp thị thông thường là phân nhánh, thu hút khách hàng, ví dụ: nếu bạn mời một người dùng mở tài khoản hoặc mời một người dùng đặt hàng, nền tảng sẽ hoàn tiền cho bạn, mời càng nhiều, nhận càng nhiều. Đồng thời, khi lượng người mời ngày càng nhiều, họ bắt đầu thiết lập một số tiêu chuẩn hàng tháng cho việc đặt hàng đầu tiên để nhận phần thưởng đầu tiên, v.v. Các tình huống tiếp thị khác nhau.</p><p>Lúc này, một hệ thống như vậy sẽ nhận các loại tin nhắn MQ khác nhau hoặc giao diện khác nhau. Nếu phải phát triển từng cái một, sẽ tốn nhiều chi phí, đồng thời cũng có một số khó khăn trong việc mở rộng sau này. Trong trường hợp này, một hệ thống có thể được cấu hình để kết nối với các MQ bên ngoài một cách linh hoạt, và các MQ này giống như đã đề cập ở trên có thể là các tin nhắn đăng ký tài khoản, tin nhắn đặt hàng sản phẩm, v.v.</p><p>Và cách tiếp cận của bản mô phỏng này cũng có thể được áp dụng vào việc điều chỉnh các thuộc tính thông tin.</p><h3 id="du-an-mo-phong-kich-ban" tabindex="-1"><a class="header-anchor" href="#du-an-mo-phong-kich-ban"><span>Dự án mô phỏng kịch bản</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">design-demo-6-00/</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">├──</span><span style="color:#98C379;--shiki-dark:#98C379;"> pom.xml</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">└──</span><span style="color:#98C379;--shiki-dark:#98C379;"> src</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> main</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> java</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">            └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> com</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> hnv99</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                    └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> design</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                        ├──</span><span style="color:#98C379;--shiki-dark:#98C379;"> mq</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                        │  </span><span style="color:#98C379;--shiki-dark:#98C379;"> ├──</span><span style="color:#98C379;--shiki-dark:#98C379;"> CreateAccount.java</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                        │  </span><span style="color:#98C379;--shiki-dark:#98C379;"> ├──</span><span style="color:#98C379;--shiki-dark:#98C379;"> OrderMq.java</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                        │  </span><span style="color:#98C379;--shiki-dark:#98C379;"> └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> POPOrderDelivered.java</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                        └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> service</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                            ├──</span><span style="color:#98C379;--shiki-dark:#98C379;"> OrderService.java</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                            └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> POPOrderService.java</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Trong dự án này, mô phỏng ba loại tin nhắn MQ khác nhau, trong đó mỗi tin nhắn đều có một số trường bắt buộc như: ID người dùng, thời gian, ID dịch vụ, nhưng mỗi loại MQ lại có các thuộc tính khác nhau. Ví dụ, trường ID người dùng trong các MQ khác nhau có thể là: uId, userId, v.v.</li><li>Đồng thời, cung cấp hai loại interface khác nhau, một dùng để truy vấn số lượng đơn hàng trong hệ thống nội bộ, một dùng để truy vấn xem liệu một đơn hàng từ bên thứ ba có phải là đơn hàng đầu tiên hay không.</li><li>Tiếp theo, sẽ thực hiện việc tạo ra các adapter để làm cho các loại tin nhắn MQ và interface tương thích với nhau.</li></ul><h3 id="mo-ta-ngan-gon" tabindex="-1"><a class="header-anchor" href="#mo-ta-ngan-gon"><span>Mô tả ngắn gọn</span></a></h3><h4 id="mq-đang-ky-mo-tai-khoan" tabindex="-1"><a class="header-anchor" href="#mq-đang-ky-mo-tai-khoan"><span>MQ đăng ký mở tài khoản</span></a></h4><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">@</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Data</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> CreateAccount</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> number</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">      // Số tài khoản  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> address</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">     // Địa chỉ mở tài khoản  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Date</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> accountDate</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">   // Ngày mở tài khoản  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> desc</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">        // Mô tả về tài khoản  </span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    @</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Override</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> toString</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> JSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">toJSONString</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">this</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><h4 id="mq-đon-hang-noi-bo" tabindex="-1"><a class="header-anchor" href="#mq-đon-hang-noi-bo"><span>MQ đơn hàng nội bộ</span></a></h4><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">@</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Data</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> OrderMq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> uid</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">           // ID Người dùng  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> sku</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">           // Mặt hàng  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> orderId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">       // ID Đơn hàng  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Date</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> createOrderTime</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;"> // Thời gian đặt hàng  </span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    @</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Override</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> toString</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> JSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">toJSONString</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">this</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><h4 id="mq-đon-hang-tu-ben-thu-ba" tabindex="-1"><a class="header-anchor" href="#mq-đon-hang-tu-ben-thu-ba"><span>MQ đơn hàng từ bên thứ ba</span></a></h4><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">@</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Data</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> POPOrderDelivered</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> uId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">     // ID Người dùng  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> orderId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;"> // ID Đơn hàng  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Date</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> orderTime</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;"> // Thời gian đặt hàng  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Date</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> sku</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">       // Mặt hàng  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Date</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> skuName</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">   // Tên mặt hàng  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> BigDecimal</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> decimal</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;"> // Số tiền  </span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    @</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Override</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> toString</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> JSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">toJSONString</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">this</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="interface-truy-van-so-luong-đon-hang-noi-bo-cua-nguoi-dung" tabindex="-1"><a class="header-anchor" href="#interface-truy-van-so-luong-đon-hang-noi-bo-cua-nguoi-dung"><span>Interface truy vấn số lượng đơn hàng nội bộ của người dùng</span></a></h4><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> OrderService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Logger</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> logger </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> LoggerFactory</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getLogger</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">POPOrderService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">class</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> long</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> queryUserOrderCount</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> userId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">){</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        logger</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">info</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Cửa hàng tự doanh, truy vấn xem số đơn hàng của người dùng có phải là đơn hàng đầu tiên không: {}&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, userId);</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 10L</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><h4 id="interface-truy-van-xem-nguoi-dung-tu-ben-thu-ba-co-đon-hang-đau-tien-khong" tabindex="-1"><a class="header-anchor" href="#interface-truy-van-xem-nguoi-dung-tu-ben-thu-ba-co-đon-hang-đau-tien-khong"><span>Interface truy vấn xem người dùng từ bên thứ ba có đơn hàng đầu tiên không</span></a></h4><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> POPOrderService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Logger</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> logger </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> LoggerFactory</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getLogger</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">POPOrderService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">class</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> boolean</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> isFirstOrder</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> uId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        logger</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">info</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Cửa hàng POP, truy vấn xem đơn hàng của người dùng có phải là đơn hàng đầu tiên không: {}&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, uId);</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> true</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><ul><li>Các mục trên đại diện cho các MQ và interface khác nhau. Sau này, chúng ta sẽ sử dụng các MQ và interface này và triển khai các adapter tương ứng.</li></ul><blockquote><p>[!info] lombok<br> Để làm cho code ngắn gọn hơn, tôi dùng lombok annotation để rút gọn code, các phần như setter, getter, constructor sẽ được lombok xử lý!</p></blockquote><h2 id="trien-khai-code" tabindex="-1"><a class="header-anchor" href="#trien-khai-code"><span>Triển khai code</span></a></h2><p><strong>Thực tế, hầu hết thời gian việc nhận tin nhắn MQ là tạo một lớp để tiêu thụ, thông qua việc chuyển đổi thuộc tính tin nhắn MQ của nó cho các phương thức của mình.</strong></p><p>Tiếp theo, chúng ta cũng sẽ trình bày một cách thực hiện mô phỏng cách thức này, nhưng cách thực hiện này có một vấn đề lớn là, khi lượng tin nhắn MQ càng ngày càng nhiều, thậm chí sau vài chục hoặc vài trăm nghìn tin nhắn, bạn làm thế nào để tối ưu cho trung gian?</p><h3 id="cau-truc-du-an" tabindex="-1"><a class="header-anchor" href="#cau-truc-du-an"><span>Cấu trúc dự án</span></a></h3><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">design</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="color:#E06C75;--shiki-dark:#E06C75;">demo</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="color:#D19A66;--shiki-dark:#D19A66;">6</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="color:#D19A66;--shiki-dark:#D19A66;">00</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">/</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">├── </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">pom</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">xml</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">└── src</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    └── main</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        └── java</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">            └── com</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">                └── hnv99</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">                    └── design</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">                        ├── mq</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">                        │   ├── </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">CreateAccount</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">                        │   ├── </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">OrderMq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">                        │   └── </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">POPOrderDelivered</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">                        └── service</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">                            ├── </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">OrderService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">                            └── </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">POPOrderService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">java</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Hiện tại cần nhận ba tin nhắn MQ khác nhau, do đó có ba lớp tương ứng, và cách triển khai giống như các đoạn mã thông thường. Nếu số lượng MQ của bạn không nhiều, phương pháp này cũng không có vấn đề gì. Tuy nhiên, khi số lượng tăng lên, bạn sẽ cần xem xét sử dụng một số mẫu thiết kế để giải quyết vấn đề.</li></ul><h3 id="trien-khai-nhan-tin-nhan-mq" tabindex="-1"><a class="header-anchor" href="#trien-khai-nhan-tin-nhan-mq"><span>Triển khai nhận tin nhắn MQ</span></a></h3><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> CreateAccountMqService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> onMessage</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> message</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        CreateAccount</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> mq</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> JSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">parseObject</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(message, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">CreateAccount</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">class</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        mq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getNumber</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        mq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getAccountDate</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">        // ... Xử lý nghiệp vụ của riêng bạn  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><ul><li>Xử lý tin nhắn MQ cho ba nhóm MQ đều tương tự như trên. Tôi không mô tả từng bước một, bạn có thể xem thêm trong mã nguồn.</li></ul><h2 id="tai-cau-truc-theo-adapter-pattern" tabindex="-1"><a class="header-anchor" href="#tai-cau-truc-theo-adapter-pattern"><span>Tái cấu trúc theo Adapter Pattern</span></a></h2><p><strong>Tiếp theo, chúng ta sẽ sử dụng mẫu Adapter để tối ưu mã, đồng thời cũng là một lần tái cấu trúc nhỏ.</strong></p><p>Vấn đề chính mà mẫu Adapter giải quyết là thống nhất đầu ra từ nhiều loại interface khác biệt, điều này cũng đã được đề cập trong việc học mẫu Factory Method, khi xử lý các loại phần thưởng khác nhau, thực ra cũng là ứng dụng của Adapter.</p><p>Trong bài viết này, chúng ta cũng sẽ thấy một tình huống sử dụng MQ với nhiều loại tin nhắn khác nhau. Để xử lý chúng một cách thống nhất, giúp giảm thiểu công việc sau này với việc nhận tin nhắn từ MQ.</p><p>Nếu bạn trước đây chưa phát triển chức năng nhận tin nhắn từ MQ, có thể sẽ không hiểu rõ tình huống này. Đối với điều này, tôi cá nhân khuyên bạn nên tìm hiểu về MQ trước. Hơn nữa, thậm chí nếu không hiểu, cũng không vấn đề gì, điều này không ảnh hưởng đến việc hiểu cách tư duy.</p><p>Hơn nữa, phần lõi của việc tương thích với MQ mà bài viết này trình bày, chính là việc xử lý việc điều chỉnh các trường dữ liệu khác nhau. Và nếu chúng ta nhận tin nhắn từ MQ, khi cấu hình các lớp tiêu thụ khác nhau, nếu không muốn phát triển từng lớp một, bạn có thể sử dụng cách tiếp cận của lớp proxy để xử lý.</p><h3 id="cau-truc-du-an-1" tabindex="-1"><a class="header-anchor" href="#cau-truc-du-an-1"><span>Cấu trúc dự án</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">design-demo-6-02/</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">├──</span><span style="color:#98C379;--shiki-dark:#98C379;"> pom.xml</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">└──</span><span style="color:#98C379;--shiki-dark:#98C379;"> src</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> main</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> java</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">            └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> com</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> hnv99</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                    └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> design</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                        ├──</span><span style="color:#98C379;--shiki-dark:#98C379;"> MQAdapter.java</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                        ├──</span><span style="color:#98C379;--shiki-dark:#98C379;"> OrderAdapterService.java</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                        ├──</span><span style="color:#98C379;--shiki-dark:#98C379;"> RebateInfo.java</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                        └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> cuisine</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                            └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> impl</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                                ├──</span><span style="color:#98C379;--shiki-dark:#98C379;"> InsideOrderService.java</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                                └──</span><span style="color:#98C379;--shiki-dark:#98C379;"> POPOrderAdapterServiceImpl.java</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Cấu trúc mô hình Adapter</strong></p><ul><li>Đây bao gồm hai loại Adapter: Adapter Interface và Adapter MQ. Lý do không chỉ giả lập việc điều chỉnh Interface là vì nhiều khi mọi người đã quen thuộc, vì vậy, chúng tôi thay đổi cách suy nghĩ về việc áp dụng mô hình Adapter vào thân tin nhắn MQ, để tăng cường hiểu biết về nhiều mẫu thiết kế.</li><li><strong>Đầu tiên là việc thực hiện điều chỉnh MQ</strong>, nhận các loại tin nhắn MQ khác nhau. Khi doanh nghiệp phát triển nhanh chóng và cần phải thưởng cho người dùng đặt hàng đầu tiên, trong tình huống như vậy, chúng ta thêm hoạt động <strong>điều chỉnh interface</strong>.</li></ul><h3 id="trien-khai-code-đieu-chinh-thong-bao-mq" tabindex="-1"><a class="header-anchor" href="#trien-khai-code-đieu-chinh-thong-bao-mq"><span>Triển khai code (điều chỉnh thông báo MQ)</span></a></h3><h4 id="noi-dung-tin-nhan-mq-thong-nhat" tabindex="-1"><a class="header-anchor" href="#noi-dung-tin-nhan-mq-thong-nhat"><span>Nội dung tin nhắn MQ thống nhất</span></a></h4><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> RebateInfo</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> userId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">  // ID người dùng</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> bizId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">   // ID nghiệp vụ</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Date</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> bizTime</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">   // Thời gian nghiệp vụ</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> String</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> desc</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // Mô tả</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">    // ... getter/setter</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><ul><li>Trong tin nhắn MQ có thể có nhiều loại thuộc tính khác nhau, mặc dù tất cả chúng đều cung cấp cùng một giá trị cho bên sử dụng, nhưng nếu chúng ta tiếp tục kết nối theo cách này, khi có nhiều tin nhắn MQ thì sẽ rất rắc rối.</li><li>Vì vậy, trong ví dụ này, chúng ta đã định nghĩa một thân tin nhắn MQ thông thường, sau đó tiến hành xử lý tất cả các tin nhắn đến một cách thống nhất.</li></ul><h4 id="lop-chuyen-đoi-noi-dung-tin-nhan-mq" tabindex="-1"><a class="header-anchor" href="#lop-chuyen-đoi-noi-dung-tin-nhan-mq"><span>Lớp chuyển đổi nội dung tin nhắn MQ</span></a></h4><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> MQAdapter</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> static</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> RebateInfo</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> filter</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> strJson</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Map</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;">link</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> throws</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> NoSuchMethodException</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> InvocationTargetException</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> IllegalAccessException</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> filter</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">JSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">parseObject</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(strJson, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Map</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">class</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), link);</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> static</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> RebateInfo</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> filter</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Map</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> obj</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Map</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;">link</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> throws</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> NoSuchMethodException</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> InvocationTargetException</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> IllegalAccessException</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        RebateInfo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> rebateInfo</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> RebateInfo</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        for</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> key</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> :</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> link</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">keySet</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">()) {</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">            Object</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> val</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> obj</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">get</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">link</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">get</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(key));</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">            RebateInfo</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">class</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getMethod</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;set&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> key</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">substring</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">).</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">toUpperCase</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">() </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">+</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> key</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">substring</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">class</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">).</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">invoke</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(rebateInfo, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">val</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">toString</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> rebateInfo;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Phương thức trong lớp này rất quan trọng, chủ yếu được sử dụng để ánh xạ các thuộc tính từ các loại MQ khác nhau thành các thuộc tính chúng ta cần và trả về. Giống như một thuộc tính có <code>ID người dùng: uId</code>, ánh xạ thành điều chúng ta cần; <code>userId</code>, để xử lý một cách thống nhất.</li><li>Trong quá trình xử lý này, cần chuyển quản lý ánh xạ cho <code>Map&lt;String, String&gt; link</code>, nó chính xác mô tả tên thuộc tính hiện tại của MQ, ánh xạ thành tên thuộc tính của chúng tôi.</li><li>Cuối cùng, vì chúng ta nhận được các tin nhắn <code>mq</code> cơ bản đều có định dạng <code>json</code>, có thể chuyển đổi thành cấu trúc MAP. Sau đó sử dụng phương thức gọi ngược để gán giá trị cho kiểu của chúng ta.</li></ul><h4 id="kiem-thu" tabindex="-1"><a class="header-anchor" href="#kiem-thu"><span>Kiểm thử</span></a></h4><p><strong>Unit test</strong></p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> ApiTest</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    @</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Test</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> testMQAdapter</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> throws</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> NoSuchMethodException</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> IllegalAccessException</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> InvocationTargetException</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> ParseException</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        SimpleDateFormat</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> s</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> SimpleDateFormat</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;yyyy-MM-dd HH:mm:ss&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        Date</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> parse</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> s</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">parse</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;2020-06-01 23:20:16&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        CreateAccount</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> createAccount</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> CreateAccount</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        createAccount</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setNumber</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;100001&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        createAccount</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setAddress</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Thu Duc, HCMC, Vietnam&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        createAccount</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setAccountDate</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(parse);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        createAccount</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setDesc</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Mo tai khoan phong gym&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        HashMap</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#E06C75;--shiki-dark:#E06C75;">link01</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> HashMap</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;&gt;();  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        link01</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">put</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;userId&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;number&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        link01</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">put</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;bizId&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;number&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        link01</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">put</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;bizTime&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;accountDate&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        link01</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">put</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;desc&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;desc&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        RebateInfo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> rebateInfo01</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> MQAdapter</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">filter</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">createAccount</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">toString</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(), link01);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        System</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">out</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">println</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;mq.CreateAccount(Trước khi điều chỉnh): &quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> createAccount</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">toString</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">());  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        System</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">out</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">println</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;mq.CreateAccount(Sau khi điều chỉnh): &quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> JSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">toJSONString</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(rebateInfo01));  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        System</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">out</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">println</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        OrderMq</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> orderMq</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> OrderMq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        orderMq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setUid</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;100001&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        orderMq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setSku</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;10928092093111123&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        orderMq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setOrderId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;100000890193847111&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        orderMq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setCreateOrderTime</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(parse);  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        HashMap</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#E06C75;--shiki-dark:#E06C75;">link02</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> HashMap</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;();  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        link02</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">put</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;userId&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;uid&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        link02</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">put</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;bizId&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;orderId&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        link02</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">put</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;bizTime&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;createOrderTime&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        RebateInfo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> rebateInfo02</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> MQAdapter</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">filter</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">orderMq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">toString</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(), link02);  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        System</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">out</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">println</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;mq.orderMq(Trước khi điều chỉnh): &quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> orderMq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">toString</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">());  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        System</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">out</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">println</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;mq.orderMq(Sau khi điều chỉnh): &quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> JSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">toJSONString</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(rebateInfo02));  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Ở đây, chúng ta mô phỏng việc truyền vào hai loại tin nhắn MQ khác nhau và thiết lập quan hệ ánh xạ giữa các trường.</li><li>Trong thực tế, khi phát triển các tình huống kinh doanh thực sự, chúng ta có thể cấu hình quan hệ ánh xạ như vậy vào tệp cấu hình hoặc cơ sở dữ liệu, giảm thiểu mã hóa.</li></ul><p><strong>Kết quả</strong></p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mq.CreateAccount(Trước</span><span style="color:#98C379;--shiki-dark:#98C379;"> khi</span><span style="color:#98C379;--shiki-dark:#98C379;"> điều</span><span style="color:#98C379;--shiki-dark:#98C379;"> chỉnh</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">): {</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;accountDate&quot;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">:1591028416000,</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;address&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;Thu Duc, HCMC, Vietnam&quot;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">,</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;desc&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;Mo tai khoan phong gym&quot;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">,</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;number&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;100001&quot;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">}</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mq.CreateAccount(Sau</span><span style="color:#98C379;--shiki-dark:#98C379;"> khi</span><span style="color:#98C379;--shiki-dark:#98C379;"> điều</span><span style="color:#98C379;--shiki-dark:#98C379;"> chỉnh</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">): {</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;bizId&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;100001&quot;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">,</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;bizTime&quot;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">:1591028416000,</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;desc&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;Mo tai khoan phong gym&quot;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">,</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;userId&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;100001&quot;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mq.orderMq(Trước</span><span style="color:#98C379;--shiki-dark:#98C379;"> khi</span><span style="color:#98C379;--shiki-dark:#98C379;"> điều</span><span style="color:#98C379;--shiki-dark:#98C379;"> chỉnh</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">): {</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;createOrderTime&quot;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">:1591028416000,</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;orderId&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;100000890193847111&quot;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">,</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;sku&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;10928092093111123&quot;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">,</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;uid&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;100001&quot;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">}</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mq.orderMq(Sau</span><span style="color:#98C379;--shiki-dark:#98C379;"> khi</span><span style="color:#98C379;--shiki-dark:#98C379;"> điều</span><span style="color:#98C379;--shiki-dark:#98C379;"> chỉnh</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">): {</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;bizId&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;100000890193847111&quot;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">,</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;bizTime&quot;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">:1591028416000,</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;userId&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;100001&quot;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">}</span></span></code></pre></div><ul><li>Từ kết quả trên, bạn có thể thấy rằng cùng một trường giá trị trong tin nhắn đã được thống nhất sau khi điều chỉnh, giúp quá trình xử lý trong kinh doanh trở nên đơn giản hơn.</li><li>Ngoài ra, một điều rất quan trọng trong phát triển thực tế là, ngoài việc sử dụng reflect, chúng ta cũng có thể thêm một <strong>lớp proxy</strong> để chuyển quản lý cấu hình ánh xạ cho nó. Điều này giúp chúng ta không cần phải tạo từng lớp mq một cách thủ công.</li></ul><h3 id="trien-khai-code-su-dung-adapter-interface" tabindex="-1"><a class="header-anchor" href="#trien-khai-code-su-dung-adapter-interface"><span>Triển khai code (Sử dụng Adapter Interface)</span></a></h3><p>Như chúng ta đã đề cập trước đó, với sự phát triển của doanh nghiệp, chính chương trình khuyến mãi cũng cần được điều chỉnh. Không thể chỉ nhận tin nhắn từ MQ mà không phát phần thưởng. Vì lúc này, số lượng người mới tham gia đã tăng lên, và cần phải thực hiện một số hạn chế.</p><p>Vì đã thêm điều kiện chỉ có người đặt hàng đầu tiên mới được thưởng, nghĩa là chỉ có đơn hàng đầu tiên của bạn trong năm hoặc chỉ trong một tháng mới được thưởng, không phải mỗi lần đặt hàng trước đó đều được thưởng.</p><p>Vậy nên, cần hạn chế theo cách này và trong tin nhắn MQ không có thuộc tính để kiểm tra đơn đầu tiên. Chỉ có thể thực hiện truy vấn thông qua giao diện và nhận được giao diện như sau;</p><table><thead><tr><th>Interface</th><th>Mô tả</th></tr></thead><tbody><tr><td>com.hnv99.design.service.OrderService.queryUserOrderCount(String userId)</td><td>Đầu ra là long, truy vấn số lượng đơn hàng</td></tr><tr><td>com.hnv99.design.service.OrderService.POPOrderService.isFirstOrder(String uId)</td><td>Đầu ra là boolean, kiểm tra xem đó có phải là đơn đầu tiên không</td></tr></tbody></table><ul><li>Logic kiểm tra và cách sử dụng của hai interface này đều khác nhau, trả về kiểu khác nhau. Một cái là kiểm tra xem đó có phải là đơn hàng đầu tiên không, cái kia cần phải kiểm tra dựa trên số lượng đơn hàng.</li><li>Vì vậy, ở đây cần sử dụng mẫu Adapter để triển khai. Tất nhiên, bạn cũng có thể triển khai bằng câu lệnh if, nhưng chúng ta thường nói rằng mã như vậy khó bảo trì.</li></ul><h4 id="đinh-nghia-adapter-interface-thong-nhat" tabindex="-1"><a class="header-anchor" href="#đinh-nghia-adapter-interface-thong-nhat"><span>Định nghĩa adapter interface thống nhất</span></a></h4><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> interface</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> OrderAdapterService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    boolean</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> isFirst</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> uId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><p>Các lớp triển khai sau cần triển khai interface này và đóng gói logic cụ thể vào lớp được chỉ định, đáp ứng nguyên tắc trách nhiệm duy nhất.</p><h4 id="trien-khai-hai-lop-khac-nhau" tabindex="-1"><a class="header-anchor" href="#trien-khai-hai-lop-khac-nhau"><span>Triển khai hai lớp khác nhau</span></a></h4><p><strong>Lớp Sản phẩm Nội bộ</strong></p><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> InsideOrderService</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> implements</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> OrderAdapterService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> OrderService</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> orderService </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> OrderService</span><span style="color:#E06C75;--shiki-dark:#E06C75;">()</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> boolean</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> isFirst</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> uId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> orderService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">queryUserOrderCount</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(uId) </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">&lt;=</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><p><strong>Lớp Sản phẩm của Bên thứ ba</strong></p><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> POPOrderAdapterServiceImpl</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> implements</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> OrderAdapterService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> POPOrderService</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> popOrderService </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> POPOrderService</span><span style="color:#E06C75;--shiki-dark:#E06C75;">()</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> boolean</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> isFirst</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> uId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> popOrderService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">isFirstOrder</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(uId);</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><ul><li>Trong hai lớp này, đều triển khai cách kiểm tra riêng của chúng, đặc biệt là lớp cung cấp số lượng đơn hàng, cần phải tự kiểm tra xem số lượng đơn hàng nhận được khi nhận mq có <code>&lt;= 1</code>, từ đó xác định xem đó có phải là đơn hàng đầu tiên không.</li></ul><h4 id="kiem-thu-1" tabindex="-1"><a class="header-anchor" href="#kiem-thu-1"><span>Kiểm thử</span></a></h4><p><strong>Unit test</strong></p><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">@</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Test</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> testItfAdapter</span><span style="color:#E06C75;--shiki-dark:#E06C75;">() {  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    OrderAdapterService</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> popOrderAdapterService </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> POPOrderAdapterServiceImpl</span><span style="color:#E06C75;--shiki-dark:#E06C75;">()</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    System</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">out</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">println</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Kiểm tra đơn hàng đầu tiên, giao diện điều chỉnh(POP): &quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> popOrderAdapterService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">isFirst</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;100001&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">));</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    OrderAdapterService</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> insideOrderService </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> InsideOrderService</span><span style="color:#E06C75;--shiki-dark:#E06C75;">()</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    System</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">out</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">println</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Kiểm tra đơn hàng đầu tiên, giao diện điều chỉnh(Doanh nghiệp tự vận hành): &quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> insideOrderService</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">isFirst</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;100001&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">));</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">}</span></span></code></pre></div><p><strong>Kết quả</strong></p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2024-03-27</span><span style="color:#98C379;--shiki-dark:#98C379;"> 22:44:07.909</span><span style="color:#98C379;--shiki-dark:#98C379;">	INFO</span><span style="color:#98C379;--shiki-dark:#98C379;">	main</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">		(POPOrderService.java:11)	|	</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Cửa</span><span style="color:#98C379;--shiki-dark:#98C379;"> hàng</span><span style="color:#98C379;--shiki-dark:#98C379;"> POP,</span><span style="color:#98C379;--shiki-dark:#98C379;"> truy</span><span style="color:#98C379;--shiki-dark:#98C379;"> vấn</span><span style="color:#98C379;--shiki-dark:#98C379;"> xem</span><span style="color:#98C379;--shiki-dark:#98C379;"> đơn</span><span style="color:#98C379;--shiki-dark:#98C379;"> hàng</span><span style="color:#98C379;--shiki-dark:#98C379;"> của</span><span style="color:#98C379;--shiki-dark:#98C379;"> người</span><span style="color:#98C379;--shiki-dark:#98C379;"> dùng</span><span style="color:#98C379;--shiki-dark:#98C379;"> có</span><span style="color:#98C379;--shiki-dark:#98C379;"> phải</span><span style="color:#98C379;--shiki-dark:#98C379;"> là</span><span style="color:#98C379;--shiki-dark:#98C379;"> đơn</span><span style="color:#98C379;--shiki-dark:#98C379;"> hàng</span><span style="color:#98C379;--shiki-dark:#98C379;"> đầu</span><span style="color:#98C379;--shiki-dark:#98C379;"> tiên</span><span style="color:#98C379;--shiki-dark:#98C379;"> không:</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 100001</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Kiểm</span><span style="color:#98C379;--shiki-dark:#98C379;"> tra</span><span style="color:#98C379;--shiki-dark:#98C379;"> đơn</span><span style="color:#98C379;--shiki-dark:#98C379;"> hàng</span><span style="color:#98C379;--shiki-dark:#98C379;"> đầu</span><span style="color:#98C379;--shiki-dark:#98C379;"> tiên,</span><span style="color:#98C379;--shiki-dark:#98C379;"> giao</span><span style="color:#98C379;--shiki-dark:#98C379;"> diện</span><span style="color:#98C379;--shiki-dark:#98C379;"> điều</span><span style="color:#98C379;--shiki-dark:#98C379;"> chỉnh</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">POP</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#98C379;--shiki-dark:#98C379;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> true</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2024-03-27</span><span style="color:#98C379;--shiki-dark:#98C379;"> 22:44:07.915</span><span style="color:#98C379;--shiki-dark:#98C379;">	INFO</span><span style="color:#98C379;--shiki-dark:#98C379;">	main</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">		(OrderService.java:10)	|	</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Cửa</span><span style="color:#98C379;--shiki-dark:#98C379;"> hàng</span><span style="color:#98C379;--shiki-dark:#98C379;"> tự</span><span style="color:#98C379;--shiki-dark:#98C379;"> kinh</span><span style="color:#98C379;--shiki-dark:#98C379;"> doanh,</span><span style="color:#98C379;--shiki-dark:#98C379;"> truy</span><span style="color:#98C379;--shiki-dark:#98C379;"> vấn</span><span style="color:#98C379;--shiki-dark:#98C379;"> xem</span><span style="color:#98C379;--shiki-dark:#98C379;"> số</span><span style="color:#98C379;--shiki-dark:#98C379;"> đơn</span><span style="color:#98C379;--shiki-dark:#98C379;"> hàng</span><span style="color:#98C379;--shiki-dark:#98C379;"> của</span><span style="color:#98C379;--shiki-dark:#98C379;"> người</span><span style="color:#98C379;--shiki-dark:#98C379;"> dùng</span><span style="color:#98C379;--shiki-dark:#98C379;"> có</span><span style="color:#98C379;--shiki-dark:#98C379;"> phải</span><span style="color:#98C379;--shiki-dark:#98C379;"> là</span><span style="color:#98C379;--shiki-dark:#98C379;"> đơn</span><span style="color:#98C379;--shiki-dark:#98C379;"> hàng</span><span style="color:#98C379;--shiki-dark:#98C379;"> đầu</span><span style="color:#98C379;--shiki-dark:#98C379;"> tiên</span><span style="color:#98C379;--shiki-dark:#98C379;"> không:</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 100001</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Kiểm</span><span style="color:#98C379;--shiki-dark:#98C379;"> tra</span><span style="color:#98C379;--shiki-dark:#98C379;"> đơn</span><span style="color:#98C379;--shiki-dark:#98C379;"> hàng</span><span style="color:#98C379;--shiki-dark:#98C379;"> đầu</span><span style="color:#98C379;--shiki-dark:#98C379;"> tiên,</span><span style="color:#98C379;--shiki-dark:#98C379;"> giao</span><span style="color:#98C379;--shiki-dark:#98C379;"> diện</span><span style="color:#98C379;--shiki-dark:#98C379;"> điều</span><span style="color:#98C379;--shiki-dark:#98C379;"> chỉnh</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Doanh</span><span style="color:#98C379;--shiki-dark:#98C379;"> nghiệp</span><span style="color:#98C379;--shiki-dark:#98C379;"> tự</span><span style="color:#98C379;--shiki-dark:#98C379;"> vận</span><span style="color:#98C379;--shiki-dark:#98C379;"> hành</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#98C379;--shiki-dark:#98C379;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> false</span></span></code></pre></div><ul><li>Từ kết quả kiểm thử trên, có thể thấy rằng các lớp đã được đóng gói một cách thống nhất, khi sử dụng bên ngoài không cần quan tâm đến logic cụ thể bên trong. Và khi gọi, chỉ cần truyền tham số thống nhất là được, điều này đáp ứng mục đích của việc sử dụng Adapter.</li></ul><h2 id="tong-ket" tabindex="-1"><a class="header-anchor" href="#tong-ket"><span>Tổng kết</span></a></h2><ul><li>Từ các phần trước, có thể thấy rằng, các chức năng có thể được triển khai mà không sử dụng mẫu Adapter, nhưng việc sử dụng mẫu Adapter có thể làm cho mã nguồn: sạch sẽ, dễ bảo trì, giảm thiểu số lượng lớn các câu lệnh điều kiện lặp lại và làm cho mã nguồn dễ bảo trì và mở rộng hơn.</li><li>Đặc biệt, khi chúng ta phải điều chỉnh các giá trị thuộc tính khác nhau của các loại thông điệp trong MQ như nhau, sau đó sử dụng lớp proxy, chúng ta có thể dễ dàng kết nối các thông điệp MQ được cung cấp bởi bên thứ ba bằng cách sử dụng cách cấu hình đơn giản mà không cần phải phát triển lại nhiều. Điều này rất thuận lợi cho việc mở rộng.</li><li>Quá trình học mẫu thiết kế có thể sẽ đề cập đến các mẫu thiết kế khác trong một số chương, nhưng không chú trọng vào việc giảng dạy, để tránh làm xáo trộn cảm xúc. Tuy nhiên, trong việc sử dụng thực tế, thường các mẫu thiết kế được sử dụng kết hợp, không phải lúc nào cũng xuất hiện độc lập.</li></ul>`,94),p=[r];function o(t,e){return a(),n("div",null,p)}const k=s(l,[["render",o],["__file","adapter.html.vue"]]),h=JSON.parse('{"path":"/design/design-pattern/practical/structural/adapter.html","title":"Adapter Pattern Practice","lang":"en-US","frontmatter":{"title":"Adapter Pattern Practice","tags":["design-pattern"],"categories":null,"date created":"2024-03-27T00:00:00.000Z","date modified":"2024-03-27T00:00:00.000Z","description":"Adapter Pattern Practice: Giới thiệu 80% diện tích của giấy vệ sinh đều được dùng để bảo vệ tay! Sau khi làm việc được khoảng vài năm, phần lớn lập trình viên đều muốn nâng cao ...","head":[["meta",{"property":"og:url","content":"https://vanhung4499.github.io/design/design-pattern/practical/structural/adapter.html"}],["meta",{"property":"og:site_name","content":"VanHung4499"}],["meta",{"property":"og:title","content":"Adapter Pattern Practice"}],["meta",{"property":"og:description","content":"Adapter Pattern Practice: Giới thiệu 80% diện tích của giấy vệ sinh đều được dùng để bảo vệ tay! Sau khi làm việc được khoảng vài năm, phần lớn lập trình viên đều muốn nâng cao ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240327200238.png"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-06-28T15:54:38.000Z"}],["meta",{"property":"article:author","content":"Hung Nguyen"}],["meta",{"property":"article:tag","content":"design-pattern"}],["meta",{"property":"article:modified_time","content":"2024-06-28T15:54:38.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Adapter Pattern Practice\\",\\"image\\":[\\"https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240327200238.png\\"],\\"dateModified\\":\\"2024-06-28T15:54:38.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Hung Nguyen\\",\\"url\\":\\"https://vanhung4499.github.io\\"}]}"]]},"headers":[{"level":2,"title":"Giới thiệu","slug":"gioi-thieu","link":"#gioi-thieu","children":[]},{"level":2,"title":"Môi trường phát triển","slug":"moi-truong-phat-trien","link":"#moi-truong-phat-trien","children":[]},{"level":2,"title":"Giới thiệu về Adapter Pattern","slug":"gioi-thieu-ve-adapter-pattern","link":"#gioi-thieu-ve-adapter-pattern","children":[]},{"level":2,"title":"Mô phỏng kịch bản","slug":"mo-phong-kich-ban","link":"#mo-phong-kich-ban","children":[{"level":3,"title":"Dự án mô phỏng kịch bản","slug":"du-an-mo-phong-kich-ban","link":"#du-an-mo-phong-kich-ban","children":[]},{"level":3,"title":"Mô tả ngắn gọn","slug":"mo-ta-ngan-gon","link":"#mo-ta-ngan-gon","children":[]}]},{"level":2,"title":"Triển khai code","slug":"trien-khai-code","link":"#trien-khai-code","children":[{"level":3,"title":"Cấu trúc dự án","slug":"cau-truc-du-an","link":"#cau-truc-du-an","children":[]},{"level":3,"title":"Triển khai nhận tin nhắn MQ","slug":"trien-khai-nhan-tin-nhan-mq","link":"#trien-khai-nhan-tin-nhan-mq","children":[]}]},{"level":2,"title":"Tái cấu trúc theo Adapter Pattern","slug":"tai-cau-truc-theo-adapter-pattern","link":"#tai-cau-truc-theo-adapter-pattern","children":[{"level":3,"title":"Cấu trúc dự án","slug":"cau-truc-du-an-1","link":"#cau-truc-du-an-1","children":[]},{"level":3,"title":"Triển khai code (điều chỉnh thông báo MQ)","slug":"trien-khai-code-đieu-chinh-thong-bao-mq","link":"#trien-khai-code-đieu-chinh-thong-bao-mq","children":[]},{"level":3,"title":"Triển khai code (Sử dụng Adapter Interface)","slug":"trien-khai-code-su-dung-adapter-interface","link":"#trien-khai-code-su-dung-adapter-interface","children":[]}]},{"level":2,"title":"Tổng kết","slug":"tong-ket","link":"#tong-ket","children":[]}],"git":{"createdTime":1719590078000,"updatedTime":1719590078000,"contributors":[{"name":"Hung Nguyen Van","email":"vanhung4499@gmail.com","commits":1}]},"readingTime":{"minutes":15.83,"words":4750},"filePathRelative":"design/design-pattern/practical/structural/adapter.md","localizedDate":"June 28, 2024","excerpt":"\\n<h2>Giới thiệu</h2>\\n<p><strong>80% diện tích của giấy vệ sinh đều được dùng để bảo vệ tay!</strong></p>\\n<p>Sau khi làm việc được khoảng vài năm, phần lớn lập trình viên đều muốn nâng cao năng lực kỹ thuật của mình, bắt đầu thử đọc mã nguồn một số thư viện, ví dụ như <code>Spring</code>, <code>Mybatis</code>, <code>Dubbo</code>, vv. Nhưng khi đọc, họ càng thấy khó hiểu hơn, đôi khi từ một nơi này sang một nơi khác. Thậm chí cảm thấy nghi ngờ về kỹ thuật của mình, dần dần không muốn tiếp cận vào kiến thức này nữa.</p>","autoDesc":true}');export{k as comp,h as data};
