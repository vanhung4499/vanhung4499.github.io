import{_ as r,o as a,c as n,a as i}from"./app-5QVbWi7Z.js";const o={};function s(l,e){return a(),n("div",null,e[0]||(e[0]=[i('<h1 id="公众号粉丝" tabindex="-1"><a class="header-anchor" href="#公众号粉丝"><span>公众号粉丝</span></a></h1><p>本章节，讲解公众号粉丝的相关内容，包括关注、取消关注等等，对应 <a href="https://developers.weixin.qq.com/doc/offiaccount/User_Management/Getting_a_User_List.html" target="_blank" rel="noopener noreferrer">《微信公众号官方文档 —— 获取用户列表》</a> 文档。</p><figure><img src="https://doc.iocoder.cn/img/公众号手册/公众号粉丝/界面.png" alt="粉丝管理" tabindex="0" loading="lazy"><figcaption>粉丝管理</figcaption></figure><h2 id="_1-表结构" tabindex="-1"><a class="header-anchor" href="#_1-表结构"><span><a href="#_1-%E8%A1%A8%E7%BB%93%E6%9E%84">#</a> 1. 表结构</span></a></h2><p>公众号粉丝对应 <code>mp_user</code> 表，结构如下图所示：</p><figure><img src="https://doc.iocoder.cn/img/公众号手册/公众号粉丝/表结构.png" alt="表结构" tabindex="0" loading="lazy"><figcaption>表结构</figcaption></figure><p>注意，自 2021-12-27 开始，公众号接口不再返回头像和昵称，只能通过微信公众号的网页登录获取。因此，表中的 <code>avatar</code> 和 <code>nickname</code> 字段，往往是空的。</p><h2 id="_2-粉丝管理界面" tabindex="-1"><a class="header-anchor" href="#_2-粉丝管理界面"><span><a href="#_2-%E7%B2%89%E4%B8%9D%E7%AE%A1%E7%90%86%E7%95%8C%E9%9D%A2">#</a> 2. 粉丝管理界面</span></a></h2><ul><li>前端：<a href="https://github.com/yudaocode/yudao-ui-admin-vue2/blob/master/src/views/mp/user/index.vue" target="_blank" rel="noopener noreferrer">/@views/mp/user</a></li><li>后端：<a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-mp/yudao-module-mp-biz/src/main/java/cn/iocoder/yudao/module/mp/controller/admin/user/MpUserController.java" target="_blank" rel="noopener noreferrer">MpUserController</a></li></ul><h2 id="_3-同步粉丝" tabindex="-1"><a class="header-anchor" href="#_3-同步粉丝"><span><a href="#_3-%E5%90%8C%E6%AD%A5%E7%B2%89%E4%B8%9D">#</a> 3. 同步粉丝</span></a></h2><p>点击粉丝管理界面的【同步】按钮，可以 <strong>异步</strong> 从公众号同步所有的粉丝信息，存储到 <code>mp_user</code> 表中。如果你的粉丝较多，可能需要等待一段时间。</p><p>对应后端的 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-mp/yudao-module-mp-biz/src/main/java/cn/iocoder/yudao/module/mp/service/user/MpUserServiceImpl.java#L95-L161" target="_blank" rel="noopener noreferrer">MpUserServiceImpl</a> 的 <code>syncUser</code> 方法。</p><h2 id="_4-关注-subscribehandler" tabindex="-1"><a class="header-anchor" href="#_4-关注-subscribehandler"><span><a href="#_4-%E5%85%B3%E6%B3%A8-subscribehandler">#</a> 4. 关注 SubscribeHandler</span></a></h2><p>用户关注公众号时，会触发 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-mp/yudao-module-mp-biz/src/main/java/cn/iocoder/yudao/module/mp/service/handler/user/SubscribeHandler.java" target="_blank" rel="noopener noreferrer">SubscribeHandler</a> 处理器，新增或修改 <code>mp_user</code> 粉丝信息。</p><figure><img src="https://doc.iocoder.cn/img/公众号手册/公众号粉丝/SubscribeHandler.png" alt="SubscribeHandler" tabindex="0" loading="lazy"><figcaption>SubscribeHandler</figcaption></figure><h2 id="_5-取关-unsubscribehandler" tabindex="-1"><a class="header-anchor" href="#_5-取关-unsubscribehandler"><span><a href="#_5-%E5%8F%96%E5%85%B3-unsubscribehandler">#</a> 5. 取关 UnsubscribeHandler</span></a></h2><p>用户取消关注公众号时，会触发 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-mp/yudao-module-mp-biz/src/main/java/cn/iocoder/yudao/module/mp/service/handler/user/UnsubscribeHandler.java" target="_blank" rel="noopener noreferrer">UnsubscribeHandler</a> 处理器，标记 <code>mp_user</code> 粉丝信息为取消关注，设置 <code>subscribe_status</code> 字段为 0。</p><figure><img src="https://doc.iocoder.cn/img/公众号手册/公众号粉丝/UnsubscribeHandler.png" alt="UnsubscribeHandler" tabindex="0" loading="lazy"><figcaption>UnsubscribeHandler</figcaption></figure>',18)]))}const d=r(o,[["render",s],["__file","user.html.vue"]]),t=JSON.parse('{"path":"/project/rouyi-vue-pro/mp/user.html","title":"公众号粉丝","lang":"en-US","frontmatter":{"title":"公众号粉丝","tags":["project","java","spring-boot","spring-cloud"],"categories":["project"],"order":148,"feed":false,"seo":false,"head":[]},"headers":[{"level":2,"title":"# 1. 表结构","slug":"_1-表结构","link":"#_1-表结构","children":[]},{"level":2,"title":"# 2. 粉丝管理界面","slug":"_2-粉丝管理界面","link":"#_2-粉丝管理界面","children":[]},{"level":2,"title":"# 3. 同步粉丝","slug":"_3-同步粉丝","link":"#_3-同步粉丝","children":[]},{"level":2,"title":"# 4. 关注 SubscribeHandler","slug":"_4-关注-subscribehandler","link":"#_4-关注-subscribehandler","children":[]},{"level":2,"title":"# 5. 取关 UnsubscribeHandler","slug":"_5-取关-unsubscribehandler","link":"#_5-取关-unsubscribehandler","children":[]}],"git":{"createdTime":1720365235000,"updatedTime":1720365235000,"contributors":[{"name":"Hung Nguyen Van","email":"vanhung4499@gmail.com","commits":1}]},"readingTime":{"minutes":1.7,"words":511},"filePathRelative":"project/rouyi-vue-pro/mp/user.md","localizedDate":"July 7, 2024"}');export{d as comp,t as data};
