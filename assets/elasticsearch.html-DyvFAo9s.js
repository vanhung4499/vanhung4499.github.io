import{_ as e,o as t,c as a,d as s}from"./app-B-Bgbu6w.js";const n={},r=s(`<h1 id="spring-accessing-elasticsearch" tabindex="-1"><a class="header-anchor" href="#spring-accessing-elasticsearch"><span>Spring Accessing Elasticsearch</span></a></h1><h2 id="gioi-thieu" tabindex="-1"><a class="header-anchor" href="#gioi-thieu"><span>Giới thiệu</span></a></h2><p><a href="https://www.elastic.co/products/elasticsearch" target="_blank" rel="noopener noreferrer">Elasticsearch</a> là một công cụ tìm kiếm và phân tích phân tán mã nguồn mở.</p><h3 id="ket-noi-elasticsearch-thong-qua-rest-client" tabindex="-1"><a class="header-anchor" href="#ket-noi-elasticsearch-thong-qua-rest-client"><span>Kết nối Elasticsearch thông qua REST Client</span></a></h3><p>Nếu có tệp JAR <code>org.elasticsearch.client:elasticsearch-rest-client</code> trong classpath, Spring Boot sẽ tự động cấu hình và đăng ký một Bean <code>RestClient</code>, mặc định là <code>localhost:9200</code>.</p><p>Bạn có thể tùy chỉnh như sau:</p><div class="language-properties" data-ext="properties" data-title="properties"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">spring.elasticsearch.rest.uris</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">http://search.example.com:9200</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">spring.elasticsearch.rest.username</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">user</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">spring.elasticsearch.rest.password</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">secret</span></span></code></pre></div><p>Bạn cũng có thể đăng ký các <code>RestClientBuilderCustomizer</code> bean để tùy chỉnh cao cấp hơn. Để hoàn toàn kiểm soát việc đăng ký, hãy định nghĩa một Bean <code>RestClient</code>.</p><p>Nếu có tệp JAR <code>org.elasticsearch.client:elasticsearch-rest-high-level-client</code> trong classpath, Spring Boot sẽ tự động cấu hình một <code>RestHighLevelClient</code>, nó bao gồm bất kỳ <code>RestClient</code> bean nào hiện có và tái sử dụng cấu hình HTTP của nó.</p><h3 id="ket-noi-elasticsearch-thong-qua-jest" tabindex="-1"><a class="header-anchor" href="#ket-noi-elasticsearch-thong-qua-jest"><span>Kết nối Elasticsearch thông qua Jest</span></a></h3><p>Nếu có Jest trong classpath, bạn có thể tiêm vào một <code>JestClient</code> được tự động cấu hình, mặc định là <code>localhost:9200</code>. Bạn có thể tinh chỉnh cấu hình của client như ví dụ dưới đây:</p><div class="language-properties" data-ext="properties" data-title="properties"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">spring.elasticsearch.jest.uris</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">http://search.example.com:9200</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">spring.elasticsearch.jest.read-timeout</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">10000</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">spring.elasticsearch.jest.username</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">user</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">spring.elasticsearch.jest.password</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">secret</span></span></code></pre></div><p>Bạn cũng có thể đăng ký các <code>HttpClientConfigBuilderCustomizer</code> bean để tùy chỉnh cao cấp hơn. Ví dụ dưới đây điều chỉnh các thiết lập HTTP khác:</p><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">static</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> HttpSettingsCustomizer</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> implements</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> HttpClientConfigBuilderCustomizer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">	@</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Override</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">	public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> customize</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">HttpClientConfig</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Builder</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> builder</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">		builder</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">maxTotalConnection</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#D19A66;--shiki-dark:#D19A66;">100</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">).</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">defaultMaxTotalConnectionPerRoute</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#D19A66;--shiki-dark:#D19A66;">5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><p>Để hoàn toàn kiểm soát việc đăng ký, hãy định nghĩa một Bean <code>JestClient</code>.</p><h3 id="truy-cap-elasticsearch-thong-qua-spring-data" tabindex="-1"><a class="header-anchor" href="#truy-cap-elasticsearch-thong-qua-spring-data"><span>Truy cập Elasticsearch thông qua Spring Data</span></a></h3><p>Để kết nối với Elasticsearch, bạn phải cung cấp địa chỉ của một hoặc nhiều nút cụm. Bạn có thể chỉ định địa chỉ bằng cách đặt thuộc tính <code>spring.data.elasticsearch.cluster-nodes</code> thành một danh sách <code>host:port</code> phân tách bằng dấu phẩy. Với cấu hình này, bạn có thể tiêm vào <code>ElasticsearchTemplate</code> hoặc <code>TransportClient</code> như bất kỳ bean Spring nào khác, như ví dụ dưới đây:</p><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">spring</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">data</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">elasticsearch</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">cluster</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-</span><span style="color:#E06C75;--shiki-dark:#E06C75;">nodes</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#E06C75;--shiki-dark:#E06C75;">localhost</span><span style="color:#C678DD;--shiki-dark:#C678DD;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">9300</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">@</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Component</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> MyBean</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">	private</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> final</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> ElasticsearchTemplate</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> template</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">	public</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> MyBean</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">ElasticsearchTemplate</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> template</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">		this</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">template</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> template;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">	// ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><p>Nếu bạn thêm một <code>@Bean</code> <code>ElasticsearchTemplate</code> hoặc <code>TransportClient</code> tùy chỉnh, nó sẽ thay thế cấu hình mặc định.</p><h3 id="elasticsearch-repositories" tabindex="-1"><a class="header-anchor" href="#elasticsearch-repositories"><span>Elasticsearch Repositories</span></a></h3><p>Spring Data cung cấp hỗ trợ repository cho Elasticsearch. Nguyên tắc cơ bản là xây dựng truy vấn tự động dựa trên tên phương thức.</p><p>Thực tế, Spring Data JPA và Spring Data Elasticsearch chia sẻ cơ sở hạ tầng chung.</p><h2 id="ma-nguon" tabindex="-1"><a class="header-anchor" href="#ma-nguon"><span>Mã nguồn</span></a></h2><p>Ví dụ đầy đủ: Comming soon</p><p>Spring và Elasticsearch tương ứng với phiên bản như sau:</p><table><thead><tr><th style="text-align:center;">Spring Data Elasticsearch</th><th style="text-align:center;">Elasticsearch</th><th style="text-align:center;">Spring Framework</th><th style="text-align:center;">Spring Boot</th></tr></thead><tbody><tr><td style="text-align:center;">5.0.x</td><td style="text-align:center;">8.5.3</td><td style="text-align:center;">6.0.x</td><td style="text-align:center;">3.0.x</td></tr><tr><td style="text-align:center;">4.4.x</td><td style="text-align:center;">7.17.3</td><td style="text-align:center;">5.3.x</td><td style="text-align:center;">2.7.x</td></tr><tr><td style="text-align:center;">4.3.x</td><td style="text-align:center;">7.15.2</td><td style="text-align:center;">5.3.x</td><td style="text-align:center;">2.6.x</td></tr><tr><td style="text-align:center;">4.2.x[<a href="https://docs.spring.io/spring-data/elasticsearch/docs/current/reference/html/#_footnotedef_1" target="_blank" rel="noopener noreferrer">1</a>]</td><td style="text-align:center;">7.12.0</td><td style="text-align:center;">5.3.x</td><td style="text-align:center;">2.5.x</td></tr><tr><td style="text-align:center;">4.1.x[<a href="https://docs.spring.io/spring-data/elasticsearch/docs/current/reference/html/#_footnotedef_1" target="_blank" rel="noopener noreferrer">1</a>]</td><td style="text-align:center;">7.9.3</td><td style="text-align:center;">5.3.2</td><td style="text-align:center;">2.4.x</td></tr><tr><td style="text-align:center;">4.0.x[<a href="https://docs.spring.io/spring-data/elasticsearch/docs/current/reference/html/#_footnotedef_1" target="_blank" rel="noopener noreferrer">1</a>]</td><td style="text-align:center;">7.6.2</td><td style="text-align:center;">5.2.12</td><td style="text-align:center;">2.3.x</td></tr><tr><td style="text-align:center;">3.2.x[<a href="https://docs.spring.io/spring-data/elasticsearch/docs/current/reference/html/#_footnotedef_1" target="_blank" rel="noopener noreferrer">1</a>]</td><td style="text-align:center;">6.8.12</td><td style="text-align:center;">5.2.12</td><td style="text-align:center;">2.2.x</td></tr><tr><td style="text-align:center;">3.1.x[<a href="https://docs.spring.io/spring-data/elasticsearch/docs/current/reference/html/#_footnotedef_1" target="_blank" rel="noopener noreferrer">1</a>]</td><td style="text-align:center;">6.2.2</td><td style="text-align:center;">5.1.19</td><td style="text-align:center;">2.1.x</td></tr><tr><td style="text-align:center;">3.0.x[<a href="https://docs.spring.io/spring-data/elasticsearch/docs/current/reference/html/#_footnotedef_1" target="_blank" rel="noopener noreferrer">1</a>]</td><td style="text-align:center;">5.5.0</td><td style="text-align:center;">5.0.13</td><td style="text-align:center;">2.0.x</td></tr><tr><td style="text-align:center;">2.1.x[<a href="https://docs.spring.io/spring-data/elasticsearch/docs/current/reference/html/#_footnotedef_1" target="_blank" rel="noopener noreferrer">1</a>]</td><td style="text-align:center;">2.4.0</td><td style="text-align:center;">4.3.25</td><td style="text-align:center;">1.5.x</td></tr></tbody></table><h2 id="tai-lieu-tham-khao" tabindex="-1"><a class="header-anchor" href="#tai-lieu-tham-khao"><span>Tài liệu tham khảo</span></a></h2><ul><li><strong>Chính thức</strong><ul><li><a href="https://www.elastic.co/cn/products/elasticsearch" target="_blank" rel="noopener noreferrer">Trang chủ Elasticsearch</a></li><li><a href="https://github.com/elastic/elasticsearch" target="_blank" rel="noopener noreferrer">Elasticsearch Github</a></li><li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html" target="_blank" rel="noopener noreferrer">Tài liệu chính thức Elasticsearch</a></li><li><a href="https://www.elastic.co/guide/en/elasticsearch/guide/master/index.html" target="_blank" rel="noopener noreferrer">Elasticsearch: The Definitive Guide</a> - Tài liệu học tập chính thức của Elasticsearch</li></ul></li><li><a href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-elasticsearch" target="_blank" rel="noopener noreferrer">Tài liệu Spring Boot về boot-features-elasticsearch</a></li><li><a href="https://github.com/spring-projects/spring-data-elasticsearch" target="_blank" rel="noopener noreferrer">Spring Data Elasticsearch trên Github</a></li><li><a href="https://docs.spring.io/spring-data/elasticsearch/docs/current/reference/html/" target="_blank" rel="noopener noreferrer">Tài liệu chính thức Spring Data Elasticsearch</a></li></ul>`,28),i=[r];function c(l,o){return t(),a("div",null,i)}const h=e(n,[["render",c],["__file","elasticsearch.html.vue"]]),d=JSON.parse('{"path":"/framework/spring/data/elasticsearch.html","title":"Spring Access ElasticSearch","lang":"en-US","frontmatter":{"title":"Spring Access ElasticSearch","tags":["spring","java","db","backend","elasticssearch"],"categories":["spring","java","db","backend"],"date created":"2023-08-11T00:00:00.000Z","date modified":"2024-02-22T00:00:00.000Z","order":9,"description":"Spring Accessing Elasticsearch Giới thiệu Elasticsearch là một công cụ tìm kiếm và phân tích phân tán mã nguồn mở. Kết nối Elasticsearch thông qua REST Client Nếu có tệp JAR org...","head":[["meta",{"property":"og:url","content":"https://vanhung4499.github.io/framework/spring/data/elasticsearch.html"}],["meta",{"property":"og:site_name","content":"VanHung4499"}],["meta",{"property":"og:title","content":"Spring Access ElasticSearch"}],["meta",{"property":"og:description","content":"Spring Accessing Elasticsearch Giới thiệu Elasticsearch là một công cụ tìm kiếm và phân tích phân tán mã nguồn mở. Kết nối Elasticsearch thông qua REST Client Nếu có tệp JAR org..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-06-28T15:54:38.000Z"}],["meta",{"property":"article:author","content":"Hung Nguyen"}],["meta",{"property":"article:tag","content":"spring"}],["meta",{"property":"article:tag","content":"java"}],["meta",{"property":"article:tag","content":"db"}],["meta",{"property":"article:tag","content":"backend"}],["meta",{"property":"article:tag","content":"elasticssearch"}],["meta",{"property":"article:modified_time","content":"2024-06-28T15:54:38.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Spring Access ElasticSearch\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-06-28T15:54:38.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Hung Nguyen\\",\\"url\\":\\"https://vanhung4499.github.io\\"}]}"]]},"headers":[{"level":2,"title":"Giới thiệu","slug":"gioi-thieu","link":"#gioi-thieu","children":[{"level":3,"title":"Kết nối Elasticsearch thông qua REST Client","slug":"ket-noi-elasticsearch-thong-qua-rest-client","link":"#ket-noi-elasticsearch-thong-qua-rest-client","children":[]},{"level":3,"title":"Kết nối Elasticsearch thông qua Jest","slug":"ket-noi-elasticsearch-thong-qua-jest","link":"#ket-noi-elasticsearch-thong-qua-jest","children":[]},{"level":3,"title":"Truy cập Elasticsearch thông qua Spring Data","slug":"truy-cap-elasticsearch-thong-qua-spring-data","link":"#truy-cap-elasticsearch-thong-qua-spring-data","children":[]},{"level":3,"title":"Elasticsearch Repositories","slug":"elasticsearch-repositories","link":"#elasticsearch-repositories","children":[]}]},{"level":2,"title":"Mã nguồn","slug":"ma-nguon","link":"#ma-nguon","children":[]},{"level":2,"title":"Tài liệu tham khảo","slug":"tai-lieu-tham-khao","link":"#tai-lieu-tham-khao","children":[]}],"git":{"createdTime":1719590078000,"updatedTime":1719590078000,"contributors":[{"name":"Hung Nguyen Van","email":"vanhung4499@gmail.com","commits":1}]},"readingTime":{"minutes":2.45,"words":735},"filePathRelative":"framework/spring/data/elasticsearch.md","localizedDate":"June 28, 2024","excerpt":"\\n<h2>Giới thiệu</h2>\\n<p><a href=\\"https://www.elastic.co/products/elasticsearch\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">Elasticsearch</a> là một công cụ tìm kiếm và phân tích phân tán mã nguồn mở.</p>\\n<h3>Kết nối Elasticsearch thông qua REST Client</h3>\\n<p>Nếu có tệp JAR <code>org.elasticsearch.client:elasticsearch-rest-client</code> trong classpath, Spring Boot sẽ tự động cấu hình và đăng ký một Bean <code>RestClient</code>, mặc định là <code>localhost:9200</code>.</p>","autoDesc":true}');export{h as comp,d as data};
