import{_ as s,o as a,c as n,d as i}from"./app-BsgpqssW.js";const t={},l=i(`<h1 id="mau-thiet-ke-flyweight" tabindex="-1"><a class="header-anchor" href="#mau-thiet-ke-flyweight"><span>Mẫu thiết kế Flyweight</span></a></h1><h2 id="y-nghia" tabindex="-1"><a class="header-anchor" href="#y-nghia"><span>Ý nghĩa</span></a></h2><p><strong>Flyweight Pattern</strong> là một mẫu thiết kế cấu trúc, nó loại bỏ cách lưu trữ tất cả dữ liệu trong mỗi đối tượng bằng cách chia sẻ trạng thái chung giữa nhiều đối tượng, cho phép bạn tải nhiều đối tượng hơn trong một dung lượng bộ nhớ hạn chế.</p><h2 id="ung-dung" tabindex="-1"><a class="header-anchor" href="#ung-dung"><span>Ứng dụng</span></a></h2><ul><li>Sử dụng Flyweight Pattern chỉ khi chương trình phải hỗ trợ một lượng lớn đối tượng và không đủ dung lượng bộ nhớ.</li></ul><h2 id="cau-truc" tabindex="-1"><a class="header-anchor" href="#cau-truc"><span>Cấu trúc</span></a></h2><figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20210430182947.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h3 id="giai-thich-cau-truc" tabindex="-1"><a class="header-anchor" href="#giai-thich-cau-truc"><span>Giải thích cấu trúc</span></a></h3><ol><li>Flyweight Pattern chỉ là một phương pháp tối ưu hóa. Trước khi áp dụng mẫu này, bạn phải xác định vấn đề về tiêu thụ bộ nhớ liên quan đến việc cùng lúc sử dụng nhiều đối tượng tương tự và đảm bảo rằng vấn đề này không thể được giải quyết bằng cách khác.</li><li>Lớp <strong>Flyweight</strong> chứa một phần trạng thái chung trong các đối tượng gốc. Cùng một đối tượng Flyweight có thể được sử dụng trong nhiều tình huống khác nhau. Trạng thái được lưu trữ trong Flyweight được gọi là &quot;trạng thái nội tại&quot;. Trạng thái được truyền vào phương thức Flyweight được gọi là &quot;trạng thái bên ngoài&quot;.</li><li>Lớp <strong>Context</strong> chứa trạng thái bên ngoài khác nhau của đối tượng gốc. Context kết hợp với đối tượng Flyweight để đại diện cho toàn bộ trạng thái của đối tượng gốc.</li><li>Thông thường, hành vi của đối tượng gốc được giữ trong lớp Flyweight. Do đó, việc gọi phương thức Flyweight phải cung cấp một số trạng thái bên ngoài làm tham số. Tuy nhiên, bạn cũng có thể di chuyển hành vi vào lớp Context, sau đó xem Flyweight kết nối như một đối tượng dữ liệu thuần túy.</li><li><strong>Client</strong> chịu trách nhiệm tính toán hoặc lưu trữ trạng thái bên ngoài của Flyweight. Đối với khách hàng, Flyweight là một mẫu đối tượng mà có thể được cấu hình tại thời điểm chạy bằng cách truyền một số dữ liệu tình huống vào phương thức của nó.</li><li><strong>Flyweight Factory</strong> quản lý bể cache của Flyweight đã có. Có Factory, khách hàng không cần tạo Flyweight trực tiếp, chỉ cần gọi Factory và truyền vào một số trạng thái nội tại của Flyweight mục tiêu. Factory sẽ tìm kiếm trong các Flyweight đã tạo trước đó dựa trên tham số và trả về nếu tìm thấy; nếu không tìm thấy, nó sẽ tạo mới Flyweight dựa trên tham số.</li></ol><h3 id="mau-code-cau-truc" tabindex="-1"><a class="header-anchor" href="#mau-code-cau-truc"><span>Mẫu code cấu trúc</span></a></h3><p><strong>Flyweight</strong>: Nó là lớp cha hoặc giao diện của tất cả các lớp Flyweight cụ thể, thông qua giao diện này, Flyweight có thể chấp nhận và tác động lên trạng thái bên ngoài.</p><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">abstract</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Flyweight</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> abstract</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> operation</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#C678DD;--shiki-dark:#C678DD;">int</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> extrinsicstates</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><p><strong>ConcreteFlyweight</strong>: Là lớp con của Flyweight hoặc triển khai giao diện Flyweight, và tăng thêm không gian lưu trữ cho trạng thái nội tại.</p><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> ConcreteFlyweight</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> extends</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Flyweight</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    @</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Override</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> operation</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#C678DD;--shiki-dark:#C678DD;">int</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> extrinsicstates</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        System</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">out</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">println</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Flyweight được chia sẻ: &quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> extrinsicstates);</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><p><strong>UnsharedConcreteFlyweight</strong>: Đề cập đến những lớp Flyweight con không cần chia sẻ, vì giao diện Flyweight cho phép chia sẻ, nhưng nó không bắt buộc chia sẻ.</p><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> UnsharedConcreteFlyweight</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> extends</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Flyweight</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    @</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">Override</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> operation</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#C678DD;--shiki-dark:#C678DD;">int</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> extrinsicstates</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        System</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">out</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">println</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Flyweight không được chia sẻ: &quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> +</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> extrinsicstates);</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><p><strong>FlywightFactory</strong>: Là một nhà máy Flyweight, được sử dụng để tạo và quản lý các đối tượng Flyweight. Nó chủ yếu để đảm bảo việc chia sẻ Flyweight một cách hợp lý, khi người dùng yêu cầu một Flyweight, đối tượng FlyweightFactory cung cấp một phiên bản đã tạo trước hoặc tạo mới (nếu đối tượng không tồn tại).</p><div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> FlywightFactory</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    private</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Hashtable</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Flyweight</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> flyweights </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Hashtable</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Flyweight</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">()</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> FlywightFactory</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">()</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        flyweights</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">put</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;X&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#C678DD;--shiki-dark:#C678DD;">new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> ConcreteFlyweight</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        flyweights</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">put</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Y&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#C678DD;--shiki-dark:#C678DD;">new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> ConcreteFlyweight</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        flyweights</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">put</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Z&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#C678DD;--shiki-dark:#C678DD;">new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> ConcreteFlyweight</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Flyweight</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> getFlyweight</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;"> key</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        return</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ((Flyweight)</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">flyweights</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">get</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(key));</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><p><strong>Client</strong></p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> FlyweightPattern</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    public</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> static</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> main</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[] </span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic;">args</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        int</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> extrinsicstates</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        FlywightFactory</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> factory</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> FlywightFactory</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        Flyweight</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> fx</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> factory</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getFlyweight</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;X&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        fx</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">operation</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(extrinsicstates);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        Flyweight</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> fy</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> factory</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getFlyweight</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Y&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        fy</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">operation</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(++extrinsicstates);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        Flyweight</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> fz</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> factory</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getFlyweight</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Z&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        fz</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">operation</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(++extrinsicstates);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        Flyweight</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> uf</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> UnsharedConcreteFlyweight</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        uf</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">operation</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(++extrinsicstates);</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Output</strong></p><div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span>Flyweight được chia sẻ: 1</span></span>
<span class="line"><span>Flyweight được chia sẻ: 2</span></span>
<span class="line"><span>Flyweight được chia sẻ: 3</span></span>
<span class="line"><span>Flyweight không được chia sẻ: 4</span></span></code></pre></div><h2 id="pseudocode" tabindex="-1"><a class="header-anchor" href="#pseudocode"><span>Pseudocode</span></a></h2><p>Trong ví dụ này, <strong>Flyweight Pattern</strong> giúp giảm thiểu lượng bộ nhớ cần thiết khi vẽ hàng triệu đối tượng cây trên bề mặt.</p><p>Mẫu này trích xuất trạng thái nội tại từ lớp chính <code>Cây</code> và di chuyển nó vào lớp Flyweight <code>Loại cây</code>.</p><p>Ban đầu, chương trình cần lưu trữ dữ liệu giống nhau trong nhiều đối tượng, nhưng bây giờ chỉ cần lưu trữ dữ liệu trong một số đối tượng Flyweight và sau đó kết nối chúng vào đối tượng <code>Cây</code> như một tình huống. Mã khách hàng sử dụng Flyweight Factory để tạo đối tượng cây và đóng gói hành vi phức tạp của việc tìm kiếm đối tượng cụ thể, và có thể tái sử dụng đối tượng khi cần thiết.</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">// Lớp Flyweight chứa một phần trạng thái của cây. Các biến thành viên này lưu trữ các giá trị duy nhất đối với cây cụ thể. Ví dụ, bạn sẽ không tìm thấy tọa độ của cây ở đây. Nhưng bạn sẽ tìm thấy các dữ liệu chung như mẫu và màu sắc giữa nhiều cây. Vì dữ liệu này thường có kích thước lớn, nếu lưu trữ chúng trong mỗi cây sẽ tốn rất nhiều bộ nhớ. Vì vậy, bạn có thể xuất dữ liệu mẫu, màu sắc và các dữ liệu lặp lại khác vào một đối tượng riêng biệt, sau đó cho phép nhiều đối tượng cây đơn lẻ tham chiếu đến nó.</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> TreeType</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> is</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    field name</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    field color</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    field texture</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    constructor TreeType(name, color, texture) </span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">{</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ...</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> }</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    method </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">draw</span><span style="color:#E06C75;--shiki-dark:#E06C75;">(canvas</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> x</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> y) is</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">        // 1. Tạo một bitmap cho loại cây, màu sắc và mẫu cụ thể.</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">        // 2. Vẽ bitmap tại tọa độ (X, Y) trên bề mặt.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">// Flyweight Factory quyết định xem có tái sử dụng Flyweight hiện có hay tạo một đối tượng mới.</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> TreeFactory</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> is</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    static</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> field treeTypes: collection of tree types</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    static</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> method getTreeType(name, color, texture) is</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        type = treeTypes.find(name, color, texture)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        if (type == null)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">            type = new TreeType(name, color, texture)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">            treeTypes.add(type)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        return type</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">// Lớp Context chứa phần trạng thái bên ngoài của cây. Chương trình có thể tạo hàng tỷ đối tượng như vậy vì chúng có kích thước nhỏ: chỉ có hai tọa độ nguyên và một biến thành viên tham chiếu.</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Tree</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> is</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    field x,y</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    field type: TreeType</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    constructor Tree(x, y, type) </span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">{</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ...</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> }</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    method </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">draw</span><span style="color:#E06C75;--shiki-dark:#E06C75;">(canvas) is</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">        type</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">draw</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(canvas, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">this</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">x</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">this</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">y</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic;">// Lớp Tree và Forest là khách hàng của Flyweight. Nếu bạn không có kế hoạch mở rộng lớp Tree, bạn có thể kết hợp chúng.</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> Forest</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> is</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    field trees: collection of Trees</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    method plantTree(x, y, name, color, texture) is</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        type = TreeFactory.getTreeType(name, color, texture)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        tree = new Tree(x, y, type)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        trees.add(tree)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    method draw(canvas) is</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        foreach (tree in trees) do</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">            tree.draw(canvas)</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="vi-du" tabindex="-1"><a class="header-anchor" href="#vi-du"><span>Ví dụ</span></a></h2><p><strong>Ví dụ sử dụng:</strong> Flyweight Pattern chỉ có một mục đích: giảm thiểu lượng bộ nhớ tiêu thụ. Nếu chương trình của bạn không gặp vấn đề về dung lượng bộ nhớ không đủ, bạn có thể tạm thời bỏ qua mẫu này.</p><p>Ví dụ về Flyweight Pattern trong thư viện Java cốt lõi:</p><ul><li><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Integer.html#valueOf-int-" target="_blank" rel="noopener noreferrer"><code>java.lang.Integer#valueOf(int)</code></a> (cũng như <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Boolean.html#valueOf-boolean-" target="_blank" rel="noopener noreferrer"><code>Boolean</code></a>、 <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Byte.html#valueOf-byte-" target="_blank" rel="noopener noreferrer"><code>Byte</code></a>、 <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Character.html#valueOf-char-" target="_blank" rel="noopener noreferrer"><code>Character</code></a>、 <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Short.html#valueOf-short-" target="_blank" rel="noopener noreferrer"><code>Short</code></a>、 <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Long.html#valueOf-long-" target="_blank" rel="noopener noreferrer"><code>Long</code></a> và <a href="https://docs.oracle.com/javase/8/docs/api/java/math/BigDecimal.html#valueOf-long-int-" target="_blank" rel="noopener noreferrer"><code>Big­Decimal</code></a>)</li></ul><p><strong>Cách nhận biết:</strong> Flyweight có thể được nhận biết thông qua phương thức xây dựng, nó trả về đối tượng cache thay vì tạo đối tượng mới.</p><h2 id="moi-quan-he-voi-cac-mau-khac" tabindex="-1"><a class="header-anchor" href="#moi-quan-he-voi-cac-mau-khac"><span>Mối quan hệ với các mẫu khác</span></a></h2><ul><li>Bạn có thể sử dụng [[Flyweight Pattern]] để triển khai các nút lá được chia sẻ trong [[Composite Pattern]] để tiết kiệm bộ nhớ.</li><li>[[Flyweight Pattern]] cho thấy cách tạo ra nhiều đối tượng nhỏ, trong khi mẫu [[Facade Pattern]] cho thấy cách sử dụng một đối tượng để đại diện cho toàn bộ hệ thống con.</li><li>Nếu bạn có thể đơn giản hóa tất cả trạng thái chia sẻ của đối tượng thành một đối tượng Flyweight, thì [[Flyweight Pattern]] sẽ trở nên giống với [[Singleton Pattern]]. Tuy nhiên, hai mẫu này có hai khác biệt cơ bản. <ol><li>Chỉ có một thực thể duy nhất của Singleton, trong khi lớp Flyweight có thể có nhiều thực thể và trạng thái nội tại của chúng cũng có thể khác nhau.</li><li>Đối tượng Singleton có thể thay đổi, trong khi đối tượng Flyweight là không thay đổi.</li></ol></li></ul>`,34),e=[l];function r(c,o){return a(),n("div",null,e)}const h=s(t,[["render",r],["__file","flyweight.html.vue"]]),d=JSON.parse('{"path":"/design/design-pattern/patterns/structural/flyweight.html","title":"Flyweight Pattern","lang":"en-US","frontmatter":{"title":"Flyweight Pattern","tags":null,"categories":null,"date created":"2023-10-06T00:00:00.000Z","date modified":"2023-10-06T00:00:00.000Z","description":"Mẫu thiết kế Flyweight Ý nghĩa Flyweight Pattern là một mẫu thiết kế cấu trúc, nó loại bỏ cách lưu trữ tất cả dữ liệu trong mỗi đối tượng bằng cách chia sẻ trạng thái chung giữa...","head":[["meta",{"property":"og:url","content":"https://vanhung4499.github.io/design/design-pattern/patterns/structural/flyweight.html"}],["meta",{"property":"og:site_name","content":"VanHung4499"}],["meta",{"property":"og:title","content":"Flyweight Pattern"}],["meta",{"property":"og:description","content":"Mẫu thiết kế Flyweight Ý nghĩa Flyweight Pattern là một mẫu thiết kế cấu trúc, nó loại bỏ cách lưu trữ tất cả dữ liệu trong mỗi đối tượng bằng cách chia sẻ trạng thái chung giữa..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://raw.githubusercontent.com/vanhung4499/images/master/snap/20210430182947.png"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-06-28T15:54:38.000Z"}],["meta",{"property":"article:author","content":"Hung Nguyen"}],["meta",{"property":"article:modified_time","content":"2024-06-28T15:54:38.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Flyweight Pattern\\",\\"image\\":[\\"https://raw.githubusercontent.com/vanhung4499/images/master/snap/20210430182947.png\\"],\\"dateModified\\":\\"2024-06-28T15:54:38.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Hung Nguyen\\",\\"url\\":\\"https://vanhung4499.github.io\\"}]}"]]},"headers":[{"level":2,"title":"Ý nghĩa","slug":"y-nghia","link":"#y-nghia","children":[]},{"level":2,"title":"Ứng dụng","slug":"ung-dung","link":"#ung-dung","children":[]},{"level":2,"title":"Cấu trúc","slug":"cau-truc","link":"#cau-truc","children":[{"level":3,"title":"Giải thích cấu trúc","slug":"giai-thich-cau-truc","link":"#giai-thich-cau-truc","children":[]},{"level":3,"title":"Mẫu code cấu trúc","slug":"mau-code-cau-truc","link":"#mau-code-cau-truc","children":[]}]},{"level":2,"title":"Pseudocode","slug":"pseudocode","link":"#pseudocode","children":[]},{"level":2,"title":"Ví dụ","slug":"vi-du","link":"#vi-du","children":[]},{"level":2,"title":"Mối quan hệ với các mẫu khác","slug":"moi-quan-he-voi-cac-mau-khac","link":"#moi-quan-he-voi-cac-mau-khac","children":[]}],"git":{"createdTime":1719590078000,"updatedTime":1719590078000,"contributors":[{"name":"Hung Nguyen Van","email":"vanhung4499@gmail.com","commits":1}]},"readingTime":{"minutes":6.58,"words":1975},"filePathRelative":"design/design-pattern/patterns/structural/flyweight.md","localizedDate":"June 28, 2024","excerpt":"\\n<h2>Ý nghĩa</h2>\\n<p><strong>Flyweight Pattern</strong> là một mẫu thiết kế cấu trúc, nó loại bỏ cách lưu trữ tất cả dữ liệu trong mỗi đối tượng bằng cách chia sẻ trạng thái chung giữa nhiều đối tượng, cho phép bạn tải nhiều đối tượng hơn trong một dung lượng bộ nhớ hạn chế.</p>\\n<h2>Ứng dụng</h2>\\n<ul>\\n<li>Sử dụng Flyweight Pattern chỉ khi chương trình phải hỗ trợ một lượng lớn đối tượng và không đủ dung lượng bộ nhớ.</li>\\n</ul>","autoDesc":true}');export{h as comp,d as data};
