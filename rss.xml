<?xml version="1.0" encoding="utf-8"?><?xml-stylesheet type="text/xsl" href="https://vanhung4499.github.io/rss.xsl"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <atom:link href="https://vanhung4499.github.io/rss.xml" rel="self" type="application/rss+xml"/>
    <title>VanHung4499</title>
    <link>https://vanhung4499.github.io/</link>
    <description>My personal wiki and blog</description>
    <language>en-US</language>
    <pubDate>Sun, 30 Jun 2024 06:40:48 GMT</pubDate>
    <lastBuildDate>Sun, 30 Jun 2024 06:40:48 GMT</lastBuildDate>
    <generator>@vuepress/plugin-feed</generator>
    <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
    <category>about</category>
    <category>blog</category>
    <category>database</category>
    <category>devops</category>
    <category>framework</category>
    <category>programming</category>
    <category>project</category>
    <category>any</category>
    <category>elastic</category>
    <category>elasticssearch</category>
    <category>mongodb</category>
    <category>nosql</category>
    <category>db</category>
    <category>mysql</category>
    <category>redis</category>
    <category>interview</category>
    <category>sql</category>
    <category>design</category>
    <category>design-pattern</category>
    <category>Docker</category>
    <category>git</category>
    <category>kubernetes</category>
    <category>linux</category>
    <category>dsa</category>
    <category>algorithm</category>
    <category>data-structure</category>
    <category>leetcode</category>
    <item>
      <title>About Me</title>
      <link>https://vanhung4499.github.io/about-me.html</link>
      <guid>https://vanhung4499.github.io/about-me.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">About Me</source>
      <description>About Me Profile Exploration &amp; geek enthusiast, software engineer, hackintosher | Currently focusing on backend development with main directions in Spring | Discovering a bigger...</description>
      <category>about</category>
      <pubDate>Sun, 12 Mar 2023 00:00:00 GMT</pubDate>
      <content:encoded><![CDATA[

<h2>Profile</h2>
<p><em>Exploration &amp; geek enthusiast, software engineer, hackintosher | Currently focusing on backend development with main directions in Spring | Discovering a bigger world together with you.</em></p>
<h2>Skills</h2>
<h3>Languages</h3>
<img src="https://skillicons.dev/icons?i=java,golang,javascript,ts,python,html,css,regex,md,bash&amp;theme=dark&amp;&amp;perline=10" alt="Skills">
<h3>Frameworks</h3>
<img src="https://skillicons.dev/icons?i=spring,nodejs,nestjs,react,nextjs,vue,redux&amp;theme=dark&amp;&amp;perline=10" alt="Skills">
<h3>Databases</h3>
<img src="https://skillicons.dev/icons?i=mysql,redis,mongodb,elasticsearch&amp;theme=dark&amp;&amp;perline=10" alt="Skills">
<h3>Others</h3>
<img src="https://skillicons.dev/icons?i=vim,idea,vscode,aws,figma,gradle,maven,npm,gcp,docker,kubernetes,git,github,gitlab,rabbitmq,kafka,jenkins,linux,postman,linkedin,stackoverflow,svg&amp;theme=dark&amp;&amp;perline=10" alt="Skills">
<h2>Github Summary</h2>
<img src="https://github-trophies.vercel.app/?username=vanhung4499&amp;theme=radical&amp;margin-w=25" alt="Github Summary">
<img src="https://github-readme-stats.vercel.app/api/top-langs/?username=vanhung4499&amp;theme=radical&amp;layout=compact&amp;bg_color=30,ef475d,904e95&amp;title_color=fff&amp;text_color=fff">
<img src="https://github-readme-stats.vercel.app/api?username=vanhung4499&amp;count_private=true&amp;show_icons=true&amp;theme=radical&amp;bg_color=30,ef475d,904e95&amp;title_color=fff&amp;text_color=fff">
<h2>Preview</h2>
<figure><img src="https://count.getloli.com/get/@:vanhung4499?theme=gelbooru-h" alt=":Augenestern-creator" tabindex="0" loading="lazy"><figcaption>:Augenestern-creator</figcaption></figure>
<h2>Activity Graph</h2>
<figure><a href="https://github.com/OrageKK/github-readme-activity-graph" target="_blank" rel="noopener noreferrer"><img src="https://github-readme-activity-graph-sandy.vercel.app/graph?username=vanhung4499&amp;theme=dracula" alt="Ashutosh's github activity graph" tabindex="0" loading="lazy"></a><figcaption>Ashutosh's github activity graph</figcaption></figure>
<h2>About This Site</h2>
<p><a href="/about">About</a></p>
]]></content:encoded>
      <enclosure url="https://count.getloli.com/get/@:vanhung4499?theme=gelbooru-h" type="image/"/>
    </item>
    <item>
      <title>About this site</title>
      <link>https://vanhung4499.github.io/about.html</link>
      <guid>https://vanhung4499.github.io/about.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">About this site</source>
      <description>About this site âœ¨ğŸ“’ Record the process of building this site, and share some thoughts and experiences. Introduction My previous wiki was built with Quartz, which is a publish to...</description>
      <category>blog</category>
      <pubDate>Tue, 14 Mar 2023 21:45:45 GMT</pubDate>
      <content:encoded><![CDATA[
<div class="hint-container info">
<p class="hint-container-title">âœ¨ğŸ“’</p>
<p>Record the process of building this site, and share some thoughts and experiences.</p>
</div>
<h2>Introduction</h2>
<p>My previous wiki was built with <a href="https://quartz.jzhao.xyz/" target="_blank" rel="noopener noreferrer">Quartz</a>, which is a publish tool for obsidian nots. I have been using it for a long time, but I found that it is not very convenient to share and search because of the navigation and the structure of the page. So I need to find a better alternative.</p>
<p>After some searching on github, I found some good-looking wiki/blog sites. I tried some of them then the last choice of me is <a href="https://v2.vuepress.vuejs.org/zh/" target="_blank" rel="noopener noreferrer">VuePress</a>, which is a static site generator based on Vue.js. It is very easy to use and has a lot of plugins and themes. I chose the <a href="https://theme-hope.vuejs.press/zh/" target="_blank" rel="noopener noreferrer">vuepress-theme-hope</a> theme, which is very beautiful and has a lot of features.</p>
<p>And I found a customized of hope theme, which is <a href="https://github.com/OrageKK/oragekk.github.io" target="_blank" rel="noopener noreferrer">https://github.com/OrageKK/oragekk.github.io</a>, It is very beautiful and has a lot of features. So I forked it and made some changes to fit my needs. Thanks to the author for the great work.</p>
<h2>Markdown Enhancement</h2>
<p>The Markdown effect of the hope theme is surprisingly good, and it supports many features that ordinary Markdown does not, such as custom containers, code blocks with tabs, and the most convenient feature of being able to write flowcharts directly. It also allows for optional highlight themes (the code highlighting on this site is based on shikiPlugin, which, although not as lightweight and efficient as the default prismjs, provides more accurate syntax highlighting). For specific effects, see here â˜ <a href="https://theme-hope.vuejs.press/guide/markdown/intro.html" target="_blank" rel="noopener noreferrer">Markdown Enhance</a>.</p>
<h2>Project Structure</h2>
<div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2">.</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> .github</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> ISSUE_TEMPLATE</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"> # Issue templates</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â””â”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> bug-report.yml</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â””â”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> workflows</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">       â””â”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> deploy-docs.yml</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"> # Deployment script</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> CNAME</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> LICENSE</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> README.md</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> api</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â””â”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> proxy.js</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"> # Cross-origin proxy</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> env.d.ts</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> package.json</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> pnpm-lock.yaml</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> script</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> requirements.txt</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â””â”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> submit.py</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"> # GitHub Actions script for submitting URLs</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> src</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> .vuepress</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> client.ts</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"> # Client configuration file</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> components</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> MyCoverLink.vue</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"> # Friend link component</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â””â”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> Mylink.vue</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"> # Card component</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> config.ts</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"> # VuePress configuration file</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> data</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"> # Data</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> navbar</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> plugins</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> vuepress-plugin-canvas</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> vuepress-plugin-gradient-cover</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> vuepress-plugin-hitokoto</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> vuepress-plugin-live2DAssist</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â””â”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> vuepress-plugin-popper</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> public</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> assets</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"> # Resources</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> sidebar</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> styles</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> theme</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> api</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â””â”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> bing.ts</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"> # Bing daily wallpaper</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> components</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"> # Custom components</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> index.ts</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> layouts</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"> # Custom layouts</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â””â”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> utils</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">       â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> busuanzi.pure.js</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"> # Busuanzi statistics</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">       â””â”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> time.ts</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"> # Runtime</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â””â”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> theme.ts</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"> # Theme configuration file</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”‚</span><span style="color:#98C379;--shiki-dark:#98C379">   â””â”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> README.md</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â”œâ”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> tsconfig.json</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">â””â”€â”€</span><span style="color:#98C379;--shiki-dark:#98C379"> vercel.json</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"> # Vercel configuration file</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>Framework Support</h2>
<p><a href="https://v2.vuepress.vuejs.org/" target="_blank" rel="noopener noreferrer">vuepress2.x</a></p>
<h2>Theme Support</h2>
<p><a href="https://theme-hope.vuejs.press/" target="_blank" rel="noopener noreferrer">vuepress-theme-hope</a></p>
<h2>Markdown Editor</h2>
<p>I use <a href="https://obsidian.md/" target="_blank" rel="noopener noreferrer">Obsidian</a> to write markdown files, which is a very powerful markdown editor. It supports many features such as graph view, backlinks, and plugins. I highly recommend it.</p>
<p>To work along with VuePress, you only need create a new vault in <code>src</code> folder, and then you can write markdown files in it.</p>
<div class="hint-container tip">
<p class="hint-container-title">Tips</p>
<p>When you create a new vault, an <code>.obsidian</code> will be created in the <code>src</code> directory, this is Obsidian configs and plugins folder. You can ignore it in the <code>.gitignore</code> file to avoid uploading it to the repository.</p>
</div>
<h2>Customization</h2>
<p>I have customized the original theme as follows. The main customizations are divided into:</p>
<ol>
<li>
<p><strong>Custom Layouts</strong></p>
<ul>
<li><code>NotFound.vue</code></li>
<li><code>Layout.vue</code> (added a donation component)</li>
<li><code>News.vue</code> (layout for news list)</li>
</ul>
</li>
<li>
<p><strong>Custom Components</strong></p>
<ul>
<li><code>BlogHero.vue</code></li>
<li><code>PageFooter.vue</code></li>
<li><code>Sponsor.vue</code> (donation component) // Not used in my site</li>
<li><code>NewsList.vue</code> (news list)</li>
<li><code>NewsItem.vue</code> (news item)</li>
</ul>
</li>
<li>
<p><strong>Local Plugin Development</strong></p>
<ul>
<li><code>vuepress-plugin-canvas</code> (supports two types of dynamic backgrounds: rainbow background and geometric shapes)</li>
<li><code>vuepress-plugin-gradient-cover</code> (background overlay)</li>
<li><code>vuepress-plugin-hitokoto</code> (Hitokoto plugin) // Not used in my site</li>
<li><code>vuepress-plugin-live2DAssist</code> (assistant for Live2D; hides on pages with sidebars to avoid obstruction)</li>
<li><code>vuepress-plugin-popper</code> (mouse effect, based on <a href="https://github.com/moefyit/moefy-canvas" target="_blank" rel="noopener noreferrer">@moefy-canvas/theme-popper</a>)</li>
</ul>
</li>
<li>
<p><strong>External Content References</strong></p>
<ul>
<li><a href="https://github.com/oh-my-live2d/vuepress-plugin-oh-my-live2d" target="_blank" rel="noopener noreferrer">vuepress-plugin-oh-my-live2d</a> (Live2D plugin)</li>
<li>Busuanzi statistics</li>
<li><a href="https://github.com/moefyit/moefy-canvas" target="_blank" rel="noopener noreferrer">@moefy-canvas/theme-popper</a> (original plugin only supported VuePress 1.x, developed a localized plugin to support VuePress 2.x)</li>
<li><a href="https://v2.vuepress.vuejs.org/zh/reference/plugin/google-analytics.html" target="_blank" rel="noopener noreferrer">@vuepress/plugin-google-analytics</a> (supports Google Analytics 4, which replaces the old UA)</li>
</ul>
</li>
<li>
<p><strong>Configuration Content</strong></p>
<ul>
<li>Navbar</li>
<li>Sidebar</li>
<li>Comments using <a href="https://waline.js.org/" target="_blank" rel="noopener noreferrer">Waline</a></li>
<li>Search using <a href="https://plugin-search-pro.vuejs.press/" target="_blank" rel="noopener noreferrer">vuepress-plugin-search-pro</a></li>
<li>Enabled copyright plugin</li>
<li>Feed RSS plugin</li>
<li>Added article type - "News"; added image preview selector for news markdown images</li>
</ul>
</li>
<li>
<p><strong>Miscellaneous</strong></p>
<ul>
<li>Runtime statistics</li>
<li>CSS beautification</li>
<li>Introduced fonts: PinYu Handwriting, XiaXingKai</li>
<li>Added custom emojis for Waline and modified the display style</li>
<li>Personalized log</li>
<li>Automatically push new article URLs to search engines (Baidu, Bing, Google) ğŸ‘‰ <a href="/platform/github/github-action">Detailed Configuration</a></li>
</ul>
</li>
</ol>
<h2>Conclusion</h2>
<blockquote>
<p>This is an ongoing project, with continuous optimization.</p>
<p>Local plugins are available for anyone interested. The source code is open; click the GitHub icon in the top right corner to access it. And don't forget to leave a star! ğŸŒŸ</p>
</blockquote>
]]></content:encoded>
    </item>
    <item>
      <title>Database</title>
      <link>https://vanhung4499.github.io/database/</link>
      <guid>https://vanhung4499.github.io/database/</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Database</source>
      <category>database</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
    </item>
    <item>
      <title>DevOps</title>
      <link>https://vanhung4499.github.io/devops/</link>
      <guid>https://vanhung4499.github.io/devops/</guid>
      <source url="https://vanhung4499.github.io/rss.xml">DevOps</source>
      <category>devops</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
    </item>
    <item>
      <title>DSA</title>
      <link>https://vanhung4499.github.io/dsa/</link>
      <guid>https://vanhung4499.github.io/dsa/</guid>
      <source url="https://vanhung4499.github.io/rss.xml">DSA</source>
      <description>Data Structures and Algorithms Info Pháº§n nÃ y hÆ°á»›ng dáº«n lÃ m quen vÃ  thá»±c hÃ nh vá»›i cáº¥u trÃºc dá»¯ liá»‡u vÃ  giáº£i thuáº­t phá»¥c vá»¥ cho vÃ²ng coding interview. Giáº£i quyáº¿t cÃ¡c váº¥n Ä‘á» trÃªn Lee...</description>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<div class="hint-container info">
<p class="hint-container-title">Info</p>
<ul>
<li>Pháº§n nÃ y hÆ°á»›ng dáº«n lÃ m quen vÃ  thá»±c hÃ nh vá»›i cáº¥u trÃºc dá»¯ liá»‡u vÃ  giáº£i thuáº­t phá»¥c vá»¥ cho vÃ²ng coding interview.</li>
<li>Giáº£i quyáº¿t cÃ¡c váº¥n Ä‘á» trÃªn Leetcode!</li>
<li>Tháº­t sá»± ráº¥t khÃ³ Ä‘á»ƒ tÃ¡ch biá»‡t Data Structure vÃ  Algorithm, nÃªn tÃ´i sáº½ viáº¿t lá»“ng ghÃ©p giá»¯a chÃºng vÃ o cÃ¡c chá»§ Ä‘á» lá»›n. VÃ¬ chÃºng tháº­t sá»± lÃ  cÃ³ má»‘i liÃªn há»‡ cháº·t cháº½ vá»›i nhau!</li>
</ul>
</div>
<div class="hint-container info">
<p class="hint-container-title">Info</p>
<p>Python lÃ  ngÃ´n ngá»¯ chÃ­nh mÃ  tÃ´i sá»­ dá»¥ng trong pháº§n nÃ y vÃ¬ nÃ³ dá»… Ä‘á»c, dá»… viáº¿t vÃ  dá»… hiá»ƒu.</p>
</div>
<h2>Introduction</h2>
<blockquote>
<p>Giá»›i thiá»‡u vá» cáº¥u trÃºc dá»¯ liá»‡u vÃ  giáº£i thuáº­t.</p>
</blockquote>
<ul>
<li><a href="./intro/introduction">Introduction to Data Structures and Algorithms</a></li>
<li><a href="/intro/complexity">Algorithm Complexity</a></li>
</ul>
<h2>Data Structures</h2>
<blockquote>
<p>Cáº¥u trÃºc dá»¯ liá»‡u lÃ  cÃ¡ch tá»• chá»©c, lÆ°u trá»¯ vÃ  quáº£n lÃ½ dá»¯ liá»‡u má»™t cÃ¡ch hiá»‡u quáº£.</p>
</blockquote>
<ul>
<li><a href="/ds/" target="_blank">Data Structures</a></li>
</ul>
<h2>Algorithms</h2>
<blockquote>
<p>Giáº£i thuáº­t lÃ  má»™t táº­p há»£p cÃ¡c hÆ°á»›ng dáº«n Ä‘á»ƒ giáº£i quyáº¿t má»™t váº¥n Ä‘á».</p>
</blockquote>
<ul>
<li><a href="/algo/" target="_blank">Alogrithms</a></li>
</ul>
<h2>LeetCode</h2>
<blockquote>
<p>Luyá»‡n táº­p giáº£i cÃ¡c bÃ i toÃ¡n trÃªn LeetCode.</p>
</blockquote>
<ul>
<li><a href="/leetcode/" target="_blank">LeetCode</a></li>
<li><a href="">LeetCode By Categories</a> Todo!</li>
<li><a href="">LeetCode Top 100</a> Todo!</li>
<li><a href="">LeetCode Top 200</a> Todo!</li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>Framework</title>
      <link>https://vanhung4499.github.io/framework/</link>
      <guid>https://vanhung4499.github.io/framework/</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Framework</source>
      <category>framework</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
    </item>
    <item>
      <title>Interview</title>
      <link>https://vanhung4499.github.io/interview/</link>
      <guid>https://vanhung4499.github.io/interview/</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Interview</source>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
    </item>
    <item>
      <title>Programming</title>
      <link>https://vanhung4499.github.io/programming/</link>
      <guid>https://vanhung4499.github.io/programming/</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Programming</source>
      <description>Programming Languages This section contains articles about programming languages.</description>
      <category>programming</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<p>This section contains articles about programming languages.</p>
]]></content:encoded>
    </item>
    <item>
      <title>Projects</title>
      <link>https://vanhung4499.github.io/project/</link>
      <guid>https://vanhung4499.github.io/project/</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Projects</source>
      <description>Projects My projects documentation.</description>
      <category>project</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<p>My projects documentation.</p>
]]></content:encoded>
    </item>
    <item>
      <title>dir template</title>
      <link>https://vanhung4499.github.io/templates/dir.html</link>
      <guid>https://vanhung4499.github.io/templates/dir.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">dir template</source>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
    </item>
    <item>
      <title>Post</title>
      <link>https://vanhung4499.github.io/templates/post.html</link>
      <guid>https://vanhung4499.github.io/templates/post.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Post</source>
      <category>any</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
    </item>
    <item>
      <title>Elastic Stack</title>
      <link>https://vanhung4499.github.io/database/elastic/</link>
      <guid>https://vanhung4499.github.io/database/elastic/</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Elastic Stack</source>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
    </item>
    <item>
      <title>Filebeat Operation</title>
      <link>https://vanhung4499.github.io/database/elastic/filebeat-operation.html</link>
      <guid>https://vanhung4499.github.io/database/elastic/filebeat-operation.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Filebeat Operation</source>
      <description>Váº­n hÃ nh Filebeat Ná»n táº£ng Beats káº¿t há»£p nhiá»u trÃ¬nh thu tháº­p dá»¯ liá»‡u Ä‘Æ¡n nhiá»‡m. ChÃºng gá»­i dá»¯ liá»‡u tá»« hÃ ng trÄƒm, hÃ ng nghÃ¬n hoáº·c hÃ ng triá»‡u mÃ¡y vÃ  há»‡ thá»‘ng Ä‘áº¿n Logstash hoáº·c Ela...</description>
      <category>elastic</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>Ná»n táº£ng Beats káº¿t há»£p nhiá»u trÃ¬nh thu tháº­p dá»¯ liá»‡u Ä‘Æ¡n nhiá»‡m. ChÃºng gá»­i dá»¯ liá»‡u tá»« hÃ ng trÄƒm, hÃ ng nghÃ¬n hoáº·c hÃ ng triá»‡u mÃ¡y vÃ  há»‡ thá»‘ng Ä‘áº¿n Logstash hoáº·c Elasticsearch.</p>
<p>VÃ¬ tÃ´i chá»‰ tiáº¿p xÃºc vá»›i Filebeat, nÃªn bÃ i viáº¿t nÃ y chá»‰ giá»›i thiá»‡u vá» váº­n hÃ nh cá»§a Filebeat.</p>
</blockquote>
<h2>1. CÃ i Ä‘áº·t Filebeat</h2>
<h3>1.1. YÃªu cáº§u mÃ´i trÆ°á»ng</h3>
<blockquote>
<p>PhiÃªn báº£n: Elastic Stack 7.4</p>
</blockquote>
<h3>1.2. CÃ¡c bÆ°á»›c cÃ i Ä‘áº·t</h3>
<p>Äá»‘i vá»›i há»‡ thá»‘ng Unix / Linux, khuyáº¿n nghá»‹ sá»­ dá»¥ng cÃ¡ch cÃ i Ä‘áº·t sau Ä‘Ã¢y vÃ¬ nÃ³ khÃ¡ phá»• biáº¿n.</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>wget https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-6.1.1-linux-x86_64.tar.gz</span></span>
<span class="line"><span>tar -zxf filebeat-6.1.1-linux-x86_64.tar.gz</span></span></code></pre>
</div><blockquote>
<p>Äá»ƒ biáº¿t thÃªm thÃ´ng tin, báº¡n cÃ³ thá»ƒ tham kháº£o: <a href="https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-installation.html" target="_blank" rel="noopener noreferrer">filebeat-installation</a></p>
</blockquote>
<h2>2. Cáº¥u hÃ¬nh Filebeat</h2>
<blockquote>
<p>Äáº§u tiÃªn, Ä‘iá»u cáº§n biáº¿t lÃ : <code>filebeat.yml</code> lÃ  tá»‡p cáº¥u hÃ¬nh cá»§a Filebeat. ÄÆ°á»ng dáº«n cá»§a nÃ³ cÃ³ thá»ƒ thay Ä‘á»•i tÃ¹y theo cÃ¡ch báº¡n cÃ i Ä‘áº·t.</p>
<p>Táº¥t cáº£ cÃ¡c tá»‡p cáº¥u hÃ¬nh cá»§a sáº£n pháº©m Beat Ä‘á»u dá»±a trÃªn Ä‘á»‹nh dáº¡ng <a href="http://www.yaml.org/" target="_blank" rel="noopener noreferrer">YAML</a>, vÃ  FileBeat cÅ©ng khÃ´ng ngoáº¡i lá»‡.</p>
<p>Äá»ƒ biáº¿t thÃªm vá» cáº¥u hÃ¬nh Filebeat, báº¡n cÃ³ thá»ƒ tham kháº£o: <a href="https://www.elastic.co/guide/en/beats/filebeat/current/configuring-howto-filebeat.html" target="_blank" rel="noopener noreferrer">Cáº¥u hÃ¬nh Filebeat</a></p>
<p>Äá»ƒ biáº¿t thÃªm vá» Ä‘á»‹nh dáº¡ng tá»‡p filebeat.yml, báº¡n cÃ³ thá»ƒ tham kháº£o: <a href="https://www.elastic.co/guide/en/beats/libbeat/6.1/config-file-format.html" target="_blank" rel="noopener noreferrer">Äá»‹nh dáº¡ng tá»‡p filebeat.yml</a></p>
</blockquote>
<p>VÃ­ dá»¥ vá» má»™t pháº§n cáº¥u hÃ¬nh filebeat.yml:</p>
<div class="language-yml" data-ext="yml" data-title="yml"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">filebeat</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  prospectors</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    - </span><span style="color:#E06C75;--shiki-dark:#E06C75">type</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">log</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      paths</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        - </span><span style="color:#98C379;--shiki-dark:#98C379">/var/log/*.log</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      multiline</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">        pattern</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'^['</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">        match</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">after</span></span></code></pre>
</div><h3>2.1. CÃ¡c má»¥c cáº¥u hÃ¬nh quan trá»ng</h3>
<blockquote>
<p>DÆ°á»›i Ä‘Ã¢y, tÃ´i sáº½ liá»‡t kÃª cÃ¡c má»¥c cáº¥u hÃ¬nh quan trá»ng cá»§a Filebeat.</p>
<p>Náº¿u báº¡n muá»‘n tÃ¬m hiá»ƒu thÃªm vá» thÃ´ng tin cáº¥u hÃ¬nh, báº¡n cÃ³ thá»ƒ tham kháº£o:</p>
<p>Äá»ƒ biáº¿t thÃªm vá» cáº¥u hÃ¬nh Filebeat, báº¡n cÃ³ thá»ƒ tham kháº£o: <a href="https://www.elastic.co/guide/en/beats/filebeat/current/configuring-howto-filebeat.html" target="_blank" rel="noopener noreferrer">Cáº¥u hÃ¬nh Filebeat</a></p>
<p>Äá»ƒ biáº¿t thÃªm vá» Ä‘á»‹nh dáº¡ng tá»‡p filebeat.yml, báº¡n cÃ³ thá»ƒ tham kháº£o: <a href="https://www.elastic.co/guide/en/beats/libbeat/6.1/config-file-format.html" target="_blank" rel="noopener noreferrer">Äá»‹nh dáº¡ng tá»‡p filebeat.yml</a></p>
</blockquote>
<h4>2.1.1. filebeat.prospectors</h4>
<p>(TrÃ¬nh theo dÃµi tá»‡p) Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ chá»‰ Ä‘á»‹nh cÃ¡c tá»‡p cáº§n quan tÃ¢m.</p>
<p><strong>VÃ­ dá»¥</strong></p>
<div class="language-yaml" data-ext="yaml" data-title="yaml"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">filebeat.prospectors</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  - </span><span style="color:#E06C75;--shiki-dark:#E06C75">type</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">log</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    enabled</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">true</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    paths</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      - </span><span style="color:#98C379;--shiki-dark:#98C379">/var/log/*.log</span></span></code></pre>
</div><h4>2.1.2. output.elasticsearch</h4>
<p>Náº¿u báº¡n muá»‘n Filebeat trá»±c tiáº¿p xuáº¥t dá»¯ liá»‡u Ä‘áº¿n Elasticsearch, báº¡n cáº§n cáº¥u hÃ¬nh output.elasticsearch.</p>
<p><strong>VÃ­ dá»¥</strong></p>
<div class="language-yaml" data-ext="yaml" data-title="yaml"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">output.elasticsearch</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  hosts</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span><span style="color:#98C379;--shiki-dark:#98C379">'192.168.1.42:9200'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">]</span></span></code></pre>
</div><h4>2.1.3. output.logstash</h4>
<p>Náº¿u báº¡n muá»‘n Filebeat xuáº¥t dá»¯ liá»‡u Ä‘áº¿n Logstash, sau Ä‘Ã³ Logstash sáº½ xuáº¥t dá»¯ liá»‡u Ä‘áº¿n Elasticsearch, báº¡n cáº§n cáº¥u hÃ¬nh output.logstash.</p>
<blockquote>
<p><strong>LÆ°u Ã½</strong></p>
<p>So vá»›i viá»‡c xuáº¥t dá»¯ liá»‡u Ä‘áº¿n Elasticsearch, tÃ´i khuyÃªn báº¡n nÃªn xuáº¥t dá»¯ liá»‡u Ä‘áº¿n Logstash.</p>
<p>Bá»Ÿi vÃ¬ khi Logstash vÃ  Filebeat lÃ m viá»‡c cÃ¹ng nhau, náº¿u Logstash báº­n xá»­ lÃ½ dá»¯ liá»‡u, nÃ³ sáº½ thÃ´ng bÃ¡o cho FileBeat lÃ m cháº­m tá»‘c Ä‘á»™ Ä‘á»c. Má»™t khi tÃ¬nh tráº¡ng táº¯c ngháº½n Ä‘Æ°á»£c giáº£i quyáº¿t, FileBeat sáº½ trá»Ÿ láº¡i tá»‘c Ä‘á»™ ban Ä‘áº§u vÃ  tiáº¿p tá»¥c truyá»n dá»¯ liá»‡u. NhÆ° váº­y, cÃ³ thá»ƒ giáº£m thiá»ƒu tÃ¬nh tráº¡ng quÃ¡ táº£i cá»§a Ä‘Æ°á»ng truyá»n.</p>
</blockquote>
<p><strong>VÃ­ dá»¥</strong></p>
<div class="language-yaml" data-ext="yaml" data-title="yaml"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">output.logstash</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  hosts</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span><span style="color:#98C379;--shiki-dark:#98C379">'127.0.0.1:5044'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">]</span></span></code></pre>
</div><p>NgoÃ i ra, báº¡n cÅ©ng cáº§n chá»‰ Ä‘á»‹nh plugin beats input trong tá»‡p cáº¥u hÃ¬nh cá»§a Logstash (nhÆ° logstash.conf):</p>
<div class="language-yaml line-numbers-mode" data-ext="yaml" data-title="yaml"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#98C379;--shiki-dark:#98C379">input {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">  beats {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">    port =&gt; 5044</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"> # Cá»•ng nÃ y cáº§n pháº£i giá»‘ng vá»›i cá»•ng trong filebeat.yml</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Pháº§n filter cá»§a tá»‡p nÃ y Ä‘Æ°á»£c bÃ¬nh luáº­n Ä‘á»ƒ chá»‰ ra ráº±ng nÃ³</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># lÃ  tÃ¹y chá»n.</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># filter {</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">#</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">output {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">  elasticsearch {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">    hosts =&gt; "localhost:9200"</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">    manage_template =&gt; false</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">    index =&gt; "%{[@metadata][beat]}-%{[@metadata][version]}-%{+YYYY.MM.dd}"</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">    document_type =&gt; "%{[@metadata][type]}"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4>2.1.4. setup.kibana</h4>
<p>Náº¿u báº¡n Ä‘á»‹nh sá»­ dá»¥ng báº£ng Ä‘iá»u khiá»ƒn Kibana do Filebeat cung cáº¥p, báº¡n cáº§n cáº¥u hÃ¬nh setup.kibana.</p>
<p><strong>VÃ­ dá»¥</strong></p>
<div class="language-yaml" data-ext="yaml" data-title="yaml"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">setup.kibana</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  host</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'localhost:5601'</span></span></code></pre>
</div><h4>2.1.5. setup.template.settings</h4>
<p>Trong Elasticsearch, <a href="https://www.elastic.co/guide/en/elasticsearch/reference/6.1/indices-templates.html" target="_blank" rel="noopener noreferrer">máº«u chá»‰ má»¥c</a> Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh cÃ i Ä‘áº·t vÃ  Ã¡nh xáº¡, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh cÃ¡ch phÃ¢n tÃ­ch cÃ¡c trÆ°á»ng.</p>
<p>Trong Filebeat, setup.template.settings Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ cáº¥u hÃ¬nh máº«u chá»‰ má»¥c.</p>
<p>Máº«u chá»‰ má»¥c Ä‘Æ°á»£c Filebeat khuyÃªn dÃ¹ng Ä‘Æ°á»£c cÃ i Ä‘áº·t bá»Ÿi gÃ³i pháº§n má»m Filebeat. Náº¿u báº¡n cháº¥p nháº­n cáº¥u hÃ¬nh máº·c Ä‘á»‹nh trong tá»‡p filebeat.yml, Filebeat sáº½ tá»± Ä‘á»™ng táº£i máº«u sau khi káº¿t ná»‘i thÃ nh cÃ´ng vá»›i Elasticsearch.</p>
<p>Báº¡n cÃ³ thá»ƒ táº¯t táº£i máº«u tá»± Ä‘á»™ng hoáº·c táº£i máº«u cá»§a riÃªng báº¡n báº±ng cÃ¡ch cáº¥u hÃ¬nh cÃ¡c tÃ¹y chá»n táº£i máº«u trong tá»‡p cáº¥u hÃ¬nh Filebeat. Báº¡n cÅ©ng cÃ³ thá»ƒ Ä‘áº·t cÃ¡c tÃ¹y chá»n Ä‘á»ƒ thay Ä‘á»•i tÃªn chá»‰ má»¥c vÃ  máº«u chá»‰ má»¥c.</p>
<blockquote>
<p><strong>Tham kháº£o</strong></p>
<p>Äá»ƒ biáº¿t thÃªm thÃ´ng tin, báº¡n cÃ³ thá»ƒ tham kháº£o: <a href="https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-template.html" target="_blank" rel="noopener noreferrer">filebeat-template</a></p>
<p><strong>Ghi chÃº</strong></p>
<p>Náº¿u khÃ´ng cáº§n thiáº¿t, hÃ£y sá»­ dá»¥ng máº«u chá»‰ má»¥c máº·c Ä‘á»‹nh trong tá»‡p cáº¥u hÃ¬nh Filebeat.</p>
</blockquote>
<h4>2.1.6. setup.dashboards</h4>
<p>Filebeat Ä‘i kÃ¨m vá»›i cÃ¡c báº£ng Ä‘iá»u khiá»ƒn Kibana máº«u. TrÆ°á»›c khi sá»­ dá»¥ng cÃ¡c báº£ng Ä‘iá»u khiá»ƒn, báº¡n cáº§n táº¡o máº«u chá»‰ má»¥c <code>filebeat-*</code> vÃ  táº£i cÃ¡c báº£ng Ä‘iá»u khiá»ƒn vÃ o Kibana. Äá»ƒ lÃ m Ä‘iá»u nÃ y, báº¡n cÃ³ thá»ƒ cháº¡y lá»‡nh <code>setup</code> hoáº·c cáº¥u hÃ¬nh táº£i báº£ng Ä‘iá»u khiá»ƒn trong tá»‡p <code>filebeat.yml</code>.</p>
<p>Äá»ƒ táº£i cÃ¡c báº£ng Ä‘iá»u khiá»ƒn Filebeat vÃ o Kibana, báº¡n cáº§n kÃ­ch hoáº¡t cÃ´ng táº¯c trong cáº¥u hÃ¬nh <code>filebeat.yml</code>:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>setup.dashboards.enabled: true</span></span></code></pre>
</div><blockquote>
<p><strong>Tham kháº£o</strong></p>
<p>Äá»ƒ biáº¿t thÃªm thÃ´ng tin, báº¡n cÃ³ thá»ƒ tham kháº£o: <a href="https://www.elastic.co/guide/en/beats/filebeat/current/configuration-dashboards.html" target="_blank" rel="noopener noreferrer">configuration-dashboards</a></p>
</blockquote>
<h2>3. Lá»‡nh Filebeat</h2>
<p>Filebeat cung cáº¥p má»™t loáº¡t cÃ¡c lá»‡nh Ä‘á»ƒ hoÃ n thÃ nh nhiá»u chá»©c nÄƒng khÃ¡c nhau.</p>
<p>CÃ¡ch thá»±c hiá»‡n lá»‡nh:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">./filebeat</span><span style="color:#98C379;--shiki-dark:#98C379"> COMMAND</span></span></code></pre>
</div><blockquote>
<p><strong>Tham kháº£o</strong></p>
<p>Äá»ƒ biáº¿t thÃªm thÃ´ng tin, báº¡n cÃ³ thá»ƒ tham kháº£o: <a href="https://www.elastic.co/guide/en/beats/filebeat/current/command-line-options.html" target="_blank" rel="noopener noreferrer">command-line-options</a></p>
<p><strong>Ghi chÃº</strong></p>
<p>Theo quan Ä‘iá»ƒm cÃ¡ nhÃ¢n, khÃ´ng cáº§n pháº£i náº¯m vá»¯ng táº¥t cáº£ cÃ¡c lá»‡nh dÃ²ng lá»‡nh, vÃ¬ háº§u háº¿t cÃ¡c chá»©c nÄƒng Ä‘á»u cÃ³ thá»ƒ hoÃ n thÃ nh thÃ´ng qua cáº¥u hÃ¬nh. VÃ  viá»‡c chá»‰ Ä‘á»‹nh chá»©c nÄƒng thÃ´ng qua dÃ²ng lá»‡nh yÃªu cáº§u nháº­p cÃ¹ng má»™t tham sá»‘ má»—i láº§n, khÃ´ng thuáº­n lá»£i cho viá»‡c khá»Ÿi Ä‘á»™ng cá»‘ Ä‘á»‹nh.</p>
<p>ÄÆ°Æ¡ng nhiÃªn, lá»‡nh khá»Ÿi Ä‘á»™ng quan trá»ng nháº¥t lÃ  run.</p>
<p><strong>VÃ­ dá»¥</strong> Khá»Ÿi Ä‘á»™ng báº±ng cÃ¡ch chá»‰ Ä‘á»‹nh tá»‡p cáº¥u hÃ¬nh</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">./filebeat</span><span style="color:#98C379;--shiki-dark:#98C379"> run</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -e</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -c</span><span style="color:#98C379;--shiki-dark:#98C379"> filebeat.yml</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -d</span><span style="color:#98C379;--shiki-dark:#98C379"> "publish"</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">./filebeat</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -e</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -c</span><span style="color:#98C379;--shiki-dark:#98C379"> filebeat.yml</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -d</span><span style="color:#98C379;--shiki-dark:#98C379"> "publish"</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"> # run cÃ³ thá»ƒ bá» qua</span></span></code></pre>
</div></blockquote>
<h2>4. Module Filebeat</h2>
<blockquote>
<p><a href="https://www.elastic.co/cn/products/beats/filebeat" target="_blank" rel="noopener noreferrer">Filebeat</a> vÃ  <a href="https://www.elastic.co/cn/products/beats/metricbeat" target="_blank" rel="noopener noreferrer">Metricbeat</a> tÃ­ch há»£p má»™t loáº¡t cÃ¡c module Ä‘á»ƒ Ä‘Æ¡n giáº£n hÃ³a quÃ¡ trÃ¬nh thu tháº­p, phÃ¢n tÃ­ch vÃ  hiá»ƒn thá»‹ cÃ¡c Ä‘á»‹nh dáº¡ng nháº­t kÃ½ thÃ´ng thÆ°á»ng (nhÆ° NGINX, Apache hoáº·c cÃ¡c chá»‰ sá»‘ há»‡ thá»‘ng nhÆ° Redis hoáº·c Docker).</p>
</blockquote>
<ul>
<li>Cáº¥u hÃ¬nh elasticsearch vÃ  kibana</li>
</ul>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>output.elasticsearch:</span></span>
<span class="line"><span>  hosts: ["myEShost:9200"]</span></span>
<span class="line"><span>  username: "elastic"</span></span>
<span class="line"><span>  password: "elastic"</span></span>
<span class="line"><span>setup.kibana:</span></span>
<span class="line"><span>  host: "mykibanahost:5601"</span></span>
<span class="line"><span>  username: "elastic"</span></span>
<span class="line"><span>  password: "elastic</span></span></code></pre>
</div><blockquote>
<p>username vÃ  password lÃ  tÃ¹y chá»n, náº¿u khÃ´ng cáº§n xÃ¡c thá»±c thÃ¬ khÃ´ng cáº§n Ä‘iá»n.</p>
</blockquote>
<ul>
<li>Khá»Ÿi táº¡o mÃ´i trÆ°á»ng</li>
</ul>
<p>Cháº¡y lá»‡nh dÆ°á»›i Ä‘Ã¢y, filebeat sáº½ táº£i máº«u chá»‰ má»¥c Ä‘Æ°á»£c khuyáº¿n nghá»‹.</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>./filebeat setup -e</span></span></code></pre>
</div><ul>
<li>Chá»‰ Ä‘á»‹nh module</li>
</ul>
<p>Cháº¡y lá»‡nh dÆ°á»›i Ä‘Ã¢y Ä‘á»ƒ chá»‰ Ä‘á»‹nh cÃ¡c module báº¡n muá»‘n táº£i.</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>./filebeat -e --modules system,nginx,mysql</span></span></code></pre>
</div><blockquote>
<p>Äá»ƒ biáº¿t thÃªm thÃ´ng tin, báº¡n cÃ³ thá»ƒ tham kháº£o:</p>
<ul>
<li><a href="https://www.elastic.co/guide/en/beats/filebeat/current/configuration-filebeat-modules.html" target="_blank" rel="noopener noreferrer">Cáº¥u hÃ¬nh module filebeat</a></li>
<li><a href="https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-modules.html" target="_blank" rel="noopener noreferrer">Module há»— trá»£ filebeat</a></li>
</ul>
</blockquote>
<h2>5. TÃ i liá»‡u tham kháº£o</h2>
<ul>
<li><a href="https://www.elastic.co/cn/products/beats" target="_blank" rel="noopener noreferrer">Trang chá»§ Beats</a></li>
<li><a href="https://github.com/elastic/beats" target="_blank" rel="noopener noreferrer">Beats Github</a></li>
<li><a href="https://www.elastic.co/guide/en/beats/libbeat/current/index.html" target="_blank" rel="noopener noreferrer">TÃ i liá»‡u chÃ­nh thá»©c Beats</a></li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>Filebeat</title>
      <link>https://vanhung4499.github.io/database/elastic/filebeat.html</link>
      <guid>https://vanhung4499.github.io/database/elastic/filebeat.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Filebeat</source>
      <description>Elastic Stack vÃ  Filebeat Giá»›i thiá»‡u Beats lÃ  cÃ¡c Ä‘áº¡i lÃ½ truyá»n dá»¯ liá»‡u Ä‘Æ°á»£c cÃ i Ä‘áº·t trÃªn mÃ¡y chá»§. Beats cÃ³ thá»ƒ truyá»n dá»¯ liá»‡u trá»±c tiáº¿p Ä‘áº¿n Elasticsearch hoáº·c Ä‘áº¿n Logstash. img...</description>
      <category>elastic</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>Giá»›i thiá»‡u</h2>
<p>Beats lÃ  cÃ¡c Ä‘áº¡i lÃ½ truyá»n dá»¯ liá»‡u Ä‘Æ°á»£c cÃ i Ä‘áº·t trÃªn mÃ¡y chá»§.</p>
<p>Beats cÃ³ thá»ƒ truyá»n dá»¯ liá»‡u trá»±c tiáº¿p Ä‘áº¿n Elasticsearch hoáº·c Ä‘áº¿n Logstash.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/beats-platform.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>
<p>Beats cÃ³ nhiá»u loáº¡i, báº¡n cÃ³ thá»ƒ chá»n loáº¡i phÃ¹ há»£p vá»›i nhu cáº§u thá»±c táº¿ cá»§a báº¡n.</p>
<p>CÃ¡c loáº¡i phá»• biáº¿n bao gá»“m:</p>
<ul>
<li><strong>Packetbeat:</strong>&nbsp;TrÃ¬nh phÃ¢n tÃ­ch gÃ³i dá»¯ liá»‡u máº¡ng, cung cáº¥p thÃ´ng tin vá» cÃ¡c giao dá»‹ch Ä‘Æ°á»£c trao Ä‘á»•i giá»¯a cÃ¡c mÃ¡y chá»§ á»©ng dá»¥ng cá»§a báº¡n.</li>
<li><strong>Filebeat:</strong>&nbsp;Gá»­i cÃ¡c tá»‡p nháº­t kÃ½ tá»« mÃ¡y chá»§ cá»§a báº¡n.</li>
<li><strong>Metricbeat:</strong>&nbsp;LÃ  má»™t Ä‘áº¡i lÃ½ giÃ¡m sÃ¡t mÃ¡y chá»§, thu tháº­p Ä‘á»‹nh ká»³ cÃ¡c chá»‰ sá»‘ tá»« há»‡ Ä‘iá»u hÃ nh vÃ  dá»‹ch vá»¥ Ä‘ang cháº¡y trÃªn mÃ¡y chá»§.</li>
<li><strong>Winlogbeat:</strong>&nbsp;Cung cáº¥p nháº­t kÃ½ sá»± kiá»‡n Windows.</li>
</ul>
<blockquote>
<p><strong>Tham kháº£o</strong></p>
<p>CÃ¡c loáº¡i Beats khÃ¡c cÃ³ thá»ƒ tham kháº£o táº¡i:&nbsp;<a href="https://www.elastic.co/guide/en/beats/libbeat/current/community-beats.html" target="_blank" rel="noopener noreferrer">community-beats</a></p>
<p><strong>ChÃº Ã½</strong></p>
<p>VÃ¬ tÃ´i chá»‰ sá»­ dá»¥ng FileBeat trong cÃ´ng viá»‡c, nÃªn ná»™i dung sau chá»‰ giá»›i thiá»‡u vá» FileBeat.</p>
</blockquote>
<h3>FileBeat cÃ³ tÃ¡c dá»¥ng gÃ¬?</h3>
<p>So vá»›i Logstash, FileBeat nháº¹ nhÃ ng hÆ¡n.</p>
<p>Trong báº¥t ká»³ mÃ´i trÆ°á»ng nÃ o, á»©ng dá»¥ng Ä‘á»u cÃ³ kháº£ nÄƒng bá»‹ táº¯t. Filebeat Ä‘á»c vÃ  chuyá»ƒn tiáº¿p cÃ¡c dÃ²ng nháº­t kÃ½, náº¿u bá»‹ giÃ¡n Ä‘oáº¡n, nÃ³ sáº½ nhá»› táº¥t cáº£ cÃ¡c sá»± kiá»‡n á»Ÿ vá»‹ trÃ­ khi tráº¡ng thÃ¡i trá»±c tuyáº¿n Ä‘Æ°á»£c khÃ´i phá»¥c.</p>
<p>Filebeat cÃ³ cÃ¡c mÃ´-Ä‘un ná»™i bá»™ (auditd, Apache, Nginx, System vÃ  MySQL) Ä‘á»ƒ Ä‘Æ¡n giáº£n hÃ³a viá»‡c thu tháº­p, phÃ¢n tÃ­ch vÃ  trá»±c quan hÃ³a Ä‘á»‹nh dáº¡ng nháº­t kÃ½ phá»• biáº¿n.</p>
<p>FileBeat khÃ´ng lÃ m quÃ¡ táº£i á»‘ng dáº«n cá»§a báº¡n. Náº¿u FileBeat truyá»n dá»¯ liá»‡u Ä‘áº¿n Logstash, khi Logstash báº­n xá»­ lÃ½ dá»¯ liá»‡u, nÃ³ sáº½ thÃ´ng bÃ¡o cho FileBeat lÃ m cháº­m tá»‘c Ä‘á»™ Ä‘á»c. Khi tÃ¬nh tráº¡ng táº¯c ngháº½n Ä‘Æ°á»£c giáº£i quyáº¿t, FileBeat sáº½ trá»Ÿ láº¡i tá»‘c Ä‘á»™ ban Ä‘áº§u vÃ  tiáº¿p tá»¥c truyá»n dá»¯ liá»‡u.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/filebeat.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>
<h2>CÃ i Ä‘áº·t</h2>
<p>Äá»‘i vá»›i há»‡ thá»‘ng Unix / Linux, báº¡n nÃªn cÃ i Ä‘áº·t theo cÃ¡ch sau vÃ¬ nÃ³ khÃ¡ phá»• biáº¿n.</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">wget</span><span style="color:#98C379;--shiki-dark:#98C379"> https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-6.1.1-linux-x86_64.tar.gz</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">tar</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -zxf</span><span style="color:#98C379;--shiki-dark:#98C379"> filebeat-6.1.1-linux-x86_64.tar.gz</span></span></code></pre>
</div><blockquote>
<p><strong>Tham kháº£o</strong></p>
<p>Äá»ƒ biáº¿t thÃªm thÃ´ng tin, báº¡n cÃ³ thá»ƒ tham kháº£o:&nbsp;<a href="https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-installation.html" target="_blank" rel="noopener noreferrer">filebeat-installation</a></p>
</blockquote>
<h2>Cáº¥u hÃ¬nh</h2>
<h3>Tá»‡p cáº¥u hÃ¬nh</h3>
<p>Äáº§u tiÃªn, Ä‘iá»u cáº§n biáº¿t lÃ : <code>filebeat.yml</code> lÃ  tá»‡p cáº¥u hÃ¬nh cá»§a Filebeat. ÄÆ°á»ng dáº«n cá»§a tá»‡p cáº¥u hÃ¬nh cÃ³ thá»ƒ thay Ä‘á»•i tÃ¹y thuá»™c vÃ o cÃ¡ch báº¡n cÃ i Ä‘áº·t.</p>
<p>Táº¥t cáº£ cÃ¡c sáº£n pháº©m trong loáº¡t Beat Ä‘á»u dá»±a trÃªn Ä‘á»‹nh dáº¡ng cáº¥u hÃ¬nh <a href="http://www.yaml.org/" target="_blank" rel="noopener noreferrer">YAML</a>, vÃ  FileBeat cÅ©ng khÃ´ng pháº£i lÃ  ngoáº¡i lá»‡.</p>
<p>VÃ­ dá»¥ vá» má»™t pháº§n cáº¥u hÃ¬nh filebeat.yml:</p>
<div class="language-yaml" data-ext="yaml" data-title="yaml"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">filebeat</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  prospectors</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    - </span><span style="color:#E06C75;--shiki-dark:#E06C75">type</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">log</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      paths</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        - </span><span style="color:#98C379;--shiki-dark:#98C379">/var/log/*.log</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      multiline</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">        pattern</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'^['</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">        match</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">after</span></span></code></pre>
</div><blockquote>
<p><strong>Tham kháº£o</strong></p>
<p>Äá»ƒ biáº¿t thÃªm vá» cáº¥u hÃ¬nh Filebeat, báº¡n cÃ³ thá»ƒ tham kháº£o: <a href="https://www.elastic.co/guide/en/beats/filebeat/current/configuring-howto-filebeat.html" target="_blank" rel="noopener noreferrer">Cáº¥u hÃ¬nh Filebeat</a></p>
<p>Äá»ƒ biáº¿t thÃªm vá» Ä‘á»‹nh dáº¡ng tá»‡p filebeat.yml, báº¡n cÃ³ thá»ƒ tham kháº£o: <a href="https://www.elastic.co/guide/en/beats/libbeat/6.1/config-file-format.html" target="_blank" rel="noopener noreferrer">Äá»‹nh dáº¡ng tá»‡p filebeat.yml</a></p>
</blockquote>
<h3>CÃ¡c má»¥c cáº¥u hÃ¬nh quan trá»ng</h3>
<h4>filebeat.prospectors</h4>
<p>(TrÃ¬nh theo dÃµi tá»‡p) Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ chá»‰ Ä‘á»‹nh cÃ¡c tá»‡p cáº§n quan tÃ¢m.</p>
<p><strong>VÃ­ dá»¥</strong></p>
<div class="language-yaml" data-ext="yaml" data-title="yaml"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">filebeat.prospectors</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  - </span><span style="color:#E06C75;--shiki-dark:#E06C75">type</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">log</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    enabled</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">true</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    paths</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      - </span><span style="color:#98C379;--shiki-dark:#98C379">/var/log/*.log</span></span></code></pre>
</div><h4>output.elasticsearch</h4>
<p>Náº¿u báº¡n muá»‘n Filebeat trá»±c tiáº¿p xuáº¥t dá»¯ liá»‡u Ä‘áº¿n Elasticsearch, báº¡n cáº§n cáº¥u hÃ¬nh output.elasticsearch.</p>
<p><strong>VÃ­ dá»¥</strong></p>
<div class="language-yaml" data-ext="yaml" data-title="yaml"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">output.elasticsearch</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  hosts</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span><span style="color:#98C379;--shiki-dark:#98C379">'192.168.1.42:9200'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">]</span></span></code></pre>
</div><h4>output.logstash</h4>
<p>Náº¿u báº¡n muá»‘n Filebeat xuáº¥t dá»¯ liá»‡u Ä‘áº¿n Logstash, sau Ä‘Ã³ Logstash sáº½ xuáº¥t dá»¯ liá»‡u Ä‘áº¿n Elasticsearch, báº¡n cáº§n cáº¥u hÃ¬nh output.logstash.</p>
<blockquote>
<p><strong>LÆ°u Ã½</strong></p>
<p>So vá»›i xuáº¥t dá»¯ liá»‡u Ä‘áº¿n Elasticsearch, tÃ´i khuyÃªn báº¡n nÃªn xuáº¥t dá»¯ liá»‡u Ä‘áº¿n Logstash.</p>
<p>Bá»Ÿi vÃ¬ khi Logstash vÃ  Filebeat lÃ m viá»‡c cÃ¹ng nhau, náº¿u Logstash báº­n xá»­ lÃ½ dá»¯ liá»‡u, nÃ³ sáº½ thÃ´ng bÃ¡o cho FileBeat lÃ m cháº­m tá»‘c Ä‘á»™ Ä‘á»c. Má»™t khi tÃ¬nh tráº¡ng táº¯c ngháº½n Ä‘Æ°á»£c giáº£i quyáº¿t, FileBeat sáº½ trá»Ÿ láº¡i tá»‘c Ä‘á»™ ban Ä‘áº§u vÃ  tiáº¿p tá»¥c truyá»n dá»¯ liá»‡u. NhÆ° váº­y, cÃ³ thá»ƒ giáº£m bá»›t tÃ¬nh tráº¡ng quÃ¡ táº£i á»‘ng dáº«n.</p>
</blockquote>
<p><strong>VÃ­ dá»¥</strong></p>
<div class="language-yaml" data-ext="yaml" data-title="yaml"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">output.logstash</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  hosts</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span><span style="color:#98C379;--shiki-dark:#98C379">'127.0.0.1:5044'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">]</span></span></code></pre>
</div><p>NgoÃ i ra, báº¡n cÅ©ng cáº§n chá»‰ Ä‘á»‹nh plugin Ä‘áº§u vÃ o beats trong tá»‡p cáº¥u hÃ¬nh Logstash (nhÆ° logstash.conf):</p>
<div class="language-yaml line-numbers-mode" data-ext="yaml" data-title="yaml"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#98C379;--shiki-dark:#98C379">input {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">  beats {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">    port =&gt; 5044</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"> # Cá»•ng nÃ y cáº§n pháº£i giá»‘ng vá»›i cá»•ng trong filebeat.yml</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Pháº§n filter cá»§a tá»‡p nÃ y Ä‘Æ°á»£c bÃ¬nh luáº­n Ä‘á»ƒ chá»‰ ra ráº±ng nÃ³ lÃ </span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># tÃ¹y chá»n.</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># filter {</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">#</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">output {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">  elasticsearch {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">    hosts =&gt; "localhost:9200"</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">    manage_template =&gt; false</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">    index =&gt; "%{[@metadata][beat]}-%{[@metadata][version]}-%{+YYYY.MM.dd}"</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">    document_type =&gt; "%{[@metadata][type]}"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4>setup.kibana</h4>
<p>Náº¿u báº¡n dá»± Ä‘á»‹nh sá»­ dá»¥ng báº£ng Ä‘iá»u khiá»ƒn Kibana do Filebeat cung cáº¥p, báº¡n cáº§n cáº¥u hÃ¬nh setup.kibana.</p>
<p><strong>VÃ­ dá»¥</strong></p>
<div class="language-yaml" data-ext="yaml" data-title="yaml"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">setup.kibana</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  host</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'localhost:5601'</span></span></code></pre>
</div><h4>setup.template.settings</h4>
<p>Trong Elasticsearch, <a href="https://www.elastic.co/guide/en/elasticsearch/reference/6.1/indices-templates.html" target="_blank" rel="noopener noreferrer">máº«u chá»‰ má»¥c</a> Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘á»‹nh nghÄ©a cÃ i Ä‘áº·t vÃ  Ã¡nh xáº¡, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh cÃ¡ch phÃ¢n tÃ­ch cÃ¡c trÆ°á»ng.</p>
<p>Trong Filebeat, setup.template.settings Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ cáº¥u hÃ¬nh máº«u chá»‰ má»¥c.</p>
<p>Filebeat gá»£i Ã½ máº«u chá»‰ má»¥c Ä‘Æ°á»£c cÃ i Ä‘áº·t bá»Ÿi gÃ³i pháº§n má»m Filebeat. Náº¿u báº¡n cháº¥p nháº­n cáº¥u hÃ¬nh máº·c Ä‘á»‹nh trong tá»‡p cáº¥u hÃ¬nh filebeat.yml, Filebeat tá»± Ä‘á»™ng táº£i máº«u sau khi káº¿t ná»‘i thÃ nh cÃ´ng vá»›i Elasticsearch.</p>
<p>Báº¡n cÃ³ thá»ƒ vÃ´ hiá»‡u hÃ³a táº£i máº«u tá»± Ä‘á»™ng hoáº·c táº£i máº«u cá»§a riÃªng báº¡n báº±ng cÃ¡ch cáº¥u hÃ¬nh cÃ¡c tÃ¹y chá»n táº£i máº«u trong tá»‡p cáº¥u hÃ¬nh Filebeat. Báº¡n cÅ©ng cÃ³ thá»ƒ Ä‘áº·t tÃ¹y chá»n Ä‘á»ƒ thay Ä‘á»•i tÃªn chá»‰ má»¥c vÃ  máº«u chá»‰ má»¥c.</p>
<blockquote>
<p><strong>Tham kháº£o</strong></p>
<p>Äá»ƒ biáº¿t thÃªm thÃ´ng tin, báº¡n cÃ³ thá»ƒ tham kháº£o: <a href="https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-template.html" target="_blank" rel="noopener noreferrer">filebeat-template</a></p>
<p><strong>ChÃº Ã½</strong></p>
<p>Náº¿u khÃ´ng cáº§n thiáº¿t, hÃ£y sá»­ dá»¥ng máº«u chá»‰ má»¥c máº·c Ä‘á»‹nh trong tá»‡p cáº¥u hÃ¬nh Filebeat.</p>
</blockquote>
<h4>setup.dashboards</h4>
<p>Filebeat Ä‘i kÃ¨m vá»›i cÃ¡c báº£ng Ä‘iá»u khiá»ƒn Kibana máº«u. TrÆ°á»›c khi sá»­ dá»¥ng báº£ng Ä‘iá»u khiá»ƒn, báº¡n cáº§n táº¡o máº«u chá»‰ má»¥c <code>filebeat-*</code> vÃ  táº£i báº£ng Ä‘iá»u khiá»ƒn vÃ o Kibana. Äá»ƒ lÃ m Ä‘iá»u nÃ y, báº¡n cÃ³ thá»ƒ cháº¡y lá»‡nh <code>setup</code> hoáº·c cáº¥u hÃ¬nh táº£i báº£ng Ä‘iá»u khiá»ƒn trong tá»‡p <code>filebeat.yml</code>.</p>
<p>Äá»ƒ táº£i báº£ng Ä‘iá»u khiá»ƒn Filebeat vÃ o Kibana, báº¡n cáº§n báº­t chá»©c nÄƒng trong cáº¥u hÃ¬nh <code>filebeat.yml</code>:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>setup.dashboards.enabled: true</span></span></code></pre>
</div><blockquote>
<p><strong>Tham kháº£o</strong></p>
<p>Äá»ƒ biáº¿t thÃªm thÃ´ng tin, báº¡n cÃ³ thá»ƒ tham kháº£o: <a href="https://www.elastic.co/guide/en/beats/filebeat/current/configuration-dashboards.html" target="_blank" rel="noopener noreferrer">configuration-dashboards</a></p>
</blockquote>
<h2>Lá»‡nh</h2>
<p>Filebeat cung cáº¥p má»™t loáº¡t cÃ¡c lá»‡nh Ä‘á»ƒ hoÃ n thÃ nh nhiá»u chá»©c nÄƒng.</p>
<p>CÃ¡ch thá»±c hiá»‡n lá»‡nh:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">./filebeat</span><span style="color:#98C379;--shiki-dark:#98C379"> COMMAND</span></span></code></pre>
</div><blockquote>
<p><strong>Tham kháº£o</strong></p>
<p>Äá»ƒ biáº¿t thÃªm thÃ´ng tin, báº¡n cÃ³ thá»ƒ tham kháº£o: <a href="https://www.elastic.co/guide/en/beats/filebeat/current/command-line-options.html" target="_blank" rel="noopener noreferrer">command-line-options</a></p>
<p><strong>ChÃº Ã½</strong></p>
<p>Theo quan Ä‘iá»ƒm cÃ¡ nhÃ¢n, khÃ´ng cáº§n pháº£i náº¯m báº¯t táº¥t cáº£ cÃ¡c lá»‡nh, bá»Ÿi vÃ¬ háº§u háº¿t cÃ¡c chá»©c nÄƒng Ä‘á»u cÃ³ thá»ƒ Ä‘Æ°á»£c hoÃ n thÃ nh thÃ´ng qua cáº¥u hÃ¬nh. HÆ¡n ná»¯a, viá»‡c chá»‰ Ä‘á»‹nh chá»©c nÄƒng thÃ´ng qua dÃ²ng lá»‡nh Ä‘Ã²i há»i pháº£i nháº­p cÃ¹ng má»™t tham sá»‘ má»—i láº§n, Ä‘iá»u nÃ y khÃ´ng thuáº­n lá»£i cho viá»‡c khá»Ÿi Ä‘á»™ng cá»‘ Ä‘á»‹nh.</p>
<p>Quan trá»ng nháº¥t, táº¥t nhiÃªn, lÃ  lá»‡nh khá»Ÿi Ä‘á»™ng run.</p>
<p><strong>VÃ­ dá»¥</strong> Khá»Ÿi Ä‘á»™ng báº±ng cÃ¡ch chá»‰ Ä‘á»‹nh tá»‡p cáº¥u hÃ¬nh</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">./filebeat</span><span style="color:#98C379;--shiki-dark:#98C379"> run</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -e</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -c</span><span style="color:#98C379;--shiki-dark:#98C379"> filebeat.yml</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -d</span><span style="color:#98C379;--shiki-dark:#98C379"> "publish"</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">./filebeat</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -e</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -c</span><span style="color:#98C379;--shiki-dark:#98C379"> filebeat.yml</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -d</span><span style="color:#98C379;--shiki-dark:#98C379"> "publish"</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"> # run cÃ³ thá»ƒ bá» qua</span></span></code></pre>
</div></blockquote>
<h2>Module</h2>
<p>Filebeat cung cáº¥p má»™t bá»™ module Ä‘Æ°á»£c xÃ¢y dá»±ng sáºµn, cho phÃ©p báº¡n triá»ƒn khai giáº£i phÃ¡p giÃ¡m sÃ¡t log nhanh chÃ³ng vÃ  Ä‘i kÃ¨m vá»›i cÃ¡c báº£ng Ä‘iá»u khiá»ƒn máº«u vÃ  trá»±c quan hÃ³a dá»¯ liá»‡u. Nhá»¯ng module nÃ y há»— trá»£ cÃ¡c Ä‘á»‹nh dáº¡ng log phá»• biáº¿n nhÆ° Nginx, Apache2 vÃ  MySQL, v.v.</p>
<h3>CÃ¡c bÆ°á»›c Ä‘á»ƒ cháº¡y module</h3>
<ul>
<li>Cáº¥u hÃ¬nh elasticsearch vÃ  kibana</li>
</ul>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>output.elasticsearch:</span></span>
<span class="line"><span>  hosts: ["myEShost:9200"]</span></span>
<span class="line"><span>  username: "elastic"</span></span>
<span class="line"><span>  password: "elastic"</span></span>
<span class="line"><span>setup.kibana:</span></span>
<span class="line"><span>  host: "mykibanahost:5601"</span></span>
<span class="line"><span>  username: "elastic"</span></span>
<span class="line"><span>  password: "elastic</span></span></code></pre>
</div><blockquote>
<p>username vÃ  password lÃ  tÃ¹y chá»n, náº¿u khÃ´ng cáº§n xÃ¡c thá»±c thÃ¬ khÃ´ng cáº§n Ä‘iá»n.</p>
</blockquote>
<ul>
<li>Khá»Ÿi táº¡o mÃ´i trÆ°á»ng</li>
</ul>
<p>Cháº¡y lá»‡nh dÆ°á»›i Ä‘Ã¢y, Filebeat sáº½ táº£i máº«u chá»‰ má»¥c Ä‘Æ°á»£c gá»£i Ã½.</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>./filebeat setup -e</span></span></code></pre>
</div><ul>
<li>Chá»‰ Ä‘á»‹nh module</li>
</ul>
<p>Cháº¡y lá»‡nh dÆ°á»›i Ä‘Ã¢y, chá»‰ Ä‘á»‹nh module báº¡n muá»‘n táº£i.</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>./filebeat -e --modules system,nginx,mysql</span></span></code></pre>
</div><blockquote>
<p><strong>Tham kháº£o</strong></p>
<p>Äá»ƒ biáº¿t thÃªm thÃ´ng tin, báº¡n cÃ³ thá»ƒ tham kháº£o: <a href="https://www.elastic.co/guide/en/beats/filebeat/current/configuration-filebeat-modules.html" target="_blank" rel="noopener noreferrer">Cáº¥u hÃ¬nh module Filebeat</a> | <a href="https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-modules.html" target="_blank" rel="noopener noreferrer">Module Ä‘Æ°á»£c há»— trá»£ bá»Ÿi Filebeat</a></p>
</blockquote>
<h2>NguyÃªn lÃ½</h2>
<p>Filebeat cÃ³ hai thÃ nh pháº§n chÃ­nh:</p>
<p>harvester: chá»‹u trÃ¡ch nhiá»‡m Ä‘á»c ná»™i dung cá»§a má»™t tá»‡p. NÃ³ sáº½ Ä‘á»c tá»«ng dÃ²ng ná»™i dung cá»§a tá»‡p vÃ  gá»­i ná»™i dung Ä‘áº¿n Ä‘Ã­ch xuáº¥t.</p>
<p>prospector: chá»‹u trÃ¡ch nhiá»‡m quáº£n lÃ½ harvester vÃ  tÃ¬m táº¥t cáº£ cÃ¡c nguá»“n tá»‡p cáº§n Ä‘á»c. VÃ­ dá»¥, náº¿u kiá»ƒu lÃ  log, prospector sáº½ duyá»‡t qua táº¥t cáº£ cÃ¡c tá»‡p phÃ¹ há»£p vá»›i yÃªu cáº§u trong Ä‘Æ°á»ng dáº«n Ä‘Ã£ chá»‰ Ä‘á»‹nh.</p>
<div class="language-yaml" data-ext="yaml" data-title="yaml"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">filebeat.prospectors</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  - </span><span style="color:#E06C75;--shiki-dark:#E06C75">type</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">log</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    paths</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      - </span><span style="color:#98C379;--shiki-dark:#98C379">/var/log/*.log</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      - </span><span style="color:#98C379;--shiki-dark:#98C379">/var/path2/*.log</span></span></code></pre>
</div><p>Filebeat giá»¯ tráº¡ng thÃ¡i cá»§a má»—i tá»‡p vÃ  thÆ°á»ng xuyÃªn lÃ m má»›i tráº¡ng thÃ¡i Ä‘Ä©a trong tá»‡p Ä‘Äƒng kÃ½. Tráº¡ng thÃ¡i Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ nhá»› vá»‹ trÃ­ cuá»‘i cÃ¹ng mÃ  harvester Ä‘ang Ä‘á»c vÃ  Ä‘áº£m báº£o táº¥t cáº£ cÃ¡c dÃ²ng log Ä‘Æ°á»£c gá»­i Ä‘i.</p>
<p>Filebeat lÆ°u tráº¡ng thÃ¡i gá»­i cá»§a má»—i sá»± kiá»‡n trong tá»‡p Ä‘Äƒng kÃ½. VÃ¬ váº­y, nÃ³ cÃ³ thá»ƒ Ä‘áº£m báº£o ráº±ng sá»± kiá»‡n Ä‘Æ°á»£c gá»­i Ã­t nháº¥t má»™t láº§n Ä‘áº¿n Ä‘áº§u ra Ä‘Æ°á»£c cáº¥u hÃ¬nh, khÃ´ng cÃ³ dá»¯ liá»‡u bá»‹ máº¥t.</p>
<h2>TÃ i liá»‡u</h2>
<p><a href="https://www.elastic.co/guide/en/beats/libbeat/current/index.html" target="_blank" rel="noopener noreferrer">TÃ i liá»‡u chÃ­nh thá»©c cá»§a Beats</a></p>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/beats-platform.png" type="image/png"/>
    </item>
    <item>
      <title>Elastic Stack Kabina</title>
      <link>https://vanhung4499.github.io/database/elastic/kabina.html</link>
      <guid>https://vanhung4499.github.io/database/elastic/kabina.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Elastic Stack Kabina</source>
      <description>Elastic Stack: Kibana Discover Báº±ng cÃ¡ch nháº¥p vÃ o Discover trong thanh Ä‘iá»u hÆ°á»›ng bÃªn, báº¡n cÃ³ thá»ƒ xem chá»©c nÄƒng truy váº¥n dá»¯ liá»‡u cá»§a Kibana. imgimg Trong thanh tÃ¬m kiáº¿m, báº¡n cÃ³ ...</description>
      <category>elastic</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>Discover</h2>
<p>Báº±ng cÃ¡ch nháº¥p vÃ o&nbsp;<code>Discover</code>&nbsp;trong thanh Ä‘iá»u hÆ°á»›ng bÃªn, báº¡n cÃ³ thá»ƒ xem chá»©c nÄƒng truy váº¥n dá»¯ liá»‡u cá»§a&nbsp;<code>Kibana</code>.</p>
<figure><img src="https://www.elastic.co/guide/en/kibana/current/images/tutorial-discover.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>
<p>Trong thanh tÃ¬m kiáº¿m, báº¡n cÃ³ thá»ƒ nháº­p Ä‘iá»u kiá»‡n truy váº¥n Elasticsearch Ä‘á»ƒ tÃ¬m kiáº¿m dá»¯ liá»‡u cá»§a mÃ¬nh. Báº¡n cÃ³ thá»ƒ duyá»‡t káº¿t quáº£ trÃªn trang&nbsp;<code>Discover</code>&nbsp;vÃ  táº¡o cÃ¡c biá»ƒu Ä‘á»“ trá»±c quan tá»« cÃ¡c tÃ¬m kiáº¿m Ä‘Ã£ lÆ°u trÃªn trang&nbsp;<code>Visualize</code>.</p>
<p>MÃ´ hÃ¬nh chá»‰ má»¥c hiá»‡n táº¡i Ä‘Æ°á»£c hiá»ƒn thá»‹ dÆ°á»›i thanh truy váº¥n. MÃ´ hÃ¬nh chá»‰ má»¥c xÃ¡c Ä‘á»‹nh chá»‰ má»¥c nÃ o Ä‘Æ°á»£c tÃ¬m kiáº¿m khi gá»­i truy váº¥n. Äá»ƒ tÃ¬m kiáº¿m má»™t táº­p há»£p chá»‰ má»¥c khÃ¡c nhau, chá»n má»™t mÃ´ hÃ¬nh khÃ¡c tá»« menu tháº£ xuá»‘ng. Äá»ƒ thÃªm mÃ´ hÃ¬nh chá»‰ má»¥c (index pattern), hÃ£y chuyá»ƒn Ä‘áº¿n&nbsp;<code>Management/Kibana/Index Patterns</code>&nbsp;vÃ  nháº¥p vÃ o&nbsp;<code>Add New</code>.</p>
<p>Báº¡n cÃ³ thá»ƒ xÃ¢y dá»±ng tÃ¬m kiáº¿m báº±ng cÃ¡ch sá»­ dá»¥ng tÃªn trÆ°á»ng vÃ  giÃ¡ trá»‹ báº¡n quan tÃ¢m. Äá»‘i vá»›i cÃ¡c trÆ°á»ng sá»‘, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c toÃ¡n tá»­ so sÃ¡nh nhÆ° lá»›n hÆ¡n (&gt;), nhá» hÆ¡n (&lt;) hoáº·c báº±ng (=). Báº¡n cÃ³ thá»ƒ liÃªn káº¿t cÃ¡c pháº§n tá»­ vá»›i cÃ¡c toÃ¡n tá»­ logic&nbsp;<code>AND</code>,&nbsp;<code>OR</code>&nbsp;vÃ &nbsp;<code>NOT</code>, táº¥t cáº£ Ä‘á»u viáº¿t hoa.</p>
<p>Máº·c Ä‘á»‹nh, má»—i tÃ i liá»‡u khá»›p sáº½ hiá»ƒn thá»‹ táº¥t cáº£ cÃ¡c trÆ°á»ng. Äá»ƒ chá»n cÃ¡c trÆ°á»ng tÃ i liá»‡u Ä‘á»ƒ hiá»ƒn thá»‹, di chuyá»ƒn chuá»™t qua danh sÃ¡ch "Available fields", sau Ä‘Ã³ nháº¥p vÃ o nÃºt thÃªm bÃªn cáº¡nh má»—i trÆ°á»ng báº¡n muá»‘n bao gá»“m. VÃ­ dá»¥, náº¿u chá»‰ thÃªm account_number, hiá»ƒn thá»‹ sáº½ thay Ä‘á»•i thÃ nh danh sÃ¡ch Ä‘Æ¡n giáº£n bao gá»“m nÄƒm sá»‘ tÃ i khoáº£n:</p>
<figure><img src="https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-discover-3.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>
<h3>Ngá»¯ phÃ¡p truy váº¥n</h3>
<p>Thanh tÃ¬m kiáº¿m cá»§a Kibana tuÃ¢n thá»§ ngá»¯ phÃ¡p truy váº¥n Ä‘Æ°á»£c mÃ´ táº£ trong tÃ i liá»‡u&nbsp;<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-query-string-query.html#query-string-syntax" target="_blank" rel="noopener noreferrer">query-string-syntax</a>.</p>
<p>DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ ngá»¯ phÃ¡p truy váº¥n cÆ¡ báº£n.</p>
<p>Chuá»—i truy váº¥n sáº½ Ä‘Æ°á»£c phÃ¢n tÃ­ch thÃ nh má»™t loáº¡t cÃ¡c thuáº­t ngá»¯ vÃ  toÃ¡n tá»­. Má»™t thuáº­t ngá»¯ cÃ³ thá»ƒ lÃ  má»™t tá»« (nhÆ°: quick, brown) hoáº·c má»™t cá»¥m tá»« Ä‘Æ°á»£c bao quanh bá»Ÿi dáº¥u ngoáº·c kÃ©p (nhÆ° "quick brown").</p>
<p>CÃ¡c hoáº¡t Ä‘á»™ng truy váº¥n cho phÃ©p báº¡n tÃ¹y chá»‰nh tÃ¬m kiáº¿m - dÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡c tÃ¹y chá»n cÃ³ sáºµn.</p>
<h4>TÃªn trÆ°á»ng</h4>
<p>NhÆ° Ä‘Ã£ nÃ³i trong truy váº¥n chuá»—i, sáº½ tÃ¬m kiáº¿m <code>default_field</code> trong Ä‘iá»u kiá»‡n tÃ¬m kiáº¿m, nhÆ°ng báº¡n cÅ©ng cÃ³ thá»ƒ chá»‰ Ä‘á»‹nh cÃ¡c trÆ°á»ng khÃ¡c trong cÃº phÃ¡p truy váº¥n:</p>
<p>VÃ­ dá»¥:</p>
<ul>
<li>TÃ¬m kiáº¿m tá»« khÃ³a <code>active</code> trong trÆ°á»ng <code>status</code></li>
</ul>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>status:active</span></span></code></pre>
</div><ul>
<li>TrÆ°á»ng <code>title</code> chá»©a tá»« khÃ³a <code>quick</code> hoáº·c <code>brown</code>. Náº¿u báº¡n bá» qua toÃ¡n tá»­ <code>OR</code>, toÃ¡n tá»­ máº·c Ä‘á»‹nh sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng</li>
</ul>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>title:(quick OR brown)</span></span>
<span class="line"><span>title:(quick brown)</span></span></code></pre>
</div><ul>
<li>TrÆ°á»ng tÃ¡c giáº£ tÃ¬m cá»¥m tá»« chÃ­nh xÃ¡c "John Smith", tá»©c lÃ  tÃ¬m kiáº¿m chÃ­nh xÃ¡c.</li>
</ul>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>author:"John Smith"</span></span></code></pre>
</div><ul>
<li>Báº¥t ká»³ trÆ°á»ng nÃ o <code>book.title</code>, <code>book.content</code> hoáº·c <code>book.date</code> Ä‘á»u chá»©a <code>quick</code> hoáº·c <code>brown</code> (lÆ°u Ã½ lÃ m tháº¿ nÃ o chÃºng tÃ´i sá»­ dá»¥ng <code>\*</code> Ä‘á»ƒ biá»ƒu thá»‹ kÃ½ tá»± Ä‘áº¡i diá»‡n)</li>
</ul>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>book.\*:(quick brown)</span></span></code></pre>
</div><ul>
<li>TrÆ°á»ng tiÃªu Ä‘á» chá»©a báº¥t ká»³ giÃ¡ trá»‹ khÃ´ng null nÃ o</li>
</ul>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>_exists_:title</span></span></code></pre>
</div><h4>KÃ½ tá»± Ä‘áº¡i diá»‡n</h4>
<p>ELK cung cáº¥p hai kÃ½ tá»± Ä‘áº¡i diá»‡n lÃ  ? vÃ  *.</p>
<ul>
<li><code>?</code> biá»ƒu thá»‹ báº¥t ká»³ kÃ½ tá»± Ä‘Æ¡n nÃ o;</li>
<li><code>*</code> biá»ƒu thá»‹ báº¥t ká»³ khÃ´ng hoáº·c nhiá»u kÃ½ tá»±.</li>
</ul>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>qu?ck bro*</span></span></code></pre>
</div><blockquote>
<p><strong>ChÃº Ã½: Truy váº¥n kÃ½ tá»± Ä‘áº¡i diá»‡n sáº½ sá»­ dá»¥ng ráº¥t nhiá»u bá»™ nhá»› vÃ  hiá»‡u suáº¥t thá»±c thi khÃ´ng tá»‘t, vÃ¬ váº­y hÃ£y sá»­ dá»¥ng cáº©n tháº­n.</strong> &gt; <strong>Gá»£i Ã½</strong>: KÃ½ tá»± Ä‘áº¡i diá»‡n tinh khiáº¿t <code>*</code> Ä‘Æ°á»£c viáº¿t vÃ o truy váº¥n <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-exists-query.html" target="_blank" rel="noopener noreferrer">exists</a>, Ä‘iá»u nÃ y Ä‘Ã£ cáº£i thiá»‡n hiá»‡u suáº¥t truy váº¥n. Do Ä‘Ã³, kÃ½ tá»± Ä‘áº¡i diá»‡n <code>fieldï¼š*</code> sáº½ khá»›p vá»›i tÃ i liá»‡u chá»©a giÃ¡ trá»‹ trá»‘ng, nhÆ°: <code>{â€œfieldâ€ï¼šâ€œâ€}</code>, nhÆ°ng náº¿u trÆ°á»ng bá»‹ máº¥t hoáº·c giÃ¡ trá»‹ Ä‘Æ°á»£c Ä‘áº·t thÃ nh null thÃ¬ sáº½ khÃ´ng khá»›p, nhÆ°: <code>â€œfieldâ€ï¼šnull}</code> &gt; <strong>Gá»£i Ã½</strong>: Sá»­ dá»¥ng kÃ½ tá»± Ä‘áº¡i diá»‡n á»Ÿ Ä‘áº§u má»™t tá»« (vÃ­ dá»¥: <code>*ing</code>) táº¡o ra má»™t lÆ°á»£ng truy váº¥n ráº¥t lá»›n, vÃ¬ táº¥t cáº£ cÃ¡c thuáº­t ngá»¯ trong chá»‰ má»¥c Ä‘á»u cáº§n Ä‘Æ°á»£c kiá»ƒm tra, chá»‰ trong trÆ°á»ng há»£p nÃ³ khá»›p. Báº¡n cÃ³ thá»ƒ vÃ´ hiá»‡u hÃ³a Ä‘iá»u nÃ y báº±ng cÃ¡ch Ä‘áº·t <code>allow_leading_wildcard</code> thÃ nh <code>false</code>.</p>
</blockquote>
<h4>Biá»ƒu thá»©c chÃ­nh quy</h4>
<p>Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng biá»ƒu thá»©c chÃ­nh quy trong chuá»—i truy váº¥n báº±ng cÃ¡ch Ä‘áº·t chÃºng vÃ o <code>/</code>.</p>
<p>VÃ­ dá»¥:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>name:/joh?n(ath[oa]n)/</span></span></code></pre>
</div><p>CÃº phÃ¡p biá»ƒu thá»©c chÃ­nh quy Ä‘Æ°á»£c há»— trá»£ cÃ³ thá»ƒ Ä‘Æ°á»£c tham kháº£o táº¡i: <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-regexp-query.html#regexp-syntax" target="_blank" rel="noopener noreferrer">Regular expression syntax</a></p>
<h4>Truy váº¥n má»</h4>
<p>ChÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng toÃ¡n tá»­ <code>~</code> Ä‘á»ƒ thá»±c hiá»‡n truy váº¥n má».</p>
<p>VÃ­ dá»¥:</p>
<p>Giáº£ sá»­ chÃºng ta thá»±c sá»± muá»‘n truy váº¥n</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>quick brown forks</span></span></code></pre>
</div><p>NhÆ°ng, do lá»—i Ä‘Ã¡nh mÃ¡y, tá»« khÃ³a truy váº¥n cá»§a chÃºng ta trá»Ÿ thÃ nh nhÆ° sau, chÃºng ta váº«n cÃ³ thá»ƒ tÃ¬m tháº¥y káº¿t quáº£ mong muá»‘n.</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>quikc\~ brwn\~ foks\~</span></span></code></pre>
</div><p>Truy váº¥n má» nÃ y sá»­ dá»¥ng khoáº£ng cÃ¡ch Damerau-Levenshtein Ä‘á»ƒ tÃ¬m táº¥t cáº£ cÃ¡c má»¥c khá»›p vá»›i tá»‘i Ä‘a hai thay Ä‘á»•i. CÃ¡c thay Ä‘á»•i Ä‘Æ°á»£c Ä‘á» cáº­p á»Ÿ Ä‘Ã¢y lÃ  viá»‡c chÃ¨n, xÃ³a hoáº·c thay tháº¿ má»™t kÃ½ tá»± duy nháº¥t, hoáº·c hoÃ¡n Ä‘á»•i hai kÃ½ tá»± liá»n ká».</p>
<p>Khoáº£ng cÃ¡ch chá»‰nh sá»­a máº·c Ä‘á»‹nh lÃ  <code>2</code>, nhÆ°ng khoáº£ng cÃ¡ch chá»‰nh sá»­a <code>1</code> nÃªn Ä‘á»§ Ä‘á»ƒ báº¯t Ä‘Æ°á»£c 80% lá»—i Ä‘Ã¡nh mÃ¡y cá»§a con ngÆ°á»i. NÃ³ cÃ³ thá»ƒ Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh nhÆ°:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>quikc\~1</span></span></code></pre>
</div><h4>TÃ¬m kiáº¿m xáº¥p xá»‰</h4>
<p>Máº·c dÃ¹ truy váº¥n cá»¥m tá»« (vÃ­ dá»¥, <code>john smith</code>) mong Ä‘á»£i táº¥t cáº£ cÃ¡c tá»« Ä‘á»u theo Ä‘Ãºng thá»© tá»±, nhÆ°ng tÃ¬m kiáº¿m xáº¥p xá»‰ cho phÃ©p cÃ¡c tá»« Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh á»Ÿ xa hÆ¡n hoáº·c Ä‘Æ°á»£c sáº¯p xáº¿p theo thá»© tá»± khÃ¡c nhau. Giá»‘ng nhÆ° truy váº¥n má» cÃ³ thá»ƒ chá»‰ Ä‘á»‹nh khoáº£ng cÃ¡ch chá»‰nh sá»­a tá»‘i Ä‘a cho cÃ¡c kÃ½ tá»± trong má»™t tá»«, tÃ¬m kiáº¿m xáº¥p xá»‰ cÅ©ng cho phÃ©p chÃºng ta chá»‰ Ä‘á»‹nh khoáº£ng cÃ¡ch chá»‰nh sá»­a tá»‘i Ä‘a cho cÃ¡c tá»« trong má»™t cá»¥m tá»«:</p>
<p>VÃ­ dá»¥</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>"fox quick"\~5</span></span></code></pre>
</div><p>VÄƒn báº£n trong trÆ°á»ng cÃ ng gáº§n vá»›i thá»© tá»± gá»‘c Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh trong chuá»—i truy váº¥n, tÃ i liá»‡u Ä‘Ã³ cÃ ng Ä‘Æ°á»£c coi lÃ  liÃªn quan. Khi so sÃ¡nh vá»›i truy váº¥n máº«u á»Ÿ trÃªn, cá»¥m tá»« <code>"quick fox"</code> sáº½ Ä‘Æ°á»£c coi lÃ  gáº§n vá»›i Ä‘iá»u kiá»‡n truy váº¥n hÆ¡n so vá»›i <code>"quick brown fox"</code>.</p>
<h4>Pháº¡m vi</h4>
<p>Báº¡n cÃ³ thá»ƒ chá»‰ Ä‘á»‹nh pháº¡m vi cho cÃ¡c trÆ°á»ng ngÃ y, sá»‘ hoáº·c chuá»—i. Pháº¡m vi khoáº£ng Ä‘Ã³ng Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh báº±ng dáº¥u ngoáº·c vuÃ´ng <code>[min TO max]</code> vÃ  pháº¡m vi khoáº£ng má»Ÿ Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh báº±ng dáº¥u ngoáº·c nhá»n <code>{min TO max}</code>.</p>
<p>HÃ£y xem má»™t sá»‘ vÃ­ dá»¥.</p>
<ul>
<li>Táº¥t cáº£ cÃ¡c ngÃ y trong nÄƒm 2012</li>
</ul>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>date:[2012-01-01 TO 2012-12-31]</span></span></code></pre>
</div><ul>
<li>Sá»‘ tá»« 1 Ä‘áº¿n 5</li>
</ul>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>count:[1 TO 5]</span></span></code></pre>
</div><ul>
<li>NhÃ£n giá»¯a <code>alpha</code> vÃ  <code>omega</code>, khÃ´ng bao gá»“m <code>alpha</code> vÃ  <code>omega</code></li>
</ul>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>tag:{alpha TO omega}</span></span></code></pre>
</div><ul>
<li>Sá»‘ lá»›n hÆ¡n 10</li>
</ul>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>count:[10 TO *]</span></span></code></pre>
</div><ul>
<li>Táº¥t cáº£ cÃ¡c ngÃ y trÆ°á»›c nÄƒm 2012</li>
</ul>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>date:{* TO 2012-01-01}</span></span></code></pre>
</div><p>NgoÃ i ra, báº¡n cÅ©ng cÃ³ thá»ƒ káº¿t há»£p khoáº£ng má»Ÿ vÃ  khoáº£ng Ä‘Ã³ng</p>
<ul>
<li>Sá»‘ tá»« 1 Ä‘áº¿n 5, nhÆ°ng khÃ´ng bao gá»“m 5</li>
</ul>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>count:[1 TO 5}</span></span></code></pre>
</div><p>Pháº¡m vi khÃ´ng giá»›i háº¡n á»Ÿ má»™t bÃªn cÅ©ng cÃ³ thá»ƒ sá»­ dá»¥ng cÃº phÃ¡p sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>age:&gt;10</span></span>
<span class="line"><span>age:&gt;=10</span></span>
<span class="line"><span>age:&lt;10</span></span>
<span class="line"><span>age:&lt;=10</span></span></code></pre>
</div><p>Táº¥t nhiÃªn, báº¡n cÅ©ng cÃ³ thá»ƒ sá»­ dá»¥ng toÃ¡n tá»­ AND Ä‘á»ƒ nháº­n Ä‘Æ°á»£c giao cá»§a hai káº¿t quáº£ truy váº¥n</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>age:(&gt;=10 AND &lt;20)</span></span>
<span class="line"><span>age:(+&gt;=10 +&lt;20)</span></span></code></pre>
</div><h4>Boosting</h4>
<p>Sá»­ dá»¥ng toÃ¡n tá»­ <code>^</code> Ä‘á»ƒ lÃ m cho má»™t thuáº­t ngá»¯ trá»Ÿ nÃªn quan trá»ng hÆ¡n má»™t thuáº­t ngá»¯ khÃ¡c. VÃ­ dá»¥, náº¿u chÃºng ta muá»‘n tÃ¬m táº¥t cáº£ cÃ¡c tÃ i liá»‡u liÃªn quan Ä‘áº¿n cÃ¡o, nhÆ°ng chÃºng ta Ä‘áº·c biá»‡t quan tÃ¢m Ä‘áº¿n tá»« "nhanh":</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>quick^2 fox</span></span></code></pre>
</div><p>GiÃ¡ trá»‹ tÄƒng cÆ°á»ng máº·c Ä‘á»‹nh lÃ  1, nhÆ°ng cÃ³ thá»ƒ lÃ  báº¥t ká»³ sá»‘ dÆ°Æ¡ng nÃ o. TÄƒng cÆ°á»ng giá»¯a 0 vÃ  1 giáº£m Ä‘á»™ liÃªn quan.</p>
<p>TÄƒng cÆ°á»ng cÅ©ng cÃ³ thá»ƒ Ä‘Æ°á»£c Ã¡p dá»¥ng cho cá»¥m tá»« hoáº·c nhÃ³m:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>"john smith"^2   (foo bar)^4</span></span></code></pre>
</div><h4>Thao tÃ¡c Boolean</h4>
<p>Theo máº·c Ä‘á»‹nh, táº¥t cáº£ cÃ¡c tá»« Ä‘á»u tÃ¹y chá»n miá»…n lÃ  cÃ³ má»™t tá»« phÃ¹ há»£p. TÃ¬m kiáº¿m <code>foo bar baz</code> sáº½ tÃ¬m kiáº¿m báº¥t ká»³ tÃ i liá»‡u nÃ o chá»©a má»™t hoáº·c nhiá»u tá»« <code>foo</code> hoáº·c <code>bar</code> hoáº·c <code>baz</code>. ChÃºng tÃ´i Ä‘Ã£ tháº£o luáº­n vá» <code>default_operator</code> á»Ÿ trÃªn, cho phÃ©p báº¡n yÃªu cáº§u táº¥t cáº£ cÃ¡c má»¥c, nhÆ°ng cÅ©ng cÃ³ cÃ¡c toÃ¡n tá»­ Boolean cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng trong chuá»—i truy váº¥n Ä‘á»ƒ cung cáº¥p nhiá»u kiá»ƒm soÃ¡t hÆ¡n.</p>
<p>ToÃ¡n tá»­ Æ°a thÃ­ch lÃ  <code>+</code> (thuáº­t ngá»¯ nÃ y pháº£i tá»“n táº¡i) vÃ  <code>-</code> (thuáº­t ngá»¯ nÃ y khÃ´ng Ä‘Æ°á»£c tá»“n táº¡i). Táº¥t cáº£ cÃ¡c thuáº­t ngá»¯ khÃ¡c lÃ  tÃ¹y chá»n. VÃ­ dá»¥, truy váº¥n nÃ y:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>quick brown +fox -news</span></span></code></pre>
</div><p>Truy váº¥n nÃ y cÃ³ nghÄ©a lÃ :</p>
<ul>
<li>fox pháº£i tá»“n táº¡i</li>
<li>news khÃ´ng Ä‘Æ°á»£c tá»“n táº¡i</li>
<li>quick vÃ  brown lÃ  tÃ¹y chá»n</li>
</ul>
<p>CÃ¡c toÃ¡n tá»­ quen thuá»™c <code>AND</code>, <code>OR</code> vÃ  <code>NOT</code> (cÅ©ng Ä‘Æ°á»£c viáº¿t lÃ  <code>&amp;&amp;</code>, <code>||</code> vÃ  <code>!</code>) cÅ©ng Ä‘Æ°á»£c há»— trá»£. Tuy nhiÃªn, cÃ¡c toÃ¡n tá»­ nÃ y cÃ³ má»©c Ä‘á»™ Æ°u tiÃªn: <code>NOT</code> Æ°u tiÃªn hÆ¡n <code>AND</code>, <code>AND</code> Æ°u tiÃªn hÆ¡n <code>OR</code>. Máº·c dÃ¹ <code>+</code> vÃ  <code>-</code> chá»‰ áº£nh hÆ°á»Ÿng Ä‘áº¿n thuáº­t ngá»¯ á»Ÿ bÃªn pháº£i cá»§a toÃ¡n tá»­, nhÆ°ng <code>AND</code> vÃ  <code>OR</code> sáº½ áº£nh hÆ°á»Ÿng Ä‘áº¿n thuáº­t ngá»¯ á»Ÿ cáº£ hai bÃªn.</p>
<h4>NhÃ³m</h4>
<p>Nhiá»u thuáº­t ngá»¯ hoáº·c má»‡nh Ä‘á» cÃ³ thá»ƒ Ä‘Æ°á»£c káº¿t há»£p báº±ng cáº·p dáº¥u ngoáº·c Ä‘á»ƒ táº¡o ra má»™t truy váº¥n con</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>(quick OR brown) AND fox</span></span></code></pre>
</div><p>Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng nhÃ³m Ä‘á»ƒ Ä‘á»‹nh vá»‹ cÃ¡c trÆ°á»ng cá»¥ thá»ƒ, hoáº·c Ä‘á»ƒ tÄƒng cÆ°á»ng káº¿t quáº£ cá»§a truy váº¥n con:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>status:(active OR pending) title:(full text search)^2</span></span></code></pre>
</div><h4>Tá»« dá»± trá»¯</h4>
<p>Náº¿u báº¡n cáº§n sá»­ dá»¥ng báº¥t ká»³ kÃ½ tá»± nÃ o trong truy váº¥n cá»§a mÃ¬nh nhÆ° má»™t toÃ¡n tá»­ (thay vÃ¬ lÃ  má»™t toÃ¡n tá»­), thÃ¬ báº¡n nÃªn sá»­ dá»¥ng má»™t dáº¥u gáº¡ch chÃ©o ngÆ°á»£c Ä‘á»ƒ thoÃ¡t khá»i chÃºng. VÃ­ dá»¥, Ä‘á»ƒ tÃ¬m kiáº¿m (1 + 1) = 2, báº¡n cáº§n viáº¿t truy váº¥n lÃ  <code>\(1\+1\)\=2</code></p>
<p>CÃ¡c kÃ½ tá»± dá»± trá»¯ lÃ : <code>+ - = &amp;&amp; || &gt; &lt; ! ( ) { } [ ] ^ " ~ * ? : \ /</code></p>
<p>KhÃ´ng thá»ƒ thoÃ¡t Ä‘Ãºng cÃ¡c kÃ½ tá»± Ä‘áº·c biá»‡t nÃ y cÃ³ thá»ƒ dáº«n Ä‘áº¿n lá»—i cÃº phÃ¡p, ngÄƒn cháº·n truy váº¥n cá»§a báº¡n.</p>
<h4>Truy váº¥n rá»—ng</h4>
<p>Náº¿u chuá»—i truy váº¥n trá»‘ng hoáº·c chá»‰ chá»©a khoáº£ng tráº¯ng, truy váº¥n sáº½ táº¡o ra má»™t táº­p káº¿t quáº£ trá»‘ng.</p>
<h2>Visualize</h2>
<p>Äá»ƒ hiá»ƒn thá»‹ dá»¯ liá»‡u cá»§a báº¡n dÆ°á»›i dáº¡ng trá»±c quan, hÃ£y nháº¥p vÃ o <code>Visualize</code> trong thanh Ä‘iá»u hÆ°á»›ng bÃªn.</p>
<p>CÃ´ng cá»¥ Visualize cho phÃ©p báº¡n xem dá»¯ liá»‡u theo nhiá»u cÃ¡ch khÃ¡c nhau nhÆ° biá»ƒu Ä‘á»“ trÃ²n, biá»ƒu Ä‘á»“ cá»™t, Ä‘á»“ thá»‹ Ä‘Æ°á»ng, biá»ƒu Ä‘á»“ phÃ¢n phá»‘i, v.v. Äá»ƒ báº¯t Ä‘áº§u, hÃ£y nháº¥p vÃ o <code>Create a visualization</code> mÃ u xanh hoáº·c nÃºt <code>+</code>.</p>
<figure><img src="https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-landing.png" alt="https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-landing.png" tabindex="0" loading="lazy"><figcaption><a href="https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-landing.png" target="_blank" rel="noopener noreferrer">https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-landing.png</a></figcaption></figure>
<p>CÃ³ nhiá»u loáº¡i trá»±c quan hÃ³a Ä‘á»ƒ lá»±a chá»n.</p>
<figure><img src="https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-wizard-step-1.png" alt="https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-wizard-step-1.png" tabindex="0" loading="lazy"><figcaption><a href="https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-wizard-step-1.png" target="_blank" rel="noopener noreferrer">https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-wizard-step-1.png</a></figcaption></figure>
<p>DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ vÃ­ dá»¥ vá» viá»‡c táº¡o biá»ƒu Ä‘á»“:</p>
<h3>Pie</h3>
<p>Báº¡n cÃ³ thá»ƒ xÃ¢y dá»±ng biá»ƒu Ä‘á»“ trá»±c quan tá»« tÃ¬m kiáº¿m Ä‘Ã£ lÆ°u hoáº·c nháº­p Ä‘iá»u kiá»‡n tÃ¬m kiáº¿m má»›i. Äá»ƒ nháº­p Ä‘iá»u kiá»‡n tÃ¬m kiáº¿m má»›i, trÆ°á»›c tiÃªn cáº§n chá»n má»™t mÃ´ hÃ¬nh chá»‰ má»¥c Ä‘á»ƒ xÃ¡c Ä‘á»‹nh chá»‰ má»¥c cáº§n tÃ¬m kiáº¿m.</p>
<p>Máº·c Ä‘á»‹nh, tÃ¬m kiáº¿m khá»›p vá»›i táº¥t cáº£ cÃ¡c tÃ i liá»‡u. Ban Ä‘áº§u, má»™t "pháº§n" chá»©a toÃ n bá»™ biá»ƒu Ä‘á»“ trÃ²n:</p>
<figure><img src="https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-pie-1.png" alt="https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-pie-1.png" tabindex="0" loading="lazy"><figcaption><a href="https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-pie-1.png" target="_blank" rel="noopener noreferrer">https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-pie-1.png</a></figcaption></figure>
<p>Äá»ƒ chá»‰ Ä‘á»‹nh dá»¯ liá»‡u nÃ o Ä‘Æ°á»£c hiá»ƒn thá»‹ trong biá»ƒu Ä‘á»“, hÃ£y sá»­ dá»¥ng viá»‡c tá»• chá»©c chá»©a cá»§a Elasticsearch. Tá»• chá»©c chá»©a chá»‰ Ä‘Æ¡n giáº£n lÃ  phÃ¢n loáº¡i cÃ¡c tÃ i liá»‡u khá»›p vá»›i Ä‘iá»u kiá»‡n tÃ¬m kiáº¿m cá»§a báº¡n vÃ  Ä‘Æ°á»£c gá»i lÃ  nhÃ³m.</p>
<p>XÃ¡c Ä‘á»‹nh má»™t tá»• chá»©c chá»©a cho má»—i pháº¡m vi:</p>
<ol>
<li>Nháº¥p vÃ o <code>Split Slices</code>.</li>
<li>Chá»n <code>Terms</code> trong danh sÃ¡ch <code>Aggregation</code>. LÆ°u Ã½: á» Ä‘Ã¢y, "Terms" lÃ  trÆ°á»ng hoáº·c nhÃ£n Ä‘Ã£ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a khi thu tháº­p dá»¯ liá»‡u Elk.</li>
<li>Chá»n <code>level.keyword</code> trong danh sÃ¡ch <code>Field</code>.</li>
<li>Nháº¥p vÃ o nÃºt <img src="https://www.elastic.co/guide/en/kibana/6.1/images/apply-changes-button.png" alt="images/apply-changes-button.png" loading="lazy"> Ä‘á»ƒ cáº­p nháº­t biá»ƒu Ä‘á»“.</li>
</ol>
<figure><img src="https://upload-images.jianshu.io/upload_images/3101171-7fb2042dc6d59520.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure>
<p>Sau khi hoÃ n thÃ nh, náº¿u báº¡n muá»‘n lÆ°u biá»ƒu Ä‘á»“ nÃ y, báº¡n cÃ³ thá»ƒ nháº¥p vÃ o nÃºt <code>Save</code> á»Ÿ phÃ­a trÃªn trang.</p>
<h3>Vertical Bar</h3>
<p>ChÃºng ta hÃ£y xem cÃ¡ch táº¡o biá»ƒu Ä‘á»“ cá»™t dá»c.</p>
<ol>
<li>Nháº¥p vÃ o <code>Create a visualization</code> mÃ u xanh hoáº·c nÃºt <code>+</code>. Chá»n <code>Vertical Bar</code>.</li>
<li>Chá»n mÃ´ hÃ¬nh chá»‰ má»¥c. VÃ¬ báº¡n chÆ°a xÃ¡c Ä‘á»‹nh báº¥t ká»³ bucket nÃ o, báº¡n sáº½ tháº¥y má»™t thanh lá»›n hiá»ƒn thá»‹ tá»•ng sá»‘ tÃ i liá»‡u khá»›p vá»›i truy váº¥n kÃ½ tá»± Ä‘áº¡i diá»‡n máº·c Ä‘á»‹nh.</li>
<li>XÃ¡c Ä‘á»‹nh trÆ°á»ng Ä‘áº¡i diá»‡n cho trá»¥c Y.</li>
<li>XÃ¡c Ä‘á»‹nh trÆ°á»ng Ä‘áº¡i diá»‡n cho trá»¥c X.</li>
<li>Nháº¥p vÃ o nÃºt <img src="https://www.elastic.co/guide/en/kibana/6.1/images/apply-changes-button.png" alt="images/apply-changes-button.png" loading="lazy"> Ä‘á»ƒ cáº­p nháº­t biá»ƒu Ä‘á»“.</li>
</ol>
<figure><img src="https://upload-images.jianshu.io/upload_images/3101171-5aa7627284c19a56.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure>
<p>Sau khi hoÃ n thÃ nh, náº¿u báº¡n muá»‘n lÆ°u biá»ƒu Ä‘á»“ nÃ y, báº¡n cÃ³ thá»ƒ nháº¥p vÃ o nÃºt <code>Save</code> á»Ÿ phÃ­a trÃªn trang.</p>
<h2>Dashboard</h2>
<p><code>Dashboard</code> cho phÃ©p tá»•ng há»£p vÃ  chia sáº» táº­p há»£p <code>Visualize</code>.</p>
<ol>
<li>Nháº¥p vÃ o <code>Dashboard</code> trong thanh Ä‘iá»u hÆ°á»›ng bÃªn.</li>
<li>Nháº¥p vÃ o <code>Add</code> Ä‘á»ƒ hiá»ƒn thá»‹ danh sÃ¡ch trá»±c quan hÃ³a Ä‘Ã£ lÆ°u.</li>
<li>Nháº¥p vÃ o <code>Visualize</code> Ä‘Ã£ lÆ°u trÆ°á»›c Ä‘Ã³ vÃ  sau Ä‘Ã³ nháº¥p vÃ o mÅ©i tÃªn nhá» á»Ÿ cuá»‘i danh sÃ¡ch Ä‘á»ƒ Ä‘Ã³ng danh sÃ¡ch trá»±c quan hÃ³a.</li>
<li>Di chuá»™t qua Ä‘á»‘i tÆ°á»£ng trá»±c quan sáº½ hiá»ƒn thá»‹ cÃ¡c Ä‘iá»u khiá»ƒn khung cho phÃ©p báº¡n chá»‰nh sá»­a, di chuyá»ƒn, xÃ³a vÃ  Ä‘iá»u chá»‰nh kÃ­ch thÆ°á»›c Ä‘á»‘i tÆ°á»£ng trá»±c quan.</li>
</ol>
]]></content:encoded>
      <enclosure url="https://www.elastic.co/guide/en/kibana/current/images/tutorial-discover.png" type="image/png"/>
    </item>
    <item>
      <title>Kibana Operation</title>
      <link>https://vanhung4499.github.io/database/elastic/kibana-operation.html</link>
      <guid>https://vanhung4499.github.io/database/elastic/kibana-operation.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Kibana Operation</source>
      <description>Váº­n hÃ nh Kibana ThÃ´ng qua Kibana, báº¡n cÃ³ thá»ƒ trá»±c quan hÃ³a Elasticsearch cá»§a mÃ¬nh vÃ  Ä‘iá»u hÆ°á»›ng trong Elastic Stack, cho phÃ©p báº¡n thá»±c hiá»‡n cÃ¡c hoáº¡t Ä‘á»™ng khÃ¡c nhau, tá»« theo dÃµi ...</description>
      <category>elastic</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<p>ThÃ´ng qua Kibana, báº¡n cÃ³ thá»ƒ trá»±c quan hÃ³a Elasticsearch cá»§a mÃ¬nh vÃ  Ä‘iá»u hÆ°á»›ng trong Elastic Stack, cho phÃ©p báº¡n thá»±c hiá»‡n cÃ¡c hoáº¡t Ä‘á»™ng khÃ¡c nhau, tá»« theo dÃµi táº£i truy váº¥n Ä‘áº¿n hiá»ƒu cÃ¡ch cÃ¡c yÃªu cáº§u cháº£y qua toÃ n bá»™ á»©ng dá»¥ng cá»§a báº¡n.</p>
<h2>1. CÃ i Ä‘áº·t</h2>
<h3>1.1. YÃªu cáº§u há»‡ thá»‘ng</h3>
<p>PhiÃªn báº£n: Elastic Stack 7.4</p>
<h3>1.2. CÃ¡c bÆ°á»›c cÃ i Ä‘áº·t</h3>
<p>CÃ¡c bÆ°á»›c cÃ i Ä‘áº·t nhÆ° sau:</p>
<ol>
<li>Táº£i gÃ³i phiÃªn báº£n yÃªu cáº§u tá»« <a href="https://www.elastic.co/downloads/kibana" target="_blank" rel="noopener noreferrer">trang táº£i xuá»‘ng chÃ­nh thá»©c cá»§a Kibana</a> vÃ  giáº£i nÃ©n nÃ³ trÃªn mÃ¡y cá»¥c bá»™ cá»§a báº¡n.</li>
<li>Sá»­a tá»‡p cáº¥u hÃ¬nh <code>config/kibana.yml</code> vÃ  Ä‘áº·t <code>elasticsearch.url</code> Ä‘á»ƒ trá» Ä‘áº¿n Elasticsearch cá»§a báº¡n.</li>
<li>Cháº¡y <code>bin/kibana</code> (hoáº·c <code>bin\kibana.bat</code> trÃªn Windows).</li>
<li>Truy cáº­p Kibana trong trÃ¬nh duyá»‡t cá»§a báº¡n táº¡i Ä‘á»‹a chá»‰ <a href="http://localhost:5601" target="_blank" rel="noopener noreferrer">http://localhost:5601</a>.</li>
</ol>
<h2>2. Sá»­ dá»¥ng</h2>
<h3>2.1. KhÃ¡m phÃ¡ (Discover)</h3>
<p>Nháº¥p vÃ o <code>Discover</code> trong thanh Ä‘iá»u hÆ°á»›ng bÃªn Ä‘á»ƒ truy cáº­p chá»©c nÄƒng truy váº¥n dá»¯ liá»‡u cá»§a Kibana.</p>
<figure><img src="https://www.elastic.co/guide/en/kibana/current/images/tutorial-discover.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>
<p>Trong thanh tÃ¬m kiáº¿m, báº¡n cÃ³ thá»ƒ nháº­p cÃ¡c Ä‘iá»u kiá»‡n truy váº¥n Elasticsearch Ä‘á»ƒ tÃ¬m kiáº¿m dá»¯ liá»‡u cá»§a báº¡n. Báº¡n cÃ³ thá»ƒ duyá»‡t qua káº¿t quáº£ trÃªn trang <code>Discover</code> vÃ  táº¡o cÃ¡c trá»±c quan hÃ³a vá»›i cÃ¡c Ä‘iá»u kiá»‡n tÃ¬m kiáº¿m Ä‘Ã£ lÆ°u trÃªn trang <code>Visualize</code>.</p>
<p>Máº«u chá»‰ má»¥c hiá»‡n táº¡i Ä‘Æ°á»£c hiá»ƒn thá»‹ dÆ°á»›i thanh tÃ¬m kiáº¿m. Máº«u chá»‰ má»¥c xÃ¡c Ä‘á»‹nh cÃ¡c chá»‰ má»¥c nÃ o Ä‘Æ°á»£c tÃ¬m kiáº¿m khi truy váº¥n Ä‘Æ°á»£c gá»­i. Äá»ƒ tÃ¬m kiáº¿m má»™t táº­p há»£p chá»‰ má»¥c khÃ¡c, hÃ£y chá»n má»™t máº«u khÃ¡c tá»« menu tháº£ xuá»‘ng. Äá»ƒ thÃªm má»™t máº«u chá»‰ má»¥c, Ä‘iá»u hÆ°á»›ng Ä‘áº¿n <code>Management/Kibana/Index Patterns</code> vÃ  nháº¥p vÃ o <code>Add New</code>.</p>
<p>Báº¡n cÃ³ thá»ƒ xÃ¢y dá»±ng cÃ¡c truy váº¥n báº±ng cÃ¡ch sá»­ dá»¥ng tÃªn trÆ°á»ng vÃ  cÃ¡c giÃ¡ trá»‹ quan tÃ¢m. Äá»‘i vá»›i cÃ¡c trÆ°á»ng sá»‘, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c toÃ¡n tá»­ so sÃ¡nh nhÆ° lá»›n hÆ¡n (&gt;), nhá» hÆ¡n (&lt;) hoáº·c báº±ng (=). Báº¡n cÃ³ thá»ƒ káº¿t há»£p cÃ¡c yáº¿u tá»‘ vá»›i cÃ¡c toÃ¡n tá»­ logic <code>AND</code>, <code>OR</code> vÃ  <code>NOT</code>, táº¥t cáº£ viáº¿t hoa.</p>
<p>Máº·c Ä‘á»‹nh, má»—i tÃ i liá»‡u khá»›p hiá»ƒn thá»‹ táº¥t cáº£ cÃ¡c trÆ°á»ng. Äá»ƒ chá»n cÃ¡c trÆ°á»ng tÃ i liá»‡u muá»‘n hiá»ƒn thá»‹, di chuá»™t qua danh sÃ¡ch "CÃ¡c trÆ°á»ng cÃ³ sáºµn" vÃ  nháº¥p vÃ o nÃºt thÃªm bÃªn cáº¡nh má»—i trÆ°á»ng báº¡n muá»‘n bao gá»“m. VÃ­ dá»¥, náº¿u chá»‰ thÃªm account_number, hiá»ƒn thá»‹ sáº½ thay Ä‘á»•i thÃ nh má»™t danh sÃ¡ch Ä‘Æ¡n giáº£n chá»©a nÄƒm tÃ i khoáº£n:</p>
<figure><img src="https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-discover-3.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>
<p>Thanh tÃ¬m kiáº¿m trong Kibana tuÃ¢n theo cÃº phÃ¡p chuá»—i truy váº¥n Ä‘Æ°á»£c mÃ´ táº£ trong tÃ i liá»‡u <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-query-string-query.html#query-string-syntax" target="_blank" rel="noopener noreferrer">query-string-syntax</a>.</p>
<p>DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ cÃº phÃ¡p truy váº¥n cÆ¡ báº£n nháº¥t.</p>
<h4>2.1.1. TÃªn trÆ°á»ng</h4>
<p>NhÆ° Ä‘Ã£ mÃ´ táº£ trong truy váº¥n chuá»—i truy váº¥n, máº·c Ä‘á»‹nh sáº½ tÃ¬m kiáº¿m trÆ°á»ng default_field trong Ä‘iá»u kiá»‡n tÃ¬m kiáº¿m, nhÆ°ng báº¡n cÃ³ thá»ƒ chá»‰ Ä‘á»‹nh cÃ¡c trÆ°á»ng khÃ¡c trong cÃº phÃ¡p truy váº¥n:</p>
<p>VÃ­ dá»¥:</p>
<ul>
<li>TÃ¬m kiáº¿m tá»« khÃ³a "active" trong trÆ°á»ng <code>status</code></li>
</ul>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>status:active</span></span></code></pre>
</div><ul>
<li>TÃ¬m kiáº¿m tá»« khÃ³a "quick" hoáº·c "brown" trong trÆ°á»ng <code>title</code>. Náº¿u báº¡n bá» qua toÃ¡n tá»­ <code>OR</code>, toÃ¡n tá»­ máº·c Ä‘á»‹nh sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng.</li>
</ul>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>title:(quick OR brown)</span></span>
<span class="line"><span>title:(quick brown)</span></span></code></pre>
</div><ul>
<li>TÃ¬m kiáº¿m cá»¥m tá»« chÃ­nh xÃ¡c "John Smith" trong trÆ°á»ng <code>author</code>.</li>
</ul>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>author:"John Smith"</span></span></code></pre>
</div><ul>
<li>TÃ¬m kiáº¿m tá»« khÃ³a "quick" hoáº·c "brown" trong báº¥t ká»³ trÆ°á»ng nÃ o (<code>book.title</code>, <code>book.content</code>, hoáº·c <code>book.date</code>). LÆ°u Ã½ cÃ¡ch sá»­ dá»¥ng <code>\*</code> Ä‘á»ƒ Ä‘áº¡i diá»‡n cho kÃ½ tá»± Ä‘áº¡i diá»‡n.</li>
</ul>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>book.\*:(quick brown)</span></span></code></pre>
</div><ul>
<li>TÃ¬m kiáº¿m cÃ¡c tÃ i liá»‡u cÃ³ trÆ°á»ng <code>title</code> chá»©a báº¥t ká»³ giÃ¡ trá»‹ khÃ¡c null nÃ o.</li>
</ul>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>_exists_:title</span></span></code></pre>
</div><h4>2.1.2. KÃ½ tá»± Ä‘áº¡i diá»‡n</h4>
<p>ELK cung cáº¥p hai kÃ½ tá»± Ä‘áº¡i diá»‡n lÃ  <code>?</code> vÃ  <code>*</code>.</p>
<ul>
<li><code>?</code> Ä‘áº¡i diá»‡n cho báº¥t ká»³ kÃ½ tá»± duy nháº¥t nÃ o;</li>
<li><code>*</code> Ä‘áº¡i diá»‡n cho báº¥t ká»³ sá»‘ kÃ½ tá»± nÃ o, bao gá»“m cáº£ khÃ´ng cÃ³ kÃ½ tá»±.</li>
</ul>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>qu?ck bro*</span></span></code></pre>
</div><blockquote>
<p><strong>LÆ°u Ã½: Truy váº¥n kÃ½ tá»± Ä‘áº¡i diá»‡n sáº½ sá»­ dá»¥ng nhiá»u bá»™ nhá»› vÃ  cÃ³ hiá»‡u suáº¥t thá»±c hiá»‡n kÃ©m, vÃ¬ váº­y hÃ£y sá»­ dá»¥ng cáº©n tháº­n.</strong> &gt; <strong>Gá»£i Ã½</strong>: Truy váº¥n kÃ½ tá»± Ä‘áº¡i diá»‡n thuáº§n tÃºy <code>*</code> Ä‘Æ°á»£c viáº¿t dÆ°á»›i dáº¡ng truy váº¥n <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-exists-query.html" target="_blank" rel="noopener noreferrer">exists</a> Ä‘á»ƒ cáº£i thiá»‡n hiá»‡u suáº¥t truy váº¥n. Do Ä‘Ã³, truy váº¥n <code>field:*</code> sáº½ khá»›p vá»›i cÃ¡c tÃ i liá»‡u chá»©a giÃ¡ trá»‹ rá»—ng nhÆ° <code>{ "field": "" }</code>, nhÆ°ng khÃ´ng khá»›p náº¿u trÆ°á»ng bá»‹ máº¥t hoáº·c giÃ¡ trá»‹ Ä‘Æ°á»£c Ä‘áº·t thÃ nh null nhÆ° <code>{ "field": null }</code>. &gt; <strong>Gá»£i Ã½</strong>: Truy váº¥n báº±ng kÃ½ tá»± Ä‘áº¡i diá»‡n á»Ÿ Ä‘áº§u tá»« (vÃ­ dá»¥: <code>*ing</code>) cÃ³ lÆ°á»£ng truy váº¥n Ä‘áº·c biá»‡t lá»›n, vÃ¬ táº¥t cáº£ cÃ¡c thuáº­t ngá»¯ trong chá»‰ má»¥c pháº£i Ä‘Æ°á»£c kiá»ƒm tra trong trÆ°á»ng há»£p cÃ³ khá»›p. Báº±ng cÃ¡ch Ä‘áº·t <code>allow_leading_wildcard</code> thÃ nh <code>false</code>, báº¡n cÃ³ thá»ƒ táº¯t tÃ­nh nÄƒng nÃ y.</p>
</blockquote>
<h4>2.1.3. Biá»ƒu thá»©c chÃ­nh quy</h4>
<p>Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng biá»ƒu thá»©c chÃ­nh quy báº±ng cÃ¡ch bao bá»c nÃ³ trong dáº¥u <code>/</code> trong chuá»—i truy váº¥n.</p>
<p>VÃ­ dá»¥:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>name:/joh?n(ath[oa]n)/</span></span></code></pre>
</div><p>CÃº phÃ¡p biá»ƒu thá»©c chÃ­nh quy Ä‘Æ°á»£c há»— trá»£ cÃ³ thá»ƒ Ä‘Æ°á»£c tham kháº£o táº¡i: <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-regexp-query.html#regexp-syntax" target="_blank" rel="noopener noreferrer">Regular expression syntax</a></p>
<h4>2.1.4. Truy váº¥n má»</h4>
<p>ChÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng toÃ¡n tá»­ <code>~</code> Ä‘á»ƒ thá»±c hiá»‡n truy váº¥n má».</p>
<p>VÃ­ dá»¥:</p>
<p>Giáº£ sá»­ chÃºng ta thá»±c sá»± muá»‘n tÃ¬m kiáº¿m</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>quick brown forks</span></span></code></pre>
</div><p>NhÆ°ng do lá»—i chÃ­nh táº£, tá»« khÃ³a truy váº¥n cá»§a chÃºng ta trá»Ÿ thÃ nh nhÆ° sau, nhÆ°ng váº«n cÃ³ thá»ƒ tÃ¬m tháº¥y káº¿t quáº£ mong muá»‘n.</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>quikc~ brwn~ foks~</span></span></code></pre>
</div><p>Truy váº¥n má» nÃ y sá»­ dá»¥ng khoáº£ng cÃ¡ch Damerau-Levenshtein Ä‘á»ƒ tÃ¬m táº¥t cáº£ cÃ¡c má»¥c khá»›p cÃ³ tá»‘i Ä‘a hai thay Ä‘á»•i. Thay Ä‘á»•i cÃ³ thá»ƒ lÃ  viá»‡c chÃ¨n, xÃ³a hoáº·c thay tháº¿ má»™t kÃ½ tá»± Ä‘Æ¡n, hoáº·c hoÃ¡n Ä‘á»•i vá»‹ trÃ­ cá»§a hai kÃ½ tá»± liá»n ká».</p>
<p>Khoáº£ng cÃ¡ch chá»‰nh sá»­a máº·c Ä‘á»‹nh lÃ  <code>2</code>, nhÆ°ng khoáº£ng cÃ¡ch chá»‰nh sá»­a lÃ  <code>1</code> thÆ°á»ng Ä‘á»§ Ä‘á»ƒ báº¯t Ä‘Æ°á»£c 80% lá»—i chÃ­nh táº£ cá»§a con ngÆ°á»i. NÃ³ cÃ³ thá»ƒ Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh nhÆ° sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>quikc~1</span></span></code></pre>
</div><h4>2.1.5. TÃ¬m kiáº¿m gáº§n Ä‘Ãºng</h4>
<p>Máº·c dÃ¹ truy váº¥n cá»¥m tá»« (vÃ­ dá»¥: <code>john smith</code>) mong Ä‘á»£i táº¥t cáº£ cÃ¡c thuáº­t ngá»¯ trong cá»¥m tá»« Ä‘Ã³ cÃ³ cÃ¹ng thá»© tá»± hoÃ n toÃ n, nhÆ°ng tÃ¬m kiáº¿m gáº§n Ä‘Ãºng cho phÃ©p chá»‰ Ä‘á»‹nh cÃ¡c tá»« cá»¥ thá»ƒ Ä‘Æ°á»£c tÃ¡ch ra hoáº·c sáº¯p xáº¿p theo thá»© tá»± khÃ¡c nhau. Giá»‘ng nhÆ° truy váº¥n má» cÃ³ thá»ƒ chá»‰ Ä‘á»‹nh khoáº£ng cÃ¡ch chá»‰nh sá»­a tá»‘i Ä‘a cho cÃ¡c kÃ½ tá»± trong tá»«, tÃ¬m kiáº¿m gáº§n Ä‘Ãºng cÅ©ng cho phÃ©p chÃºng ta chá»‰ Ä‘á»‹nh khoáº£ng cÃ¡ch chá»‰nh sá»­a tá»‘i Ä‘a cho cÃ¡c tá»« trong cá»¥m tá»«:</p>
<p>VÃ­ dá»¥:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>"fox quick"~5</span></span></code></pre>
</div><p>CÃ ng gáº§n vÄƒn báº£n trong trÆ°á»ng vá»›i thá»© tá»± ban Ä‘áº§u Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh trong chuá»—i truy váº¥n, tÃ i liá»‡u Ä‘Ã³ cÃ ng Ä‘Æ°á»£c coi lÃ  liÃªn quan. So vá»›i truy váº¥n vÃ­ dá»¥ trÃªn, cá»¥m tá»« <code>"quick fox"</code> sáº½ Ä‘Æ°á»£c coi lÃ  gáº§n giá»‘ng Ä‘iá»u kiá»‡n truy váº¥n hÆ¡n <code>"quick brown fox"</code>.</p>
<h4>2.1.6. Pháº¡m vi</h4>
<p>ChÃºng ta cÃ³ thá»ƒ chá»‰ Ä‘á»‹nh pháº¡m vi cho cÃ¡c trÆ°á»ng ngÃ y thÃ¡ng, sá»‘ hoáº·c chuá»—i. Pháº¡m vi Ä‘Ã³ng cá»­a Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh báº±ng cáº·p dáº¥u ngoáº·c vuÃ´ng <code>[min TO max]</code> vÃ  pháº¡m vi má»Ÿ Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh báº±ng cáº·p dáº¥u ngoáº·c nhá»n <code>{min TO max}</code>.</p>
<p>HÃ£y xem má»™t sá»‘ vÃ­ dá»¥.</p>
<ul>
<li>Táº¥t cáº£ cÃ¡c ngÃ y trong nÄƒm 2012</li>
</ul>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>date:[2012-01-01 TO 2012-12-31]</span></span></code></pre>
</div><ul>
<li>Sá»‘ tá»« 1 Ä‘áº¿n 5</li>
</ul>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>count:[1 TO 5]</span></span></code></pre>
</div><ul>
<li>CÃ¡c nhÃ£n náº±m giá»¯a <code>alpha</code> vÃ  <code>omega</code>, khÃ´ng bao gá»“m <code>alpha</code> vÃ  <code>omega</code></li>
</ul>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>tag:{alpha TO omega}</span></span></code></pre>
</div><ul>
<li>Sá»‘ lá»›n hÆ¡n hoáº·c báº±ng 10</li>
</ul>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>count:[10 TO *]</span></span></code></pre>
</div><ul>
<li>Táº¥t cáº£ cÃ¡c ngÃ y trÆ°á»›c nÄƒm 2012</li>
</ul>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>date:{* TO 2012-01-01}</span></span></code></pre>
</div><p>NgoÃ i ra, pháº¡m vi má»Ÿ vÃ  Ä‘Ã³ng cÅ©ng cÃ³ thá»ƒ Ä‘Æ°á»£c káº¿t há»£p sá»­ dá»¥ng</p>
<ul>
<li>Máº£ng tá»« 1 Ä‘áº¿n 5, nhÆ°ng khÃ´ng bao gá»“m sá»‘ 5</li>
</ul>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>count:[1 TO 5}</span></span></code></pre>
</div><p>Pháº¡m vi khÃ´ng bá»‹ rÃ ng buá»™c á»Ÿ má»™t bÃªn cÅ©ng cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng vá»›i cÃº phÃ¡p sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>age:&gt;10</span></span>
<span class="line"><span>age:&gt;=10</span></span>
<span class="line"><span>age:&lt;10</span></span>
<span class="line"><span>age:&lt;=10</span></span></code></pre>
</div><p>Táº¥t nhiÃªn, báº¡n cÅ©ng cÃ³ thá»ƒ sá»­ dá»¥ng toÃ¡n tá»­ AND Ä‘á»ƒ láº¥y giao cá»§a hai káº¿t quáº£ truy váº¥n:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>age:(&gt;=10 AND &lt;20)</span></span>
<span class="line"><span>age:(+&gt;=10 +&lt;20)</span></span></code></pre>
</div><h4>2.1.7. Boosting</h4>
<p>Sá»­ dá»¥ng toÃ¡n tá»­ <code>^</code> Ä‘á»ƒ lÃ m cho má»™t thuáº­t ngá»¯ quan trá»ng hÆ¡n má»™t thuáº­t ngá»¯ khÃ¡c. VÃ­ dá»¥, náº¿u chÃºng ta muá»‘n tÃ¬m kiáº¿m táº¥t cáº£ cÃ¡c tÃ i liá»‡u liÃªn quan Ä‘áº¿n con cÃ¡o, nhÆ°ng chÃºng ta Ä‘áº·c biá»‡t quan tÃ¢m Ä‘áº¿n con cÃ¡o:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>quick^2 fox</span></span></code></pre>
</div><p>GiÃ¡ trá»‹ tÄƒng cÆ°á»ng máº·c Ä‘á»‹nh lÃ  1, nhÆ°ng nÃ³ cÃ³ thá»ƒ lÃ  báº¥t ká»³ sá»‘ thá»±c dÆ°Æ¡ng nÃ o. GiÃ¡ trá»‹ tÄƒng cÆ°á»ng tá»« 0 Ä‘áº¿n 1 giáº£m tÃ­nh liÃªn quan.</p>
<p>TÄƒng cÆ°á»ng cÅ©ng cÃ³ thá»ƒ Ä‘Æ°á»£c Ã¡p dá»¥ng cho cá»¥m tá»« hoáº·c nhÃ³m:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>"john smith"^2   (foo bar)^4</span></span></code></pre>
</div><h4>2.1.8. PhÃ©p toÃ¡n Boolean</h4>
<p>Máº·c Ä‘á»‹nh, chá»‰ cáº§n má»™t tá»« khá»›p, táº¥t cáº£ cÃ¡c tá»« Ä‘á»u lÃ  tÃ¹y chá»n. TÃ¬m kiáº¿m <code>foo bar baz</code> sáº½ tÃ¬m kiáº¿m báº¥t ká»³ tÃ i liá»‡u nÃ o chá»©a má»™t hoáº·c nhiá»u tá»« trong <code>foo</code>, <code>bar</code> hoáº·c <code>baz</code>. ChÃºng ta Ä‘Ã£ tháº£o luáº­n vá» <code>default_operator</code> á»Ÿ trÃªn, cho phÃ©p báº¡n yÃªu cáº§u táº¥t cáº£ cÃ¡c má»¥c, nhÆ°ng cÅ©ng cÃ³ cÃ¡c toÃ¡n tá»­ Boolean cÃ³ thá»ƒ sá»­ dá»¥ng trong chuá»—i truy váº¥n Ä‘á»ƒ cung cáº¥p sá»± kiá»ƒm soÃ¡t nhiá»u hÆ¡n.</p>
<p>CÃ¡c toÃ¡n tá»­ Ä‘Æ°á»£c Æ°u tiÃªn sá»­ dá»¥ng lÃ  <code>+</code> (thuáº­t ngá»¯ nÃ y pháº£i tá»“n táº¡i) vÃ  <code>-</code> (thuáº­t ngá»¯ nÃ y khÃ´ng Ä‘Æ°á»£c tá»“n táº¡i). Táº¥t cáº£ cÃ¡c thuáº­t ngá»¯ khÃ¡c lÃ  tÃ¹y chá»n. VÃ­ dá»¥, truy váº¥n nÃ y:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>quick brown +fox -news</span></span></code></pre>
</div><p>Truy váº¥n nÃ y cÃ³ nghÄ©a lÃ :</p>
<ul>
<li><code>fox</code> pháº£i tá»“n táº¡i</li>
<li><code>news</code> khÃ´ng Ä‘Æ°á»£c tá»“n táº¡i</li>
<li><code>quick</code> vÃ  <code>brown</code> lÃ  tÃ¹y chá»n</li>
</ul>
<p>CÃ¡c toÃ¡n tá»­ quen thuá»™c <code>AND</code>, <code>OR</code> vÃ  <code>NOT</code> (cÅ©ng cÃ³ thá»ƒ Ä‘Æ°á»£c viáº¿t lÃ  <code>&amp;&amp;</code>, <code>||</code> vÃ  <code>!</code>) cÅ©ng Ä‘Æ°á»£c há»— trá»£. Tuy nhiÃªn, cÃ¡c toÃ¡n tá»­ nÃ y cÃ³ má»©c Ä‘á»™ Æ°u tiÃªn nháº¥t Ä‘á»‹nh: <code>NOT</code> Æ°u tiÃªn hÆ¡n <code>AND</code>, <code>AND</code> Æ°u tiÃªn hÆ¡n <code>OR</code>. Máº·c dÃ¹ <code>+</code> vÃ  <code>-</code> chá»‰ áº£nh hÆ°á»Ÿng Ä‘áº¿n thuáº­t ngá»¯ bÃªn pháº£i cá»§a toÃ¡n tá»­, nhÆ°ng <code>AND</code> vÃ  <code>OR</code> áº£nh hÆ°á»Ÿng Ä‘áº¿n cáº£ thuáº­t ngá»¯ bÃªn trÃ¡i vÃ  bÃªn pháº£i.</p>
<h4>2.1.9. NhÃ³m</h4>
<p>Nhiá»u thuáº­t ngá»¯ hoáº·c má»‡nh Ä‘á» cÃ³ thá»ƒ Ä‘Æ°á»£c káº¿t há»£p trong cáº·p dáº¥u ngoáº·c trÃ²n Ä‘á»ƒ táº¡o thÃ nh má»™t truy váº¥n con:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>(quick OR brown) AND fox</span></span></code></pre>
</div><p>CÃ³ thá»ƒ sá»­ dá»¥ng nhÃ³m Ä‘á»ƒ xÃ¡c Ä‘á»‹nh trÆ°á»ng cá»¥ thá»ƒ hoáº·c cáº£i thiá»‡n káº¿t quáº£ cá»§a truy váº¥n con:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>status:(active OR pending) title:(full text search)^2</span></span></code></pre>
</div><h4>2.1.10. Tá»« khÃ³a Ä‘áº·c biá»‡t</h4>
<p>Náº¿u báº¡n cáº§n sá»­ dá»¥ng báº¥t ká»³ kÃ½ tá»± nÃ o trong truy váº¥n cá»§a mÃ¬nh lÃ  má»™t toÃ¡n tá»­ (thay vÃ¬ má»™t toÃ¡n tá»­), báº¡n nÃªn sá»­ dá»¥ng dáº¥u gáº¡ch chÃ©o ngÆ°á»£c Ä‘á»ƒ trÃ¡nh chÃºng. VÃ­ dá»¥, Ä‘á»ƒ tÃ¬m kiáº¿m (1 + 1) = 2, báº¡n cáº§n viáº¿t truy váº¥n lÃ  <code>\(1\+1\)\=2</code></p>
<p>CÃ¡c kÃ½ tá»± Ä‘áº·c biá»‡t lÃ : <code>+ - = &amp;&amp; || &gt; &lt; ! ( ) { } [ ] ^ " ~ * ? : \ /</code></p>
<p>KhÃ´ng thá»ƒ thoÃ¡t cÃ¡c kÃ½ tá»± Ä‘áº·c biá»‡t nÃ y má»™t cÃ¡ch chÃ­nh xÃ¡c cÃ³ thá»ƒ dáº«n Ä‘áº¿n lá»—i cÃº phÃ¡p vÃ  ngÄƒn truy váº¥n cá»§a báº¡n hoáº¡t Ä‘á»™ng.</p>
<h4>2.1.11. Truy váº¥n trá»‘ng</h4>
<p>Náº¿u chuá»—i truy váº¥n lÃ  trá»‘ng hoáº·c chá»‰ chá»©a khoáº£ng tráº¯ng, truy váº¥n sáº½ táº¡o ra má»™t táº­p káº¿t quáº£ trá»‘ng.</p>
<h3>2.2. Trá»±c quan hÃ³a</h3>
<p>Äá»ƒ hiá»ƒn thá»‹ dá»¯ liá»‡u cá»§a báº¡n dÆ°á»›i dáº¡ng trá»±c quan, hÃ£y nháº¥p vÃ o <code>Visualize</code> trong thanh Ä‘iá»u hÆ°á»›ng bÃªn.</p>
<p>CÃ´ng cá»¥ Visualize cho phÃ©p báº¡n xem dá»¯ liá»‡u theo nhiá»u cÃ¡ch khÃ¡c nhau, cháº³ng háº¡n nhÆ° biá»ƒu Ä‘á»“ trÃ²n, biá»ƒu Ä‘á»“ cá»™t, biá»ƒu Ä‘á»“ Ä‘Æ°á»ng, biá»ƒu Ä‘á»“ phÃ¢n phá»‘i, v.v. Äá»ƒ báº¯t Ä‘áº§u, hÃ£y nháº¥p vÃ o <code>Create a visualization</code> hoáº·c nÃºt <code>+</code> mÃ u xanh lÃ¡ cÃ¢y.</p>
<figure><img src="https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-landing.png" alt="https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-landing.png" tabindex="0" loading="lazy"><figcaption><a href="https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-landing.png" target="_blank" rel="noopener noreferrer">https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-landing.png</a></figcaption></figure>
<p>CÃ³ nhiá»u loáº¡i trá»±c quan hÃ³a Ä‘á»ƒ lá»±a chá»n.</p>
<figure><img src="https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-wizard-step-1.png" alt="https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-wizard-step-1.png" tabindex="0" loading="lazy"><figcaption><a href="https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-wizard-step-1.png" target="_blank" rel="noopener noreferrer">https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-wizard-step-1.png</a></figcaption></figure>
<p>DÆ°á»›i Ä‘Ã¢y, chÃºng ta sáº½ táº¡o má»™t sá»‘ vÃ­ dá»¥ biá»ƒu Ä‘á»“:</p>
<h4>2.2.1. Pie</h4>
<p>Báº¡n cÃ³ thá»ƒ xÃ¢y dá»±ng má»™t trá»±c quan hÃ³a tá»« tÃ¬m kiáº¿m Ä‘Ã£ lÆ°u hoáº·c nháº­p Ä‘iá»u kiá»‡n tÃ¬m kiáº¿m má»›i. Äá»ƒ nháº­p Ä‘iá»u kiá»‡n tÃ¬m kiáº¿m má»›i, trÆ°á»›c tiÃªn báº¡n cáº§n chá»n má»™t máº«u chá»‰ má»¥c Ä‘á»ƒ xÃ¡c Ä‘á»‹nh chá»‰ má»¥c báº¡n muá»‘n tÃ¬m kiáº¿m.</p>
<p>Máº·c Ä‘á»‹nh, tÃ¬m kiáº¿m khá»›p vá»›i táº¥t cáº£ cÃ¡c tÃ i liá»‡u. Ban Ä‘áº§u, má»™t "miáº¿ng" chá»©a toÃ n bá»™ biá»ƒu Ä‘á»“ trÃ²n:</p>
<figure><img src="https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-pie-1.png" alt="https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-pie-1.png" tabindex="0" loading="lazy"><figcaption><a href="https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-pie-1.png" target="_blank" rel="noopener noreferrer">https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-pie-1.png</a></figcaption></figure>
<p>Äá»ƒ chá»‰ Ä‘á»‹nh dá»¯ liá»‡u nÃ o hiá»ƒn thá»‹ trong biá»ƒu Ä‘á»“, hÃ£y sá»­ dá»¥ng bucket aggregation cá»§a Elasticsearch. Grouping aggregation chá»‰ lÃ  viá»‡c phÃ¢n loáº¡i tÃ i liá»‡u khá»›p vá»›i Ä‘iá»u kiá»‡n tÃ¬m kiáº¿m cá»§a báº¡n thÃ nh cÃ¡c danh má»¥c khÃ¡c nhau, cÃ²n Ä‘Æ°á»£c gá»i lÃ  bucket.</p>
<p>Äá»‹nh nghÄ©a má»™t bucket cho má»—i pháº¡m vi:</p>
<ol>
<li>Nháº¥p vÃ o <code>Split Slices</code>.</li>
<li>Chá»n <code>Terms</code> trong danh sÃ¡ch <code>Aggregation</code>. <em>LÆ°u Ã½: CÃ¡c thuáº­t ngá»¯ á»Ÿ Ä‘Ã¢y lÃ  cÃ¡c trÆ°á»ng hoáº·c nhÃ£n Ä‘Ã£ Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh khi thu tháº­p dá»¯ liá»‡u Elk</em>.</li>
<li>Chá»n <code>level.keyword</code> trong danh sÃ¡ch <code>Field</code>.</li>
<li>Nháº¥p vÃ o <img src="https://www.elastic.co/guide/en/kibana/6.1/images/apply-changes-button.png" alt="images/apply-changes-button.png" loading="lazy"> Ä‘á»ƒ cáº­p nháº­t biá»ƒu Ä‘á»“.</li>
</ol>
<figure><img src="https://upload-images.jianshu.io/upload_images/3101171-7fb2042dc6d59520.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure>
<p>Sau khi hoÃ n thÃ nh, náº¿u báº¡n muá»‘n lÆ°u biá»ƒu Ä‘á»“ nÃ y, báº¡n cÃ³ thá»ƒ nháº¥p vÃ o nÃºt <code>Save</code> á»Ÿ phÃ­a trÃªn trang.</p>
<h4>2.2.2. Vertical Bar</h4>
<p>ChÃºng ta sáº½ xem cÃ¡ch táº¡o biá»ƒu Ä‘á»“ cá»™t dá»c.</p>
<ol>
<li>Nháº¥p vÃ o <code>Create a visualization</code> hoáº·c nÃºt <code>+</code> mÃ u xanh lÃ¡ cÃ¢y. Chá»n <code>Vertical Bar</code>.</li>
<li>Chá»n máº«u chá»‰ má»¥c. VÃ¬ báº¡n chÆ°a xÃ¡c Ä‘á»‹nh báº¥t ká»³ bucket nÃ o, báº¡n sáº½ tháº¥y má»™t thanh lá»›n hiá»ƒn thá»‹ tá»•ng sá»‘ tÃ i liá»‡u khá»›p vá»›i truy váº¥n máº·c Ä‘á»‹nh.</li>
<li>Chá»‰ Ä‘á»‹nh trÆ°á»ng Ä‘áº¡i diá»‡n cho trá»¥c Y.</li>
<li>Chá»‰ Ä‘á»‹nh trÆ°á»ng Ä‘áº¡i diá»‡n cho trá»¥c X.</li>
<li>Nháº¥p vÃ o <img src="https://www.elastic.co/guide/en/kibana/6.1/images/apply-changes-button.png" alt="images/apply-changes-button.png" loading="lazy"> Ä‘á»ƒ cáº­p nháº­t biá»ƒu Ä‘á»“.</li>
</ol>
<figure><img src="https://upload-images.jianshu.io/upload_images/3101171-5aa7627284c19a56.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure>
<p>Sau khi hoÃ n thÃ nh, náº¿u báº¡n muá»‘n lÆ°u biá»ƒu Ä‘á»“ nÃ y, báº¡n cÃ³ thá»ƒ nháº¥p vÃ o nÃºt <code>Save</code> á»Ÿ phÃ­a trÃªn trang.</p>
<h3>2.3. BÃ¡o cÃ¡o</h3>
<p><code>BÃ¡o cÃ¡o (Dashboard)</code> cho phÃ©p tá»•ng há»£p vÃ  chia sáº» táº­p há»£p <code>Visualize</code>.</p>
<ol>
<li>Nháº¥p vÃ o <code>Dashboard</code> trong thanh Ä‘iá»u hÆ°á»›ng bÃªn.</li>
<li>Nháº¥p vÃ o <code>ThÃªm hiá»ƒn thá»‹ tá»« danh sÃ¡ch Visualize Ä‘Ã£ lÆ°u</code>.</li>
<li>Nháº¥p vÃ o <code>Visualize</code> Ä‘Ã£ lÆ°u trÆ°á»›c Ä‘Ã³, sau Ä‘Ã³ nháº¥p vÃ o mÅ©i tÃªn nhá» á»Ÿ cuá»‘i danh sÃ¡ch Ä‘á»ƒ Ä‘Ã³ng danh sÃ¡ch Visualize.</li>
<li>Khi di chuá»™t qua Ä‘á»‘i tÆ°á»£ng Visualize, cÃ¡c Ä‘iá»u khiá»ƒn container sáº½ hiá»ƒn thá»‹ cho phÃ©p báº¡n chá»‰nh sá»­a, di chuyá»ƒn, xÃ³a vÃ  Ä‘iá»u chá»‰nh kÃ­ch thÆ°á»›c Ä‘á»‘i tÆ°á»£ng Visualize.</li>
</ol>
<h2>3. FAQ</h2>
<h3>3.1. Cáº£nh bÃ¡o Kibana No Default Index Pattern</h3>
<p><strong>CÃ¢u há»i:</strong> Sau khi cÃ i Ä‘áº·t ELK, khi truy cáº­p trang Kibana, tÃ´i nháº­n Ä‘Æ°á»£c cáº£nh bÃ¡o lá»—i sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>Warning No default index pattern. You must select or create one to continue.</span></span>
<span class="line"><span>...</span></span>
<span class="line"><span>Unable to fetch mapping. Do you have indices matching the pattern?</span></span></code></pre>
</div><p>Äiá»u nÃ y cho tháº¥y logstash khÃ´ng ghi nháº­t kÃ½ vÃ o elasticsearch.</p>
<p><strong>Giáº£i phÃ¡p:</strong></p>
<p>Kiá»ƒm tra xem cÃ³ váº¥n Ä‘á» gÃ¬ vá» giao tiáº¿p giá»¯a logstash vÃ  elasticsearch, thÆ°á»ng lÃ  váº¥n Ä‘á» náº±m á»Ÿ Ä‘Ã¢y.</p>
<h2>4. TÃ i liá»‡u tham kháº£o</h2>
<ul>
<li><a href="https://www.elastic.co/cn/products/kibana" target="_blank" rel="noopener noreferrer">Trang web chÃ­nh thá»©c cá»§a Kibana</a></li>
<li><a href="https://github.com/elastic/kibana" target="_blank" rel="noopener noreferrer">Kibana Github</a></li>
<li><a href="https://www.elastic.co/guide/en/kibana/current/index.html" target="_blank" rel="noopener noreferrer">TÃ i liá»‡u chÃ­nh thá»©c cá»§a Kibana</a></li>
</ul>
]]></content:encoded>
      <enclosure url="https://www.elastic.co/guide/en/kibana/current/images/tutorial-discover.png" type="image/png"/>
    </item>
    <item>
      <title>Logstash Operation</title>
      <link>https://vanhung4499.github.io/database/elastic/logstash-operation.html</link>
      <guid>https://vanhung4499.github.io/database/elastic/logstash-operation.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Logstash Operation</source>
      <description>DÆ°á»›i Ä‘Ã¢y lÃ  báº£n dá»‹ch sang tiáº¿ng Viá»‡t cá»§a Ä‘oáº¡n vÄƒn báº¡n yÃªu cáº§u: Váº­n hÃ nh Logstash Logstash lÃ  má»™t pipeline xá»­ lÃ½ dá»¯ liá»‡u phÃ­a mÃ¡y chá»§ mÃ£ nguá»“n má»Ÿ, cÃ³ kháº£ nÄƒng thu tháº­p dá»¯ liá»‡u tá»«...</description>
      <category>elastic</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[<p>DÆ°á»›i Ä‘Ã¢y lÃ  báº£n dá»‹ch sang tiáº¿ng Viá»‡t cá»§a Ä‘oáº¡n vÄƒn báº¡n yÃªu cáº§u:</p>
<h1>Váº­n hÃ nh Logstash</h1>
<blockquote>
<p><a href="https://github.com/elastic/logstash" target="_blank" rel="noopener noreferrer">Logstash</a> lÃ  má»™t pipeline xá»­ lÃ½ dá»¯ liá»‡u phÃ­a mÃ¡y chá»§ mÃ£ nguá»“n má»Ÿ, cÃ³ kháº£ nÄƒng thu tháº­p dá»¯ liá»‡u tá»« nhiá»u nguá»“n, chuyá»ƒn Ä‘á»•i dá»¯ liá»‡u vÃ  sau Ä‘Ã³ gá»­i dá»¯ liá»‡u Ä‘áº¿n "kho lÆ°u trá»¯" yÃªu thÃ­ch cá»§a báº¡n.</p>
</blockquote>
<h2>1. CÃ i Ä‘áº·t</h2>
<h3>1.1. CÃ¡c bÆ°á»›c cÃ i Ä‘áº·t</h3>
<p>CÃ¡c bÆ°á»›c cÃ i Ä‘áº·t nhÆ° sau:</p>
<p>(1) Táº£i xuá»‘ng gÃ³i phiÃªn báº£n mong muá»‘n tá»« <a href="https://www.elastic.co/downloads/logstash" target="_blank" rel="noopener noreferrer">Ä‘á»‹a chá»‰ táº£i xuá»‘ng chÃ­nh thá»©c cá»§a logstash</a> vÃ  giáº£i nÃ©n nÃ³ vÃ o mÃ¡y cá»¥c bá»™.</p>
<p>(2) ThÃªm tá»‡p <code>logstash.conf</code>, chá»‰ Ä‘á»‹nh cÃ¡c plugin báº¡n muá»‘n sá»­ dá»¥ng vÃ  cáº¥u hÃ¬nh cho má»—i plugin. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ Ä‘Æ¡n giáº£n:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>input { stdin { } }</span></span>
<span class="line"><span>output {</span></span>
<span class="line"><span>  elasticsearch { hosts =&gt; ["localhost:9200"] }</span></span>
<span class="line"><span>  stdout { codec =&gt; rubydebug }</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><p>(3) Cháº¡y lá»‡nh <code>bin/logstash -f logstash.conf</code> (trÃªn Windows, cháº¡y <code>bin/logstash.bat -f logstash.conf</code>)</p>
<h2>2. Cáº¥u hÃ¬nh</h2>
<h3>2.1. Tá»‡p cáº¥u hÃ¬nh</h3>
<ul>
<li><strong><code>logstash.yml</code></strong>: Tá»‡p cáº¥u hÃ¬nh khá»Ÿi Ä‘á»™ng máº·c Ä‘á»‹nh cá»§a logstash.</li>
<li><strong><code>jvm.options</code></strong>: Tá»‡p cáº¥u hÃ¬nh JVM cá»§a logstash.</li>
<li><strong><code>startup.options</code></strong> (Linux): Chá»©a cÃ¡c tÃ¹y chá»n Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi táº­p lá»‡nh cÃ i Ä‘áº·t há»‡ thá»‘ng trong <code>/usr/share/logstash/bin</code> Ä‘á»ƒ xÃ¢y dá»±ng cÃ¡c táº­p lá»‡nh khá»Ÿi Ä‘á»™ng phÃ¹ há»£p cho há»‡ thá»‘ng cá»§a báº¡n. Khi cÃ i Ä‘áº·t gÃ³i logstash, táº­p lá»‡nh cÃ i Ä‘áº·t há»‡ thá»‘ng sáº½ Ä‘Æ°á»£c thá»±c thi khi quÃ¡ trÃ¬nh cÃ i Ä‘áº·t káº¿t thÃºc vÃ  sá»­ dá»¥ng cÃ¡c cÃ i Ä‘áº·t Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh trong <code>startup.options</code> Ä‘á»ƒ Ä‘áº·t ngÆ°á»i dÃ¹ng, nhÃ³m, tÃªn dá»‹ch vá»¥ vÃ  mÃ´ táº£ dá»‹ch vá»¥.</li>
</ul>
<h3>2.2. CÃ¡c má»¥c cáº¥u hÃ¬nh trong logstash.yml</h3>
<p>DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ má»¥c cáº¥u hÃ¬nh Ä‘Æ°á»£c trÃ­ch dáº«n, vui lÃ²ng xem thÃªm táº¡i: <a href="https://www.elastic.co/guide/en/logstash/current/logstash-settings-file.html" target="_blank" rel="noopener noreferrer">https://www.elastic.co/guide/en/logstash/current/logstash-settings-file.html</a></p>
<p>| Tham sá»‘                    | MÃ´ táº£                                                                                                                                                                                                                                                                                                                                                            | GiÃ¡ trá»‹ máº·c Ä‘á»‹nh                                                                                                                         |<br>
|</p>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/3101171-cd876d79a14955b0.png" type="image/png"/>
    </item>
    <item>
      <title>Logstash</title>
      <link>https://vanhung4499.github.io/database/elastic/logstash.html</link>
      <guid>https://vanhung4499.github.io/database/elastic/logstash.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Logstash</source>
      <description>Elastic Stack: Logstash BÃ i viáº¿t nÃ y táº­p trung vÃ o Logstash, má»™t thÃ nh pháº§n cá»§a Elastic Technology Stack (ELK). Náº¿u báº¡n khÃ´ng quen vá»›i cÃ¡ch cÃ i Ä‘áº·t, cáº¥u hÃ¬nh vÃ  triá»ƒn khai Elast...</description>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>BÃ i viáº¿t nÃ y táº­p trung vÃ o Logstash, má»™t thÃ nh pháº§n cá»§a Elastic Technology Stack (ELK).</p>
<p>Náº¿u báº¡n khÃ´ng quen vá»›i cÃ¡ch cÃ i Ä‘áº·t, cáº¥u hÃ¬nh vÃ  triá»ƒn khai Elastic, báº¡n cÃ³ thá»ƒ tham kháº£o hÆ°á»›ng dáº«n: [[Elastic Quick Start|Báº¯t Ä‘áº§u nhanh vá»›i Elastic Technology Stack]])</p>
</blockquote>
<h2>Giá»›i thiá»‡u</h2>
<p>Logstash Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ váº­n chuyá»ƒn vÃ  xá»­ lÃ½ cÃ¡c logs, giao dá»‹ch hoáº·c dá»¯ liá»‡u khÃ¡c cá»§a báº¡n.</p>
<h3>TÃ­nh nÄƒng</h3>
<p>Logstash lÃ  á»‘ng dáº«n dá»¯ liá»‡u tá»‘t nháº¥t cho Elasticsearch.</p>
<p>Logstash tuÃ¢n theo kiáº¿n trÃºc dá»±a trÃªn plugin, cho phÃ©p tÃ¹y chá»‰nh thÃ´ng qua cÃ¡c plugin á»Ÿ cÃ¡c giai Ä‘oáº¡n input, filter, output vÃ  codec. Cá»™ng Ä‘á»“ng Logstash cung cáº¥p hÆ¡n 200 plugin cÃ³ sáºµn.</p>
<h3>CÃ¡ch hoáº¡t Ä‘á»™ng</h3>
<p>Logstash bao gá»“m ba yáº¿u tá»‘ cÆ¡ báº£n: <code>input</code>, <code>filter</code> vÃ  <code>output</code>. CÃ³ má»™t yáº¿u tá»‘ tÃ¹y chá»n lÃ  <code>codec</code>.</p>
<p>Ba yáº¿u tá»‘ nÃ y Ä‘áº¡i diá»‡n cho ba giai Ä‘oáº¡n xá»­ lÃ½ sá»± kiá»‡n cá»§a Logstash: input &gt; filter &gt; output.</p>
<figure><img src="https://www.elastic.co/guide/en/logstash/current/static/images/basic_logstash_pipeline.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>
<ul>
<li><code>input</code> cÃ³ trÃ¡ch nhiá»‡m thu tháº­p dá»¯ liá»‡u tá»« nguá»“n dá»¯ liá»‡u.</li>
<li><code>filter</code> sá»­a Ä‘á»•i dá»¯ liá»‡u thÃ nh Ä‘á»‹nh dáº¡ng hoáº·c ná»™i dung Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh.</li>
<li><code>output</code> chuyá»ƒn dá»¯ liá»‡u Ä‘áº¿n Ä‘Ã­ch cá»§a nÃ³.</li>
</ul>
<p>Trong cÃ¡c ká»‹ch báº£n thá»±c táº¿, thÆ°á»ng cÃ³ nhiá»u input, output vÃ  filter. Logstash cho phÃ©p ngÆ°á»i dÃ¹ng chá»n vÃ  káº¿t há»£p cÃ¡c plugin cho má»—i giai Ä‘oáº¡n dá»±a trÃªn nhu cáº§u á»©ng dá»¥ng cá»§a há».</p>
<p>Chi tiáº¿t vá» cÃ¡c plugin sáº½ Ä‘Æ°á»£c tháº£o luáº­n sau.</p>
<h2>Cáº¥u hÃ¬nh</h2>
<h3>Tá»‡p cáº¥u hÃ¬nh</h3>
<ul>
<li><strong><code>logstash.yml</code></strong>: Tá»‡p cáº¥u hÃ¬nh khá»Ÿi Ä‘á»™ng máº·c Ä‘á»‹nh cho Logstash.</li>
<li><strong><code>jvm.options</code></strong>: Tá»‡p cáº¥u hÃ¬nh JVM cho Logstash.</li>
<li><strong><code>startup.options</code></strong> (Linux): Chá»©a cÃ¡c tÃ¹y chá»n Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi táº­p lá»‡nh cÃ i Ä‘áº·t há»‡ thá»‘ng trong <code>/usr/share/logstash/bin</code> Ä‘á»ƒ xÃ¢y dá»±ng cÃ¡c táº­p lá»‡nh khá»Ÿi Ä‘á»™ng phÃ¹ há»£p cho há»‡ thá»‘ng cá»§a báº¡n. Táº­p lá»‡nh cÃ i Ä‘áº·t há»‡ thá»‘ng Ä‘Æ°á»£c thá»±c thi trong quÃ¡ trÃ¬nh cÃ i Ä‘áº·t vÃ  Ä‘áº·t cÃ¡c tÃ¹y chá»n nhÆ° ngÆ°á»i dÃ¹ng, nhÃ³m, tÃªn dá»‹ch vá»¥ vÃ  mÃ´ táº£ dá»‹ch vá»¥ dá»±a trÃªn cÃ¡c thiáº¿t láº­p Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh trong <code>startup.options</code>.</li>
</ul>
<h3>CÃ i Ä‘áº·t logstash.yml</h3>
<p>DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ cÃ i Ä‘áº·t Ä‘Æ°á»£c chá»n lá»c. Äá»ƒ biáº¿t thÃªm tÃ¹y chá»n, vui lÃ²ng tham kháº£o: <a href="https://www.elastic.co/guide/en/logstash/current/logstash-settings-file.html" target="_blank" rel="noopener noreferrer">https://www.elastic.co/guide/en/logstash/current/logstash-settings-file.html</a></p>
<p>| Tham sá»‘                    | MÃ´ táº£                                                                                                                                                                                                                                                                                                                                                         | GiÃ¡ trá»‹ máº·c Ä‘á»‹nh                                                                                                                            |<br>
|</p>
]]></content:encoded>
      <enclosure url="https://www.elastic.co/guide/en/logstash/current/static/images/basic_logstash_pipeline.png" type="image/png"/>
    </item>
    <item>
      <title>Elastic Overview</title>
      <link>https://vanhung4499.github.io/database/elastic/overview.html</link>
      <guid>https://vanhung4499.github.io/database/elastic/overview.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Elastic Overview</source>
      <description>Elastic Stack Overview Elastic Stack thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng lÃ m giáº£i phÃ¡p cho viá»‡c thu tháº­p, truy xuáº¥t vÃ  trá»±c quan hÃ³a nháº­t kÃ½ (log). ELK lÃ  viáº¿t táº¯t cá»§a ba sáº£n pháº©m thuá»™c cÃ´ng ty...</description>
      <category>elastic</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p><strong>Elastic Stack thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng lÃ m giáº£i phÃ¡p cho viá»‡c thu tháº­p, truy xuáº¥t vÃ  trá»±c quan hÃ³a nháº­t kÃ½ (log).</strong></p>
<p>ELK lÃ  viáº¿t táº¯t cá»§a ba sáº£n pháº©m thuá»™c cÃ´ng ty Elastic:&nbsp;<a href="https://www.elastic.co/products/elasticsearch" target="_blank" rel="noopener noreferrer">Elasticsearch</a>,&nbsp;<a href="https://www.elastic.co/products/logstash" target="_blank" rel="noopener noreferrer">Logstash</a>&nbsp;vÃ &nbsp;<a href="https://www.elastic.co/products/kibana" target="_blank" rel="noopener noreferrer">Kibana</a>.</p>
<p><a href="https://www.elastic.co/products/logstash" target="_blank" rel="noopener noreferrer">Logstash</a>&nbsp;Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ truyá»n vÃ  xá»­ lÃ½ nháº­t kÃ½, giao dá»‹ch hoáº·c dá»¯ liá»‡u khÃ¡c.</p>
<p><a href="https://www.elastic.co/products/kibana" target="_blank" rel="noopener noreferrer">Kibana</a>&nbsp;Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ phÃ¢n tÃ­ch dá»¯ liá»‡u tá»« Elasticsearch vÃ  hiá»ƒn thá»‹ chÃºng dÆ°á»›i dáº¡ng bÃ¡o cÃ¡o trá»±c quan.</p>
<p>Elastic Stack Ä‘Ã£ má»Ÿ rá»™ng thÃªm má»™t sá»‘ sáº£n pháº©m má»›i trÃªn cÆ¡ sá»Ÿ cá»§a ELK, cháº³ng háº¡n nhÆ°:&nbsp;<a href="https://www.elastic.co/products/beats" target="_blank" rel="noopener noreferrer">Beats</a>&nbsp;vÃ &nbsp;<a href="https://www.elastic.co/products/x-pack" target="_blank" rel="noopener noreferrer">X-Pack</a>.</p>
</blockquote>
<h2>ğŸ“– Contents</h2>
]]></content:encoded>
    </item>
    <item>
      <title>Elastic Quick Start</title>
      <link>https://vanhung4499.github.io/database/elastic/quick-start.html</link>
      <guid>https://vanhung4499.github.io/database/elastic/quick-start.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Elastic Quick Start</source>
      <description>1. HÆ°á»›ng dáº«n nhanh vá» Elastic Giáº¥y phÃ©p mÃ£ nguá»“n má»Ÿ: Apache 2.0 1. Giá»›i thiá»‡u 1.1. Elastic Stack lÃ  gÃ¬ Elastic Stack cÃ²n Ä‘Æ°á»£c gá»i lÃ  ELK Stack. ELK lÃ  viáº¿t táº¯t cá»§a ba sáº£n pháº©m c...</description>
      <category>elastic</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[<h2>1. HÆ°á»›ng dáº«n nhanh vá» Elastic</h2>
<blockquote>
<p>Giáº¥y phÃ©p mÃ£ nguá»“n má»Ÿ: <a href="https://github.com/elastic/elasticsearch/tree/7.4/licenses/APACHE-LICENSE-2.0.txt" target="_blank" rel="noopener noreferrer">Apache 2.0</a></p>
</blockquote>
<h2>1. Giá»›i thiá»‡u</h2>
<h3>1.1. Elastic Stack lÃ  gÃ¬</h3>
<p><strong>Elastic Stack</strong> cÃ²n Ä‘Æ°á»£c gá»i lÃ  <strong>ELK Stack</strong>.</p>
<p>ELK lÃ  viáº¿t táº¯t cá»§a ba sáº£n pháº©m cá»§a cÃ´ng ty Elastic: <a href="https://www.elastic.co/cn/products/elasticsearch" target="_blank" rel="noopener noreferrer">ElasticSearch</a>, <a href="https://www.elastic.co/cn/products/logstash" target="_blank" rel="noopener noreferrer">Logstash</a>, vÃ  <a href="https://www.elastic.co/cn/products/kibana" target="_blank" rel="noopener noreferrer">Kibana</a>.</p>
<ul>
<li>Elasticsearch lÃ  má»™t cÃ´ng cá»¥ tÃ¬m kiáº¿m vÃ  phÃ¢n tÃ­ch.</li>
<li>Logstash lÃ  má»™t pipeline xá»­ lÃ½ dá»¯ liá»‡u phÃ­a mÃ¡y chá»§, cÃ³ kháº£ nÄƒng thu tháº­p dá»¯ liá»‡u tá»« nhiá»u nguá»“n cÃ¹ng má»™t lÃºc, chuyá»ƒn Ä‘á»•i dá»¯ liá»‡u, sau Ä‘Ã³ gá»­i dá»¯ liá»‡u Ä‘áº¿n cÃ¡c "kho lÆ°u trá»¯" nhÆ° Elasticsearch.</li>
<li>Kibana cho phÃ©p ngÆ°á»i dÃ¹ng trá»±c quan hÃ³a dá»¯ liá»‡u trong Elasticsearch báº±ng cÃ¡c biá»ƒu Ä‘á»“ vÃ  biá»ƒu Ä‘á»“.</li>
</ul>
<p>Elastic Stack lÃ  phiÃªn báº£n cáº­p nháº­t cá»§a ELK Stack, sáº£n pháº©m má»›i nháº¥t Ä‘Ã£ giá»›i thiá»‡u cÃ¡c bá»™ thu tháº­p dá»¯ liá»‡u chá»©c nÄƒng Ä‘Æ¡n láº» nháº¹ vÃ  Ä‘áº·t tÃªn cho chÃºng lÃ  <a href="https://www.elastic.co/beats" target="_blank" rel="noopener noreferrer">Beats</a>.</p>
<h3>1.2. Táº¡i sao sá»­ dá»¥ng Elastic Stack</h3>
<p>Äá»‘i vá»›i cÃ¡c cÃ´ng ty cÃ³ quy mÃ´ nháº¥t Ä‘á»‹nh, thÆ°á»ng sáº½ cÃ³ nhiá»u á»©ng dá»¥ng vÃ  Ä‘Æ°á»£c triá»ƒn khai trÃªn má»™t sá»‘ lÆ°á»£ng lá»›n mÃ¡y chá»§. NhÃ¢n viÃªn váº­n hÃ nh vÃ  phÃ¡t triá»ƒn thÆ°á»ng cáº§n xem nháº­t kÃ½ Ä‘á»ƒ xÃ¡c Ä‘á»‹nh váº¥n Ä‘á». Náº¿u á»©ng dá»¥ng Ä‘Æ°á»£c triá»ƒn khai theo cá»¥m, hÃ£y tÆ°á»Ÿng tÆ°á»£ng náº¿u báº¡n Ä‘Äƒng nháº­p vÃ o tá»«ng mÃ¡y chá»§ Ä‘á»ƒ xem nháº­t kÃ½, Ä‘iá»u nÃ y sáº½ tá»‘n nhiá»u thá»i gian vÃ  cÃ´ng sá»©c.</p>
<p>Vá»›i giáº£i phÃ¡p ELK, báº¡n cÃ³ thá»ƒ thu tháº­p, tÃ¬m kiáº¿m vÃ  phÃ¢n tÃ­ch nháº­t kÃ½ cÃ¹ng má»™t lÃºc.</p>
<h3>1.3. Kiáº¿n trÃºc Elastic Stack</h3>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/deploy3.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>
<blockquote>
<p><strong>Giáº£i thÃ­ch</strong></p>
<p>ÄÃ¢y lÃ  má»™t sÆ¡ Ä‘á»“ kiáº¿n trÃºc cá»§a Elastic Stack. Tá»« hÃ¬nh trÃªn, báº¡n cÃ³ thá»ƒ rÃµ rÃ ng tháº¥y hÆ°á»›ng dÃ²ng dá»¯ liá»‡u.</p>
<ul>
<li><a href="https://www.elastic.co/products/beats" target="_blank" rel="noopener noreferrer">Beats</a> lÃ  má»™t ná»n táº£ng truyá»n dá»¯ liá»‡u Ä‘Æ¡n chá»©c nÄƒng, nÃ³ cÃ³ thá»ƒ gá»­i dá»¯ liá»‡u tá»« nhiá»u mÃ¡y chá»§ Ä‘áº¿n Logstash hoáº·c ElasticSearch. Tuy nhiÃªn, Beats khÃ´ng pháº£i lÃ  má»™t pháº§n khÃ´ng thá»ƒ thiáº¿u, vÃ¬ váº­y bÃ i viáº¿t nÃ y sáº½ khÃ´ng giá»›i thiá»‡u.</li>
<li><a href="https://www.elastic.co/products/logstash" target="_blank" rel="noopener noreferrer">Logstash</a> lÃ  má»™t pipeline thu tháº­p dá»¯ liá»‡u Ä‘á»™ng. Há»— trá»£ thu tháº­p dá»¯ liá»‡u theo nhiá»u cÃ¡ch nhÆ° TCP/UDP/HTTP (cÅ©ng cÃ³ thá»ƒ nháº­n dá»¯ liá»‡u Ä‘Æ°á»£c Beats truyá»n Ä‘áº¿n), vÃ  xá»­ lÃ½ dá»¯ liá»‡u Ä‘á»ƒ lÃ m giÃ u hoáº·c trÃ­ch xuáº¥t trÆ°á»ng.</li>
<li><a href="https://www.elastic.co/products/elasticsearch" target="_blank" rel="noopener noreferrer">ElasticSearch</a> lÃ  má»™t cÃ´ng cá»¥ tÃ¬m kiáº¿m vÃ  phÃ¢n tÃ­ch phÃ¢n tÃ¡n dá»±a trÃªn JSON. LÃ  trung tÃ¢m cá»§a ELK, nÃ³ lÆ°u trá»¯ dá»¯ liá»‡u táº­p trung.</li>
<li><a href="https://www.elastic.co/products/kibana" target="_blank" rel="noopener noreferrer">Kibana</a> lÃ  giao diá»‡n ngÆ°á»i dÃ¹ng cá»§a ELK. NÃ³ trá»±c quan hÃ³a dá»¯ liá»‡u Ä‘Ã£ thu tháº­p (cÃ¡c bÃ¡o cÃ¡o, dá»¯ liá»‡u hÃ¬nh há»c) vÃ  cung cáº¥p giao diá»‡n Ä‘á»ƒ cáº¥u hÃ¬nh, quáº£n lÃ½ ELK.</li>
</ul>
</blockquote>
<h2>2. ElasticSearch</h2>
<blockquote>
<p><a href="https://github.com/elastic/elasticsearch" target="_blank" rel="noopener noreferrer">Elasticsearch</a>&nbsp;lÃ  má»™t cÃ´ng cá»¥ tÃ¬m kiáº¿m vÃ  phÃ¢n tÃ­ch dá»¯ liá»‡u phong cÃ¡ch RESTful, phÃ¢n tÃ¡n, cÃ³ thá»ƒ giáº£i quyáº¿t nhiá»u trÆ°á»ng há»£p sá»­ dá»¥ng xuáº¥t hiá»‡n liÃªn tá»¥c. LÃ  trung tÃ¢m cá»§a Elastic Stack, nÃ³ lÆ°u trá»¯ dá»¯ liá»‡u cá»§a báº¡n, giÃºp báº¡n khÃ¡m phÃ¡ cÃ¡c tÃ¬nh huá»‘ng dá»± kiáº¿n vÃ  khÃ´ng dá»± kiáº¿n.</p>
</blockquote>
<h3>2.1. Giá»›i thiá»‡u vá» ElasticSearch</h3>
<p><a href="https://github.com/elastic/elasticsearch" target="_blank" rel="noopener noreferrer">Elasticsearch</a>&nbsp;Ä‘Æ°á»£c phÃ¡t triá»ƒn dá»±a trÃªn thÆ° viá»‡n tÃ¬m kiáº¿m&nbsp;<a href="https://github.com/apache/lucene-solr" target="_blank" rel="noopener noreferrer">Lucene</a>. Elasticsearch giáº¥u Ä‘i sá»± phá»©c táº¡p cá»§a Lucene, cung cáº¥p giao diá»‡n API REST / Java dá»… sá»­ dá»¥ng (cÅ©ng nhÆ° cÃ¡c giao diá»‡n API báº±ng ngÃ´n ngá»¯ khÃ¡c).</p>
<p>Elasticsearch cÃ³ thá»ƒ Ä‘Æ°á»£c xem nhÆ° má»™t kho lÆ°u trá»¯ tÃ i liá»‡u, nÆ¡i nÃ³&nbsp;<strong>chuyá»ƒn Ä‘á»•i cÃ¡c cáº¥u trÃºc dá»¯ liá»‡u phá»©c táº¡p thÃ nh JSON Ä‘á»ƒ lÆ°u trá»¯</strong>.</p>
<p><strong>ElasticSearch lÃ  má»™t cÃ´ng cá»¥ tÃ¬m kiáº¿m toÃ n vÄƒn gáº§n nhÆ° thá»i gian thá»±c</strong>, Ä‘iá»u nÃ y cÃ³ nghÄ©a lÃ :</p>
<ul>
<li>Tá»« khi ghi dá»¯ liá»‡u Ä‘áº¿n khi dá»¯ liá»‡u cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m kiáº¿m, cÃ³ má»™t Ä‘á»™ trá»… nhá» (khoáº£ng 1s)</li>
<li>CÃ¡c hoáº¡t Ä‘á»™ng tÃ¬m kiáº¿m vÃ  phÃ¢n tÃ­ch dá»±a trÃªn ES cÃ³ thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c má»©c Ä‘á»™ giÃ¢y</li>
</ul>
<h4>2.1.1. KhÃ¡i niá»‡m cá»‘t lÃµi</h4>
<ul>
<li><strong><code>Index</code></strong>&nbsp;cÃ³ thá»ƒ Ä‘Æ°á»£c coi lÃ  má»™t táº­p há»£p tá»‘i Æ°u cá»§a cÃ¡c tÃ i liá»‡u (document).</li>
<li>Má»—i&nbsp;<strong><code>document</code></strong>&nbsp;lÃ  má»™t táº­p há»£p cÃ¡c trÆ°á»ng (field).</li>
<li><strong><code>Field</code></strong>&nbsp;lÃ  má»™t cáº·p giÃ¡ trá»‹ key-value chá»©a dá»¯ liá»‡u.</li>
<li>Theo máº·c Ä‘á»‹nh, Elasticsearch xÃ¢y dá»±ng chá»‰ má»¥c cho táº¥t cáº£ dá»¯ liá»‡u trong má»—i trÆ°á»ng vÃ  má»—i trÆ°á»ng chá»‰ má»¥c Ä‘á»u cÃ³ cáº¥u trÃºc dá»¯ liá»‡u tá»‘i Æ°u hÃ³a riÃªng.</li>
<li>Má»—i chá»‰ má»¥c cÃ³ thá»ƒ cÃ³ má»™t hoáº·c nhiá»u loáº¡i (type).&nbsp;<code>Type</code>&nbsp;lÃ  má»™t phÃ¢n loáº¡i logic cá»§a chá»‰ má»¥c,</li>
<li>Khi má»™t mÃ¡y khÃ´ng Ä‘á»§ Ä‘á»ƒ lÆ°u trá»¯ dá»¯ liá»‡u lá»›n, Elasticsearch cÃ³ thá»ƒ chia dá»¯ liá»‡u trong má»™t chá»‰ má»¥c thÃ nh nhiá»u&nbsp;<strong><code>shard</code></strong>.&nbsp;<strong><code>Shard</code></strong>&nbsp;Ä‘Æ°á»£c lÆ°u trá»¯ trÃªn nhiá»u mÃ¡y chá»§. Vá»›i shard, báº¡n cÃ³ thá»ƒ má»Ÿ rá»™ng theo chiá»u ngang, lÆ°u trá»¯ nhiá»u dá»¯ liá»‡u hÆ¡n, cho phÃ©p cÃ¡c hoáº¡t Ä‘á»™ng tÃ¬m kiáº¿m vÃ  phÃ¢n tÃ­ch Ä‘Æ°á»£c phÃ¢n phá»‘i trÃªn nhiá»u mÃ¡y chá»§, tÄƒng cÆ°á»ng throughput vÃ  hiá»‡u suáº¥t. Má»—i shard Ä‘á»u lÃ  má»™t chá»‰ má»¥c lucene.</li>
<li>Báº¥t ká»³ mÃ¡y chá»§ nÃ o cÅ©ng cÃ³ thá»ƒ gáº·p sá»± cá»‘ hoáº·c bá»‹ táº¯t báº¥t cá»© lÃºc nÃ o, lÃºc nÃ y shard cÃ³ thá»ƒ bá»‹ máº¥t, do Ä‘Ã³, báº¡n cÃ³ thá»ƒ táº¡o nhiá»u&nbsp;<strong><code>replica</code></strong>&nbsp;cho má»—i shard. Replica cÃ³ thá»ƒ cung cáº¥p dá»‹ch vá»¥ dá»± phÃ²ng khi shard gáº·p sá»± cá»‘, Ä‘áº£m báº£o dá»¯ liá»‡u khÃ´ng bá»‹ máº¥t, nhiá»u replica cÅ©ng cÃ³ thá»ƒ tÄƒng cÆ°á»ng throughput vÃ  hiá»‡u suáº¥t cá»§a hoáº¡t Ä‘á»™ng tÃ¬m kiáº¿m. Primary shard (Ä‘Æ°á»£c thiáº¿t láº­p khi táº¡o chá»‰ má»¥c, khÃ´ng thá»ƒ sá»­a Ä‘á»•i, máº·c Ä‘á»‹nh lÃ  5), replica shard (cÃ³ thá»ƒ thay Ä‘á»•i sá»‘ lÆ°á»£ng báº¥t cá»© lÃºc nÃ o, máº·c Ä‘á»‹nh lÃ  1), máº·c Ä‘á»‹nh má»—i chá»‰ má»¥c cÃ³ 10 shard, 5 primary shard, 5 replica shard, cáº¥u hÃ¬nh cÃ³ sáºµn tá»‘i thiá»ƒu, lÃ  2 mÃ¡y chá»§.</li>
</ul>
<h3>2.2. NguyÃªn lÃ½ ElasticSearch</h3>
<h4>2.2.1. QuÃ¡ trÃ¬nh ghi dá»¯ liá»‡u ES</h4>
<ul>
<li>MÃ¡y khÃ¡ch chá»n má»™t node vÃ  gá»­i yÃªu cáº§u Ä‘áº¿n, node nÃ y Ä‘Æ°á»£c gá»i lÃ &nbsp;<code>coordinating node</code>&nbsp;(nÃºt Ä‘iá»u phá»‘i).</li>
<li><code>Coordinating node</code>&nbsp;thá»±c hiá»‡n&nbsp;<strong>Ä‘á»‹nh tuyáº¿n</strong>&nbsp;cho document vÃ  chuyá»ƒn tiáº¿p yÃªu cáº§u Ä‘áº¿n node tÆ°Æ¡ng á»©ng (cÃ³ primary shard).</li>
<li><code>Primary shard</code>&nbsp;trÃªn node thá»±c táº¿ xá»­ lÃ½ yÃªu cáº§u, sau Ä‘Ã³ Ä‘á»“ng bá»™ hÃ³a dá»¯ liá»‡u vá»›i&nbsp;<code>replica node</code>.</li>
<li>Náº¿u&nbsp;<code>coordinating node</code>&nbsp;phÃ¡t hiá»‡n&nbsp;<code>primary node</code>&nbsp;vÃ  táº¥t cáº£&nbsp;<code>replica node</code>&nbsp;Ä‘á»u Ä‘Ã£ hoÃ n thÃ nh, nÃ³ sáº½ tráº£ láº¡i káº¿t quáº£ pháº£n há»“i cho mÃ¡y khÃ¡ch.</li>
</ul>
<h4>2.2.2. QuÃ¡ trÃ¬nh Ä‘á»c dá»¯ liá»‡u es</h4>
<p>Báº¡n cÃ³ thá»ƒ tÃ¬m kiáº¿m theo&nbsp;<code>doc id</code>, sáº½ dá»±a trÃªn&nbsp;<code>doc id</code>&nbsp;Ä‘á»ƒ thá»±c hiá»‡n hash, xÃ¡c Ä‘á»‹nh xem lÃºc Ä‘Ã³&nbsp;<code>doc id</code>&nbsp;Ä‘Ã£ Ä‘Æ°á»£c phÃ¢n bá»• vÃ o shard nÃ o, tá»« shard Ä‘Ã³ Ä‘á»ƒ tÃ¬m kiáº¿m.</p>
<ul>
<li>MÃ¡y khÃ¡ch gá»­i yÃªu cáº§u Ä‘áº¿n&nbsp;<strong>báº¥t ká»³</strong>&nbsp;má»™t node, trá»Ÿ thÃ nh&nbsp;<code>coordinate node</code>.</li>
<li><code>Coordinate node</code>&nbsp;Ä‘á»‹nh tuyáº¿n&nbsp;<code>doc id</code>&nbsp;theo hash, chuyá»ƒn yÃªu cáº§u Ä‘áº¿n node tÆ°Æ¡ng á»©ng, lÃºc nÃ y sáº½ sá»­ dá»¥ng thuáº­t toÃ¡n&nbsp;<strong>round-robin ngáº«u nhiÃªn</strong>, chá»n ngáº«u nhiÃªn má»™t trong sá»‘&nbsp;<code>primary shard</code>&nbsp;vÃ  táº¥t cáº£ cÃ¡c replica cá»§a nÃ³, Ä‘á»ƒ cÃ¢n báº±ng táº£i yÃªu cáº§u Ä‘á»c.</li>
<li>Node nháº­n yÃªu cáº§u tráº£ vá» document cho&nbsp;<code>coordinate node</code>.</li>
<li><code>Coordinate node</code>&nbsp;tráº£ vá» document cho mÃ¡y khÃ¡ch.</li>
</ul>
<h4>2.2.3. NguyÃªn lÃ½ cÆ¡ báº£n cá»§a viá»‡c ghi dá»¯ liá»‡u</h4>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240223111949.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure>
<p>Äáº§u tiÃªn, dá»¯ liá»‡u sáº½ Ä‘Æ°á»£c ghi vÃ o bá»™ Ä‘á»‡m trong bá»™ nhá»› (buffer), trong quÃ¡ trÃ¬nh nÃ y dá»¯ liá»‡u khÃ´ng thá»ƒ Ä‘Æ°á»£c tÃ¬m kiáº¿m; Ä‘á»“ng thá»i dá»¯ liá»‡u cÅ©ng Ä‘Æ°á»£c ghi vÃ o tá»‡p nháº­t kÃ½ translog.</p>
<p>Náº¿u bá»™ Ä‘á»‡m gáº§n nhÆ° Ä‘áº§y, hoáº·c sau má»™t khoáº£ng thá»i gian nháº¥t Ä‘á»‹nh, dá»¯ liá»‡u trong bá»™ Ä‘á»‡m sáº½ Ä‘Æ°á»£c&nbsp;<code>refresh</code>&nbsp;vÃ o má»™t&nbsp;<code>segment file</code>&nbsp;má»›i, nhÆ°ng lÃºc nÃ y dá»¯ liá»‡u khÃ´ng Ä‘Æ°á»£c ghi trá»±c tiáº¿p vÃ o tá»‡p&nbsp;<code>segment file</code> trÃªn Ä‘Ä©a, mÃ  pháº£i Ä‘i vÃ o&nbsp;<code>os cache</code>&nbsp;trÆ°á»›c. QuÃ¡ trÃ¬nh nÃ y Ä‘Æ°á»£c gá»i lÃ &nbsp;<code>refresh</code>.</p>
<p>Má»—i giÃ¢y, ES sáº½ ghi dá»¯ liá»‡u trong bá»™ Ä‘á»‡m vÃ o má»™t&nbsp;<code>segment file</code>&nbsp;<strong>má»›i</strong>, má»—i giÃ¢y sáº½ táº¡o ra má»™t tá»‡p Ä‘Ä©a <code>segment file</code>&nbsp;<strong>má»›i</strong>, tá»‡p&nbsp;<code>segment file</code> nÃ y sáº½ lÆ°u trá»¯ dá»¯ liá»‡u Ä‘Æ°á»£c ghi vÃ o bá»™ Ä‘á»‡m trong 1 giÃ¢y gáº§n Ä‘Ã¢y.</p>
<p>Tuy nhiÃªn, náº¿u khÃ´ng cÃ³ dá»¯ liá»‡u trong bá»™ Ä‘á»‡m, thÃ¬ táº¥t nhiÃªn khÃ´ng cÃ³ quÃ¡ trÃ¬nh refresh nÃ o Ä‘Æ°á»£c thá»±c hiá»‡n, náº¿u cÃ³ dá»¯ liá»‡u trong bá»™ Ä‘á»‡m, máº·c Ä‘á»‹nh sáº½ thá»±c hiá»‡n má»™t láº§n refresh má»—i giÃ¢y, Ä‘áº©y dá»¯ liá»‡u vÃ o má»™t&nbsp;<code>segment file</code>&nbsp;má»›i.</p>
<p>TrÃªn há»‡ Ä‘iá»u hÃ nh, tá»‡p Ä‘Ä©a thá»±c táº¿ Ä‘á»u cÃ³ má»™t thá»© gá»i lÃ &nbsp;<code>os cache</code>, tá»©c lÃ  trÆ°á»›c khi dá»¯ liá»‡u Ä‘Æ°á»£c ghi vÃ o tá»‡p Ä‘Ä©a, nÃ³ sáº½ Ä‘Æ°á»£c Ä‘Æ°a vÃ o&nbsp;<code>os cache</code> trÆ°á»›c, Ä‘áº§u tiÃªn vÃ o bá»™ nhá»› cache cáº¥p há»‡ Ä‘iá»u hÃ nh. Chá»‰ cáº§n dá»¯ liá»‡u trong bá»™ Ä‘á»‡m Ä‘Æ°á»£c chuyá»ƒn vÃ o&nbsp;<code>os cache</code>&nbsp;thÃ´ng qua hoáº¡t Ä‘á»™ng refresh, dá»¯ liá»‡u nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m kiáº¿m.</p>
<p>Táº¡i sao nÃ³i ráº±ng ES lÃ &nbsp;<strong>gáº§n nhÆ° thá»i gian thá»±c</strong>?&nbsp;<code>NRT</code>, tÃªn Ä‘áº§y Ä‘á»§ lÃ &nbsp;<code>near real-time</code>. Máº·c Ä‘á»‹nh lÃ  refresh má»—i giÃ¢y má»™t láº§n, vÃ¬ váº­y ES lÃ  gáº§n nhÆ° thá»i gian thá»±c, vÃ¬ dá»¯ liá»‡u Ä‘Æ°á»£c ghi vÃ o sau 1 giÃ¢y má»›i cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m tháº¥y. Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng&nbsp;<code>restful api</code>&nbsp;cá»§a es hoáº·c&nbsp;<code>java api</code>&nbsp;Ä‘á»ƒ thá»±c hiá»‡n má»™t hoáº¡t Ä‘á»™ng refresh&nbsp;<strong>thá»§ cÃ´ng</strong>, tá»©c lÃ  thá»§ cÃ´ng Ä‘Æ°a dá»¯ liá»‡u trong bá»™ Ä‘á»‡m vÃ o&nbsp;<code>os cache</code>, Ä‘á»ƒ dá»¯ liá»‡u cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m kiáº¿m ngay láº­p tá»©c. Miá»…n lÃ  dá»¯ liá»‡u Ä‘Æ°á»£c Ä‘Æ°a vÃ o&nbsp;<code>os cache</code>, bá»™ Ä‘á»‡m sáº½ Ä‘Æ°á»£c lÃ m sáº¡ch, vÃ¬ khÃ´ng cáº§n giá»¯ bá»™ Ä‘á»‡m ná»¯a, dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c lÆ°u trá»¯ trong tá»‡p nháº­t kÃ½ translog má»™t láº§n.</p>
<p>Láº·p láº¡i cÃ¡c bÆ°á»›c trÃªn, dá»¯ liá»‡u má»›i liÃªn tá»¥c vÃ o bá»™ Ä‘á»‡m vÃ  translog, liÃªn tá»¥c ghi dá»¯ liá»‡u&nbsp;<code>buffer</code>&nbsp;vÃ o má»™t&nbsp;<code>segment file</code>&nbsp;má»›i sau má»—i láº§n&nbsp;<code>refresh</code>, sau má»—i láº§n&nbsp;<code>refresh</code>&nbsp;bá»™ Ä‘á»‡m sáº½ Ä‘Æ°á»£c lÃ m sáº¡ch, translog sáº½ Ä‘Æ°á»£c giá»¯ láº¡i. Khi quÃ¡ trÃ¬nh nÃ y tiáº¿p diá»…n, translog sáº½ ngÃ y cÃ ng lá»›n. Khi translog Ä‘áº¡t Ä‘áº¿n má»™t Ä‘á»™ dÃ i nháº¥t Ä‘á»‹nh, nÃ³ sáº½ kÃ­ch hoáº¡t hoáº¡t Ä‘á»™ng&nbsp;<code>commit</code>.</p>
<p>BÆ°á»›c Ä‘áº§u tiÃªn cá»§a hoáº¡t Ä‘á»™ng commit lÃ  ghi dá»¯ liá»‡u hiá»‡n cÃ³ trong bá»™ Ä‘á»‡m vÃ o&nbsp;<code>os cache</code>, sau Ä‘Ã³ lÃ m sáº¡ch bá»™ Ä‘á»‡m. Sau Ä‘Ã³, ghi má»™t&nbsp;<code>commit point</code>&nbsp;vÃ o tá»‡p Ä‘Ä©a, trong Ä‘Ã³ Ä‘Ã¡nh dáº¥u táº¥t cáº£ cÃ¡c&nbsp;<code>segment file</code>&nbsp;tÆ°Æ¡ng á»©ng vá»›i&nbsp;<code>commit point</code>&nbsp;nÃ y, Ä‘á»“ng thá»i buá»™c&nbsp;<code>os cache</code>&nbsp;chá»©a táº¥t cáº£ dá»¯ liá»‡u hiá»‡n táº¡i Ä‘á»ƒ Ä‘Æ°á»£c&nbsp;<code>fsync</code>&nbsp;vÃ o tá»‡p Ä‘Ä©a. Cuá»‘i cÃ¹ng,&nbsp;<strong>xÃ³a</strong>&nbsp;tá»‡p nháº­t kÃ½ translog hiá»‡n táº¡i, khá»Ÿi Ä‘á»™ng láº¡i má»™t translog, lÃºc nÃ y hoáº¡t Ä‘á»™ng commit Ä‘Ã£ hoÃ n thÃ nh.</p>
<p>Hoáº¡t Ä‘á»™ng commit nÃ y Ä‘Æ°á»£c gá»i lÃ &nbsp;<code>flush</code>. Máº·c Ä‘á»‹nh lÃ  má»—i 30 phÃºt tá»± Ä‘á»™ng thá»±c hiá»‡n má»™t láº§n&nbsp;<code>flush</code>, nhÆ°ng náº¿u translog quÃ¡ lá»›n, cÅ©ng sáº½ kÃ­ch hoáº¡t&nbsp;<code>flush</code>. Hoáº¡t Ä‘á»™ng flush tÆ°Æ¡ng á»©ng vá»›i toÃ n bá»™ quÃ¡ trÃ¬nh commit, chÃºng ta cÃ³ thá»ƒ thÃ´ng qua api cá»§a es, thá»±c hiá»‡n thá»§ cÃ´ng hoáº¡t Ä‘á»™ng flush, thá»§ cÃ´ng&nbsp;<code>fsync</code>&nbsp;dá»¯ liá»‡u trong&nbsp;<code>os cache</code>&nbsp;vÃ o Ä‘Ä©a.</p>
<p>Tá»‡p nháº­t kÃ½ translog cÃ³ vai trÃ² gÃ¬? TrÆ°á»›c khi báº¡n thá»±c hiá»‡n hoáº¡t Ä‘á»™ng commit, dá»¯ liá»‡u cÃ³ thá»ƒ Ä‘ang náº±m trong bá»™ Ä‘á»‡m hoáº·c náº±m trong&nbsp;<code>os cache</code>. DÃ¹ lÃ  bá»™ Ä‘á»‡m hay&nbsp;<code>os cache</code>&nbsp;Ä‘á»u lÃ  bá»™ nhá»›, náº¿u mÃ¡y nÃ y bá»‹ há»ng, dá»¯ liá»‡u trong bá»™ nhá»› sáº½ máº¥t háº¿t. VÃ¬ váº­y, cáº§n ghi cÃ¡c hoáº¡t Ä‘á»™ng tÆ°Æ¡ng á»©ng cá»§a dá»¯ liá»‡u vÃ o má»™t tá»‡p nháº­t kÃ½ Ä‘áº·c biá»‡t lÃ &nbsp;<code>translog</code>, náº¿u mÃ¡y bá»‹ há»ng lÃºc nÃ y, khi khá»Ÿi Ä‘á»™ng láº¡i, es sáº½ tá»± Ä‘á»™ng Ä‘á»c dá»¯ liá»‡u tá»« tá»‡p nháº­t kÃ½ translog vÃ  phá»¥c há»“i vÃ o bá»™ nhá»›&nbsp;<code>buffer</code>&nbsp;vÃ &nbsp;<code>os cache</code>.</p>
<p>Thá»±c táº¿, translog cÅ©ng Ä‘Æ°á»£c ghi vÃ o&nbsp;<code>os cache</code>&nbsp;trÆ°á»›c, máº·c Ä‘á»‹nh lÃ  má»—i 5 giÃ¢y sáº½ Ä‘áº©y vÃ o Ä‘Ä©a má»™t láº§n, vÃ¬ váº­y máº·c Ä‘á»‹nh, cÃ³ thá»ƒ cÃ³ 5 giÃ¢y dá»¯ liá»‡u chá»‰ náº±m trong bá»™ Ä‘á»‡m hoáº·c <code>os cache</code> hoáº·c tá»‡p translog, khÃ´ng náº±m trÃªn Ä‘Ä©a, náº¿u mÃ¡y nÃ y bá»‹ há»ng lÃºc nÃ y, sáº½&nbsp;<strong>máº¥t</strong>&nbsp;5 giÃ¢y dá»¯ liá»‡u. NhÆ°ng hiá»‡u suáº¥t nhÆ° váº­y tá»‘t hÆ¡n, máº¥t tá»‘i Ä‘a 5 giÃ¢y dá»¯ liá»‡u. Báº¡n cÅ©ng cÃ³ thá»ƒ Ä‘áº·t translog Ä‘á»ƒ má»—i láº§n ghi pháº£i&nbsp;<code>fsync</code>&nbsp;trá»±c tiáº¿p vÃ o Ä‘Ä©a, nhÆ°ng hiá»‡u suáº¥t sáº½ kÃ©m hÆ¡n nhiá»u.</p>
<p>Thá»±c táº¿, náº¿u báº¡n á»Ÿ Ä‘Ã¢y, náº¿u ngÆ°á»i phá»ng váº¥n khÃ´ng há»i báº¡n vá» váº¥n Ä‘á» máº¥t dá»¯ liá»‡u cá»§a es, báº¡n cÃ³ thá»ƒ tá»± hÃ o vá»›i ngÆ°á»i phá»ng váº¥n á»Ÿ Ä‘Ã¢y, báº¡n nÃ³i, thá»±c táº¿ es trÆ°á»›c tiÃªn lÃ  gáº§n nhÆ° thá»i gian thá»±c, dá»¯ liá»‡u Ä‘Æ°á»£c ghi vÃ o sau 1 giÃ¢y má»›i cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m tháº¥y; cÃ³ thá»ƒ máº¥t dá»¯ liá»‡u. CÃ³ 5 giÃ¢y dá»¯ liá»‡u, náº±m trong bá»™ Ä‘á»‡m,&nbsp;<code>os cache</code>&nbsp;cá»§a translog,&nbsp;<code>os cache</code>&nbsp;cá»§a&nbsp;<code>segment file</code>, khÃ´ng náº±m trÃªn Ä‘Ä©a, náº¿u mÃ¡y nÃ y bá»‹ há»ng lÃºc nÃ y, sáº½ dáº«n Ä‘áº¿n&nbsp;<strong>máº¥t</strong>&nbsp;5 giÃ¢y dá»¯ liá»‡u.</p>
<p><strong>TÃ³m láº¡i</strong>, dá»¯ liá»‡u Ä‘Æ°á»£c ghi vÃ o bá»™ Ä‘á»‡m trÆ°á»›c, sau Ä‘Ã³ má»—i giÃ¢y, dá»¯ liá»‡u sáº½ Ä‘Æ°á»£c refresh vÃ o&nbsp;<code>os cache</code>, khi dá»¯ liá»‡u Ä‘áº¿n&nbsp;<code>os cache</code>, dá»¯ liá»‡u cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m kiáº¿m (Ä‘Ã³ lÃ  lÃ½ do táº¡i sao chÃºng ta nÃ³i ráº±ng tá»« khi dá»¯ liá»‡u Ä‘Æ°á»£c ghi vÃ o cho Ä‘áº¿n khi cÃ³ thá»ƒ tÃ¬m kiáº¿m, cÃ³ Ä‘á»™ trá»… 1s). Má»—i 5 giÃ¢y, dá»¯ liá»‡u sáº½ Ä‘Æ°á»£c ghi vÃ o tá»‡p translog (do Ä‘Ã³, náº¿u mÃ¡y bá»‹ há»ng, táº¥t cáº£ dá»¯ liá»‡u trong bá»™ nhá»› sáº½ máº¥t, tá»‘i Ä‘a sáº½ máº¥t 5s dá»¯ liá»‡u), khi translog lá»›n Ä‘áº¿n má»™t má»©c Ä‘á»™ nháº¥t Ä‘á»‹nh, hoáº·c máº·c Ä‘á»‹nh má»—i 30 phÃºt, má»™t hoáº¡t Ä‘á»™ng commit sáº½ Ä‘Æ°á»£c kÃ­ch hoáº¡t, Ä‘áº©y táº¥t cáº£ dá»¯ liá»‡u trong bá»™ Ä‘á»‡m vÃ o tá»‡p&nbsp;<code>segment file</code>trÃªn Ä‘Ä©a.</p>
<blockquote>
<p>Sau khi dá»¯ liá»‡u Ä‘Æ°á»£c ghi vÃ o&nbsp;<code>segment file</code>, chá»‰ má»¥c Ä‘áº£o ngÆ°á»£c cÅ©ng sáº½ Ä‘Æ°á»£c táº¡o ngay láº­p tá»©c.</p>
</blockquote>
<h4>2.2.4. NguyÃªn lÃ½ cÆ¡ báº£n khi xÃ³a/cáº­p nháº­t dá»¯ liá»‡u</h4>
<p>Náº¿u lÃ  hoáº¡t Ä‘á»™ng xÃ³a, khi commit sáº½ táº¡o ra má»™t tá»‡p&nbsp;<code>.del</code>, trong Ä‘Ã³ Ä‘Ã¡nh dáº¥u má»™t doc nháº¥t Ä‘á»‹nh lÃ  tráº¡ng thÃ¡i&nbsp;<code>deleted</code>, vÃ¬ váº­y khi tÃ¬m kiáº¿m, dá»±a vÃ o tá»‡p&nbsp;<code>.del</code>, báº¡n sáº½ biáº¿t liá»‡u doc cÃ³ bá»‹ xÃ³a hay khÃ´ng.</p>
<p>Náº¿u lÃ  hoáº¡t Ä‘á»™ng cáº­p nháº­t, nÃ³ sáº½ Ä‘Ã¡nh dáº¥u doc gá»‘c lÃ  tráº¡ng thÃ¡i&nbsp;<code>deleted</code>&nbsp;vÃ  sau Ä‘Ã³ ghi má»™t dá»¯ liá»‡u má»›i.</p>
<p>Má»—i khi bá»™ Ä‘á»‡m Ä‘Æ°á»£c refresh, má»™t&nbsp;<code>segment file</code>&nbsp;sáº½ Ä‘Æ°á»£c táº¡o ra, vÃ¬ váº­y máº·c Ä‘á»‹nh lÃ  má»™t&nbsp;<code>segment file</code>&nbsp;má»—i giÃ¢y, vÃ¬ váº­y&nbsp;<code>segment file</code>&nbsp;sáº½ ngÃ y cÃ ng nhiá»u, lÃºc nÃ y sáº½ thÆ°á»ng xuyÃªn thá»±c hiá»‡n merge. Má»—i láº§n merge, nhiá»u&nbsp;<code>segment file</code>&nbsp;sáº½ Ä‘Æ°á»£c há»£p nháº¥t thÃ nh má»™t, Ä‘á»“ng thá»i á»Ÿ Ä‘Ã¢y, doc Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u lÃ &nbsp;<code>deleted</code>&nbsp;sáº½ Ä‘Æ°á»£c&nbsp;<strong>xÃ³a váº­t lÃ½</strong>, sau Ä‘Ã³ ghi&nbsp;<code>segment file</code>&nbsp;má»›i vÃ o Ä‘Ä©a, á»Ÿ Ä‘Ã¢y sáº½ ghi má»™t&nbsp;<code>commit point</code>, Ä‘Ã¡nh dáº¥u táº¥t cáº£&nbsp;<code>segment file</code>&nbsp;má»›i, sau Ä‘Ã³ má»Ÿ&nbsp;<code>segment file</code>&nbsp;Ä‘á»ƒ tÃ¬m kiáº¿m, vÃ  sau Ä‘Ã³ xÃ³a&nbsp;<code>segment file</code>&nbsp;cÅ©.</p>
<h4>2.2.5. Lá»›p cÆ¡ báº£n Lucene</h4>
<p>ÄÆ¡n giáº£n, Lucene chá»‰ lÃ  má»™t thÆ° viá»‡n jar, bÃªn trong nÃ³ chá»©a cÃ¡c mÃ£ thuáº­t toÃ¡n Ä‘Ã£ Ä‘Æ°á»£c Ä‘Ã³ng gÃ³i Ä‘á»ƒ táº¡o chá»‰ má»¥c Ä‘áº£o ngÆ°á»£c. Khi chÃºng ta phÃ¡t triá»ƒn báº±ng Java, chÃºng ta chá»‰ cáº§n import thÆ° viá»‡n jar Lucene, sau Ä‘Ã³ phÃ¡t triá»ƒn dá»±a trÃªn API cá»§a Lucene.</p>
<p>ThÃ´ng qua Lucene, chÃºng ta cÃ³ thá»ƒ táº¡o chá»‰ má»¥c cho dá»¯ liá»‡u hiá»‡n cÃ³, Lucene sáº½ tá»• chá»©c cáº¥u trÃºc dá»¯ liá»‡u chá»‰ má»¥c trÃªn á»• Ä‘Ä©a cá»¥c bá»™ cho chÃºng ta.</p>
<h4>2.2.5. Chá»‰ má»¥c Ä‘áº£o ngÆ°á»£c</h4>
<p>Trong cÃ´ng cá»¥ tÃ¬m kiáº¿m, má»—i tÃ i liá»‡u Ä‘á»u cÃ³ má»™t ID tÃ i liá»‡u tÆ°Æ¡ng á»©ng, ná»™i dung tÃ i liá»‡u Ä‘Æ°á»£c biá»ƒu diá»…n dÆ°á»›i dáº¡ng má»™t táº­p há»£p cÃ¡c tá»« khÃ³a. VÃ­ dá»¥, sau khi phÃ¢n loáº¡i, tÃ i liá»‡u 1 Ä‘Ã£ trÃ­ch xuáº¥t 20 tá»« khÃ³a, má»—i tá»« khÃ³a Ä‘á»u ghi láº¡i sá»‘ láº§n xuáº¥t hiá»‡n vÃ  vá»‹ trÃ­ xuáº¥t hiá»‡n cá»§a nÃ³ trong tÃ i liá»‡u.</p>
<p>Váº­y, chá»‰ má»¥c Ä‘áº£o ngÆ°á»£c lÃ  Ã¡nh xáº¡ tá»«&nbsp;<strong>tá»« khÃ³a Ä‘áº¿n ID tÃ i liá»‡u</strong>, má»—i tá»« khÃ³a Ä‘á»u tÆ°Æ¡ng á»©ng vá»›i má»™t loáº¡t tÃ i liá»‡u, trong Ä‘Ã³ táº¥t cáº£ cÃ¡c tÃ i liá»‡u Ä‘á»u xuáº¥t hiá»‡n tá»« khÃ³a.</p>
<p>VÃ­ dá»¥.</p>
<p>CÃ³ cÃ¡c tÃ i liá»‡u sau:</p>
<p>| DocId | Doc                                                                           |<br>
|</p>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/deploy3.png" type="image/png"/>
    </item>
    <item>
      <title>Elasticsearch</title>
      <link>https://vanhung4499.github.io/database/elasticsearch/</link>
      <guid>https://vanhung4499.github.io/database/elasticsearch/</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Elasticsearch</source>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
    </item>
    <item>
      <title>Elasticsearch Aggregation</title>
      <link>https://vanhung4499.github.io/database/elasticsearch/aggregation.html</link>
      <guid>https://vanhung4499.github.io/database/elasticsearch/aggregation.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Elasticsearch Aggregation</source>
      <description>Elasticsearch Aggregations Elasticsearch lÃ  má»™t cÃ´ng cá»¥ tÃ¬m kiáº¿m toÃ n vÄƒn báº£n phÃ¢n tÃ¡n, láº­p chá»‰ má»¥c vÃ  tÃ¬m kiáº¿m lÃ  cÃ¡c chá»©c nÄƒng cÆ¡ báº£n cá»§a Elasticsearch. Thá»±c táº¿, chá»©c nÄƒng Agg...</description>
      <category>elasticssearch</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<p>Elasticsearch lÃ  má»™t cÃ´ng cá»¥ tÃ¬m kiáº¿m toÃ n vÄƒn báº£n phÃ¢n tÃ¡n, láº­p chá»‰ má»¥c vÃ  tÃ¬m kiáº¿m lÃ  cÃ¡c chá»©c nÄƒng cÆ¡ báº£n cá»§a Elasticsearch. Thá»±c táº¿, chá»©c nÄƒng Aggregations cá»§a Elasticsearch cÅ©ng ráº¥t máº¡nh máº½, cho phÃ©p thá»±c hiá»‡n phÃ¢n tÃ­ch thá»‘ng kÃª phá»©c táº¡p trÃªn dá»¯ liá»‡u. Elasticsearch cung cáº¥p bá»‘n loáº¡i chá»©c nÄƒng phÃ¢n tÃ­ch tá»•ng há»£p chÃ­nh, bao gá»“m <strong>aggregations chá»‰ sá»‘ (metrics aggregations)</strong>, <strong>aggregations thÃ¹ng (bucket aggregations)</strong>, <strong>aggregations á»‘ng (pipeline aggregations)</strong> vÃ  <strong>aggregations ma tráº­n (matrix aggregations)</strong>. Aggregations á»‘ng vÃ  aggregations ma tráº­n Ä‘ang trong giai Ä‘oáº¡n thá»­ nghiá»‡m theo thÃ´ng bÃ¡o chÃ­nh thá»©c, vÃ  sáº½ Ä‘Æ°á»£c thay Ä‘á»•i hoÃ n toÃ n hoáº·c loáº¡i bá» sau nÃ y, vÃ¬ váº­y chÃºng tÃ´i sáº½ khÃ´ng giáº£i thÃ­ch vá» aggregations á»‘ng vÃ  aggregations ma tráº­n á»Ÿ Ä‘Ã¢y.</p>
<h2>Cáº¥u trÃºc cá»¥ thá»ƒ cá»§a Aggregations</h2>
<p>Táº¥t cáº£ cÃ¡c aggregations, báº¥t ká»ƒ loáº¡i nÃ o, Ä‘á»u tuÃ¢n theo cÃ¡c quy táº¯c sau.</p>
<ul>
<li>ChÃºng Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong cÃ¹ng má»™t yÃªu cáº§u JSON nhÆ° truy váº¥n, vÃ  báº¡n Ä‘Ã¡nh dáº¥u chÃºng báº±ng cÃ¡ch sá»­ dá»¥ng khÃ³a aggregations hoáº·c aggs. Báº¡n cáº§n Ä‘áº·t tÃªn cho má»—i aggregation, chá»‰ Ä‘á»‹nh loáº¡i cá»§a nÃ³ vÃ  cÃ¡c tÃ¹y chá»n liÃªn quan Ä‘áº¿n loáº¡i Ä‘Ã³.</li>
<li>ChÃºng cháº¡y trÃªn káº¿t quáº£ cá»§a truy váº¥n. CÃ¡c tÃ i liá»‡u khÃ´ng khá»›p vá»›i truy váº¥n sáº½ khÃ´ng Ä‘Æ°á»£c tÃ­nh, trá»« khi báº¡n sá»­ dá»¥ng aggregation global Ä‘á»ƒ bao gá»“m cÃ¡c tÃ i liá»‡u khÃ´ng khá»›p.</li>
<li>ChÃºng cÃ³ thá»ƒ lá»c thÃªm káº¿t quáº£ cá»§a truy váº¥n mÃ  khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n aggregation.</li>
</ul>
<p>DÆ°á»›i Ä‘Ã¢y lÃ  cáº¥u trÃºc cÆ¡ báº£n cá»§a aggregation:</p>
<div class="language-json" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#98C379;--shiki-dark:#98C379">"aggregations"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : { </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">&lt;!--</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> KhÃ³a</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> aggregation</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> á»Ÿ</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> cáº¥p</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> Ä‘á»™</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> cao</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> nháº¥t,</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> cÅ©ng</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> cÃ³</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> thá»ƒ</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> viáº¿t</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> táº¯t</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> lÃ </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> aggs</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> --&gt;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "&lt;aggregation_name&gt;"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : { </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">&lt;!--</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> TÃªn</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> tÃ¹y</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> chá»‰nh</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> cá»§a</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> aggregation</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> --&gt;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">        "&lt;aggregation_type&gt;"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : { </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">&lt;!--</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> Loáº¡i</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> aggregation,</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> liÃªn</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> quan</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> Ä‘áº¿n</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> chá»‰</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> sá»‘</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> nhÆ°</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> max,</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> min,</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> avg,</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> sum,</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> liÃªn</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> quan</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> Ä‘áº¿n</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> thÃ¹ng</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> nhÆ°</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> terms,</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> filter,</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> v.v.</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> --&gt;</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">            &lt;aggregation_body&gt;</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> &lt;!--</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> ThÃ¢n</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> aggregation</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">trÆ°á»ng</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> nÃ o</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> sáº½</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> Ä‘Æ°á»£c</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> tá»•ng</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> há»£p</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">cÃ³</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> thá»ƒ</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> láº¥y</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> giÃ¡</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> trá»‹</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> cá»§a</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> trÆ°á»ng</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> hoáº·c</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> káº¿t</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> quáº£</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> cá»§a</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> script</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        [,</span><span style="color:#98C379;--shiki-dark:#98C379">"meta"</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> :</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> {  </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">[&lt;meta_data_body&gt;]</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> } ]</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">?</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> &lt;!--</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> Meta</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        [,</span><span style="color:#98C379;--shiki-dark:#98C379">"aggregations"</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> :</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> { </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">[&lt;sub_aggregation&gt;]+</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> } ]</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">?</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> &lt;!--</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> Äá»‹nh</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> nghÄ©a</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> sub-aggregation</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> trong</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> aggregation</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    [,</span><span style="color:#98C379;--shiki-dark:#98C379">"&lt;aggregation_name_2&gt;"</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> :</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> { </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">...</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> } ]</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">*</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> &lt;!--</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> TÃªn</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> tÃ¹y</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> chá»‰nh</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> cá»§a</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> aggregation</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 2</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><ul>
<li><strong>á» cáº¥p Ä‘á»™ cao nháº¥t cÃ³ má»™t khÃ³a aggregations, cÃ³ thá»ƒ viáº¿t táº¯t lÃ  aggs</strong>.</li>
<li>á» cáº¥p Ä‘á»™ tiáº¿p theo, báº¡n cáº§n chá»‰ Ä‘á»‹nh tÃªn cho aggregation. Báº¡n sáº½ tháº¥y tÃªn nÃ y trong káº¿t quáº£ tráº£ vá» cá»§a yÃªu cáº§u. Äiá»u nÃ y ráº¥t há»¯u Ã­ch khi sá»­ dá»¥ng nhiá»u aggregation trong cÃ¹ng má»™t yÃªu cáº§u, nÃ³ giÃºp báº¡n dá»… dÃ ng hiá»ƒu Ã½ nghÄ©a cá»§a má»—i nhÃ³m káº¿t quáº£.</li>
<li>Cuá»‘i cÃ¹ng, báº¡n pháº£i chá»‰ Ä‘á»‹nh loáº¡i aggregation.</li>
</ul>
<blockquote>
<p>GiÃ¡ trá»‹ phÃ¢n tÃ­ch tá»•ng há»£p cÃ³ thá»ƒ <strong>láº¥y tá»« giÃ¡ trá»‹ cá»§a trÆ°á»ng</strong> hoáº·c lÃ  <strong>káº¿t quáº£ cá»§a script</strong>.</p>
<p>Tuy nhiÃªn, khi sá»­ dá»¥ng káº¿t quáº£ cá»§a script, báº¡n cáº§n chÃº Ã½ Ä‘áº¿n hiá»‡u suáº¥t vÃ  an toÃ n cá»§a script; máº·c dÃ¹ háº§u háº¿t cÃ¡c loáº¡i aggregation Ä‘á»u cho phÃ©p sá»­ dá»¥ng script, nhÆ°ng script lÃ m cháº­m aggregation vÃ¬ script pháº£i cháº¡y trÃªn má»—i tÃ i liá»‡u. Äá»ƒ trÃ¡nh cháº¡y script, báº¡n cÃ³ thá»ƒ tÃ­nh toÃ¡n trong giai Ä‘oáº¡n láº­p chá»‰ má»¥c.</p>
<p>NgoÃ i ra, script cÅ©ng cÃ³ thá»ƒ bá»‹ sá»­ dá»¥ng Ä‘á»ƒ táº¥n cÃ´ng mÃ£ Ä‘á»™c, hÃ£y cá»‘ gáº¯ng sá»­ dá»¥ng ngÃ´n ngá»¯ script trong sandbox.</p>
</blockquote>
<p>VÃ­ dá»¥: Truy váº¥n tuá»•i trung bÃ¬nh cá»§a táº¥t cáº£ cÃ¡c cáº§u thá»§ lÃ  bao nhiÃªu, vÃ  cá»™ng 188 vÃ o má»©c lÆ°Æ¡ng trung bÃ¬nh cá»§a cáº§u thá»§ (cÅ©ng cÃ³ thá»ƒ hiá»ƒu lÃ  má»©c lÆ°Æ¡ng trung bÃ¬nh sau khi cá»™ng thÃªm 188 cho má»—i cáº§u thá»§).</p>
<div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> /player/_search?size=</span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "aggs"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "avg_age"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "avg"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "field"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "age"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    },</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "avg_salary_188"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "avg"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "script"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">          "source"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "doc.salary.value + 188"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>Aggregations chá»‰ sá»‘</h2>
<p>Aggregations chá»‰ sá»‘ (cÃ²n Ä‘Æ°á»£c gá»i lÃ  aggregations Ä‘o lÆ°á»ng) chá»§ yáº¿u rÃºt ra dá»¯ liá»‡u thá»‘ng kÃª tá»« cÃ¡c nhÃ³m tÃ i liá»‡u khÃ¡c nhau, hoáº·c tá»« cÃ¡c thÃ¹ng tÃ i liá»‡u tá»« cÃ¡c aggregations khÃ¡c.</p>
<p>Nhá»¯ng dá»¯ liá»‡u thá»‘ng kÃª nÃ y thÆ°á»ng Ä‘áº¿n tá»« cÃ¡c trÆ°á»ng sá»‘, nhÆ° giÃ¡ trá»‹ nhá» nháº¥t hoáº·c trung bÃ¬nh. NgÆ°á»i dÃ¹ng cÃ³ thá»ƒ láº¥y tá»«ng dá»¯ liá»‡u thá»‘ng kÃª riÃªng láº», hoáº·c cÅ©ng cÃ³ thá»ƒ sá»­ dá»¥ng aggregations stats Ä‘á»ƒ láº¥y chÃºng cÃ¹ng má»™t lÃºc. Dá»¯ liá»‡u thá»‘ng kÃª nÃ¢ng cao hÆ¡n, nhÆ° tá»•ng bÃ¬nh phÆ°Æ¡ng hoáº·c Ä‘á»™ lá»‡ch chuáº©n, cÃ³ thá»ƒ Ä‘Æ°á»£c láº¥y thÃ´ng qua aggregations extended stats.</p>
<h3>Max Aggregation</h3>
<p>Max Aggregation Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thá»‘ng kÃª giÃ¡ trá»‹ lá»›n nháº¥t. VÃ­ dá»¥, Ä‘á»ƒ thá»‘ng kÃª cuá»‘n sÃ¡ch cÃ³ giÃ¡ cao nháº¥t trong chá»‰ má»¥c sales, vÃ  tÃ­nh giÃ¡ trá»‹ gáº¥p Ä‘Ã´i cá»§a giÃ¡ Ä‘Ã³, cÃ¢u truy váº¥n nhÆ° sau:</p>
<div class="language- line-numbers-mode" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET /sales/_search?size=0</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  "aggs" : {</span></span>
<span class="line"><span>    "max_price" : {</span></span>
<span class="line"><span>      "max" : {</span></span>
<span class="line"><span>        "field" : "price"</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    },</span></span>
<span class="line"><span>    "max_price_2" : {</span></span>
<span class="line"><span>      "max" : {</span></span>
<span class="line"><span>        "field" : "price",</span></span>
<span class="line"><span>        "script": {</span></span>
<span class="line"><span>          "source": "_value * 2.0"</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>TrÆ°á»ng Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh, trong script cÃ³ thá»ƒ láº¥y giÃ¡ trá»‹ cá»§a trÆ°á»ng báº±ng _value</strong>.</p>
<p>Káº¿t quáº£ aggregation nhÆ° sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>{</span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span>  "aggregations": {</span></span>
<span class="line"><span>    "max_price": {</span></span>
<span class="line"><span>      "value": 188.0</span></span>
<span class="line"><span>    },</span></span>
<span class="line"><span>    "max_price_2": {</span></span>
<span class="line"><span>      "value": 376.0</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><h3>Min Aggregation</h3>
<p>Min Aggregation Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thá»‘ng kÃª giÃ¡ trá»‹ nhá» nháº¥t. VÃ­ dá»¥, Ä‘á»ƒ thá»‘ng kÃª cuá»‘n sÃ¡ch cÃ³ giÃ¡ tháº¥p nháº¥t trong chá»‰ má»¥c sales, cÃ¢u truy váº¥n nhÆ° sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET /sales/_search?size=0</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  "aggs" : {</span></span>
<span class="line"><span>    "min_price" : {</span></span>
<span class="line"><span>      "min" : {</span></span>
<span class="line"><span>        "field" : "price"</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><p>Káº¿t quáº£ aggregation nhÆ° sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>{</span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span>  "aggregations": {</span></span>
<span class="line"><span>    "min_price": {</span></span>
<span class="line"><span>      "value": 18.0</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><h3>Avg Aggregation</h3>
<p>Avg Aggregation Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ­nh giÃ¡ trá»‹ trung bÃ¬nh. VÃ­ dá»¥, Ä‘á»ƒ thá»‘ng kÃª Ä‘iá»ƒm trung bÃ¬nh cá»§a ká»³ thi trong chá»‰ má»¥c exams, náº¿u khÃ´ng cÃ³ Ä‘iá»ƒm sá»‘, máº·c Ä‘á»‹nh lÃ  60 Ä‘iá»ƒm, cÃ¢u truy váº¥n nhÆ° sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET /exams/_search?size=0</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  "aggs" : {</span></span>
<span class="line"><span>    "avg_grade" : {</span></span>
<span class="line"><span>      "avg" : {</span></span>
<span class="line"><span>        "field" : "grade",</span></span>
<span class="line"><span>        "missing": 60</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><p><strong>Náº¿u trÆ°á»ng chá»‰ Ä‘á»‹nh khÃ´ng cÃ³ giÃ¡ trá»‹, báº¡n cÃ³ thá»ƒ chá»‰ Ä‘á»‹nh giÃ¡ trá»‹ máº·c Ä‘á»‹nh báº±ng missing; náº¿u khÃ´ng chá»‰ Ä‘á»‹nh giÃ¡ trá»‹ máº·c Ä‘á»‹nh, tÃ i liá»‡u thiáº¿u giÃ¡ trá»‹ trÆ°á»ng nÃ y sáº½ bá»‹ bá» qua (tÃ­nh toÃ¡n)</strong>.</p>
<p>Káº¿t quáº£ aggregation nhÆ° sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>{</span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span>  "aggregations": {</span></span>
<span class="line"><span>    "avg_grade": {</span></span>
<span class="line"><span>      "value": 78.0</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><p>NgoÃ i tÃ­nh toÃ¡n aggregation trung bÃ¬nh thÃ´ng thÆ°á»ng, elasticsearch cÅ©ng cung cáº¥p tÃ­nh toÃ¡n aggregation trung bÃ¬nh cÃ³ trá»ng sá»‘, chi tiáº¿t xem táº¡i <a href="https://www.knowledgedict.com/tutorial/elasticsearch-aggregations-metrics-weighted-avg-aggregation.html" target="_blank" rel="noopener noreferrer">Elasticsearch Aggregations chá»‰ sá»‘ - Weighted Avg Aggregation</a>.</p>
<h3>Sum Aggregation</h3>
<p>Sum Aggregation Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ­nh tá»•ng. VÃ­ dá»¥, Ä‘á»ƒ thá»‘ng kÃª tá»•ng giÃ¡ cá»§a cÃ¡c máº·t hÃ ng cÃ³ loáº¡i lÃ  "hat" trong chá»‰ má»¥c sales, cÃ¢u truy váº¥n nhÆ° sau:</p>
<div class="language- line-numbers-mode" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET /sales/_search?size=0</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  "query" : {</span></span>
<span class="line"><span>    "constant_score" : {</span></span>
<span class="line"><span>      "filter" : {</span></span>
<span class="line"><span>        "match" : { "type" : "hat" }</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  },</span></span>
<span class="line"><span>  "aggs" : {</span></span>
<span class="line"><span>    "hat_prices" : {</span></span>
<span class="line"><span>      "sum" : { "field" : "price" }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Káº¿t quáº£ aggregation nhÆ° sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>{</span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span>  "aggregations": {</span></span>
<span class="line"><span>    "hat_prices": {</span></span>
<span class="line"><span>      "value": 567.0</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><h3>Value Count Aggregation</h3>
<p>Value Count Aggregation cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘áº¿m sá»‘ lÆ°á»£ng tÃ i liá»‡u theo trÆ°á»ng. VÃ­ dá»¥, Ä‘á»ƒ Ä‘áº¿m sá»‘ lÆ°á»£ng tÃ i liá»‡u cÃ³ trÆ°á»ng author trong chá»‰ má»¥c books, cÃ¢u truy váº¥n nhÆ° sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET /books/_search?size=0</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  "aggs" : {</span></span>
<span class="line"><span>    "doc_count" : {</span></span>
<span class="line"><span>      "value_count" : { "field" : "author" }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><p>Káº¿t quáº£ aggregation nhÆ° sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>{</span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span>  "aggregations": {</span></span>
<span class="line"><span>    "doc_count": {</span></span>
<span class="line"><span>      "value": 5</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><h3>Cardinality Aggregation</h3>
<p>Cardinality Aggregation Ä‘Æ°á»£c sá»­ dá»¥ng cho thá»‘ng kÃª cÆ¡ sá»Ÿ, nhiá»‡m vá»¥ cá»§a nÃ³ lÃ  thá»±c hiá»‡n cÃ¡c hoáº¡t Ä‘á»™ng tÆ°Æ¡ng tá»± nhÆ° distinct trong SQL, loáº¡i bá» cÃ¡c má»¥c trÃ¹ng láº·p trong táº­p há»£p, sau Ä‘Ã³ Ä‘áº¿m Ä‘á»™ dÃ i cá»§a táº­p há»£p sau khi loáº¡i bá» trÃ¹ng láº·p. VÃ­ dá»¥, thá»±c hiá»‡n hoáº¡t Ä‘á»™ng cardinality trÃªn trÆ°á»ng language trong chá»‰ má»¥c books cÃ³ thá»ƒ Ä‘áº¿m sá»‘ lÆ°á»£ng ngÃ´n ngá»¯ láº­p trÃ¬nh, cÃ¢u truy váº¥n nhÆ° sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET /books/_search?size=0</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  "aggs" : {</span></span>
<span class="line"><span>    "all_lan" : {</span></span>
<span class="line"><span>      "cardinality" : { "field" : "language" }</span></span>
<span class="line"><span>    },</span></span>
<span class="line"><span>    "title_cnt" : {</span></span>
<span class="line"><span>      "cardinality" : { "field" : "title.keyword" }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><p><strong>Giáº£ sá»­ trÆ°á»ng title lÃ  kiá»ƒu vÄƒn báº£n (text), khi loáº¡i bá» trÃ¹ng láº·p, báº¡n cáº§n chá»‰ Ä‘á»‹nh keyword, cÃ³ nghÄ©a lÃ  xem title nhÆ° má»™t thá»ƒ thá»‘ng nháº¥t, tá»©c lÃ  khÃ´ng phÃ¢n tÃ¡ch tá»« Ä‘á»ƒ Ä‘áº¿m</strong>.</p>
<p>Káº¿t quáº£ aggregation nhÆ° sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>{</span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span>  "aggregations": {</span></span>
<span class="line"><span>    "all_lan": {</span></span>
<span class="line"><span>      "value": 8</span></span>
<span class="line"><span>    },</span></span>
<span class="line"><span>    "title_cnt": {</span></span>
<span class="line"><span>      "value": 18</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><h3>Stats Aggregation</h3>
<p>Stats Aggregation Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thá»‘ng kÃª cÆ¡ báº£n, sáº½ tráº£ vá» 5 chá»‰ sá»‘ count, max, min, avg vÃ  sum cÃ¹ng má»™t lÃºc. VÃ­ dá»¥, Ä‘á»ƒ thá»‘ng kÃª cÆ¡ báº£n liÃªn quan Ä‘áº¿n Ä‘iá»ƒm sá»‘ trÃªn trÆ°á»ng grade trong chá»‰ má»¥c exams, cÃ¢u truy váº¥n nhÆ° sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET /exams/_search?size=0</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  "aggs" : {</span></span>
<span class="line"><span>    "grades_stats" : {</span></span>
<span class="line"><span>      "stats" : { "field" : "grade" }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><p>Káº¿t quáº£ aggregation nhÆ° sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>{</span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span>  "aggregations": {</span></span>
<span class="line"><span>    "grades_stats": {</span></span>
<span class="line"><span>      "count": 2,</span></span>
<span class="line"><span>      "min": 50.0,</span></span>
<span class="line"><span>      "max": 100.0,</span></span>
<span class="line"><span>      "avg": 75.0,</span></span>
<span class="line"><span>      "sum": 150.0</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><h3>Extended Stats Aggregation</h3>
<p>Extended Stats Aggregation Ä‘Æ°á»£c sá»­ dá»¥ng cho thá»‘ng kÃª nÃ¢ng cao, tÆ°Æ¡ng tá»± nhÆ° thá»‘ng kÃª cÆ¡ báº£n, nhÆ°ng sáº½ cÃ³ thÃªm má»™t sá»‘ káº¿t quáº£ thá»‘ng kÃª sau, sum_of_squares (tá»•ng bÃ¬nh phÆ°Æ¡ng), variance (phÆ°Æ¡ng sai), std_deviation (Ä‘á»™ lá»‡ch chuáº©n), std_deviation_bounds (khoáº£ng giá»¯a giÃ¡ trá»‹ trung bÃ¬nh cá»™ng/trá»« hai Ä‘á»™ lá»‡ch chuáº©n). Äá»ƒ thá»‘ng kÃª nÃ¢ng cao liÃªn quan Ä‘áº¿n Ä‘iá»ƒm sá»‘ trÃªn trÆ°á»ng grade trong chá»‰ má»¥c exams, cÃ¢u truy váº¥n nhÆ° sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET /exams/_search?size=0</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  "aggs" : {</span></span>
<span class="line"><span>    "grades_stats" : {</span></span>
<span class="line"><span>      "extended_stats" : { "field" : "grade" }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><p>Káº¿t quáº£ aggregation nhÆ° sau:</p>
<div class="language- line-numbers-mode" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>{</span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span>  "aggregations": {</span></span>
<span class="line"><span>    "grades_stats": {</span></span>
<span class="line"><span>      "count": 2,</span></span>
<span class="line"><span>      "min": 50.0,</span></span>
<span class="line"><span>      "max": 100.0,</span></span>
<span class="line"><span>      "avg": 75.0,</span></span>
<span class="line"><span>      "sum": 150.0,</span></span>
<span class="line"><span>      "sum_of_squares": 12500.0,</span></span>
<span class="line"><span>      "variance": 625.0,</span></span>
<span class="line"><span>      "std_deviation": 25.0,</span></span>
<span class="line"><span>      "std_deviation_bounds": {</span></span>
<span class="line"><span>        "upper": 125.0,</span></span>
<span class="line"><span>        "lower": 25.0</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>Percentiles Aggregation</h3>
<p>Percentiles Aggregation Ä‘Æ°á»£c sá»­ dá»¥ng cho thá»‘ng kÃª phÃ¢n vá»‹. PhÃ¢n vá»‹ lÃ  má»™t thuáº­t ngá»¯ thá»‘ng kÃª, náº¿u ta sáº¯p xáº¿p má»™t táº­p dá»¯ liá»‡u tá»« lá»›n Ä‘áº¿n nhá» vÃ  tÃ­nh toÃ¡n pháº§n trÄƒm lÅ©y káº¿ tÆ°Æ¡ng á»©ng, giÃ¡ trá»‹ cá»§a dá»¯ liá»‡u tÆ°Æ¡ng á»©ng vá»›i phÃ¢n vá»‹ Ä‘Ã³ Ä‘Æ°á»£c gá»i lÃ  phÃ¢n vá»‹ cá»§a phÃ¢n vá»‹ Ä‘Ã³. Theo máº·c Ä‘á»‹nh, cÃ¡c phÃ¢n vá»‹ lÅ©y káº¿ lÃ  [ 1, 5, 25, 50, 75, 95, 99 ]. VÃ­ dá»¥ sau Ä‘Ã¢y cho tháº¥y cÃ¡ch thá»‘ng kÃª phÃ¢n vá»‹ thá»i gian táº£i trÃªn trÆ°á»ng load_time trong chá»‰ má»¥c latency, cÃ¢u truy váº¥n nhÆ° sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET latency/_search</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  "size": 0,</span></span>
<span class="line"><span>  "aggs" : {</span></span>
<span class="line"><span>    "load_time_outlier" : {</span></span>
<span class="line"><span>      "percentiles" : {</span></span>
<span class="line"><span>        "field" : "load_time"</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><p><strong>Cáº§n lÆ°u Ã½ ráº±ng, trÆ°á»ng <code>load_time</code> nhÆ° trÃªn pháº£i lÃ  loáº¡i sá»‘</strong>.</p>
<p>Káº¿t quáº£ tá»•ng há»£p nhÆ° sau:</p>
<div class="language- line-numbers-mode" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>{</span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span>  "aggregations": {</span></span>
<span class="line"><span>    "load_time_outlier": {</span></span>
<span class="line"><span>      "values" : {</span></span>
<span class="line"><span>        "1.0": 5.0,</span></span>
<span class="line"><span>        "5.0": 25.0,</span></span>
<span class="line"><span>        "25.0": 165.0,</span></span>
<span class="line"><span>        "50.0": 445.0,</span></span>
<span class="line"><span>        "75.0": 725.0,</span></span>
<span class="line"><span>        "95.0": 945.0,</span></span>
<span class="line"><span>        "99.0": 985.0</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Thá»‘ng kÃª phÃ¢n vá»‹ cÅ©ng cÃ³ thá»ƒ chá»‰ Ä‘á»‹nh tham sá»‘ percents Ä‘á»ƒ chá»‰ Ä‘á»‹nh phÃ¢n vá»‹, nhÆ° sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET latency/_search</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  "size": 0,</span></span>
<span class="line"><span>  "aggs" : {</span></span>
<span class="line"><span>    "load_time_outlier" : {</span></span>
<span class="line"><span>      "percentiles" : {</span></span>
<span class="line"><span>        "field" : "load_time",</span></span>
<span class="line"><span>        "percents": [60, 80, 95]</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><h3>Percentiles Ranks Aggregation</h3>
<p>Percentiles Ranks Aggregation cÃ³ Ã½ nghÄ©a ngÆ°á»£c láº¡i vá»›i Percentiles Aggregation, Ä‘Ã³ lÃ  muá»‘n xem giÃ¡ trá»‹ hiá»‡n táº¡i náº±m trong pháº¡m vi nÃ o (phÃ¢n vá»‹). Giáº£ sá»­ báº¡n kiá»ƒm tra xem giÃ¡ trá»‹ hiá»‡n táº¡i 500 vÃ  600 náº±m á»Ÿ phÃ¢n vá»‹ nÃ o, phÃ¡t hiá»‡n ra lÃ  90.01 vÃ  100, Ä‘iá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ  90.01% cá»§a cÃ¡c giÃ¡ trá»‹ Ä‘á»u náº±m trong pháº¡m vi 500, vÃ  100% cá»§a cÃ¡c giÃ¡ trá»‹ náº±m trong pháº¡m vi 600.</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET latency/_search</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  "size": 0,</span></span>
<span class="line"><span>    "aggs" : {</span></span>
<span class="line"><span>      "load_time_ranks" : {</span></span>
<span class="line"><span>        "percentile_ranks" : {</span></span>
<span class="line"><span>          "field" : "load_time",</span></span>
<span class="line"><span>          "values" : [500, 600]</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><p><strong>TrÆ°á»ng <code>load_time</code> cÅ©ng pháº£i lÃ  loáº¡i sá»‘</strong>.</p>
<p>Káº¿t quáº£ tráº£ vá» sáº½ tÆ°Æ¡ng tá»± nhÆ° sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>{</span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span>  "aggregations": {</span></span>
<span class="line"><span>    "load_time_ranks": {</span></span>
<span class="line"><span>      "values" : {</span></span>
<span class="line"><span>        "500.0": 90.01,</span></span>
<span class="line"><span>        "600.0": 100.0</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><p>Báº¡n cÃ³ thá»ƒ Ä‘áº·t tham sá»‘ <code>keyed</code> lÃ  <code>true</code> Ä‘á»ƒ tráº£ vá» cÃ¡c giÃ¡ trá»‹ tÆ°Æ¡ng á»©ng nhÆ° lÃ  key cá»§a cÃ¡c bucket, máº·c Ä‘á»‹nh lÃ  <code>false</code>.</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET latency/_search</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  "size": 0,</span></span>
<span class="line"><span>  "aggs": {</span></span>
<span class="line"><span>    "load_time_ranks": {</span></span>
<span class="line"><span>      "percentile_ranks": {</span></span>
<span class="line"><span>        "field": "load_time",</span></span>
<span class="line"><span>        "values": [500, 600],</span></span>
<span class="line"><span>        "keyed": true</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><p>Káº¿t quáº£ tráº£ vá» nhÆ° sau:</p>
<div class="language- line-numbers-mode" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>{</span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span>  "aggregations": {</span></span>
<span class="line"><span>    "load_time_ranks": {</span></span>
<span class="line"><span>      "values": [</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>          "key": 500.0,</span></span>
<span class="line"><span>          "value": 90.01</span></span>
<span class="line"><span>        },</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>          "key": 600.0,</span></span>
<span class="line"><span>          "value": 100.0</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>      ]</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>Bucket Aggregation</h2>
<p>Bucket cÃ³ thá»ƒ Ä‘Æ°á»£c hiá»ƒu nhÆ° má»™t cÃ¡i thÃ¹ng, nÃ³ sáº½ duyá»‡t qua ná»™i dung cá»§a tÃ i liá»‡u, nhá»¯ng gÃ¬ phÃ¹ há»£p vá»›i má»™t yÃªu cáº§u nháº¥t Ä‘á»‹nh sáº½ Ä‘Æ°á»£c Ä‘áº·t vÃ o má»™t thÃ¹ng, phÃ¢n thÃ¹ng tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i group by trong SQL. Tá»« má»™t gÃ³c Ä‘á»™ khÃ¡c, báº¡n cÃ³ thá»ƒ xem metric aggregation nhÆ° lÃ  bucket aggregation Ä‘Æ¡n, tá»©c lÃ  Ä‘áº·t táº¥t cáº£ tÃ i liá»‡u vÃ o má»™t thÃ¹ng, trong khi bucket aggregation lÃ  multi-bucket aggregation, nÃ³ phÃ¢n nhÃ³m theo cÃ¡c Ä‘iá»u kiá»‡n tÆ°Æ¡ng á»©ng.</p>
<p>| Loáº¡i                          | MÃ´ táº£/TrÆ°á»ng há»£p sá»­ dá»¥ng                                                                                                                                                                                |<br>
| :</p>
]]></content:encoded>
    </item>
    <item>
      <title>Elasticsearch Analyzer</title>
      <link>https://vanhung4499.github.io/database/elasticsearch/analyzer.html</link>
      <guid>https://vanhung4499.github.io/database/elasticsearch/analyzer.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Elasticsearch Analyzer</source>
      <description>Elasticsearch Analyzer PhÃ¢n tÃ­ch vÄƒn báº£n lÃ  quÃ¡ trÃ¬nh chuyá»ƒn Ä‘á»•i toÃ n bá»™ vÄƒn báº£n thÃ nh má»™t chuá»—i cÃ¡c tá»« (term/token), cÃ²n Ä‘Æ°á»£c gá»i lÃ  phÃ¢n tá»«. Trong Elasticsearch, phÃ¢n tá»« Ä‘Æ°á»£c ...</description>
      <category>elasticssearch</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<p>PhÃ¢n tÃ­ch vÄƒn báº£n lÃ  quÃ¡ trÃ¬nh chuyá»ƒn Ä‘á»•i toÃ n bá»™ vÄƒn báº£n thÃ nh má»™t chuá»—i cÃ¡c tá»« (term/token), cÃ²n Ä‘Æ°á»£c gá»i lÃ  phÃ¢n tá»«. Trong Elasticsearch, phÃ¢n tá»« Ä‘Æ°á»£c thá»±c hiá»‡n thÃ´ng qua analyzer (bá»™ phÃ¢n tÃ­ch), dÃ¹ lÃ  chá»‰ má»¥c hay tÃ¬m kiáº¿m, Ä‘á»u cáº§n sá»­ dá»¥ng analyzer (bá»™ phÃ¢n tÃ­ch). Bá»™ phÃ¢n tÃ­ch, chia thÃ nh&nbsp;<strong>bá»™ phÃ¢n tÃ­ch Ä‘Æ°á»£c xÃ¢y dá»±ng sáºµn</strong>&nbsp;vÃ &nbsp;<strong>bá»™ phÃ¢n tÃ­ch tÃ¹y chá»‰nh</strong>.</p>
<p>Bá»™ phÃ¢n tÃ­ch cÃ³ thá»ƒ Ä‘Æ°á»£c phÃ¢n loáº¡i thÃ nh ba pháº§n lÃ &nbsp;<strong>bá»™ lá»c kÃ½ tá»±</strong>(<strong>Character Filters</strong>),&nbsp;<strong>bá»™ phÃ¢n tá»«</strong>&nbsp;(<strong>Tokenizer</strong>) vÃ &nbsp;<strong>bá»™ lá»c tá»«</strong>&nbsp;(<strong>Token Filters</strong>). Thá»© tá»± thá»±c thi cá»§a nÃ³ nhÆ° sau:</p>
<p><strong><em>character filters</em></strong>&nbsp;-&gt;&nbsp;<strong><em>tokenizer</em></strong>&nbsp;-&gt;&nbsp;<strong><em>token filters</em></strong></p>
<h2>Bá»™ lá»c kÃ½ tá»± (Character Filters)</h2>
<p>Bá»™ lá»c kÃ½ tá»± nháº­n Ä‘áº§u vÃ o lÃ  vÄƒn báº£n gá»‘c, náº¿u cáº¥u hÃ¬nh nhiá»u hÆ¡n, nÃ³ sáº½ thá»±c hiá»‡n theo thá»© tá»± cáº¥u hÃ¬nh. Hiá»‡n táº¡i ES cÃ³ 3 loáº¡i bá»™ lá»c kÃ½ tá»± chÃ­nh:</p>
<ol>
<li><strong>html strip character filter</strong>: Loáº¡i bá» cÃ¡c pháº§n tá»­ HTML khá»i vÄƒn báº£n vÃ  thay tháº¿ cÃ¡c thá»±c thá»ƒ HTML báº±ng giÃ¡ trá»‹ giáº£i mÃ£ cá»§a chÃºng (vÃ­ dá»¥, thay tháº¿ <strong><em><code>ï¼†amp;</code></em></strong> báº±ng <strong><em><code>ï¼†</code></em></strong>).</li>
<li><strong>mapping character filter</strong>: Tá»± Ä‘á»‹nh nghÄ©a má»™t báº£n Ä‘á»“ Ã¡nh xáº¡, cÃ³ thá»ƒ thá»±c hiá»‡n má»™t sá»‘ thay tháº¿ tÃ¹y chá»‰nh, nhÆ° thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thay Ä‘á»•i chá»¯ hoa thÃ nh chá»¯ thÆ°á»ng cÅ©ng cÃ³ thá»ƒ Ä‘Æ°á»£c thiáº¿t láº­p táº¡i Ä‘Ã¢y.</li>
<li><strong>pattern replace character filter</strong>: Sá»­ dá»¥ng biá»ƒu thá»©c chÃ­nh quy java Ä‘á»ƒ khá»›p cÃ¡c kÃ½ tá»± cáº§n thay tháº¿ báº±ng chuá»—i thay tháº¿ Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh, ngoÃ i ra, chuá»—i thay tháº¿ cÃ³ thá»ƒ tham chiáº¿u Ä‘áº¿n nhÃ³m báº¯t trong biá»ƒu thá»©c chÃ­nh quy.</li>
</ol>
<h3>HTML strip character filter</h3>
<p>VÃ­ dá»¥ vá» HTML strip:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_analyze</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "tokenizer"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "keyword",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "char_filter"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "html_strip"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  ],</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "text"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "&lt;p&gt;I&amp;apos;m so &lt;b&gt;happy&lt;/b&gt;!&lt;/p&gt;"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><p>Sau khi xá»­ lÃ½ báº±ng bá»™ lá»c kÃ½ tá»± <strong><em><code>html_strip</code></em></strong>, Ä‘áº§u ra nhÆ° sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>[ \nI'm so happy!\n ]</span></span></code></pre>
</div><h3>Mapping character filter</h3>
<p>Mapping character filter nháº­n má»™t báº£n Ä‘á»“ Ã¡nh xáº¡ giá»¯a khÃ³a vÃ  giÃ¡ trá»‹ (key =&gt; value) nhÆ° tham sá»‘ cáº¥u hÃ¬nh, má»—i khi gáº·p má»™t chuá»—i trong vÄƒn báº£n gá»‘c giá»‘ng vá»›i khÃ³a trong báº£n Ä‘á»“ Ã¡nh xáº¡, nÃ³ sáº½ thay tháº¿ chuá»—i Ä‘Ã³ báº±ng giÃ¡ trá»‹ tÆ°Æ¡ng á»©ng cá»§a khÃ³a.</p>
<p>Viá»‡c khá»›p chuá»—i trong vÄƒn báº£n gá»‘c vá»›i khÃ³a trong báº£n Ä‘á»“ Ã¡nh xáº¡ lÃ  tham lam, náº¿u cÃ³ sá»± chá»“ng chÃ©o giá»¯a cÃ¡c khÃ³a trong báº£n Ä‘á»“ Ã¡nh xáº¡, nÃ³ sáº½ Æ°u tiÃªn <strong>khá»›p khÃ³a dÃ i nháº¥t</strong>. CÅ©ng cÃ³ thá»ƒ thay tháº¿ báº±ng chuá»—i rá»—ng.</p>
<p>mapping char_filter khÃ´ng giá»‘ng nhÆ° html_strip cÃ³ thá»ƒ sá»­ dá»¥ng ngay láº­p tá»©c, nÃ³ cáº§n Ä‘Æ°á»£c cáº¥u hÃ¬nh trÆ°á»›c khi sá»­ dá»¥ng, nÃ³ cÃ³ hai thuá»™c tÃ­nh cÃ³ thá»ƒ cáº¥u hÃ¬nh:</p>
<p>| TÃªn tham sá»‘              | MÃ´ táº£ tham sá»‘                                                                                       |<br>
| :</p>
]]></content:encoded>
    </item>
    <item>
      <title>Elasticsearch Cluster and Shard</title>
      <link>https://vanhung4499.github.io/database/elasticsearch/cluster-shard.html</link>
      <guid>https://vanhung4499.github.io/database/elasticsearch/cluster-shard.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Elasticsearch Cluster and Shard</source>
      <description>Elasticsearch Clusters vÃ  Shards Clusters Cluster trá»‘ng Náº¿u chÃºng ta khá»Ÿi Ä‘á»™ng má»™t nÃºt Ä‘Æ¡n láº» khÃ´ng chá»©a báº¥t ká»³ dá»¯ liá»‡u hay chá»‰ má»¥c nÃ o, cluster cá»§a chÃºng ta sáº½ trÃ´ng nhÆ° má»™t cl...</description>
      <category>elasticssearch</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>Clusters</h2>
<h3>Cluster trá»‘ng</h3>
<p>Náº¿u chÃºng ta khá»Ÿi Ä‘á»™ng má»™t nÃºt Ä‘Æ¡n láº» khÃ´ng chá»©a báº¥t ká»³ dá»¯ liá»‡u hay chá»‰ má»¥c nÃ o, cluster cá»§a chÃºng ta sáº½ trÃ´ng nhÆ° má»™t cluster vá»›i má»™t nÃºt ná»™i dung trá»‘ng.</p>
<p><strong>HÃ¬nh 1. Cluster vá»›i nÃºt ná»™i dung trá»‘ng</strong></p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/elas_0201.png" alt="Cluster vá»›i nÃºt ná»™i dung trá»‘ng" tabindex="0" loading="lazy"><figcaption>Cluster vá»›i nÃºt ná»™i dung trá»‘ng</figcaption></figure>
<p>HÃ¬nh 1: Cluster chá»‰ cÃ³ má»™t nÃºt trá»‘ng</p>
<p>Má»™t thá»±c thá»ƒ Elasticsearch Ä‘ang cháº¡y Ä‘Æ°á»£c gá»i lÃ  má»™t <strong>nÃºt</strong>, vÃ  má»™t <strong>cluster</strong> bao gá»“m má»™t hoáº·c nhiá»u nÃºt vá»›i cáº¥u hÃ¬nh <code>cluster.name</code> giá»‘ng nhau. ChÃºng cÃ¹ng nhau chá»‹u Ã¡p lá»±c cá»§a dá»¯ liá»‡u vÃ  táº£i. Khi cÃ¡c nÃºt Ä‘Æ°á»£c thÃªm vÃ o hoáº·c loáº¡i bá» khá»i cluster, cluster sáº½ phÃ¢n phá»‘i láº¡i táº¥t cáº£ dá»¯ liá»‡u má»™t cÃ¡ch Ä‘á»u.</p>
<p>Khi má»™t nÃºt Ä‘Æ°á»£c báº§u lÃ m <strong>nÃºt chÃ­nh</strong>, nÃ³ chá»‹u trÃ¡ch nhiá»‡m quáº£n lÃ½ <strong>táº¥t cáº£ cÃ¡c thay Ä‘á»•i</strong> trong pháº¡m vi cluster, cháº³ng háº¡n nhÆ° thÃªm hoáº·c xÃ³a chá»‰ má»¥c, hoáº·c thÃªm hoáº·c xÃ³a cÃ¡c nÃºt, v.v. NÃºt chÃ­nh khÃ´ng cáº§n tham gia vÃ o cÃ¡c thay Ä‘á»•i cáº¥p Ä‘á»™ tÃ i liá»‡u vÃ  tÃ¬m kiáº¿m, vÃ¬ váº­y ngay cáº£ khi lÆ°u lÆ°á»£ng tÄƒng lÃªn, nÃ³ sáº½ khÃ´ng trá»Ÿ thÃ nh má»™t nÃºt cá»• chai khi cluster chá»‰ cÃ³ má»™t nÃºt chÃ­nh. Báº¥t ká»³ nÃºt nÃ o cÅ©ng cÃ³ thá»ƒ trá»Ÿ thÃ nh nÃºt chÃ­nh. Cluster máº«u cá»§a chÃºng ta chá»‰ cÃ³ má»™t nÃºt, vÃ¬ váº­y nÃ³ cÅ©ng trá»Ÿ thÃ nh nÃºt chÃ­nh.</p>
<p>LÃ  ngÆ°á»i dÃ¹ng, chÃºng ta cÃ³ thá»ƒ gá»­i yÃªu cáº§u Ä‘áº¿n báº¥t ká»³ nÃºt nÃ o trong cluster, bao gá»“m cáº£ nÃºt chÃ­nh. Má»—i nÃºt Ä‘á»u biáº¿t vá»‹ trÃ­ cá»§a báº¥t ká»³ tÃ i liá»‡u nÃ o vÃ  cÃ³ thá»ƒ chuyá»ƒn tiáº¿p yÃªu cáº§u cá»§a chÃºng ta trá»±c tiáº¿p Ä‘áº¿n nÃºt lÆ°u trá»¯ tÃ i liá»‡u mÃ  chÃºng ta cáº§n. KhÃ´ng quan trá»ng chÃºng ta gá»­i yÃªu cáº§u Ä‘áº¿n nÃºt nÃ o, nÃºt Ä‘Ã³ cÃ³ thá»ƒ chá»‹u trÃ¡ch nhiá»‡m thu tháº­p dá»¯ liá»‡u tá»« táº¥t cáº£ cÃ¡c nÃºt chá»©a tÃ i liá»‡u mÃ  chÃºng ta cáº§n vÃ  tráº£ káº¿t quáº£ cuá»‘i cÃ¹ng cho mÃ¡y khÃ¡ch. Elasticsearch quáº£n lÃ½ táº¥t cáº£ má»i thá»© nÃ y má»™t cÃ¡ch trong suá»‘t.</p>
<h3>Cluster Health</h3>
<p>ThÃ´ng tin giÃ¡m sÃ¡t cluster cá»§a Elasticsearch chá»©a nhiá»u dá»¯ liá»‡u thá»‘ng kÃª, trong Ä‘Ã³ quan trá»ng nháº¥t lÃ  <em>sá»©c khá»e cá»§a cluster</em>, Ä‘Æ°á»£c hiá»ƒn thá»‹ lÃ  <code>green</code>, <code>yellow</code>, hoáº·c <code>red</code> trong trÆ°á»ng <code>status</code>.</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_cluster/health</span></span></code></pre>
</div><p>Trong má»™t cluster trá»‘ng khÃ´ng chá»©a báº¥t ká»³ chá»‰ má»¥c nÃ o, nÃ³ sáº½ cÃ³ ná»™i dung tráº£ vá» tÆ°Æ¡ng tá»± nhÆ° sau:</p>
<div class="language-json" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "cluster_name"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"elasticsearch"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "status"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"green"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "timed_out"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">false</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "number_of_nodes"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "number_of_data_nodes"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "active_primary_shards"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "active_shards"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "relocating_shards"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "initializing_shards"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "unassigned_shards"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><p>TrÆ°á»ng <code>status</code> chá»‰ ra liá»‡u cluster hiá»‡n táº¡i cÃ³ hoáº¡t Ä‘á»™ng bÃ¬nh thÆ°á»ng tá»•ng thá»ƒ hay khÃ´ng. Ba mÃ u cá»§a nÃ³ cÃ³ Ã½ nghÄ©a nhÆ° sau:</p>
<ul>
<li><strong><code>green</code></strong>: Táº¥t cáº£ cÃ¡c shard chÃ­nh vÃ  shard phá»¥ Ä‘á»u hoáº¡t Ä‘á»™ng bÃ¬nh thÆ°á»ng.</li>
<li><strong><code>yellow</code></strong>: Táº¥t cáº£ cÃ¡c shard chÃ­nh Ä‘á»u hoáº¡t Ä‘á»™ng bÃ¬nh thÆ°á»ng, nhÆ°ng khÃ´ng pháº£i táº¥t cáº£ cÃ¡c shard phá»¥ Ä‘á»u hoáº¡t Ä‘á»™ng bÃ¬nh thÆ°á»ng.</li>
<li><strong><code>red</code></strong>: CÃ³ shard chÃ­nh khÃ´ng hoáº¡t Ä‘á»™ng bÃ¬nh thÆ°á»ng.</li>
</ul>
<h3>ThÃªm chá»‰ má»¥c</h3>
<p>Khi chÃºng ta thÃªm dá»¯ liá»‡u vÃ o Elasticsearch, chÃºng ta cáº§n sá»­ dá»¥ng <em>chá»‰ má»¥c</em> - nÆ¡i lÆ°u trá»¯ dá»¯ liá»‡u liÃªn quan. Chá»‰ má»¥c thá»±c ra lÃ  khÃ´ng gian tÃªn logic trá» Ä‘áº¿n má»™t hoáº·c nhiá»u shard váº­t lÃ½.</p>
<p>Má»™t <em>shard</em> lÃ  má»™t <em>Ä‘Æ¡n vá»‹ cÃ´ng viá»‡c</em> cÆ¡ báº£n, nÃ³ chá»‰ lÆ°u trá»¯ má»™t pháº§n cá»§a táº¥t cáº£ dá»¯ liá»‡u. BÃ¢y giá» chÃºng ta chá»‰ cáº§n biáº¿t má»™t shard lÃ  má»™t thá»ƒ hiá»‡n cá»§a Lucene, vÃ  nÃ³ chÃ­nh lÃ  má»™t cÃ´ng cá»¥ tÃ¬m kiáº¿m hoÃ n chá»‰nh. TÃ i liá»‡u cá»§a chÃºng ta Ä‘Æ°á»£c lÆ°u trá»¯ vÃ  chá»‰ má»¥c trong shard, nhÆ°ng á»©ng dá»¥ng thá»±c hiá»‡n tÆ°Æ¡ng tÃ¡c trá»±c tiáº¿p vá»›i chá»‰ má»¥c chá»© khÃ´ng pháº£i vá»›i shard.</p>
<p>Elasticsearch sá»­ dá»¥ng shard Ä‘á»ƒ phÃ¢n phá»‘i dá»¯ liá»‡u Ä‘áº¿n cÃ¡c nÆ¡i khÃ¡c nhau trong cluster. shard lÃ  bá»™ chá»©a dá»¯ liá»‡u, tÃ i liá»‡u Ä‘Æ°á»£c lÆ°u trá»¯ trong shard, vÃ  shard Ä‘Æ°á»£c phÃ¢n bá»• Ä‘áº¿n cÃ¡c nÃºt khÃ¡c nhau trong cluster. Khi kÃ­ch thÆ°á»›c cá»§a cluster cá»§a báº¡n má»Ÿ rá»™ng hoáº·c thu háº¹p, Elasticsearch sáº½ tá»± Ä‘á»™ng di chuyá»ƒn shard giá»¯a cÃ¡c nÃºt, Ä‘á»ƒ dá»¯ liá»‡u váº«n Ä‘Æ°á»£c phÃ¢n phá»‘i Ä‘á»u trong cluster.</p>
<p>Má»™t shard cÃ³ thá»ƒ lÃ  shard <em>chÃ­nh</em> hoáº·c shard <em>sao lÆ°u</em>. Báº¥t ká»³ tÃ i liá»‡u nÃ o trong chá»‰ má»¥c Ä‘á»u thuá»™c vá» má»™t shard chÃ­nh, vÃ¬ váº­y sá»‘ lÆ°á»£ng shard chÃ­nh quyáº¿t Ä‘á»‹nh lÆ°á»£ng dá»¯ liá»‡u tá»‘i Ä‘a mÃ  chá»‰ má»¥c cÃ³ thá»ƒ lÆ°u trá»¯.</p>
<blockquote>
<p>Ká»¹ thuáº­t, má»™t shard chÃ­nh cÃ³ thá»ƒ lÆ°u trá»¯ tá»‘i Ä‘a <code>Integer.MAX_VALUE - 128</code> tÃ i liá»‡u, nhÆ°ng giÃ¡ trá»‹ tá»‘i Ä‘a thá»±c táº¿ cÃ²n phá»¥ thuá»™c vÃ o tÃ¬nh huá»‘ng sá»­ dá»¥ng cá»§a báº¡n: bao gá»“m pháº§n cá»©ng báº¡n sá»­ dá»¥ng, kÃ­ch thÆ°á»›c vÃ  Ä‘á»™ phá»©c táº¡p cá»§a tÃ i liá»‡u, cÃ¡ch chá»‰ má»¥c vÃ  truy váº¥n tÃ i liá»‡u cÅ©ng nhÆ° thá»i gian pháº£n há»“i mong Ä‘á»£i cá»§a báº¡n.</p>
</blockquote>
<p>Má»™t shard sao lÆ°u chá»‰ lÃ  má»™t báº£n sao cá»§a shard chÃ­nh. shard sao lÆ°u Ä‘Ã³ng vai trÃ² lÃ  báº£n sao dá»± phÃ²ng dÆ° thá»«a Ä‘á»ƒ báº£o vá»‡ dá»¯ liá»‡u khÃ´ng bá»‹ máº¥t khi xáº£y ra lá»—i pháº§n cá»©ng, vÃ  cung cáº¥p dá»‹ch vá»¥ cho cÃ¡c hoáº¡t Ä‘á»™ng Ä‘á»c nhÆ° tÃ¬m kiáº¿m vÃ  tráº£ vá» tÃ i liá»‡u.</p>
<p>Sá»‘ shard chÃ­nh Ä‘Ã£ Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh khi táº¡o chá»‰ má»¥c, nhÆ°ng sá»‘ shard sao lÆ°u cÃ³ thá»ƒ Ä‘Æ°á»£c thay Ä‘á»•i báº¥t cá»© lÃºc nÃ o.</p>
<p>HÃ£y táº¡o má»™t chá»‰ má»¥c cÃ³ tÃªn <code>blogs</code> trong má»™t cluster vá»›i má»™t nÃºt trá»‘ng. Theo máº·c Ä‘á»‹nh, chá»‰ má»¥c sáº½ Ä‘Æ°á»£c phÃ¢n bá»• 5 shard chÃ­nh, nhÆ°ng vÃ¬ má»¥c Ä‘Ã­ch minh há»a, chÃºng tÃ´i sáº½ phÃ¢n bá»• 3 shard chÃ­nh vÃ  má»™t báº£n sao (má»—i shard chÃ­nh cÃ³ má»™t shard sao lÆ°u):</p>
<div class="language-json" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">PUT /blogs</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">   "settings"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "number_of_shards"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#D19A66;--shiki-dark:#D19A66">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "number_of_replicas"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">   }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><p>Cluster cá»§a chÃºng ta hiá»‡n táº¡i lÃ  <em>má»™t cluster Ä‘Æ¡n nÃºt cÃ³ má»™t chá»‰ má»¥c</em>. Táº¥t cáº£ 3 shard chÃ­nh Ä‘á»u Ä‘Æ°á»£c phÃ¢n bá»• táº¡i <code>Node 1</code>.</p>
<p><strong>HÃ¬nh 2. Cluster Ä‘Æ¡n nÃºt cÃ³ má»™t chá»‰ má»¥c</strong></p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/elas_0202.png" alt="Cluster Ä‘Æ¡n nÃºt cÃ³ má»™t chá»‰ má»¥c" tabindex="0" loading="lazy"><figcaption>Cluster Ä‘Æ¡n nÃºt cÃ³ má»™t chá»‰ má»¥c</figcaption></figure>
<p>Náº¿u chÃºng ta kiá»ƒm tra sá»©c khá»e cá»§a cluster ngay bÃ¢y giá», chÃºng ta sáº½ tháº¥y ná»™i dung sau:</p>
<div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "cluster_name"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"elasticsearch"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "status"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"yellow"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "timed_out"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">false</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "number_of_nodes"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "number_of_data_nodes"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "active_primary_shards"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "active_shards"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "relocating_shards"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "initializing_shards"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "unassigned_shards"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "delayed_unassigned_shards"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "number_of_pending_tasks"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "number_of_in_flight_fetch"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "task_max_waiting_in_queue_millis"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "active_shards_percent_as_number"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">50</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul>
<li>GiÃ¡ trá»‹ status cá»§a cluster lÃ  yellow</li>
<li>Sá»‘ lÆ°á»£ng shard sao lÆ°u khÃ´ng Ä‘Æ°á»£c phÃ¢n bá»• cho báº¥t ká»³ nÃºt nÃ o</li>
</ul>
<p>Sá»©c khá»e cá»§a cluster á»Ÿ tráº¡ng thÃ¡i <code>yellow</code> cÃ³ nghÄ©a lÃ  táº¥t cáº£ cÃ¡c shard <em>chÃ­nh</em> Ä‘á»u hoáº¡t Ä‘á»™ng bÃ¬nh thÆ°á»ng (cluster cÃ³ thá»ƒ phá»¥c vá»¥ táº¥t cáº£ cÃ¡c yÃªu cáº§u), nhÆ°ng khÃ´ng pháº£i táº¥t cáº£ cÃ¡c shard <em>sao lÆ°u</em> Ä‘á»u á»Ÿ tráº¡ng thÃ¡i bÃ¬nh thÆ°á»ng. Thá»±c táº¿, táº¥t cáº£ 3 shard sao lÆ°u Ä‘á»u lÃ  <code>unassigned</code> - chÃºng khÃ´ng Ä‘Æ°á»£c phÃ¢n bá»• cho báº¥t ká»³ nÃºt nÃ o. Viá»‡c lÆ°u trá»¯ dá»¯ liá»‡u gá»‘c vÃ  báº£n sao trÃªn cÃ¹ng má»™t nÃºt khÃ´ng cÃ³ Ã½ nghÄ©a, bá»Ÿi vÃ¬ má»™t khi chÃºng ta máº¥t nÃºt Ä‘Ã³, chÃºng ta cÅ©ng sáº½ máº¥t táº¥t cáº£ dá»¯ liá»‡u báº£n sao trÃªn nÃºt Ä‘Ã³.</p>
<p>Hiá»‡n táº¡i, cluster cá»§a chÃºng ta Ä‘ang hoáº¡t Ä‘á»™ng bÃ¬nh thÆ°á»ng, nhÆ°ng cÃ³ nguy cÆ¡ máº¥t dá»¯ liá»‡u khi xáº£y ra lá»—i pháº§n cá»©ng.</p>
<h3>ThÃªm kháº£ nÄƒng chuyá»ƒn Ä‘á»•i khi gáº·p sá»± cá»‘</h3>
<p>Khi chá»‰ cÃ³ má»™t nÃºt Ä‘ang hoáº¡t Ä‘á»™ng trong cluster, Ä‘iá»u nÃ y cÃ³ nghÄ©a lÃ  sáº½ cÃ³ má»™t váº¥n Ä‘á» vá» Ä‘iá»ƒm lá»—i Ä‘Æ¡n - khÃ´ng cÃ³ sá»± dá»± phÃ²ng. May máº¯n thay, chÃºng ta chá»‰ cáº§n khá»Ÿi Ä‘á»™ng thÃªm má»™t nÃºt ná»¯a Ä‘á»ƒ ngÄƒn cháº·n máº¥t dá»¯ liá»‡u.</p>
<blockquote>
<p>Äá»ƒ kiá»ƒm tra tÃ¬nh hÃ¬nh sau khi khá»Ÿi Ä‘á»™ng nÃºt thá»© hai, báº¡n cÃ³ thá»ƒ khá»Ÿi Ä‘á»™ng má»™t nÃºt má»›i trong cÃ¹ng má»™t thÆ° má»¥c, hoÃ n toÃ n tuÃ¢n theo cÃ¡ch khá»Ÿi Ä‘á»™ng nÃºt Ä‘áº§u tiÃªn (xem CÃ i Ä‘áº·t vÃ  cháº¡y Elasticsearch). Nhiá»u nÃºt cÃ³ thá»ƒ chia sáº» cÃ¹ng má»™t thÆ° má»¥c.</p>
<p>Khi báº¡n khá»Ÿi Ä‘á»™ng nÃºt thá»© hai trÃªn cÃ¹ng má»™t mÃ¡y, miá»…n lÃ  nÃ³ cÃ³ cáº¥u hÃ¬nh <code>cluster.name</code> giá»‘ng vá»›i nÃºt Ä‘áº§u tiÃªn, nÃ³ sáº½ tá»± Ä‘á»™ng phÃ¡t hiá»‡n cluster vÃ  tham gia vÃ o Ä‘Ã³. Tuy nhiÃªn, khi khá»Ÿi Ä‘á»™ng nÃºt trÃªn cÃ¡c mÃ¡y khÃ¡c nhau, Ä‘á»ƒ tham gia vÃ o cÃ¹ng má»™t cluster, báº¡n cáº§n cáº¥u hÃ¬nh danh sÃ¡ch host unicast cÃ³ thá»ƒ káº¿t ná»‘i.</p>
</blockquote>
<p>Náº¿u chÃºng ta khá»Ÿi Ä‘á»™ng má»™t nÃºt thá»© hai, cluster cá»§a chÃºng ta sáº½ trá»Ÿ thÃ nh má»™t cluster vá»›i hai nÃºt - táº¥t cáº£ cÃ¡c shard chÃ­nh vÃ  shard sao lÆ°u Ä‘á»u Ä‘Ã£ Ä‘Æ°á»£c phÃ¢n bá»•.</p>
<p><strong>HÃ¬nh 3. Cluster vá»›i hai nÃºt - táº¥t cáº£ cÃ¡c shard chÃ­nh vÃ  shard sao lÆ°u Ä‘á»u Ä‘Ã£ Ä‘Æ°á»£c phÃ¢n bá»•</strong></p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/elas_0203.png" alt="Cluster vá»›i hai nÃºt" tabindex="0" loading="lazy"><figcaption>Cluster vá»›i hai nÃºt</figcaption></figure>
<p>Khi nÃºt thá»© hai tham gia vÃ o cluster, 3 shard <em>sao lÆ°u</em> sáº½ Ä‘Æ°á»£c phÃ¢n bá»• cho nÃºt nÃ y - má»—i shard chÃ­nh cÃ³ má»™t shard sao lÆ°u tÆ°Æ¡ng á»©ng. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  khi báº¥t ká»³ nÃºt nÃ o trong cluster gáº·p sá»± cá»‘, dá»¯ liá»‡u cá»§a chÃºng ta váº«n cÃ²n nguyÃªn váº¹n.</p>
<p>Táº¥t cáº£ cÃ¡c tÃ i liá»‡u má»›i Ä‘Æ°á»£c chá»‰ má»¥c sáº½ Ä‘Æ°á»£c lÆ°u trá»¯ trong shard chÃ­nh, sau Ä‘Ã³ Ä‘Æ°á»£c sao chÃ©p song song Ä‘áº¿n shard sao lÆ°u tÆ°Æ¡ng á»©ng. Äiá»u nÃ y Ä‘áº£m báº£o ráº±ng chÃºng ta cÃ³ thá»ƒ láº¥y tÃ i liá»‡u tá»« shard chÃ­nh cÅ©ng nhÆ° tá»« shard sao lÆ°u.</p>
<p><code>cluster-health</code> hiá»‡n táº¡i hiá»ƒn thá»‹ tráº¡ng thÃ¡i lÃ  <code>green</code>, Ä‘iá»u nÃ y cho tháº¥y táº¥t cáº£ 6 shard (bao gá»“m 3 shard chÃ­nh vÃ  3 shard sao lÆ°u) Ä‘á»u Ä‘ang hoáº¡t Ä‘á»™ng bÃ¬nh thÆ°á»ng.</p>
<div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "cluster_name"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"elasticsearch"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "status"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"green"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "timed_out"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">false</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "number_of_nodes"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "number_of_data_nodes"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "active_primary_shards"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "active_shards"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">6</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "relocating_shards"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "initializing_shards"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "unassigned_shards"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "delayed_unassigned_shards"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "number_of_pending_tasks"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "number_of_in_flight_fetch"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "task_max_waiting_in_queue_millis"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "active_shards_percent_as_number"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">100</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul>
<li>Tráº¡ng thÃ¡i <code>status</code> cá»§a cluster lÃ  <code>green</code></li>
</ul>
<p>Cluster cá»§a chÃºng ta hiá»‡n táº¡i khÃ´ng chá»‰ Ä‘ang hoáº¡t Ä‘á»™ng bÃ¬nh thÆ°á»ng, mÃ  cÃ²n á»Ÿ tráº¡ng thÃ¡i <em>luÃ´n sáºµn sÃ ng</em>.</p>
<h3>Má»Ÿ rá»™ng ngang</h3>
<p>LÃ m tháº¿ nÃ o Ä‘á»ƒ chÃºng ta má»Ÿ rá»™ng theo nhu cáº§u cho á»©ng dá»¥ng Ä‘ang phÃ¡t triá»ƒn cá»§a chÃºng ta? Khi khá»Ÿi Ä‘á»™ng má»™t nÃºt thá»© ba, cluster cá»§a chÃºng ta sáº½ trá»Ÿ thÃ nh má»™t cluster vá»›i ba nÃºt - phÃ¢n phá»‘i láº¡i cÃ¡c shard Ä‘á»ƒ phÃ¢n tÃ¡n táº£i.</p>
<p><strong>HÃ¬nh 4. Cluster vá»›i ba nÃºt - phÃ¢n phá»‘i láº¡i cÃ¡c shard Ä‘á»ƒ phÃ¢n tÃ¡n táº£i</strong></p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/elas_0204.png" alt="Cluster vá»›i ba nÃºt" tabindex="0" loading="lazy"><figcaption>Cluster vá»›i ba nÃºt</figcaption></figure>
<p>Má»™t shard tá»« <code>Node 1</code> vÃ  <code>Node 2</code> Ä‘Ã£ Ä‘Æ°á»£c di chuyá»ƒn Ä‘áº¿n nÃºt má»›i <code>Node 3</code>, bÃ¢y giá» má»—i nÃºt Ä‘á»u cÃ³ 2 shard, thay vÃ¬ 3 nhÆ° trÆ°á»›c. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  tÃ i nguyÃªn pháº§n cá»©ng (CPU, RAM, I/O) cá»§a má»—i nÃºt sáº½ Ä‘Æ°á»£c chia sáº» cho Ã­t shard hÆ¡n, hiá»‡u suáº¥t cá»§a má»—i shard sáº½ Ä‘Æ°á»£c cáº£i thiá»‡n.</p>
<p>Má»™t shard lÃ  má»™t cÃ´ng cá»¥ tÃ¬m kiáº¿m hoÃ n chá»‰nh, nÃ³ cÃ³ kháº£ nÄƒng sá»­ dá»¥ng táº¥t cáº£ cÃ¡c tÃ i nguyÃªn trÃªn má»™t nÃºt. Chá»‰ má»¥c cá»§a chÃºng ta cÃ³ 6 shard (3 shard chÃ­nh vÃ  3 shard sao lÆ°u) cÃ³ thá»ƒ má»Ÿ rá»™ng tá»‘i Ä‘a lÃªn Ä‘áº¿n 6 nÃºt, má»—i nÃºt cÃ³ má»™t shard, vÃ  má»—i shard cÃ³ toÃ n bá»™ tÃ i nguyÃªn cá»§a nÃºt nÆ¡i nÃ³ Ä‘áº·t.</p>
<h2>Shard</h2>
<blockquote>
<ul>
<li>Táº¡i sao tÃ¬m kiáº¿m lÃ  <em>gáº§n</em> thá»i gian thá»±c?</li>
<li>Táº¡i sao cÃ¡c hoáº¡t Ä‘á»™ng CRUD (Táº¡o - Äá»c - Cáº­p nháº­t - XÃ³a) trÃªn tÃ i liá»‡u lÃ  <em>thá»i gian thá»±c</em>?</li>
<li>Elasticsearch lÃ m tháº¿ nÃ o Ä‘á»ƒ Ä‘áº£m báº£o cÃ¡c cáº­p nháº­t Ä‘Æ°á»£c lÆ°u trá»¯ má»™t cÃ¡ch bá»n vá»¯ng mÃ  khÃ´ng máº¥t dá»¯ liá»‡u khi máº¥t Ä‘iá»‡n?</li>
<li>Táº¡i sao viá»‡c xÃ³a tÃ i liá»‡u khÃ´ng giáº£i phÃ³ng khÃ´ng gian ngay láº­p tá»©c?</li>
<li>API <code>refresh</code>, <code>flush</code>, vÃ  <code>optimize</code> lÃ m gÃ¬ vÃ  khi nÃ o báº¡n nÃªn sá»­ dá»¥ng chÃºng?</li>
</ul>
</blockquote>
<h3>LÃ m cho vÄƒn báº£n cÃ³ thá»ƒ tÃ¬m kiáº¿m</h3>
<p>ThÃ¡ch thá»©c Ä‘áº§u tiÃªn cáº§n giáº£i quyáº¿t lÃ  lÃ m tháº¿ nÃ o Ä‘á»ƒ lÃ m cho vÄƒn báº£n cÃ³ thá»ƒ tÃ¬m kiáº¿m. CÃ¡c cÆ¡ sá»Ÿ dá»¯ liá»‡u truyá»n thá»‘ng lÆ°u trá»¯ má»™t giÃ¡ trá»‹ duy nháº¥t cho má»—i trÆ°á»ng, nhÆ°ng Ä‘iá»u nÃ y khÃ´ng Ä‘á»§ cho tÃ¬m kiáº¿m toÃ n vÄƒn. Má»—i tá»« trong trÆ°á»ng vÄƒn báº£n cáº§n Ä‘Æ°á»£c tÃ¬m kiáº¿m, Ä‘iá»u nÃ y Ä‘á»‘i vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cÃ³ nghÄ©a lÃ  cáº§n cÃ³ kháº£ nÄƒng láº­p chá»‰ má»¥c nhiá»u giÃ¡ trá»‹ (á»Ÿ Ä‘Ã¢y lÃ  tá»«) cho má»™t trÆ°á»ng duy nháº¥t.</p>
<p>Cáº¥u trÃºc dá»¯ liá»‡u phÃ¹ há»£p nháº¥t Ä‘á»ƒ há»— trá»£ yÃªu cáº§u <em>nhiá»u giÃ¡ trá»‹ cho má»™t trÆ°á»ng</em> lÃ  <em>chá»‰ má»¥c Ä‘áº£o ngÆ°á»£c</em> mÃ  chÃºng ta Ä‘Ã£ giá»›i thiá»‡u trong chÆ°Æ¡ng <a href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/inverted-index.html" target="_blank" rel="noopener noreferrer">Chá»‰ má»¥c Ä‘áº£o ngÆ°á»£c</a>. Chá»‰ má»¥c Ä‘áº£o ngÆ°á»£c bao gá»“m má»™t danh sÃ¡ch Ä‘Ã£ sáº¯p xáº¿p, chá»©a táº¥t cáº£ cÃ¡c cÃ¡ thá»ƒ khÃ´ng trÃ¹ng láº·p xuáº¥t hiá»‡n trong tÃ i liá»‡u, hoáº·c Ä‘Æ°á»£c gá»i lÃ  <em>cá»¥m tá»«</em>, vÃ  cho má»—i cá»¥m tá»«, chá»©a danh sÃ¡ch táº¥t cáº£ cÃ¡c tÃ i liá»‡u mÃ  nÃ³ Ä‘Ã£ xuáº¥t hiá»‡n.</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>Term  | Doc 1 | Doc 2 | Doc 3 | ...</span></span></code></pre>
</div>]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/elas_0201.png" type="image/png"/>
    </item>
    <item>
      <title>Elasticsearch Index</title>
      <link>https://vanhung4499.github.io/database/elasticsearch/es-index.html</link>
      <guid>https://vanhung4499.github.io/database/elasticsearch/es-index.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Elasticsearch Index</source>
      <description>Elasticsearch Index Thao tÃ¡c quáº£n lÃ½ chá»‰ má»¥c Quáº£n lÃ½ chá»‰ má»¥c Elasticsearch chá»§ yáº¿u bao gá»“m cÃ¡ch táº¡o chá»‰ má»¥c, xÃ³a chá»‰ má»¥c, cáº­p nháº­t báº£n sao, quyá»n Ä‘á»c ghi chá»‰ má»¥c, cáº¥u hÃ¬nh bÃ­ da...</description>
      <category>elasticssearch</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>Thao tÃ¡c quáº£n lÃ½ chá»‰ má»¥c</h2>
<p>Quáº£n lÃ½ chá»‰ má»¥c Elasticsearch chá»§ yáº¿u bao gá»“m cÃ¡ch táº¡o chá»‰ má»¥c, xÃ³a chá»‰ má»¥c, cáº­p nháº­t báº£n sao, quyá»n Ä‘á»c ghi chá»‰ má»¥c, cáº¥u hÃ¬nh bÃ­ danh chá»‰ má»¥c, vÃ  nhiá»u ná»™i dung khÃ¡c.</p>
<h3>XÃ³a chá»‰ má»¥c</h3>
<p>Äá»ƒ xÃ³a chá»‰ má»¥c ES, báº¡n chá»‰ cáº§n gá»­i má»™t yÃªu cáº§u http delete Ä‘áº¿n giao diá»‡n http cá»§a cá»¥m ES vá»›i chá»‰ má»¥c Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh, báº¡n cÃ³ thá»ƒ thá»±c hiá»‡n Ä‘iá»u nÃ y báº±ng lá»‡nh curl, cá»¥ thá»ƒ nhÆ° sau:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">curl</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -X</span><span style="color:#98C379;--shiki-dark:#98C379"> DELETE</span><span style="color:#98C379;--shiki-dark:#98C379"> http://{es_host}:{es_http_port}/{index}</span></span></code></pre>
</div><p>Náº¿u xÃ³a thÃ nh cÃ´ng, nÃ³ sáº½ tráº£ vá» thÃ´ng tin nhÆ° sau, vÃ­ dá»¥ cá»¥ thá»ƒ nhÆ° sau:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">curl</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -X</span><span style="color:#98C379;--shiki-dark:#98C379"> DELETE</span><span style="color:#98C379;--shiki-dark:#98C379"> http://10.10.10.66:9200/my_index?pretty</span></span></code></pre>
</div><p>Äá»ƒ lÃ m cho thÃ´ng tin tráº£ vá» dá»… Ä‘á»c hÆ¡n, chÃºng tÃ´i Ä‘Ã£ thÃªm tham sá»‘ pretty:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "acknowledged"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#D19A66;--shiki-dark:#D19A66"> true</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h3>BÃ­ danh chá»‰ má»¥c</h3>
<p>BÃ­ danh chá»‰ má»¥c ES lÃ  tÃªn khÃ¡c mÃ  báº¡n Ä‘áº·t cho má»™t hoáº·c nhiá»u chá»‰ má»¥c, má»™t á»©ng dá»¥ng Ä‘iá»ƒn hÃ¬nh lÃ  Ä‘á»ƒ thá»±c hiá»‡n chuyá»ƒn Ä‘á»•i mÆ°á»£t mÃ  cho viá»‡c sá»­ dá»¥ng chá»‰ má»¥c.</p>
<p>Äáº§u tiÃªn, táº¡o chá»‰ má»¥c my_index, sau Ä‘Ã³ Ä‘áº·t bÃ­ danh my_alias Ä‘á»ƒ chá»‰ Ä‘áº¿n nÃ³, vÃ­ dá»¥ nhÆ° sau:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> /my_index</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> /my_index/_alias/my_alias</span></span></code></pre>
</div><p>Báº¡n cÅ©ng cÃ³ thá»ƒ thá»±c hiá»‡n nhÆ° sau:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> /_aliases</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "actions"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    { </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"add"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "index":</span><span style="color:#98C379;--shiki-dark:#98C379"> "my_index",</span><span style="color:#98C379;--shiki-dark:#98C379"> "alias":</span><span style="color:#98C379;--shiki-dark:#98C379"> "my_alias"</span><span style="color:#98C379;--shiki-dark:#98C379"> }}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  ]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><p>Báº¡n cÅ©ng cÃ³ thá»ƒ thÃªm vÃ  xÃ³a bÃ­ danh trong má»™t yÃªu cáº§u:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> /_aliases</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "actions"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    { </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"remove"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "index":</span><span style="color:#98C379;--shiki-dark:#98C379"> "my_index",</span><span style="color:#98C379;--shiki-dark:#98C379"> "alias":</span><span style="color:#98C379;--shiki-dark:#98C379"> "my_alias"</span><span style="color:#98C379;--shiki-dark:#98C379"> }},</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    { </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"add"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "index":</span><span style="color:#98C379;--shiki-dark:#98C379"> "my_index_v2",</span><span style="color:#98C379;--shiki-dark:#98C379"> "alias":</span><span style="color:#98C379;--shiki-dark:#98C379"> "my_alias"</span><span style="color:#98C379;--shiki-dark:#98C379"> }}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  ]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><blockquote>
<p>Cáº§n lÆ°u Ã½ ráº±ng, náº¿u bÃ­ danh vÃ  chá»‰ má»¥c lÃ  má»™t-má»™t, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng bÃ­ danh Ä‘á»ƒ láº­p chá»‰ má»¥c hoáº·c truy váº¥n tÃ i liá»‡u. Tuy nhiÃªn, náº¿u bÃ­ danh vÃ  chá»‰ má»¥c lÃ  má»™t-nhiá»u, viá»‡c sá»­ dá»¥ng bÃ­ danh sáº½ gÃ¢y ra lá»—i, vÃ¬ ES khÃ´ng biáº¿t pháº£i ghi tÃ i liá»‡u vÃ o chá»‰ má»¥c nÃ o hoáº·c Ä‘á»c tÃ i liá»‡u tá»« chá»‰ má»¥c nÃ o.</p>
</blockquote>
<p>Má»™t á»©ng dá»¥ng Ä‘iá»ƒn hÃ¬nh cá»§a bÃ­ danh chá»‰ má»¥c ES lÃ  chuyá»ƒn Ä‘á»•i mÆ°á»£t mÃ , báº¡n cÃ³ thá»ƒ xem thÃªm chi tiáº¿t táº¡i <a href="https://www.knowledgedict.com/tutorial/elasticsearch-index-smooth-shift.html" target="_blank" rel="noopener noreferrer">PhÆ°Æ¡ng phÃ¡p chuyá»ƒn Ä‘á»•i mÆ°á»£t mÃ  chá»‰ má»¥c Elasticsearch (ES) khÃ´ng cáº§n táº¯t mÃ¡y (khÃ´ng cáº§n khá»Ÿi Ä‘á»™ng láº¡i)</a>.</p>
<h2>Giáº£i thÃ­ch Settings</h2>
<p>Cáº¥u hÃ¬nh chá»‰ má»¥c Elasticsearch chá»§ yáº¿u Ä‘Æ°á»£c chia thÃ nh <strong>thuá»™c tÃ­nh cáº¥u hÃ¬nh tÄ©nh</strong> vÃ  <strong>thuá»™c tÃ­nh cáº¥u hÃ¬nh Ä‘á»™ng</strong>. Thuá»™c tÃ­nh cáº¥u hÃ¬nh tÄ©nh khÃ´ng thá»ƒ thay Ä‘á»•i sau khi táº¡o chá»‰ má»¥c, trong khi thuá»™c tÃ­nh cáº¥u hÃ¬nh Ä‘á»™ng cÃ³ thá»ƒ thay Ä‘á»•i báº¥t cá»© lÃºc nÃ o.</p>
<p>API Ä‘á»ƒ thiáº¿t láº­p chá»‰ má»¥c ES lÃ  <strong><em><code>_settings</code></em></strong>, vÃ­ dá»¥ Ä‘áº§y Ä‘á»§ nhÆ° sau:</p>
<div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> /my_index</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "settings"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "index"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "number_of_shards"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "1",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "number_of_replicas"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "1",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "refresh_interval"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "60s",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "analysis"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "filter"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">          "tsconvert"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "type"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "stconvert",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "convert_type"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "t2s",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "delimiter"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> ","</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">          },</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">          "synonym"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "type"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "synonym",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "synonyms_path"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "analysis/synonyms.txt"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">          }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        },</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "analyzer"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">          "ik_max_word_synonym"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "filter"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">              "synonym"</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">              "tsconvert"</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">              "standard"</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">              "lowercase"</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">              "stop"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">            ],</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "tokenizer"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "ik_max_word"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">          },</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">          "ik_smart_synonym"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "filter"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">              "synonym"</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">              "standard"</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">              "lowercase"</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">              "stop"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">            ],</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "tokenizer"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "ik_smart"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">          }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        },</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">		"mapping"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">			"coerce"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "false",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">			"ignore_malformed"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "false"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">		},</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">		"indexing"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">			"slowlog"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">				"threshold"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">					"index"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">						"warn"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "2s",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">						"info"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "1s"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">					}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">				}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">			}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">		},</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">		"provided_name"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "hospital_202101070533",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">		"query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">			"default_field"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "timestamp",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">			"parse"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">				"allow_unmapped_fields"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "false"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">			}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">		},</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">		"requests"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">			"cache"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">				"enable"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "true"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">			}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">		},</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">		"search"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">			"slowlog"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">				"threshold"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">					"fetch"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">						"warn"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "1s",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">						"info"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "200ms"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">					},</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">					"query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">						"warn"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "1s",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">						"info"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "500ms"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">					}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">				}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">			}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">		}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">	}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>Thuá»™c tÃ­nh cá»‘ Ä‘á»‹nh</h3>
<ul>
<li><strong><em><code>index.creation_date</code></em></strong>: ÄÃºng nhÆ° tÃªn gá»i, Ä‘Ã¢y lÃ  dáº¥u thá»i gian táº¡o chá»‰ má»¥c.</li>
<li><strong><em><code>index.uuid</code></em></strong>: ThÃ´ng tin uuid cá»§a chá»‰ má»¥c.</li>
<li><strong><em><code>index.version.created</code></em></strong>: PhiÃªn báº£n cá»§a chá»‰ má»¥c.</li>
</ul>
<h3>Cáº¥u hÃ¬nh tÄ©nh chá»‰ má»¥c</h3>
<ul>
<li><strong><em><code>index.number_of_shards</code></em></strong>: Sá»‘ lÆ°á»£ng máº£nh chÃ­nh cá»§a chá»‰ má»¥c, giÃ¡ trá»‹ máº·c Ä‘á»‹nh lÃ  <strong><em><code>5</code></em></strong>. Cáº¥u hÃ¬nh nÃ y khÃ´ng thá»ƒ thay Ä‘á»•i sau khi táº¡o chá»‰ má»¥c; á»Ÿ cáº¥p Ä‘á»™ es, báº¡n cÃ³ thá»ƒ thiáº¿t láº­p sá»‘ lÆ°á»£ng máº£nh tá»‘i Ä‘a cho chá»‰ má»¥c thÃ´ng qua thuá»™c tÃ­nh <strong><em><code>es.index.max_number_of_shards</code></em></strong>, máº·c Ä‘á»‹nh lÃ  <strong><em><code>1024</code></em></strong>.</li>
<li><strong><em><code>index.codec</code></em></strong>: Thuáº­t toÃ¡n nÃ©n Ä‘á»ƒ lÆ°u trá»¯ dá»¯ liá»‡u, giÃ¡ trá»‹ máº·c Ä‘á»‹nh lÃ  <strong><em><code>LZ4</code></em></strong>. CÃ¡c giÃ¡ trá»‹ tÃ¹y chá»n khÃ¡c bao gá»“m <strong><em><code>best_compression</code></em></strong>, nÃ³ cÃ³ tá»· lá»‡ nÃ©n tá»‘t hÆ¡n so vá»›i LZ4 (tá»©c lÃ  chiáº¿m Ã­t khÃ´ng gian Ä‘Ä©a hÆ¡n, nhÆ°ng hiá»‡u suáº¥t lÆ°u trá»¯ tháº¥p hÆ¡n LZ4).</li>
<li><strong><em><code>index.routing_partition_size</code></em></strong>: Sá»‘ lÆ°á»£ng phÃ¢n vÃ¹ng Ä‘á»‹nh tuyáº¿n, náº¿u thiáº¿t láº­p tham sá»‘ nÃ y, thuáº­t toÃ¡n Ä‘á»‹nh tuyáº¿n sáº½ lÃ : <code>( hash(_routing) + hash(_id) % index.routing_parttion_size ) % number_of_shards</code>. Náº¿u giÃ¡ trá»‹ nÃ y khÃ´ng Ä‘Æ°á»£c thiáº¿t láº­p, thuáº­t toÃ¡n Ä‘á»‹nh tuyáº¿n sáº½ lÃ  <code>hash(_routing) % number_of_shardings</code>, <code>_routing</code> máº·c Ä‘á»‹nh lÃ  <code>_id</code>.</li>
</ul>
<p>Trong cáº¥u hÃ¬nh tÄ©nh, má»™t pháº§n quan trá»ng lÃ  cáº¥u hÃ¬nh phÃ¢n tÃ­ch (config analyzers).</p>
<ul>
<li>
<p><strong><code>index.analysis</code></strong></p>
<p>: Cáº¥u hÃ¬nh ngoÃ i cÃ¹ng cá»§a phÃ¢n tÃ­ch, bÃªn trong chá»§ yáº¿u Ä‘Æ°á»£c chia thÃ nh char_filter, tokenizer, filter vÃ  analyzer.</p>
<ul>
<li><strong><em><code>char_filter</code></em></strong>: Äá»‹nh nghÄ©a bá»™ lá»c kÃ½ tá»± má»›i.</li>
<li><strong><em><code>tokenizer</code></em></strong>: Äá»‹nh nghÄ©a tokenizer má»›i.</li>
<li><strong><em><code>filter</code></em></strong>: Äá»‹nh nghÄ©a bá»™ lá»c token má»›i, nhÆ° bá»™ lá»c Ä‘á»“ng nghÄ©a.</li>
<li><strong><em><code>analyzer</code></em></strong>: Cáº¥u hÃ¬nh phÃ¢n tÃ­ch má»›i, thÆ°á»ng lÃ  sá»± káº¿t há»£p cá»§a char_filter, tokenizer vÃ  má»™t sá»‘ bá»™ lá»c token.</li>
</ul>
</li>
</ul>
<h3>Cáº¥u hÃ¬nh Ä‘á»™ng chá»‰ má»¥c</h3>
<ul>
<li><strong><em><code>index.number_of_replicas</code></em></strong>: Sá»‘ lÆ°á»£ng báº£n sao cá»§a máº£nh chÃ­nh cá»§a chá»‰ má»¥c, giÃ¡ trá»‹ máº·c Ä‘á»‹nh lÃ  <strong><em><code>1</code></em></strong>, giÃ¡ trá»‹ nÃ y pháº£i lá»›n hÆ¡n hoáº·c báº±ng 0, cáº¥u hÃ¬nh nÃ y cÃ³ thá»ƒ thay Ä‘á»•i báº¥t cá»© lÃºc nÃ o.</li>
<li><strong><em><code>index.refresh_interval</code></em></strong>: Táº§n suáº¥t thá»±c hiá»‡n thao tÃ¡c lÃ m má»›i dá»¯ liá»‡u chá»‰ má»¥c má»›i, thao tÃ¡c nÃ y lÃ m cho nhá»¯ng thay Ä‘á»•i gáº§n nháº¥t Ä‘á»‘i vá»›i chá»‰ má»¥c cÃ³ thá»ƒ nhÃ¬n tháº¥y khi tÃ¬m kiáº¿m, máº·c Ä‘á»‹nh lÃ  <strong><em><code>1s</code></em></strong>. Báº¡n cÅ©ng cÃ³ thá»ƒ Ä‘áº·t lÃ  <strong><em><code>-1</code></em></strong> Ä‘á»ƒ vÃ´ hiá»‡u hÃ³a viá»‡c lÃ m má»›i. ThÃ´ng tin chi tiáº¿t hÆ¡n xem táº¡i <a href="https://www.knowledgedict.com/tutorial/elasticsearch-refresh_interval-settings.html" target="_blank" rel="noopener noreferrer">Elasticsearch chá»‰nh sá»­a Ä‘á»™ng refresh_interval cÃ i Ä‘áº·t khoáº£ng thá»i gian lÃ m má»›i</a>.</li>
</ul>
<h2>Giáº£i thÃ­ch Mapping</h2>
<p>Trong Elasticsearch, <strong><code>Mapping</code></strong> (Ã¡nh xáº¡) Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘á»‹nh rÃµ cÃ¡ch má»™t tÃ i liá»‡u vÃ  cÃ¡c trÆ°á»ng mÃ  nÃ³ chá»©a Ä‘Æ°á»£c lÆ°u trá»¯ vÃ  láº­p chá»‰ má»¥c. Báº¡n cÃ³ thá»ƒ Ä‘á»‹nh trÆ°á»›c loáº¡i dá»¯ liá»‡u cá»§a cÃ¡c trÆ°á»ng, trá»ng sá»‘ cá»§a cÃ¡c trÆ°á»ng, bá»™ phÃ¢n tÃ­ch, vÃ  cÃ¡c thuá»™c tÃ­nh khÃ¡c trong Ã¡nh xáº¡, giá»‘ng nhÆ° viá»‡c thiáº¿t láº­p loáº¡i dá»¯ liá»‡u cho cÃ¡c trÆ°á»ng khi táº¡o báº£ng trong cÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡.</p>
<p>Mapping sáº½ Ã¡nh xáº¡ tÃ i liá»‡u json thÃ nh Ä‘á»‹nh dáº¡ng pháº³ng mÃ  Lucene cáº§n.</p>
<p>Má»™t Mapping thuá»™c vá» má»™t Type cá»§a chá»‰ má»¥c</p>
<ul>
<li>Má»—i tÃ i liá»‡u Ä‘á»u thuá»™c vá» má»™t Type</li>
<li>Má»™t Type cÃ³ má»™t Ä‘á»‹nh nghÄ©a Mapping</li>
<li>Tá»« phiÃªn báº£n 7.0 trá»Ÿ Ä‘i, khÃ´ng cáº§n pháº£i chá»‰ Ä‘á»‹nh thÃ´ng tin type trong Ä‘á»‹nh nghÄ©a Mapping</li>
</ul>
<h3>PhÃ¢n loáº¡i Ã¡nh xáº¡</h3>
<p>Trong Elasticsearch, Ã¡nh xáº¡ cÃ³ thá»ƒ Ä‘Æ°á»£c chia thÃ nh Ã¡nh xáº¡ tÄ©nh vÃ  Ã¡nh xáº¡ Ä‘á»™ng. Trong cÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡, trÆ°á»›c khi ghi dá»¯ liá»‡u, báº¡n cáº§n táº¡o báº£ng trÆ°á»›c, trong cÃ¢u lá»‡nh táº¡o báº£ng, báº¡n sáº½ khai bÃ¡o thuá»™c tÃ­nh cá»§a cÃ¡c trÆ°á»ng. Tuy nhiÃªn, trong Elasticsearch, báº¡n khÃ´ng cáº§n pháº£i lÃ m nhÆ° váº­y. Má»™t trong nhá»¯ng tÃ­nh nÄƒng quan trá»ng nháº¥t cá»§a Elasticsearch lÃ  cho phÃ©p báº¡n khÃ¡m phÃ¡ dá»¯ liá»‡u cÃ ng nhanh cÃ ng tá»‘t. Khi tÃ i liá»‡u Ä‘Æ°á»£c ghi vÃ o Elasticsearch, nÃ³ sáº½ tá»± Ä‘á»™ng nháº­n biáº¿t loáº¡i cá»§a cÃ¡c trÆ°á»ng. CÆ¡ cháº¿ nÃ y Ä‘Æ°á»£c gá»i lÃ  <strong>Ã¡nh xáº¡ Ä‘á»™ng</strong>, trong khi <strong>Ã¡nh xáº¡ tÄ©nh</strong> lÃ  viá»‡c thiáº¿t láº­p thuá»™c tÃ­nh cá»§a cÃ¡c trÆ°á»ng trÆ°á»›c khi ghi dá»¯ liá»‡u.</p>
<h4>Ãnh xáº¡ tÄ©nh</h4>
<p><strong>Ãnh xáº¡ tÄ©nh</strong> lÃ  viá»‡c chá»‰ Ä‘á»‹nh Ã¡nh xáº¡ chá»‰ má»¥c theo cÃ¡ch thá»§ cÃ´ng khi táº¡o chá»‰ má»¥c. Ãnh xáº¡ tÄ©nh tÆ°Æ¡ng tá»± nhÆ° viá»‡c chá»‰ Ä‘á»‹nh thuá»™c tÃ­nh trÆ°á»ng trong cÃ¢u lá»‡nh táº¡o báº£ng trong SQL. So vá»›i Ã¡nh xáº¡ Ä‘á»™ng, thÃ´ng qua Ã¡nh xáº¡ tÄ©nh, báº¡n cÃ³ thá»ƒ thÃªm cÃ¡c thÃ´ng tin cáº¥u hÃ¬nh chi tiáº¿t vÃ  chÃ­nh xÃ¡c hÆ¡n.</p>
<p>CÃ¡ch Ä‘á»‹nh nghÄ©a má»™t Mapping</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> /books</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "mappings"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "type_one"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> ...</span><span style="color:#98C379;--shiki-dark:#98C379"> any</span><span style="color:#98C379;--shiki-dark:#98C379"> mappings</span><span style="color:#98C379;--shiki-dark:#98C379"> ...</span><span style="color:#98C379;--shiki-dark:#98C379"> },</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "type_two"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> ...</span><span style="color:#98C379;--shiki-dark:#98C379"> any</span><span style="color:#98C379;--shiki-dark:#98C379"> mappings</span><span style="color:#98C379;--shiki-dark:#98C379"> ...</span><span style="color:#98C379;--shiki-dark:#98C379"> },</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2">        ...</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h4>Ãnh xáº¡ Ä‘á»™ng</h4>
<p><strong>Ãnh xáº¡ Ä‘á»™ng</strong> lÃ  má»™t cÃ¡ch thoáº£i mÃ¡i, cho phÃ©p báº¡n táº¡o chá»‰ má»¥c vÃ  ghi tÃ i liá»‡u mÃ  khÃ´ng cáº§n thiáº¿t láº­p loáº¡i trÆ°á»ng khi táº¡o chá»‰ má»¥c. Loáº¡i cá»§a cÃ¡c trÆ°á»ng trong tÃ i liá»‡u sáº½ Ä‘Æ°á»£c Elasticsearch <strong>tá»± Ä‘á»™ng nháº­n biáº¿t</strong>. Trong dá»± Ã¡n thá»±c táº¿, náº¿u báº¡n khÃ´ng cháº¯c cháº¯n vá» cÃ¡c trÆ°á»ng sáº½ cÃ³ trong dá»¯ liá»‡u trÆ°á»›c khi nháº­p, hoáº·c báº¡n khÃ´ng rÃµ vá» loáº¡i dá»¯ liá»‡u cá»§a cÃ¡c trÆ°á»ng, viá»‡c sá»­ dá»¥ng Ã¡nh xáº¡ Ä‘á»™ng sáº½ ráº¥t phÃ¹ há»£p. Khi Elasticsearch gáº·p má»™t trÆ°á»ng mÃ  nÃ³ chÆ°a tá»«ng tháº¥y trÆ°á»›c Ä‘Ã³ trong tÃ i liá»‡u, nÃ³ sáº½ sá»­ dá»¥ng Ã¡nh xáº¡ Ä‘á»™ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh loáº¡i cá»§a trÆ°á»ng Ä‘Ã³ vÃ  tá»± Ä‘á»™ng thÃªm trÆ°á»ng Ä‘Ã³ vÃ o Ã¡nh xáº¡, dá»±a vÃ o giÃ¡ trá»‹ cá»§a trÆ°á»ng Ä‘á»ƒ tá»± Ä‘á»™ng dá»± Ä‘oÃ¡n loáº¡i trÆ°á»ng theo báº£ng sau:</p>
<p>| Dá»¯ liá»‡u Ä‘á»‹nh dáº¡ng JSON | Loáº¡i trÆ°á»ng Ä‘Æ°á»£c dá»± Ä‘oÃ¡n tá»± Ä‘á»™ng                                                       |<br>
| :</p>
]]></content:encoded>
    </item>
    <item>
      <title>Elasticsearch Highlight Search and Display</title>
      <link>https://vanhung4499.github.io/database/elasticsearch/highlight-search-display.html</link>
      <guid>https://vanhung4499.github.io/database/elasticsearch/highlight-search-display.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Elasticsearch Highlight Search and Display</source>
      <description>TÃ¬m kiáº¿m vÃ  hiá»ƒn thá»‹ ná»•i báº­t trong Elasticsearch Chá»©c nÄƒng tÃ¬m kiáº¿m ná»•i báº­t (highlight) cá»§a Elasticsearch cho phÃ©p báº¡n láº¥y Ä‘oáº¡n tÃ³m táº¯t ná»•i báº­t tá»« má»™t hoáº·c nhiá»u trÆ°á»ng trong káº¿...</description>
      <category>elasticssearch</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<p>Chá»©c nÄƒng tÃ¬m kiáº¿m ná»•i báº­t (highlight) cá»§a Elasticsearch cho phÃ©p báº¡n láº¥y Ä‘oáº¡n tÃ³m táº¯t ná»•i báº­t tá»« má»™t hoáº·c nhiá»u trÆ°á»ng trong káº¿t quáº£ tÃ¬m kiáº¿m, Ä‘á»ƒ hiá»ƒn thá»‹ vá»‹ trÃ­ phÃ¹ há»£p vá»›i truy váº¥n cá»§a ngÆ°á»i dÃ¹ng. Khi báº¡n yÃªu cáº§u tÃ¬m kiáº¿m ná»•i báº­t, trÆ°á»ng highlight trong káº¿t quáº£ tráº£ vá» sáº½ bao gá»“m cÃ¡c trÆ°á»ng ná»•i báº­t vÃ  cÃ¡c Ä‘oáº¡n ná»•i báº­t. Elasticsearch máº·c Ä‘á»‹nh sáº½ Ä‘Ã¡nh dáº¥u tá»« khÃ³a báº±ng tháº» <code>&lt;em&gt;&lt;/em&gt;</code>.</p>
<h2>Tham sá»‘ tÃ¬m kiáº¿m ná»•i báº­t</h2>
<p>ES cung cáº¥p cÃ¡c tham sá»‘ tÃ¬m kiáº¿m ná»•i báº­t sau Ä‘Ã¢y:</p>
<p>| Tham sá»‘                   | MÃ´ táº£                                                                                                                                                                                                                                                                                                                                                                                                             |<br>
| :</p>
]]></content:encoded>
    </item>
    <item>
      <title>Elasticsearch Interview</title>
      <link>https://vanhung4499.github.io/database/elasticsearch/interview.html</link>
      <guid>https://vanhung4499.github.io/database/elasticsearch/interview.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Elasticsearch Interview</source>
      <description>TÃ³m táº¯t phá»ng váº¥n Elasticsearch Triá»ƒn khai cá»¥m Cáº¥u hÃ¬nh triá»ƒn khai ES: 5 nÃºt (cáº¥u hÃ¬nh: 8 nhÃ¢n 64 G 1T), tá»•ng cá»™ng 320 G, 5 T. Khoáº£ng 10+ chá»‰ má»¥c, 5 phÃ¢n Ä‘oáº¡n, lÆ°á»£ng dá»¯ liá»‡u má»›i...</description>
      <category>elasticssearch</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>Triá»ƒn khai cá»¥m</h2>
<p>Cáº¥u hÃ¬nh triá»ƒn khai ES:</p>
<p>5 nÃºt (cáº¥u hÃ¬nh: 8 nhÃ¢n 64 G 1T), tá»•ng cá»™ng 320 G, 5 T.</p>
<p>Khoáº£ng 10+ chá»‰ má»¥c, 5 phÃ¢n Ä‘oáº¡n, lÆ°á»£ng dá»¯ liá»‡u má»›i hÃ ng ngÃ y lÃ  khoáº£ng 2G, 40 triá»‡u báº£n ghi. Báº£n ghi Ä‘Æ°á»£c lÆ°u trá»¯ trong 30 ngÃ y.</p>
<h2>Tá»‘i Æ°u hÃ³a hiá»‡u suáº¥t</h2>
<h3>filesystem cache</h3>
<p>Dá»¯ liá»‡u báº¡n ghi vÃ o es, thá»±c táº¿ Ä‘Ã£ Ä‘Æ°á»£c ghi vÃ o tá»‡p trÃªn Ä‘Ä©a,&nbsp;<strong>khi truy váº¥n</strong>, há»‡ Ä‘iá»u hÃ nh sáº½ tá»± Ä‘á»™ng lÆ°u trá»¯ dá»¯ liá»‡u tá»« tá»‡p trÃªn Ä‘Ä©a vÃ o&nbsp;<code>filesystem cache</code>.</p>
<p><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240223081955.png" alt="image.png" loading="lazy"><br>
CÆ¡ cháº¿ tÃ¬m kiáº¿m cá»§a es phá»¥ thuá»™c náº·ng ná» vÃ o&nbsp;<code>filesystem cache</code>&nbsp;cÆ¡ sá»Ÿ. Náº¿u báº¡n cung cáº¥p thÃªm bá»™ nhá»› cho&nbsp;<code>filesystem cache</code>, cá»‘ gáº¯ng Ä‘á»ƒ bá»™ nhá»› cÃ³ thá»ƒ chá»©a táº¥t cáº£ cÃ¡c tá»‡p dá»¯ liá»‡u chá»‰ má»¥c&nbsp;<code>idx segment file</code>, thÃ¬ khi báº¡n tÃ¬m kiáº¿m, háº§u nhÆ° táº¥t cáº£ cÃ¡c hoáº¡t Ä‘á»™ng Ä‘á»u Ä‘i qua bá»™ nhá»›, hiá»‡u suáº¥t sáº½ ráº¥t cao.</p>
<p>Hiá»‡u suáº¥t cÃ³ thá»ƒ chÃªnh lá»‡ch Ä‘áº¿n má»©c Ä‘á»™ nÃ o? Trong nhiá»u thá»­ nghiá»‡m vÃ  kiá»ƒm tra Ã¡p lá»±c cá»§a chÃºng tÃ´i trÆ°á»›c Ä‘Ã¢y, náº¿u Ä‘i qua Ä‘Ä©a, thÃ¬ thá»i gian tÃ¬m kiáº¿m cháº¯c cháº¯n lÃ  á»Ÿ má»©c giÃ¢y, tá»« 1 giÃ¢y, 5 giÃ¢y Ä‘áº¿n 10 giÃ¢y. NhÆ°ng náº¿u Ä‘i qua&nbsp;<code>filesystem cache</code>, nghÄ©a lÃ  Ä‘i qua bá»™ nhá»› thuáº§n tÃºy, thÃ¬ hiá»‡u suáº¥t thÆ°á»ng cao hÆ¡n má»™t báº­c so vá»›i viá»‡c Ä‘i qua Ä‘Ä©a, cÆ¡ báº£n lÃ  á»Ÿ má»©c mili giÃ¢y, tá»« vÃ i mili giÃ¢y Ä‘áº¿n vÃ i trÄƒm mili giÃ¢y.</p>
<p>á» Ä‘Ã¢y cÃ³ má»™t vÃ­ dá»¥ thá»±c táº¿. Má»™t cÃ´ng ty cÃ³ 3 mÃ¡y chá»§ es, má»—i mÃ¡y chá»§ cÃ³ váº» nhÆ° cÃ³ nhiá»u bá»™ nhá»›, 64G, tá»•ng bá»™ nhá»› lÃ &nbsp;<code>64 * 3 = 192G</code>. Má»—i mÃ¡y chá»§ cung cáº¥p cho es jvm heap lÃ &nbsp;<code>32G</code>, vÃ¬ váº­y pháº§n cÃ²n láº¡i cho&nbsp;<code>filesystem cache</code>&nbsp;chá»‰ lÃ &nbsp;<code>32G</code>&nbsp;má»—i mÃ¡y, tá»•ng cá»™ng trong cá»¥m, cho&nbsp;<code>filesystem cache</code>&nbsp;chá»‰ lÃ &nbsp;<code>32 * 3 = 96G</code>&nbsp;bá»™ nhá»›. Tuy nhiÃªn, vÃ o thá»i Ä‘iá»ƒm Ä‘Ã³, táº¥t cáº£ cÃ¡c tá»‡p dá»¯ liá»‡u chá»‰ má»¥c trÃªn Ä‘Ä©a, trÃªn 3 mÃ¡y, tá»•ng cá»™ng chiáº¿m&nbsp;<code>1T</code>&nbsp;dung lÆ°á»£ng Ä‘Ä©a, lÆ°á»£ng dá»¯ liá»‡u es lÃ &nbsp;<code>1T</code>, vÃ¬ váº­y lÆ°á»£ng dá»¯ liá»‡u má»—i mÃ¡y lÃ &nbsp;<code>300G</code>. Hiá»‡u suáº¥t tá»‘t khÃ´ng? Bá»™ nhá»›&nbsp;<code>filesystem cache</code>&nbsp;chá»‰ cÃ³ 100G, chá»‰ má»™t pháº§n mÆ°á»i dá»¯ liá»‡u cÃ³ thá»ƒ Ä‘Æ°á»£c Ä‘áº·t trong bá»™ nhá»›, pháº§n cÃ²n láº¡i Ä‘á»u á»Ÿ trÃªn Ä‘Ä©a, sau Ä‘Ã³ báº¡n thá»±c hiá»‡n hoáº¡t Ä‘á»™ng tÃ¬m kiáº¿m, háº§u háº¿t cÃ¡c hoáº¡t Ä‘á»™ng Ä‘á»u Ä‘i qua Ä‘Ä©a, hiá»‡u suáº¥t cháº¯c cháº¯n sáº½ kÃ©m.</p>
<p>Vá» cÆ¡ báº£n, náº¿u báº¡n muá»‘n es hoáº¡t Ä‘á»™ng tá»‘t, trÆ°á»ng há»£p tá»‘t nháº¥t lÃ  bá»™ nhá»› mÃ¡y cá»§a báº¡n cÃ³ thá»ƒ chá»©a Ã­t nháº¥t má»™t ná»­a tá»•ng lÆ°á»£ng dá»¯ liá»‡u cá»§a báº¡n.</p>
<p>Dá»±a trÃªn kinh nghiá»‡m thá»±c táº¿ trong mÃ´i trÆ°á»ng product cá»§a chÃºng tÃ´i, trÆ°á»ng há»£p tá»‘t nháº¥t lÃ  chá»‰ lÆ°u trá»¯ má»™t lÆ°á»£ng dá»¯ liá»‡u nhá» trong es, chá»‰ lÃ  nhá»¯ng chá»‰ má»¥c mÃ  báº¡n cáº§n&nbsp;<strong>tÃ¬m kiáº¿m</strong>, náº¿u bá»™ nhá»› dÃ nh cho&nbsp;<code>filesystem cache</code>&nbsp;lÃ  100G, thÃ¬ báº¡n nÃªn kiá»ƒm soÃ¡t lÆ°á»£ng dá»¯ liá»‡u chá»‰ má»¥c dÆ°á»›i&nbsp;<code>100G</code>. Trong trÆ°á»ng há»£p nÃ y, háº§u háº¿t dá»¯ liá»‡u cá»§a báº¡n Ä‘á»u Ä‘i qua bá»™ nhá»› Ä‘á»ƒ tÃ¬m kiáº¿m, hiá»‡u suáº¥t ráº¥t cao, thÆ°á»ng cÃ³ thá»ƒ trong vÃ²ng 1 giÃ¢y.</p>
<p>VÃ­ dá»¥, báº¡n hiá»‡n cÃ³ má»™t hÃ ng dá»¯ liá»‡u.&nbsp;<code>id, name, age â€¦.</code>&nbsp;30 trÆ°á»ng. NhÆ°ng bÃ¢y giá», báº¡n chá»‰ cáº§n tÃ¬m kiáº¿m dá»±a trÃªn ba trÆ°á»ng&nbsp;<code>id, name, age</code>. Náº¿u báº¡n ngÃ¢y thÆ¡ ghi táº¥t cáº£ cÃ¡c trÆ°á»ng cá»§a má»™t hÃ ng dá»¯ liá»‡u vÃ o es, Ä‘iá»u nÃ y sáº½ dáº«n Ä‘áº¿n viá»‡c&nbsp;<code>90%</code>&nbsp;dá»¯ liá»‡u khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ¬m kiáº¿m, nhÆ°ng váº«n chiáº¿m khÃ´ng gian&nbsp;<code>filesystem cache</code>&nbsp;trÃªn mÃ¡y chá»§ es, dá»¯ liá»‡u má»—i hÃ ng cÃ ng lá»›n,&nbsp;<code>filesystem cache</code>&nbsp;cÃ³ thá»ƒ lÆ°u trá»¯ cÃ ng Ã­t dá»¯ liá»‡u. Thá»±c táº¿, chá»‰ cáº§n ghi vÃ o es&nbsp;<strong>má»™t sá»‘ trÆ°á»ng Ã­t</strong>&nbsp;cáº§n tÃ¬m kiáº¿m, vÃ­ dá»¥, chá»‰ cáº§n ghi vÃ o es&nbsp;<code>id, name, age</code>&nbsp;ba trÆ°á»ng, sau Ä‘Ã³ báº¡n cÃ³ thá»ƒ lÆ°u trá»¯ dá»¯ liá»‡u trÆ°á»ng khÃ¡c trong mysql/hbase, chÃºng tÃ´i thÆ°á»ng khuyáº¿n nghá»‹ sá»­ dá»¥ng cáº¥u trÃºc&nbsp;<code>es + hbase</code>.</p>
<p>Äáº·c Ä‘iá»ƒm cá»§a hbase lÃ &nbsp;<strong>phÃ¹ há»£p cho viá»‡c lÆ°u trá»¯ dá»¯ liá»‡u trá»±c tuyáº¿n lá»›n</strong>, tá»©c lÃ  hbase cÃ³ thá»ƒ ghi vÃ o dá»¯ liá»‡u lá»›n, nhÆ°ng khÃ´ng nÃªn thá»±c hiá»‡n tÃ¬m kiáº¿m phá»©c táº¡p, chá»‰ cáº§n thá»±c hiá»‡n má»™t sá»‘ hoáº¡t Ä‘á»™ng Ä‘Æ¡n giáº£n dá»±a trÃªn id hoáº·c pháº¡m vi. TÃ¬m kiáº¿m tá»« es dá»±a trÃªn tÃªn vÃ  tuá»•i, káº¿t quáº£ cÃ³ thá»ƒ chá»‰ lÃ  20&nbsp;<code>doc id</code>, sau Ä‘Ã³ tÃ¬m kiáº¿m&nbsp;<strong>dá»¯ liá»‡u Ä‘áº§y Ä‘á»§</strong>&nbsp;tÆ°Æ¡ng á»©ng vá»›i má»—i&nbsp;<code>doc id</code>&nbsp;tá»« hbase, Ä‘Æ°a ra, sau Ä‘Ã³ tráº£ vá» cho phÃ­a trÆ°á»›c.</p>
<p>Dá»¯ liá»‡u ghi vÃ o es nÃªn nhá» hÆ¡n hoáº·c báº±ng, hoáº·c hÆ¡i lá»›n hÆ¡n dung lÆ°á»£ng bá»™ nhá»› cá»§a filesystem cache cá»§a es. Sau Ä‘Ã³, báº¡n cÃ³ thá»ƒ máº¥t 20ms Ä‘á»ƒ tÃ¬m kiáº¿m tá»« es, sau Ä‘Ã³ tÃ¬m kiáº¿m tá»« hbase dá»±a trÃªn id Ä‘Æ°á»£c tráº£ vá» tá»« es, tÃ¬m kiáº¿m 20 báº£n ghi, cÃ³ thá»ƒ máº¥t thÃªm 30ms, cÃ³ thá»ƒ báº¡n Ä‘Ã£ chÆ¡i nhÆ° váº­y trÆ°á»›c Ä‘Ã¢y, 1T dá»¯ liá»‡u Ä‘á»u Ä‘áº·t trong es, má»—i truy váº¥n Ä‘á»u máº¥t 5~10s, bÃ¢y giá» cÃ³ thá»ƒ hiá»‡u suáº¥t sáº½ cao hÆ¡n, má»—i truy váº¥n chá»‰ máº¥t 50ms.</p>
<h3>Dá»¯ liá»‡u khá»Ÿi Ä‘á»™ng</h3>
<p>Giáº£ sá»­, ngay cáº£ khi báº¡n lÃ m theo phÆ°Æ¡ng Ã¡n Ä‘Ã£ nÃªu á»Ÿ trÃªn, lÆ°á»£ng dá»¯ liá»‡u Ä‘Æ°á»£c ghi vÃ o má»—i mÃ¡y trong cá»¥m es váº«n vÆ°á»£t quÃ¡ gáº¥p Ä‘Ã´i&nbsp;<code>filesystem cache</code>, vÃ­ dá»¥, báº¡n ghi 60G dá»¯ liá»‡u vÃ o má»™t mÃ¡y, nhÆ°ng&nbsp;<code>filesystem cache</code>&nbsp;chá»‰ cÃ³ 30G, váº«n cÃ²n 30G dá»¯ liá»‡u á»Ÿ trÃªn Ä‘Ä©a.</p>
<p>Thá»±c táº¿, báº¡n cÃ³ thá»ƒ thá»±c hiá»‡n&nbsp;<strong>khá»Ÿi Ä‘á»™ng dá»¯ liá»‡u</strong>.</p>
<p>VÃ­ dá»¥, náº¿u báº¡n nÃ³i vá» Weibo, báº¡n cÃ³ thá»ƒ láº¥y má»™t sá»‘ dá»¯ liá»‡u tá»« cÃ¡c ngÆ°á»i dÃ¹ng VIP, nhá»¯ng ngÆ°á»i thÆ°á»ng xuyÃªn Ä‘Æ°á»£c xem nhiá»u, báº¡n tá»± táº¡o má»™t há»‡ thá»‘ng phÃ­a sau, sau má»—i má»™t thá»i gian, há»‡ thá»‘ng phÃ­a sau cá»§a báº¡n sáº½ tÃ¬m kiáº¿m dá»¯ liá»‡u nÃ³ng, vÃ  Ä‘áº©y vÃ o&nbsp;<code>filesystem cache</code>, sau Ä‘Ã³, khi ngÆ°á»i dÃ¹ng thá»±c sá»± Ä‘áº¿n xem dá»¯ liá»‡u nÃ³ng nÃ y, há» sáº½ trá»±c tiáº¿p tÃ¬m kiáº¿m tá»« bá»™ nhá»›, ráº¥t nhanh.</p>
<p>Hoáº·c lÃ  thÆ°Æ¡ng máº¡i Ä‘iá»‡n tá»­, báº¡n cÃ³ thá»ƒ láº¥y má»™t sá»‘ sáº£n pháº©m Ä‘Æ°á»£c xem nhiá»u nháº¥t thÆ°á»ng xuyÃªn, cháº³ng háº¡n nhÆ° iPhone 15, dá»¯ liá»‡u nÃ³ng Ä‘Æ°á»£c táº¡o trÆ°á»›c báº±ng má»™t chÆ°Æ¡ng trÃ¬nh phÃ­a sau, sau má»—i phÃºt, báº¡n tá»± Ä‘á»™ng truy cáº­p má»™t láº§n, vÃ  Ä‘áº©y vÃ o&nbsp;<code>filesystem cache</code>.</p>
<p>Äá»‘i vá»›i nhá»¯ng dá»¯ liá»‡u mÃ  báº¡n cho lÃ  nÃ³ng, vÃ  thÆ°á»ng xuyÃªn cÃ³ ngÆ°á»i truy cáº­p, nÃªn&nbsp;<strong>táº¡o má»™t há»‡ thá»‘ng khá»Ÿi Ä‘á»™ng bá»™ Ä‘á»‡m chuyÃªn dá»¥ng</strong>, tá»©c lÃ , sau má»—i má»™t khoáº£ng thá»i gian, truy cáº­p trÆ°á»›c vÃ o dá»¯ liá»‡u nÃ³ng, Ä‘á»ƒ dá»¯ liá»‡u vÃ o&nbsp;<code>filesystem cache</code>. NhÆ° váº­y, khi ngÆ°á»i khÃ¡c truy cáº­p láº§n sau, hiá»‡u suáº¥t cháº¯c cháº¯n sáº½ tá»‘t hÆ¡n nhiá»u.</p>
<h3>PhÃ¢n tÃ¡ch nÃ³ng vÃ  láº¡nh</h3>
<p>es cÃ³ thá»ƒ thá»±c hiá»‡n viá»‡c phÃ¢n tÃ¡ch ngang tÆ°Æ¡ng tá»± nhÆ° mysql, tá»©c lÃ , Ä‘áº·t má»™t lÆ°á»£ng lá»›n dá»¯ liá»‡u Ã­t Ä‘Æ°á»£c truy cáº­p, táº§n suáº¥t tháº¥p vÃ o má»™t chá»‰ má»¥c riÃªng biá»‡t, sau Ä‘Ã³ Ä‘áº·t dá»¯ liá»‡u nÃ³ng Ä‘Æ°á»£c truy cáº­p thÆ°á»ng xuyÃªn vÃ o má»™t chá»‰ má»¥c riÃªng biá»‡t. Tá»‘t nháº¥t lÃ  Ä‘áº·t&nbsp;<strong>dá»¯ liá»‡u láº¡nh vÃ o má»™t chá»‰ má»¥c, sau Ä‘Ã³ Ä‘áº·t dá»¯ liá»‡u nÃ³ng vÃ o má»™t chá»‰ má»¥c khÃ¡c</strong>, Ä‘iá»u nÃ y cÃ³ thá»ƒ Ä‘áº£m báº£o ráº±ng sau khi dá»¯ liá»‡u nÃ³ng Ä‘Æ°á»£c khá»Ÿi Ä‘á»™ng, hÃ£y Ä‘á»ƒ chÃºng á»Ÿ trong&nbsp;<code>filesystem os cache</code>&nbsp;cÃ ng nhiá»u cÃ ng tá»‘t,&nbsp;<strong>Ä‘á»«ng Ä‘á»ƒ dá»¯ liá»‡u láº¡nh xÃ³a bá» chÃºng</strong>.</p>
<p>Báº¡n xem, giáº£ sá»­ báº¡n cÃ³ 6 mÃ¡y, 2 chá»‰ má»¥c, má»™t cho dá»¯ liá»‡u láº¡nh, má»™t cho dá»¯ liá»‡u nÃ³ng, má»—i chá»‰ má»¥c cÃ³ 3 shard. 3 mÃ¡y Ä‘áº·t chá»‰ má»¥c dá»¯ liá»‡u nÃ³ng, 3 mÃ¡y khÃ¡c Ä‘áº·t chá»‰ má»¥c dá»¯ liá»‡u láº¡nh. Sau Ä‘Ã³, báº¡n sáº½ dÃ nh nhiá»u thá»i gian truy cáº­p vÃ o chá»‰ má»¥c dá»¯ liá»‡u nÃ³ng, dá»¯ liá»‡u nÃ³ng cÃ³ thá»ƒ chiáº¿m 10% tá»•ng lÆ°á»£ng dá»¯ liá»‡u, lÃºc nÃ y lÆ°á»£ng dá»¯ liá»‡u ráº¥t nhá», gáº§n nhÆ° táº¥t cáº£ Ä‘á»u Ä‘Æ°á»£c giá»¯ trong&nbsp;<code>filesystem cache</code>, Ä‘iá»u nÃ y cÃ³ thá»ƒ Ä‘áº£m báº£o ráº±ng hiá»‡u suáº¥t truy cáº­p dá»¯ liá»‡u nÃ³ng ráº¥t cao. NhÆ°ng Ä‘á»‘i vá»›i dá»¯ liá»‡u láº¡nh, nÃ³ náº±m trong má»™t chá»‰ má»¥c khÃ¡c, khÃ´ng á»Ÿ cÃ¹ng mÃ¡y vá»›i chá»‰ má»¥c dá»¯ liá»‡u nÃ³ng, khÃ´ng cÃ³ liÃªn há»‡ gÃ¬ vá»›i nhau. Náº¿u cÃ³ ngÆ°á»i truy cáº­p dá»¯ liá»‡u láº¡nh, cÃ³ thá»ƒ nhiá»u dá»¯ liá»‡u Ä‘ang á»Ÿ trÃªn Ä‘Ä©a, lÃºc nÃ y hiá»‡u suáº¥t sáº½ kÃ©m má»™t chÃºt, chá»‰ cÃ³ 10% ngÆ°á»i truy cáº­p dá»¯ liá»‡u láº¡nh, 90% ngÆ°á»i Ä‘ang truy cáº­p dá»¯ liá»‡u nÃ³ng, khÃ´ng sao cáº£.</p>
<h3>Thiáº¿t káº¿ mÃ´ hÃ¬nh document</h3>
<p>Äá»‘i vá»›i MySQL, chÃºng ta thÆ°á»ng xuyÃªn cÃ³ má»™t sá»‘ truy váº¥n liÃªn káº¿t phá»©c táº¡p. Trong es, chÃºng ta nÃªn xá»­ lÃ½ nhÆ° tháº¿ nÃ o, truy váº¥n liÃªn káº¿t phá»©c táº¡p trong es nÃªn trÃ¡nh sá»­ dá»¥ng cÃ ng nhiá»u cÃ ng tá»‘t, má»™t khi sá»­ dá»¥ng, hiá»‡u suáº¥t thÆ°á»ng khÃ´ng tá»‘t.</p>
<p>Tá»‘t nháº¥t lÃ  hoÃ n thÃ nh liÃªn káº¿t trÆ°á»›c trong há»‡ thá»‘ng Java, vÃ  ghi dá»¯ liá»‡u Ä‘Ã£ liÃªn káº¿t trá»±c tiáº¿p vÃ o es. Khi tÃ¬m kiáº¿m, khÃ´ng cáº§n sá»­ dá»¥ng cÃº phÃ¡p tÃ¬m kiáº¿m cá»§a es Ä‘á»ƒ hoÃ n thÃ nh truy váº¥n liÃªn káº¿t nhÆ° join.</p>
<p>Thiáº¿t káº¿ mÃ´ hÃ¬nh document ráº¥t quan trá»ng, nhiá»u hoáº¡t Ä‘á»™ng, khÃ´ng nÃªn chá» Ä‘áº¿n khi tÃ¬m kiáº¿m má»›i thá»±c hiá»‡n cÃ¡c hoáº¡t Ä‘á»™ng phá»©c táº¡p khÃ¡c nhau. es há»— trá»£ ráº¥t nhiá»u hoáº¡t Ä‘á»™ng, khÃ´ng nÃªn cá»‘ gáº¯ng sá»­ dá»¥ng es Ä‘á»ƒ thá»±c hiá»‡n má»™t sá»‘ thao tÃ¡c mÃ  nÃ³ khÃ´ng lÃ m tá»‘t. Náº¿u thá»±c sá»± cÃ³ thao tÃ¡c nhÆ° váº­y, hÃ£y cá»‘ gáº¯ng hoÃ n thÃ nh nÃ³ khi thiáº¿t káº¿ mÃ´ hÃ¬nh document, khi ghi dá»¯ liá»‡u. NgoÃ i ra, Ä‘á»‘i vá»›i má»™t sá»‘ hoáº¡t Ä‘á»™ng quÃ¡ phá»©c táº¡p, nhÆ° join/nested/parent-child tÃ¬m kiáº¿m nÃªn trÃ¡nh cÃ ng nhiá»u cÃ ng tá»‘t, hiá»‡u suáº¥t Ä‘á»u ráº¥t kÃ©m.</p>
<h3>Tá»‘i Æ°u hÃ³a hiá»‡u suáº¥t phÃ¢n trang</h3>
<p>PhÃ¢n trang cá»§a es khÃ¡ khÃ³ khÄƒn, táº¡i sao? VÃ­ dá»¥, giáº£ sá»­ báº¡n cÃ³ 10 báº£n ghi trÃªn má»—i trang, vÃ  báº¡n muá»‘n truy váº¥n trang thá»© 100, thá»±c táº¿, nÃ³ sáº½ láº¥y 1000 báº£n ghi Ä‘áº§u tiÃªn Ä‘Æ°á»£c lÆ°u trá»¯ trÃªn má»—i shard vÃ  Ä‘Æ°a chÃºng vÃ o má»™t nÃºt Ä‘iá»u phá»‘i, náº¿u báº¡n cÃ³ 5 shard, thÃ¬ sáº½ cÃ³ 5000 báº£n ghi, sau Ä‘Ã³ nÃºt Ä‘iá»u phá»‘i sáº½ xá»­ lÃ½ vÃ  há»£p nháº¥t 5000 báº£n ghi nÃ y, sau Ä‘Ã³ láº¥y 10 báº£n ghi cuá»‘i cÃ¹ng trÃªn trang thá»© 100.</p>
<p>PhÃ¢n tÃ¡n, báº¡n muá»‘n xem 10 báº£n ghi trÃªn trang thá»© 100, khÃ´ng thá»ƒ nÃ³i ráº±ng tá»« 5 shard, má»—i shard chá»‰ xem 2 báº£n ghi, cuá»‘i cÃ¹ng há»£p nháº¥t thÃ nh 10 báº£n ghi táº¡i nÃºt Ä‘iá»u phá»‘i, pháº£i khÃ´ng? Báº¡n&nbsp;<strong>pháº£i</strong>&nbsp;láº¥y 1000 báº£n ghi tá»« má»—i shard, sau Ä‘Ã³ sáº¯p xáº¿p, lá»c, v.v., dá»±a trÃªn yÃªu cáº§u cá»§a báº¡n, sau Ä‘Ã³ phÃ¢n trang má»™t láº§n ná»¯a, láº¥y dá»¯ liá»‡u trÃªn trang thá»© 100. Khi báº¡n láº­t trang, cÃ ng sÃ¢u, má»—i shard tráº£ vá» cÃ ng nhiá»u dá»¯ liá»‡u, vÃ  thá»i gian xá»­ lÃ½ cá»§a nÃºt Ä‘iá»u phá»‘i cÃ ng lÃ¢u, ráº¥t khÃ³ chá»‹u. VÃ¬ váº­y, khi sá»­ dá»¥ng es Ä‘á»ƒ phÃ¢n trang, báº¡n sáº½ tháº¥y ráº±ng cÃ ng láº­t Ä‘áº¿n sau, cÃ ng cháº­m.</p>
<p>ChÃºng tÃ´i cÅ©ng Ä‘Ã£ gáº·p váº¥n Ä‘á» nÃ y trÆ°á»›c Ä‘Ã¢y, sá»­ dá»¥ng es Ä‘á»ƒ phÃ¢n trang, má»™t sá»‘ trang Ä‘áº§u tiÃªn chá»‰ máº¥t vÃ i chá»¥c mili giÃ¢y, khi láº­t Ä‘áº¿n trang thá»© 10 hoáº·c vÃ i chá»¥c trang, cÆ¡ báº£n máº¥t 5~10 giÃ¢y má»›i cÃ³ thá»ƒ láº¥y má»™t trang dá»¯ liá»‡u.</p>
<p>CÃ³ giáº£i phÃ¡p nÃ o khÃ´ng?</p>
<h4>KhÃ´ng cho phÃ©p phÃ¢n trang sÃ¢u (máº·c Ä‘á»‹nh hiá»‡u suáº¥t phÃ¢n trang sÃ¢u ráº¥t kÃ©m)</h4>
<p>NÃ³i vá»›i quáº£n lÃ½ sáº£n pháº©m ráº±ng, há»‡ thá»‘ng cá»§a báº¡n khÃ´ng cho phÃ©p láº­t trang quÃ¡ sÃ¢u, máº·c Ä‘á»‹nh lÃ  cÃ ng láº­t sÃ¢u, hiá»‡u suáº¥t cÃ ng kÃ©m.</p>
<h4>TÆ°Æ¡ng tá»± nhÆ° viá»‡c kÃ©o xuá»‘ng Ä‘á»ƒ hiá»ƒn thá»‹ thÃªm sáº£n pháº©m Ä‘Æ°á»£c Ä‘á» xuáº¥t trong á»©ng dá»¥ng</h4>
<p>TÆ°Æ¡ng tá»± nhÆ° trong Weibo, kÃ©o xuá»‘ng Ä‘á»ƒ lÃ m má»›i Weibo, hiá»ƒn thá»‹ tá»«ng trang, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng <code>scroll api</code>. Äá»‘i vá»›i cÃ¡ch sá»­ dá»¥ng, hÃ£y tá»± tÃ¬m kiáº¿m trÃªn internet.</p>
<p>Scroll sáº½ táº¡o ra má»™t <strong>báº£n chá»¥p toÃ n bá»™ dá»¯ liá»‡u</strong> cho báº¡n má»™t láº§n, sau Ä‘Ã³ má»—i láº§n kÃ©o xuá»‘ng Ä‘á»ƒ láº­t trang tiáº¿p theo sáº½ thÃ´ng qua viá»‡c di chuyá»ƒn <strong>con trá»</strong> <code>scroll_id</code>, nháº­n trang tiáº¿p theo nhÆ° váº­y, hiá»‡u suáº¥t sáº½ cao hÆ¡n ráº¥t nhiá»u so vá»›i hiá»‡u suáº¥t phÃ¢n trang Ä‘Ã£ nÃ³i á»Ÿ trÃªn, cÆ¡ báº£n lÃ  á»Ÿ má»©c mili giÃ¢y.</p>
<p>Tuy nhiÃªn, Ä‘iá»ƒm duy nháº¥t lÃ , Ä‘iá»u nÃ y phÃ¹ há»£p vá»›i viá»‡c láº­t trang khi kÃ©o xuá»‘ng giá»‘ng nhÆ° Weibo, <strong>khÃ´ng thá»ƒ tÃ¹y Ã½ nháº£y Ä‘áº¿n báº¥t ká»³ trang nÃ o</strong>. NghÄ©a lÃ , báº¡n khÃ´ng thá»ƒ truy cáº­p trang thá»© 10 trÆ°á»›c, sau Ä‘Ã³ Ä‘i Ä‘áº¿n trang thá»© 120, sau Ä‘Ã³ láº¡i quay láº¡i trang thá»© 58, khÃ´ng thá»ƒ nháº£y trang tÃ¹y Ã½. VÃ¬ váº­y, nhiá»u sáº£n pháº©m hiá»‡n nay khÃ´ng cho phÃ©p báº¡n tÃ¹y Ã½ láº­t trang, á»©ng dá»¥ng, cÅ©ng nhÆ° má»™t sá»‘ trang web, chá»‰ cho phÃ©p báº¡n kÃ©o xuá»‘ng, láº­t tá»«ng trang má»™t.</p>
<p>Khi khá»Ÿi táº¡o, báº¡n pháº£i chá»‰ Ä‘á»‹nh tham sá»‘ <code>scroll</code>, thÃ´ng bÃ¡o cho es cáº§n lÆ°u trá»¯ ngá»¯ cáº£nh tÃ¬m kiáº¿m nÃ y trong bao lÃ¢u. Báº¡n cáº§n Ä‘áº£m báº£o ráº±ng ngÆ°á»i dÃ¹ng sáº½ khÃ´ng tiáº¿p tá»¥c láº­t trang trong vÃ i giá», náº¿u khÃ´ng cÃ³ thá»ƒ sáº½ tháº¥t báº¡i do quÃ¡ thá»i gian.</p>
<p>NgoÃ i viá»‡c sá»­ dá»¥ng <code>scroll api</code>, báº¡n cÅ©ng cÃ³ thá»ƒ sá»­ dá»¥ng <code>search_after</code>. Ã tÆ°á»Ÿng cá»§a <code>search_after</code> lÃ  sá»­ dá»¥ng káº¿t quáº£ cá»§a trang trÆ°á»›c Ä‘á»ƒ giÃºp tÃ¬m kiáº¿m dá»¯ liá»‡u trÃªn trang tiáº¿p theo, rÃµ rÃ ng, cÃ¡ch nÃ y cÅ©ng khÃ´ng cho phÃ©p báº¡n tÃ¹y Ã½ láº­t trang, báº¡n chá»‰ cÃ³ thá»ƒ láº­t tá»«ng trang má»™t. Khi khá»Ÿi táº¡o, báº¡n cáº§n sá»­ dá»¥ng má»™t trÆ°á»ng giÃ¡ trá»‹ duy nháº¥t lÃ m trÆ°á»ng sáº¯p xáº¿p.</p>
<p><strong>1.1. Tá»‘i Æ°u hÃ³a giai Ä‘oáº¡n thiáº¿t káº¿</strong></p>
<p>(1) Dá»±a trÃªn yÃªu cáº§u tÄƒng trÆ°á»Ÿng kinh doanh, táº¡o chá»‰ má»¥c dá»±a trÃªn máº«u ngÃ y, cuá»™n chá»‰ má»¥c qua API roll over;</p>
<p>(2) Sá»­ dá»¥ng bÃ­ danh Ä‘á»ƒ quáº£n lÃ½ chá»‰ má»¥c;</p>
<p>(3) Má»—i ngÃ y vÃ o lÃºc ná»­a Ä‘Ãªm, thá»±c hiá»‡n thao tÃ¡c force_merge trÃªn chá»‰ má»¥c Ä‘á»ƒ giáº£i phÃ³ng khÃ´ng gian;</p>
<p>(4) Sá»­ dá»¥ng cÆ¡ cháº¿ phÃ¢n tÃ¡ch nÃ³ng vÃ  láº¡nh, lÆ°u trá»¯ dá»¯ liá»‡u nÃ³ng vÃ o SSD Ä‘á»ƒ cáº£i thiá»‡n hiá»‡u suáº¥t tÃ¬m kiáº¿m; dá»¯ liá»‡u láº¡nh Ä‘Æ°á»£c thu nhá» Ä‘á»‹nh ká»³ Ä‘á»ƒ giáº£m bá»›t lÆ°u trá»¯;</p>
<p>(5) Sá»­ dá»¥ng curator Ä‘á»ƒ quáº£n lÃ½ vÃ²ng Ä‘á»i chá»‰ má»¥c;</p>
<p>(6) Chá»‰ Ä‘áº·t tokenizer má»™t cÃ¡ch há»£p lÃ½ cho cÃ¡c trÆ°á»ng cáº§n phÃ¢n máº£nh;</p>
<p>(7) Giai Ä‘oáº¡n Mapping káº¿t há»£p Ä‘áº§y Ä‘á»§ cÃ¡c thuá»™c tÃ­nh cá»§a tá»«ng trÆ°á»ng, liá»‡u cÃ³ cáº§n tÃ¬m kiáº¿m, liá»‡u cÃ³ cáº§n lÆ°u trá»¯, v.vâ€¦â€¦.</p>
<p><strong>1.2. Tá»‘i Æ°u hÃ³a viáº¿t</strong></p>
<p>(1) Thiáº¿t láº­p sá»‘ lÆ°á»£ng báº£n sao lÃ  0 trÆ°á»›c khi ghi;</p>
<p>(2) Táº¯t refresh_interval trÆ°á»›c khi ghi, Ä‘áº·t lÃ  -1, vÃ´ hiá»‡u hÃ³a cÆ¡ cháº¿ lÃ m má»›i;</p>
<p>(3) Trong quÃ¡ trÃ¬nh ghi: sá»­ dá»¥ng bulk Ä‘á»ƒ ghi hÃ ng loáº¡t;</p>
<p>(4) Phá»¥c há»“i sá»‘ lÆ°á»£ng báº£n sao vÃ  khoáº£ng thá»i gian lÃ m má»›i sau khi ghi;</p>
<p>(5) Cá»‘ gáº¯ng sá»­ dá»¥ng id tá»± Ä‘á»™ng sinh.</p>
<p>1.3. Tá»‘i Æ°u hÃ³a truy váº¥n</p>
<p>(1) VÃ´ hiá»‡u hÃ³a wildcard;</p>
<p>(2) VÃ´ hiá»‡u hÃ³a terms hÃ ng loáº¡t (trÆ°á»ng há»£p hÃ ng trÄƒm hÃ ng nghÃ¬n);</p>
<p>(3) Táº­n dá»¥ng tá»‘i Ä‘a cÆ¡ cháº¿ chá»‰ má»¥c Ä‘áº£o ngÆ°á»£c, náº¿u cÃ³ thá»ƒ dÃ¹ng loáº¡i keyword thÃ¬ hÃ£y dÃ¹ng keyword;</p>
<p>(4) Khi lÆ°á»£ng dá»¯ liá»‡u lá»›n, báº¡n cÃ³ thá»ƒ Ä‘á»‹nh chá»‰ má»¥c dá»±a trÃªn thá»i gian trÆ°á»›c khi tÃ¬m kiáº¿m;</p>
<p>(5) Thiáº¿t láº­p cÆ¡ cháº¿ Ä‘á»‹nh tuyáº¿n há»£p lÃ½.</p>
<p>1.4. Tá»‘i Æ°u hÃ³a khÃ¡c</p>
<p>Tá»‘i Æ°u hÃ³a triá»ƒn khai, tá»‘i Æ°u hÃ³a kinh doanh, v.v.</p>
<p>Pháº§n nÃªu trÃªn chá»‰ Ä‘á» cáº­p Ä‘áº¿n má»™t pháº§n, ngÆ°á»i phá»ng váº¥n sáº½ cÆ¡ báº£n Ä‘Ã¡nh giÃ¡ kinh nghiá»‡m thá»±c hÃ nh hoáº·c váº­n hÃ nh trÆ°á»›c Ä‘Ã¢y cá»§a báº¡n.</p>
<h2>NguyÃªn lÃ½ hoáº¡t Ä‘á»™ng</h2>
<h3>QuÃ¡ trÃ¬nh ghi dá»¯ liá»‡u es</h3>
<ul>
<li>MÃ¡y khÃ¡ch chá»n má»™t node Ä‘á»ƒ gá»­i yÃªu cáº§u Ä‘i, node nÃ y lÃ  <code>coordinating node</code> (nÃºt Ä‘iá»u phá»‘i).</li>
<li><code>Coordinating node</code> thá»±c hiá»‡n <strong>Ä‘á»‹nh tuyáº¿n</strong> cho document, chuyá»ƒn yÃªu cáº§u Ä‘áº¿n node tÆ°Æ¡ng á»©ng (cÃ³ primary shard).</li>
<li><code>Primary shard</code> trÃªn node thá»±c táº¿ xá»­ lÃ½ yÃªu cáº§u, sau Ä‘Ã³ Ä‘á»“ng bá»™ hÃ³a dá»¯ liá»‡u vá»›i <code>replica node</code>.</li>
<li><code>Coordinating node</code> náº¿u phÃ¡t hiá»‡n <code>primary node</code> vÃ  táº¥t cáº£ <code>replica node</code> Ä‘á»u Ä‘Ã£ hoÃ n thÃ nh, thÃ¬ tráº£ káº¿t quáº£ pháº£n há»“i cho mÃ¡y khÃ¡ch.</li>
</ul>
<h3>QuÃ¡ trÃ¬nh Ä‘á»c dá»¯ liá»‡u es</h3>
<p>CÃ³ thá»ƒ truy váº¥n thÃ´ng qua <code>doc id</code>, sáº½ dá»±a vÃ o <code>doc id</code> Ä‘á»ƒ thá»±c hiá»‡n hash, xÃ¡c Ä‘á»‹nh lÃºc Ä‘Ã³ Ä‘Ã£ phÃ¢n <code>doc id</code> vÃ o shard nÃ o, tá»« shard Ä‘Ã³ truy váº¥n.</p>
<ul>
<li>MÃ¡y khÃ¡ch gá»­i yÃªu cáº§u Ä‘áº¿n <strong>báº¥t ká»³</strong> má»™t node, trá»Ÿ thÃ nh <code>coordinate node</code>.</li>
<li><code>Coordinate node</code> thá»±c hiá»‡n Ä‘á»‹nh tuyáº¿n hash cho <code>doc id</code>, chuyá»ƒn yÃªu cáº§u Ä‘áº¿n node tÆ°Æ¡ng á»©ng, lÃºc nÃ y sáº½ sá»­ dá»¥ng thuáº­t toÃ¡n <strong>round-robin ngáº«u nhiÃªn</strong>, chá»n ngáº«u nhiÃªn má»™t trong sá»‘ <code>primary shard</code> vÃ  táº¥t cáº£ cÃ¡c báº£n sao cá»§a nÃ³, Ä‘á»ƒ cÃ¢n báº±ng táº£i yÃªu cáº§u Ä‘á»c.</li>
<li>Node nháº­n yÃªu cáº§u tráº£ document cho <code>coordinate node</code>.</li>
<li><code>Coordinate node</code> tráº£ document cho mÃ¡y khÃ¡ch.</li>
</ul>
<h3>QuÃ¡ trÃ¬nh tÃ¬m kiáº¿m dá»¯ liá»‡u trong ES</h3>
<p>Äiá»ƒm máº¡nh nháº¥t cá»§a ES lÃ  thá»±c hiá»‡n tÃ¬m kiáº¿m toÃ n vÄƒn, vÃ­ dá»¥, báº¡n cÃ³ ba dá»¯ liá»‡u:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>Java is interesting</span></span>
<span class="line"><span>Java is so difficult to learn</span></span>
<span class="line"><span>J2EE is great</span></span></code></pre>
</div><p>Báº¡n tÃ¬m kiáº¿m theo tá»« khÃ³a&nbsp;<code>java</code>, nÃ³ sáº½ tÃ¬m kiáº¿m cÃ¡c&nbsp;<code>document</code>&nbsp;chá»©a&nbsp;<code>java</code>. ES sáº½ tráº£ vá» cho báº¡n: Java is interesting, Java is so difficult to learn</p>
<ul>
<li>MÃ¡y khÃ¡ch gá»­i yÃªu cáº§u Ä‘áº¿n má»™t&nbsp;<code>coordinating node</code>.</li>
<li>NÃºt Ä‘iá»u phá»‘i chuyá»ƒn yÃªu cáº§u tÃ¬m kiáº¿m Ä‘áº¿n&nbsp;<strong>táº¥t cáº£</strong>&nbsp;<code>primary shard</code> hoáº·c&nbsp;<code>replica shard</code>&nbsp;tÆ°Æ¡ng á»©ng.</li>
<li>Giai Ä‘oáº¡n truy váº¥n (query phase): má»—i shard sáº½ tráº£ láº¡i káº¿t quáº£ tÃ¬m kiáº¿m cá»§a mÃ¬nh (thá»±c táº¿ chá»‰ lÃ  má»™t sá»‘&nbsp;<code>doc id</code>) cho nÃºt Ä‘iá»u phá»‘i, nÃºt Ä‘iá»u phá»‘i thá»±c hiá»‡n cÃ¡c hoáº¡t Ä‘á»™ng nhÆ° há»£p nháº¥t dá»¯ liá»‡u, sáº¯p xáº¿p, phÃ¢n trang, etc., Ä‘á»ƒ táº¡o ra káº¿t quáº£ cuá»‘i cÃ¹ng.</li>
<li>Giai Ä‘oáº¡n láº¥y (fetch phase): sau Ä‘Ã³, nÃºt Ä‘iá»u phá»‘i sáº½&nbsp;<strong>láº¥y</strong>&nbsp;dá»¯ liá»‡u&nbsp;<code>document</code>&nbsp;thá»±c táº¿ tá»« cÃ¡c node dá»±a trÃªn&nbsp;<code>doc id</code>, vÃ  cuá»‘i cÃ¹ng tráº£ láº¡i cho mÃ¡y khÃ¡ch.</li>
</ul>
<blockquote>
<p>YÃªu cáº§u ghi Ä‘Æ°á»£c ghi vÃ o primary shard, sau Ä‘Ã³ Ä‘á»“ng bá»™ hÃ³a vá»›i táº¥t cáº£ cÃ¡c replica shard; yÃªu cáº§u Ä‘á»c cÃ³ thá»ƒ Ä‘Æ°á»£c Ä‘á»c tá»« primary shard hoáº·c replica shard, sá»­ dá»¥ng thuáº­t toÃ¡n round-robin.</p>
</blockquote>
<h3>NguyÃªn lÃ½ cÆ¡ báº£n khi ghi dá»¯ liá»‡u</h3>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240223111949.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure>
<p>Äáº§u tiÃªn, dá»¯ liá»‡u sáº½ Ä‘Æ°á»£c ghi vÃ o bá»™ Ä‘á»‡m trong bá»™ nhá»› (buffer), trong quÃ¡ trÃ¬nh nÃ y dá»¯ liá»‡u khÃ´ng thá»ƒ Ä‘Æ°á»£c tÃ¬m kiáº¿m; Ä‘á»“ng thá»i dá»¯ liá»‡u cÅ©ng Ä‘Æ°á»£c ghi vÃ o tá»‡p nháº­t kÃ½ translog.</p>
<p>Náº¿u bá»™ Ä‘á»‡m gáº§n nhÆ° Ä‘áº§y, hoáº·c sau má»™t khoáº£ng thá»i gian nháº¥t Ä‘á»‹nh, dá»¯ liá»‡u trong bá»™ Ä‘á»‡m sáº½ Ä‘Æ°á»£c&nbsp;<code>refresh</code>&nbsp;vÃ o má»™t&nbsp;<code>segment file</code>&nbsp;má»›i, nhÆ°ng lÃºc nÃ y dá»¯ liá»‡u khÃ´ng Ä‘Æ°á»£c ghi trá»±c tiáº¿p vÃ o tá»‡p&nbsp;<code>segment file</code> trÃªn Ä‘Ä©a, mÃ  pháº£i Ä‘i vÃ o&nbsp;<code>os cache</code>&nbsp;trÆ°á»›c. QuÃ¡ trÃ¬nh nÃ y Ä‘Æ°á»£c gá»i lÃ &nbsp;<code>refresh</code>.</p>
<p>Má»—i giÃ¢y, ES sáº½ ghi dá»¯ liá»‡u trong bá»™ Ä‘á»‡m vÃ o má»™t&nbsp;<code>segment file</code>&nbsp;<strong>má»›i</strong>, má»—i giÃ¢y sáº½ táº¡o ra má»™t tá»‡p Ä‘Ä©a <code>segment file</code>&nbsp;<strong>má»›i</strong>, tá»‡p&nbsp;<code>segment file</code> nÃ y sáº½ lÆ°u trá»¯ dá»¯ liá»‡u Ä‘Æ°á»£c ghi vÃ o bá»™ Ä‘á»‡m trong 1 giÃ¢y gáº§n Ä‘Ã¢y.</p>
<p>Tuy nhiÃªn, náº¿u khÃ´ng cÃ³ dá»¯ liá»‡u trong bá»™ Ä‘á»‡m, thÃ¬ táº¥t nhiÃªn khÃ´ng cÃ³ quÃ¡ trÃ¬nh refresh nÃ o Ä‘Æ°á»£c thá»±c hiá»‡n, náº¿u cÃ³ dá»¯ liá»‡u trong bá»™ Ä‘á»‡m, máº·c Ä‘á»‹nh sáº½ thá»±c hiá»‡n má»™t láº§n refresh má»—i giÃ¢y, Ä‘áº©y dá»¯ liá»‡u vÃ o má»™t&nbsp;<code>segment file</code>&nbsp;má»›i.</p>
<p>TrÃªn há»‡ Ä‘iá»u hÃ nh, tá»‡p Ä‘Ä©a thá»±c táº¿ Ä‘á»u cÃ³ má»™t thá»© gá»i lÃ &nbsp;<code>os cache</code>, tá»©c lÃ  trÆ°á»›c khi dá»¯ liá»‡u Ä‘Æ°á»£c ghi vÃ o tá»‡p Ä‘Ä©a, nÃ³ sáº½ Ä‘Æ°á»£c Ä‘Æ°a vÃ o&nbsp;<code>os cache</code> trÆ°á»›c, Ä‘áº§u tiÃªn vÃ o bá»™ nhá»› cache cáº¥p há»‡ Ä‘iá»u hÃ nh. Chá»‰ cáº§n dá»¯ liá»‡u trong bá»™ Ä‘á»‡m Ä‘Æ°á»£c chuyá»ƒn vÃ o&nbsp;<code>os cache</code>&nbsp;thÃ´ng qua hoáº¡t Ä‘á»™ng refresh, dá»¯ liá»‡u nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m kiáº¿m.</p>
<p>Táº¡i sao nÃ³i ráº±ng ES lÃ &nbsp;<strong>gáº§n nhÆ° thá»i gian thá»±c</strong>?&nbsp;<code>NRT</code>, tÃªn Ä‘áº§y Ä‘á»§ lÃ &nbsp;<code>near real-time</code>. Máº·c Ä‘á»‹nh lÃ  refresh má»—i giÃ¢y má»™t láº§n, vÃ¬ váº­y ES lÃ  gáº§n nhÆ° thá»i gian thá»±c, vÃ¬ dá»¯ liá»‡u Ä‘Æ°á»£c ghi vÃ o sau 1 giÃ¢y má»›i cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m tháº¥y. Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng&nbsp;<code>restful api</code>&nbsp;cá»§a es hoáº·c&nbsp;<code>java api</code>&nbsp;Ä‘á»ƒ thá»±c hiá»‡n má»™t hoáº¡t Ä‘á»™ng refresh&nbsp;<strong>thá»§ cÃ´ng</strong>, tá»©c lÃ  thá»§ cÃ´ng Ä‘Æ°a dá»¯ liá»‡u trong bá»™ Ä‘á»‡m vÃ o&nbsp;<code>os cache</code>, Ä‘á»ƒ dá»¯ liá»‡u cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m kiáº¿m ngay láº­p tá»©c. Miá»…n lÃ  dá»¯ liá»‡u Ä‘Æ°á»£c Ä‘Æ°a vÃ o&nbsp;<code>os cache</code>, bá»™ Ä‘á»‡m sáº½ Ä‘Æ°á»£c lÃ m sáº¡ch, vÃ¬ khÃ´ng cáº§n giá»¯ bá»™ Ä‘á»‡m ná»¯a, dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c lÆ°u trá»¯ trong tá»‡p nháº­t kÃ½ translog má»™t láº§n.</p>
<p>Láº·p láº¡i cÃ¡c bÆ°á»›c trÃªn, dá»¯ liá»‡u má»›i liÃªn tá»¥c vÃ o bá»™ Ä‘á»‡m vÃ  translog, liÃªn tá»¥c ghi dá»¯ liá»‡u&nbsp;<code>buffer</code>&nbsp;vÃ o má»™t&nbsp;<code>segment file</code>&nbsp;má»›i sau má»—i láº§n&nbsp;<code>refresh</code>, sau má»—i láº§n&nbsp;<code>refresh</code>&nbsp;bá»™ Ä‘á»‡m sáº½ Ä‘Æ°á»£c lÃ m sáº¡ch, translog sáº½ Ä‘Æ°á»£c giá»¯ láº¡i. Khi quÃ¡ trÃ¬nh nÃ y tiáº¿p diá»…n, translog sáº½ ngÃ y cÃ ng lá»›n. Khi translog Ä‘áº¡t Ä‘áº¿n má»™t Ä‘á»™ dÃ i nháº¥t Ä‘á»‹nh, nÃ³ sáº½ kÃ­ch hoáº¡t hoáº¡t Ä‘á»™ng&nbsp;<code>commit</code>.</p>
<p>BÆ°á»›c Ä‘áº§u tiÃªn cá»§a hoáº¡t Ä‘á»™ng commit lÃ  ghi dá»¯ liá»‡u hiá»‡n cÃ³ trong bá»™ Ä‘á»‡m vÃ o&nbsp;<code>os cache</code>, sau Ä‘Ã³ lÃ m sáº¡ch bá»™ Ä‘á»‡m. Sau Ä‘Ã³, ghi má»™t&nbsp;<code>commit point</code>&nbsp;vÃ o tá»‡p Ä‘Ä©a, trong Ä‘Ã³ Ä‘Ã¡nh dáº¥u táº¥t cáº£ cÃ¡c&nbsp;<code>segment file</code>&nbsp;tÆ°Æ¡ng á»©ng vá»›i&nbsp;<code>commit point</code>&nbsp;nÃ y, Ä‘á»“ng thá»i buá»™c&nbsp;<code>os cache</code>&nbsp;chá»©a táº¥t cáº£ dá»¯ liá»‡u hiá»‡n táº¡i Ä‘á»ƒ Ä‘Æ°á»£c&nbsp;<code>fsync</code>&nbsp;vÃ o tá»‡p Ä‘Ä©a. Cuá»‘i cÃ¹ng,&nbsp;<strong>xÃ³a</strong>&nbsp;tá»‡p nháº­t kÃ½ translog hiá»‡n táº¡i, khá»Ÿi Ä‘á»™ng láº¡i má»™t translog, lÃºc nÃ y hoáº¡t Ä‘á»™ng commit Ä‘Ã£ hoÃ n thÃ nh.</p>
<p>Hoáº¡t Ä‘á»™ng commit nÃ y Ä‘Æ°á»£c gá»i lÃ &nbsp;<code>flush</code>. Máº·c Ä‘á»‹nh lÃ  má»—i 30 phÃºt tá»± Ä‘á»™ng thá»±c hiá»‡n má»™t láº§n&nbsp;<code>flush</code>, nhÆ°ng náº¿u translog quÃ¡ lá»›n, cÅ©ng sáº½ kÃ­ch hoáº¡t&nbsp;<code>flush</code>. Hoáº¡t Ä‘á»™ng flush tÆ°Æ¡ng á»©ng vá»›i toÃ n bá»™ quÃ¡ trÃ¬nh commit, chÃºng ta cÃ³ thá»ƒ thÃ´ng qua api cá»§a es, thá»±c hiá»‡n thá»§ cÃ´ng hoáº¡t Ä‘á»™ng flush, thá»§ cÃ´ng&nbsp;<code>fsync</code>&nbsp;dá»¯ liá»‡u trong&nbsp;<code>os cache</code>&nbsp;vÃ o Ä‘Ä©a.</p>
<p>Tá»‡p nháº­t kÃ½ translog cÃ³ vai trÃ² gÃ¬? TrÆ°á»›c khi báº¡n thá»±c hiá»‡n hoáº¡t Ä‘á»™ng commit, dá»¯ liá»‡u cÃ³ thá»ƒ Ä‘ang náº±m trong bá»™ Ä‘á»‡m hoáº·c náº±m trong&nbsp;<code>os cache</code>. DÃ¹ lÃ  bá»™ Ä‘á»‡m hay&nbsp;<code>os cache</code>&nbsp;Ä‘á»u lÃ  bá»™ nhá»›, náº¿u mÃ¡y nÃ y bá»‹ há»ng, dá»¯ liá»‡u trong bá»™ nhá»› sáº½ máº¥t háº¿t. VÃ¬ váº­y, cáº§n ghi cÃ¡c hoáº¡t Ä‘á»™ng tÆ°Æ¡ng á»©ng cá»§a dá»¯ liá»‡u vÃ o má»™t tá»‡p nháº­t kÃ½ Ä‘áº·c biá»‡t lÃ &nbsp;<code>translog</code>, náº¿u mÃ¡y bá»‹ há»ng lÃºc nÃ y, khi khá»Ÿi Ä‘á»™ng láº¡i, es sáº½ tá»± Ä‘á»™ng Ä‘á»c dá»¯ liá»‡u tá»« tá»‡p nháº­t kÃ½ translog vÃ  phá»¥c há»“i vÃ o bá»™ nhá»›&nbsp;<code>buffer</code>&nbsp;vÃ &nbsp;<code>os cache</code>.</p>
<p>Thá»±c táº¿, translog cÅ©ng Ä‘Æ°á»£c ghi vÃ o&nbsp;<code>os cache</code>&nbsp;trÆ°á»›c, máº·c Ä‘á»‹nh lÃ  má»—i 5 giÃ¢y sáº½ Ä‘áº©y vÃ o Ä‘Ä©a má»™t láº§n, vÃ¬ váº­y máº·c Ä‘á»‹nh, cÃ³ thá»ƒ cÃ³ 5 giÃ¢y dá»¯ liá»‡u chá»‰ náº±m trong bá»™ Ä‘á»‡m hoáº·c <code>os cache</code> hoáº·c tá»‡p translog, khÃ´ng náº±m trÃªn Ä‘Ä©a, náº¿u mÃ¡y nÃ y bá»‹ há»ng lÃºc nÃ y, sáº½&nbsp;<strong>máº¥t</strong>&nbsp;5 giÃ¢y dá»¯ liá»‡u. NhÆ°ng hiá»‡u suáº¥t nhÆ° váº­y tá»‘t hÆ¡n, máº¥t tá»‘i Ä‘a 5 giÃ¢y dá»¯ liá»‡u. Báº¡n cÅ©ng cÃ³ thá»ƒ Ä‘áº·t translog Ä‘á»ƒ má»—i láº§n ghi pháº£i&nbsp;<code>fsync</code>&nbsp;trá»±c tiáº¿p vÃ o Ä‘Ä©a, nhÆ°ng hiá»‡u suáº¥t sáº½ kÃ©m hÆ¡n nhiá»u.</p>
<p>Thá»±c táº¿, náº¿u báº¡n á»Ÿ Ä‘Ã¢y, náº¿u ngÆ°á»i phá»ng váº¥n khÃ´ng há»i báº¡n vá» váº¥n Ä‘á» máº¥t dá»¯ liá»‡u cá»§a es, báº¡n cÃ³ thá»ƒ tá»± hÃ o vá»›i ngÆ°á»i phá»ng váº¥n á»Ÿ Ä‘Ã¢y, báº¡n nÃ³i, thá»±c táº¿ es trÆ°á»›c tiÃªn lÃ  gáº§n nhÆ° thá»i gian thá»±c, dá»¯ liá»‡u Ä‘Æ°á»£c ghi vÃ o sau 1 giÃ¢y má»›i cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m tháº¥y; cÃ³ thá»ƒ máº¥t dá»¯ liá»‡u. CÃ³ 5 giÃ¢y dá»¯ liá»‡u, náº±m trong bá»™ Ä‘á»‡m,&nbsp;<code>os cache</code>&nbsp;cá»§a translog,&nbsp;<code>os cache</code>&nbsp;cá»§a&nbsp;<code>segment file</code>, khÃ´ng náº±m trÃªn Ä‘Ä©a, náº¿u mÃ¡y nÃ y bá»‹ há»ng lÃºc nÃ y, sáº½ dáº«n Ä‘áº¿n&nbsp;<strong>máº¥t</strong>&nbsp;5 giÃ¢y dá»¯ liá»‡u.</p>
<p><strong>TÃ³m láº¡i</strong>, dá»¯ liá»‡u Ä‘Æ°á»£c ghi vÃ o bá»™ Ä‘á»‡m trÆ°á»›c, sau Ä‘Ã³ má»—i giÃ¢y, dá»¯ liá»‡u sáº½ Ä‘Æ°á»£c refresh vÃ o&nbsp;<code>os cache</code>, khi dá»¯ liá»‡u Ä‘áº¿n&nbsp;<code>os cache</code>, dá»¯ liá»‡u cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m kiáº¿m (Ä‘Ã³ lÃ  lÃ½ do táº¡i sao chÃºng ta nÃ³i ráº±ng tá»« khi dá»¯ liá»‡u Ä‘Æ°á»£c ghi vÃ o cho Ä‘áº¿n khi cÃ³ thá»ƒ tÃ¬m kiáº¿m, cÃ³ Ä‘á»™ trá»… 1s). Má»—i 5 giÃ¢y, dá»¯ liá»‡u sáº½ Ä‘Æ°á»£c ghi vÃ o tá»‡p translog (do Ä‘Ã³, náº¿u mÃ¡y bá»‹ há»ng, táº¥t cáº£ dá»¯ liá»‡u trong bá»™ nhá»› sáº½ máº¥t, tá»‘i Ä‘a sáº½ máº¥t 5s dá»¯ liá»‡u), khi translog lá»›n Ä‘áº¿n má»™t má»©c Ä‘á»™ nháº¥t Ä‘á»‹nh, hoáº·c máº·c Ä‘á»‹nh má»—i 30 phÃºt, má»™t hoáº¡t Ä‘á»™ng commit sáº½ Ä‘Æ°á»£c kÃ­ch hoáº¡t, Ä‘áº©y táº¥t cáº£ dá»¯ liá»‡u trong bá»™ Ä‘á»‡m vÃ o tá»‡p&nbsp;<code>segment file</code>trÃªn Ä‘Ä©a.</p>
<blockquote>
<p>Sau khi dá»¯ liá»‡u Ä‘Æ°á»£c ghi vÃ o&nbsp;<code>segment file</code>, chá»‰ má»¥c Ä‘áº£o ngÆ°á»£c cÅ©ng sáº½ Ä‘Æ°á»£c táº¡o ngay láº­p tá»©c.</p>
</blockquote>
<h3>NguyÃªn lÃ½ cÆ¡ báº£n khi xÃ³a/cáº­p nháº­t dá»¯ liá»‡u</h3>
<p>Náº¿u lÃ  hoáº¡t Ä‘á»™ng xÃ³a, khi commit sáº½ táº¡o ra má»™t tá»‡p&nbsp;<code>.del</code>, trong Ä‘Ã³ Ä‘Ã¡nh dáº¥u má»™t doc nháº¥t Ä‘á»‹nh lÃ  tráº¡ng thÃ¡i&nbsp;<code>deleted</code>, vÃ¬ váº­y khi tÃ¬m kiáº¿m, dá»±a vÃ o tá»‡p&nbsp;<code>.del</code>, báº¡n sáº½ biáº¿t liá»‡u doc cÃ³ bá»‹ xÃ³a hay khÃ´ng.</p>
<p>Náº¿u lÃ  hoáº¡t Ä‘á»™ng cáº­p nháº­t, nÃ³ sáº½ Ä‘Ã¡nh dáº¥u doc gá»‘c lÃ  tráº¡ng thÃ¡i&nbsp;<code>deleted</code>&nbsp;vÃ  sau Ä‘Ã³ ghi má»™t dá»¯ liá»‡u má»›i.</p>
<p>Má»—i khi bá»™ Ä‘á»‡m Ä‘Æ°á»£c refresh, má»™t&nbsp;<code>segment file</code>&nbsp;sáº½ Ä‘Æ°á»£c táº¡o ra, vÃ¬ váº­y máº·c Ä‘á»‹nh lÃ  má»™t&nbsp;<code>segment file</code>&nbsp;má»—i giÃ¢y, vÃ¬ váº­y&nbsp;<code>segment file</code>&nbsp;sáº½ ngÃ y cÃ ng nhiá»u, lÃºc nÃ y sáº½ thÆ°á»ng xuyÃªn thá»±c hiá»‡n merge. Má»—i láº§n merge, nhiá»u&nbsp;<code>segment file</code>&nbsp;sáº½ Ä‘Æ°á»£c há»£p nháº¥t thÃ nh má»™t, Ä‘á»“ng thá»i á»Ÿ Ä‘Ã¢y, doc Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u lÃ &nbsp;<code>deleted</code>&nbsp;sáº½ Ä‘Æ°á»£c&nbsp;<strong>xÃ³a váº­t lÃ½</strong>, sau Ä‘Ã³ ghi&nbsp;<code>segment file</code>&nbsp;má»›i vÃ o Ä‘Ä©a, á»Ÿ Ä‘Ã¢y sáº½ ghi má»™t&nbsp;<code>commit point</code>, Ä‘Ã¡nh dáº¥u táº¥t cáº£&nbsp;<code>segment file</code>&nbsp;má»›i, sau Ä‘Ã³ má»Ÿ&nbsp;<code>segment file</code>&nbsp;Ä‘á»ƒ tÃ¬m kiáº¿m, vÃ  sau Ä‘Ã³ xÃ³a&nbsp;<code>segment file</code>&nbsp;cÅ©.</p>
<h3>Lá»›p cÆ¡ báº£n Lucene</h3>
<p>ÄÆ¡n giáº£n, Lucene chá»‰ lÃ  má»™t thÆ° viá»‡n jar, bÃªn trong nÃ³ chá»©a cÃ¡c mÃ£ thuáº­t toÃ¡n Ä‘Ã£ Ä‘Æ°á»£c Ä‘Ã³ng gÃ³i Ä‘á»ƒ táº¡o chá»‰ má»¥c Ä‘áº£o ngÆ°á»£c. Khi chÃºng ta phÃ¡t triá»ƒn báº±ng Java, chÃºng ta chá»‰ cáº§n import thÆ° viá»‡n jar Lucene, sau Ä‘Ã³ phÃ¡t triá»ƒn dá»±a trÃªn API cá»§a Lucene.</p>
<p>ThÃ´ng qua Lucene, chÃºng ta cÃ³ thá»ƒ táº¡o chá»‰ má»¥c cho dá»¯ liá»‡u hiá»‡n cÃ³, Lucene sáº½ tá»• chá»©c cáº¥u trÃºc dá»¯ liá»‡u chá»‰ má»¥c trÃªn á»• Ä‘Ä©a cá»¥c bá»™ cho chÃºng ta.</p>
<h3>Chá»‰ má»¥c Ä‘áº£o ngÆ°á»£c</h3>
<p>Trong cÃ´ng cá»¥ tÃ¬m kiáº¿m, má»—i tÃ i liá»‡u Ä‘á»u cÃ³ má»™t ID tÃ i liá»‡u tÆ°Æ¡ng á»©ng, ná»™i dung tÃ i liá»‡u Ä‘Æ°á»£c biá»ƒu diá»…n dÆ°á»›i dáº¡ng má»™t táº­p há»£p cÃ¡c tá»« khÃ³a. VÃ­ dá»¥, sau khi phÃ¢n loáº¡i, tÃ i liá»‡u 1 Ä‘Ã£ trÃ­ch xuáº¥t 20 tá»« khÃ³a, má»—i tá»« khÃ³a Ä‘á»u ghi láº¡i sá»‘ láº§n xuáº¥t hiá»‡n vÃ  vá»‹ trÃ­ xuáº¥t hiá»‡n cá»§a nÃ³ trong tÃ i liá»‡u.</p>
<p>Váº­y, chá»‰ má»¥c Ä‘áº£o ngÆ°á»£c lÃ  Ã¡nh xáº¡ tá»«&nbsp;<strong>tá»« khÃ³a Ä‘áº¿n ID tÃ i liá»‡u</strong>, má»—i tá»« khÃ³a Ä‘á»u tÆ°Æ¡ng á»©ng vá»›i má»™t loáº¡t tÃ i liá»‡u, trong Ä‘Ã³ táº¥t cáº£ cÃ¡c tÃ i liá»‡u Ä‘á»u xuáº¥t hiá»‡n tá»« khÃ³a.</p>
<p>VÃ­ dá»¥.</p>
<p>CÃ³ cÃ¡c tÃ i liá»‡u sau:</p>
<p>| DocId | Doc                                                                           |<br>
|</p>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240223081955.png" type="image/png"/>
    </item>
    <item>
      <title>Elasticsearch Intro</title>
      <link>https://vanhung4499.github.io/database/elasticsearch/intro.html</link>
      <guid>https://vanhung4499.github.io/database/elasticsearch/intro.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Elasticsearch Intro</source>
      <description>Giá»›i thiá»‡u vá» Elasticsearch Elasticsearch lÃ  má»™t cÃ´ng cá»¥ tÃ¬m kiáº¿m vÃ  phÃ¢n tÃ­ch dá»¯ liá»‡u dá»±a trÃªn Lucene, cung cáº¥p má»™t dá»‹ch vá»¥ phÃ¢n tÃ¡n. Elasticsearch lÃ  má»™t sáº£n pháº©m mÃ£ nguá»“n má»Ÿ ...</description>
      <category>elasticssearch</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<p>Elasticsearch lÃ  má»™t cÃ´ng cá»¥ tÃ¬m kiáº¿m vÃ  phÃ¢n tÃ­ch dá»¯ liá»‡u dá»±a trÃªn Lucene, cung cáº¥p má»™t dá»‹ch vá»¥ phÃ¢n tÃ¡n. Elasticsearch lÃ  má»™t sáº£n pháº©m mÃ£ nguá»“n má»Ÿ tuÃ¢n thá»§ cÃ¡c Ä‘iá»u khoáº£n mÃ£ nguá»“n má»Ÿ cá»§a Apache vÃ  hiá»‡n lÃ  cÃ´ng cá»¥ tÃ¬m kiáº¿m cáº¥p doanh nghiá»‡p phá»• biáº¿n hiá»‡n nay.</p>
<p>NÃ³ Ä‘Æ°á»£c sá»­ dá»¥ng cho tÃ¬m kiáº¿m toÃ n vÄƒn báº£n, tÃ¬m kiáº¿m cÃ³ cáº¥u trÃºc, phÃ¢n tÃ­ch, vÃ  káº¿t há»£p ba yáº¿u tá»‘ nÃ y:</p>
<ul>
<li>Wikipedia sá»­ dá»¥ng Elasticsearch Ä‘á»ƒ cung cáº¥p tÃ¬m kiáº¿m toÃ n vÄƒn báº£n vá»›i Ä‘Ã¡nh dáº¥u tá»« khÃ³a, cÅ©ng nhÆ° cÃ¡c tÃ­nh nÄƒng Ä‘á» xuáº¥t tÃ¬m kiáº¿m nhÆ°&nbsp;<strong>tÃ¬m kiáº¿m thá»i gian thá»±c (search-as-you-type)</strong>&nbsp;vÃ &nbsp;<strong>sá»­a lá»—i tÃ¬m kiáº¿m (did-you-mean)</strong>.</li>
<li>The Guardian sá»­ dá»¥ng Elasticsearch Ä‘á»ƒ cung cáº¥p pháº£n há»“i thá»i gian thá»±c cho biÃªn táº­p viÃªn cá»§a há» báº±ng cÃ¡ch káº¿t há»£p dá»¯ liá»‡u nháº­t kÃ½ ngÆ°á»i dÃ¹ng vÃ  dá»¯ liá»‡u máº¡ng xÃ£ há»™i, giÃºp há» hiá»ƒu rÃµ pháº£n á»©ng cá»§a cÃ´ng chÃºng Ä‘á»‘i vá»›i cÃ¡c bÃ i viáº¿t má»›i xuáº¥t báº£n.</li>
<li>StackOverflow káº¿t há»£p tÃ¬m kiáº¿m toÃ n vÄƒn báº£n vá»›i truy váº¥n vá»‹ trÃ­ Ä‘á»‹a lÃ½ vÃ  tÃ­nh nÄƒng&nbsp;<strong>more-like-this</strong>&nbsp;Ä‘á»ƒ tÃ¬m cÃ¡c cÃ¢u há»i vÃ  cÃ¢u tráº£ lá»i liÃªn quan.</li>
<li>Github sá»­ dá»¥ng Elasticsearch Ä‘á»ƒ tÃ¬m kiáº¿m 130 tá»· dÃ²ng code. (sá»‘ liá»‡u cÃ³ thá»ƒ thay Ä‘á»•i hÃ ng giá» nÃªn cÃ³ thá»ƒ sai lá»‡ch táº¡i thá»i Ä‘iá»ƒm viáº¿t)</li>
</ul>
<h2>Äáº·c Ä‘iá»ƒm cá»§a Elasticsearch</h2>
<ul>
<li>LÆ°u trá»¯ tá»‡p thá»i gian thá»±c phÃ¢n tÃ¡n, vá»›i má»—i trÆ°á»ng Ä‘Æ°á»£c láº­p chá»‰ má»¥c vÃ  cÃ³ thá»ƒ tÃ¬m kiáº¿m.</li>
<li>CÃ´ng cá»¥ tÃ¬m kiáº¿m phÃ¢n tÃ­ch thá»i gian thá»±c phÃ¢n tÃ¡n.</li>
<li>CÃ³ thá»ƒ má»Ÿ rá»™ng linh hoáº¡t lÃªn Ä‘áº¿n hÃ ng trÄƒm mÃ¡y chá»§, xá»­ lÃ½ dá»¯ liá»‡u cÃ³ cáº¥u trÃºc hoáº·c khÃ´ng cÃ³ cáº¥u trÃºc á»Ÿ cáº¥p petabyte.</li>
<li>Sáºµn sÃ ng sá»­ dá»¥ng ngay sau khi cÃ i Ä‘áº·t, nÃ³ cung cáº¥p nhiá»u giÃ¡ trá»‹ máº·c Ä‘á»‹nh há»£p lÃ½ vÃ  áº©n Ä‘i lÃ½ thuyáº¿t cÃ´ng cá»¥ tÃ¬m kiáº¿m phá»©c táº¡p Ä‘á»‘i vá»›i ngÆ°á»i má»›i há»c. NÃ³ cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng trong mÃ´i trÆ°á»ng product vá»›i yÃªu cáº§u há»c táº­p tá»‘i thiá»ƒu.</li>
</ul>
<h2>Lá»‹ch sá»­ phÃ¡t triá»ƒn cá»§a Elasticsearch</h2>
<ul>
<li>NgÃ y 8 thÃ¡ng 2 nÄƒm 2010, phiÃªn báº£n cÃ´ng khai Ä‘áº§u tiÃªn cá»§a Elasticsearch Ä‘Ã£ Ä‘Æ°á»£c phÃ¡t hÃ nh.</li>
<li>NgÃ y 14 thÃ¡ng 5 nÄƒm 2010, phiÃªn báº£n ban Ä‘áº§u mang tÃ­nh bÆ°á»›c ngoáº·t <strong>0.7.0</strong> Ä‘Æ°á»£c phÃ¡t hÃ nh, vá»›i cÃ¡c tÃ­nh nÄƒng:
<ul>
<li>MÃ´-Ä‘un Zen Discovery tá»± Ä‘á»™ng phÃ¡t hiá»‡n;
<ul>
<li>Há»— trá»£ cho Groovy Client;</li>
</ul>
</li>
<li>CÆ¡ cháº¿ quáº£n lÃ½ plugin Ä‘Æ¡n giáº£n;
<ul>
<li>Há»— trá»£ tá»‘t hÆ¡n cho bá»™ tÃ¡ch tá»« icu;</li>
</ul>
</li>
<li>Nhiá»u API quáº£n lÃ½ hÆ¡n.</li>
</ul>
</li>
<li>Äáº§u nÄƒm 2013, GitHub tá»« bá» Solr vÃ  chá»n Elasticsearch Ä‘á»ƒ thá»±c hiá»‡n tÃ¬m kiáº¿m cáº¥p PB cá»§a mÃ¬nh.</li>
<li>NgÃ y 14 thÃ¡ng 2 nÄƒm 2014, phiÃªn báº£n <strong>1.0.0</strong> Ä‘Æ°á»£c phÃ¡t hÃ nh, thÃªm cÃ¡c tÃ­nh nÄƒng quan trá»ng sau:
<ul>
<li>Há»— trá»£ cho Snapshot/Restore API backup recovery API;
<ul>
<li>Há»— trá»£ cho Aggregations;</li>
</ul>
</li>
<li>Há»— trá»£ cho cat API;
<ul>
<li>Há»— trá»£ cho circuit breakers;</li>
</ul>
</li>
<li>Giá»›i thiá»‡u Doc values.</li>
</ul>
</li>
<li>NgÃ y 28 thÃ¡ng 10 nÄƒm 2015, phiÃªn báº£n <strong>2.0.0</strong> Ä‘Æ°á»£c phÃ¡t hÃ nh, vá»›i cÃ¡c tÃ­nh nÄƒng quan trá»ng sau:
<ul>
<li>ThÃªm Pipleline Aggregations;
<ul>
<li>Query/filter query merging, táº¥t cáº£ Ä‘Æ°á»£c há»£p nháº¥t vÃ o query, thá»±c hiá»‡n cÃ¡c truy váº¥n khÃ¡c nhau theo cÃ¡c ngá»¯ cáº£nh khÃ¡c nhau;</li>
</ul>
</li>
<li>Cáº¥u hÃ¬nh lÆ°u trá»¯ nÃ©n;
<ul>
<li>MÃ´-Ä‘un Rivers Ä‘Ã£ bá»‹ loáº¡i bá»;</li>
</ul>
</li>
<li>TÃ­nh nÄƒng Multicast Ä‘Ã£ bá»‹ loáº¡i bá», trá»Ÿ thÃ nh má»™t plugin, vÃ  má»™t Ä‘á»‹a chá»‰ unicast pháº£i Ä‘Æ°á»£c cáº¥u hÃ¬nh trong mÃ´i trÆ°á»ng sáº£n xuáº¥t.</li>
</ul>
</li>
<li>NgÃ y 26 thÃ¡ng 10 nÄƒm 2016, phiÃªn báº£n <strong>5.0.0</strong> Ä‘Æ°á»£c phÃ¡t hÃ nh, vá»›i cÃ¡c thay Ä‘á»•i tÃ­nh nÄƒng lá»›n sau:
<ul>
<li>Há»— trá»£ cho Lucene 6.x, giáº£m má»™t ná»­a khÃ´ng gian Ä‘Ä©a; giáº£m má»™t ná»­a thá»i gian láº­p chá»‰ má»¥c; tÄƒng 25% hiá»‡u suáº¥t truy váº¥n; há»— trá»£ cho IPV6;</li>
<li>KhÃ³a Ä‘ua Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ trÃ¡nh cáº­p nháº­t Ä‘á»“ng thá»i cá»§a cÃ¹ng má»™t tÃ i liá»‡u Ä‘Ã£ Ä‘Æ°á»£c loáº¡i bá» á»Ÿ cáº¥p Internal Engine, dáº«n Ä‘áº¿n cáº£i thiá»‡n hiá»‡u suáº¥t 15%-20%;</li>
<li>Shrink API, cÃ³ thá»ƒ thu nhá» sá»‘ lÆ°á»£ng shard thÃ nh cÃ¡c yáº¿u tá»‘ cá»§a nÃ³, vÃ­ dá»¥ nhÆ° náº¿u trÆ°á»›c Ä‘Ã¢y báº¡n cÃ³ 15 shard, báº¡n cÃ³ thá»ƒ thu nhá» thÃ nh 5 hoáº·c 3 hoáº·c 1, vÃ¬ váº­y chÃºng ta cÃ³ thá»ƒ tÆ°á»Ÿng tÆ°á»£ng má»™t tÃ¬nh huá»‘ng nhÆ° tháº¿ nÃ y, trong giai Ä‘oáº¡n thu tháº­p mÃ  Ã¡p lá»±c ghi lÃ  ráº¥t lá»›n, Ä‘áº·t Ä‘á»§ chá»‰ má»¥c, táº­n dá»¥ng tá»‘i Ä‘a kháº£ nÄƒng ghi song song cá»§a shard, sau khi chá»‰ má»¥c Ä‘Æ°á»£c viáº¿t, thu nhá» thÃ nh Ã­t shard hÆ¡n, cáº£i thiá»‡n hiá»‡u suáº¥t truy váº¥n;
<ul>
<li>Cung cáº¥p SDK client REST gá»‘c Java Ä‘áº§u tiÃªn;</li>
</ul>
</li>
<li>IngestNode, trÆ°á»›c Ä‘Ã¢y náº¿u báº¡n cáº§n xá»­ lÃ½ dá»¯ liá»‡u, nÃ³ Ä‘Æ°á»£c xá»­ lÃ½ trÆ°á»›c khi láº­p chá»‰ má»¥c, vÃ­ dá»¥ nhÆ° logstash cÃ³ thá»ƒ cáº¥u trÃºc vÃ  chuyá»ƒn Ä‘á»•i nháº­t kÃ½, bÃ¢y giá» nÃ³ cÃ³ thá»ƒ Ä‘Æ°á»£c xá»­ lÃ½ trá»±c tiáº¿p trong es;
<ul>
<li>Cung cáº¥p script Painless, thay tháº¿ cho script Groovy;</li>
<li>Loáº¡i bá» site plugins, cÃ³ nghÄ©a lÃ  head, bigdesk khÃ´ng thá»ƒ Ä‘Æ°á»£c cÃ i Ä‘áº·t trá»±c tiáº¿p trong es ná»¯a, nhÆ°ng cÃ³ thá»ƒ triá»ƒn khai cÃ¡c trang Ä‘á»™c láº­p (dÃ¹ sao Ä‘Ã³ cÅ©ng lÃ  cÃ¡c tá»‡p tÄ©nh) hoáº·c phÃ¡t triá»ƒn plugin kibana;</li>
<li>ThÃªm loáº¡i Sliced Scroll, bÃ¢y giá» giao diá»‡n Scroll cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ duyá»‡t dá»¯ liá»‡u Ä‘á»“ng thá»i. Má»—i yÃªu cáº§u Scroll cÃ³ thá»ƒ Ä‘Æ°á»£c chia thÃ nh nhiá»u yÃªu cáº§u Slice, cÃ³ thá»ƒ Ä‘Æ°á»£c hiá»ƒu lÃ  cÃ¡c lÃ¡t, má»—i Slice lÃ  Ä‘á»™c láº­p vÃ  song song, sá»­ dá»¥ng Scroll Ä‘á»ƒ xÃ¢y dá»±ng láº¡i hoáº·c duyá»‡t sáº½ nhanh hÆ¡n nhiá»u láº§n;</li>
<li>ThÃªm Profile API;</li>
<li>ThÃªm Rollover API;</li>
<li>ThÃªm Reindex;</li>
<li>Giá»›i thiá»‡u cÃ¡c loáº¡i trÆ°á»ng má»›i Text/Keyword Ä‘á»ƒ thay tháº¿ String;</li>
<li>Giá»›i háº¡n kÃ­ch thÆ°á»›c yÃªu cáº§u chá»‰ má»¥c Ä‘á»ƒ trÃ¡nh má»™t sá»‘ lÆ°á»£ng lá»›n yÃªu cáº§u Ä‘á»“ng thá»i lÃ m quÃ¡ táº£i ES;</li>
<li>Giá»›i háº¡n sá»‘ lÆ°á»£ng shard trong má»™t yÃªu cáº§u duy nháº¥t, máº·c Ä‘á»‹nh 1000.</li>
</ul>
</li>
</ul>
</li>
<li>NgÃ y 31 thÃ¡ng 8 nÄƒm 2017, phiÃªn báº£n <strong>6.0.0</strong> Ä‘Æ°á»£c phÃ¡t hÃ nh, vá»›i cÃ¡c tÃ­nh nÄƒng quan trá»ng sau:
<ul>
<li>Há»— trá»£ cho Doc Values thÆ°a thá»›t;
<ul>
<li>Index Sorting, tá»©c lÃ  sáº¯p xáº¿p á»Ÿ giai Ä‘oáº¡n láº­p chá»‰ má»¥c;</li>
</ul>
</li>
<li>Há»— trá»£ cho sá»‘ thá»© tá»±, má»—i hoáº¡t Ä‘á»™ng es cÃ³ má»™t sá»‘ thá»© tá»± (tÆ°Æ¡ng tá»± nhÆ° thiáº¿t káº¿ tÄƒng dáº§n);
<ul>
<li>NÃ¢ng cáº¥p cuá»™n mÆ°á»£t mÃ ;</li>
</ul>
</li>
<li>Báº¯t Ä‘áº§u tá»« 6.0, khÃ´ng há»— trá»£ nhiá»u loáº¡i trong má»™t index;
<ul>
<li>Index-template inheritance, káº¿ thá»«a phiÃªn báº£n index, hiá»‡n táº¡i cÃ¡c máº«u index Ä‘á»u Ä‘Æ°á»£c khá»›p vÃ  há»£p nháº¥t, Ä‘iá»u nÃ y cÃ³ thá»ƒ gÃ¢y ra má»™t sá»‘ váº¥n Ä‘á» xung Ä‘á»™t máº«u index, 6.0 sáº½ chá»‰ khá»›p má»™t, vÃ  index sáº½ Ä‘Æ°á»£c xÃ¡c minh khi táº¡o;</li>
<li>Load aware shard routing, Ä‘á»‹nh tuyáº¿n yÃªu cáº§u dá»±a trÃªn táº£i, cÃ¡c yÃªu cáº§u tÃ¬m kiáº¿m hiá»‡n táº¡i lÃ  toÃ n nÃºt polling, vÃ¬ váº­y nÃºt hoáº¡t Ä‘á»™ng cháº­m nháº¥t thÆ°á»ng gÃ¢y ra tÄƒng Ä‘á»™ trá»… tá»•ng thá»ƒ, cÃ¡ch thá»±c hiá»‡n má»›i sáº½ tá»± Ä‘á»™ng Ä‘iá»u chá»‰nh Ä‘á»™ dÃ i hÃ ng Ä‘á»£i dá»±a trÃªn thá»i gian tiÃªu thá»¥ cá»§a hÃ ng Ä‘á»£i, Ä‘á»™ dÃ i hÃ ng Ä‘á»£i cá»§a nÃºt táº£i cao sáº½ giáº£m, cho phÃ©p cÃ¡c nÃºt khÃ¡c chia sáº» Ã¡p lá»±c nhiá»u hÆ¡n, tÃ¬m kiáº¿m vÃ  chá»‰ má»¥c sáº½ dá»±a trÃªn cÆ¡ cháº¿ nÃ y;</li>
<li>CÃ¡c chá»‰ má»¥c Ä‘Ã£ Ä‘Ã³ng cÅ©ng sáº½ há»— trá»£ xá»­ lÃ½ tá»± Ä‘á»™ng cá»§a báº£n sao Ä‘á»ƒ Ä‘áº£m báº£o Ä‘á»™ tin cáº­y cá»§a dá»¯ liá»‡u.</li>
</ul>
</li>
</ul>
</li>
<li>NgÃ y 10 thÃ¡ng 4 nÄƒm 2019, phiÃªn báº£n <strong>7.0.0</strong> Ä‘Æ°á»£c phÃ¡t hÃ nh, vá»›i cÃ¡c tÃ­nh nÄƒng quan trá»ng sau:
<ul>
<li>Thay Ä‘á»•i káº¿t ná»‘i cá»¥m: TransportClient Ä‘Ã£ bá»‹ loáº¡i bá», mÃ£ java cá»§a es7 chá»‰ cÃ³ thá»ƒ sá»­ dá»¥ng restclient; Ä‘á»‘i vá»›i láº­p trÃ¬nh java, nÃªn sá»­ dá»¥ng High-level-rest-client Ä‘á»ƒ váº­n hÃ nh cá»¥m ES;
<ul>
<li>GÃ³i chÆ°Æ¡ng trÃ¬nh ES máº·c Ä‘á»‹nh Ä‘Ã³ng gÃ³i jdk: phiÃªn báº£n gÃ³i chÆ°Æ¡ng trÃ¬nh 7.x trá»Ÿ thÃ nh 300MB+, so vá»›i 6.x, gÃ³i lá»›n hÆ¡n 200MB+, Ä‘Ã¢y chÃ­nh lÃ  kÃ­ch thÆ°á»›c cá»§a JDK;</li>
<li>Sá»­ dá»¥ng Lucene 9.0;
<ul>
<li>ChÃ­nh thá»©c loáº¡i bá» há»— trá»£ cho nhiá»u Type dÆ°á»›i má»™t chá»‰ má»¥c duy nháº¥t, thá»i gian es6, chÃ­nh thá»©c Ä‘Ã£ nÃ³i ráº±ng es7 sáº½ xÃ³a type, vÃ  thá»i gian es6, Ä‘Ã£ quy Ä‘á»‹nh ráº±ng má»—i chá»‰ má»¥c chá»‰ cÃ³ thá»ƒ cÃ³ má»™t loáº¡i. Trong es7, sá»­ dá»¥ng _doc máº·c Ä‘á»‹nh nhÆ° lÃ  loáº¡i, chÃ­nh thá»©c nÃ³i trong phiÃªn báº£n 8.x sáº½ hoÃ n toÃ n loáº¡i bá» loáº¡i. PhÆ°Æ¡ng thá»©c yÃªu cáº§u API cÅ©ng gá»­i thay Ä‘á»•i, cháº³ng háº¡n nhÆ° láº¥y má»™t tÃ i liá»‡u cá»§a má»™t ID cá»¥ thá»ƒ cá»§a má»™t chá»‰ má»¥c: GET index/_doc/id nÆ¡i chá»‰ má»¥c vÃ  id lÃ  cÃ¡c giÃ¡ trá»‹ cá»¥ thá»ƒ;</li>
</ul>
</li>
</ul>
</li>
<li>Giá»›i thiá»‡u má»™t bá»™ cáº¯t máº¡ch bá»™ nhá»› thá»±c sá»±, cÃ³ thá»ƒ phÃ¡t hiá»‡n chÃ­nh xÃ¡c hÆ¡n cÃ¡c yÃªu cáº§u khÃ´ng thá»ƒ xá»­ lÃ½ vÃ  ngÄƒn chÃºng lÃ m cho má»™t nÃºt duy nháº¥t khÃ´ng á»•n Ä‘á»‹nh;
<ul>
<li>Zen2 lÃ  lá»›p Ä‘iá»u phá»‘i cá»¥m hoÃ n toÃ n má»›i cá»§a Elasticsearch, cáº£i thiá»‡n Ä‘á»™ tin cáº­y, hiá»‡u suáº¥t, vÃ  tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng, trá»Ÿ nÃªn nhanh hÆ¡n, an toÃ n hÆ¡n, vÃ  dá»… sá»­ dá»¥ng hÆ¡n.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2>CÃ¡c khÃ¡i niá»‡m vá» Elasticsearch</h2>
<p>DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ khÃ¡i niá»‡m cá»‘t lÃµi cá»§a Elasticsearch. Hiá»ƒu rÃµ nhá»¯ng khÃ¡i niá»‡m nÃ y tá»« Ä‘áº§u sáº½ giÃºp báº¡n Ä‘Æ¡n giáº£n hÃ³a quÃ¡ trÃ¬nh há»c Elasticsearch.</p>
<h3>Gáº§n thá»i gian thá»±c (NRT)</h3>
<p>Elasticsearch lÃ  má»™t ná»n táº£ng tÃ¬m kiáº¿m gáº§n thá»i gian thá»±c. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  <strong>cÃ³ má»™t khoáº£ng trá»… nhá» (thÆ°á»ng lÃ  má»™t giÃ¢y) tá»« lÃºc láº­p chá»‰ má»¥c cho má»™t tÃ i liá»‡u cho Ä‘áº¿n khi tÃ i liá»‡u Ä‘Ã³ cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m kiáº¿m</strong>.</p>
<h3>Chá»‰ má»¥c (Index)</h3>
<p>Trong cÃ¡c ngá»¯ cáº£nh khÃ¡c nhau, "chá»‰ má»¥c" cÃ³ nhá»¯ng Ã½ nghÄ©a khÃ¡c nhau:</p>
<ul>
<li>Chá»‰ má»¥c (danh tá»«): Má»™t&nbsp;<strong>chá»‰ má»¥c</strong>&nbsp;tÆ°Æ¡ng tá»± nhÆ° má»™t&nbsp;<strong>cÆ¡ sá»Ÿ dá»¯ liá»‡u</strong>trong cÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡ truyá»n thá»‘ng, lÃ  má»™t nÆ¡i chá»©a cÃ¡c tÃ i liá»‡u dáº¡ng quan há»‡. Chá»‰ má»¥c thá»±c cháº¥t lÃ  má»™t&nbsp;<strong>khÃ´ng gian tÃªn logic</strong>&nbsp;trá» Ä‘áº¿n má»™t hoáº·c nhiá»u&nbsp;<strong>phÃ¢n Ä‘oáº¡n váº­t lÃ½</strong>.</li>
<li>Chá»‰ má»¥c (Ä‘á»™ng tá»«): Chá»‰ má»¥c má»™t tÃ i liá»‡u cÃ³ nghÄ©a lÃ  lÆ°u trá»¯ má»™t tÃ i liá»‡u vÃ o má»™t&nbsp;<em>chá»‰ má»¥c</em>&nbsp;(danh tá»«) Ä‘á»ƒ cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m kiáº¿m vÃ  truy váº¥n. Äiá»u nÃ y ráº¥t giá»‘ng vá»›i tá»« khÃ³a&nbsp;<code>INSERT</code>&nbsp;trong SQL, ngoáº¡i trá»« khi tÃ i liá»‡u Ä‘Ã£ tá»“n táº¡i, tÃ i liá»‡u má»›i sáº½ thay tháº¿ tÃ i liá»‡u cÅ©.</li>
<li>Chá»‰ má»¥c Ä‘áº£o ngÆ°á»£c : CÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡ tÄƒng tá»‘c Ä‘á»™ truy váº¥n dá»¯ liá»‡u báº±ng cÃ¡ch thÃªm má»™t chá»‰ má»¥c, cháº³ng háº¡n nhÆ° má»™t chá»‰ má»¥c cÃ¢y B, vÃ o cÃ¡c cá»™t Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh. Elasticsearch vÃ  Lucene sá»­ dá»¥ng má»™t cáº¥u trÃºc gá»i lÃ &nbsp;<strong>chá»‰ má»¥c Ä‘áº£o ngÆ°á»£c</strong>&nbsp;Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c má»¥c Ä‘Ã­ch tÆ°Æ¡ng tá»±.</li>
</ul>
<p>Chá»‰ má»¥c cá»§a Mapping vÃ  Setting</p>
<ul>
<li><strong><code>Mapping</code></strong>&nbsp;xÃ¡c Ä‘á»‹nh kiá»ƒu cá»§a cÃ¡c trÆ°á»ng tÃ i liá»‡u</li>
<li><strong><code>Setting</code></strong>&nbsp;xÃ¡c Ä‘á»‹nh phÃ¢n phá»‘i dá»¯ liá»‡u khÃ¡c nhau</li>
</ul>
<p>VÃ­ dá»¥:</p>
<div class="language-json" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "settings"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">...</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> any</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> settings</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> ...</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "mappings"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">        "type_one"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">...</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> any</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> mappings</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> ...</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">        "type_two"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">...</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> any</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> mappings</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF"> ...</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">        ...</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h4>Chá»‰ má»¥c Ä‘áº£o ngÆ°á»£c</h4>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240223160504.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure>
<h4>index template</h4>
<p><strong><code>index template</code></strong> (máº«u chá»‰ má»¥c) giÃºp ngÆ°á»i dÃ¹ng Ä‘áº·t Mapping vÃ  Setting, vÃ  tá»± Ä‘á»™ng khá»›p chÃºng vá»›i chá»‰ má»¥c má»›i Ä‘Æ°á»£c táº¡o theo má»™t quy táº¯c nháº¥t Ä‘á»‹nh.</p>
<ul>
<li>Máº«u chá»‰ cÃ³ hiá»‡u lá»±c khi má»™t chá»‰ má»¥c Ä‘Æ°á»£c táº¡o. Viá»‡c sá»­a Ä‘á»•i máº«u sáº½ khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c chá»‰ má»¥c Ä‘Ã£ táº¡o.</li>
<li>Báº¡n cÃ³ thá»ƒ Ä‘áº·t nhiá»u máº«u chá»‰ má»¥c, cÃ¡c thiáº¿t láº­p nÃ y sáº½ Ä‘Æ°á»£c káº¿t há»£p láº¡i vá»›i nhau.</li>
<li>Báº¡n cÃ³ thá»ƒ chá»‰ Ä‘á»‹nh giÃ¡ trá»‹ order Ä‘á»ƒ kiá»ƒm soÃ¡t quÃ¡ trÃ¬nh káº¿t há»£p.</li>
</ul>
<p>Khi táº¡o má»›i má»™t chá»‰ má»¥c:</p>
<ul>
<li>Ãp dá»¥ng Mapping vÃ  Setting máº·c Ä‘á»‹nh cá»§a ES</li>
<li>Ãp dá»¥ng cÃ¡c thiáº¿t láº­p trong máº«u chá»‰ má»¥c cÃ³ giÃ¡ trá»‹ order tháº¥p</li>
<li>Ãp dá»¥ng cÃ¡c thiáº¿t láº­p trong máº«u chá»‰ má»¥c cÃ³ giÃ¡ trá»‹ order cao, cÃ¡c thiáº¿t láº­p trÆ°á»›c Ä‘Ã³ sáº½ bá»‹ ghi Ä‘Ã¨</li>
<li>Ãp dá»¥ng Mapping vÃ  Setting Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh bá»Ÿi ngÆ°á»i dÃ¹ng khi táº¡o chá»‰ má»¥c, vÃ  ghi Ä‘Ã¨ cÃ¡c thiáº¿t láº­p trong máº«u trÆ°á»›c Ä‘Ã³.</li>
</ul>
<p>VÃ­ dá»¥: Táº¡o máº«u chá»‰ má»¥c máº·c Ä‘á»‹nh</p>
<div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> _template/template_default</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "index_patterns"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span><span style="color:#98C379;--shiki-dark:#98C379">"*"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">],</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "order"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> 0,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "version"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> 1,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "settings"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "number_of_shards"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> 1,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "number_of_replicas"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> /_template/template_test</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "index_patterns"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span><span style="color:#98C379;--shiki-dark:#98C379">"test*"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">],</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "order"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> 1,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "settings"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "number_of_shards"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> 1,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "number_of_replicas"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 2</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  },</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "mappings"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "date_detection"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#D19A66;--shiki-dark:#D19A66"> false</span><span style="color:#98C379;--shiki-dark:#98C379">,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "numeric_detection"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#D19A66;--shiki-dark:#D19A66"> true</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Kiá»ƒm tra máº«u chá»‰ má»¥c</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_template/template_default</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_template/temp</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">*</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Ghi dá»¯ liá»‡u má»›i, chá»‰ má»¥c báº¯t Ä‘áº§u báº±ng test</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> testtemplate/_doc/1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "someNumber"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "1",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "someDate"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "2019/01/01"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> testtemplate/_mapping</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> testtemplate/_settings</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> testmy</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">	"settings"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">		"number_of_replicas"</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">:5</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">	}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> testmy/_doc/1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "key"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "value"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> testmy/_settings</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">DELETE</span><span style="color:#98C379;--shiki-dark:#98C379"> testmy</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">DELETE</span><span style="color:#98C379;--shiki-dark:#98C379"> /_template/template_default</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">DELETE</span><span style="color:#98C379;--shiki-dark:#98C379"> /_template/template_test</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4>dynamic template</h4>
<ul>
<li>Dá»±a vÃ o kiá»ƒu dá»¯ liá»‡u Ä‘Æ°á»£c ES nháº­n biáº¿t, káº¿t há»£p vá»›i tÃªn trÆ°á»ng, Ä‘á»ƒ Ä‘áº·t Ä‘á»™ng kiá»ƒu trÆ°á»ng:
<ul>
<li>Táº¥t cáº£ cÃ¡c kiá»ƒu chuá»—i Ä‘á»u Ä‘Æ°á»£c Ä‘áº·t thÃ nh Keyword, hoáº·c táº¯t trÆ°á»ng keyword.</li>
<li>CÃ¡c trÆ°á»ng báº¯t Ä‘áº§u báº±ng "is" Ä‘á»u Ä‘Æ°á»£c Ä‘áº·t thÃ nh boolean.</li>
<li>CÃ¡c trÆ°á»ng báº¯t Ä‘áº§u báº±ng "long_" Ä‘á»u Ä‘Æ°á»£c Ä‘áº·t thÃ nh kiá»ƒu long.</li>
</ul>
</li>
<li>Máº«u Ä‘á»™ng Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong Mapping cá»§a má»™t chá»‰ má»¥c.</li>
<li>Máº«u cÃ³ má»™t tÃªn.</li>
<li>Quy táº¯c khá»›p lÃ  má»™t máº£ng.</li>
<li>Äáº·t Mapping cho cÃ¡c trÆ°á»ng khá»›p.</li>
</ul>
<p>VÃ­ dá»¥:</p>
<div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">#Dynaminc Mapping dá»±a trÃªn kiá»ƒu vÃ  tÃªn trÆ°á»ng</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">DELETE</span><span style="color:#98C379;--shiki-dark:#98C379"> my_index</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> my_index/_doc/1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "firstName"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "Ruan",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "isVIP"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "true"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> my_index/_mapping</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">DELETE</span><span style="color:#98C379;--shiki-dark:#98C379"> my_index</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> my_index</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "mappings"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "dynamic_templates"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "strings_as_boolean"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">          "match_mapping_type"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "string",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">          "match"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "is*",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">          "mapping"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "type"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "boolean"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">          }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "strings_as_keywords"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">          "match_mapping_type"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "string",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">          "mapping"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "type"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "keyword"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">          }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    ]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> my_index/_mapping</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">DELETE</span><span style="color:#98C379;--shiki-dark:#98C379"> my_index</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">#Káº¿t há»£p vá»›i Ä‘Æ°á»ng dáº«n</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> my_index</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "mappings"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "dynamic_templates"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "full_name"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">          "path_match"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "name.*",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">          "path_unmatch"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "*.middle",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">          "mapping"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "type"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "text",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "copy_to"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "full_name"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">          }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    ]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> my_index/_mapping</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> my_index/_doc/1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "name"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "first"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "John",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "middle"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "Winston",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "last"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "Lennon"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> my_index/_search?q=full_name:John</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">DELETE</span><span style="color:#98C379;--shiki-dark:#98C379"> my_index</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3><s>Kiá»ƒu (Type)</s></h3>
<p><s>Kiá»ƒu lÃ  má»™t phÃ¢n loáº¡i hay phÃ¢n vÃ¹ng theo Ã½ nghÄ©a logic, cho phÃ©p táº¡o nhiá»u loáº¡i trong cÃ¹ng má»™t chá»‰ má»¥c. Báº£n cháº¥t, nÃ³ tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i má»™t Ä‘iá»u kiá»‡n lá»c, cÃ¡c phiÃªn báº£n cao hÆ¡n sáº½ loáº¡i bá» khÃ¡i niá»‡m loáº¡i.</s></p>
<blockquote>
<p><s><strong>Tá»« phiÃªn báº£n 6.0.0 trá»Ÿ Ä‘i, loáº¡i Ä‘Ã£ bá»‹ loáº¡i bá»</strong></s></p>
</blockquote>
<h3>TÃ i liá»‡u (Document)</h3>
<p>Elasticsearch lÃ  hÆ°á»›ng tá»›i tÃ i liá»‡u, <strong>tÃ i liá»‡u lÃ  Ä‘Æ¡n vá»‹ nhá» nháº¥t cá»§a táº¥t cáº£ dá»¯ liá»‡u cÃ³ thá»ƒ tÃ¬m kiáº¿m</strong>.</p>
<p>Elasticsearch sá»­ dá»¥ng <a href="http://en.wikipedia.org/wiki/Json" target="_blank" rel="noopener noreferrer"><em>JSON</em></a> lÃ m Ä‘á»‹nh dáº¡ng tuáº§n tá»± hÃ³a cho tÃ i liá»‡u.</p>
<p>Trong chá»‰ má»¥c/loáº¡i, báº¡n cÃ³ thá»ƒ lÆ°u trá»¯ báº¥t ká»³ sá»‘ lÆ°á»£ng tÃ i liá»‡u nÃ o theo nhu cáº§u.</p>
<p>Má»—i tÃ i liá»‡u Ä‘á»u cÃ³ má»™t <strong>ID duy nháº¥t</strong></p>
<ul>
<li>NgÆ°á»i dÃ¹ng cÃ³ thá»ƒ tá»± chá»‰ Ä‘á»‹nh</li>
<li>Hoáº·c Ä‘Æ°á»£c Elasticsearch tá»± Ä‘á»™ng táº¡o</li>
</ul>
<h4>Metadata cá»§a tÃ i liá»‡u</h4>
<p>Má»™t tÃ i liá»‡u khÃ´ng chá»‰ chá»©a dá»¯ liá»‡u cá»§a nÃ³, mÃ  cÃ²n chá»©a <strong>metadata</strong> - thÃ´ng tin vá» tÃ i liá»‡u.</p>
<ul>
<li><code>_index</code>: TÃ i liá»‡u Ä‘Æ°á»£c lÆ°u trá»¯ á»Ÿ Ä‘Ã¢u</li>
<li><code>_type</code>: Loáº¡i Ä‘á»‘i tÆ°á»£ng mÃ  tÃ i liá»‡u Ä‘áº¡i diá»‡n</li>
<li><code>_id</code>: Äá»‹nh danh duy nháº¥t cá»§a tÃ i liá»‡u</li>
<li><code>_source</code>: Dá»¯ liá»‡u Json gá»‘c cá»§a tÃ i liá»‡u</li>
<li><code>_all</code>: TÃ­ch há»£p táº¥t cáº£ ná»™i dung cá»§a cÃ¡c trÆ°á»ng vÃ o trÆ°á»ng nÃ y, Ä‘Ã£ bá»‹ loáº¡i bá»</li>
<li><code>_version</code>: ThÃ´ng tin phiÃªn báº£n cá»§a tÃ i liá»‡u</li>
<li><code>_score</code>: Äiá»ƒm liÃªn quan</li>
</ul>
<p>VÃ­ dá»¥:</p>
<div class="language-json" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "_index"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"megacorp"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "_type"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"employee"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"1"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "_version"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "found"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">true</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "_source"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "first_name"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"John"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "last_name"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Smith"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "age"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">25</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "about"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"I love to go rock climbing"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "interests"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span><span style="color:#98C379;--shiki-dark:#98C379">"sports"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">"music"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h3>NÃºt (Node)</h3>
<h4>Giá»›i thiá»‡u vá» nÃºt</h4>
<p>Má»™t thá»±c thá»ƒ Elasticsearch Ä‘ang cháº¡y Ä‘Æ°á»£c gá»i lÃ  má»™t <strong>nÃºt</strong>.</p>
<p>Thá»±c thá»ƒ Elasticsearch vá» cÆ¡ báº£n lÃ  má»™t tiáº¿n trÃ¬nh Java. Má»™t mÃ¡y cÃ³ thá»ƒ cháº¡y nhiá»u tiáº¿n trÃ¬nh Elasticsearch, nhÆ°ng mÃ´i trÆ°á»ng product nÃªn cháº¡y má»™t tiáº¿n trÃ¬nh Elasticsearch trÃªn má»™t mÃ¡y.</p>
<p>Má»—i nÃºt Ä‘á»u cÃ³ tÃªn, Ä‘Æ°á»£c cáº¥u hÃ¬nh thÃ´ng qua tá»‡p cáº¥u hÃ¬nh, hoáº·c chá»‰ Ä‘á»‹nh khi khá»Ÿi Ä‘á»™ng thÃ´ng qua <code>-E node.name=node1</code>.</p>
<p>Sau khi má»—i nÃºt khá»Ÿi Ä‘á»™ng, nÃ³ sáº½ Ä‘Æ°á»£c gÃ¡n má»™t UID, Ä‘Æ°á»£c lÆ°u trong thÆ° má»¥c <code>data</code>.</p>
<h4>Loáº¡i nÃºt</h4>
<ul>
<li><strong>NÃºt chÃ­nh (master node)</strong>: Má»—i nÃºt Ä‘á»u lÆ°u trá»¯ tráº¡ng thÃ¡i cá»§a cá»¥m, chá»‰ cÃ³ nÃºt chÃ­nh má»›i cÃ³ thá»ƒ sá»­a Ä‘á»•i thÃ´ng tin tráº¡ng thÃ¡i cá»§a cá»¥m (Ä‘áº£m báº£o tÃ­nh nháº¥t quÃ¡n cá»§a dá»¯ liá»‡u). <strong>Tráº¡ng thÃ¡i cá»¥m</strong> duy trÃ¬ thÃ´ng tin sau:
<ul>
<li>ThÃ´ng tin vá» táº¥t cáº£ cÃ¡c nÃºt</li>
<li>Táº¥t cáº£ cÃ¡c chá»‰ má»¥c vÃ  thÃ´ng tin liÃªn quan Ä‘áº¿n mapping vÃ  setting</li>
<li>ThÃ´ng tin Ä‘á»‹nh tuyáº¿n phÃ¢n Ä‘oáº¡n</li>
</ul>
</li>
<li><strong>NÃºt á»©ng cá»­ (master eligible node)</strong>: NÃºt á»©ng cá»­ cÃ³ thá»ƒ tham gia vÃ o quÃ¡ trÃ¬nh báº§u chá»n chÃ­nh. NÃºt khá»Ÿi Ä‘á»™ng Ä‘áº§u tiÃªn sáº½ tá»± báº§u lÃ m nÃºt chÃ­nh.
<ul>
<li>Sau khi má»—i nÃºt khá»Ÿi Ä‘á»™ng, máº·c Ä‘á»‹nh lÃ  nÃºt á»©ng cá»­, cÃ³ thá»ƒ bá»‹ cáº¥m thÃ´ng qua cáº¥u hÃ¬nh <code>node.master: false</code></li>
</ul>
</li>
<li><strong>NÃºt dá»¯ liá»‡u (data node)</strong>: Chá»‹u trÃ¡ch nhiá»‡m lÆ°u trá»¯ dá»¯ liá»‡u phÃ¢n Ä‘oáº¡n.</li>
<li><strong>NÃºt Ä‘iá»u phá»‘i (coordinating node)</strong>: Chá»‹u trÃ¡ch nhiá»‡m nháº­n yÃªu cáº§u tá»« khÃ¡ch hÃ ng, phÃ¢n phá»‘i yÃªu cáº§u Ä‘áº¿n nÃºt thÃ­ch há»£p, cuá»‘i cÃ¹ng tá»•ng há»£p káº¿t quáº£ láº¡i vá»›i nhau. Má»—i nÃºt Elasticsearch máº·c Ä‘á»‹nh Ä‘á»u lÃ  nÃºt Ä‘iá»u phá»‘i (coordinating node).</li>
<li><strong>NÃºt láº¡nh/nÃ³ng (warm/hot node)</strong>: DÃ nh cho cÃ¡c nÃºt dá»¯ liá»‡u (data node) vá»›i cáº¥u hÃ¬nh pháº§n cá»©ng khÃ¡c nhau, Ä‘á»ƒ thá»±c hiá»‡n kiáº¿n trÃºc Hot &amp; Warm, giáº£m chi phÃ­ triá»ƒn khai cá»¥m.</li>
<li><strong>NÃºt há»c mÃ¡y (machine learning node)</strong>: Chá»‹u trÃ¡ch nhiá»‡m thá»±c hiá»‡n cÃ´ng viá»‡c há»c mÃ¡y, Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ phÃ¡t hiá»‡n báº¥t thÆ°á»ng.</li>
</ul>
<h4>Cáº¥u hÃ¬nh nÃºt</h4>
<p>| Tham sá»‘ cáº¥u hÃ¬nh | GiÃ¡ trá»‹ máº·c Ä‘á»‹nh | Giáº£i thÃ­ch                               |<br>
|</p>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240223160504.png" type="image/png"/>
    </item>
    <item>
      <title>Elasticsearch Mapping</title>
      <link>https://vanhung4499.github.io/database/elasticsearch/mapping.html</link>
      <guid>https://vanhung4499.github.io/database/elasticsearch/mapping.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Elasticsearch Mapping</source>
      <description>Elasticsearch Mapping Trong Elasticsearch, Mapping (Ã¡nh xáº¡) Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh cÃ¡ch má»™t tÃ i liá»‡u cÃ¹ng vá»›i cÃ¡c trÆ°á»ng bÃªn trong nÃ³ Ä‘Æ°á»£c lÆ°u trá»¯ vÃ  láº­p chá»‰ má»¥c. Mapping cho ...</description>
      <category>elasticssearch</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<p>Trong Elasticsearch, <strong><code>Mapping</code></strong> (Ã¡nh xáº¡) Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh cÃ¡ch má»™t tÃ i liá»‡u cÃ¹ng vá»›i cÃ¡c trÆ°á»ng bÃªn trong nÃ³ Ä‘Æ°á»£c lÆ°u trá»¯ vÃ  láº­p chá»‰ má»¥c. Mapping cho phÃ©p báº¡n xÃ¡c Ä‘á»‹nh trÆ°á»›c cÃ¡c thuá»™c tÃ­nh nhÆ° kiá»ƒu dá»¯ liá»‡u cá»§a cÃ¡c trÆ°á»ng, trá»ng sá»‘ cá»§a cÃ¡c trÆ°á»ng, bá»™ phÃ¢n tÃ­ch tá»« vÃ  cÃ¡c thuá»™c tÃ­nh khÃ¡c, giá»‘ng nhÆ° viá»‡c thiáº¿t láº­p cÃ¡c trÆ°á»ng khi táº¡o báº£ng trong cÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡.</p>
<p>Mapping sáº½ Ã¡nh xáº¡ tÃ i liá»‡u JSON thÃ nh Ä‘á»‹nh dáº¡ng pháº³ng mÃ  Lucene cáº§n.</p>
<p>Má»—i Mapping thuá»™c vá» má»™t Type cá»§a chá»‰ má»¥c.</p>
<ul>
<li>Má»—i tÃ i liá»‡u Ä‘á»u thuá»™c vá» má»™t Type.</li>
<li>Má»™t Type cÃ³ má»™t Ä‘á»‹nh nghÄ©a Mapping.</li>
<li>Tá»« phiÃªn báº£n 7.0 trá»Ÿ Ä‘i, khÃ´ng cáº§n pháº£i chá»‰ Ä‘á»‹nh thÃ´ng tin type trong Ä‘á»‹nh nghÄ©a Mapping.</li>
</ul>
<p>Má»—i <code>document</code> lÃ  má»™t táº­p há»£p cá»§a <code>field</code>, má»—i <code>field</code> Ä‘á»u cÃ³ kiá»ƒu dá»¯ liá»‡u cá»§a riÃªng nÃ³. Khi Ã¡nh xáº¡ dá»¯ liá»‡u, báº¡n cÃ³ thá»ƒ táº¡o má»™t <code>mapping</code> chá»©a danh sÃ¡ch <code>field</code> liÃªn quan Ä‘áº¿n <code>document</code>. Äá»‹nh nghÄ©a Ã¡nh xáº¡ cÅ©ng bao gá»“m cÃ¡c <code>field</code> metadata, nhÆ° <code>_source</code>, nÃ³ tÃ¹y chá»‰nh cÃ¡ch xá»­ lÃ½ metadata liÃªn quan Ä‘áº¿n <code>document</code>.</p>
<h2>CÃ¡ch Ã¡nh xáº¡</h2>
<p>Trong Elasticsearch, Ã¡nh xáº¡ cÃ³ thá»ƒ Ä‘Æ°á»£c chia thÃ nh Ã¡nh xáº¡ tÄ©nh vÃ  Ã¡nh xáº¡ Ä‘á»™ng. Trong cÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡, trÆ°á»›c khi ghi dá»¯ liá»‡u, báº¡n cáº§n táº¡o báº£ng vÃ  khai bÃ¡o thuá»™c tÃ­nh cá»§a cÃ¡c trÆ°á»ng trong cÃ¢u lá»‡nh táº¡o báº£ng. Tuy nhiÃªn, trong Elasticsearch, Ä‘iá»u nÃ y khÃ´ng cáº§n thiáº¿t. Má»™t trong nhá»¯ng tÃ­nh nÄƒng quan trá»ng nháº¥t cá»§a Elasticsearch lÃ  cho phÃ©p báº¡n báº¯t Ä‘áº§u khÃ¡m phÃ¡ dá»¯ liá»‡u cÃ ng nhanh cÃ ng tá»‘t. Khi tÃ i liá»‡u Ä‘Æ°á»£c ghi vÃ o Elasticsearch, nÃ³ sáº½ tá»± Ä‘á»™ng nháº­n biáº¿t kiá»ƒu dá»¯ liá»‡u cá»§a cÃ¡c trÆ°á»ng. CÆ¡ cháº¿ nÃ y Ä‘Æ°á»£c gá»i lÃ  <strong>Ã¡nh xáº¡ Ä‘á»™ng</strong>. Trong khi Ä‘Ã³, <strong>Ã¡nh xáº¡ tÄ©nh</strong> lÃ  viá»‡c thiáº¿t láº­p thuá»™c tÃ­nh cá»§a cÃ¡c trÆ°á»ng trÆ°á»›c khi ghi dá»¯ liá»‡u.</p>
<h3>Ãnh xáº¡ tÄ©nh</h3>
<p>ES gá»i Ã¡nh xáº¡ tÄ©nh lÃ  <strong>Ã¡nh xáº¡ rÃµ rÃ ng (<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/explicit-mapping.html" target="_blank" rel="noopener noreferrer">Explicit mapping</a>)</strong>. <strong>Ãnh xáº¡ tÄ©nh</strong> lÃ  viá»‡c chá»‰ Ä‘á»‹nh rÃµ rÃ ng Ã¡nh xáº¡ chá»‰ má»¥c khi táº¡o chá»‰ má»¥c. Ãnh xáº¡ tÄ©nh tÆ°Æ¡ng tá»± nhÆ° viá»‡c chá»‰ Ä‘á»‹nh thuá»™c tÃ­nh trÆ°á»ng trong cÃ¢u lá»‡nh táº¡o báº£ng trong SQL. So vá»›i Ã¡nh xáº¡ Ä‘á»™ng, thÃ´ng qua Ã¡nh xáº¡ tÄ©nh, báº¡n cÃ³ thá»ƒ thÃªm cÃ¡c thÃ´ng tin cáº¥u hÃ¬nh chi tiáº¿t vÃ  chÃ­nh xÃ¡c hÆ¡n. VÃ­ dá»¥:</p>
<ul>
<li>Nhá»¯ng trÆ°á»ng chuá»—i nÃ o nÃªn Ä‘Æ°á»£c coi lÃ  trÆ°á»ng toÃ n vÄƒn báº£n.</li>
<li>Nhá»¯ng trÆ°á»ng nÃ o chá»©a sá»‘, ngÃ y hoáº·c vá»‹ trÃ­ Ä‘á»‹a lÃ½.</li>
<li>Äá»‹nh dáº¡ng cá»§a giÃ¡ trá»‹ ngÃ y.</li>
<li>CÃ¡c quy táº¯c tÃ¹y chá»‰nh Ä‘á»ƒ kiá»ƒm soÃ¡t viá»‡c thÃªm trÆ°á»ng Ä‘á»™ng.</li>
</ul>
<p>ã€VÃ­ dá»¥ã€‘Khi táº¡o chá»‰ má»¥c, chá»‰ Ä‘á»‹nh rÃµ rÃ ng mapping</p>
<div class="language-javascript" data-ext="javascript" data-title="javascript"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">PUT</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> /</span><span style="color:#E06C75;--shiki-dark:#E06C75">my</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#E06C75;--shiki-dark:#E06C75">index</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#D19A66;--shiki-dark:#D19A66">000001</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">  "mappings"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">    "properties"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">      "age"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:    { </span><span style="color:#98C379;--shiki-dark:#98C379">"type"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"integer"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">      "email"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:  { </span><span style="color:#98C379;--shiki-dark:#98C379">"type"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"keyword"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  },</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">      "name"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:   { </span><span style="color:#98C379;--shiki-dark:#98C379">"type"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"text"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><p>ã€VÃ­ dá»¥ã€‘Trong chá»‰ má»¥c Ä‘Ã£ tá»“n táº¡i, chá»‰ Ä‘á»‹nh thuá»™c tÃ­nh cá»§a má»™t trÆ°á»ng</p>
<div class="language-javascript" data-ext="javascript" data-title="javascript"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">PUT</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> /</span><span style="color:#E06C75;--shiki-dark:#E06C75">my</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#E06C75;--shiki-dark:#E06C75">index</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#D19A66;--shiki-dark:#D19A66">000001</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">/</span><span style="color:#E06C75;--shiki-dark:#E06C75">_mapping</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">  "properties"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">    "employee-id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">      "type"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"keyword"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">      "index"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">false</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><p>ã€VÃ­ dá»¥ã€‘Xem mapping</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET /my-index-000001/_mapping</span></span></code></pre>
</div><p>ã€VÃ­ dá»¥ã€‘Xem mapping cá»§a má»™t trÆ°á»ng cá»¥ thá»ƒ</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET /my-index-000001/_mapping/field/employee-id</span></span></code></pre>
</div><h3>Ãnh xáº¡ Ä‘á»™ng</h3>
<p>CÆ¡ cháº¿ Ã¡nh xáº¡ Ä‘á»™ng cho phÃ©p ngÆ°á»i dÃ¹ng khÃ´ng cáº§n Ä‘á»‹nh nghÄ©a thá»§ cÃ´ng Ã¡nh xáº¡, Elasticsearch sáº½ tá»± Ä‘á»™ng nháº­n biáº¿t kiá»ƒu dá»¯ liá»‡u cá»§a cÃ¡c trÆ°á»ng. Trong cÃ¡c dá»± Ã¡n thá»±c táº¿, náº¿u Ä‘á»‘i tÃ¡c khÃ´ng biáº¿t trÆ°á»›c cÃ¡c trÆ°á»ng nÃ o sáº½ xuáº¥t hiá»‡n trong dá»¯ liá»‡u Ä‘Æ°á»£c nháº­p vÃ o, hoáº·c khÃ´ng rÃµ kiá»ƒu dá»¯ liá»‡u cá»§a cÃ¡c trÆ°á»ng, viá»‡c sá»­ dá»¥ng Ã¡nh xáº¡ Ä‘á»™ng sáº½ ráº¥t phÃ¹ há»£p. Khi Elasticsearch gáº·p má»™t trÆ°á»ng chÆ°a tá»«ng tháº¥y trÆ°á»›c Ä‘Ã³ trong má»™t tÃ i liá»‡u, nÃ³ sáº½ sá»­ dá»¥ng Ã¡nh xáº¡ Ä‘á»™ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh kiá»ƒu cá»§a trÆ°á»ng vÃ  tá»± Ä‘á»™ng thÃªm trÆ°á»ng Ä‘Ã³ vÃ o Ã¡nh xáº¡.</p>
<p>VÃ­ dá»¥: Táº¡o má»™t chá»‰ má»¥c tÃªn lÃ  <code>data</code>, vá»›i kiá»ƒu <code>mapping</code> lÃ  <code>_doc</code>, vÃ  cÃ³ má»™t trÆ°á»ng kiá»ƒu <code>long</code> tÃªn <code>count</code>.</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> data/_doc/1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"count"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 5</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span></code></pre>
</div><h4>Ãnh xáº¡ Ä‘á»™ng trÆ°á»ng</h4>
<p>Ãnh xáº¡ Ä‘á»™ng trÆ°á»ng (<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/dynamic-field-mapping.html" target="_blank" rel="noopener noreferrer">Dynamic field mappings</a>) lÃ  quy táº¯c Ä‘á»ƒ quáº£n lÃ½ viá»‡c phÃ¡t hiá»‡n trÆ°á»ng Ä‘á»™ng. Khi Elasticsearch phÃ¡t hiá»‡n má»™t trÆ°á»ng má»›i trong má»™t tÃ i liá»‡u, theo máº·c Ä‘á»‹nh, nÃ³ sáº½ tá»± Ä‘á»™ng thÃªm trÆ°á»ng Ä‘Ã³ vÃ o Ã¡nh xáº¡ kiá»ƒu.</p>
<p>Trong Ã¡nh xáº¡, báº¡n cÃ³ thá»ƒ má»Ÿ Ã¡nh xáº¡ Ä‘á»™ng báº±ng cÃ¡ch Ä‘áº·t tham sá»‘ <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/dynamic.html" target="_blank" rel="noopener noreferrer"><code>dynamic</code></a> thÃ nh <code>true</code> hoáº·c <code>runtime</code>.</p>
<p>CÃ¡c tÃ¹y chá»n khÃ¡c nhau cá»§a tham sá»‘ <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/dynamic.html" target="_blank" rel="noopener noreferrer"><code>dynamic</code></a> cÃ³ cÃ¡c chá»©c nÄƒng nhÆ° sau:</p>
<p>| GiÃ¡ trá»‹ lá»±a chá»n | MÃ´ táº£ |<br>
|</p>
]]></content:encoded>
    </item>
    <item>
      <title>Elasticsearch Operation</title>
      <link>https://vanhung4499.github.io/database/elasticsearch/operation.html</link>
      <guid>https://vanhung4499.github.io/database/elasticsearch/operation.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Elasticsearch Operation</source>
      <description>Elasticsearch Operation Elasticsearch lÃ  má»™t cÃ´ng cá»¥ tÃ¬m kiáº¿m vÃ  phÃ¢n tÃ­ch dá»¯ liá»‡u phÃ¢n tÃ¡n, há»— trá»£ RESTful, cÃ³ kháº£ nÄƒng giáº£i quyáº¿t má»™t sá»‘ lÆ°á»£ng ngÃ y cÃ ng tÄƒng cÃ¡c trÆ°á»ng há»£p sá»­...</description>
      <category>elasticssearch</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p><a href="https://github.com/elastic/elasticsearch" target="_blank" rel="noopener noreferrer">Elasticsearch</a> lÃ  má»™t cÃ´ng cá»¥ tÃ¬m kiáº¿m vÃ  phÃ¢n tÃ­ch dá»¯ liá»‡u phÃ¢n tÃ¡n, há»— trá»£ RESTful, cÃ³ kháº£ nÄƒng giáº£i quyáº¿t má»™t sá»‘ lÆ°á»£ng ngÃ y cÃ ng tÄƒng cÃ¡c trÆ°á»ng há»£p sá»­ dá»¥ng. LÃ  trung tÃ¢m cá»§a Elastic Stack, nÃ³ lÆ°u trá»¯ dá»¯ liá»‡u cá»§a báº¡n táº­p trung Ä‘á»ƒ tÃ¬m kiáº¿m nhanh chÃ³ng, tinh chá»‰nh Ä‘á»™ liÃªn quan, vÃ  phÃ¢n tÃ­ch máº¡nh máº½ cÃ³ thá»ƒ má»Ÿ rá»™ng dá»… dÃ ng.</p>
</blockquote>
<h2>CÃ i Ä‘áº·t Elasticsearch</h2>
<blockquote>
<p><a href="https://www.elastic.co/cn/downloads/elasticsearch" target="_blank" rel="noopener noreferrer">HÆ°á»›ng dáº«n táº£i vÃ  cÃ i Ä‘áº·t chÃ­nh thá»©c cá»§a Elasticsearch</a></p>
</blockquote>
<p>(1) Táº£i vÃ  giáº£i nÃ©n</p>
<p>Truy cáº­p <a href="https://www.elastic.co/cn/downloads/elasticsearch" target="_blank" rel="noopener noreferrer">Ä‘á»‹a chá»‰ táº£i chÃ­nh thá»©c</a>, chá»n phiÃªn báº£n cáº§n thiáº¿t, táº£i vÃ  giáº£i nÃ©n vá» mÃ¡y cá»§a báº¡n.</p>
<p>(2) Cháº¡y</p>
<p>Cháº¡y <code>bin/elasticsearch</code> (TrÃªn há»‡ thá»‘ng Windows, cháº¡y <code>bin\elasticsearch.bat</code>)</p>
<p>(3) Truy cáº­p</p>
<p>Thá»±c hiá»‡n <code>curl http://localhost:9200/</code> Ä‘á»ƒ kiá»ƒm tra xem dá»‹ch vá»¥ Ä‘Ã£ khá»Ÿi Ä‘á»™ng chÆ°a</p>
<h2>Láº­p káº¿ hoáº¡ch cho Cluster Elasticsearch</h2>
<p>Cluster Elasticsearch cáº§n Ä‘Æ°á»£c láº­p káº¿ hoáº¡ch má»™t cÃ¡ch há»£p lÃ½ dá»±a trÃªn tÃ¬nh hÃ¬nh thá»±c táº¿ cá»§a doanh nghiá»‡p.</p>
<p>CÃ¡c Ä‘iá»ƒm cáº§n xem xÃ©t:</p>
<ul>
<li>Cáº§n triá»ƒn khai bao nhiÃªu node trong cluster?</li>
<li>CÃ³ bao nhiÃªu index?</li>
<li>Má»—i index cÃ³ bao nhiÃªu dá»¯ liá»‡u?</li>
<li>Má»—i index cÃ³ bao nhiÃªu shard?</li>
</ul>
<p>Má»™t káº¿ hoáº¡ch tham kháº£o:</p>
<ul>
<li>3 mÃ¡y, má»—i mÃ¡y lÃ  6-core 64G.</li>
<li>TÄƒng hÃ ng ngÃ y cá»§a cluster ES cá»§a chÃºng tÃ´i lÃ  khoáº£ng 20 triá»‡u báº£n ghi, dá»¯ liá»‡u tÄƒng hÃ ng ngÃ y lÃ  khoáº£ng 500MB, dá»¯ liá»‡u tÄƒng hÃ ng thÃ¡ng lÃ  khoáº£ng 600 triá»‡u, 15G. Há»‡ thá»‘ng Ä‘Ã£ hoáº¡t Ä‘á»™ng trong vÃ i thÃ¡ng, vÃ  bÃ¢y giá» tá»•ng lÆ°á»£ng dá»¯ liá»‡u trong cluster ES lÃ  khoáº£ng 100G.</li>
<li>Hiá»‡n táº¡i cÃ³ 5 index trá»±c tuyáº¿n (Ä‘iá»u nÃ y Ä‘Æ°á»£c káº¿t há»£p vá»›i doanh nghiá»‡p cá»§a báº¡n, xem dá»¯ liá»‡u nÃ o cá»§a báº¡n cÃ³ thá»ƒ Ä‘áº·t trong ES), má»—i index cÃ³ khá»‘i lÆ°á»£ng dá»¯ liá»‡u lÃ  khoáº£ng 20G, vÃ¬ váº­y trong khá»‘i lÆ°á»£ng dá»¯ liá»‡u nÃ y, chÃºng tÃ´i phÃ¢n bá»• 8 shard cho má»—i index, Ä‘Ã³ lÃ  3 shard nhiá»u hÆ¡n máº·c Ä‘á»‹nh lÃ  5 shard.</li>
</ul>
<h2>Cáº¥u hÃ¬nh Elasticsearch</h2>
<p>Tá»‡p cáº¥u hÃ¬nh máº·c Ä‘á»‹nh cá»§a ES lÃ  <code>config/elasticsearch.yml</code></p>
<p>DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ thÃ´ng tin cÆ¡ báº£n vá» cáº¥u hÃ¬nh:</p>
<div class="language-yml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">cluster.name</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">elasticsearch</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Cáº¥u hÃ¬nh tÃªn cá»¥m cá»§a es, máº·c Ä‘á»‹nh lÃ  elasticsearch, es sáº½ tá»± Ä‘á»™ng phÃ¡t hiá»‡n es trong cÃ¹ng má»™t shard máº¡ng, náº¿u cÃ³ nhiá»u cá»¥m trong cÃ¹ng má»™t shard máº¡ng, thuá»™c tÃ­nh nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ phÃ¢n biá»‡t cÃ¡c cá»¥m khÃ¡c nhau.</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">node.name</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'Franz Kafka'</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># TÃªn node, máº·c Ä‘á»‹nh Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh má»™t cÃ¡ch ngáº«u nhiÃªn tá»« danh sÃ¡ch tÃªn, danh sÃ¡ch nÃ y náº±m trong tá»‡p name.txt trong thÆ° má»¥c cáº¥u hÃ¬nh trong gÃ³i jar es, trong Ä‘Ã³ cÃ³ nhiá»u tÃªn thÃº vá»‹ Ä‘Æ°á»£c thÃªm bá»Ÿi cÃ¡c tÃ¡c giáº£.</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">node.master</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">true</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># XÃ¡c Ä‘á»‹nh node nÃ y cÃ³ Ä‘á»§ Ä‘iá»u kiá»‡n Ä‘á»ƒ Ä‘Æ°á»£c báº§u lÃ m node hay khÃ´ng, máº·c Ä‘á»‹nh lÃ  true, es máº·c Ä‘á»‹nh lÃ  mÃ¡y Ä‘áº§u tiÃªn trong cá»¥m lÃ  master, náº¿u mÃ¡y nÃ y bá»‹ treo thÃ¬ sáº½ báº§u láº¡i master.</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">node.data</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">true</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># XÃ¡c Ä‘á»‹nh node nÃ y cÃ³ lÆ°u trá»¯ dá»¯ liá»‡u index hay khÃ´ng, máº·c Ä‘á»‹nh lÃ  true.</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">index.number_of_shards</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">5</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Äáº·t sá»‘ lÆ°á»£ng máº£nh shard máº·c Ä‘á»‹nh cho index, máº·c Ä‘á»‹nh lÃ  5 máº£nh.</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">index.number_of_replicas</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Äáº·t sá»‘ lÆ°á»£ng báº£n sao máº·c Ä‘á»‹nh cho index, máº·c Ä‘á»‹nh lÃ  1 báº£n sao.</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">path.conf</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">/path/to/conf</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Äáº·t Ä‘Æ°á»ng dáº«n lÆ°u trá»¯ tá»‡p cáº¥u hÃ¬nh, máº·c Ä‘á»‹nh lÃ  thÆ° má»¥c config trong thÆ° má»¥c gá»‘c es.</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">path.data</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">/path/to/data</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Äáº·t Ä‘Æ°á»ng dáº«n lÆ°u trá»¯ dá»¯ liá»‡u index, máº·c Ä‘á»‹nh lÃ  thÆ° má»¥c data trong thÆ° má»¥c gá»‘c es, cÃ³ thá»ƒ Ä‘áº·t nhiá»u Ä‘Æ°á»ng dáº«n lÆ°u trá»¯, phÃ¢n cÃ¡ch báº±ng dáº¥u pháº©y, vÃ­ dá»¥:</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">#path.data: /path/to/data1,/path/to/data2</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">path.work</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">/path/to/work</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Äáº·t Ä‘Æ°á»ng dáº«n lÆ°u trá»¯ tá»‡p táº¡m thá»i, máº·c Ä‘á»‹nh lÃ  thÆ° má»¥c work trong thÆ° má»¥c gá»‘c es.</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">path.logs</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">/path/to/logs</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Äáº·t Ä‘Æ°á»ng dáº«n lÆ°u trá»¯ tá»‡p nháº­t kÃ½, máº·c Ä‘á»‹nh lÃ  thÆ° má»¥c logs trong thÆ° má»¥c gá»‘c es</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">path.plugins</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">/path/to/plugins</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Äáº·t Ä‘Æ°á»ng dáº«n lÆ°u trá»¯ plugin, máº·c Ä‘á»‹nh lÃ  thÆ° má»¥c plugins trong thÆ° má»¥c gá»‘c es</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">bootstrap.mlockall</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">true</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Äáº·t true Ä‘á»ƒ khÃ³a bá»™ nhá»›. Bá»Ÿi vÃ¬ khi jvm báº¯t Ä‘áº§u swapping thÃ¬ hiá»‡u suáº¥t cá»§a es sáº½ giáº£m, vÃ¬ váº­y Ä‘á»ƒ Ä‘áº£m báº£o nÃ³ khÃ´ng swap, báº¡n cÃ³ thá»ƒ Ä‘áº·t hai biáº¿n mÃ´i trÆ°á»ng ES_MIN_MEM vÃ  ES_MAX_MEM thÃ nh cÃ¹ng má»™t giÃ¡ trá»‹, vÃ  Ä‘áº£m báº£o mÃ¡y cÃ³ Ä‘á»§ bá»™ nhá»› Ä‘á»ƒ phÃ¢n bá»• cho es. Äá»“ng thá»i, báº¡n cÅ©ng pháº£i cho phÃ©p tiáº¿n trÃ¬nh elasticsearch cÃ³ thá»ƒ khÃ³a bá»™ nhá»›, trÃªn linux báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng lá»‡nh `ulimit -l unlimited`.</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">network.bind_host</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">192.168.0.1</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Äáº·t Ä‘á»‹a chá»‰ ip Ä‘Æ°á»£c liÃªn káº¿t, cÃ³ thá»ƒ lÃ  ipv4 hoáº·c ipv6, máº·c Ä‘á»‹nh lÃ  0.0.0.0.</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">network.publish_host</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">192.168.0.1</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Äáº·t Ä‘á»‹a chá»‰ ip mÃ  cÃ¡c node khÃ¡c vÃ  node nÃ y tÆ°Æ¡ng tÃ¡c, náº¿u khÃ´ng Ä‘áº·t nÃ³ sáº½ tá»± Ä‘á»™ng xÃ¡c Ä‘á»‹nh, giÃ¡ trá»‹ pháº£i lÃ  má»™t Ä‘á»‹a chá»‰ ip thá»±c sá»±.</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">network.host</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">192.168.0.1</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Tham sá»‘ nÃ y Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘á»“ng thá»i Ä‘áº·t bind_host vÃ  publish_host á»Ÿ trÃªn.</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">transport.tcp.port</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">9300</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Äáº·t cá»•ng tcp Ä‘á»ƒ tÆ°Æ¡ng tÃ¡c giá»¯a cÃ¡c node, máº·c Ä‘á»‹nh lÃ  9300.</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">transport.tcp.compress</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">true</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Äáº·t liá»‡u cÃ³ nÃ©n dá»¯ liá»‡u khi truyá»n táº£i tcp hay khÃ´ng, máº·c Ä‘á»‹nh lÃ  false, khÃ´ng nÃ©n.</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">http.port</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">9200</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Äáº·t cá»•ng http phá»¥c vá»¥ bÃªn ngoÃ i, máº·c Ä‘á»‹nh lÃ  9200.</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">http.max_content_length</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">100mb</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Äáº·t dung lÆ°á»£ng tá»‘i Ä‘a cá»§a ná»™i dung, máº·c Ä‘á»‹nh lÃ  100mb</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">http.enabled</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">false</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># CÃ³ sá»­ dá»¥ng giao thá»©c http Ä‘á»ƒ cung cáº¥p dá»‹ch vá»¥ bÃªn ngoÃ i hay khÃ´ng, máº·c Ä‘á»‹nh lÃ  true, Ä‘Æ°á»£c má»Ÿ.</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">gateway.type</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">local</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Loáº¡i gateway, máº·c Ä‘á»‹nh lÃ  local tá»©c lÃ  há»‡ thá»‘ng tá»‡p cá»¥c bá»™, cÃ³ thá»ƒ Ä‘áº·t lÃ  há»‡ thá»‘ng tá»‡p cá»¥c bá»™, há»‡ thá»‘ng tá»‡p phÃ¢n tÃ¡n, HDFS cá»§a hadoop, vÃ  mÃ¡y chá»§ s3 cá»§a amazon, cÃ¡ch Ä‘áº·t há»‡ thá»‘ng tá»‡p khÃ¡c sáº½ Ä‘Æ°á»£c nÃ³i chi tiáº¿t vÃ o láº§n sau.</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">gateway.recover_after_nodes</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Äáº·t sá»‘ lÆ°á»£ng node trong cá»¥m khi khá»Ÿi Ä‘á»™ng Ä‘á»ƒ khÃ´i phá»¥c dá»¯ liá»‡u, máº·c Ä‘á»‹nh lÃ  1.</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">gateway.recover_after_time</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">5m</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Äáº·t thá»i gian chá» tá»‘i Ä‘a Ä‘á»ƒ khá»Ÿi táº¡o quÃ¡ trÃ¬nh khÃ´i phá»¥c dá»¯ liá»‡u, máº·c Ä‘á»‹nh lÃ  5 phÃºt.</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">gateway.expected_nodes</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">2</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Äáº·t sá»‘ lÆ°á»£ng node trong cá»¥m nÃ y, máº·c Ä‘á»‹nh lÃ  2, má»™t khi N node nÃ y Ä‘Æ°á»£c khá»Ÿi Ä‘á»™ng, quÃ¡ trÃ¬nh khÃ´i phá»¥c dá»¯ liá»‡u sáº½ Ä‘Æ°á»£c báº¯t Ä‘áº§u ngay láº­p tá»©c.</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">cluster.routing.allocation.node_initial_primaries_recoveries</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">4</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Khi khÃ´i phá»¥c dá»¯ liá»‡u ban Ä‘áº§u, sá»‘ lÆ°á»£ng luá»“ng khÃ´i phá»¥c Ä‘á»“ng thá»i, máº·c Ä‘á»‹nh lÃ  4.</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">cluster.routing.allocation.node_concurrent_recoveries</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">2</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Khi thÃªm hoáº·c xÃ³a node hoáº·c cÃ¢n báº±ng táº£i, sá»‘ lÆ°á»£ng luá»“ng khÃ´i phá»¥c Ä‘á»“ng thá»i, máº·c Ä‘á»‹nh lÃ  2.</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">indices.recovery.max_size_per_sec</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Äáº·t bÄƒng thÃ´ng giá»›i háº¡n khi khÃ´i phá»¥c dá»¯ liá»‡u, vÃ­ dá»¥ 100mb, máº·c Ä‘á»‹nh lÃ  0, tá»©c khÃ´ng giá»›i háº¡n.</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">indices.recovery.concurrent_streams</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">5</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Äáº·t tham sá»‘ nÃ y Ä‘á»ƒ giá»›i háº¡n sá»‘ lÆ°á»£ng luá»“ng Ä‘á»“ng thá»i má»Ÿ tá»‘i Ä‘a khi khÃ´i phá»¥c dá»¯ liá»‡u tá»« cÃ¡c máº£nh khÃ¡c, máº·c Ä‘á»‹nh lÃ  5.</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">discovery.zen.minimum_master_nodes</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Äáº·t tham sá»‘ nÃ y Ä‘á»ƒ Ä‘áº£m báº£o ráº±ng cÃ¡c node trong cá»¥m cÃ³ thá»ƒ biáº¿t Ä‘Æ°á»£c sá»‘ lÆ°á»£ng tá»‘i thiá»ƒu N node khÃ¡c cÃ³ Ä‘á»§ Ä‘iá»u kiá»‡n lÃ m master. Máº·c Ä‘á»‹nh lÃ  1, Ä‘á»‘i vá»›i cá»¥m lá»›n, cÃ³ thá»ƒ Ä‘áº·t giÃ¡ trá»‹ lá»›n hÆ¡n má»™t chÃºt (2-4)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">discovery.zen.ping.timeout</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">3s</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Äáº·t thá»i gian chá» káº¿t ná»‘i ping khi tá»± Ä‘á»™ng phÃ¡t hiá»‡n cÃ¡c node khÃ¡c trong cá»¥m, máº·c Ä‘á»‹nh lÃ  3 giÃ¢y, Ä‘á»‘i vá»›i mÃ´i trÆ°á»ng máº¡ng kÃ©m, cÃ³ thá»ƒ Ä‘áº·t giÃ¡ trá»‹ cao hÆ¡n Ä‘á»ƒ ngÄƒn cháº·n lá»—i khi phÃ¡t hiá»‡n tá»± Ä‘á»™ng.</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">discovery.zen.ping.multicast.enabled</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">false</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Äáº·t liá»‡u cÃ³ má»Ÿ phÃ¡t hiá»‡n node Ä‘a phÃ¡t hay khÃ´ng, máº·c Ä‘á»‹nh lÃ  true.</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">discovery.zen.ping.unicast.hosts</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span><span style="color:#98C379;--shiki-dark:#98C379">'host1'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">'host2:port'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">'host3[portX-portY]'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">]</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Äáº·t danh sÃ¡ch ban Ä‘áº§u cá»§a cÃ¡c node master trong cá»¥m, cÃ¡c node má»›i tham gia cá»¥m cÃ³ thá»ƒ Ä‘Æ°á»£c phÃ¡t hiá»‡n tá»± Ä‘á»™ng thÃ´ng qua cÃ¡c node nÃ y.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>Elasticsearch FAQ</h2>
<h3>Elasticsearch khÃ´ng cho phÃ©p cháº¡y vá»›i quyá»n root</h3>
<p><strong>Váº¥n Ä‘á»:</strong> Trong mÃ´i trÆ°á»ng Linux, Elasticsearch khÃ´ng cho phÃ©p cháº¡y vá»›i quyá»n root.</p>
<p>Náº¿u báº¡n cháº¡y Elasticsearch dÆ°á»›i quyá»n root, báº¡n sáº½ nháº­n Ä‘Æ°á»£c lá»—i sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>can not run elasticsearch as root</span></span></code></pre>
</div><p><strong>CÃ¡ch giáº£i quyáº¿t:</strong> Cháº¡y Elasticsearch dÆ°á»›i tÃ i khoáº£n khÃ´ng cÃ³ quyá»n root</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Táº¡o nhÃ³m ngÆ°á»i dÃ¹ng</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">groupadd</span><span style="color:#98C379;--shiki-dark:#98C379"> elk</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Táº¡o ngÆ°á»i dÃ¹ng má»›i, -g elk Ä‘áº·t nhÃ³m ngÆ°á»i dÃ¹ng cá»§a nÃ³ thÃ nh elk, -p elk Ä‘áº·t máº­t kháº©u cá»§a nÃ³ thÃ nh elk</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">useradd</span><span style="color:#98C379;--shiki-dark:#98C379"> elk</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -g</span><span style="color:#98C379;--shiki-dark:#98C379"> elk</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -p</span><span style="color:#98C379;--shiki-dark:#98C379"> elk</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Thay Ä‘á»•i chá»§ sá»Ÿ há»¯u cá»§a thÆ° má»¥c /opt vÃ  cÃ¡c tá»‡p bÃªn trong thÃ nh elk:elk</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">chown</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -R</span><span style="color:#98C379;--shiki-dark:#98C379"> elk:elk</span><span style="color:#98C379;--shiki-dark:#98C379"> /opt</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"> # Giáº£ sá»­ báº¡n Ä‘Ã£ cÃ i Ä‘áº·t elasticsearch trong thÆ° má»¥c opt</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Chuyá»ƒn Ä‘á»•i tÃ i khoáº£n</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">su</span><span style="color:#98C379;--shiki-dark:#98C379"> elk</span></span></code></pre>
</div><h3>vm.max_map_count khÃ´ng tháº¥p hÆ¡n 262144</h3>
<p><strong>Váº¥n Ä‘á»:</strong> <code>vm.max_map_count</code> biá»ƒu thá»‹ kÃ­ch thÆ°á»›c bá»™ nhá»› áº£o, Ä‘Ã¢y lÃ  má»™t tham sá»‘ kernel. Elasticsearch yÃªu cáº§u <code>vm.max_map_count</code> khÃ´ng tháº¥p hÆ¡n 262144.</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>max virtual memory areas vm.max_map_count [65530] is too low, increase to at least [262144]</span></span></code></pre>
</div><p><strong>CÃ¡ch giáº£i quyáº¿t:</strong></p>
<p>Báº¡n cÃ³ thá»ƒ thá»±c hiá»‡n lá»‡nh sau Ä‘á»ƒ Ä‘áº·t <code>vm.max_map_count</code>, nhÆ°ng sau khi khá»Ÿi Ä‘á»™ng láº¡i, nÃ³ sáº½ trá»Ÿ láº¡i giÃ¡ trá»‹ ban Ä‘áº§u.</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>sysctl -w vm.max_map_count=262144</span></span></code></pre>
</div><p>CÃ¡ch lÃ m lÃ¢u dÃ i lÃ  sá»­a Ä‘á»•i tham sá»‘ <code>vm.max_map_count</code> trong tá»‡p <code>/etc/sysctl.conf</code>:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>echo "vm.max_map_count=262144" &gt; /etc/sysctl.conf</span></span>
<span class="line"><span>sysctl -p</span></span></code></pre>
</div><blockquote>
<p><strong>LÆ°u Ã½</strong></p>
<p>Náº¿u mÃ´i trÆ°á»ng cháº¡y lÃ  docker container, cÃ³ thá»ƒ sáº½ háº¡n cháº¿ viá»‡c thá»±c hiá»‡n sysctl Ä‘á»ƒ sá»­a Ä‘á»•i tham sá»‘ kernel.</p>
<p>Trong trÆ°á»ng há»£p nÃ y, báº¡n chá»‰ cÃ³ thá»ƒ chá»n sá»­a Ä‘á»•i tham sá»‘ trÃªn mÃ¡y chá»§ chá»§.</p>
</blockquote>
<h3>nofile khÃ´ng tháº¥p hÆ¡n 65536</h3>
<p><strong>Váº¥n Ä‘á»:</strong> <code>nofile</code> biá»ƒu thá»‹ sá»‘ lÆ°á»£ng tá»‡p tá»‘i Ä‘a mÃ  má»™t quÃ¡ trÃ¬nh cÃ³ thá»ƒ má»Ÿ. QuÃ¡ trÃ¬nh Elasticsearch yÃªu cáº§u sá»‘ lÆ°á»£ng tá»‡p tá»‘i Ä‘a cÃ³ thá»ƒ má»Ÿ khÃ´ng tháº¥p hÆ¡n 65536.</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>max file descriptors [4096] for elasticsearch process is too low, increase to at least [65536]</span></span></code></pre>
</div><p><strong>CÃ¡ch giáº£i quyáº¿t:</strong></p>
<p>Sá»­a Ä‘á»•i tham sá»‘ <code>nofile</code> trong tá»‡p <code>/etc/security/limits.conf</code>:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>echo "* soft nofile 65536" &gt; /etc/security/limits.conf</span></span>
<span class="line"><span>echo "* hard nofile 131072" &gt; /etc/security/limits.conf</span></span></code></pre>
</div><h3>nproc khÃ´ng tháº¥p hÆ¡n 2048</h3>
<p><strong>Váº¥n Ä‘á»:</strong> <code>nproc</code> biá»ƒu thá»‹ sá»‘ lÆ°á»£ng tá»‘i Ä‘a cá»§a cÃ¡c thread. Elasticsearch yÃªu cáº§u sá»‘ lÆ°á»£ng tá»‘i Ä‘a thread khÃ´ng tháº¥p hÆ¡n 2048.</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>max number of threads [1024] for user [user] is too low, increase to at least [2048]</span></span></code></pre>
</div><p><strong>CÃ¡ch giáº£i quyáº¿t:</strong></p>
<p>Sá»­a Ä‘á»•i tham sá»‘ <code>nproc</code> trong tá»‡p <code>/etc/security/limits.conf</code>:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>echo "* soft nproc 2048" &gt; /etc/security/limits.conf</span></span>
<span class="line"><span>echo "* hard nproc 4096" &gt; /etc/security/limits.conf</span></span></code></pre>
</div><h2>TÃ i liá»‡u tham kháº£o</h2>
<ul>
<li><a href="https://www.elastic.co/cn/downloads/elasticsearch" target="_blank" rel="noopener noreferrer">HÆ°á»›ng dáº«n táº£i vÃ  cÃ i Ä‘áº·t Elasticsearch chÃ­nh thá»©c</a></li>
<li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/rpm.html#rpm" target="_blank" rel="noopener noreferrer">CÃ i Ä‘áº·t Elasticsearch vá»›i RPM</a></li>
<li><a href="http://siye1982.github.io/2015/09/17/es-optimize/" target="_blank" rel="noopener noreferrer">TÃ­ch lÅ©y sá»­ dá»¥ng Elasticsearch</a></li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>Elasticsearch performance optimization</title>
      <link>https://vanhung4499.github.io/database/elasticsearch/optimization.html</link>
      <guid>https://vanhung4499.github.io/database/elasticsearch/optimization.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Elasticsearch performance optimization</source>
      <description>Tá»‘i Æ°u hÃ³a hiá»‡u suáº¥t Elasticsearch Elasticsearch lÃ  cÃ´ng cá»¥ tÃ¬m kiáº¿m cáº¥p doanh nghiá»‡p phá»• biáº¿n hiá»‡n nay, Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ hoáº¡t Ä‘á»™ng trong mÃ´i trÆ°á»ng Ä‘Ã¡m mÃ¢y, cÃ³ kháº£ nÄƒng tÃ¬m kiáº¿...</description>
      <category>elasticssearch</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<p>Elasticsearch lÃ  cÃ´ng cá»¥ tÃ¬m kiáº¿m cáº¥p doanh nghiá»‡p phá»• biáº¿n hiá»‡n nay, Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ hoáº¡t Ä‘á»™ng trong mÃ´i trÆ°á»ng Ä‘Ã¡m mÃ¢y, cÃ³ kháº£ nÄƒng tÃ¬m kiáº¿m thá»i gian thá»±c, á»•n Ä‘á»‹nh, Ä‘Ã¡ng tin cáº­y, nhanh chÃ³ng vÃ  dá»… dÃ ng cÃ i Ä‘áº·t. DÃ¹ lÃ  má»™t sáº£n pháº©m sáºµn sÃ ng sá»­ dá»¥ng ngay sau khi má»Ÿ há»™p, sau khi Ä‘Æ°a vÃ o mÃ´i trÆ°á»ng sáº£n xuáº¥t, chÃºng ta khÃ´ng thá»ƒ Ä‘áº£m báº£o Ä‘Æ°á»£c hiá»‡u suáº¥t vÃ  á»•n Ä‘á»‹nh cá»§a nÃ³. Viá»‡c tÄƒng cÆ°á»ng hiá»‡u suáº¥t dá»‹ch vá»¥ dá»±a trÃªn tÃ¬nh hÃ¬nh thá»±c táº¿ cÃ³ ráº¥t nhiá»u ká»¹ thuáº­t. Trong chÆ°Æ¡ng nÃ y, chÃºng tÃ´i sáº½ chia sáº» nhá»¯ng kinh nghiá»‡m tá»‘i Æ°u hÃ³a hiá»‡u suáº¥t Elasticsearch tá»« thá»±c tiá»…n, chá»§ yáº¿u tá»« cÃ¡c khÃ­a cáº¡nh nhÆ° tá»‘i Æ°u hÃ³a cáº¥u hÃ¬nh pháº§n cá»©ng, cÃ i Ä‘áº·t tá»‘i Æ°u hÃ³a chá»‰ má»¥c, tá»‘i Æ°u hÃ³a truy váº¥n, tá»‘i Æ°u hÃ³a cáº¥u trÃºc dá»¯ liá»‡u, tá»‘i Æ°u hÃ³a kiáº¿n trÃºc cá»¥m.</p>
<h2>Tá»‘i Æ°u hÃ³a cáº¥u hÃ¬nh pháº§n cá»©ng</h2>
<p>NÃ¢ng cáº¥p cáº¥u hÃ¬nh pháº§n cá»©ng luÃ´n lÃ  phÆ°Æ¡ng phÃ¡p tÄƒng cÆ°á»ng kháº£ nÄƒng phá»¥c vá»¥ nhanh chÃ³ng vÃ  hiá»‡u quáº£ nháº¥t, ba yáº¿u tá»‘ cÃ³ thá»ƒ áº£nh hÆ°á»Ÿng Ä‘áº¿n hiá»‡u suáº¥t á»©ng dá»¥ng á»Ÿ cáº¥p Ä‘á»™ há»‡ thá»‘ng bao gá»“m: CPU, bá»™ nhá»› vÃ  IO, cÃ³ thá»ƒ tá»‘i Æ°u hÃ³a hiá»‡u suáº¥t ES tá»« ba khÃ­a cáº¡nh nÃ y.</p>
<h3>Cáº¥u hÃ¬nh CPU</h3>
<p>NÃ³i chung, cÃ³ má»™t sá»‘ lÃ½ do khiáº¿n CPU báº­n rá»™n:</p>
<ol>
<li>CÃ³ vÃ²ng láº·p vÃ´ háº¡n, khÃ´ng cháº·n, khá»›p máº«u thÃ´ng thÆ°á»ng hoáº·c chá»‰ tÃ­nh toÃ¡n trong luá»“ng;</li>
<li>Xáº£y ra GC thÆ°á»ng xuyÃªn;</li>
<li>Chuyá»ƒn Ä‘á»•i ngá»¯ cáº£nh cá»§a nhiá»u luá»“ng;</li>
</ol>
<p>Háº§u háº¿t cÃ¡c triá»ƒn khai Elasticsearch thÆ°á»ng khÃ´ng Ä‘áº·t yÃªu cáº§u cao Ä‘á»‘i vá»›i CPU. Do Ä‘Ã³, so vá»›i cÃ¡c tÃ i nguyÃªn khÃ¡c, viá»‡c cáº¥u hÃ¬nh bao nhiÃªu (CPU) khÃ´ng quan trá»ng láº¯m. Báº¡n nÃªn chá»n bá»™ xá»­ lÃ½ hiá»‡n Ä‘áº¡i cÃ³ nhiá»u nhÃ¢n, mÃ¡y chá»§ trong cá»¥m thÆ°á»ng sá»­ dá»¥ng tá»« 2 Ä‘áº¿n 8 nhÃ¢n. <strong>Náº¿u báº¡n pháº£i chá»n giá»¯a CPUs nhanh hÆ¡n vÃ  sá»‘ lÆ°á»£ng nhÃ¢n nhiá»u hÆ¡n, viá»‡c chá»n sá»‘ lÆ°á»£ng nhÃ¢n nhiá»u hÆ¡n sáº½ tá»‘t hÆ¡n</strong>. Sá»‘ lÆ°á»£ng nhÃ¢n bá»• sung cung cáº¥p Ä‘á»“ng thá»i nhiá»u hÆ¡n ráº¥t nhiá»u so vá»›i tá»‘c Ä‘á»™ xung nhá»‹p nhanh hÆ¡n má»™t chÃºt.</p>
<h3>Cáº¥u hÃ¬nh bá»™ nhá»›</h3>
<p>Náº¿u cÃ³ má»™t loáº¡i tÃ i nguyÃªn nÃ o Ä‘Ã³ sáº½ Ä‘Æ°á»£c tiÃªu thá»¥ trÆ°á»›c tiÃªn, Ä‘Ã³ cÃ³ thá»ƒ lÃ  bá»™ nhá»›. Sáº¯p xáº¿p vÃ  tá»•ng há»£p Ä‘á»u tiÃªu thá»¥ nhiá»u bá»™ nhá»›, vÃ¬ váº­y viá»‡c cÃ³ Ä‘á»§ khÃ´ng gian heap Ä‘á»ƒ xá»­ lÃ½ chÃºng lÃ  ráº¥t quan trá»ng. Ngay cáº£ khi khÃ´ng gian heap khÃ¡ nhá», nÃ³ cÅ©ng cÃ³ thá»ƒ cung cáº¥p thÃªm bá»™ nhá»› cho bá»™ Ä‘á»‡m tá»‡p há»‡ Ä‘iá»u hÃ nh. Bá»Ÿi vÃ¬ nhiá»u cáº¥u trÃºc dá»¯ liá»‡u mÃ  Lucene sá»­ dá»¥ng dá»±a trÃªn Ä‘á»‹nh dáº¡ng dá»±a trÃªn Ä‘Ä©a, Elasticsearch táº­n dá»¥ng bá»™ Ä‘á»‡m há»‡ Ä‘iá»u hÃ nh cÃ³ thá»ƒ táº¡o ra hiá»‡u quáº£ lá»›n.</p>
<p><strong>MÃ¡y cÃ³ bá»™ nhá»› 64 GB lÃ  ráº¥t lÃ½ tÆ°á»Ÿng</strong>, nhÆ°ng mÃ¡y 32 GB vÃ  16 GB cÅ©ng ráº¥t phá»• biáº¿n. DÆ°á»›i 8 GB sáº½ pháº£n tÃ¡c dá»¥ng (báº¡n cuá»‘i cÃ¹ng sáº½ cáº§n ráº¥t nhiá»u mÃ¡y nhá»), mÃ¡y cÃ³ bá»™ nhá»› lá»›n hÆ¡n 64 GB cÅ©ng sáº½ gáº·p váº¥n Ä‘á».</p>
<p>Do ES Ä‘Æ°á»£c xÃ¢y dá»±ng dá»±a trÃªn lucene, vÃ  sá»©c máº¡nh cá»§a thiáº¿t káº¿ lucene náº±m á»Ÿ chá»— lucene cÃ³ thá»ƒ táº­n dá»¥ng tá»‘t bá»™ nhá»› há»‡ Ä‘iá»u hÃ nh Ä‘á»ƒ lÆ°u trá»¯ dá»¯ liá»‡u chá»‰ má»¥c, Ä‘á»ƒ cung cáº¥p hiá»‡u suáº¥t truy váº¥n nhanh. CÃ¡c tá»‡p phÃ¢n Ä‘oáº¡n chá»‰ má»¥c cá»§a lucene Ä‘Æ°á»£c lÆ°u trá»¯ trong má»™t tá»‡p duy nháº¥t vÃ  khÃ´ng thay Ä‘á»•i, Ä‘á»‘i vá»›i há»‡ Ä‘iá»u hÃ nh, cÃ³ thá»ƒ giá»¯ tá»‡p chá»‰ má»¥c trong bá»™ Ä‘á»‡m má»™t cÃ¡ch thÃ¢n thiá»‡n, Ä‘á»ƒ truy cáº­p nhanh; do Ä‘Ã³, chÃºng ta cáº§n Ä‘á»ƒ má»™t ná»­a bá»™ nhá»› váº­t lÃ½ cho lucene; ná»­a cÃ²n láº¡i cá»§a bá»™ nhá»› váº­t lÃ½ Ä‘á»ƒ cho ES (JVM heap).</p>
<h4>PhÃ¢n bá»• bá»™ nhá»›</h4>
<p>Khi bá»™ nhá»› mÃ¡y nhá» hÆ¡n 64G, tuÃ¢n theo nguyÃªn táº¯c chung, 50% cho ES, 50% cho lucene.</p>
<p>Khi bá»™ nhá»› mÃ¡y lá»›n hÆ¡n 64G, tuÃ¢n theo nguyÃªn táº¯c sau:</p>
<ul>
<li>Náº¿u cáº£nh sá»­ dá»¥ng chÃ­nh lÃ  tÃ¬m kiáº¿m toÃ n vÄƒn báº£n, thÃ¬ nÃªn cáº¥p 4~32G bá»™ nhá»› cho ES Heap; bá»™ nhá»› khÃ¡c Ä‘á»ƒ cho há»‡ Ä‘iá»u hÃ nh, cho lucene sá»­ dá»¥ng (segments cache), Ä‘á»ƒ cung cáº¥p hiá»‡u suáº¥t truy váº¥n nhanh hÆ¡n.</li>
<li>Náº¿u cáº£nh sá»­ dá»¥ng chÃ­nh lÃ  tá»•ng há»£p hoáº·c sáº¯p xáº¿p, vÃ  háº§u háº¿t lÃ  numerics, dates, geo_points vÃ  cÃ¡c loáº¡i kÃ½ tá»± not_analyzed, nÃªn cáº¥p 4~32G bá»™ nhá»› cho ES Heap; bá»™ nhá»› khÃ¡c Ä‘á»ƒ cho há»‡ Ä‘iá»u hÃ nh, cho lucene sá»­ dá»¥ng, cung cáº¥p hiá»‡u suáº¥t tá»•ng há»£p, sáº¯p xáº¿p nhanh hÆ¡n dá»±a trÃªn tÃ i liá»‡u.</li>
<li>Náº¿u cáº£nh sá»­ dá»¥ng lÃ  tá»•ng há»£p hoáº·c sáº¯p xáº¿p, vÃ  táº¥t cáº£ Ä‘á»u dá»±a trÃªn dá»¯ liá»‡u kÃ½ tá»± analyzed, thÃ¬ cáº§n nhiá»u heap size hÆ¡n, nÃªn cháº¡y nhiá»u thá»±c thá»ƒ ES trÃªn mÃ¡y, má»—i thá»±c thá»ƒ giá»¯ khÃ´ng vÆ°á»£t quÃ¡ 50% cÃ i Ä‘áº·t heap ES (nhÆ°ng khÃ´ng vÆ°á»£t quÃ¡ 32 G, khi heap memory Ä‘Æ°á»£c cÃ i Ä‘áº·t dÆ°á»›i 32 G, JVM sá»­ dá»¥ng ká»¹ thuáº­t nÃ©n chá»‰ sá»‘ Ä‘á»‘i tÆ°á»£ng Ä‘á»ƒ tiáº¿t kiá»‡m khÃ´ng gian), hÆ¡n 50% Ä‘á»ƒ cho lucene.</li>
</ul>
<h4>VÃ´ hiá»‡u hÃ³a swap</h4>
<p>VÃ´ hiá»‡u hÃ³a swap, má»™t khi cho phÃ©p trao Ä‘á»•i bá»™ nhá»› vá»›i Ä‘Ä©a, sáº½ gÃ¢y ra váº¥n Ä‘á» vá» hiá»‡u suáº¥t nghiÃªm trá»ng. CÃ³ thá»ƒ thÃ´ng qua <code>bootstrap.memory_lock: true</code> trong elasticsearch.yml, Ä‘á»ƒ giá»¯ JVM khÃ³a bá»™ nhá»›, Ä‘áº£m báº£o hiá»‡u suáº¥t cá»§a ES.</p>
<h4>CÃ i Ä‘áº·t GC</h4>
<p>Giá»¯ cÃ i Ä‘áº·t GC hiá»‡n táº¡i, cÃ i Ä‘áº·t máº·c Ä‘á»‹nh lÃ : Concurrent-Mark and Sweep (CMS), khÃ´ng chuyá»ƒn sang G1 GC, vÃ¬ hiá»‡n táº¡i G1 váº«n cÃ³ ráº¥t nhiá»u BUG.</p>
<p>Giá»¯ cÃ i Ä‘áº·t hiá»‡n táº¡i cá»§a thread pool, hiá»‡n táº¡i cÃ i Ä‘áº·t thread pool cá»§a ES Ä‘Ã£ cÃ³ nhiá»u cÃ i Ä‘áº·t tá»‘i Æ°u hÃ³a so vá»›i 1.X, giá»¯ nguyÃªn lÃ  Ä‘Æ°á»£c; kÃ­ch thÆ°á»›c thread pool máº·c Ä‘á»‹nh báº±ng sá»‘ lÆ°á»£ng lÃµi CPU. Náº¿u cáº§n thay Ä‘á»•i, cÃ i Ä‘áº·t theo cÃ´ng thá»©c ((sá»‘ lÆ°á»£ng lÃµi CPU * 3) / 2) + 1; khÃ´ng Ä‘Æ°á»£c vÆ°á»£t quÃ¡ gáº¥p Ä‘Ã´i sá»‘ lÆ°á»£ng lÃµi CPU; nhÆ°ng khÃ´ng nÃªn thay Ä‘á»•i cáº¥u hÃ¬nh máº·c Ä‘á»‹nh, náº¿u khÃ´ng sáº½ gÃ¢y tá»•n thÆ°Æ¡ng cho CPU.</p>
<h3>ÄÄ©a</h3>
<p>ÄÄ©a quan trá»ng Ä‘á»‘i vá»›i táº¥t cáº£ cÃ¡c cá»¥m, Ä‘áº·c biá»‡t quan trá»ng Ä‘á»‘i vá»›i cÃ¡c cá»¥m cÃ³ lÆ°á»£ng ghi lá»›n (vÃ­ dá»¥ nhÆ° nhá»¯ng cá»¥m lÆ°u trá»¯ dá»¯ liá»‡u nháº­t kÃ½). ÄÄ©a lÃ  há»‡ thá»‘ng con cháº­m nháº¥t trÃªn mÃ¡y chá»§, Ä‘iá»u nÃ y cÃ³ nghÄ©a lÃ  nhá»¯ng cá»¥m cÃ³ lÆ°á»£ng ghi lá»›n dá»… dÃ ng lÃ m cho Ä‘Ä©a bÃ£o hÃ²a, khiáº¿n nÃ³ trá»Ÿ thÃ nh nÃºt tháº¯t cá»• chai cá»§a cá»¥m.</p>
<p><strong>Trong pháº¡m vi chá»‹u Ä‘á»±ng Ä‘Æ°á»£c Ã¡p lá»±c kinh táº¿, hÃ£y sá»­ dá»¥ng á»• Ä‘Ä©a thá»ƒ ráº¯n (SSD) cÃ ng nhiá»u cÃ ng tá»‘t</strong>. So vá»›i báº¥t ká»³ phÆ°Æ¡ng tiá»‡n quay nÃ o (á»• Ä‘Ä©a cá»©ng cÆ¡ há»c, bÄƒng tá»«, v.v.), á»• Ä‘Ä©a thá»ƒ ráº¯n sáº½ tÄƒng cÆ°á»ng IO Ä‘Ã¡ng ká»ƒ, dÃ¹ lÃ  ghi ngáº«u nhiÃªn hay ghi tuáº§n tá»±.</p>
<blockquote>
<p>Náº¿u báº¡n Ä‘ang sá»­ dá»¥ng SSD, hÃ£y Ä‘áº£m báº£o ráº±ng trÃ¬nh láº­p lá»‹ch I/O cá»§a há»‡ thá»‘ng báº¡n Ä‘Æ°á»£c cáº¥u hÃ¬nh Ä‘Ãºng. Khi báº¡n ghi dá»¯ liá»‡u vÃ o Ä‘Ä©a, trÃ¬nh láº­p lá»‹ch I/O quyáº¿t Ä‘á»‹nh khi nÃ o thá»±c sá»± gá»­i dá»¯ liá»‡u Ä‘áº¿n Ä‘Ä©a. Háº§u háº¿t cÃ¡c phiÃªn báº£n *nix máº·c Ä‘á»‹nh cÃ³ trÃ¬nh láº­p lá»‹ch lÃ  cfq (Completely Fair Queuing).</p>
<p>TrÃ¬nh láº­p lá»‹ch phÃ¢n bá»• thá»i gian cho má»—i quy trÃ¬nh. VÃ  tá»‘i Æ°u hÃ³a viá»‡c chuyá»ƒn cÃ¡c hÃ ng Ä‘á»£i lá»›n Ä‘áº¿n Ä‘Ä©a. NhÆ°ng nÃ³ Ä‘Æ°á»£c tá»‘i Æ°u hÃ³a cho phÆ°Æ¡ng tiá»‡n quay: Ä‘áº·c tÃ­nh cá»‘ há»¯u cá»§a á»• Ä‘Ä©a cÆ¡ há»c cÃ³ nghÄ©a lÃ  viá»‡c ghi dá»¯ liá»‡u vÃ o Ä‘Ä©a dá»±a trÃªn bá»‘ cá»¥c váº­t lÃ½ sáº½ hiá»‡u quáº£ hÆ¡n.</p>
<p>Äiá»u nÃ y khÃ´ng hiá»‡u quáº£ Ä‘á»‘i vá»›i SSD, máº·c dÃ¹ khÃ´ng liÃªn quan Ä‘áº¿n á»• Ä‘Ä©a cÆ¡ há»c. Tuy nhiÃªn, deadline hoáº·c noop nÃªn Ä‘Æ°á»£c sá»­ dá»¥ng. TrÃ¬nh láº­p lá»‹ch deadline tá»‘i Æ°u hÃ³a dá»±a trÃªn thá»i gian chá» ghi, trong khi noop chá»‰ lÃ  má»™t hÃ ng Ä‘á»£i FIFO Ä‘Æ¡n giáº£n.</p>
<p>Thay Ä‘á»•i Ä‘Æ¡n giáº£n nÃ y cÃ³ thá»ƒ táº¡o ra sá»± khÃ¡c biá»‡t Ä‘Ã¡ng ká»ƒ. Chá»‰ cáº§n sá»­ dá»¥ng trÃ¬nh láº­p lá»‹ch Ä‘Ãºng, chÃºng tÃ´i Ä‘Ã£ tháº¥y kháº£ nÄƒng ghi tÄƒng lÃªn 500 láº§n.</p>
</blockquote>
<p><strong>Náº¿u báº¡n sá»­ dá»¥ng phÆ°Æ¡ng tiá»‡n quay (nhÆ° á»• Ä‘Ä©a cÆ¡ há»c), hÃ£y cá»‘ gáº¯ng cÃ³ Ä‘Æ°á»£c á»• Ä‘Ä©a nhanh nháº¥t cÃ³ thá»ƒ (á»• Ä‘Ä©a mÃ¡y chá»§ hiá»‡u suáº¥t cao, á»• Ä‘Ä©a 15k RPM)</strong>.</p>
<p><strong>Sá»­ dá»¥ng RAID0 lÃ  cÃ¡ch hiá»‡u quáº£ Ä‘á»ƒ tÄƒng tá»‘c Ä‘á»™ Ä‘Ä©a, Ä‘á»‘i vá»›i cáº£ á»• Ä‘Ä©a cÆ¡ há»c vÃ  SSD</strong>. KhÃ´ng cáº§n pháº£i sá»­ dá»¥ng gÆ°Æ¡ng hoáº·c cÃ¡c biáº¿n thá»ƒ RAID khÃ¡c, bá»Ÿi vÃ¬ Elasticsearch Ä‘Ã£ cung cáº¥p chá»©c nÄƒng sao lÆ°u á»Ÿ cáº¥p Ä‘á»™ tá»± thÃ¢n thÃ´ng qua cÃ¡c báº£n sao, vÃ¬ váº­y khÃ´ng cáº§n sá»­ dá»¥ng chá»©c nÄƒng sao lÆ°u cá»§a Ä‘Ä©a, Ä‘á»“ng thá»i náº¿u sá»­ dá»¥ng chá»©c nÄƒng sao lÆ°u cá»§a Ä‘Ä©a, sáº½ áº£nh hÆ°á»Ÿng lá»›n Ä‘áº¿n tá»‘c Ä‘á»™ ghi.</p>
<p><strong>Cuá»‘i cÃ¹ng, hÃ£y trÃ¡nh sá»­ dá»¥ng lÆ°u trá»¯ káº¿t ná»‘i máº¡ng (NAS)</strong>. Má»i ngÆ°á»i thÆ°á»ng tuyÃªn bá»‘ ráº±ng giáº£i phÃ¡p NAS cá»§a há» nhanh hÆ¡n vÃ  Ä‘Ã¡ng tin cáº­y hÆ¡n so vá»›i á»• Ä‘Ä©a cá»¥c bá»™. Bá» qua nhá»¯ng tuyÃªn bá»‘ nÃ y, chÃºng tÃ´i chÆ°a bao giá» tháº¥y NAS Ä‘Ã¡ng giÃ¡ cho sá»± quáº£ng cÃ¡o lá»›n cá»§a nÃ³. NAS thÆ°á»ng ráº¥t cháº­m, hiá»ƒn thá»‹ Ä‘á»™ trá»… lá»›n hÆ¡n vÃ  phÆ°Æ¡ng sai Ä‘á»™ trá»… trung bÃ¬nh rá»™ng hÆ¡n, vÃ  nÃ³ lÃ  Ä‘iá»ƒm lá»—i Ä‘Æ¡n.</p>
<h2>CÃ i Ä‘áº·t tá»‘i Æ°u hÃ³a chá»‰ má»¥c</h2>
<p>Tá»‘i Æ°u hÃ³a chá»‰ má»¥c chá»§ yáº¿u táº­p trung vÃ o viá»‡c tá»‘i Æ°u hÃ³a á»Ÿ má»©c Ä‘á»™ chÃ¨n cá»§a Elasticsearch, tá»‘c Ä‘á»™ chá»‰ má»¥c cá»§a Elasticsearch thá»±c sá»± khÃ¡ nhanh, dá»¯ liá»‡u cá»¥ thá»ƒ, chÃºng ta cÃ³ thá»ƒ tham kháº£o dá»¯ liá»‡u benchmark chÃ­nh thá»©c. ChÃºng ta cÃ³ thá»ƒ tá»‘i Æ°u hÃ³a chá»‰ má»¥c dá»±a trÃªn cÃ¡c yÃªu cáº§u khÃ¡c nhau.</p>
<h3>Gá»­i hÃ ng loáº¡t</h3>
<p>Khi cÃ³ ráº¥t nhiá»u dá»¯ liá»‡u cáº§n gá»­i, nÃªn sá»­ dá»¥ng gá»­i hÃ ng loáº¡t (hoáº¡t Ä‘á»™ng Bulk); ngoÃ i ra, khi sá»­ dá»¥ng yÃªu cáº§u bulk, má»—i yÃªu cáº§u khÃ´ng nÃªn vÆ°á»£t quÃ¡ vÃ i chá»¥c MB, vÃ¬ náº¿u quÃ¡ lá»›n sáº½ dáº«n Ä‘áº¿n viá»‡c sá»­ dá»¥ng quÃ¡ nhiá»u bá»™ nhá»›.</p>
<p>VÃ­ dá»¥, trong quÃ¡ trÃ¬nh thá»±c thi ELK, Logstash indexer gá»­i dá»¯ liá»‡u vÃ o Elasticsearch, kÃ­ch thÆ°á»›c batch cÃ³ thá»ƒ hoáº¡t Ä‘á»™ng nhÆ° má»™t Ä‘iá»ƒm tá»‘i Æ°u hÃ³a. Tuy nhiÃªn, kÃ­ch thÆ°á»›c tá»‘i Æ°u cáº§n pháº£i xÃ¡c Ä‘á»‹nh dá»±a trÃªn kÃ­ch thÆ°á»›c tÃ i liá»‡u vÃ  hiá»‡u suáº¥t mÃ¡y chá»§.</p>
<p>VÃ­ dá»¥, trong Logstash, náº¿u kÃ­ch thÆ°á»›c tÃ i liá»‡u gá»­i vÆ°á»£t quÃ¡ 20MB, Logstash sáº½ chia má»™t yÃªu cáº§u hÃ ng loáº¡t thÃ nh nhiá»u yÃªu cáº§u hÃ ng loáº¡t.</p>
<p>Náº¿u trong quÃ¡ trÃ¬nh gá»­i, báº¡n gáº·p pháº£i ngoáº¡i lá»‡ EsRejectedExecutionException, thÃ¬ Ä‘iá»u nÃ y cho tháº¥y hiá»‡u suáº¥t chá»‰ má»¥c cá»§a cá»¥m Ä‘Ã£ Ä‘áº¡t Ä‘áº¿n giá»›i háº¡n. Trong trÆ°á»ng há»£p nÃ y, báº¡n cáº§n tÄƒng nguá»“n lá»±c cá»§a cá»¥m mÃ¡y chá»§ hoáº·c giáº£m tá»‘c Ä‘á»™ thu tháº­p dá»¯ liá»‡u dá»±a trÃªn quy táº¯c kinh doanh, vÃ­ dá»¥ chá»‰ thu tháº­p nháº­t kÃ½ cáº¥p Warn, Error trá»Ÿ lÃªn.</p>
<h3>TÄƒng khoáº£ng thá»i gian Refresh</h3>
<p>Äá»ƒ tÄƒng hiá»‡u suáº¥t chá»‰ má»¥c, Elasticsearch sá»­ dá»¥ng chiáº¿n lÆ°á»£c ghi trá»… khi ghi dá»¯ liá»‡u, tá»©c lÃ  dá»¯ liá»‡u Ä‘Æ°á»£c ghi vÃ o bá»™ nhá»› trÆ°á»›c, khi vÆ°á»£t quÃ¡ 1 giÃ¢y máº·c Ä‘á»‹nh (index.refresh_interval) sáº½ thá»±c hiá»‡n má»™t hoáº¡t Ä‘á»™ng ghi, tá»©c lÃ  lÃ m má»›i dá»¯ liá»‡u segment trong bá»™ nhá»› vÃ o Ä‘Ä©a, lÃºc nÃ y chÃºng ta má»›i cÃ³ thá»ƒ tÃ¬m kiáº¿m dá»¯ liá»‡u. ÄÃ¢y lÃ  lÃ½ do táº¡i sao Elasticsearch cung cáº¥p chá»©c nÄƒng tÃ¬m kiáº¿m gáº§n thá»i gian thá»±c, chá»© khÃ´ng pháº£i lÃ  tÃ¬m kiáº¿m thá»i gian thá»±c.</p>
<p>Náº¿u há»‡ thá»‘ng cá»§a chÃºng ta khÃ´ng Ä‘áº·t yÃªu cáº§u cao vá» Ä‘á»™ trá»… dá»¯ liá»‡u, chÃºng ta <strong>cÃ³ thá»ƒ tÄƒng khoáº£ng thá»i gian lÃ m má»›i Ä‘á»ƒ giáº£m Ã¡p lá»±c há»£p nháº¥t segment vÃ  tÄƒng tá»‘c Ä‘á»™ chá»‰ má»¥c</strong>. VÃ­ dá»¥, trong quÃ¡ trÃ¬nh theo dÃµi toÃ n bá»™ chuá»—i, chÃºng tÃ´i Ä‘Ã£ Ä‘áº·t <code>index.refresh_interval</code> thÃ nh 30 giÃ¢y, giáº£m sá»‘ láº§n lÃ m má»›i. Má»™t vÃ­ dá»¥ khÃ¡c, khi tiáº¿n hÃ nh chá»‰ má»¥c toÃ n bá»™, báº¡n cÃ³ thá»ƒ táº¡m thá»i táº¯t sá»‘ láº§n lÃ m má»›i, tá»©c lÃ  Ä‘áº·t <code>index.refresh_interval</code> thÃ nh -1, sau khi dá»¯ liá»‡u Ä‘Æ°á»£c nháº­p thÃ nh cÃ´ng, hÃ£y má»Ÿ láº¡i cháº¿ Ä‘á»™ bÃ¬nh thÆ°á»ng, vÃ­ dá»¥ 30 giÃ¢y.</p>
<blockquote>
<p>Khi táº£i dá»¯ liá»‡u lá»›n, báº¡n cÃ³ thá»ƒ táº¡m thá»i khÃ´ng sá»­ dá»¥ng refresh vÃ  repliccas, Ä‘áº·t index.refresh_interval thÃ nh -1, Ä‘áº·t index.number_of_replicas thÃ nh 0.</p>
</blockquote>
<h3>Chá»‰nh sá»­a cÃ i Ä‘áº·t index_buffer_size</h3>
<p>CÃ i Ä‘áº·t bá»™ Ä‘á»‡m chá»‰ má»¥c cÃ³ thá»ƒ kiá»ƒm soÃ¡t bao nhiÃªu bá»™ nhá»› Ä‘Æ°á»£c phÃ¢n bá»• cho quÃ¡ trÃ¬nh chá»‰ má»¥c. ÄÃ¢y lÃ  má»™t cáº¥u hÃ¬nh toÃ n cáº§u, sáº½ Ä‘Æ°á»£c Ã¡p dá»¥ng cho táº¥t cáº£ cÃ¡c phÃ¢n Ä‘oáº¡n khÃ¡c nhau trÃªn má»™t nÃºt.</p>
<div class="language-yml" data-ext="yml" data-title="yml"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">indices.memory.index_buffer_size</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">10%</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">indices.memory.min_index_buffer_size</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">48mb</span></span></code></pre>
</div><p><code>indices.memory.index_buffer_size</code> cháº¥p nháº­n má»™t pháº§n trÄƒm hoáº·c má»™t giÃ¡ trá»‹ biá»ƒu thá»‹ kÃ­ch thÆ°á»›c byte. Máº·c Ä‘á»‹nh lÃ  10%, cÃ³ nghÄ©a lÃ  10% tá»•ng bá»™ nhá»› Ä‘Æ°á»£c phÃ¢n bá»• cho nÃºt Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ lÃ m kÃ­ch thÆ°á»›c bá»™ Ä‘á»‡m chá»‰ má»¥c. GiÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chia cho cÃ¡c phÃ¢n Ä‘oáº¡n (shards) khÃ¡c nhau. Náº¿u báº¡n Ä‘áº·t pháº§n trÄƒm, báº¡n cÅ©ng cÃ³ thá»ƒ Ä‘áº·t <code>min_index_buffer_size</code> (máº·c Ä‘á»‹nh lÃ  48mb) vÃ  <code>max_index_buffer_size</code> (máº·c Ä‘á»‹nh khÃ´ng cÃ³ giá»›i háº¡n trÃªn).</p>
<h3>Chá»‰nh sá»­a cÃ i Ä‘áº·t liÃªn quan Ä‘áº¿n translog</h3>
<p>Má»™t lÃ  kiá»ƒm soÃ¡t táº§n suáº¥t hoáº¡t Ä‘á»™ng tá»« bá»™ nhá»› Ä‘áº¿n á»• cá»©ng, Ä‘á»ƒ giáº£m IO á»• cá»©ng. Báº¡n cÃ³ thá»ƒ Ä‘áº·t thá»i gian sync_interval lá»›n hÆ¡n. Máº·c Ä‘á»‹nh lÃ  5 giÃ¢y.</p>
<div class="language-yml" data-ext="yml" data-title="yml"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">index.translog.sync_interval</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">5s</span></span></code></pre>
</div><p>Báº¡n cÅ©ng cÃ³ thá»ƒ kiá»ƒm soÃ¡t kÃ­ch thÆ°á»›c khá»‘i dá»¯ liá»‡u tranlog, khi Ä‘áº¡t Ä‘áº¿n kÃ­ch thÆ°á»›c threshold, dá»¯ liá»‡u má»›i sáº½ Ä‘Æ°á»£c flush vÃ o tá»‡p chá»‰ má»¥c lucene. Máº·c Ä‘á»‹nh lÃ  512mb.</p>
<div class="language-yml" data-ext="yml" data-title="yml"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">index.translog.flush_threshold_size</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">512mb</span></span></code></pre>
</div><h3>ChÃº Ã½ sá»­ dá»¥ng trÆ°á»ng _id</h3>
<p>Trong viá»‡c sá»­ dá»¥ng trÆ°á»ng _id, báº¡n nÃªn trÃ¡nh tÃ¹y chá»‰nh _id Ä‘á»ƒ trÃ¡nh quáº£n lÃ½ phiÃªn báº£n dá»±a trÃªn ID; nÃªn sá»­ dá»¥ng chiáº¿n lÆ°á»£c táº¡o ID máº·c Ä‘á»‹nh cá»§a ES hoáº·c sá»­ dá»¥ng ID kiá»ƒu sá»‘ lÃ m khÃ³a chÃ­nh.</p>
<h3>ChÃº Ã½ sá»­ dá»¥ng trÆ°á»ng _all vÃ  trÆ°á»ng _source</h3>
<p>Báº¡n nÃªn chÃº Ã½ Ä‘áº¿n viá»‡c sá»­ dá»¥ng trÆ°á»ng _all vÃ  trÆ°á»ng _source, tÃ¹y thuá»™c vÃ o tÃ¬nh huá»‘ng vÃ  nhu cáº§u, trÆ°á»ng _all bao gá»“m táº¥t cáº£ cÃ¡c trÆ°á»ng chá»‰ má»¥c, thuáº­n tiá»‡n cho viá»‡c tÃ¬m kiáº¿m toÃ n vÄƒn, náº¿u khÃ´ng cÃ³ nhu cáº§u nÃ y, cÃ³ thá»ƒ táº¯t; _source lÆ°u trá»¯ ná»™i dung tÃ i liá»‡u gá»‘c, náº¿u khÃ´ng cÃ³ nhu cáº§u láº¥y dá»¯ liá»‡u tÃ i liá»‡u gá»‘c, cÃ³ thá»ƒ Ä‘á»‹nh nghÄ©a cÃ¡c trÆ°á»ng Ä‘Æ°á»£c Ä‘Æ°a vÃ o _source báº±ng cÃ¡ch Ä‘áº·t thuá»™c tÃ­nh includes, excludes.</p>
<h3>Sá»­ dá»¥ng thuá»™c tÃ­nh index má»™t cÃ¡ch há»£p lÃ½</h3>
<p>HÃ£y sá»­ dá»¥ng thuá»™c tÃ­nh index má»™t cÃ¡ch há»£p lÃ½, analyzed vÃ  not_analyzed, kiá»ƒm soÃ¡t trÆ°á»ng cÃ³ pháº£i lÃ  tá»« vá»±ng hay khÃ´ng dá»±a trÃªn yÃªu cáº§u kinh doanh. Chá»‰ cáº§n cÃ¡c trÆ°á»ng yÃªu cáº§u groupby, khi cáº¥u hÃ¬nh, Ä‘áº·t thÃ nh not_analyzed Ä‘á»ƒ tÄƒng hiá»‡u suáº¥t truy váº¥n hoáº·c phÃ¢n loáº¡i.</p>
<h3>Giáº£m sá»‘ lÆ°á»£ng báº£n sao</h3>
<p>Elasticsearch máº·c Ä‘á»‹nh sá»‘ lÆ°á»£ng báº£n sao lÃ  3, máº·c dÃ¹ Ä‘iá»u nÃ y sáº½ cáº£i thiá»‡n kháº£ nÄƒng sáºµn cÃ³ cá»§a cá»¥m, tÄƒng sá»‘ lÆ°á»£ng truy váº¥n Ä‘á»“ng thá»i, nhÆ°ng cÅ©ng sáº½ áº£nh hÆ°á»Ÿng Ä‘áº¿n hiá»‡u suáº¥t ghi chá»‰ má»¥c.</p>
<p>Trong quÃ¡ trÃ¬nh chá»‰ má»¥c, cáº§n gá»­i tÃ i liá»‡u Ä‘Æ°á»£c cáº­p nháº­t Ä‘áº¿n cÃ¡c nÃºt báº£n sao, chá» nÃºt báº£n sao hoáº¡t Ä‘á»™ng sau Ä‘Ã³ tráº£ vá» káº¿t thÃºc. Khi sá»­ dá»¥ng Elasticsearch Ä‘á»ƒ tÃ¬m kiáº¿m kinh doanh, nÃªn Ä‘áº·t sá»‘ lÆ°á»£ng báº£n sao lÃ  3, nhÆ°ng trong há»‡ thá»‘ng nháº­t kÃ½ ELK ná»™i bá»™, há»‡ thá»‘ng theo dÃµi phÃ¢n tÃ¡n, hoÃ n toÃ n cÃ³ thá»ƒ Ä‘áº·t sá»‘ lÆ°á»£ng báº£n sao lÃ  1.</p>
<h2>Tá»‘i Æ°u hÃ³a vá» truy váº¥n</h2>
<p>Khi Elasticsearch Ä‘Æ°á»£c sá»­ dá»¥ng nhÆ° má»™t truy váº¥n gáº§n thá»i gian thá»±c cho tÃ¬m kiáº¿m kinh doanh, viá»‡c tá»‘i Æ°u hÃ³a hiá»‡u suáº¥t truy váº¥n trá»Ÿ nÃªn ráº¥t quan trá»ng.</p>
<h3>Tá»‘i Æ°u hÃ³a Ä‘á»‹nh tuyáº¿n</h3>
<p>Khi chÃºng tÃ´i truy váº¥n má»™t tÃ i liá»‡u, Elasticsearch lÃ m tháº¿ nÃ o Ä‘á»ƒ biáº¿t má»™t tÃ i liá»‡u nÃªn Ä‘Æ°á»£c lÆ°u trá»¯ trong phÃ¢n Ä‘oáº¡n nÃ o? Thá»±c táº¿, nÃ³ Ä‘Æ°á»£c tÃ­nh toÃ¡n thÃ´ng qua cÃ´ng thá»©c sau Ä‘Ã¢y.</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>shard = hash(routing) % number_of_primary_shards</span></span></code></pre>
</div><p>GiÃ¡ trá»‹ máº·c Ä‘á»‹nh cá»§a routing lÃ  id cá»§a tÃ i liá»‡u, nhÆ°ng cÅ©ng cÃ³ thá»ƒ sá»­ dá»¥ng giÃ¡ trá»‹ tÃ¹y chá»‰nh, cháº³ng háº¡n nhÆ° ID ngÆ°á»i dÃ¹ng.</p>
<h4>Truy váº¥n khÃ´ng cÃ³ routing</h4>
<p>Khi truy váº¥n, vÃ¬ khÃ´ng biáº¿t dá»¯ liá»‡u cáº§n truy váº¥n cá»¥ thá»ƒ náº±m trÃªn phÃ¢n Ä‘oáº¡n nÃ o, nÃªn toÃ n bá»™ quÃ¡ trÃ¬nh Ä‘Æ°á»£c chia thÃ nh 2 bÆ°á»›c:</p>
<ol>
<li>PhÃ¢n phá»‘i: Khi yÃªu cáº§u Ä‘áº¿n nÃºt Ä‘iá»u phá»‘i, nÃºt Ä‘iá»u phá»‘i sáº½ phÃ¢n phá»‘i yÃªu cáº§u truy váº¥n Ä‘áº¿n má»—i phÃ¢n Ä‘oáº¡n.</li>
<li>Tá»•ng há»£p: NÃºt Ä‘iá»u phá»‘i thu tháº­p káº¿t quáº£ truy váº¥n tá»« má»—i phÃ¢n Ä‘oáº¡n, sau Ä‘Ã³ sáº¯p xáº¿p káº¿t quáº£ truy váº¥n, sau Ä‘Ã³ tráº£ vá» káº¿t quáº£ cho ngÆ°á»i dÃ¹ng.</li>
</ol>
<h4>Truy váº¥n cÃ³ routing</h4>
<p>Khi truy váº¥n, cÃ³ thá»ƒ trá»±c tiáº¿p xÃ¡c Ä‘á»‹nh má»™t phÃ¢n Ä‘oáº¡n truy váº¥n dá»±a trÃªn thÃ´ng tin routing, khÃ´ng cáº§n truy váº¥n táº¥t cáº£ cÃ¡c phÃ¢n Ä‘oáº¡n, sau Ä‘Ã³ sáº¯p xáº¿p thÃ´ng qua nÃºt Ä‘iá»u phá»‘i.</p>
<p>NhÆ° truy váº¥n ngÆ°á»i dÃ¹ng tÃ¹y chá»‰nh á»Ÿ trÃªn, náº¿u routing Ä‘Æ°á»£c Ä‘áº·t lÃ  userid, thÃ¬ cÃ³ thá»ƒ trá»±c tiáº¿p truy váº¥n ra dá»¯ liá»‡u, hiá»‡u quáº£ tÄƒng ráº¥t nhiá»u.</p>
<h3>Filter VS Query</h3>
<p>Náº¿u cÃ³ thá»ƒ, hÃ£y sá»­ dá»¥ng ngá»¯ cáº£nh bá»™ lá»c (Filter) thay vÃ¬ ngá»¯ cáº£nh truy váº¥n (Query)</p>
<ul>
<li>Query: TÃ i liá»‡u nÃ y khá»›p vá»›i cÃ¢u truy váº¥n con nÃ y á»Ÿ má»©c Ä‘á»™ nÃ o?</li>
<li>Filter: TÃ i liá»‡u nÃ y cÃ³ khá»›p vá»›i cÃ¢u truy váº¥n con khÃ´ng?</li>
</ul>
<p>Elasticsearch chá»‰ cáº§n tráº£ lá»i "cÃ³" hoáº·c "khÃ´ng" cho cÃ¡c truy váº¥n Filter, khÃ´ng cáº§n tÃ­nh Ä‘iá»ƒm liÃªn quan nhÆ° truy váº¥n Query, Ä‘á»“ng thá»i káº¿t quáº£ Filter cÃ³ thá»ƒ Ä‘Æ°á»£c lÆ°u vÃ o bá»™ nhá»› cache.</p>
<h3>PhÃ¢n trang sÃ¢u</h3>
<p>Trong quÃ¡ trÃ¬nh sá»­ dá»¥ng Elasticsearch, nÃªn trÃ¡nh viá»‡c phÃ¢n trang lá»›n xáº£y ra.</p>
<p>Truy váº¥n phÃ¢n trang thÃ´ng thÆ°á»ng Ä‘á»u báº¯t Ä‘áº§u tá»« from vÃ  láº¥y size báº£n ghi, Ä‘iá»u nÃ y yÃªu cáº§u truy váº¥n vÃ  xáº¿p háº¡ng from+size báº£n ghi Ä‘áº§u tiÃªn trong má»—i phÃ¢n Ä‘oáº¡n. NÃºt Ä‘iá»u phá»‘i thu tháº­p from+size báº£n ghi Ä‘áº§u tiÃªn tá»« má»—i phÃ¢n Ä‘oáº¡n. NÃºt Ä‘iá»u phá»‘i sáº½ nháº­n Ä‘Æ°á»£c N*(from+size) báº£n ghi, sau Ä‘Ã³ sáº¯p xáº¿p chÃºng, sau Ä‘Ã³ tráº£ vá» from Ä‘áº¿n from+size báº£n ghi. Náº¿u from hoáº·c size ráº¥t lá»›n, sá»‘ lÆ°á»£ng báº£n ghi tham gia sáº¯p xáº¿p sáº½ tÄƒng lÃªn nhiá»u, cuá»‘i cÃ¹ng sáº½ lÃ m tÄƒng tiÃªu hao tÃ i nguyÃªn CPU.</p>
<p>CÃ³ thá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y báº±ng cÃ¡ch sá»­ dá»¥ng scroll vÃ  scroll-scan hiá»‡u quáº£ cá»§a Elasticsearch.</p>
<p>CÅ©ng cÃ³ thá»ƒ káº¿t há»£p vá»›i Ä‘áº·c Ä‘iá»ƒm kinh doanh thá»±c táº¿, náº¿u kÃ­ch thÆ°á»›c id tÃ i liá»‡u vÃ  thá»i gian táº¡o tÃ i liá»‡u lÃ  Ä‘á»“ng nháº¥t vÃ  cÃ³ thá»© tá»±, cÃ³ thá»ƒ sá»­ dá»¥ng id tÃ i liá»‡u lÃ m offset phÃ¢n trang, vÃ  Ä‘áº·t nÃ³ lÃ m má»™t Ä‘iá»u kiá»‡n truy váº¥n phÃ¢n trang.</p>
<h3>Sá»­ dá»¥ng script má»™t cÃ¡ch há»£p lÃ½</h3>
<p>ChÃºng ta biáº¿t ráº±ng viá»‡c sá»­ dá»¥ng script chá»§ yáº¿u cÃ³ 3 hÃ¬nh thá»©c, cÃ¡ch biÃªn dá»‹ch Ä‘á»™ng ná»™i tuyáº¿n, lÆ°u trá»¯ trong thÆ° viá»‡n chá»‰ má»¥c _script vÃ  lÆ°u trá»¯ dÆ°á»›i dáº¡ng script tá»‡p; cáº£nh bÃ¡o thÃ´ng thÆ°á»ng lÃ  sáº¯p xáº¿p thÃ´, nÃªn sá»­ dá»¥ng cÃ¡ch thá»© hai Ä‘á»ƒ lÆ°u trá»¯ script trong thÆ° viá»‡n chá»‰ má»¥c _script trÆ°á»›c, Ä‘á»ƒ biÃªn dá»‹ch trÆ°á»›c, sau Ä‘Ã³ sá»­ dá»¥ng thÃ´ng qua id script vÃ  káº¿t há»£p vá»›i params, cÃ³ thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c mÃ´ hÃ¬nh (logic) vÃ  dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c phÃ¢n tÃ¡ch, Ä‘á»“ng thá»i dá»… dÃ ng má»Ÿ rá»™ng vÃ  báº£o dÆ°á»¡ng mÃ´-Ä‘un script. Vui lÃ²ng tham kháº£o chi tiáº¿t vá» ná»™i dung script ES táº¡i <a href="https://www.knowledgedict.com/tutorial/elasticsearch-script.html" target="_blank" rel="noopener noreferrer">Giáº£i thÃ­ch chi tiáº¿t vá» mÃ´-Ä‘un script Elasticsearch</a>.</p>
<h2>Tá»‘i Æ°u hÃ³a cáº¥u trÃºc dá»¯ liá»‡u</h2>
<p>Dá»±a trÃªn cÃ¡c tÃ¬nh huá»‘ng sá»­ dá»¥ng cá»§a Elasticsearch, cáº¥u trÃºc dá»¯ liá»‡u tÃ i liá»‡u nÃªn Ä‘Æ°á»£c káº¿t há»£p vá»›i tÃ¬nh huá»‘ng sá»­ dá»¥ng, loáº¡i bá» dá»¯ liá»‡u khÃ´ng cáº§n thiáº¿t vÃ  khÃ´ng há»£p lÃ½.</p>
<h3>Giáº£m thiá»ƒu cÃ¡c trÆ°á»ng khÃ´ng cáº§n thiáº¿t</h3>
<p>Náº¿u Elasticsearch Ä‘Æ°á»£c sá»­ dá»¥ng cho dá»‹ch vá»¥ tÃ¬m kiáº¿m kinh doanh, má»™t sá»‘ trÆ°á»ng khÃ´ng cáº§n thiáº¿t Ä‘á»ƒ tÃ¬m kiáº¿m nÃªn khÃ´ng Ä‘Æ°á»£c lÆ°u trong ES. Äiá»u nÃ y khÃ´ng chá»‰ tiáº¿t kiá»‡m khÃ´ng gian, mÃ  cÃ²n cáº£i thiá»‡n hiá»‡u suáº¥t tÃ¬m kiáº¿m vá»›i cÃ¹ng má»™t lÆ°á»£ng dá»¯ liá»‡u.</p>
<p>TrÃ¡nh sá»­ dá»¥ng giÃ¡ trá»‹ Ä‘á»™ng lÃ m trÆ°á»ng, viá»‡c tÄƒng mapping Ä‘á»™ng cÃ³ thá»ƒ dáº«n Ä‘áº¿n sá»± cá»‘ á»Ÿ cá»¥m; tÆ°Æ¡ng tá»±, cáº§n kiá»ƒm soÃ¡t sá»‘ lÆ°á»£ng trÆ°á»ng, khÃ´ng láº­p chá»‰ má»¥c cho cÃ¡c trÆ°á»ng khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng trong kinh doanh. Kiá»ƒm soÃ¡t sá»‘ lÆ°á»£ng trÆ°á»ng chá»‰ má»¥c, Ä‘á»™ sÃ¢u cá»§a mapping, loáº¡i trÆ°á»ng chá»‰ má»¥c, lÃ  quan trá»ng nháº¥t trong viá»‡c tá»‘i Æ°u hÃ³a hiá»‡u suáº¥t ES.</p>
<p>DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ cÃ i Ä‘áº·t máº·c Ä‘á»‹nh cá»§a ES vá» sá»‘ lÆ°á»£ng trÆ°á»ng, Ä‘á»™ sÃ¢u mapping:</p>
<div class="language-yml" data-ext="yml" data-title="yml"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">index.mapping.nested_objects.limit</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">10000</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">index.mapping.total_fields.limit</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1000</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">index.mapping.depth.limit</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">20</span></span></code></pre>
</div><h3>Nested Object vs Parent/Child</h3>
<p>Háº¡n cháº¿ sá»­ dá»¥ng cÃ¡c trÆ°á»ng nested hoáº·c parent/child, khÃ´ng sá»­ dá»¥ng náº¿u khÃ´ng cáº§n thiáº¿t; nested query cháº­m, parent/child query cÃ²n cháº­m hÆ¡n, cháº­m hÆ¡n nested query hÃ ng trÄƒm láº§n; vÃ¬ váº­y, náº¿u cÃ³ thá»ƒ giáº£i quyáº¿t á»Ÿ giai Ä‘oáº¡n thiáº¿t káº¿ mapping (thiáº¿t káº¿ báº£ng rá»™ng lá»›n hoáº·c sá»­ dá»¥ng cáº¥u trÃºc dá»¯ liá»‡u thÃ´ng minh), thÃ¬ khÃ´ng nÃªn sá»­ dá»¥ng mapping quan há»‡ cha-con.</p>
<p>Náº¿u báº¡n cáº§n sá»­ dá»¥ng nested fields, hÃ£y Ä‘áº£m báº£o khÃ´ng cÃ³ quÃ¡ nhiá»u trÆ°á»ng nested, hiá»‡n táº¡i giá»›i háº¡n máº·c Ä‘á»‹nh cá»§a ES lÃ  50. Bá»Ÿi vÃ¬ Ä‘á»‘i vá»›i 1 tÃ i liá»‡u, má»—i trÆ°á»ng nested sáº½ táº¡o ra má»™t tÃ i liá»‡u Ä‘á»™c láº­p, Ä‘iá»u nÃ y sáº½ lÃ m tÄƒng sá»‘ lÆ°á»£ng tÃ i liá»‡u má»™t cÃ¡ch Ä‘Ã¡ng ká»ƒ, áº£nh hÆ°á»Ÿng Ä‘áº¿n hiá»‡u suáº¥t truy váº¥n, Ä‘áº·c biá»‡t lÃ  hiá»‡u suáº¥t JOIN.</p>
<div class="language-yml" data-ext="yml" data-title="yml"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">index.mapping.nested_fields.limit</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">50</span></span></code></pre>
</div><p>| So sÃ¡nh | Nested Object                        | Parent/Child                                       |<br>
| :</p>
]]></content:encoded>
    </item>
    <item>
      <title>Elasticsearch Overview</title>
      <link>https://vanhung4499.github.io/database/elasticsearch/overview.html</link>
      <guid>https://vanhung4499.github.io/database/elasticsearch/overview.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Elasticsearch Overview</source>
      <description>Elasticsearch MOC Elasticsearch lÃ  má»™t cÃ´ng cá»¥ tÃ¬m kiáº¿m vÃ  phÃ¢n tÃ­ch dá»¯ liá»‡u dá»±a trÃªn Lucene, cung cáº¥p má»™t dá»‹ch vá»¥ phÃ¢n tÃ¡n. Elasticsearch lÃ  má»™t sáº£n pháº©m mÃ£ nguá»“n má»Ÿ tuÃ¢n theo ...</description>
      <category>elasticssearch</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>Elasticsearch lÃ  má»™t cÃ´ng cá»¥ tÃ¬m kiáº¿m vÃ  phÃ¢n tÃ­ch dá»¯ liá»‡u dá»±a trÃªn Lucene, cung cáº¥p má»™t dá»‹ch vá»¥ phÃ¢n tÃ¡n. Elasticsearch lÃ  má»™t sáº£n pháº©m mÃ£ nguá»“n má»Ÿ tuÃ¢n theo cÃ¡c Ä‘iá»u khoáº£n mÃ£ nguá»“n má»Ÿ cá»§a Apache vÃ  hiá»‡n Ä‘ang lÃ  cÃ´ng cá»¥ tÃ¬m kiáº¿m doanh nghiá»‡p phá»• biáº¿n.</p>
</blockquote>
<h2>ğŸ“– Contents</h2>
]]></content:encoded>
    </item>
    <item>
      <title>Elasticsearch Query</title>
      <link>https://vanhung4499.github.io/database/elasticsearch/query.html</link>
      <guid>https://vanhung4499.github.io/database/elasticsearch/query.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Elasticsearch Query</source>
      <description>Elasticsearch Query CÃ¢u truy váº¥n Elasticsearch sá»­ dá»¥ng interface dá»±a trÃªn phong cÃ¡ch RESTful Ä‘Æ°á»£c Ä‘Ã³ng gÃ³i thÃ nh Ä‘á»‘i tÆ°á»£ng JSON, Ä‘Æ°á»£c gá»i lÃ  Query DSL. Elasticsearch chia cÃ¡c tr...</description>
      <category>elasticssearch</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<p>CÃ¢u truy váº¥n Elasticsearch sá»­ dá»¥ng interface dá»±a trÃªn phong cÃ¡ch RESTful Ä‘Æ°á»£c Ä‘Ã³ng gÃ³i thÃ nh Ä‘á»‘i tÆ°á»£ng JSON, Ä‘Æ°á»£c gá»i lÃ  Query DSL. Elasticsearch chia cÃ¡c truy váº¥n thÃ nh cÃ¡c loáº¡i chÃ­nh sau: <strong>truy váº¥n toÃ n vÄƒn</strong>, <strong>truy váº¥n tá»« khoÃ¡</strong>, <strong>truy váº¥n káº¿t há»£p</strong>, <strong>truy váº¥n lá»“ng nhau</strong>, <strong>truy váº¥n vá»‹ trÃ­</strong>, <strong>truy váº¥n Ä‘áº·c biá»‡t</strong>. Má»™t cÃ¡ch phÃ¢n loáº¡i khÃ¡c cá»§a Elasticsearch truy váº¥n dá»±a vÃ o cÆ¡ cháº¿, má»™t lÃ  dá»±a vÃ o tá»« khoÃ¡ truy váº¥n Ä‘Æ°á»£c ngÆ°á»i dÃ¹ng nháº­p vÃ o, thÃ´ng qua mÃ´ hÃ¬nh xáº¿p háº¡ng Ä‘á»ƒ tÃ­nh toÃ¡n <strong>má»©c Ä‘á»™ liÃªn quan</strong> giá»¯a tÃ i liá»‡u vÃ  tá»« khoÃ¡ truy váº¥n, vÃ  tráº£ vá» dá»±a trÃªn thá»© tá»± Ä‘iá»ƒm sá»‘; cÃ¡ch khÃ¡c lÃ  <strong>cÆ¡ cháº¿ lá»c</strong>, chá»‰ lá»c tÃ i liá»‡u dá»±a trÃªn Ä‘iá»u kiá»‡n lá»c, khÃ´ng tÃ­nh toÃ¡n Ä‘iá»ƒm sá»‘, tá»‘c Ä‘á»™ tÆ°Æ¡ng Ä‘á»‘i nhanh hÆ¡n.</p>
<h2>Truy váº¥n toÃ n vÄƒn</h2>
<p>Truy váº¥n toÃ n vÄƒn ES chá»§ yáº¿u Ä‘Æ°á»£c sá»­ dá»¥ng trÃªn cÃ¡c trÆ°á»ng toÃ n vÄƒn, chá»§ yáº¿u xem xÃ©t má»©c Ä‘á»™ liÃªn quan (Relevance) giá»¯a tá»« khoÃ¡ truy váº¥n vÃ  tÃ i liá»‡u.</p>
<h3>intervals query</h3>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-intervals-query.html" target="_blank" rel="noopener noreferrer"><strong><code>intervals query</code></strong></a> tráº£ vá» tÃ i liá»‡u dá»±a trÃªn thá»© tá»± vÃ  Ä‘á»™ tÆ°Æ¡ng quan cá»§a tá»« khoÃ¡ khá»›p.</p>
<p>intervals query sá»­ dá»¥ng <strong>quy táº¯c khá»›p</strong>, cÃ¡c quy táº¯c nÃ y Ä‘Æ°á»£c Ã¡p dá»¥ng cho cÃ¡c term trong trÆ°á»ng Ä‘Ã£ chá»‰ Ä‘á»‹nh.</p>
<p>VÃ­ dá»¥: VÃ­ dá»¥ dÆ°á»›i Ä‘Ã¢y tÃ¬m kiáº¿m trÆ°á»ng <code>query</code>, giÃ¡ trá»‹ tÃ¬m kiáº¿m lÃ  <code>my favorite food</code>, khÃ´ng cÃ³ báº¥t ká»³ khoáº£ng tráº¯ng nÃ o; sau Ä‘Ã³ lÃ  trÆ°á»ng <code>my_text</code> tÃ¬m kiáº¿m term khá»›p <code>hot water</code>, <code>cold porridge</code>.</p>
<p>Khi giÃ¡ trá»‹ cá»§a my_text lÃ  <code>my favorite food is cold porridge</code>, nÃ³ sáº½ khá»›p thÃ nh cÃ´ng, nhÆ°ng <code>when it's cold my favorite food is porridge</code> thÃ¬ khÃ´ng khá»›p.</p>
<div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> _search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "intervals"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "my_text"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "all_of"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">          "ordered"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#D19A66;--shiki-dark:#D19A66"> true</span><span style="color:#98C379;--shiki-dark:#98C379">,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">          "intervals"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">            {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">              "match"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">                "query"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "my favorite food",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">                "max_gaps"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> 0,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">                "ordered"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#D19A66;--shiki-dark:#D19A66"> true</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">              }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">            },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">            {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">              "any_of"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">                "intervals"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">                  { </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"match"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "query"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "hot water"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span><span style="color:#98C379;--shiki-dark:#98C379"> },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">                  { </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"match"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "query"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "cold porridge"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">                ]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">              }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">            }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">          ]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>match query</h3>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-match-query.html" target="_blank" rel="noopener noreferrer"><strong><code>match query</code></strong></a> <strong>Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ¬m kiáº¿m má»™t trÆ°á»ng Ä‘Æ¡n</strong>, Ä‘áº§u tiÃªn sáº½ phÃ¢n tÃ­ch cÃ¢u truy váº¥n (qua analyzer), chá»§ yáº¿u lÃ  Ä‘á»ƒ tÃ¡ch cÃ¢u truy váº¥n thÃ nh cÃ¡c tá»«, sau khi tÃ¡ch tá»«, báº¥t ká»³ tá»« nÃ o trong cÃ¢u truy váº¥n khá»›p, tÃ i liá»‡u sáº½ Ä‘Æ°á»£c tÃ¬m tháº¥y, theo máº·c Ä‘á»‹nh, nÃ³ tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i viá»‡c thá»±c hiá»‡n hoáº¡t Ä‘á»™ng khá»›p or sau khi tÃ¡ch tá»«.</p>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-match-query.html" target="_blank" rel="noopener noreferrer"><strong><code>match query</code></strong></a> lÃ  truy váº¥n tiÃªu chuáº©n Ä‘á»ƒ thá»±c hiá»‡n tÃ¬m kiáº¿m toÃ n vÄƒn, bao gá»“m cÃ¡c tÃ¹y chá»n khá»›p má».</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> kibana_sample_data_ecommerce/_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "match"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "customer_full_name"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "George Hubbard"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><p>TÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i hoáº¡t Ä‘á»™ng khá»›p <code>or</code>, nhÆ° sau:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> kibana_sample_data_ecommerce/_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "match"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "customer_full_name"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "George Hubbard",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "operator"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "or"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h4>match query viáº¿t táº¯t</h4>
<p>Báº¡n cÃ³ thá»ƒ Ä‘Æ¡n giáº£n hÃ³a cÃº phÃ¡p truy váº¥n khá»›p báº±ng cÃ¡ch káº¿t há»£p tham sá»‘ <code>&lt;field&gt;</code> vÃ  <code>query</code>.</p>
<p>VÃ­ dá»¥:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "match"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "message"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "this is a test"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h4>match query hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o</h4>
<p>Truy váº¥n khá»›p lÃ  kiá»ƒu boolean. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  nÃ³ sáº½ phÃ¢n tÃ­ch vÄƒn báº£n Ä‘Æ°á»£c cung cáº¥p, quÃ¡ trÃ¬nh phÃ¢n tÃ­ch sáº½ xÃ¢y dá»±ng má»™t truy váº¥n boolean tá»« vÄƒn báº£n Ä‘Æ°á»£c cung cáº¥p. Tham sá»‘ <code>operator</code> cÃ³ thá»ƒ Ä‘Æ°á»£c Ä‘áº·t thÃ nh <code>or</code> hoáº·c <code>and</code> Ä‘á»ƒ kiá»ƒm soÃ¡t cÃ¡c má»‡nh Ä‘á» con boolean (máº·c Ä‘á»‹nh lÃ  <code>or</code>). Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng tham sá»‘ <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-minimum-should-match.html" target="_blank" rel="noopener noreferrer"><code>minimum_should_match</code></a> Ä‘á»ƒ Ä‘áº·t sá»‘ lÆ°á»£ng tá»‘i thiá»ƒu cÃ¡c má»‡nh Ä‘á» <code>should</code> tÃ¹y chá»n cáº§n pháº£i khá»›p.</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> kibana_sample_data_ecommerce/_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "match"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "customer_full_name"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "George Hubbard",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "operator"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "and"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><p>Báº¡n cÃ³ thá»ƒ Ä‘áº·t <code>analyzer</code> Ä‘á»ƒ kiá»ƒm soÃ¡t analyzer nÃ o sáº½ thá»±c hiá»‡n quÃ¡ trÃ¬nh phÃ¢n tÃ­ch vÄƒn báº£n. NÃ³ máº·c Ä‘á»‹nh lÃ  analyzer Ä‘Ã£ Ä‘Æ°á»£c Ä‘á»‹nh rÃµ trong Ä‘á»‹nh nghÄ©a mapping trÆ°á»ng hoáº·c analyzer tÃ¬m kiáº¿m máº·c Ä‘á»‹nh.</p>
<p>Tham sá»‘ <code>lenient</code> cÃ³ thá»ƒ Ä‘Æ°á»£c Ä‘áº·t thÃ nh <code>true</code> Ä‘á»ƒ bá» qua cÃ¡c ngoáº¡i lá»‡ do khÃ´ng khá»›p kiá»ƒu dá»¯ liá»‡u, cháº³ng háº¡n nhÆ° cá»‘ gáº¯ng truy váº¥n chuá»—i sá»‘ trÃªn trÆ°á»ng sá»‘. Máº·c Ä‘á»‹nh lÃ  <code>false</code>.</p>
<h4>match query khá»›p má»</h4>
<p><code>fuzziness</code> cho phÃ©p khá»›p má» dá»±a trÃªn loáº¡i trÆ°á»ng Ä‘ang Ä‘Æ°á»£c truy váº¥n. Xem cáº¥u hÃ¬nh <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/common-options.html#fuzziness" target="_blank" rel="noopener noreferrer">Fuzziness</a>.</p>
<p>Trong trÆ°á»ng há»£p nÃ y, báº¡n cÃ³ thá»ƒ Ä‘áº·t <code>prefix_length</code> vÃ  <code>max_expansions</code> Ä‘á»ƒ kiá»ƒm soÃ¡t khá»›p má». Náº¿u Ä‘Ã£ Ä‘áº·t cÃ¡c tÃ¹y chá»n má», truy váº¥n sáº½ sá»­ dá»¥ng <code>top_terms_blended_freqs_${max_expansions}</code> lÃ m phÆ°Æ¡ng phÃ¡p viáº¿t láº¡i cá»§a nÃ³, tham sá»‘ <code>fuzzy_rewrite</code> cho phÃ©p kiá»ƒm soÃ¡t cÃ¡ch truy váº¥n sáº½ Ä‘Æ°á»£c viáº¿t láº¡i.</p>
<p>Theo máº·c Ä‘á»‹nh, cho phÃ©p Ä‘áº£o ngÆ°á»£c má» (<code>ab</code> â†’ <code>ba</code>), nhÆ°ng cÃ³ thá»ƒ bá»‹ vÃ´ hiá»‡u hÃ³a báº±ng cÃ¡ch Ä‘áº·t <code>fuzzy_transpositions</code> thÃ nh <code>false</code>.</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "match"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "message"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "this is a testt",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "fuzziness"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "AUTO"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h4>zero terms query</h4>
<p>Náº¿u analyzer Ä‘Æ°á»£c sá»­ dá»¥ng loáº¡i bá» táº¥t cáº£ cÃ¡c token trong truy váº¥n, thÃ¬ hÃ nh vi máº·c Ä‘á»‹nh lÃ  khÃ´ng khá»›p vá»›i báº¥t ká»³ tÃ i liá»‡u nÃ o. Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng tÃ¹y chá»n <code>zero_terms_query</code> Ä‘á»ƒ thay Ä‘á»•i hÃ nh vi máº·c Ä‘á»‹nh, nÃ³ cháº¥p nháº­n <code>none</code> (máº·c Ä‘á»‹nh) vÃ  <code>all</code> (tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i truy váº¥n <code>match_all</code>).</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "match"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "message"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "to be or not to be",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "operator"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "and",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "zero_terms_query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "all"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h3>match_bool_prefix query</h3>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-match-bool-prefix-query.html" target="_blank" rel="noopener noreferrer"><strong><code>match_bool_prefix query</code></strong></a> phÃ¢n tÃ­ch Ä‘áº§u vÃ o cá»§a nÃ³ vÃ  xÃ¢y dá»±ng má»™t truy váº¥n boolean dá»±a trÃªn cÃ¡c tá»« nÃ y. Má»—i tá»«, ngoáº¡i trá»« tá»« cuá»‘i cÃ¹ng, Ä‘Æ°á»£c sá»­ dá»¥ng trong má»™t truy váº¥n tá»«. Tá»« cuá»‘i cÃ¹ng Ä‘Æ°á»£c sá»­ dá»¥ng trong má»™t <code>prefix query</code>.</p>
<p>VÃ­ dá»¥:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "match_bool_prefix"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "message"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "quick brown f"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><p>TÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "bool"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "should"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        { </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"term"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "message":</span><span style="color:#98C379;--shiki-dark:#98C379"> "quick"</span><span style="color:#98C379;--shiki-dark:#98C379"> }},</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        { </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"term"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "message":</span><span style="color:#98C379;--shiki-dark:#98C379"> "brown"</span><span style="color:#98C379;--shiki-dark:#98C379"> }},</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        { </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"prefix"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "message":</span><span style="color:#98C379;--shiki-dark:#98C379"> "f"}}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      ]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><p>Má»™t sá»± khÃ¡c biá»‡t quan trá»ng giá»¯a <code>match_bool_prefix query</code> vÃ  <code>match_phrase_prefix query</code> lÃ : <code>match_phrase_prefix query</code> sáº½ khá»›p cÃ¡c term cá»§a nÃ³ nhÆ° má»™t cá»¥m tá»«, nhÆ°ng <code>match_bool_prefix query</code> cÃ³ thá»ƒ khá»›p cÃ¡c term cá»§a nÃ³ á»Ÿ báº¥t ká»³ vá»‹ trÃ­ nÃ o.</p>
<p>VÃ­ dá»¥ truy váº¥n <code>match_bool_prefix query</code> á»Ÿ trÃªn cÃ³ thá»ƒ khá»›p vá»›i cÃ¡c trÆ°á»ng chá»©a <code>quick brown fox</code>, nhÆ°ng nÃ³ cÅ©ng cÃ³ thá»ƒ khá»›p nhanh vá»›i <code>brown fox</code>. NÃ³ cÅ©ng cÃ³ thá»ƒ khá»›p vá»›i cÃ¡c trÆ°á»ng chá»©a <code>quick</code>, <code>brown</code> vÃ  báº¯t Ä‘áº§u báº±ng <code>f</code>, xuáº¥t hiá»‡n á»Ÿ báº¥t ká»³ vá»‹ trÃ­ nÃ o.</p>
<h3>match_phrase query</h3>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-match-query-phrase.html" target="_blank" rel="noopener noreferrer"><strong><code>match_phrase query</code></strong></a> tá»©c lÃ  khá»›p cá»¥m tá»«, Ä‘áº§u tiÃªn nÃ³ sáº½ tÃ¡ch ná»™i dung query thÃ nh cÃ¡c tá»«, bá»™ tÃ¡ch tá»« cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¹y chá»‰nh, Ä‘á»“ng thá»i tÃ i liá»‡u cÅ©ng pháº£i Ä‘Ã¡p á»©ng hai Ä‘iá»u kiá»‡n sau Ä‘Ã¢y má»›i Ä‘Æ°á»£c tÃ¬m kiáº¿m:</p>
<ol>
<li><strong>Táº¥t cáº£ cÃ¡c tá»« sau khi tÃ¡ch pháº£i xuáº¥t hiá»‡n trong trÆ°á»ng nÃ y (tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i hoáº¡t Ä‘á»™ng and)</strong>.</li>
<li><strong>Thá»© tá»± cá»§a cÃ¡c tá»« trong trÆ°á»ng pháº£i phÃ¹ há»£p</strong>.</li>
</ol>
<p>VÃ­ dá»¥, cÃ³ 3 tÃ i liá»‡u sau, sá»­ dá»¥ng <strong><code>match_phrase</code></strong> Ä‘á»ƒ truy váº¥n "How are you", chá»‰ cÃ³ hai tÃ i liá»‡u Ä‘áº§u tiÃªn Ä‘Æ°á»£c khá»›p:</p>
<div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> demo/_create/1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"desc"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "How are you"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> demo/_create/2</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"desc"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "How are you, Jack?"}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> demo/_create/3</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"desc"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "are you"}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> demo/_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "match_phrase"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "desc"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "How are you"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote>
<p>Ghi chÃº:</p>
<p>Má»™t tÃ i liá»‡u Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh lÃ  khá»›p vá»›i cá»¥m tá»« "How are you" pháº£i Ä‘Ã¡p á»©ng cÃ¡c yÃªu cáº§u sau Ä‘Ã¢y:</p>
<ul>
<li>How, are vÃ  you cáº§n pháº£i xuáº¥t hiá»‡n trong trÆ°á»ng.</li>
<li>Vá»‹ trÃ­ cá»§a are pháº£i lá»›n hÆ¡n vá»‹ trÃ­ cá»§a How lÃ  1.</li>
<li>Vá»‹ trÃ­ cá»§a you pháº£i lá»›n hÆ¡n vá»‹ trÃ­ cá»§a How lÃ  2.</li>
</ul>
</blockquote>
<h3>match_phrase_prefix query</h3>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-match-query-phrase-prefix.html" target="_blank" rel="noopener noreferrer"><strong><code>match_phrase_prefix query</code></strong></a> tÆ°Æ¡ng tá»± nhÆ° <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-match-query-phrase.html" target="_blank" rel="noopener noreferrer"><strong><code>match_phrase query</code></strong></a>, chá»‰ khÃ¡c lÃ  <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-match-query-phrase-prefix.html" target="_blank" rel="noopener noreferrer"><strong><code>match_phrase_prefix query</code></strong></a> sáº½ xem term cuá»‘i cÃ¹ng nhÆ° má»™t prefix match.</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> demo/_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "match_phrase_prefix"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "desc"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "are yo"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><p>Trong vÃ­ dá»¥ nÃ y, Elasticsearch sáº½ tÃ¬m kiáº¿m cÃ¡c tÃ i liá»‡u cÃ³ trÆ°á»ng "desc" chá»©a cá»¥m tá»« báº¯t Ä‘áº§u báº±ng "are yo". Cá»¥m tá»« nÃ y cÃ³ thá»ƒ hoÃ n thÃ nh vá»›i báº¥t ká»³ tá»« nÃ o báº¯t Ä‘áº§u báº±ng "yo", cháº³ng háº¡n nhÆ° "you" hoáº·c "yoga". Äiá»u nÃ y cÃ³ thá»ƒ há»¯u Ã­ch khi báº¡n muá»‘n tÃ¬m kiáº¿m má»™t cá»¥m tá»« nhÆ°ng chá»‰ biáº¿t má»™t pháº§n cá»§a nÃ³.</p>
<h3>multi_match query</h3>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-multi-match-query.html" target="_blank" rel="noopener noreferrer"><strong><code>multi_match query</code></strong></a> lÃ  má»™t phiÃªn báº£n nÃ¢ng cáº¥p cá»§a <strong><code>match query</code></strong>, <strong>Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ¬m kiáº¿m trÃªn nhiá»u trÆ°á»ng</strong>.</p>
<p>VÃ­ dá»¥:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> kibana_sample_data_ecommerce/_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "multi_match"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> 34.98,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "fields"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "taxful_total_price"</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "taxless_total_price"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      ]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><p>TrÆ°á»ng tÃ¬m kiáº¿m cá»§a <strong><code>multi_match query</code></strong> cÃ³ thá»ƒ Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh báº±ng cÃ¡ch sá»­ dá»¥ng kÃ½ tá»± Ä‘áº¡i diá»‡n, vÃ­ dá»¥ nhÆ° sau:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> kibana_sample_data_ecommerce/_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "multi_match"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> 34.98,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "fields"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "taxful_*"</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "taxless_total_price"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      ]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><p>Äá»“ng thá»i, báº¡n cÅ©ng cÃ³ thá»ƒ <strong>chá»‰ Ä‘á»‹nh trá»ng sá»‘ cá»§a trÆ°á»ng tÃ¬m kiáº¿m báº±ng cÃ¡ch sá»­ dá»¥ng kÃ½ hiá»‡u mÅ©</strong>.</p>
<p>VÃ­ dá»¥: chá»‰ Ä‘á»‹nh trá»ng sá»‘ cá»§a trÆ°á»ng taxful_total_price lÃ  gáº¥p ba láº§n trÆ°á»ng taxless_total_price, lá»‡nh nhÆ° sau:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> kibana_sample_data_ecommerce/_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "multi_match"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> 34.98,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "fields"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "taxful_total_price^3"</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "taxless_total_price"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      ]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><p>Äiá»u nÃ y cÃ³ nghÄ©a lÃ  káº¿t quáº£ tÃ¬m kiáº¿m tá»« trÆ°á»ng "taxful_total_price" sáº½ cÃ³ trá»ng sá»‘ cao hÆ¡n ba láº§n so vá»›i káº¿t quáº£ tá»« trÆ°á»ng "taxless_total_price".</p>
<h3>combined_fields query</h3>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-combined-fields-query.html" target="_blank" rel="noopener noreferrer"><strong><code>combined_fields query</code></strong></a> há»— trá»£ tÃ¬m kiáº¿m nhiá»u trÆ°á»ng vÄƒn báº£n, giá»‘ng nhÆ° ná»™i dung cá»§a chÃºng Ä‘Ã£ Ä‘Æ°á»£c láº­p chá»‰ má»¥c vÃ o má»™t trÆ°á»ng káº¿t há»£p. Truy váº¥n nÃ y táº¡o ra má»™t gÃ³c nhÃ¬n dá»±a trÃªn term cá»§a chuá»—i Ä‘áº§u vÃ o: Ä‘áº§u tiÃªn nÃ³ phÃ¢n tÃ­ch chuá»—i truy váº¥n thÃ nh cÃ¡c term Ä‘á»™c láº­p, sau Ä‘Ã³ tÃ¬m kiáº¿m má»—i term trong táº¥t cáº£ cÃ¡c trÆ°á»ng. Khi káº¿t quáº£ phÃ¹ há»£p cÃ³ thá»ƒ tráº£i qua nhiá»u trÆ°á»ng vÄƒn báº£n, truy váº¥n nÃ y Ä‘áº·c biá»‡t há»¯u Ã­ch, vÃ­ dá»¥ nhÆ° tiÃªu Ä‘á», tÃ³m táº¯t vÃ  ná»™i dung cá»§a má»™t bÃ i viáº¿t:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "combined_fields"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379">      "database systems",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "fields"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">     [ </span><span style="color:#98C379;--shiki-dark:#98C379">"title",</span><span style="color:#98C379;--shiki-dark:#98C379"> "abstract",</span><span style="color:#98C379;--shiki-dark:#98C379"> "body"],</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "operator"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379">   "and"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h4>Trá»ng sá»‘ tiá»n tá»‘ trÆ°á»ng</h4>
<p>Trá»ng sá»‘ tiá»n tá»‘ trÆ°á»ng Ä‘Æ°á»£c tÃ­nh toÃ¡n dá»±a trÃªn mÃ´ hÃ¬nh trÆ°á»ng káº¿t há»£p. VÃ­ dá»¥, náº¿u trá»ng sá»‘ cá»§a trÆ°á»ng tiÃªu Ä‘á» lÃ  2, thÃ¬ khi tÃ­nh Ä‘iá»ƒm Ä‘á»™ phÃ¹ há»£p, má»—i term táº¡o ra tá»« trÆ°á»ng tiÃªu Ä‘á» sáº½ Ä‘Æ°á»£c tÃ­nh Ä‘iá»ƒm nhÆ° thá»ƒ nÃ³ xuáº¥t hiá»‡n hai láº§n.</p>
<h3>common_terms query</h3>
<blockquote>
<p>ÄÃ£ bá»‹ loáº¡i bá» tá»« phiÃªn báº£n 7.3.0</p>
</blockquote>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-common-terms-query.html" target="_blank" rel="noopener noreferrer"><strong><code>common_terms query</code></strong></a> lÃ  má»™t giáº£i phÃ¡p Ä‘á»ƒ cáº£i thiá»‡n Ä‘á»™ chÃ­nh xÃ¡c vÃ  Ä‘á»™ bao phá»§ cá»§a tÃ¬m kiáº¿m mÃ  khÃ´ng lÃ m giáº£m hiá»‡u suáº¥t, thay tháº¿ cho viá»‡c sá»­ dá»¥ng tá»« dá»«ng (stop words).</p>
<p>Má»—i tá»« trong truy váº¥n Ä‘á»u cÃ³ má»™t chi phÃ­ nháº¥t Ä‘á»‹nh. VÃ­ dá»¥, khi tÃ¬m kiáº¿m "The brown fox", truy váº¥n sáº½ Ä‘Æ°á»£c phÃ¢n tÃ­ch thÃ nh ba tá»«: "the", "brown", vÃ  "fox", má»—i tá»« sáº½ thá»±c hiá»‡n má»™t truy váº¥n trong chá»‰ má»¥c. RÃµ rÃ ng, sá»‘ lÆ°á»£ng tÃ i liá»‡u chá»©a "the" ráº¥t nhiá»u, so vá»›i cÃ¡c tá»« khÃ¡c, táº§m quan trá»ng cá»§a "the" tháº¥p hÆ¡n nhiá»u. CÃ¡ch giáº£i quyáº¿t truyá»n thá»‘ng lÃ  coi "the" lÃ  má»™t tá»« dá»«ng, loáº¡i bá» tá»« dá»«ng cÃ³ thá»ƒ giáº£m kÃ­ch thÆ°á»›c chá»‰ má»¥c vÃ  giáº£m viá»‡c thu háº¹p tá»« dá»«ng khi tÃ¬m kiáº¿m.</p>
<p>Tuy nhiÃªn, máº·c dÃ¹ tá»« dá»«ng khÃ´ng áº£nh hÆ°á»Ÿng nhiá»u Ä‘áº¿n viá»‡c Ä‘Ã¡nh giÃ¡ tÃ i liá»‡u, nhÆ°ng khi tá»« dá»«ng váº«n cÃ³ Ã½ nghÄ©a quan trá»ng, viá»‡c loáº¡i bá» tá»« dá»«ng khÃ´ng pháº£i lÃ  giáº£i phÃ¡p hoÃ n háº£o. Náº¿u loáº¡i bá» tá»« dá»«ng, báº¡n khÃ´ng thá»ƒ phÃ¢n biá»‡t "happy" vÃ  "not happy", "The" trong "To be or not to be" sáº½ khÃ´ng tá»“n táº¡i trong chá»‰ má»¥c, lÃ m giáº£m Ä‘á»™ chÃ­nh xÃ¡c vÃ  Ä‘á»™ bao phá»§ cá»§a tÃ¬m kiáº¿m.</p>
<p><code>common_terms query</code> cung cáº¥p má»™t giáº£i phÃ¡p, nÃ³ chia nhá»¯ng tá»« sau khi phÃ¢n tÃ¡ch truy váº¥n thÃ nh tá»« quan trá»ng (tá»« cÃ³ táº§n suáº¥t tháº¥p) vÃ  tá»« khÃ´ng quan trá»ng (tá»« cÃ³ táº§n suáº¥t cao, cÅ©ng chÃ­nh lÃ  tá»« dá»«ng trÆ°á»›c Ä‘Ã¢y). Khi tÃ¬m kiáº¿m, Ä‘áº§u tiÃªn tÃ¬m kiáº¿m tÃ i liá»‡u phÃ¹ há»£p vá»›i tá»« quan trá»ng, nhá»¯ng tÃ i liá»‡u nÃ y lÃ  nhá»¯ng tÃ i liá»‡u mÃ  tá»« xuáº¥t hiá»‡n Ã­t vÃ  áº£nh hÆ°á»Ÿng lá»›n Ä‘áº¿n viá»‡c Ä‘Ã¡nh giÃ¡. Sau Ä‘Ã³, thá»±c hiá»‡n truy váº¥n thá»© hai, tÃ¬m kiáº¿m tá»« cÃ³ táº§n suáº¥t cao áº£nh hÆ°á»Ÿng Ã­t Ä‘áº¿n viá»‡c Ä‘Ã¡nh giÃ¡, nhÆ°ng khÃ´ng tÃ­nh Ä‘iá»ƒm cho táº¥t cáº£ tÃ i liá»‡u, chá»‰ tÃ­nh Ä‘iá»ƒm cho tÃ i liá»‡u Ä‘Ã£ phÃ¹ há»£p trong truy váº¥n Ä‘áº§u tiÃªn. Náº¿u má»™t truy váº¥n chá»‰ chá»©a tá»« cÃ³ táº§n suáº¥t cao, thÃ¬ sáº½ thá»±c hiá»‡n má»™t truy váº¥n Ä‘á»™c láº­p thÃ´ng qua toÃ¡n tá»­ "and", nÃ³i cÃ¡ch khÃ¡c, sáº½ tÃ¬m kiáº¿m táº¥t cáº£ cÃ¡c tá»«.</p>
<p>Tá»« lÃ  tá»« cÃ³ táº§n suáº¥t cao hay táº§n suáº¥t tháº¥p Ä‘Æ°á»£c thiáº¿t láº­p thÃ´ng qua giÃ¡ trá»‹ ngÆ°á»¡ng cutoff frequency, cÃ³ thá»ƒ lÃ  táº§n suáº¥t tuyá»‡t Ä‘á»‘i (táº§n suáº¥t lá»›n hÆ¡n 1) hoáº·c táº§n suáº¥t tÆ°Æ¡ng Ä‘á»‘i (0 ~ 1). Äiá»ƒm thÃº vá»‹ nháº¥t cá»§a <code>common_terms query</code> lÃ  nÃ³ cÃ³ thá»ƒ tá»± Ä‘iá»u chá»‰nh tá»« dá»«ng cho lÄ©nh vá»±c cá»¥ thá»ƒ, vÃ­ dá»¥, trÃªn trang web lÆ°u trá»¯ video, cÃ¡c tá»« cÃ³ táº§n suáº¥t cao nhÆ° "clip" hoáº·c "video" sáº½ tá»± Ä‘á»™ng Ä‘Æ°á»£c coi lÃ  tá»« dá»«ng, khÃ´ng cáº§n duy trÃ¬ danh sÃ¡ch thá»§ cÃ´ng.</p>
<p>VÃ­ dá»¥, tá»« cÃ³ táº§n suáº¥t xuáº¥t hiá»‡n trong tÃ i liá»‡u lá»›n hÆ¡n 0.1% sáº½ Ä‘Æ°á»£c coi lÃ  tá»« cÃ³ táº§n suáº¥t cao, tá»« cÃ³ táº§n suáº¥t cÃ³ thá»ƒ Ä‘Æ°á»£c káº¿t ná»‘i báº±ng cÃ¡c tham sá»‘ low_freq_operator vÃ  high_freq_operator. Thiáº¿t láº­p toÃ¡n tá»­ tá»« cÃ³ táº§n suáº¥t tháº¥p lÃ  "and" Ä‘á»ƒ táº¥t cáº£ cÃ¡c tá»« cÃ³ táº§n suáº¥t tháº¥p Ä‘á»u pháº£i tÃ¬m kiáº¿m, vÃ­ dá»¥ mÃ£ nhÆ° sau:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> books/_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">	"query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">		"common"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">			"body"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">				"query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "nelly the elephant as a cartoon",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">				"cutoff_frequency"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> 0.001,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">				"low_freq_operator"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "and"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">			}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">		}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">	}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><p>Hoáº¡t Ä‘á»™ng trÃªn tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i:</p>
<div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> books/_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">	"query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">		"bool"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">			"must"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">			  { </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"term"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "body":</span><span style="color:#98C379;--shiki-dark:#98C379"> "nelly"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span><span style="color:#98C379;--shiki-dark:#98C379"> },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">			  { </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"term"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "body":</span><span style="color:#98C379;--shiki-dark:#98C379"> "elephant"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span><span style="color:#98C379;--shiki-dark:#98C379"> },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">			  { </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"term"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "body":</span><span style="color:#98C379;--shiki-dark:#98C379"> "cartoon"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">			],</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">			"should"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">			  { </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"term"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "body":</span><span style="color:#98C379;--shiki-dark:#98C379"> "the"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span><span style="color:#98C379;--shiki-dark:#98C379"> },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">			  { </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"term"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "body":</span><span style="color:#98C379;--shiki-dark:#98C379"> "as"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span><span style="color:#98C379;--shiki-dark:#98C379"> },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">			  { </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"term"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "body":</span><span style="color:#98C379;--shiki-dark:#98C379"> "a"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">			]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">		}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">	}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>query_string query</h3>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-query-string-query.html" target="_blank" rel="noopener noreferrer"><strong><code>query_string query</code></strong></a> lÃ  má»™t loáº¡i truy váº¥n gáº¯n káº¿t cháº·t cháº½ vá»›i cÃº phÃ¡p truy váº¥n cá»§a Lucene, cho phÃ©p sá»­ dá»¥ng nhiá»u tá»« khÃ³a Ä‘iá»u kiá»‡n Ä‘áº·c biá»‡t (nhÆ°: AND | OR | NOT) trong má»™t cÃ¢u truy váº¥n Ä‘á»ƒ tÃ¬m kiáº¿m trÃªn nhiá»u trÆ°á»ng, khuyáº¿n nghá»‹ cho ngÆ°á»i dÃ¹ng Ä‘Ã£ quen vá»›i cÃº phÃ¡p truy váº¥n cá»§a Lucene.</p>
<p>NgÆ°á»i dÃ¹ng cÃ³ thá»ƒ sá»­ dá»¥ng <code>query_string query</code> Ä‘á»ƒ táº¡o cÃ¡c truy váº¥n phá»©c táº¡p bao gá»“m kÃ½ tá»± Ä‘áº¡i diá»‡n, tÃ¬m kiáº¿m trÃªn nhiá»u trÆ°á»ng, v.v. Máº·c dÃ¹ lÃ  phá»• biáº¿n, nhÆ°ng truy váº¥n lÃ  nghiÃªm ngáº·t, náº¿u chuá»—i truy váº¥n chá»©a báº¥t ká»³ cÃº phÃ¡p khÃ´ng há»£p lá»‡ nÃ o, sáº½ tráº£ vá» lá»—i.</p>
<p>VÃ­ dá»¥:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "query_string"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "(new york city) OR (big apple)",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "default_field"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "content"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h3>simple_query_string query</h3>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-simple-query-string-query.html" target="_blank" rel="noopener noreferrer"><strong><code>simple_query_string query</code></strong></a> lÃ  má»™t loáº¡i truy váº¥n phÃ¹ há»£p Ä‘á»ƒ trá»±c tiáº¿p tiáº¿p xÃºc vá»›i ngÆ°á»i dÃ¹ng vÃ  cÃ³ cÃº phÃ¡p truy váº¥n ráº¥t hoÃ n chá»‰nh, cháº¥p nháº­n cÃº phÃ¡p truy váº¥n cá»§a Lucene, khÃ´ng nÃ©m ra ngoáº¡i lá»‡ náº¿u cÃ³ lá»—i trong quÃ¡ trÃ¬nh phÃ¢n tÃ­ch cÃº phÃ¡p.</p>
<p>Máº·c dÃ¹ cÃº phÃ¡p nghiÃªm ngáº·t hÆ¡n <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-query-string-query.html" target="_blank" rel="noopener noreferrer"><strong><code>query_string query</code></strong></a>, nhÆ°ng <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-simple-query-string-query.html" target="_blank" rel="noopener noreferrer"><strong><code>simple_query_string query</code></strong></a> khÃ´ng tráº£ vá» lá»—i cÃº phÃ¡p khÃ´ng há»£p lá»‡. NgÆ°á»£c láº¡i, nÃ³ sáº½ bá» qua báº¥t ká»³ pháº§n khÃ´ng há»£p lá»‡ nÃ o cá»§a chuá»—i truy váº¥n.</p>
<p>VÃ­ dá»¥:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "simple_query_string"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">\"</span><span style="color:#98C379;--shiki-dark:#98C379">fried eggs</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">\"</span><span style="color:#98C379;--shiki-dark:#98C379"> +(eggplant | potato) -frittata",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "fields"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span><span style="color:#98C379;--shiki-dark:#98C379">"title^5"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">"body"],</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "default_operator"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "and"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h4>Ã nghÄ©a cá»§a simple_query_string</h4>
<ul>
<li><code>+</code>: tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i toÃ¡n tá»­ AND</li>
<li><code>|</code>: tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i toÃ¡n tá»­ OR</li>
<li><code>-</code>: tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i toÃ¡n tá»­ NOT</li>
<li><code>"</code>: bao quanh má»™t sá»‘ token Ä‘á»ƒ chá»‰ ra cá»¥m tá»« dÃ¹ng Ä‘á»ƒ tÃ¬m kiáº¿m</li>
<li><code>*</code>: sau má»™t tá»« Ä‘á»ƒ chá»‰ ra truy váº¥n tiá»n tá»‘</li>
<li><code>(</code> vÃ  <code>)</code>: chá»‰ ra má»©c Ä‘á»™ Æ°u tiÃªn</li>
<li><code>~N</code>: sau má»™t tá»« Ä‘á»ƒ chá»‰ ra khoáº£ng cÃ¡ch chá»‰nh sá»­a (má»)</li>
<li><code>~N</code>: sau má»™t cá»¥m tá»« Ä‘á»ƒ chá»‰ ra lÆ°á»£ng trÃ n</li>
</ul>
<p>LÆ°u Ã½: Äá»ƒ sá»­ dá»¥ng cÃ¡c kÃ½ tá»± trÃªn, hÃ£y sá»­ dá»¥ng dáº¥u gáº¡ch chÃ©o ngÆ°á»£c <code>/</code> Ä‘á»ƒ thoÃ¡t.</p>
<h3>VÃ­ dá»¥ hoÃ n chá»‰nh vá» truy váº¥n toÃ n vÄƒn</h3>
<div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">#Äáº·t position_increment_gap</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">DELETE</span><span style="color:#98C379;--shiki-dark:#98C379"> groups</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> groups</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "mappings"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "properties"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "names"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "type"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "text",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "position_increment_gap"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 0</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> groups/_mapping</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> groups/_doc</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "names"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [ </span><span style="color:#98C379;--shiki-dark:#98C379">"John Water",</span><span style="color:#98C379;--shiki-dark:#98C379"> "Water Smith"]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> groups/_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "match_phrase"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "names"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "Water Water",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "slop"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 100</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> groups/_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "match_phrase"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "names"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "Water Smith"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">DELETE</span><span style="color:#98C379;--shiki-dark:#98C379"> groups</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Trong vÃ­ dá»¥ nÃ y, chÃºng tÃ´i thiáº¿t láº­p <code>position_increment_gap</code> cho trÆ°á»ng "names" trong chá»‰ má»¥c "groups". <code>position_increment_gap</code> Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ kiá»ƒm soÃ¡t cÃ¡ch Elasticsearch xá»­ lÃ½ cÃ¡c máº£ng cá»§a chuá»—i vÄƒn báº£n khi thá»±c hiá»‡n truy váº¥n cá»¥m tá»«. Trong trÆ°á»ng há»£p nÃ y, nÃ³ Ä‘Æ°á»£c cÃ i Ä‘áº·t lÃ  0, cÃ³ nghÄ©a lÃ  khÃ´ng cÃ³ khoáº£ng cÃ¡ch giá»¯a cÃ¡c pháº§n tá»­ trong máº£ng.</p>
<p>Sau Ä‘Ã³, chÃºng tÃ´i thÃªm má»™t tÃ i liá»‡u vÃ o chá»‰ má»¥c, vá»›i trÆ°á»ng "names" bao gá»“m hai chuá»—i: "John Water" vÃ  "Water Smith".</p>
<p>Tiáº¿p theo, chÃºng tÃ´i thá»±c hiá»‡n hai truy váº¥n <code>match_phrase</code> khÃ¡c nhau. Truy váº¥n Ä‘áº§u tiÃªn tÃ¬m kiáº¿m cá»¥m tá»« "Water Water" vá»›i má»™t "slop" (cho phÃ©p sá»± khÃ´ng khá»›p) lÃ  100. Truy váº¥n thá»© hai tÃ¬m kiáº¿m cá»¥m tá»« "Water Smith".</p>
<p>Cuá»‘i cÃ¹ng, chÃºng tÃ´i xÃ³a chá»‰ má»¥c "groups".</p>
<h2>Truy váº¥n tá»« khÃ³a</h2>
<p><strong><code>Term</code> (tá»« khÃ³a) lÃ  Ä‘Æ¡n vá»‹ nhá» nháº¥t Ä‘á»ƒ diá»…n Ä‘áº¡t Ã½ nghÄ©a</strong>. Cáº£ viá»‡c tÃ¬m kiáº¿m vÃ  xá»­ lÃ½ ngÃ´n ngá»¯ tá»± nhiÃªn báº±ng mÃ´ hÃ¬nh ngÃ´n ngá»¯ thá»‘ng kÃª Ä‘á»u cáº§n xá»­ lÃ½ Term.</p>
<p>Truy váº¥n toÃ n vÄƒn sáº½ phÃ¢n tÃ­ch chuá»—i truy váº¥n trÆ°á»›c khi thá»±c hiá»‡n truy váº¥n.</p>
<p>KhÃ¡c vá»›i truy váº¥n toÃ n vÄƒn, truy váº¥n tá»« khÃ³a khÃ´ng phÃ¢n tÃ¡ch tá»«, mÃ  coi Ä‘áº§u vÃ o lÃ  má»™t thá»ƒ thá»‘ng nháº¥t, tÃ¬m kiáº¿m cÃ¡c tá»« khÃ³a chÃ­nh xÃ¡c trong chá»‰ má»¥c Ä‘áº£o ngÆ°á»£c vÃ  sá»­ dá»¥ng cÃ´ng thá»©c tÃ­nh toÃ¡n Ä‘á»™ liÃªn quan cho má»—i tÃ i liá»‡u chá»©a tá»« khÃ³a Ä‘Ã³. NÃ³i cÃ¡ch khÃ¡c: <strong>truy váº¥n tá»« khÃ³a lÃ  viá»‡c khá»›p chÃ­nh xÃ¡c tá»« khÃ³a</strong>. Truy váº¥n tá»« khÃ³a thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng cho dá»¯ liá»‡u cÃ³ cáº¥u trÃºc, nhÆ° sá»‘, ngÃ y vÃ  kiá»ƒu liá»‡t kÃª.</p>
<p>CÃ¡c loáº¡i truy váº¥n tá»« khÃ³a bao gá»“m:</p>
<ul>
<li><strong><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-exists-query.html" target="_blank" rel="noopener noreferrer"><code>exists</code> query</a></strong></li>
<li><strong><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-fuzzy-query.html" target="_blank" rel="noopener noreferrer"><code>fuzzy</code> query</a></strong></li>
<li><strong><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-ids-query.html" target="_blank" rel="noopener noreferrer"><code>ids</code> query</a></strong></li>
<li><strong><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-prefix-query.html" target="_blank" rel="noopener noreferrer"><code>prefix</code> query</a></strong></li>
<li><strong><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-range-query.html" target="_blank" rel="noopener noreferrer"><code>range</code> query</a></strong></li>
<li><strong><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-regexp-query.html" target="_blank" rel="noopener noreferrer"><code>regexp</code> query</a></strong></li>
<li><strong><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-term-query.html" target="_blank" rel="noopener noreferrer"><code>term</code> query</a></strong></li>
<li><strong><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-terms-query.html" target="_blank" rel="noopener noreferrer"><code>terms</code> query</a></strong></li>
<li><strong><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-type-query.html" target="_blank" rel="noopener noreferrer"><code>type</code> query</a></strong></li>
<li><strong><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-wildcard-query.html" target="_blank" rel="noopener noreferrer"><code>wildcard</code> query</a></strong></li>
</ul>
<h3>exists query</h3>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-exists-query.html" target="_blank" rel="noopener noreferrer"><strong><code>exists query</code></strong></a> sáº½ tráº£ vá» cÃ¡c tÃ i liá»‡u cÃ³ Ã­t nháº¥t má»™t giÃ¡ trá»‹ khÃ´ng trá»‘ng trong trÆ°á»ng.</p>
<p>VÃ¬ nhiá»u lÃ½ do, trÆ°á»ng cá»§a tÃ i liá»‡u cÃ³ thá»ƒ khÃ´ng tá»“n táº¡i giÃ¡ trá»‹ chá»‰ má»¥c:</p>
<ul>
<li>TrÆ°á»ng trong JSON lÃ  <code>null</code> hoáº·c <code>[]</code></li>
<li>TrÆ°á»ng nÃ y Ä‘Æ°á»£c cáº¥u hÃ¬nh <code>"index" : false</code> trong mapping</li>
<li>Äá»™ dÃ i giÃ¡ trá»‹ trÆ°á»ng vÆ°á»£t quÃ¡ cÃ i Ä‘áº·t <code>ignore_above</code> trong mapping</li>
<li>Äá»‹nh dáº¡ng giÃ¡ trá»‹ trÆ°á»ng khÃ´ng Ä‘Ãºng vÃ  <code>ignore_malformed</code> Ä‘Ã£ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong mapping</li>
</ul>
<p>VÃ­ dá»¥:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> kibana_sample_data_ecommerce/_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "exists"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "field"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "email"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><p>CÃ¡c tÃ i liá»‡u sau sáº½ khá»›p vá»›i truy váº¥n trÃªn:</p>
<ul>
<li><code>{ "user" : "jane" }</code> cÃ³ trÆ°á»ng user vÃ  khÃ´ng trá»‘ng.</li>
<li><code>{ "user" : "" }</code> cÃ³ trÆ°á»ng user, giÃ¡ trá»‹ lÃ  chuá»—i trá»‘ng.</li>
<li><code>{ "user" : "-" }</code> cÃ³ trÆ°á»ng user, giÃ¡ trá»‹ khÃ´ng trá»‘ng.</li>
<li><code>{ "user" : [ "jane" ] }</code> cÃ³ trÆ°á»ng user, giÃ¡ trá»‹ khÃ´ng trá»‘ng.</li>
<li><code>{ "user" : [ "jane", null ] }</code> cÃ³ trÆ°á»ng user, chá»‰ cáº§n cÃ³ Ã­t nháº¥t má»™t giÃ¡ trá»‹ khÃ´ng trá»‘ng.</li>
</ul>
<p>CÃ¡c tÃ i liá»‡u sau sáº½ khÃ´ng khá»›p:</p>
<ul>
<li><code>{ "user" : null }</code> cÃ³ trÆ°á»ng user nhÆ°ng giÃ¡ trá»‹ trá»‘ng.</li>
<li><code>{ "user" : [] }</code> cÃ³ trÆ°á»ng user nhÆ°ng giÃ¡ trá»‹ trá»‘ng.</li>
<li><code>{ "user" : [null] }</code> cÃ³ trÆ°á»ng user nhÆ°ng giÃ¡ trá»‹ trá»‘ng.</li>
<li><code>{ "foo" : "bar" }</code> khÃ´ng cÃ³ trÆ°á»ng user.</li>
</ul>
<h3>fuzzy query</h3>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-fuzzy-query.html" target="_blank" rel="noopener noreferrer"><strong><code>fuzzy query</code></strong> (truy váº¥n má»)</a> tráº£ vá» cÃ¡c tÃ i liá»‡u chá»©a cÃ¡c tá»« tÆ°Æ¡ng tá»± vá»›i tá»« tÃ¬m kiáº¿m. ES sá»­ dá»¥ng <a href="https://en.wikipedia.org/wiki/Levenshtein_distance" target="_blank" rel="noopener noreferrer">Khoáº£ng cÃ¡ch chá»‰nh sá»­a Levenshtein</a> Ä‘á»ƒ Ä‘o Ä‘á»™ tÆ°Æ¡ng tá»± hoáº·c má».</p>
<p>Khoáº£ng cÃ¡ch chá»‰nh sá»­a lÃ  sá»‘ lÆ°á»£ng thay Ä‘á»•i kÃ½ tá»± Ä‘Æ¡n láº» cáº§n thiáº¿t Ä‘á»ƒ chuyá»ƒn Ä‘á»•i má»™t thuáº­t ngá»¯ thÃ nh thuáº­t ngá»¯ khÃ¡c. Nhá»¯ng thay Ä‘á»•i nÃ y cÃ³ thá»ƒ bao gá»“m:</p>
<ul>
<li>Thay Ä‘á»•i má»™t kÃ½ tá»±: (<strong>b</strong>ox -&gt; <strong>f</strong>ox)</li>
<li>XÃ³a má»™t kÃ½ tá»±: (<strong>b</strong>lack -&gt; lack)</li>
<li>ThÃªm má»™t kÃ½ tá»±: (sic -&gt; sic<strong>k</strong>)</li>
<li>Äáº£o ngÆ°á»£c hai kÃ½ tá»± liá»n ká»: (<strong>ac</strong>t â†’ <strong>ca</strong>t)</li>
</ul>
<p>Äá»ƒ tÃ¬m cÃ¡c tá»« khÃ³a tÆ°Æ¡ng tá»±, truy váº¥n má» sáº½ táº¡o ra táº¥t cáº£ cÃ¡c biáº¿n thá»ƒ hoáº·c táº­p má»Ÿ rá»™ng cÃ³ thá»ƒ cá»§a tá»« khÃ³a tÃ¬m kiáº¿m trong khoáº£ng cÃ¡ch chá»‰nh sá»­a Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh. Sau Ä‘Ã³, nÃ³ tráº£ vá» cÃ¡c tÃ i liá»‡u khá»›p hoÃ n toÃ n vá»›i báº¥t ká»³ táº­p má»Ÿ rá»™ng nÃ o.</p>
<div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> books/_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "fuzzy"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "user.id"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "value"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "ki",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "fuzziness"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "AUTO",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "max_expansions"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> 50,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "prefix_length"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> 0,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "transpositions"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#D19A66;--shiki-dark:#D19A66"> true</span><span style="color:#98C379;--shiki-dark:#98C379">,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "rewrite"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "constant_score"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>LÆ°u Ã½: Náº¿u <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl.html#query-dsl-allow-expensive-queries" target="_blank" rel="noopener noreferrer"><code>search.allow_expensive_queries</code></a> Ä‘Ã£ Ä‘Æ°á»£c cáº¥u hÃ¬nh, thÃ¬ truy váº¥n má» khÃ´ng thá»ƒ Ä‘Æ°á»£c thá»±c thi.</p>
<h3>ids query</h3>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-ids-query.html" target="_blank" rel="noopener noreferrer"><strong><code>ids query</code></strong></a> tráº£ vá» cÃ¡c tÃ i liá»‡u dá»±a trÃªn ID. Truy váº¥n nÃ y sá»­ dá»¥ng ID tÃ i liá»‡u Ä‘Æ°á»£c lÆ°u trá»¯ trong trÆ°á»ng <code>_id</code>.</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "ids"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "values"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span><span style="color:#98C379;--shiki-dark:#98C379">"1"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">"4",</span><span style="color:#98C379;--shiki-dark:#98C379"> "100"]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h3>prefix query</h3>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-prefix-query.html#prefix-query-ex-request" target="_blank" rel="noopener noreferrer"><strong><code>prefix query</code></strong></a> Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ truy váº¥n cÃ¡c tÃ i liá»‡u cÃ³ chá»©a tiá»n tá»‘ chá»‰ Ä‘á»‹nh trong má»™t trÆ°á»ng nÃ o Ä‘Ã³.</p>
<p>VÃ­ dá»¥, Ä‘á»ƒ truy váº¥n cÃ¡c tÃ i liá»‡u cÃ³ <code>user.id</code> chá»©a cÃ¡c tá»« khÃ³a báº¯t Ä‘áº§u báº±ng <code>ki</code>, táº¥t cáº£ cÃ¡c tÃ i liá»‡u chá»©a cÃ¡c tá»« khÃ³a nhÆ° <code>kind</code>, <code>kid</code> vÃ  báº¥t ká»³ tá»« khÃ³a nÃ o khÃ¡c báº¯t Ä‘áº§u báº±ng <code>ki</code> sáº½ Ä‘Æ°á»£c khá»›p.</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "prefix"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "user.id"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "value"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "ki"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h3>range query</h3>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-range-query.html" target="_blank" rel="noopener noreferrer"><strong><code>range query</code></strong></a> hay truy váº¥n pháº¡m vi, Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ khá»›p cÃ¡c tÃ i liá»‡u cÃ³ trÆ°á»ng sá»‘, ngÃ y hoáº·c chuá»—i trong má»™t pháº¡m vi nháº¥t Ä‘á»‹nh. VÃ­ dá»¥, tÃ¬m kiáº¿m nhá»¯ng quyá»ƒn sÃ¡ch cÃ³ giÃ¡ tá»« 50 Ä‘áº¿n 100, hoáº·c nhá»¯ng quyá»ƒn sÃ¡ch Ä‘Æ°á»£c xuáº¥t báº£n tá»« nÄƒm 2015 Ä‘áº¿n nÄƒm 2019. <strong>Truy váº¥n pháº¡m vi chá»‰ cÃ³ thá»ƒ truy váº¥n má»™t trÆ°á»ng, khÃ´ng thá»ƒ Ã¡p dá»¥ng trÃªn nhiá»u trÆ°á»ng</strong>.</p>
<p>Truy váº¥n pháº¡m vi há»— trá»£ cÃ¡c tham sá»‘ sau:</p>
<ul>
<li><strong><code>gt</code></strong>: lá»›n hÆ¡n</li>
<li><strong><code>gte</code></strong>: lá»›n hÆ¡n hoáº·c báº±ng</li>
<li><strong><code>lt</code></strong>: nhá» hÆ¡n</li>
<li><strong><code>lte</code></strong>: nhá» hÆ¡n hoáº·c báº±ng</li>
<li><strong><code>format</code></strong>: náº¿u trÆ°á»ng lÃ  loáº¡i Date, báº¡n cÃ³ thá»ƒ Ä‘áº·t Ä‘á»‹nh dáº¡ng ngÃ y</li>
<li><strong><code>time_zone</code></strong>: mÃºi giá»</li>
<li><strong><code>relation</code></strong>: chá»‰ ra cÃ¡ch truy váº¥n pháº¡m vi khá»›p vá»›i cÃ¡c giÃ¡ trá»‹ trÆ°á»ng pháº¡m vi.
<ul>
<li><strong><code>INTERSECTS</code> (Máº·c Ä‘á»‹nh)</strong>: Khá»›p vá»›i cÃ¡c tÃ i liá»‡u cÃ³ giÃ¡ trá»‹ trÆ°á»ng pháº¡m vi giao nhau vá»›i truy váº¥n.</li>
<li><strong><code>CONTAINS</code></strong>: Khá»›p vá»›i cÃ¡c tÃ i liá»‡u hoÃ n toÃ n chá»©a giÃ¡ trá»‹ trÆ°á»ng cá»§a truy váº¥n.</li>
<li><strong><code>WITHIN</code></strong>: Khá»›p vá»›i cÃ¡c tÃ i liá»‡u cÃ³ giÃ¡ trá»‹ trÆ°á»ng pháº¡m vi hoÃ n toÃ n trong pháº¡m vi truy váº¥n.</li>
</ul>
</li>
</ul>
<p>VÃ­ dá»¥: Truy váº¥n pháº¡m vi sá»‘</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> kibana_sample_data_ecommerce/_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "range"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "taxful_total_price"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "gt"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> 10,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "lte"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 50</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><p>VÃ­ dá»¥: Truy váº¥n pháº¡m vi ngÃ y</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> kibana_sample_data_ecommerce/_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "range"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "order_date"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "time_zone"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "+00:00",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "gte"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "2018-01-01T00:00:00",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "lte"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "now"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h3>regexp query</h3>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-regexp-query.html" target="_blank" rel="noopener noreferrer"><strong><code>regexp query</code></strong></a> tráº£ vá» cÃ¡c tÃ i liá»‡u thuá»™c vá» cÃ¡c term khá»›p vá»›i biá»ƒu thá»©c chÃ­nh quy.</p>
<p><a href="https://vi.wikipedia.org/wiki/Bi%E1%BB%83u_th%E1%BB%A9c_ch%C3%ADnh_quy" target="_blank" rel="noopener noreferrer">Biá»ƒu thá»©c chÃ­nh quy</a> lÃ  má»™t phÆ°Æ¡ng phÃ¡p sá»­ dá»¥ng cÃ¡c kÃ½ tá»± Ä‘áº¡i diá»‡n Ä‘á»ƒ khá»›p vá»›i cÃ¡c mÃ´ hÃ¬nh dá»¯ liá»‡u, Ä‘Æ°á»£c gá»i lÃ  toÃ¡n tá»­.</p>
<p>VÃ­ dá»¥: TÃ¬m kiáº¿m dÆ°á»›i Ä‘Ã¢y tráº£ vá» cÃ¡c tÃ i liá»‡u cÃ³ trÆ°á»ng <code>user.id</code> chá»©a báº¥t ká»³ tá»« nÃ o báº¯t Ä‘áº§u báº±ng <code>k</code> vÃ  káº¿t thÃºc báº±ng <code>y</code>. ToÃ¡n tá»­ <code>.*</code> khá»›p vá»›i báº¥t ká»³ kÃ½ tá»± nÃ o vá»›i báº¥t ká»³ Ä‘á»™ dÃ i nÃ o, bao gá»“m cáº£ khÃ´ng cÃ³ kÃ½ tá»±. CÃ¡c tá»« khá»›p cÃ³ thá»ƒ bao gá»“m <code>ky</code>, <code>kay</code> vÃ  <code>kimchy</code>.</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "regexp"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "user.id"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "value"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "k.*y",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "flags"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "ALL",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "case_insensitive"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#D19A66;--shiki-dark:#D19A66"> true</span><span style="color:#98C379;--shiki-dark:#98C379">,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "max_determinized_states"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> 10000,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "rewrite"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "constant_score"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><blockquote>
<p>LÆ°u Ã½: Náº¿u <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl.html#query-dsl-allow-expensive-queries" target="_blank" rel="noopener noreferrer"><code>search.allow_expensive_queries</code></a> Ä‘Æ°á»£c cáº¥u hÃ¬nh, thÃ¬ <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-regexp-query.html" target="_blank" rel="noopener noreferrer"><strong><code>regexp query</code></strong></a> sáº½ bá»‹ vÃ´ hiá»‡u hÃ³a.</p>
</blockquote>
<h3>term query</h3>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-term-query.html" target="_blank" rel="noopener noreferrer"><strong><code>term query</code></strong></a> Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ¬m cÃ¡c tÃ i liá»‡u cÃ³ chá»©a tá»« cá»¥ thá»ƒ trong má»™t trÆ°á»ng cá»¥ thá»ƒ. Truy váº¥n term khÃ´ng Ä‘Æ°á»£c phÃ¢n tÃ­ch, chá»‰ khi tá»« truy váº¥n vÃ  tá»« trong tÃ i liá»‡u khá»›p chÃ­nh xÃ¡c thÃ¬ má»›i Ä‘Æ°á»£c tÃ¬m kiáº¿m. CÃ¡c tÃ¬nh huá»‘ng Ã¡p dá»¥ng bao gá»“m tÃ¬m kiáº¿m tÃªn ngÆ°á»i, tÃªn Ä‘á»‹a Ä‘iá»ƒm vÃ  cÃ¡c yÃªu cáº§u khá»›p chÃ­nh xÃ¡c khÃ¡c.</p>
<p>VÃ­ dá»¥:</p>
<div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># 1. Táº¡o má»™t chá»‰ má»¥c</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">DELETE</span><span style="color:#98C379;--shiki-dark:#98C379"> my-index-000001</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> my-index-000001</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "mappings"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "properties"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "full_text"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "type":</span><span style="color:#98C379;--shiki-dark:#98C379"> "text"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># 2. Sá»­ dá»¥ng tá»« khÃ³a "Quick Brown Foxes!" Ä‘á»ƒ tÃ¬m kiáº¿m trÆ°á»ng "full_text"</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> my-index-000001/_doc/1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "full_text"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "Quick Brown Foxes!"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># 3. Sá»­ dá»¥ng term query</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> my-index-000001/_search?pretty</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "term"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "full_text"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "Quick Brown Foxes!"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># VÃ¬ trÆ°á»ng full_text khÃ´ng cÃ²n chá»©a Term chÃ­nh xÃ¡c - "Quick Brown Foxes!", nÃªn term query khÃ´ng tÃ¬m tháº¥y káº¿t quáº£ nÃ o</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># 4. Sá»­ dá»¥ng match query</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> my-index-000001/_search?pretty</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "match"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "full_text"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "Quick Brown Foxes!"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">DELETE</span><span style="color:#98C379;--shiki-dark:#98C379"> my-index-000001</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote>
<p>âš ï¸ LÆ°u Ã½: NÃªn trÃ¡nh sá»­ dá»¥ng term query Ä‘á»ƒ truy váº¥n cÃ¡c trÆ°á»ng text.</p>
<p>Theo máº·c Ä‘á»‹nh, Elasticsearch phÃ¢n tÃ­ch cÃ¡c giÃ¡ trá»‹ cá»§a trÆ°á»ng text, Ä‘iá»u nÃ y khiáº¿n viá»‡c tÃ¬m kiáº¿m khá»›p chÃ­nh xÃ¡c vá»›i giÃ¡ trá»‹ cá»§a trÆ°á»ng text trá»Ÿ nÃªn khÃ³ khÄƒn.</p>
<p>Äá»ƒ tÃ¬m kiáº¿m giÃ¡ trá»‹ cá»§a trÆ°á»ng text, báº¡n nÃªn sá»­ dá»¥ng match query.</p>
</blockquote>
<h3>terms query</h3>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-terms-query.html" target="_blank" rel="noopener noreferrer"><strong><code>terms query</code></strong></a> giá»‘ng vá»›i <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-term-query.html" target="_blank" rel="noopener noreferrer"><strong><code>term query</code></strong></a>, nhÆ°ng cÃ³ thá»ƒ tÃ¬m kiáº¿m nhiá»u giÃ¡ trá»‹.</p>
<p>CÃ¡c tham sá»‘ truy váº¥n terms query:</p>
<ul>
<li><strong><code>index</code></strong>: TÃªn chá»‰ má»¥c</li>
<li><strong><code>id</code></strong>: ID tÃ i liá»‡u</li>
<li><strong><code>path</code></strong>: TÃªn cá»§a trÆ°á»ng mÃ  tá»« Ä‘Ã³ láº¥y giÃ¡ trá»‹ trÆ°á»ng, tá»©c tá»« khÃ³a tÃ¬m kiáº¿m</li>
<li><strong><code>routing</code></strong> (tÃ¹y chá»n): GiÃ¡ trá»‹ Ä‘á»‹nh tuyáº¿n tÃ¹y chá»‰nh cá»§a tÃ i liá»‡u tá»« Ä‘Ã³ láº¥y giÃ¡ trá»‹ term. Náº¿u giÃ¡ trá»‹ Ä‘á»‹nh tuyáº¿n tÃ¹y chá»‰nh Ä‘Ã£ Ä‘Æ°á»£c cung cáº¥p khi láº­p chá»‰ má»¥c tÃ i liá»‡u, thÃ¬ tham sá»‘ nÃ y lÃ  báº¯t buá»™c.</li>
</ul>
<p>VÃ­ dá»¥:</p>
<div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># 1. Táº¡o má»™t chá»‰ má»¥c</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">DELETE</span><span style="color:#98C379;--shiki-dark:#98C379"> my-index-000001</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> my-index-000001</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "mappings"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "properties"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "color"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "type":</span><span style="color:#98C379;--shiki-dark:#98C379"> "keyword"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># 2. Ghi má»™t tÃ i liá»‡u</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> my-index-000001/_doc/1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "color"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "blue"</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "green"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  ]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># 3. Ghi má»™t tÃ i liá»‡u khÃ¡c</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> my-index-000001/_doc/2</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "color"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "blue"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># 3. Sá»­ dá»¥ng terms query</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> my-index-000001/_search?pretty</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "terms"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "color"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "index"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "my-index-000001",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "id"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "2",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "path"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "color"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">DELETE</span><span style="color:#98C379;--shiki-dark:#98C379"> my-index-000001</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>type query</h3>
<blockquote>
<p>ÄÃ£ bá»‹ loáº¡i bá» sau phiÃªn báº£n 7.0.0</p>
</blockquote>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-type-query.html" target="_blank" rel="noopener noreferrer"><strong><code>type query</code></strong></a> Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ truy váº¥n cÃ¡c tÃ i liá»‡u cÃ³ loáº¡i cá»¥ thá»ƒ.</p>
<p>VÃ­ dá»¥:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "type"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "value"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "_doc"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><p>Tuy nhiÃªn, tá»« phiÃªn báº£n 7.0.0 trá»Ÿ Ä‘i, Elasticsearch Ä‘Ã£ loáº¡i bá» há»— trá»£ cho nhiá»u loáº¡i tÃ i liá»‡u trong má»™t chá»‰ má»¥c. Do Ä‘Ã³, <code>type query</code> khÃ´ng cÃ²n Ä‘Æ°á»£c sá»­ dá»¥ng ná»¯a. Thay vÃ o Ä‘Ã³, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c cáº¥u trÃºc dá»¯ liá»‡u khÃ¡c nhau trong cÃ¹ng má»™t tÃ i liá»‡u hoáº·c sá»­ dá»¥ng nhiá»u chá»‰ má»¥c.</p>
<h3>wildcard query</h3>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-wildcard-query.html" target="_blank" rel="noopener noreferrer"><strong><code>wildcard query</code></strong></a> lÃ  truy váº¥n sá»­ dá»¥ng kÃ½ tá»± Ä‘áº¡i diá»‡n, tráº£ vá» cÃ¡c tÃ i liá»‡u khá»›p vá»›i mÃ´ hÃ¬nh kÃ½ tá»± Ä‘áº¡i diá»‡n.</p>
<p><code>?</code> Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ khá»›p vá»›i má»™t kÃ½ tá»± báº¥t ká»³, <code>*</code> Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ khá»›p vá»›i khÃ´ng hoáº·c nhiá»u kÃ½ tá»±.</p>
<p>VÃ­ dá»¥: Truy váº¥n dÆ°á»›i Ä‘Ã¢y tráº£ vá» cÃ¡c tÃ i liá»‡u mÃ  trÆ°á»ng <code>user.id</code> chá»©a cÃ¡c thuáº­t ngá»¯ báº¯t Ä‘áº§u báº±ng <code>ki</code> vÃ  káº¿t thÃºc báº±ng <code>y</code>. CÃ¡c khá»›p nÃ y cÃ³ thá»ƒ bao gá»“m <code>kiy</code>, <code>kity</code> hoáº·c <code>kimchy</code>.</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "wildcard"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "user.id"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "value"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "ki*y",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "boost"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> 1.0,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "rewrite"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "constant_score"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><blockquote>
<p>LÆ°u Ã½: Náº¿u <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl.html#query-dsl-allow-expensive-queries" target="_blank" rel="noopener noreferrer"><code>search.allow_expensive_queries</code></a> Ä‘Æ°á»£c cáº¥u hÃ¬nh, thÃ¬ <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-wildcard-query.html" target="_blank" rel="noopener noreferrer"><strong><code>wildcard query</code></strong></a> sáº½ bá»‹ vÃ´ hiá»‡u hÃ³a.</p>
</blockquote>
<h3>VÃ­ dá»¥ hoÃ n chá»‰nh vá» truy váº¥n tá»« khoÃ¡</h3>
<div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">DELETE</span><span style="color:#98C379;--shiki-dark:#98C379"> products</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> products</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "settings"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "number_of_shards"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> /products/_bulk</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"index"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "_id":</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1</span><span style="color:#98C379;--shiki-dark:#98C379"> }}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"productID"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "XHDK-A-1293-#fJ3","desc":"iPhone"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"index"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "_id":</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 2</span><span style="color:#98C379;--shiki-dark:#98C379"> }}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"productID"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "KDKE-B-9947-#kL5","desc":"iPad"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"index"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "_id":</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 3</span><span style="color:#98C379;--shiki-dark:#98C379"> }}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"productID"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "JODL-X-1937-#pV7","desc":"MBP"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /products</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> /products/_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "term"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "desc"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        //</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"value"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "iPhone"</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "value"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"iphone"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> /products/_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "term"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "desc.keyword"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        //</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"value"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "iPhone"</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        //</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"value"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"iphone"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> /products/_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "term"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "productID"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "value"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "XHDK-A-1293-#fJ3"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> /products/_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  //</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"explain"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#D19A66;--shiki-dark:#D19A66"> true</span><span style="color:#98C379;--shiki-dark:#98C379">,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "term"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "productID.keyword"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "value"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "XHDK-A-1293-#fJ3"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> /products/_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "explain"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#D19A66;--shiki-dark:#D19A66"> true</span><span style="color:#98C379;--shiki-dark:#98C379">,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "constant_score"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "filter"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "term"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">          "productID.keyword"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "XHDK-A-1293-#fJ3"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Trong vÃ­ dá»¥ trÃªn, chÃºng ta Ä‘Ã£ táº¡o má»™t chá»‰ má»¥c <code>products</code> vá»›i má»™t sá»‘ tÃ i liá»‡u. Má»—i tÃ i liá»‡u cÃ³ hai trÆ°á»ng lÃ  <code>productID</code> vÃ  <code>desc</code>.</p>
<p>Sau Ä‘Ã³, chÃºng ta thá»±c hiá»‡n má»™t sá»‘ truy váº¥n tá»« ngá»¯ (<code>term query</code>) khÃ¡c nhau. Truy váº¥n tá»« ngá»¯ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ¬m cÃ¡c tÃ i liá»‡u mÃ  má»™t trÆ°á»ng cá»¥ thá»ƒ chá»©a má»™t giÃ¡ trá»‹ cá»¥ thá»ƒ.</p>
<p>Trong cÃ¡c truy váº¥n, chÃºng ta cÃ³ thá»ƒ tháº¥y ráº±ng Elasticsearch phÃ¢n biá»‡t chá»¯ hoa vÃ  chá»¯ thÆ°á»ng. VÃ­ dá»¥, truy váº¥n tá»« ngá»¯ vá»›i giÃ¡ trá»‹ "iphone" sáº½ khÃ´ng tráº£ vá» tÃ i liá»‡u mÃ  trÆ°á»ng <code>desc</code> cÃ³ giÃ¡ trá»‹ "iPhone".</p>
<p>NgoÃ i ra, chÃºng ta cÅ©ng tháº¥y ráº±ng chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng trÆ°á»ng <code>keyword</code> Ä‘á»ƒ thá»±c hiá»‡n truy váº¥n khÃ´ng phÃ¢n biá»‡t chá»¯ hoa vÃ  chá»¯ thÆ°á»ng.</p>
<p>Cuá»‘i cÃ¹ng, chÃºng ta cÅ©ng tháº¥y ráº±ng chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng <code>constant_score</code> Ä‘á»ƒ Ã¡p dá»¥ng Ä‘iá»ƒm sá»‘ cá»‘ Ä‘á»‹nh cho táº¥t cáº£ cÃ¡c tÃ i liá»‡u khá»›p.</p>
<h2>Truy váº¥n káº¿t há»£p</h2>
<p>Truy váº¥n káº¿t há»£p lÃ  viá»‡c káº¿t há»£p má»™t sá»‘ truy váº¥n Ä‘Æ¡n giáº£n láº¡i vá»›i nhau Ä‘á»ƒ Ä‘Ã¡p á»©ng cÃ¡c yÃªu cáº§u truy váº¥n phá»©c táº¡p hÆ¡n. NgoÃ i ra, truy váº¥n káº¿t há»£p cÅ©ng cÃ³ thá»ƒ Ä‘iá»u khiá»ƒn hÃ nh vi cá»§a cÃ¡c truy váº¥n khÃ¡c.</p>
<h3>bool query</h3>
<p>Truy váº¥n bool cÃ³ thá»ƒ káº¿t há»£p báº¥t ká»³ sá»‘ lÆ°á»£ng truy váº¥n Ä‘Æ¡n giáº£n nÃ o, sá»­ dá»¥ng cÃ¡c tÃ¹y chá»n must, should, must_not, filter Ä‘á»ƒ biá»ƒu thá»‹ logic giá»¯a cÃ¡c truy váº¥n Ä‘Æ¡n giáº£n. Má»—i tÃ¹y chá»n cÃ³ thá»ƒ xuáº¥t hiá»‡n tá»« 0 Ä‘áº¿n nhiá»u láº§n, Ã½ nghÄ©a cá»§a chÃºng nhÆ° sau:</p>
<ul>
<li>must: tÃ i liá»‡u pháº£i khá»›p vá»›i cÃ¡c Ä‘iá»u kiá»‡n truy váº¥n trong tÃ¹y chá»n must, tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i AND trong logic, vÃ  tham gia vÃ o viá»‡c Ä‘Ã¡nh giÃ¡ má»©c Ä‘á»™ liÃªn quan cá»§a tÃ i liá»‡u.</li>
<li>should: tÃ i liá»‡u cÃ³ thá»ƒ khá»›p hoáº·c khÃ´ng khá»›p vá»›i cÃ¡c Ä‘iá»u kiá»‡n truy váº¥n trong tÃ¹y chá»n should, tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i OR trong logic, vÃ  tham gia vÃ o viá»‡c Ä‘Ã¡nh giÃ¡ má»©c Ä‘á»™ liÃªn quan cá»§a tÃ i liá»‡u.</li>
<li>must_not: ngÆ°á»£c láº¡i vá»›i must, cÃ¡c tÃ i liá»‡u khá»›p vá»›i cÃ¡c Ä‘iá»u kiá»‡n truy váº¥n trong tÃ¹y chá»n must_not sáº½ khÃ´ng Ä‘Æ°á»£c tráº£ vá»; Ä‘iá»u cáº§n lÆ°u Ã½ lÃ  <strong>cÃ¢u lá»‡nh must_not khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n viá»‡c Ä‘Ã¡nh giÃ¡ Ä‘iá»ƒm, nÃ³ chá»‰ loáº¡i bá» cÃ¡c tÃ i liá»‡u khÃ´ng liÃªn quan</strong>.</li>
<li>filter: giá»‘ng nhÆ° must, chá»‰ cÃ¡c tÃ i liá»‡u khá»›p vá»›i cÃ¡c Ä‘iá»u kiá»‡n truy váº¥n trong tÃ¹y chá»n filter má»›i Ä‘Æ°á»£c tráº£ vá», <strong>nhÆ°ng filter khÃ´ng Ä‘Ã¡nh giÃ¡ Ä‘iá»ƒm, chá»‰ cÃ³ chá»©c nÄƒng lá»c, ngÆ°á»£c láº¡i vá»›i must_not</strong>.</li>
</ul>
<p>Giáº£ sá»­ báº¡n muá»‘n tÃ¬m kiáº¿m cÃ¡c cuá»‘n sÃ¡ch cÃ³ tiÃªu Ä‘á» chá»©a tá»« khÃ³a java, giÃ¡ khÃ´ng cao hÆ¡n 70, mÃ´ táº£ cÃ³ thá»ƒ chá»©a hoáº·c khÃ´ng chá»©a mÃ¡y áº£o, báº¡n cÃ³ thá»ƒ táº¡o truy váº¥n bool nhÆ° sau:</p>
<div class="language- line-numbers-mode" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET books/_search</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  "query": {</span></span>
<span class="line"><span>    "bool": {</span></span>
<span class="line"><span>      "filter": {</span></span>
<span class="line"><span>        "term": {</span></span>
<span class="line"><span>          "status": 1</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>      },</span></span>
<span class="line"><span>      "must_not": {</span></span>
<span class="line"><span>        "range": {</span></span>
<span class="line"><span>          "price": {</span></span>
<span class="line"><span>            "gte": 70</span></span>
<span class="line"><span>          }</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>      },</span></span>
<span class="line"><span>      "must": {</span></span>
<span class="line"><span>        "match": {</span></span>
<span class="line"><span>          "title": "java"</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>      },</span></span>
<span class="line"><span>      "should": [</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>          "match": {</span></span>
<span class="line"><span>            "description": "mÃ¡y áº£o"</span></span>
<span class="line"><span>          }</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>      ],</span></span>
<span class="line"><span>      "minimum_should_match": 1</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Äá»ƒ biáº¿t thÃªm thÃ´ng tin chi tiáº¿t vá» truy váº¥n bool, hÃ£y tham kháº£o <a href="https://www.knowledgedict.com/tutorial/elasticsearch-query-bool.html" target="_blank" rel="noopener noreferrer">bool queryï¼ˆtruy váº¥n káº¿t há»£pï¼‰chi tiáº¿t</a>.</p>
<h3>Truy váº¥n boosting</h3>
<p>Truy váº¥n boosting Ä‘Æ°á»£c sá»­ dá»¥ng trong cÃ¡c tÃ¬nh huá»‘ng cáº§n Ä‘iá»u chá»‰nh Ä‘iá»ƒm sá»‘ cá»§a hai truy váº¥n. Truy váº¥n boosting sáº½ Ä‘Ã³ng gÃ³i hai truy váº¥n láº¡i vá»›i nhau vÃ  giáº£m Ä‘iá»ƒm sá»‘ cá»§a má»™t trong hai truy váº¥n.</p>
<p>Truy váº¥n boosting bao gá»“m ba pháº§n: positive, negative vÃ  negative_boost. Äiá»ƒm sá»‘ cá»§a truy váº¥n trong pháº§n positive Ä‘Æ°á»£c giá»¯ nguyÃªn, truy váº¥n trong pháº§n negative sáº½ giáº£m Ä‘iá»ƒm sá»‘ cá»§a tÃ i liá»‡u, vÃ  negative_boost chá»‰ Ä‘á»‹nh giÃ¡ trá»‹ giáº£m trong pháº§n negative. Náº¿u chÃºng ta muá»‘n giáº£m Ä‘iá»ƒm sá»‘ cá»§a cÃ¡c cuá»‘n sÃ¡ch xuáº¥t báº£n trÆ°á»›c nÄƒm 2015, chÃºng ta cÃ³ thá»ƒ táº¡o má»™t truy váº¥n boosting, truy váº¥n nhÆ° sau:</p>
<div class="language- line-numbers-mode" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET books/_search</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	"query": {</span></span>
<span class="line"><span>		"boosting": {</span></span>
<span class="line"><span>			"positive": {</span></span>
<span class="line"><span>				"match": {</span></span>
<span class="line"><span>					"title": "python"</span></span>
<span class="line"><span>				}</span></span>
<span class="line"><span>			},</span></span>
<span class="line"><span>			"negative": {</span></span>
<span class="line"><span>				"range": {</span></span>
<span class="line"><span>					"publish_time": {</span></span>
<span class="line"><span>						"lte": "2015-01-01"</span></span>
<span class="line"><span>					}</span></span>
<span class="line"><span>				}</span></span>
<span class="line"><span>			},</span></span>
<span class="line"><span>			"negative_boost": 0.2</span></span>
<span class="line"><span>		}</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Trong truy váº¥n boosting, chÃºng ta Ä‘Ã£ chá»‰ Ä‘á»‹nh yáº¿u tá»‘ á»©c cháº¿ lÃ  0.2, Ä‘iá»ƒm sá»‘ cá»§a cÃ¡c tÃ i liá»‡u cÃ³ giÃ¡ trá»‹ publish_time sau ngÃ y 01-01-2015 khÃ´ng thay Ä‘á»•i, Ä‘iá»ƒm sá»‘ cá»§a cÃ¡c tÃ i liá»‡u cÃ³ giÃ¡ trá»‹ publish_time trÆ°á»›c ngÃ y 01-01-2015 sáº½ lÃ  0.2 láº§n Ä‘iá»ƒm sá»‘ gá»‘c.</p>
<h3>Truy váº¥n constant_score</h3>
<p>Truy váº¥n constant_score Ä‘Ã³ng gÃ³i má»™t truy váº¥n filter vÃ  tráº£ vá» cÃ¡c tÃ i liá»‡u phÃ¹ há»£p vá»›i Ä‘iá»u kiá»‡n truy váº¥n cá»§a bá»™ lá»c, vá»›i Ä‘iá»ƒm sá»‘ liÃªn quan cá»§a táº¥t cáº£ chÃºng Ä‘á»u báº±ng giÃ¡ trá»‹ cá»§a tham sá»‘ _boost_ (cÃ³ thá»ƒ hiá»ƒu lÃ  Ä‘iá»ƒm sá»‘ liÃªn quan ban Ä‘áº§u dá»±a trÃªn tf-idf hoáº·c bm25 Ä‘Æ°á»£c cá»‘ Ä‘á»‹nh lÃ  1.0, vÃ¬ váº­y Ä‘iá»ƒm sá»‘ cuá»‘i cÃ¹ng lÃ  <em>1.0 * boost</em>, tá»©c lÃ  báº±ng giÃ¡ trá»‹ cá»§a tham sá»‘ <em>boost</em>). Truy váº¥n dÆ°á»›i Ä‘Ã¢y sáº½ tráº£ vá» cÃ¡c tÃ i liá»‡u cÃ³ trÆ°á»ng title chá»©a tá»« khÃ³a <em>elasticsearch</em>, vá»›i Ä‘iá»ƒm sá»‘ cá»§a táº¥t cáº£ cÃ¡c tÃ i liá»‡u Ä‘á»u lÃ  1.8:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET books/_search</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  "query": {</span></span>
<span class="line"><span>    "constant_score": {</span></span>
<span class="line"><span>      "filter": {</span></span>
<span class="line"><span>        "term": {</span></span>
<span class="line"><span>          "title": "elasticsearch"</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>      },</span></span>
<span class="line"><span>      "boost": 1.8</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><h3>Truy váº¥n dis_max</h3>
<p>Truy váº¥n dis_max cÃ³ má»™t sá»‘ liÃªn há»‡ nhÆ°ng cÅ©ng cÃ³ sá»± khÃ¡c biá»‡t vá»›i truy váº¥n bool. Truy váº¥n dis_max há»— trá»£ nhiá»u truy váº¥n song song, cÃ³ thá»ƒ tráº£ vá» báº¥t ká»³ loáº¡i tÃ i liá»‡u nÃ o phÃ¹ há»£p vá»›i báº¥t ká»³ Ä‘iá»u kiá»‡n truy váº¥n con nÃ o. KhÃ¡c vá»›i cÃ¡ch truy váº¥n bool cÃ³ thá»ƒ káº¿t há»£p Ä‘iá»ƒm sá»‘ cá»§a táº¥t cáº£ cÃ¡c truy váº¥n phÃ¹ há»£p, truy váº¥n dis_max chá»‰ sá»­ dá»¥ng Ä‘iá»ƒm sá»‘ cá»§a Ä‘iá»u kiá»‡n truy váº¥n phÃ¹ há»£p nháº¥t. HÃ£y xem vÃ­ dá»¥ dÆ°á»›i Ä‘Ã¢y:</p>
<div class="language- line-numbers-mode" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET books/_search</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	"query": {</span></span>
<span class="line"><span>		"dis_max": {</span></span>
<span class="line"><span>			"tie_breaker": 0.7,</span></span>
<span class="line"><span>			"boost": 1.2,</span></span>
<span class="line"><span>			"queries": [{</span></span>
<span class="line"><span>					"term": {</span></span>
<span class="line"><span>						"age": 34</span></span>
<span class="line"><span>					}</span></span>
<span class="line"><span>				},</span></span>
<span class="line"><span>				{</span></span>
<span class="line"><span>					"term": {</span></span>
<span class="line"><span>						"age": 35</span></span>
<span class="line"><span>					}</span></span>
<span class="line"><span>				}</span></span>
<span class="line"><span>			]</span></span>
<span class="line"><span>		}</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>Truy váº¥n function_score</h3>
<p>Truy váº¥n function_score cÃ³ thá»ƒ chá»‰nh sá»­a Ä‘iá»ƒm sá»‘ cá»§a cÃ¡c tÃ i liá»‡u Ä‘Æ°á»£c truy váº¥n, loáº¡i truy váº¥n nÃ y ráº¥t há»¯u Ã­ch trong má»™t sá»‘ trÆ°á»ng há»£p, cháº³ng háº¡n nhÆ° khi chi phÃ­ tÃ­nh toÃ¡n Ä‘iá»ƒm sá»‘ cá»§a tÃ i liá»‡u báº±ng hÃ m Ä‘iá»ƒm sá»‘ lÃ  quÃ¡ cao, ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ thay tháº¿ cÃ¡ch tÃ­nh Ä‘iá»ƒm sá»‘ truyá»n thá»‘ng báº±ng cÃ¡ch sá»­ dá»¥ng bá»™ lá»c káº¿t há»£p vá»›i hÃ m Ä‘iá»ƒm sá»‘ tÃ¹y chá»‰nh.</p>
<p>Khi sá»­ dá»¥ng truy váº¥n function_score, ngÆ°á»i dÃ¹ng cáº§n Ä‘á»‹nh nghÄ©a má»™t truy váº¥n vÃ  má»™t hoáº·c nhiá»u hÃ m Ä‘iá»ƒm sá»‘, hÃ m Ä‘iá»ƒm sá»‘ sáº½ tÃ­nh toÃ¡n Ä‘iá»ƒm sá»‘ cho má»—i tÃ i liá»‡u Ä‘Æ°á»£c truy váº¥n.</p>
<p>Truy váº¥n dÆ°á»›i Ä‘Ã¢y sáº½ tráº£ vá» táº¥t cáº£ cÃ¡c tÃ i liá»‡u trong chá»‰ má»¥c books, vá»›i Ä‘iá»ƒm sá»‘ tá»‘i Ä‘a cá»§a tÃ i liá»‡u lÃ  5, Ä‘iá»ƒm sá»‘ cá»§a má»—i tÃ i liá»‡u Ä‘Æ°á»£c táº¡o ngáº«u nhiÃªn, cháº¿ Ä‘á»™ tÃ­nh trá»ng sá»‘ lÃ  cháº¿ Ä‘á»™ nhÃ¢n.</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET books/_search</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  "query": {</span></span>
<span class="line"><span>    "function_score": {</span></span>
<span class="line"><span>      "query": {</span></span>
<span class="line"><span>        "match_all": {}</span></span>
<span class="line"><span>      },</span></span>
<span class="line"><span>      "boost": "5",</span></span>
<span class="line"><span>      "random_score": {},</span></span>
<span class="line"><span>      "boost_mode": "multiply"</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><p>Sá»­ dá»¥ng script Ä‘á»ƒ tÃ¹y chá»‰nh cÃ´ng thá»©c Ä‘iá»ƒm sá»‘, á»Ÿ Ä‘Ã¢y chÃºng tÃ´i láº¥y cÄƒn báº­c hai cá»§a má»™t pháº§n mÆ°á»i giÃ¡ trá»‹ price lÃ m Ä‘iá»ƒm sá»‘ cho má»—i tÃ i liá»‡u, truy váº¥n nhÆ° sau:</p>
<div class="language- line-numbers-mode" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET books/_search</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  "query": {</span></span>
<span class="line"><span>    "function_score": {</span></span>
<span class="line"><span>      "query": {</span></span>
<span class="line"><span>        "match": {</span></span>
<span class="line"><span>          "title": "java"</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>      },</span></span>
<span class="line"><span>      "script_score": {</span></span>
<span class="line"><span>        "inline": "Math.sqrt(doc['price'].value/10)"</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Äá»ƒ biáº¿t thÃªm chi tiáº¿t vá» function_score, vui lÃ²ng xem <a href="https://www.knowledgedict.com/tutorial/elasticsearch-function_score.html" target="_blank" rel="noopener noreferrer">Elasticsearch function_score truy váº¥n giáº£i thÃ­ch máº¡nh nháº¥t</a>.</p>
<h3>Truy váº¥n indices</h3>
<p>Truy váº¥n indices phÃ¹ há»£p vá»›i cÃ¡c tÃ¬nh huá»‘ng cáº§n truy váº¥n giá»¯a nhiá»u chá»‰ má»¥c, nÃ³ cho phÃ©p chá»‰ Ä‘á»‹nh danh sÃ¡ch tÃªn chá»‰ má»¥c vÃ  truy váº¥n ná»™i bá»™. Trong truy váº¥n indices, cÃ³ hai pháº§n lÃ  query vÃ  no_match_query. Pháº§n query Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ¬m kiáº¿m tÃ i liá»‡u trong danh sÃ¡ch chá»‰ má»¥c Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh, trong khi Ä‘iá»u kiá»‡n truy váº¥n trong no_match_query Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ¬m kiáº¿m tÃ i liá»‡u ngoÃ i danh sÃ¡ch chá»‰ má»¥c Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh. Truy váº¥n sau Ä‘Ã¢y tÃ¬m kiáº¿m cÃ¡c tÃ i liá»‡u trong chá»‰ má»¥c books vÃ  books2 cÃ³ trÆ°á»ng title chá»©a tá»« khÃ³a "javascript", vÃ  cÃ¡c tÃ i liá»‡u trong cÃ¡c chá»‰ má»¥c khÃ¡c cÃ³ trÆ°á»ng title chá»©a "basketball". Truy váº¥n nhÆ° sau:</p>
<div class="language- line-numbers-mode" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET books/_search</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	"query": {</span></span>
<span class="line"><span>		"indices": {</span></span>
<span class="line"><span>			"indices": ["books", "books2"],</span></span>
<span class="line"><span>			"query": {</span></span>
<span class="line"><span>				"match": {</span></span>
<span class="line"><span>					"title": "javascript"</span></span>
<span class="line"><span>				}</span></span>
<span class="line"><span>			},</span></span>
<span class="line"><span>			"no_match_query": {</span></span>
<span class="line"><span>				"term": {</span></span>
<span class="line"><span>					"title": "basketball"</span></span>
<span class="line"><span>				}</span></span>
<span class="line"><span>			}</span></span>
<span class="line"><span>		}</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>Truy váº¥n lá»“ng</h2>
<p>Trong há»‡ thá»‘ng phÃ¢n tÃ¡n nhÆ° Elasticsearch, viá»‡c thá»±c hiá»‡n truy váº¥n káº¿t ná»‘i theo phong cÃ¡ch SQL toÃ n diá»‡n cÃ³ chi phÃ­ cao vÃ  khÃ´ng kháº£ thi. Thay vÃ o Ä‘Ã³, Ä‘á»ƒ thá»±c hiá»‡n má»Ÿ rá»™ng theo quy mÃ´ chiá»u ngang, Elasticsearch cung cáº¥p hai hÃ¬nh thá»©c join sau:</p>
<ul>
<li>
<p>Truy váº¥n lá»“ng (nested query)</p>
<p>CÃ¡c tÃ i liá»‡u cÃ³ thá»ƒ chá»©a cÃ¡c trÆ°á»ng kiá»ƒu lá»“ng, cÃ¡c trÆ°á»ng nÃ y Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ chá»‰ má»¥c má»™t sá»‘ Ä‘á»‘i tÆ°á»£ng máº£ng, má»—i Ä‘á»‘i tÆ°á»£ng cÃ³ thá»ƒ Ä‘Æ°á»£c truy váº¥n nhÆ° má»™t tÃ i liá»‡u Ä‘á»™c láº­p.</p>
</li>
<li>
<p>Truy váº¥n has_child (cÃ³ truy váº¥n con) vÃ  truy váº¥n has_parent (cÃ³ truy váº¥n cha)</p>
<p>Má»‘i quan há»‡ cha-con cÃ³ thá»ƒ tá»“n táº¡i giá»¯a hai loáº¡i tÃ i liá»‡u trong má»™t chá»‰ má»¥c duy nháº¥t. Truy váº¥n has_child sáº½ tráº£ vá» cÃ¡c tÃ i liá»‡u cha mÃ  tÃ i liá»‡u con cá»§a chÃºng Ä‘Ã¡p á»©ng truy váº¥n cá»¥ thá»ƒ, trong khi has_parent sáº½ tráº£ vá» cÃ¡c tÃ i liá»‡u con mÃ  tÃ i liá»‡u cha cá»§a chÃºng Ä‘Ã¡p á»©ng truy váº¥n cá»¥ thá»ƒ.</p>
</li>
</ul>
<h3>Truy váº¥n lá»“ng</h3>
<p>CÃ¡c tÃ i liá»‡u cÃ³ thá»ƒ chá»©a cÃ¡c trÆ°á»ng kiá»ƒu lá»“ng, cÃ¡c trÆ°á»ng nÃ y Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ chá»‰ má»¥c má»™t sá»‘ Ä‘á»‘i tÆ°á»£ng máº£ng, má»—i Ä‘á»‘i tÆ°á»£ng cÃ³ thá»ƒ Ä‘Æ°á»£c truy váº¥n nhÆ° má»™t tÃ i liá»‡u Ä‘á»™c láº­p (sá»­ dá»¥ng truy váº¥n lá»“ng).</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>PUT /my_index</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	"mappings": {</span></span>
<span class="line"><span>		"type1": {</span></span>
<span class="line"><span>			"properties": {</span></span>
<span class="line"><span>				"obj1": {</span></span>
<span class="line"><span>					"type": "nested"</span></span>
<span class="line"><span>				}</span></span>
<span class="line"><span>			}</span></span>
<span class="line"><span>		}</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><h3>Truy váº¥n has_child</h3>
<p>Má»‘i quan há»‡ cha-con giá»¯a cÃ¡c tÃ i liá»‡u Ä‘Æ°á»£c khai bÃ¡o trong lÃºc táº¡o chá»‰ má»¥c, trong vÃ­ dá»¥ nÃ y, chÃºng ta sáº½ sá»­ dá»¥ng nhÃ¢n viÃªn (employee) vÃ  chi nhÃ¡nh (branch) lÃ m vÃ­ dá»¥, chÃºng thuá»™c vá» cÃ¡c loáº¡i khÃ¡c nhau, tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i hai báº£ng trong cÆ¡ sá»Ÿ dá»¯ liá»‡u. Náº¿u chÃºng ta muá»‘n liÃªn káº¿t nhÃ¢n viÃªn vá»›i thÃ nh phá»‘ mÃ  há» lÃ m viá»‡c, chÃºng ta cáº§n thÃ´ng bÃ¡o cho Elasticsearch vá» má»‘i quan há»‡ cha-con giá»¯a cÃ¡c tÃ i liá»‡u, trong Ä‘Ã³ employee lÃ  loáº¡i con, vÃ  branch lÃ  loáº¡i cha. ChÃºng ta khai bÃ¡o má»‘i quan há»‡ nÃ y trong lÃºc táº¡o chá»‰ má»¥c, thá»±c hiá»‡n lá»‡nh sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>PUT /company</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	"mappings": {</span></span>
<span class="line"><span>		"branch": {},</span></span>
<span class="line"><span>		"employee": {</span></span>
<span class="line"><span>			"parent": { "type": "branch" }</span></span>
<span class="line"><span>		}</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><p>Sá»­ dá»¥ng bulk api Ä‘á»ƒ chá»‰ má»¥c tÃ i liá»‡u dÆ°á»›i loáº¡i branch, lá»‡nh nhÆ° sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>POST company/branch/_bulk</span></span>
<span class="line"><span>{ "index": { "_id": "london" }}</span></span>
<span class="line"><span>{ "name": "London Westminster","city": "London","country": "UK" }</span></span>
<span class="line"><span>{ "index": { "_id": "liverpool" }}</span></span>
<span class="line"><span>{ "name": "Liverpool Central","city": "Liverpool","country": "UK" }</span></span>
<span class="line"><span>{ "index": { "_id": "paris" }}</span></span>
<span class="line"><span>{ "name": "Champs Elysees","city": "Paris","country": "France" }</span></span></code></pre>
</div><p>ThÃªm dá»¯ liá»‡u nhÃ¢n viÃªn:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>POST company/employee/_bulk</span></span>
<span class="line"><span>{ "index": { "_id": 1,"parent":"london" }}</span></span>
<span class="line"><span>{ "name": "Alice Smith","dob": "1970-10-24","hobby": "hiking" }</span></span>
<span class="line"><span>{ "index": { "_id": 2,"parent":"london" }}</span></span>
<span class="line"><span>{ "name": "Mark Tomas","dob": "1982-05-16","hobby": "diving" }</span></span>
<span class="line"><span>{ "index": { "_id": 3,"parent":"liverpool" }}</span></span>
<span class="line"><span>{ "name": "Barry Smith","dob": "1979-04-01","hobby": "hiking" }</span></span>
<span class="line"><span>{ "index": { "_id": 4,"parent":"paris" }}</span></span>
<span class="line"><span>{ "name": "Adrien Grand","dob": "1987-05-11","hobby": "horses" }</span></span></code></pre>
</div><p>Äá»ƒ truy váº¥n tÃ i liá»‡u cha thÃ´ng qua tÃ i liá»‡u con, chÃºng ta sá»­ dá»¥ng truy váº¥n has_child. VÃ­ dá»¥, Ä‘á»ƒ tÃ¬m kiáº¿m cÃ¡c chi nhÃ¡nh cÃ³ nhÃ¢n viÃªn sinh sau nÄƒm 1980, nhÃ¢n viÃªn sinh sau nÄƒm 1980 bao gá»“m Mark Thomas vÃ  Adrien Grand, há» lÃ m viá»‡c táº¡i London vÃ  Paris tÆ°Æ¡ng á»©ng. ChÃºng ta thá»±c hiá»‡n lá»‡nh truy váº¥n sau Ä‘á»ƒ xÃ¡c minh:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET company/branch/_search</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	"query": {</span></span>
<span class="line"><span>		"has_child": {</span></span>
<span class="line"><span>			"type": "employee",</span></span>
<span class="line"><span>			"query": {</span></span>
<span class="line"><span>				"range": { "dob": { "gte": "1980-01-01" } }</span></span>
<span class="line"><span>			}</span></span>
<span class="line"><span>		}</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><p>TÃ¬m kiáº¿m nhá»¯ng chi nhÃ¡nh cÃ³ nhÃ¢n viÃªn tÃªn lÃ  "Alice Smith", vÃ¬ chÃºng ta sá»­ dá»¥ng truy váº¥n match, nÃ³ sáº½ Ä‘Æ°á»£c phÃ¢n tÃ­ch thÃ nh "Alice" vÃ  "Smith", vÃ¬ váº­y chi nhÃ¡nh mÃ  Alice Smith vÃ  Barry Smith lÃ m viá»‡c sáº½ Ä‘Æ°á»£c khá»›p. ChÃºng ta thá»±c hiá»‡n lá»‡nh truy váº¥n sau Ä‘á»ƒ xÃ¡c minh:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET company/branch/_search</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	"query": {</span></span>
<span class="line"><span>		"has_child": {</span></span>
<span class="line"><span>			"type": "employee",</span></span>
<span class="line"><span>			"score_mode": "max",</span></span>
<span class="line"><span>			"query": {</span></span>
<span class="line"><span>				"match": { "name": "Alice Smith" }</span></span>
<span class="line"><span>			}</span></span>
<span class="line"><span>		}</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><p>ChÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng min_children Ä‘á»ƒ chá»‰ Ä‘á»‹nh sá»‘ lÆ°á»£ng tá»‘i thiá»ƒu cá»§a tÃ i liá»‡u con. VÃ­ dá»¥, Ä‘á»ƒ tÃ¬m kiáº¿m nhá»¯ng chi nhÃ¡nh cÃ³ Ã­t nháº¥t hai nhÃ¢n viÃªn, chÃºng ta thá»±c hiá»‡n lá»‡nh truy váº¥n sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET company/branch/_search?pretty</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	"query": {</span></span>
<span class="line"><span>		"has_child": {</span></span>
<span class="line"><span>			"type": "employee",</span></span>
<span class="line"><span>			"min_children": 2,</span></span>
<span class="line"><span>			"query": {</span></span>
<span class="line"><span>				"match_all": {}</span></span>
<span class="line"><span>			}</span></span>
<span class="line"><span>		}</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><h3>Truy váº¥n has_parent</h3>
<p>Äá»ƒ truy váº¥n tÃ i liá»‡u con thÃ´ng qua tÃ i liá»‡u cha, chÃºng ta sá»­ dá»¥ng truy váº¥n has_parent. VÃ­ dá»¥, Ä‘á»ƒ tÃ¬m kiáº¿m nhá»¯ng nhÃ¢n viÃªn lÃ m viá»‡c á»Ÿ UK, chÃºng ta thá»±c hiá»‡n lá»‡nh truy váº¥n sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET company/employee/_search</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	"query": {</span></span>
<span class="line"><span>		"has_parent": {</span></span>
<span class="line"><span>			"parent_type": "branch",</span></span>
<span class="line"><span>			"query": {</span></span>
<span class="line"><span>				"match": { "country": "UK" }</span></span>
<span class="line"><span>			}</span></span>
<span class="line"><span>		}</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><h2>Truy váº¥n vá»‹ trÃ­</h2>
<p>Elasticsearch cÃ³ thá»ƒ tÃ¬m kiáº¿m dá»¯ liá»‡u cá»§a loáº¡i Ä‘iá»ƒm Ä‘á»‹a lÃ½ (geo_point) vÃ  hÃ¬nh dáº¡ng Ä‘á»‹a lÃ½ (geo_shape). Äá»ƒ thuáº­n tiá»‡n cho viá»‡c há»c, chÃºng ta sáº½ chuáº©n bá»‹ má»™t sá»‘ tá»a Ä‘á»™ Ä‘á»‹a lÃ½ cá»§a cÃ¡c thÃ nh phá»‘ Ä‘á»ƒ lÃ m dá»¯ liá»‡u thá»­ nghiá»‡m, má»—i tÃ i liá»‡u Ä‘á»u bao gá»“m hai trÆ°á»ng lÃ  tÃªn thÃ nh phá»‘ vÃ  tá»a Ä‘á»™ Ä‘á»‹a lÃ½. Tá»a Ä‘á»™ nÃ y Ä‘Æ°á»£c láº¥y tá»« má»™t vá»‹ trÃ­ á»Ÿ trung tÃ¢m cá»§a má»—i thÃ nh phá»‘. Äáº§u tiÃªn, hÃ£y lÆ°u ná»™i dung sau vÃ o tá»‡p geo.json:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>{"index":{ "_index":"geo","_type":"city","_id":"1" }}</span></span>
<span class="line"><span>{"name":"Báº¯c Kinh","location":"39.9088145109,116.3973999023"}</span></span>
<span class="line"><span>{"index":{ "_index":"geo","_type":"city","_id": "2" }}</span></span>
<span class="line"><span>{"name":"Urumqi","location":"43.8266300000,87.6168800000"}</span></span>
<span class="line"><span>{"index":{ "_index":"geo","_type":"city","_id":"3" }}</span></span>
<span class="line"><span>{"name":"TÃ¢y An","location":"34.3412700000,108.9398400000"}</span></span>
<span class="line"><span>{"index":{ "_index":"geo","_type":"city","_id":"4" }}</span></span>
<span class="line"><span>{"name":"Zhengzhou","location":"34.7447157466,113.6587142944"}</span></span>
<span class="line"><span>{"index":{ "_index":"geo","_type":"city","_id":"5" }}</span></span>
<span class="line"><span>{"name":"HÃ ng ChÃ¢u","location":"30.2294080260,120.1492309570"}</span></span>
<span class="line"><span>{"index":{ "_index":"geo","_type":"city","_id":"6" }}</span></span>
<span class="line"><span>{"name":"Jinan","location":"36.6518400000,117.1200900000"}</span></span></code></pre>
</div><p>Táº¡o má»™t chá»‰ má»¥c vÃ  thiáº¿t láº­p Ã¡nh xáº¡:</p>
<div class="language- line-numbers-mode" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>PUT geo</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	"mappings": {</span></span>
<span class="line"><span>		"city": {</span></span>
<span class="line"><span>			"properties": {</span></span>
<span class="line"><span>				"name": {</span></span>
<span class="line"><span>					"type": "keyword"</span></span>
<span class="line"><span>				},</span></span>
<span class="line"><span>				"location": {</span></span>
<span class="line"><span>					"type": "geo_point"</span></span>
<span class="line"><span>				}</span></span>
<span class="line"><span>			}</span></span>
<span class="line"><span>		}</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Sau Ä‘Ã³ thá»±c hiá»‡n lá»‡nh nháº­p hÃ ng loáº¡t:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>curl -XPOST "http://localhost:9200/_bulk?pretty" --data-binary @geo.json</span></span></code></pre>
</div><h3>Truy váº¥n geo_distance</h3>
<p>Truy váº¥n geo_distance cÃ³ thá»ƒ tÃ¬m kiáº¿m cÃ¡c tÃ i liá»‡u Ä‘iá»ƒm Ä‘á»‹a lÃ½ náº±m trong pháº¡m vi xÃ¡c Ä‘á»‹nh tá»« má»™t Ä‘iá»ƒm trung tÃ¢m. VÃ­ dá»¥, Ä‘á»ƒ tÃ¬m kiáº¿m cÃ¡c thÃ nh phá»‘ náº±m trong bÃ¡n kÃ­nh 200km tá»« Thanh ÄÃ´, káº¿t quáº£ tÃ¬m kiáº¿m sáº½ tráº£ vá» Báº¯c Kinh, lá»‡nh nhÆ° sau:</p>
<div class="language- line-numbers-mode" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET geo/_search</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	"query": {</span></span>
<span class="line"><span>		"bool": {</span></span>
<span class="line"><span>			"must": {</span></span>
<span class="line"><span>				"match_all": {}</span></span>
<span class="line"><span>			},</span></span>
<span class="line"><span>			"filter": {</span></span>
<span class="line"><span>				"geo_distance": {</span></span>
<span class="line"><span>					"distance": "200km",</span></span>
<span class="line"><span>					"location": {</span></span>
<span class="line"><span>						"lat": 39.0851000000,</span></span>
<span class="line"><span>						"lon": 117.1993700000</span></span>
<span class="line"><span>					}</span></span>
<span class="line"><span>				}</span></span>
<span class="line"><span>			}</span></span>
<span class="line"><span>		}</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Sáº¯p xáº¿p cÃ¡c thÃ nh phá»‘ theo khoáº£ng cÃ¡ch Ä‘áº¿n Báº¯c Kinh:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET geo/_search</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  "query": {</span></span>
<span class="line"><span>    "match_all": {}</span></span>
<span class="line"><span>  },</span></span>
<span class="line"><span>  "sort": [{</span></span>
<span class="line"><span>    "_geo_distance": {</span></span>
<span class="line"><span>      "location": "39.9088145109,116.3973999023",</span></span>
<span class="line"><span>      "unit": "km",</span></span>
<span class="line"><span>      "order": "asc",</span></span>
<span class="line"><span>      "distance_type": "plane"</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }]</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><p>Trong Ä‘Ã³, trÆ°á»ng location tÆ°Æ¡ng á»©ng vá»›i trÆ°á»ng kinh Ä‘á»™ vÃ  vÄ© Ä‘á»™; unit lÃ  <code>km</code>, nghÄ©a lÃ  khoáº£ng cÃ¡ch sáº½ Ä‘Æ°á»£c ghi vÃ o khÃ³a sort cá»§a má»—i káº¿t quáº£ tráº£ vá» theo Ä‘Æ¡n vá»‹ <code>km</code>; distance_type lÃ  <code>plane</code>, nghÄ©a lÃ  sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p tÃ­nh toÃ¡n <code>plane</code> nhanh nhÆ°ng Ä‘á»™ chÃ­nh xÃ¡c hÆ¡i kÃ©m.</p>
<h3>Truy váº¥n geo_bounding_box</h3>
<p>Truy váº¥n geo_bounding_box Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ¬m kiáº¿m cÃ¡c tá»a Ä‘á»™ Ä‘á»‹a lÃ½ náº±m trong má»™t hÃ¬nh chá»¯ nháº­t xÃ¡c Ä‘á»‹nh. Truy váº¥n xÃ¡c Ä‘á»‹nh má»™t hÃ¬nh chá»¯ nháº­t báº±ng hai Ä‘iá»ƒm, sau Ä‘Ã³ tÃ¬m kiáº¿m cÃ¡c tÃ i liá»‡u phÃ¹ há»£p trong khu vá»±c hÃ¬nh chá»¯ nháº­t.</p>
<div class="language- line-numbers-mode" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET geo/_search</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	"query": {</span></span>
<span class="line"><span>		"bool": {</span></span>
<span class="line"><span>			"must": {</span></span>
<span class="line"><span>				"match_all": {}</span></span>
<span class="line"><span>			},</span></span>
<span class="line"><span>			"filter": {</span></span>
<span class="line"><span>				"geo_bounding_box": {</span></span>
<span class="line"><span>					"location": {</span></span>
<span class="line"><span>						"top_left": {</span></span>
<span class="line"><span>							"lat": 38.4864400000,</span></span>
<span class="line"><span>							"lon": 106.2324800000</span></span>
<span class="line"><span>						},</span></span>
<span class="line"><span>						"bottom_right": {</span></span>
<span class="line"><span>							"lat": 28.6820200000,</span></span>
<span class="line"><span>							"lon": 115.8579400000</span></span>
<span class="line"><span>						}</span></span>
<span class="line"><span>					}</span></span>
<span class="line"><span>				}</span></span>
<span class="line"><span>			}</span></span>
<span class="line"><span>		}</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>Truy váº¥n geo_polygon</h3>
<p>Truy váº¥n geo_polygon Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ¬m kiáº¿m cÃ¡c Ä‘iá»ƒm Ä‘á»‹a lÃ½ náº±m trong má»™t Ä‘a giÃ¡c xÃ¡c Ä‘á»‹nh. VÃ­ dá»¥, Hohhot, Chongqing vÃ  ThÆ°á»£ng Háº£i táº¡o thÃ nh má»™t tam giÃ¡c, truy váº¥n cÃ¡c thÃ nh phá»‘ náº±m trong khu vá»±c tam giÃ¡c nÃ y, lá»‡nh nhÆ° sau:</p>
<div class="language- line-numbers-mode" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET geo/_search</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	"query": {</span></span>
<span class="line"><span>		"bool": {</span></span>
<span class="line"><span>			"must": {</span></span>
<span class="line"><span>				"match_all": {}</span></span>
<span class="line"><span>			}</span></span>
<span class="line"><span>		},</span></span>
<span class="line"><span>		"filter": {</span></span>
<span class="line"><span>			"geo_polygon": {</span></span>
<span class="line"><span>				"location": {</span></span>
<span class="line"><span>					"points": [{</span></span>
<span class="line"><span>						"lat": 40.8414900000,</span></span>
<span class="line"><span>						"lon": 111.7519900000</span></span>
<span class="line"><span>					}, {</span></span>
<span class="line"><span>						"lat": 29.5647100000,</span></span>
<span class="line"><span>						"lon": 106.5507300000</span></span>
<span class="line"><span>					}, {</span></span>
<span class="line"><span>						"lat": 31.2303700000,</span></span>
<span class="line"><span>						"lon": 121.4737000000</span></span>
<span class="line"><span>					}]</span></span>
<span class="line"><span>				}</span></span>
<span class="line"><span>			}</span></span>
<span class="line"><span>		}</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>Truy váº¥n geo_shape</h3>
<p>Truy váº¥n geo_shape Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ¬m kiáº¿m dá»¯ liá»‡u Ä‘á»‹a lÃ½ kiá»ƒu geo_shape, cÃ³ ba má»‘i quan há»‡ giá»¯a cÃ¡c hÃ¬nh dáº¡ng Ä‘á»‹a lÃ½ lÃ  giao nhau, chá»©a vÃ  khÃ´ng giao nhau. Táº¡o má»™t chá»‰ má»¥c má»›i Ä‘á»ƒ thá»­ nghiá»‡m, trong Ä‘Ã³ loáº¡i trÆ°á»ng location Ä‘Æ°á»£c Ä‘áº·t lÃ  geo_shape.</p>
<div class="language- line-numbers-mode" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>PUT geoshape</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	"mappings": {</span></span>
<span class="line"><span>		"city": {</span></span>
<span class="line"><span>			"properties": {</span></span>
<span class="line"><span>				"name": {</span></span>
<span class="line"><span>					"type": "keyword"</span></span>
<span class="line"><span>				},</span></span>
<span class="line"><span>				"location": {</span></span>
<span class="line"><span>					"type": "geo_shape"</span></span>
<span class="line"><span>				}</span></span>
<span class="line"><span>			}</span></span>
<span class="line"><span>		}</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Vá» thá»© tá»± kinh Ä‘á»™ vÃ  vÄ© Ä‘á»™, chÃºng ta cáº§n lÆ°u Ã½ ráº±ng, Ä‘á»‘i vá»›i trÆ°á»ng kiá»ƒu geo_point, vÄ© Ä‘á»™ Ä‘á»©ng trÆ°á»›c kinh Ä‘á»™, nhÆ°ng Ä‘á»‘i vá»›i Ä‘iá»ƒm trong kiá»ƒu geo_shape, kinh Ä‘á»™ Ä‘á»©ng trÆ°á»›c vÄ© Ä‘á»™.</p>
<p>ChÃºng ta cÃ³ thá»ƒ viáº¿t dÃ²ng káº¿t ná»‘i TÃ¢y An vÃ  Zhengzhou vÃ o chá»‰ má»¥c:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>POST geoshape/city/1</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	"name": "TÃ¢y An-Zhengzhou",</span></span>
<span class="line"><span>	"location": {</span></span>
<span class="line"><span>		"type": "linestring",</span></span>
<span class="line"><span>		"coordinates": [</span></span>
<span class="line"><span>			[108.9398400000, 34.3412700000],</span></span>
<span class="line"><span>			[113.6587142944, 34.7447157466]</span></span>
<span class="line"><span>		]</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><p>Truy váº¥n hÃ¬nh dáº¡ng Ä‘á»‹a lÃ½ náº±m trong hÃ¬nh chá»¯ nháº­t Ä‘Æ°á»£c táº¡o bá»Ÿi Yinchuan vÃ  Nanchang lÃ m cÃ¡c Ä‘iá»ƒm trÃªn Ä‘Æ°á»ng chÃ©o, vÃ¬ Ä‘Æ°á»ng tháº³ng tá»« TÃ¢y An Ä‘áº¿n Zhengzhou náº±m trong khu vá»±c hÃ¬nh chá»¯ nháº­t nÃ y, vÃ¬ váº­y nÃ³ cÃ³ thá»ƒ Ä‘Æ°á»£c truy váº¥n. Lá»‡nh nhÆ° sau:</p>
<div class="language- line-numbers-mode" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET geoshape/_search</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	"query": {</span></span>
<span class="line"><span>		"bool": {</span></span>
<span class="line"><span>			"must": {</span></span>
<span class="line"><span>				"match_all": {}</span></span>
<span class="line"><span>			},</span></span>
<span class="line"><span>			"filter": {</span></span>
<span class="line"><span>				"geo_shape": {</span></span>
<span class="line"><span>					"location": {</span></span>
<span class="line"><span>						"shape": {</span></span>
<span class="line"><span>							"type": "envelope",</span></span>
<span class="line"><span>							"coordinates": [</span></span>
<span class="line"><span>								[106.23248, 38.48644],</span></span>
<span class="line"><span>								[115.85794, 28.68202]</span></span>
<span class="line"><span>							]</span></span>
<span class="line"><span>						},</span></span>
<span class="line"><span>						"relation": "within"</span></span>
<span class="line"><span>					}</span></span>
<span class="line"><span>				}</span></span>
<span class="line"><span>			}</span></span>
<span class="line"><span>		}</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>Truy váº¥n more_like_this</h3>
<p>Truy váº¥n more_like_this cÃ³ thá»ƒ tÃ¬m kiáº¿m cÃ¡c tÃ i liá»‡u tÆ°Æ¡ng tá»± vá»›i vÄƒn báº£n cung cáº¥p, thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng trong cÃ¡c tÃ¬nh huá»‘ng nhÆ° Ä‘á» xuáº¥t vÄƒn báº£n tÆ°Æ¡ng tá»±. Lá»‡nh truy váº¥n nhÆ° sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET books/_search</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	"query": {</span></span>
<span class="line"><span>		"more_like_this": {</span></span>
<span class="line"><span>			"fields": ["title", "description"],</span></span>
<span class="line"><span>			"like": "java virtual machine",</span></span>
<span class="line"><span>			"min_term_freq": 1,</span></span>
<span class="line"><span>			"max_query_terms": 12</span></span>
<span class="line"><span>		}</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><p>CÃ¡c tham sá»‘ tÃ¹y chá»n vÃ  mÃ´ táº£ giÃ¡ trá»‹ cá»§a chÃºng nhÆ° sau:</p>
<ul>
<li>fields: cÃ¡c trÆ°á»ng cáº§n phÃ¹ há»£p, máº·c Ä‘á»‹nh lÃ  trÆ°á»ng _all.</li>
<li>like: vÄƒn báº£n cáº§n phÃ¹ há»£p.</li>
<li>min_term_freq: táº§n suáº¥t tá»‘i thiá»ƒu cá»§a cÃ¡c thuáº­t ngá»¯ trong tÃ i liá»‡u, máº·c Ä‘á»‹nh lÃ  2, cÃ¡c tÃ i liá»‡u cÃ³ táº§n suáº¥t tháº¥p hÆ¡n sáº½ bá»‹ bá» qua.</li>
<li>max_query_terms: sá»‘ lÆ°á»£ng thuáº­t ngá»¯ tá»‘i Ä‘a cÃ³ thá»ƒ cÃ³ trong truy váº¥n, máº·c Ä‘á»‹nh lÃ  25.</li>
<li>min_doc_freq: táº§n suáº¥t tÃ i liá»‡u tá»‘i thiá»ƒu, máº·c Ä‘á»‹nh lÃ  5.</li>
<li>max_doc_freq: táº§n suáº¥t tÃ i liá»‡u tá»‘i Ä‘a.</li>
<li>min_word_length: Ä‘á»™ dÃ i tá»‘i thiá»ƒu cá»§a tá»«.</li>
<li>max_word_length: Ä‘á»™ dÃ i tá»‘i Ä‘a cá»§a tá»«.</li>
<li>stop_words: danh sÃ¡ch cÃ¡c tá»« dá»«ng.</li>
<li>analyzer: bá»™ phÃ¢n tÃ­ch.</li>
<li>minimum_should_match: sá»‘ lÆ°á»£ng thuáº­t ngá»¯ tá»‘i thiá»ƒu mÃ  tÃ i liá»‡u cáº§n phÃ¹ há»£p, máº·c Ä‘á»‹nh lÃ  30% sá»‘ thuáº­t ngá»¯ sau khi phÃ¢n tÃ­ch truy váº¥n.</li>
<li>boost_terms: trá»ng sá»‘ cá»§a cÃ¡c thuáº­t ngá»¯.</li>
<li>include: liá»‡u cÃ³ nÃªn tráº£ vá» tÃ i liá»‡u Ä‘áº§u vÃ o nhÆ° má»™t káº¿t quáº£ hay khÃ´ng.</li>
<li>boost: trá»ng sá»‘ cá»§a toÃ n bá»™ truy váº¥n, máº·c Ä‘á»‹nh lÃ  1.0.</li>
</ul>
<h3>Truy váº¥n script</h3>
<p>Elasticsearch há»— trá»£ viá»‡c sá»­ dá»¥ng script Ä‘á»ƒ truy váº¥n. VÃ­ dá»¥, Ä‘á»ƒ tÃ¬m kiáº¿m cÃ¡c tÃ i liá»‡u cÃ³ giÃ¡ lá»›n hÆ¡n 180, lá»‡nh nhÆ° sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET books/_search</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  "query": {</span></span>
<span class="line"><span>    "script": {</span></span>
<span class="line"><span>      "script": {</span></span>
<span class="line"><span>        "inline": "doc['price'].value &gt; 180",</span></span>
<span class="line"><span>        "lang": "painless"</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><h3>Truy váº¥n percolate</h3>
<p>Trong háº§u háº¿t cÃ¡c trÆ°á»ng há»£p, chÃºng ta thÆ°á»ng viáº¿t tÃ i liá»‡u vÃ o Elasticsearch trÆ°á»›c, sau Ä‘Ã³ sá»­ dá»¥ng cÃ¢u lá»‡nh truy váº¥n Ä‘á»ƒ tÃ¬m kiáº¿m tÃ i liá»‡u. Truy váº¥n percolate lÃ m Ä‘iá»u ngÆ°á»£c láº¡i, nÃ³ Ä‘Äƒng kÃ½ cÃ¡c Ä‘iá»u kiá»‡n truy váº¥n trÆ°á»›c, sau Ä‘Ã³ dá»±a vÃ o tÃ i liá»‡u Ä‘á»ƒ truy váº¥n query. VÃ­ dá»¥, trong chá»‰ má»¥c my-index cÃ³ má»™t loáº¡i laptop, tÃ i liá»‡u cÃ³ hai trÆ°á»ng lÃ  price vÃ  name, trong mapping, chÃºng ta Ä‘á»‹nh nghÄ©a má»™t trÆ°á»ng percolator lÃ  query, lá»‡nh nhÆ° sau:</p>
<div class="language- line-numbers-mode" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>PUT my-index</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	"mappings": {</span></span>
<span class="line"><span>		"laptop": {</span></span>
<span class="line"><span>			"properties": {</span></span>
<span class="line"><span>				"price": { "type": "long" },</span></span>
<span class="line"><span>				"name": { "type": "text" }</span></span>
<span class="line"><span>			},</span></span>
<span class="line"><span>			"queries": {</span></span>
<span class="line"><span>				"properties": {</span></span>
<span class="line"><span>					"query": { "type": "percolator" }</span></span>
<span class="line"><span>				}</span></span>
<span class="line"><span>			}</span></span>
<span class="line"><span>		}</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ÄÄƒng kÃ½ má»™t bool query, trong Ä‘Ã³ bool query bao gá»“m má»™t range query, yÃªu cáº§u trÆ°á»ng price cÃ³ giÃ¡ trá»‹ nhá» hÆ¡n hoáº·c báº±ng 10000, vÃ  trÆ°á»ng name chá»©a tá»« khÃ³a macbook:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>PUT /my-index/queries/1?refresh</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	"query": {</span></span>
<span class="line"><span>		"bool": {</span></span>
<span class="line"><span>			"must": [{</span></span>
<span class="line"><span>				"range": { "price": { "lte": 10000 } }</span></span>
<span class="line"><span>			}, {</span></span>
<span class="line"><span>				"match": { "name": "macbook" }</span></span>
<span class="line"><span>			}]</span></span>
<span class="line"><span>		}</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><p>Truy váº¥n query dá»±a vÃ o tÃ i liá»‡u:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET /my-index/_search</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	"query": {</span></span>
<span class="line"><span>		"percolate": {</span></span>
<span class="line"><span>			"field": "query",</span></span>
<span class="line"><span>			"document_type": "laptop",</span></span>
<span class="line"><span>			"document": {</span></span>
<span class="line"><span>				"price": 9999,</span></span>
<span class="line"><span>				"name": "macbook pro on sale"</span></span>
<span class="line"><span>			}</span></span>
<span class="line"><span>		}</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span></code></pre>
</div><p>TÃ i liá»‡u phÃ¹ há»£p vá»›i Ä‘iá»u kiá»‡n trong query, káº¿t quáº£ tráº£ vá» cÃ³ thá»ƒ tÃ¬m tháº¥y bool query Ä‘Ã£ Ä‘Äƒng kÃ½ á»Ÿ trÃªn. Truy váº¥n percolate cÃ³ tÃ­nh nÄƒng nÃ y phÃ¹ há»£p vá»›i cÃ¡c tÃ¬nh huá»‘ng nhÆ° phÃ¢n loáº¡i dá»¯ liá»‡u, Ä‘á»‹nh tuyáº¿n dá»¯ liá»‡u, giÃ¡m sÃ¡t sá»± kiá»‡n vÃ  cáº£nh bÃ¡o.</p>
]]></content:encoded>
    </item>
    <item>
      <title>Elasticsearch Quick Start</title>
      <link>https://vanhung4499.github.io/database/elasticsearch/quick-start.html</link>
      <guid>https://vanhung4499.github.io/database/elasticsearch/quick-start.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Elasticsearch Quick Start</source>
      <description>Elasticsearch: Quick Start Elasticsearch lÃ  má»™t cÃ´ng cá»¥ tÃ¬m kiáº¿m vÃ  phÃ¢n tÃ­ch dá»¯ liá»‡u phÃ¢n tÃ¡n, theo phong cÃ¡ch RESTful, cÃ³ kháº£ nÄƒng giáº£i quyáº¿t nhiá»u tÃ¬nh huá»‘ng khÃ¡c nhau Ä‘ang l...</description>
      <category>elasticssearch</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p><strong><a href="https://github.com/elastic/elasticsearch" target="_blank" rel="noopener noreferrer">Elasticsearch</a>&nbsp;lÃ  má»™t cÃ´ng cá»¥ tÃ¬m kiáº¿m vÃ  phÃ¢n tÃ­ch dá»¯ liá»‡u phÃ¢n tÃ¡n, theo phong cÃ¡ch RESTful</strong>, cÃ³ kháº£ nÄƒng giáº£i quyáº¿t nhiá»u tÃ¬nh huá»‘ng khÃ¡c nhau Ä‘ang liÃªn tá»¥c xuáº¥t hiá»‡n. LÃ  trung tÃ¢m cá»§a Elastic Stack, nÃ³ lÆ°u trá»¯ dá»¯ liá»‡u cá»§a báº¡n má»™t cÃ¡ch táº­p trung, giÃºp báº¡n khÃ¡m phÃ¡ nhá»¯ng Ä‘iá»u dá»± kiáº¿n vÃ  khÃ´ng dá»± kiáº¿n.</p>
<p><a href="https://github.com/elastic/elasticsearch" target="_blank" rel="noopener noreferrer">Elasticsearch</a>&nbsp;Ä‘Æ°á»£c phÃ¡t triá»ƒn dá»±a trÃªn thÆ° viá»‡n tÃ¬m kiáº¿m&nbsp;<a href="https://github.com/apache/lucene-solr" target="_blank" rel="noopener noreferrer">Lucene</a>. Elasticsearch áº©n Ä‘i sá»± phá»©c táº¡p cá»§a Lucene vÃ  cung cáº¥p interface API REST / Java dá»… sá»­ dá»¥ng (cÅ©ng nhÆ° cÃ¡c interface API báº±ng ngÃ´n ngá»¯ khÃ¡c).</p>
<p><em>DÆ°á»›i Ä‘Ã¢y sáº½ gá»i táº¯t lÃ  ES</em>.</p>
</blockquote>
<h2>Giá»›i thiá»‡u Elasticsearch</h2>
<p><strong><a href="https://github.com/elastic/elasticsearch" target="_blank" rel="noopener noreferrer">Elasticsearch</a>&nbsp;lÃ  má»™t cÃ´ng cá»¥ tÃ¬m kiáº¿m vÃ  phÃ¢n tÃ­ch dá»¯ liá»‡u phÃ¢n tÃ¡n, theo phong cÃ¡ch RESTful</strong>, cÃ³ kháº£ nÄƒng giáº£i quyáº¿t nhiá»u tÃ¬nh huá»‘ng khÃ¡c nhau Ä‘ang liÃªn tá»¥c xuáº¥t hiá»‡n. LÃ  trung tÃ¢m cá»§a Elastic Stack, nÃ³ lÆ°u trá»¯ dá»¯ liá»‡u cá»§a báº¡n má»™t cÃ¡ch táº­p trung, giÃºp báº¡n khÃ¡m phÃ¡ nhá»¯ng Ä‘iá»u dá»± kiáº¿n vÃ  khÃ´ng dá»± kiáº¿n.</p>
<p><a href="https://github.com/elastic/elasticsearch" target="_blank" rel="noopener noreferrer">Elasticsearch</a>&nbsp;<strong>Ä‘Æ°á»£c phÃ¡t triá»ƒn dá»±a trÃªn thÆ° viá»‡n tÃ¬m kiáº¿m&nbsp;<a href="https://github.com/apache/lucene-solr" target="_blank" rel="noopener noreferrer">Lucene</a></strong>. Elasticsearch áº©n Ä‘i sá»± phá»©c táº¡p cá»§a Lucene vÃ  cung cáº¥p interface API REST / Java dá»… sá»­ dá»¥ng (cÅ©ng nhÆ° cÃ¡c interface API báº±ng ngÃ´n ngá»¯ khÃ¡c).</p>
<p>Elasticsearch cÃ³ thá»ƒ coi lÃ  má»™t kho lÆ°u trá»¯ tÃ i liá»‡u, nÃ³&nbsp;<strong>chuáº©n hÃ³a cáº¥u trÃºc dá»¯ liá»‡u phá»©c táº¡p thÃ nh JSON Ä‘á»ƒ lÆ°u trá»¯</strong>.</p>
<p><strong>Elasticsearch lÃ  má»™t cÃ´ng cá»¥ tÃ¬m kiáº¿m toÃ n vÄƒn gáº§n nhÆ° thá»i gian thá»±c</strong>, Ä‘iá»u nÃ y cÃ³ nghÄ©a lÃ :</p>
<ul>
<li>Tá»« khi ghi dá»¯ liá»‡u cho Ä‘áº¿n khi dá»¯ liá»‡u cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m kiáº¿m, cÃ³ má»™t Ä‘á»™ trá»… nhá» (khoáº£ng 1 giÃ¢y)</li>
<li>Thá»±c hiá»‡n tÃ¬m kiáº¿m vÃ  phÃ¢n tÃ­ch dá»±a trÃªn ES cÃ³ thá»ƒ Ä‘áº¡t Ä‘áº¿n má»©c giÃ¢y.</li>
</ul>
<h3>KhÃ¡i niá»‡m cá»‘t lÃµi</h3>
<p><code>index -&gt; type -&gt; mapping -&gt; document -&gt; field</code></p>
<h4>Cluster</h4>
<p>Má»™t cluster bao gá»“m nhiá»u node, má»—i node thuá»™c vá» cluster nÃ o Ä‘Æ°á»£c quyáº¿t Ä‘á»‹nh thÃ´ng qua má»™t cáº¥u hÃ¬nh. Äá»‘i vá»›i cÃ¡c á»©ng dá»¥ng vá»«a vÃ  nhá», ban Ä‘áº§u má»™t cluster chá»‰ cÃ³ má»™t node lÃ  bÃ¬nh thÆ°á»ng.</p>
<h4>Node</h4>
<p>Node lÃ  má»™t node trong cluster, má»—i node cÅ©ng cÃ³ má»™t tÃªn, máº·c Ä‘á»‹nh lÃ  Ä‘Æ°á»£c phÃ¢n bá»• ngáº«u nhiÃªn. Máº·c Ä‘á»‹nh, node sáº½ tham gia vÃ o má»™t cluster cÃ³ tÃªn lÃ &nbsp;<code>elasticsearch</code>. Náº¿u báº¡n khá»Ÿi Ä‘á»™ng má»™t loáº¡t node trá»±c tiáº¿p, chÃºng sáº½ tá»± Ä‘á»™ng hÃ¬nh thÃ nh má»™t cluster elasticsearch, táº¥t nhiÃªn má»™t node cÅ©ng cÃ³ thá»ƒ hÃ¬nh thÃ nh má»™t cluster elasticsearch.</p>
<h4>Index</h4>
<p><strong>CÃ³ thá»ƒ coi lÃ  táº­p há»£p tá»‘i Æ°u cá»§a cÃ¡c tÃ i liá»‡u (document).</strong></p>
<p>ES sáº½ xÃ¢y dá»±ng chá»‰ má»¥c cho táº¥t cáº£ cÃ¡c trÆ°á»ng, sau khi xá»­ lÃ½, nÃ³ sáº½ Ä‘Æ°á»£c ghi vÃ o má»™t chá»‰ má»¥c Ä‘áº£o ngÆ°á»£c (Inverted Index). Khi tÃ¬m kiáº¿m dá»¯ liá»‡u, chá»‰ cáº§n tÃ¬m kiáº¿m chá»‰ má»¥c nÃ y.</p>
<p>VÃ¬ váº­y, Ä‘Æ¡n vá»‹ quáº£n lÃ½ dá»¯ liá»‡u hÃ ng Ä‘áº§u cá»§a ES Ä‘Æ°á»£c gá»i lÃ  Index (chá»‰ má»¥c). NÃ³ tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘Æ¡n láº». Má»—i Index (hay cÆ¡ sá»Ÿ dá»¯ liá»‡u) pháº£i cÃ³ tÃªn viáº¿t thÆ°á»ng.</p>
<h4>Type</h4>
<p>Má»—i chá»‰ má»¥c cÃ³ thá»ƒ chá»©a má»™t hoáº·c nhiá»u loáº¡i (type).&nbsp;<code>Type</code>&nbsp;lÃ  má»™t phÃ¢n loáº¡i logic cá»§a index.</p>
<p>CÃ¡c Type khÃ¡c nhau nÃªn cÃ³ cáº¥u trÃºc (schema) tÆ°Æ¡ng tá»±, vÃ­ dá»¥, trÆ°á»ng&nbsp;<code>id</code>&nbsp;khÃ´ng thá»ƒ lÃ  chuá»—i trong má»™t nhÃ³m nÃ y, trong khi lÃ  giÃ¡ trá»‹ sá»‘ trong má»™t nhÃ³m khÃ¡c. ÄÃ¢y lÃ  má»™t&nbsp;<a href="https://www.elastic.co/guide/en/elasticsearch/guide/current/mapping.html" target="_blank" rel="noopener noreferrer">khÃ¡c biá»‡t</a>&nbsp;so vá»›i báº£ng cá»§a cÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡. Dá»¯ liá»‡u cÃ³ tÃ­nh cháº¥t hoÃ n toÃ n khÃ¡c nhau (nhÆ°&nbsp;<code>products</code>vÃ &nbsp;<code>logs</code>) nÃªn Ä‘Æ°á»£c lÆ°u trá»¯ dÆ°á»›i dáº¡ng hai Index, chá»© khÃ´ng pháº£i lÃ  hai Type trong má»™t Index (máº·c dÃ¹ cÃ³ thá»ƒ lÃ m Ä‘Æ°á»£c).</p>
<blockquote>
<p>ChÃº Ã½: Theo&nbsp;<a href="https://www.elastic.co/blog/index-type-parent-child-join-now-future-in-elasticsearch" target="_blank" rel="noopener noreferrer">káº¿ hoáº¡ch</a>, phiÃªn báº£n Elastic 6.x chá»‰ cho phÃ©p má»—i Index chá»©a má»™t Type, phiÃªn báº£n 7.x sáº½ hoÃ n toÃ n loáº¡i bá» Type.</p>
</blockquote>
<h4>Document</h4>
<p>Trong má»—i Index, má»—i báº£n ghi Ä‘Æ°á»£c gá»i lÃ  Document. Nhiá»u Document táº¡o nÃªn má»™t Index.</p>
<p>Má»—i&nbsp;<strong><code>tÃ i liá»‡u (document)</code></strong>&nbsp;lÃ  má»™t táº­p há»£p cÃ¡c trÆ°á»ng (field).</p>
<p>Document sá»­ dá»¥ng Ä‘á»‹nh dáº¡ng JSON, dÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥.</p>
<div class="language-json" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">	"user"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Hung Nguyen"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">	"title"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Engineer"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">	"desc"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Database management"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><p>CÃ¡c Document trong cÃ¹ng má»™t Index khÃ´ng yÃªu cáº§u cÃ³ cáº¥u trÃºc (scheme) giá»‘ng nhau, nhÆ°ng tá»‘t nháº¥t nÃªn giá»¯ giá»‘ng nhau, Ä‘iá»u nÃ y cÃ³ lá»£i cho viá»‡c cáº£i thiá»‡n hiá»‡u suáº¥t tÃ¬m kiáº¿m.</p>
<h4>Field</h4>
<p><strong><code>TrÆ°á»ng (field)</code></strong>&nbsp;lÃ  cáº·p khÃ³a-giÃ¡ trá»‹ chá»©a dá»¯ liá»‡u.</p>
<p>Theo máº·c Ä‘á»‹nh, Elasticsearch xÃ¢y dá»±ng chá»‰ má»¥c cho táº¥t cáº£ dá»¯ liá»‡u trong má»—i trÆ°á»ng, vÃ  má»—i trÆ°á»ng chá»‰ má»¥c cÃ³ cáº¥u trÃºc dá»¯ liá»‡u tá»‘i Æ°u riÃªng.</p>
<h4>Shard</h4>
<p>Khi má»™t mÃ¡y duy nháº¥t khÃ´ng Ä‘á»§ Ä‘á»ƒ lÆ°u trá»¯ lÆ°á»£ng dá»¯ liá»‡u lá»›n, Elasticsearch cÃ³ thá»ƒ chia dá»¯ liá»‡u trong má»™t chá»‰ má»¥c thÃ nh nhiá»u&nbsp;<strong><code>shard</code></strong>.&nbsp;<strong><code>Shard</code></strong>&nbsp;Ä‘Æ°á»£c lÆ°u trá»¯ trÃªn nhiá»u mÃ¡y chá»§. Vá»›i shard, báº¡n cÃ³ thá»ƒ má»Ÿ rá»™ng theo chiá»u ngang, lÆ°u trá»¯ nhiá»u dá»¯ liá»‡u hÆ¡n, cho phÃ©p cÃ¡c hoáº¡t Ä‘á»™ng tÃ¬m kiáº¿m vÃ  phÃ¢n tÃ­ch Ä‘Æ°á»£c phÃ¢n phá»‘i trÃªn nhiá»u mÃ¡y chá»§, cáº£i thiá»‡n throughput vÃ  hiá»‡u suáº¥t. Má»—i shard Ä‘á»u lÃ  má»™t chá»‰ má»¥c lucene.</p>
<h4>Replica</h4>
<p>Báº¥t ká»³ mÃ¡y chá»§ nÃ o cÅ©ng cÃ³ thá»ƒ gáº·p sá»± cá»‘ hoáº·c ngá»«ng hoáº¡t Ä‘á»™ng báº¥t cá»© lÃºc nÃ o, lÃºc nÃ y shard cÃ³ thá»ƒ bá»‹ máº¥t, do Ä‘Ã³, báº¡n cÃ³ thá»ƒ táº¡o nhiá»u&nbsp;<strong><code>báº£n sao (replica)</code></strong>&nbsp;cho má»—i shard. Báº£n sao cÃ³ thá»ƒ cung cáº¥p dá»‹ch vá»¥ dá»± phÃ²ng khi shard gáº·p sá»± cá»‘, Ä‘áº£m báº£o dá»¯ liá»‡u khÃ´ng bá»‹ máº¥t, nhiá»u báº£n sao cÃ²n cÃ³ thá»ƒ cáº£i thiá»‡n throughput vÃ  hiá»‡u suáº¥t cá»§a hoáº¡t Ä‘á»™ng tÃ¬m kiáº¿m. Shard chÃ­nh (Ä‘Æ°á»£c thiáº¿t láº­p má»™t láº§n khi táº¡o chá»‰ má»¥c, khÃ´ng thá»ƒ sá»­a Ä‘á»•i, máº·c Ä‘á»‹nh lÃ  5), shard báº£n sao (sá»‘ lÆ°á»£ng cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­a Ä‘á»•i báº¥t cá»© lÃºc nÃ o, máº·c Ä‘á»‹nh lÃ  1), máº·c Ä‘á»‹nh má»—i chá»‰ má»¥c cÃ³ 10 shard, 5 shard chÃ­nh, 5 shard báº£n sao, cáº¥u hÃ¬nh cao cÃ³ sáºµn tá»‘i thiá»ƒu, lÃ  2 mÃ¡y chá»§.</p>
<h4>ES - KhÃ¡i niá»‡m cá»‘t lÃµi vs. DB - KhÃ¡i niá»‡m cá»‘t lÃµi</h4>
<p>| ES       | DB               |<br>
|</p>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240223094001.png" type="image/png"/>
    </item>
    <item>
      <title>Elasticsearch REST API</title>
      <link>https://vanhung4499.github.io/database/elasticsearch/rest-api.html</link>
      <guid>https://vanhung4499.github.io/database/elasticsearch/rest-api.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Elasticsearch REST API</source>
      <description>Elasticsearch Rest API Elasticsearch lÃ  má»™t cÃ´ng cá»¥ tÃ¬m kiáº¿m vÃ  phÃ¢n tÃ­ch dá»¯ liá»‡u phÃ¢n tÃ¡n, theo phong cÃ¡ch RESTful, cÃ³ kháº£ nÄƒng giáº£i quyáº¿t nhiá»u tÃ¬nh huá»‘ng sá»­ dá»¥ng má»›i xuáº¥t hiá»‡...</description>
      <category>elasticssearch</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p><strong><a href="https://github.com/elastic/elasticsearch" target="_blank" rel="noopener noreferrer">Elasticsearch</a> lÃ  má»™t cÃ´ng cá»¥ tÃ¬m kiáº¿m vÃ  phÃ¢n tÃ­ch dá»¯ liá»‡u phÃ¢n tÃ¡n, theo phong cÃ¡ch RESTful</strong>, cÃ³ kháº£ nÄƒng giáº£i quyáº¿t nhiá»u tÃ¬nh huá»‘ng sá»­ dá»¥ng má»›i xuáº¥t hiá»‡n. LÃ  trung tÃ¢m cá»§a Elastic Stack, nÃ³ lÆ°u trá»¯ dá»¯ liá»‡u táº­p trung cá»§a báº¡n, giÃºp báº¡n phÃ¡t hiá»‡n nhá»¯ng sá»± kiá»‡n dá»± kiáº¿n vÃ  khÃ´ng dá»± kiáº¿n.</p>
<p><a href="https://github.com/elastic/elasticsearch" target="_blank" rel="noopener noreferrer">Elasticsearch</a> Ä‘Æ°á»£c phÃ¡t triá»ƒn dá»±a trÃªn thÆ° viá»‡n tÃ¬m kiáº¿m <a href="https://github.com/apache/lucene-solr" target="_blank" rel="noopener noreferrer">Lucene</a>. Elasticsearch áº©n Ä‘i sá»± phá»©c táº¡p cá»§a Lucene, cung cáº¥p giao diá»‡n API REST / Java dá»… sá»­ dá»¥ng (ngoÃ i ra cÃ²n cÃ³ cÃ¡c giao diá»‡n API báº±ng ngÃ´n ngá»¯ khÃ¡c).</p>
<p><em>DÆ°á»›i Ä‘Ã¢y gá»i táº¯t lÃ  ES</em>.</p>
<p>TÃ i liá»‡u chi tiáº¿t nháº¥t vá» REST API nÃªn tham kháº£o: <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/rest-apis.html" target="_blank" rel="noopener noreferrer">ES Official REST API</a></p>
</blockquote>
<h2>CÃº phÃ¡p ElasticSearch Rest API</h2>
<p>CÃ¡c pháº§n thÃ nh pháº§n cá»§a yÃªu cáº§u gá»­i Ä‘áº¿n Elasticsearch giá»‘ng nhÆ° cÃ¡c yÃªu cáº§u HTTP thÃ´ng thÆ°á»ng khÃ¡c:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">curl</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -X</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&lt;</span><span style="color:#D19A66;--shiki-dark:#D19A66">VERB</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&gt;</span><span style="color:#98C379;--shiki-dark:#98C379"> '&lt;PROTOCOL&gt;://&lt;HOST&gt;:&lt;PORT&gt;/&lt;PATH&gt;?&lt;QUERY_STRING&gt;'</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -d</span><span style="color:#98C379;--shiki-dark:#98C379"> '&lt;BODY&gt;'</span></span></code></pre>
</div><ul>
<li><code>VERB</code>ï¼šPhÆ°Æ¡ng thá»©c HTTP, há»— trá»£: <code>GET</code>, <code>POST</code>, <code>PUT</code>, <code>HEAD</code>, <code>DELETE</code></li>
<li><code>PROTOCOL</code>ï¼šgiao thá»©c http hoáº·c https (chá»‰ cÃ³ thá»ƒ sá»­ dá»¥ng khi cÃ³ proxy https phÃ­a trÆ°á»›c Elasticsearch)</li>
<li><code>HOST</code>ï¼štÃªn mÃ¡y chá»§ cá»§a báº¥t ká»³ nÃºt nÃ o trong cá»¥m Elasticsearch, náº¿u lÃ  nÃºt trÃªn mÃ¡y cá»¥c bá»™, thÃ¬ gá»i lÃ  localhost</li>
<li><code>PORT</code>ï¼šcá»•ng dá»‹ch vá»¥ HTTP cá»§a Elasticsearch, máº·c Ä‘á»‹nh lÃ  9200</li>
<li><code>PATH</code>ï¼šÄ‘Æ°á»ng dáº«n API (vÃ­ dá»¥: <code>_count</code> sáº½ tráº£ vá» sá»‘ lÆ°á»£ng tÃ i liá»‡u trong cá»¥m),</li>
<li><code>PATH</code>ï¼šcÃ³ thá»ƒ chá»©a nhiá»u thÃ nh pháº§n, vÃ­ dá»¥ <code>_cluster/stats</code> hoáº·c <code>_nodes/stats/jvm</code></li>
<li><code>QUERY_STRING</code>ï¼šmá»™t sá»‘ tham sá»‘ truy váº¥n tÃ¹y chá»n, vÃ­ dá»¥ tham sá»‘ ?pretty sáº½ lÃ m cho yÃªu cáº§u tráº£ vá» dá»¯ liá»‡u JSON dá»… Ä‘á»c hÆ¡n</li>
<li><code>BODY</code>ï¼šmá»™t cÆ¡ thá»ƒ yÃªu cáº§u á»Ÿ Ä‘á»‹nh dáº¡ng JSON (náº¿u yÃªu cáº§u cáº§n)</li>
</ul>
<p>ElasticSearch Rest API Ä‘Æ°á»£c chia thÃ nh hai loáº¡i:</p>
<ul>
<li><strong>URI Search</strong>ï¼šsá»­ dá»¥ng tham sá»‘ truy váº¥n trong URL</li>
<li><strong>Request Body Search</strong>ï¼šdá»±a trÃªn DSL Ä‘á»‹nh dáº¡ng JSON, hoÃ n chá»‰nh hÆ¡n</li>
</ul>
<p>VÃ­ dá»¥ vá» URI Search:</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20220530072511.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<p>VÃ­ dá»¥ vá» Request Body Search:</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20220530072654.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<h2>Index API</h2>
<blockquote>
<p>TÃ i liá»‡u tham kháº£o: <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/cat-indices.html" target="_blank" rel="noopener noreferrer">Elasticsearch Official cat Index API</a></p>
</blockquote>
<h3>Táº¡o chá»‰ má»¥c</h3>
<p>Äá»ƒ táº¡o má»›i Index, báº¡n cÃ³ thá»ƒ gá»­i trá»±c tiáº¿p yÃªu cáº§u <code>PUT</code> Ä‘áº¿n mÃ¡y chá»§ ES.</p>
<p>CÃº phÃ¡p:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> /my_index</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "settings"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> ...</span><span style="color:#98C379;--shiki-dark:#98C379"> any</span><span style="color:#98C379;--shiki-dark:#98C379"> settings</span><span style="color:#98C379;--shiki-dark:#98C379"> ...</span><span style="color:#98C379;--shiki-dark:#98C379"> },</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "mappings"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "type_one"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> ...</span><span style="color:#98C379;--shiki-dark:#98C379"> any</span><span style="color:#98C379;--shiki-dark:#98C379"> mappings</span><span style="color:#98C379;--shiki-dark:#98C379"> ...</span><span style="color:#98C379;--shiki-dark:#98C379"> },</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "type_two"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> ...</span><span style="color:#98C379;--shiki-dark:#98C379"> any</span><span style="color:#98C379;--shiki-dark:#98C379"> mappings</span><span style="color:#98C379;--shiki-dark:#98C379"> ...</span><span style="color:#98C379;--shiki-dark:#98C379"> },</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2">        ...</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><p>VÃ­ dá»¥:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> /user</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "settings"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "index"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "number_of_shards"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> 3,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "number_of_replicas"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 2</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><p>MÃ¡y chá»§ tráº£ vá» má»™t Ä‘á»‘i tÆ°á»£ng JSON, trong Ä‘Ã³ trÆ°á»ng <code>acknowledged</code> biá»ƒu thá»‹ hoáº¡t Ä‘á»™ng thÃ nh cÃ´ng.</p>
<div class="language-javascript" data-ext="javascript" data-title="javascript"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span><span style="color:#98C379;--shiki-dark:#98C379">"acknowledged"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span><span style="color:#D19A66;--shiki-dark:#D19A66">true</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#98C379;--shiki-dark:#98C379">"shards_acknowledged"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span><span style="color:#D19A66;--shiki-dark:#D19A66">true</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#98C379;--shiki-dark:#98C379">"index"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span><span style="color:#98C379;--shiki-dark:#98C379">"user"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><p>Náº¿u báº¡n muá»‘n vÃ´ hiá»‡u hÃ³a viá»‡c táº¡o tá»± Ä‘á»™ng chá»‰ má»¥c, báº¡n cÃ³ thá»ƒ thÃªm cáº¥u hÃ¬nh sau vÃ o <code>config/elasticsearch.yml</code> trong má»—i nÃºt:</p>
<div class="language-js" data-ext="js" data-title="js"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">action</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#E06C75;--shiki-dark:#E06C75">auto_create_index</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">false</span></span></code></pre>
</div><h3>XÃ³a chá»‰ má»¥c</h3>
<p>Tiáº¿p theo, chÃºng ta cÃ³ thá»ƒ gá»­i yÃªu cáº§u <code>DELETE</code> Ä‘á»ƒ xÃ³a chá»‰ má»¥c nÃ y.</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">DELETE</span><span style="color:#98C379;--shiki-dark:#98C379"> /user</span></span></code></pre>
</div><p>XÃ³a nhiá»u chá»‰ má»¥c</p>
<div class="language-js" data-ext="js" data-title="js"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">DELETE</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> /</span><span style="color:#E06C75;--shiki-dark:#E06C75">index_one</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#E06C75;--shiki-dark:#E06C75">index_two</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">DELETE</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> /</span><span style="color:#E06C75;--shiki-dark:#E06C75">index_</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">*</span></span></code></pre>
</div><h3>Xem chá»‰ má»¥c</h3>
<p>Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng yÃªu cáº§u GET Ä‘á»ƒ xem thÃ´ng tin vá» chá»‰ má»¥c</p>
<div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Xem thÃ´ng tin liÃªn quan Ä‘áº¿n chá»‰ má»¥c</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> kibana_sample_data_ecommerce</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Xem tá»•ng sá»‘ tÃ i liá»‡u trong chá»‰ má»¥c</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> kibana_sample_data_ecommerce/_count</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Xem 10 tÃ i liá»‡u Ä‘áº§u tiÃªn Ä‘á»ƒ hiá»ƒu Ä‘á»‹nh dáº¡ng tÃ i liá»‡u</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> kibana_sample_data_ecommerce/_search</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># _cat indices API</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Xem cÃ¡c chá»‰ má»¥c</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_cat/indices/kibana</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">*</span><span style="color:#98C379;--shiki-dark:#98C379">?v</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&amp;</span><span style="color:#E06C75;--shiki-dark:#E06C75">s</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379">index</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Xem chá»‰ má»¥c cÃ³ tráº¡ng thÃ¡i lÃ  xanh</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_cat/indices?v</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&amp;</span><span style="color:#E06C75;--shiki-dark:#E06C75">health</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379">green</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Sáº¯p xáº¿p theo sá»‘ lÆ°á»£ng tÃ i liá»‡u</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_cat/indices?v</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&amp;</span><span style="color:#E06C75;--shiki-dark:#E06C75">s</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379">docs.count:desc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Xem cÃ¡c trÆ°á»ng cá»¥ thá»ƒ</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_cat/indices/kibana</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">*</span><span style="color:#98C379;--shiki-dark:#98C379">?pri</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&amp;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">v</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&amp;</span><span style="color:#E06C75;--shiki-dark:#E06C75">h</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379">health,index,pri,rep,docs.count,mt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Xem bá»™ nhá»› mÃ  chá»‰ má»¥c sá»­ dá»¥ng</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_cat/indices?v</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&amp;</span><span style="color:#E06C75;--shiki-dark:#E06C75">h</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379">i,tm</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&amp;</span><span style="color:#E06C75;--shiki-dark:#E06C75">s</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379">tm:desc</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>BÃ­ danh chá»‰ má»¥c</h3>
<p>BÃ­ danh chá»‰ má»¥c trong ES chÃ­nh lÃ  tÃªn khÃ¡c mÃ  báº¡n Ä‘áº·t cho má»™t hoáº·c nhiá»u chá»‰ má»¥c. Má»™t á»©ng dá»¥ng Ä‘iá»ƒn hÃ¬nh lÃ  viá»‡c chuyá»ƒn mÆ°á»£t mÃ  giá»¯a cÃ¡c chá»‰ má»¥c.</p>
<p>Äáº§u tiÃªn, táº¡o chá»‰ má»¥c my_index, sau Ä‘Ã³ Ä‘áº·t bÃ­ danh my_alias cho nÃ³, vÃ­ dá»¥ nhÆ° sau:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> /my_index</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> /my_index/_alias/my_alias</span></span></code></pre>
</div><p>Báº¡n cÅ©ng cÃ³ thá»ƒ thá»±c hiá»‡n nhÆ° sau:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> /_aliases</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "actions"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    { </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"add"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "index":</span><span style="color:#98C379;--shiki-dark:#98C379"> "my_index",</span><span style="color:#98C379;--shiki-dark:#98C379"> "alias":</span><span style="color:#98C379;--shiki-dark:#98C379"> "my_alias"</span><span style="color:#98C379;--shiki-dark:#98C379"> }}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  ]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><p>Báº¡n cÅ©ng cÃ³ thá»ƒ trong má»™t yÃªu cáº§u thÃªm vÃ  xÃ³a bÃ­ danh:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> /_aliases</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "actions"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    { </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"remove"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "index":</span><span style="color:#98C379;--shiki-dark:#98C379"> "my_index",</span><span style="color:#98C379;--shiki-dark:#98C379"> "alias":</span><span style="color:#98C379;--shiki-dark:#98C379"> "my_alias"</span><span style="color:#98C379;--shiki-dark:#98C379"> }}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    { </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"add"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "index":</span><span style="color:#98C379;--shiki-dark:#98C379"> "my_index_v2",</span><span style="color:#98C379;--shiki-dark:#98C379"> "alias":</span><span style="color:#98C379;--shiki-dark:#98C379"> "my_alias"</span><span style="color:#98C379;--shiki-dark:#98C379"> }}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  ]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><blockquote>
<p>Äiá»u cáº§n lÆ°u Ã½ lÃ  náº¿u bÃ­ danh vÃ  chá»‰ má»¥c lÃ  má»™t-Ä‘á»‘i-má»™t, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng bÃ­ danh Ä‘á»ƒ láº­p chá»‰ má»¥c hoáº·c truy váº¥n tÃ i liá»‡u. Tuy nhiÃªn, náº¿u bÃ­ danh vÃ  chá»‰ má»¥c lÃ  má»™t-Ä‘á»‘i-nhiá»u, viá»‡c sá»­ dá»¥ng bÃ­ danh sáº½ gÃ¢y ra lá»—i, vÃ¬ ES khÃ´ng biáº¿t nÃªn viáº¿t tÃ i liá»‡u vÃ o chá»‰ má»¥c nÃ o hoáº·c Ä‘á»c tÃ i liá»‡u tá»« chá»‰ má»¥c nÃ o.</p>
</blockquote>
<p>Má»™t á»©ng dá»¥ng Ä‘iá»ƒn hÃ¬nh cá»§a bÃ­ danh chá»‰ má»¥c ES lÃ  viá»‡c chuyá»ƒn mÆ°á»£t mÃ  giá»¯a cÃ¡c chá»‰ má»¥c. Äá»ƒ biáº¿t thÃªm chi tiáº¿t, báº¡n cÃ³ thá»ƒ xem <a href="https://www.knowledgedict.com/tutorial/elasticsearch-index-smooth-shift.html" target="_blank" rel="noopener noreferrer">PhÆ°Æ¡ng phÃ¡p chuyá»ƒn mÆ°á»£t mÃ  giá»¯a cÃ¡c chá»‰ má»¥c Elasticsearch (ES) mÃ  khÃ´ng cáº§n táº¯t mÃ¡y (khÃ´ng cáº§n khá»Ÿi Ä‘á»™ng láº¡i)</a>.</p>
<h3>Má»Ÿ/ÄÃ³ng chá»‰ má»¥c</h3>
<p>Báº±ng cÃ¡ch thÃªm <code>_close</code> hoáº·c <code>_open</code> vÃ o <code>POST</code>, báº¡n cÃ³ thá»ƒ má»Ÿ hoáº·c Ä‘Ã³ng chá»‰ má»¥c.</p>
<p>Má»Ÿ chá»‰ má»¥c</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Má»Ÿ chá»‰ má»¥c</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> kibana_sample_data_ecommerce/_open</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># ÄÃ³ng chá»‰ má»¥c</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> kibana_sample_data_ecommerce/_close</span></span></code></pre>
</div><h2>TÃ i liá»‡u</h2>
<div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">############Create Document############</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">#create document. _id is automatically generated</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> users/_doc</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">	"user"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "Mike",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "post_date"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "2019-04-15T14:12:12",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "message"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "trying out Kibana"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">#create document. Specify Id. If id already exists, an error is returned</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> users/_doc/1?op_type=create</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "user"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "Jack",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "post_date"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "2019-05-15T14:12:12",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "message"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "trying out Elasticsearch"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">#create document. Specify ID. If it already exists, an error is returned</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> users/_create/1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">     "user"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "Jack",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "post_date"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "2019-05-15T14:12:12",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "message"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "trying out Elasticsearch"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">### Get Document by ID</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">#Get the document by ID</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> users/_doc/1</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">###  Index &amp; Update</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">#Update specified ID  (delete first, then write)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> users/_doc/1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> users/_doc/1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">	"user"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "Mike"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">#GET users/_doc/1</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">#Add fields to the original document</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> users/_update/1/</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "doc"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "post_date"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "2019-05-15T14:12:12",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "message"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "trying out Elasticsearch"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">### Delete by Id</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Delete document</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">DELETE</span><span style="color:#98C379;--shiki-dark:#98C379"> users/_doc/1</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">### Bulk Operations</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">#Execute twice, check the result each time</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">#Execute the first time</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> _bulk</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"index"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "_index"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "test",</span><span style="color:#98C379;--shiki-dark:#98C379"> "_id"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "1"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"field1"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "value1"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"delete"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "_index"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "test",</span><span style="color:#98C379;--shiki-dark:#98C379"> "_id"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "2"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"create"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "_index"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "test2",</span><span style="color:#98C379;--shiki-dark:#98C379"> "_id"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "3"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"field1"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "value3"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"update"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {"_id"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "1",</span><span style="color:#98C379;--shiki-dark:#98C379"> "_index"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "test"}</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"doc"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {"field2"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "value2"}</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">#Execute the second time</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> _bulk</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"index"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "_index"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "test",</span><span style="color:#98C379;--shiki-dark:#98C379"> "_id"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "1"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"field1"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "value1"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"delete"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "_index"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "test",</span><span style="color:#98C379;--shiki-dark:#98C379"> "_id"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "2"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"create"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "_index"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "test2",</span><span style="color:#98C379;--shiki-dark:#98C379"> "_id"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "3"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"field1"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "value3"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"update"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {"_id"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "1",</span><span style="color:#98C379;--shiki-dark:#98C379"> "_index"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "test"}</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"doc"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {"field2"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "value2"}</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">### mget Operations</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_mget</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "docs"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_index"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "test",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_id"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "1"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_index"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "test",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_id"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "2"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    ]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">#Specify index in URI</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /test/_mget</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "docs"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_id"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "1"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_id"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "2"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    ]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_mget</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "docs"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_index"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "test",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_id"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "1",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_source"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#D19A66;--shiki-dark:#D19A66"> false</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_index"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "test",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_id"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "2",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_source"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span><span style="color:#98C379;--shiki-dark:#98C379">"field3"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">"field4"]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_index"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "test",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_id"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "3",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_source"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">                "include"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span><span style="color:#98C379;--shiki-dark:#98C379">"user"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">],</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">                "exclude"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span><span style="color:#98C379;--shiki-dark:#98C379">"user.location"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">            }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    ]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">### msearch Operations</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> kibana_sample_data_ecommerce/_msearch</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"query"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {"match_all"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {}},"size":1}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"index"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "kibana_sample_data_flights"}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"query"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {"match_all"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {}},"size":2}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">### Clear Test Data</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">#Clear data</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">DELETE</span><span style="color:#98C379;--shiki-dark:#98C379"> users</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">DELETE</span><span style="color:#98C379;--shiki-dark:#98C379"> test</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">DELETE</span><span style="color:#98C379;--shiki-dark:#98C379"> test2</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>Táº¡o tÃ i liá»‡u</h3>
<h4>XÃ¡c Ä‘á»‹nh ID</h4>
<p>Äá»‹nh dáº¡ng cÃº phÃ¡p:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> /_index/_type/_create/_id</span></span></code></pre>
</div><p>VÃ­ dá»¥:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> /user/_doc/_create/1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "user"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "TrÆ°Æ¡ng Tam",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "title"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "Ká»¹ sÆ°",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "desc"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "Quáº£n lÃ½ cÆ¡ sá»Ÿ dá»¯ liá»‡u"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><blockquote>
<p>LÆ°u Ã½: XÃ¡c Ä‘á»‹nh Id, náº¿u id Ä‘Ã£ tá»“n táº¡i, sáº½ bÃ¡o lá»—i</p>
</blockquote>
<h4>Tá»± Ä‘á»™ng táº¡o ID</h4>
<p>Khi thÃªm báº£n ghi má»›i, báº¡n cÅ©ng cÃ³ thá»ƒ khÃ´ng xÃ¡c Ä‘á»‹nh Id, lÃºc nÃ y báº¡n cáº§n thay Ä‘á»•i yÃªu cáº§u thÃ nh POST.</p>
<p>Äá»‹nh dáº¡ng cÃº phÃ¡p:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> /_index/_type</span></span></code></pre>
</div><p>VÃ­ dá»¥:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> /user/_doc</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "user"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "TrÆ°Æ¡ng Tam",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "title"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "Ká»¹ sÆ°",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "desc"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "Quáº£n trá»‹ viÃªn siÃªu cáº¥p"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h3>XÃ³a tÃ i liá»‡u</h3>
<p>Äá»‹nh dáº¡ng cÃº phÃ¡p:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">DELETE</span><span style="color:#98C379;--shiki-dark:#98C379"> /_index/_doc/_id</span></span></code></pre>
</div><p>VÃ­ dá»¥:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">DELETE</span><span style="color:#98C379;--shiki-dark:#98C379"> /user/_doc/1</span></span></code></pre>
</div><h3>Cáº­p nháº­t tÃ i liá»‡u</h3>
<h4>XÃ³a trÆ°á»›c, sau Ä‘Ã³ viáº¿t vÃ o</h4>
<p>Äá»‹nh dáº¡ng cÃº phÃ¡p:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> /_index/_type/_id</span></span></code></pre>
</div><p>VÃ­ dá»¥:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PUT</span><span style="color:#98C379;--shiki-dark:#98C379"> /user/_doc/1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "user"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "LÃ½ Tá»©",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "title"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "Ká»¹ sÆ°",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "desc"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "Quáº£n trá»‹ viÃªn siÃªu cáº¥p"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h4>ThÃªm trÆ°á»ng vÃ o tÃ i liá»‡u gá»‘c</h4>
<p>Äá»‹nh dáº¡ng cÃº phÃ¡p:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> /_index/_update/_id</span></span></code></pre>
</div><p>VÃ­ dá»¥:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> /user/_update/1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "doc"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "age"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "30"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h3>Truy váº¥n tÃ i liá»‡u</h3>
<h4>Truy váº¥n theo ID cá»¥ thá»ƒ</h4>
<p>Äá»‹nh dáº¡ng cÃº phÃ¡p:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>GET /_index/_type/_id</span></span></code></pre>
</div><p>VÃ­ dá»¥:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /user/_doc/1</span></span></code></pre>
</div><p>Káº¿t quáº£:</p>
<div class="language-json" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "_index"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"user"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "_type"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"_doc"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"1"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "_version"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "_seq_no"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">536248</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "_primary_term"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "found"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">true</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "_source"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "user"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"TrÆ°Æ¡ng Tam"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "title"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Ká»¹ sÆ°"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "desc"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Quáº£n lÃ½ cÆ¡ sá»Ÿ dá»¯ liá»‡u"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><p>Trong dá»¯ liá»‡u tráº£ vá», trÆ°á»ng <code>found</code> biá»ƒu thá»‹ truy váº¥n thÃ nh cÃ´ng, trÆ°á»ng <code>_source</code> tráº£ vá» báº£n gá»‘c cá»§a báº£n ghi.</p>
<p>Náº¿u id khÃ´ng chÃ­nh xÃ¡c, dá»¯ liá»‡u sáº½ khÃ´ng Ä‘Æ°á»£c tÃ¬m tháº¥y, vÃ  trÆ°á»ng <code>found</code> sáº½ lÃ  <code>false</code></p>
<h4>Truy váº¥n táº¥t cáº£ cÃ¡c báº£n ghi</h4>
<p>Sá»­ dá»¥ng phÆ°Æ¡ng thá»©c <code>GET</code>, yÃªu cáº§u trá»±c tiáº¿p Ä‘áº¿n <code>/index/type/_search</code>, táº¥t cáº£ cÃ¡c báº£n ghi sáº½ Ä‘Æ°á»£c tráº£ vá».</p>
<div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">$</span><span style="color:#98C379;--shiki-dark:#98C379"> curl</span><span style="color:#98C379;--shiki-dark:#98C379"> 'localhost:9200/user/admin/_search?pretty'</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "took"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> 1,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "timed_out"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#D19A66;--shiki-dark:#D19A66"> false</span><span style="color:#98C379;--shiki-dark:#98C379">,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "_shards"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "total"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> 3,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "successful"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> 3,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "skipped"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> 0,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "failed"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 0</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  },</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "hits"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "total"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> 2,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "max_score"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> 1.0,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "hits"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "_index"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "user",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "_type"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "admin",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "_id"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "WWuoDG8BHwECs7SiYn93",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "_score"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> 1.0,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "_source"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">          "user"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "LÃ½ Tá»©",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">          "title"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "Ká»¹ sÆ°",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">          "desc"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "Quáº£n lÃ½ há»‡ thá»‘ng"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "_index"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "user",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "_type"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "admin",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "_id"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "1",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "_score"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> 1.0,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "_source"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">          "user"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "TrÆ°Æ¡ng Tam",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">          "title"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "Ká»¹ sÆ°",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">          "desc"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "Quáº£n trá»‹ viÃªn siÃªu cáº¥p"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    ]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Trong káº¿t quáº£ tráº£ vá» á»Ÿ trÃªn, trÆ°á»ng <code>took</code> biá»ƒu thá»‹ thá»i gian tiÃªu tá»‘n cho thao tÃ¡c nÃ y (Ä‘Æ¡n vá»‹ lÃ  mili giÃ¢y), trÆ°á»ng <code>timed_out</code> biá»ƒu thá»‹ liá»‡u cÃ³ quÃ¡ thá»i gian hay khÃ´ng, trÆ°á»ng <code>hits</code> biá»ƒu thá»‹ cÃ¡c báº£n ghi Ä‘Ã£ truy váº¥n Ä‘Æ°á»£c, trong Ä‘Ã³ cÃ¡c trÆ°á»ng con cÃ³ Ã½ nghÄ©a nhÆ° sau.</p>
<ul>
<li><code>total</code>: sá»‘ lÆ°á»£ng báº£n ghi tráº£ vá», trong trÆ°á»ng há»£p nÃ y lÃ  2.</li>
<li><code>max_score</code>: má»©c Ä‘á»™ khá»›p cao nháº¥t, trong trÆ°á»ng há»£p nÃ y lÃ  <code>1.0</code>.</li>
<li><code>hits</code>: máº£ng cÃ¡c báº£n ghi tráº£ vá».</li>
</ul>
<p>Trong cÃ¡c báº£n ghi tráº£ vá», má»—i báº£n ghi Ä‘á»u cÃ³ má»™t trÆ°á»ng <code>_score</code>, biá»ƒu thá»‹ má»©c Ä‘á»™ khá»›p, máº·c Ä‘á»‹nh lÃ  Ä‘Æ°á»£c sáº¯p xáº¿p theo trÆ°á»ng nÃ y theo thá»© tá»± giáº£m dáº§n.</p>
<h3>TÃ¬m kiáº¿m toÃ n vÄƒn</h3>
<p>ES sá»­ dá»¥ng <a href="https://www.elastic.co/guide/en/elasticsearch/reference/5.5/query-dsl.html" target="_blank" rel="noopener noreferrer">cÃº phÃ¡p truy váº¥n</a> Ä‘á»™c Ä‘Ã¡o cá»§a chÃ­nh nÃ³, yÃªu cáº§u cÃ¡c yÃªu cáº§u GET Ä‘i kÃ¨m vá»›i dá»¯ liá»‡u.</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">$</span><span style="color:#98C379;--shiki-dark:#98C379"> curl</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -H</span><span style="color:#98C379;--shiki-dark:#98C379"> 'Content-Type: application/json'</span><span style="color:#98C379;--shiki-dark:#98C379"> 'localhost:9200/user/admin/_search?pretty'</span><span style="color:#D19A66;--shiki-dark:#D19A66">  -d</span><span style="color:#98C379;--shiki-dark:#98C379"> '</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">{</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">"query" : { "match" : { "desc" : "quáº£n lÃ½" }}</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">}'</span></span></code></pre>
</div><p>Äoáº¡n mÃ£ trÃªn sá»­ dá»¥ng <a href="https://www.elastic.co/guide/en/elasticsearch/reference/5.5/query-dsl-match-query.html" target="_blank" rel="noopener noreferrer">Match Query</a>, vá»›i Ä‘iá»u kiá»‡n khá»›p Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh lÃ  trÆ°á»ng <code>desc</code> chá»©a tá»« "quáº£n lÃ½". Káº¿t quáº£ tráº£ vá» nhÆ° sau.</p>
<div class="language-javascript line-numbers-mode" data-ext="javascript" data-title="javascript"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">  "took"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#D19A66;--shiki-dark:#D19A66">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">  "timed_out"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#D19A66;--shiki-dark:#D19A66">false</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">  "_shards"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">    "total"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#D19A66;--shiki-dark:#D19A66">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">    "successful"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#D19A66;--shiki-dark:#D19A66">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">    "skipped"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">    "failed"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  },</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">  "hits"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">    "total"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#D19A66;--shiki-dark:#D19A66">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">    "max_score"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#D19A66;--shiki-dark:#D19A66">0.38200712</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">    "hits"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : [</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">        "_index"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#98C379;--shiki-dark:#98C379">"user"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">        "_type"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#98C379;--shiki-dark:#98C379">"admin"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">        "_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#98C379;--shiki-dark:#98C379">"WWuoDG8BHwECs7SiYn93"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">        "_score"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#D19A66;--shiki-dark:#D19A66">0.38200712</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">        "_source"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">          "user"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#98C379;--shiki-dark:#98C379">"LÃ½ Tá»©"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">          "title"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#98C379;--shiki-dark:#98C379">"Ká»¹ sÆ°"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">          "desc"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#98C379;--shiki-dark:#98C379">"Quáº£n lÃ½ há»‡ thá»‘ng"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">        "_index"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#98C379;--shiki-dark:#98C379">"user"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">        "_type"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#98C379;--shiki-dark:#98C379">"admin"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">        "_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#98C379;--shiki-dark:#98C379">"1"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">        "_score"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#D19A66;--shiki-dark:#D19A66">0.3487891</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">        "_source"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">          "user"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#98C379;--shiki-dark:#98C379">"TrÆ°Æ¡ng Tam"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">          "title"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#98C379;--shiki-dark:#98C379">"Ká»¹ sÆ°"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">          "desc"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#98C379;--shiki-dark:#98C379">"Quáº£n trá»‹ viÃªn siÃªu cáº¥p"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    ]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Elastic máº·c Ä‘á»‹nh tráº£ vá» 10 káº¿t quáº£ má»—i láº§n, báº¡n cÃ³ thá»ƒ thay Ä‘á»•i cÃ i Ä‘áº·t nÃ y thÃ´ng qua trÆ°á»ng <code>size</code>, vÃ  cÅ©ng cÃ³ thá»ƒ chá»‰ Ä‘á»‹nh vá»‹ trÃ­ thÃ´ng qua trÆ°á»ng <code>from</code>.</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">$</span><span style="color:#98C379;--shiki-dark:#98C379"> curl</span><span style="color:#98C379;--shiki-dark:#98C379"> 'localhost:9200/user/admin/_search'</span><span style="color:#D19A66;--shiki-dark:#D19A66">  -d</span><span style="color:#98C379;--shiki-dark:#98C379"> '</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">{</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">  "query" : { "match" : { "desc" : "quáº£n lÃ½" }},</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">  "from": 1,</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">  "size": 1</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">}'</span></span></code></pre>
</div><p>Äoáº¡n mÃ£ trÃªn chá»‰ Ä‘á»‹nh, báº¯t Ä‘áº§u tá»« vá»‹ trÃ­ 1 (máº·c Ä‘á»‹nh lÃ  báº¯t Ä‘áº§u tá»« vá»‹ trÃ­ 0), chá»‰ tráº£ vá» má»™t káº¿t quáº£.</p>
<h3>PhÃ©p toÃ¡n logic</h3>
<p>Náº¿u cÃ³ nhiá»u tá»« khÃ³a tÃ¬m kiáº¿m, Elastic coi chÃºng lÃ  má»‘i quan há»‡ <code>or</code>.</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">$</span><span style="color:#98C379;--shiki-dark:#98C379"> curl</span><span style="color:#98C379;--shiki-dark:#98C379"> 'localhost:9200/user/admin/_search'</span><span style="color:#D19A66;--shiki-dark:#D19A66">  -d</span><span style="color:#98C379;--shiki-dark:#98C379"> '</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">{</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">"query" : { "match" : { "desc" : "pháº§n má»m há»‡ thá»‘ng" }}</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">}'</span></span></code></pre>
</div><p>Äoáº¡n mÃ£ trÃªn tÃ¬m kiáº¿m <code>pháº§n má»m or há»‡ thá»‘ng</code>.</p>
<p>Náº¿u báº¡n muá»‘n thá»±c hiá»‡n tÃ¬m kiáº¿m <code>and</code> vá»›i nhiá»u tá»« khÃ³a, báº¡n pháº£i sá»­ dá»¥ng <a href="https://www.elastic.co/guide/en/elasticsearch/reference/5.5/query-dsl-bool-query.html" target="_blank" rel="noopener noreferrer">Bool Query</a>.</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">$</span><span style="color:#98C379;--shiki-dark:#98C379"> curl</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -H</span><span style="color:#98C379;--shiki-dark:#98C379"> 'Content-Type: application/json'</span><span style="color:#98C379;--shiki-dark:#98C379"> 'localhost:9200/user/admin/_search?pretty'</span><span style="color:#D19A66;--shiki-dark:#D19A66">  -d</span><span style="color:#98C379;--shiki-dark:#98C379"> '</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">{</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379"> "query": {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">  "bool": {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">   "must": [</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">    { "match": { "desc": "quáº£n lÃ½" } },</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">    { "match": { "desc": "siÃªu cáº¥p" } }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">   ]</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">  }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">}'</span></span></code></pre>
</div><h3>Thá»±c hiá»‡n hÃ ng loáº¡t</h3>
<p>Há»— trá»£ thá»±c hiá»‡n cÃ¡c hoáº¡t Ä‘á»™ng trÃªn cÃ¡c chá»‰ má»¥c khÃ¡c nhau trong má»™t láº§n gá»i API</p>
<p>Há»— trá»£ bá»‘n loáº¡i hoáº¡t Ä‘á»™ng</p>
<ul>
<li>index</li>
<li>create</li>
<li>update</li>
<li>delete</li>
</ul>
<p>Náº¿u má»™t hoáº¡t Ä‘á»™ng Ä‘Æ¡n láº» tháº¥t báº¡i, Ä‘iá»u nÃ y sáº½ khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c hoáº¡t Ä‘á»™ng khÃ¡c.</p>
<p>Káº¿t quáº£ tráº£ vá» bao gá»“m káº¿t quáº£ cá»§a tá»«ng hoáº¡t Ä‘á»™ng Ä‘Æ°á»£c thá»±c hiá»‡n.</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> _bulk</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"index"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "_index"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "test",</span><span style="color:#98C379;--shiki-dark:#98C379"> "_id"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "1"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"field1"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "value1"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"delete"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "_index"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "test",</span><span style="color:#98C379;--shiki-dark:#98C379"> "_id"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "2"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"create"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "_index"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "test2",</span><span style="color:#98C379;--shiki-dark:#98C379"> "_id"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "3"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"field1"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "value3"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"update"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {"_id"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "1",</span><span style="color:#98C379;--shiki-dark:#98C379"> "_index"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "test"}</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"doc"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {"field2"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "value2"}</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span></code></pre>
</div><blockquote>
<p>LÆ°u Ã½: Náº¿u vÃ­ dá»¥ trÃªn Ä‘Æ°á»£c thá»±c hiá»‡n nhiá»u láº§n, káº¿t quáº£ sáº½ khÃ´ng giá»‘ng nhau.</p>
</blockquote>
<h3>Äá»c hÃ ng loáº¡t</h3>
<p>Äá»c nhiá»u chá»‰ má»¥c</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_mget</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "docs"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_index"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "test",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_id"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "1"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_index"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "test",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_id"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "2"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    ]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><p>Äá»c má»™t chá»‰ má»¥c</p>
<div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /test/_mget</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "docs"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_id"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "1"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_id"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "2"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    ]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_mget</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "docs"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_index"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "test",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_id"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "1",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_source"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#D19A66;--shiki-dark:#D19A66"> false</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_index"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "test",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_id"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "2",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_source"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span><span style="color:#98C379;--shiki-dark:#98C379">"field3"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">"field4"]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_index"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "test",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_id"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "3",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">            "_source"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">                "include"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span><span style="color:#98C379;--shiki-dark:#98C379">"user"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">],</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">                "exclude"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span><span style="color:#98C379;--shiki-dark:#98C379">"user.location"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">            }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    ]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>Truy váº¥n hÃ ng loáº¡t</h3>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> kibana_sample_data_ecommerce/_msearch</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"query"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {"match_all"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {}},"size":1}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"index"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "kibana_sample_data_flights"}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"query"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {"match_all"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> {}},"size":2}</span></span></code></pre>
</div><h3>TÃ¬m kiáº¿m URI</h3>
<p>TÃ¬m kiáº¿m URI Elasticsearch tuÃ¢n theo ngá»¯ cáº£nh QueryString, dáº¡ng nhÆ° sau:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /movies/_search?q=</span><span style="color:#D19A66;--shiki-dark:#D19A66">2012</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&amp;</span><span style="color:#E06C75;--shiki-dark:#E06C75">df</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379">title</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&amp;</span><span style="color:#E06C75;--shiki-dark:#E06C75">sort</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379">year:desc</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&amp;</span><span style="color:#E06C75;--shiki-dark:#E06C75">from</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&amp;</span><span style="color:#E06C75;--shiki-dark:#E06C75">size</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379">10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&amp;</span><span style="color:#E06C75;--shiki-dark:#E06C75">timeout</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379">1s</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">	"profile"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#D19A66;--shiki-dark:#D19A66"> true</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><ul>
<li><strong><code>q</code></strong> chá»‰ Ä‘á»‹nh cÃ¢u truy váº¥n, sá»­ dá»¥ng ngá»¯ cáº£nh QueryString</li>
<li><strong><code>df</code></strong> lÃ  trÆ°á»ng máº·c Ä‘á»‹nh, náº¿u khÃ´ng chá»‰ Ä‘á»‹nh</li>
<li><strong><code>sort</code></strong> sáº¯p xáº¿p: <code>from</code> vÃ  <code>size</code> Ä‘Æ°á»£c sá»­ dá»¥ng cho phÃ¢n trang</li>
<li><strong><code>profile</code></strong> cÃ³ thá»ƒ xem cÃ¡ch thá»±c hiá»‡n truy váº¥n</li>
</ul>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /movies/_search?q=title:2012</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&amp;</span><span style="color:#E06C75;--shiki-dark:#E06C75">sort</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379">year:desc</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&amp;</span><span style="color:#E06C75;--shiki-dark:#E06C75">from</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&amp;</span><span style="color:#E06C75;--shiki-dark:#E06C75">size</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379">10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&amp;</span><span style="color:#E06C75;--shiki-dark:#E06C75">timeout</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379">1s</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">	"profile"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"true"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h4>Term vÃ  Phrase</h4>
<p>Beautiful Mind tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i Beautiful OR Mind</p>
<p>"Beautiful Mind" tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i Beautiful AND Mind</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Truy váº¥n Term</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /movies/_search?q=title:Beautiful</span><span style="color:#98C379;--shiki-dark:#98C379"> Mind</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">	"profile"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"true"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Sá»­ dá»¥ng dáº¥u ngoáº·c kÃ©p, Truy váº¥n Phrase</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /movies/_search?q=title:"Beautiful Mind"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">	"profile"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"true"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h4>NhÃ³m vÃ  dáº¥u ngoáº·c kÃ©p</h4>
<p>title:(Beautiful AND Mind)</p>
<p>title="Beautiful Mind"</p>
<h4>AND, OR, NOT hoáº·c &amp;&amp;, ||, !</h4>
<blockquote>
<p>ChÃº Ã½: AND, OR, NOT pháº£i viáº¿t HOA</p>
</blockquote>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># ToÃ¡n tá»­ boolean</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /movies/_search?q=title:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">Beautiful</span><span style="color:#98C379;--shiki-dark:#98C379"> AND</span><span style="color:#98C379;--shiki-dark:#98C379"> Mind</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">	"profile"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"true"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /movies/_search?q=title:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">Beautiful</span><span style="color:#98C379;--shiki-dark:#98C379"> NOT</span><span style="color:#98C379;--shiki-dark:#98C379"> Mind</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">	"profile"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"true"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h4>Truy váº¥n pháº¡m vi</h4>
<ul>
<li><code>[]</code> biá»ƒu thá»‹ khoáº£ng Ä‘Ã³ng</li>
<li><code>{}</code> biá»ƒu thá»‹ khoáº£ng má»Ÿ</li>
</ul>
<p>VÃ­ dá»¥:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Truy váº¥n pháº¡m vi, cÃº phÃ¡p khoáº£ng</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /movies/_search?q=title:beautiful</span><span style="color:#98C379;--shiki-dark:#98C379"> AND</span><span style="color:#98C379;--shiki-dark:#98C379"> year:{</span><span style="color:#D19A66;--shiki-dark:#D19A66">2010</span><span style="color:#98C379;--shiki-dark:#98C379"> TO</span><span style="color:#98C379;--shiki-dark:#98C379"> 2018%7D</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">	"profile"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"true"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /movies/_search?q=title:beautiful</span><span style="color:#98C379;--shiki-dark:#98C379"> AND</span><span style="color:#98C379;--shiki-dark:#98C379"> year:[</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">*</span><span style="color:#98C379;--shiki-dark:#98C379"> TO</span><span style="color:#98C379;--shiki-dark:#98C379"> 2018]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">	"profile"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"true"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h4>KÃ½ hiá»‡u toÃ¡n há»c</h4>
<div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Há»“ sÆ¡ sau nÄƒm 2010</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /movies/_search?q=year</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:&gt;</span><span style="color:#98C379;--shiki-dark:#98C379">2010</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">	"profile"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"true"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Há»“ sÆ¡ tá»« nÄƒm 2010 Ä‘áº¿n nÄƒm 2018</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /movies/_search?q=year:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(&gt;2010 &amp;&amp; &lt;</span><span style="color:#98C379;--shiki-dark:#98C379">=2018</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">	"profile"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"true"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Há»“ sÆ¡ tá»« nÄƒm 2010 Ä‘áº¿n nÄƒm 2018</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /movies/_search?q=year:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">+</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&gt;</span><span style="color:#98C379;--shiki-dark:#98C379">2010</span><span style="color:#98C379;--shiki-dark:#98C379"> +</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&lt;</span><span style="color:#98C379;--shiki-dark:#98C379">=</span><span style="color:#D19A66;--shiki-dark:#D19A66">2018</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">	"profile"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"true"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4>Truy váº¥n dÃ¹ng kÃ½ tá»± Ä‘áº¡i diá»‡n</h4>
<ul>
<li><code>?</code> Ä‘áº¡i diá»‡n cho 1 kÃ½ tá»±</li>
<li><code>*</code> Ä‘áº¡i diá»‡n cho 0 hoáº·c nhiá»u kÃ½ tá»±</li>
</ul>
<p>VÃ­ dá»¥:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /movies/_search?q=title:mi?d</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">	"profile"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"true"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /movies/_search?q=title:b</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">*</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">	"profile"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"true"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h4>Biá»ƒu thá»©c chÃ­nh quy</h4>
<p>title:[bt]oy</p>
<h4>Káº¿t há»£p má» vÃ  truy váº¥n gáº§n Ä‘Ãºng</h4>
<p>VÃ­ dá»¥:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Äá»™ tÆ°Æ¡ng tá»± trong khoáº£ng 1 kÃ½ tá»±</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /movies/_search?q=title:beautifl~1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">	"profile"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"true"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Äá»™ tÆ°Æ¡ng tá»± trong khoáº£ng 2 kÃ½ tá»±</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /movies/_search?q=title:"Lord Rings"~2</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">	"profile"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"true"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h3>Request Body &amp; DSL</h3>
<p>NgoÃ i phÆ°Æ¡ng phÃ¡p tÃ¬m kiáº¿m URI, Elasticsearch cÃ²n há»— trá»£ viá»‡c gá»­i cÃ¢u truy váº¥n thÃ´ng qua Http Request Body.</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /kibana_sample_data_ecommerce/_search?ignore_unavailable=</span><span style="color:#D19A66;--shiki-dark:#D19A66">true</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">	"profile"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"true"</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">	"query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">	  "match_all"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">	}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h4>PhÃ¢n trang</h4>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /kibana_sample_data_ecommerce/_search?ignore_unavailable=</span><span style="color:#D19A66;--shiki-dark:#D19A66">true</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "profile"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "true",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "from"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> 0,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "size"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> 10,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "match_all"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h4>Sáº¯p xáº¿p</h4>
<p>Tá»‘t nháº¥t lÃ  sáº¯p xáº¿p trÃªn trÆ°á»ng dáº¡ng sá»‘ hoáº·c ngÃ y</p>
<p>Bá»Ÿi vÃ¬ khi sáº¯p xáº¿p trÃªn trÆ°á»ng cÃ³ nhiá»u giÃ¡ trá»‹ hoáº·c Ä‘Ã£ Ä‘Æ°á»£c phÃ¢n tÃ­ch, há»‡ thá»‘ng sáº½ chá»n má»™t giÃ¡ trá»‹, khÃ´ng thá»ƒ biáº¿t giÃ¡ trá»‹ Ä‘Ã³ lÃ  gÃ¬</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /kibana_sample_data_ecommerce/_search?ignore_unavailable=</span><span style="color:#D19A66;--shiki-dark:#D19A66">true</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "profile"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "true",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "sort"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "order_date"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "desc"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  ],</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "from"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> 1,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "size"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> 10,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "match_all"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h4>Lá»c _source</h4>
<p>Náº¿u <code>_source</code> khÃ´ng Ä‘Æ°á»£c lÆ°u trá»¯, thÃ¬ chá»‰ tráº£ vá» metadata cá»§a cÃ¡c tÃ i liá»‡u khá»›p</p>
<p><code>_source</code> há»— trá»£ sá»­ dá»¥ng kÃ½ tá»± Ä‘áº¡i diá»‡n, vÃ­ dá»¥: <code>_source["name*", "desc*"]</code></p>
<p>VÃ­ dá»¥:</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /kibana_sample_data_ecommerce/_search?ignore_unavailable=</span><span style="color:#D19A66;--shiki-dark:#D19A66">true</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "profile"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "true",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "_source"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "order_date"</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "category.keyword"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  ],</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "from"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> 1,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "size"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> 10,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "match_all"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h4>TrÆ°á»ng script</h4>
<div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /kibana_sample_data_ecommerce/_search?ignore_unavailable=</span><span style="color:#D19A66;--shiki-dark:#D19A66">true</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "profile"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "true",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "script_fields"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "new_field"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "script"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "lang"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "painless",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "source"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">"doc['order_date'].value+' hello'"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  },</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "from"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> 1,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "size"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> 10,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "match_all"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4>Sá»­ dá»¥ng biá»ƒu thá»©c truy váº¥n - Match</h4>
<div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> movies/_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "match"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "title"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "last christmas"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> movies/_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "match"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "title"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "last christmas",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "operator"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "and"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4>TÃ¬m kiáº¿m cá»¥m tá»« - Match Phrase</h4>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">POST</span><span style="color:#98C379;--shiki-dark:#98C379"> movies/_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "match_phrase"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "title"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "last christmas"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h2>Cluster API</h2>
<blockquote>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/cluster.html" target="_blank" rel="noopener noreferrer">Elasticsearch Official Cluster API</a></p>
</blockquote>
<p>Má»™t sá»‘ API cáº¥p cluster cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c thi trÃªn má»™t táº­p con cá»§a cÃ¡c node, nhá»¯ng node nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh báº±ng bá»™ lá»c node. VÃ­ dá»¥, cÃ¡c API quáº£n lÃ½ task, thá»‘ng kÃª node vÃ  thÃ´ng tin node Ä‘á»u cÃ³ thá»ƒ bÃ¡o cÃ¡o káº¿t quáº£ tá»« má»™t nhÃ³m cÃ¡c node Ä‘Ã£ lá»c thay vÃ¬ táº¥t cáº£ cÃ¡c node.</p>
<p>Bá»™ lá»c node Ä‘Æ°á»£c viáº¿t dÆ°á»›i dáº¡ng danh sÃ¡ch bá»™ lá»c Ä‘Æ¡n láº» Ä‘Æ°á»£c phÃ¢n tÃ¡ch báº±ng dáº¥u pháº©y, má»—i bá»™ lá»c thÃªm hoáº·c loáº¡i bá» cÃ¡c node tá»« táº­p con Ä‘Ã£ chá»n. Má»—i bá»™ lá»c cÃ³ thá»ƒ lÃ  má»™t trong nhá»¯ng Ä‘iá»u sau:</p>
<ul>
<li><code>_all</code>: thÃªm táº¥t cáº£ cÃ¡c node vÃ o táº­p con</li>
<li><code>_local</code>: thÃªm node cá»¥c bá»™ vÃ o táº­p con</li>
<li><code>_master</code>: thÃªm node master hiá»‡n táº¡i vÃ o táº­p con</li>
<li>ThÃªm cÃ¡c node khá»›p theo ID node hoáº·c tÃªn node vÃ o táº­p con</li>
<li>ThÃªm cÃ¡c node khá»›p theo Ä‘á»‹a chá»‰ IP hoáº·c tÃªn mÃ¡y chá»§ vÃ o táº­p con</li>
<li>Sá»­ dá»¥ng kÃ½ tá»± Ä‘áº¡i diá»‡n, thÃªm cÃ¡c node cÃ³ tÃªn, tÃªn Ä‘á»‹a chá»‰ hoáº·c tÃªn mÃ¡y chá»§ khá»›p vÃ o táº­p con</li>
<li><code>master:true</code>, <code>data:true</code>, <code>ingest:true</code>, <code>voting_only:true</code>, <code>ml:true</code> hoáº·c <code>coordinating_only:true</code>, tÆ°Æ¡ng á»©ng cÃ³ nghÄ©a lÃ  thÃªm táº¥t cáº£ cÃ¡c node master, táº¥t cáº£ cÃ¡c node dá»¯ liá»‡u, táº¥t cáº£ cÃ¡c node ingest, táº¥t cáº£ cÃ¡c node chá»‰ bá» phiáº¿u, táº¥t cáº£ cÃ¡c node machine learning vÃ  táº¥t cáº£ cÃ¡c node Ä‘iá»u phá»‘i vÃ o táº­p con.</li>
<li><code>master:false</code>, <code>data:false</code>, <code>ingest:false</code>, <code>voting_only:true</code>, <code>ml:false</code> hoáº·c <code>coordinating_only:false</code>, tÆ°Æ¡ng á»©ng cÃ³ nghÄ©a lÃ  loáº¡i trá»« táº¥t cáº£ cÃ¡c node master, táº¥t cáº£ cÃ¡c node dá»¯ liá»‡u, táº¥t cáº£ cÃ¡c node ingest, táº¥t cáº£ cÃ¡c node chá»‰ bá» phiáº¿u, táº¥t cáº£ cÃ¡c node machine learning vÃ  táº¥t cáº£ cÃ¡c node Ä‘iá»u phá»‘i ra khá»i táº­p con.</li>
<li>MÃ´ hÃ¬nh ghÃ©p cáº·p, sá»­ dá»¥ng kÃ½ tá»± Ä‘áº¡i diá»‡n <code>*</code>, theo dáº¡ng <code>attrname:attrvalue</code>, thÃªm táº¥t cáº£ cÃ¡c node cÃ³ thuá»™c tÃ­nh node tÃ¹y chá»‰nh vÃ o táº­p con, tÃªn vÃ  giÃ¡ trá»‹ cá»§a nÃ³ khá»›p vá»›i mÃ´ hÃ¬nh tÆ°Æ¡ng á»©ng. Thuá»™c tÃ­nh node tÃ¹y chá»‰nh Ä‘Æ°á»£c thiáº¿t láº­p trong tá»‡p cáº¥u hÃ¬nh theo dáº¡ng <code>node.attr.attrname: attrvalue</code>.</li>
</ul>
<div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Náº¿u khÃ´ng cÃ³ bá»™ lá»c, máº·c Ä‘á»‹nh lÃ  truy váº¥n táº¥t cáº£ cÃ¡c node</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_nodes</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Truy váº¥n táº¥t cáº£ cÃ¡c node</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_nodes/_all</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Truy váº¥n node cá»¥c bá»™</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_nodes/_local</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Truy váº¥n node master</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_nodes/_master</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Truy váº¥n node theo tÃªn (há»— trá»£ kÃ½ tá»± Ä‘áº¡i diá»‡n)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_nodes/node_name_goes_here</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_nodes/node_name_goes_</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">*</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Truy váº¥n node theo Ä‘á»‹a chá»‰ (há»— trá»£ kÃ½ tá»± Ä‘áº¡i diá»‡n)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_nodes/10.0.0.3,10.0.0.4</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_nodes/10.0.0.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">*</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Truy váº¥n node theo quy táº¯c</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_nodes/_all,master:</span><span style="color:#D19A66;--shiki-dark:#D19A66">false</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_nodes/data:</span><span style="color:#D19A66;--shiki-dark:#D19A66">true</span><span style="color:#98C379;--shiki-dark:#98C379">,ingest:</span><span style="color:#D19A66;--shiki-dark:#D19A66">true</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_nodes/coordinating_only:</span><span style="color:#D19A66;--shiki-dark:#D19A66">true</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_nodes/master:</span><span style="color:#D19A66;--shiki-dark:#D19A66">true</span><span style="color:#98C379;--shiki-dark:#98C379">,voting_only:</span><span style="color:#D19A66;--shiki-dark:#D19A66">false</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Truy váº¥n node theo thuá»™c tÃ­nh tÃ¹y chá»‰nh (vÃ­ dá»¥: truy váº¥n cÃ¡c node cÃ³ thuá»™c tÃ­nh node.attr.rack:2 trong tá»‡p cáº¥u hÃ¬nh)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_nodes/rack:2</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_nodes/ra</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">*</span><span style="color:#98C379;--shiki-dark:#98C379">:2</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_nodes/ra</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">*</span><span style="color:#98C379;--shiki-dark:#98C379">:2</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">*</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>Cluster Health API</h3>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_cluster/health</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_cluster/health?level=shards</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_cluster/health/kibana_sample_data_ecommerce,kibana_sample_data_flights</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_cluster/health/kibana_sample_data_flights?level=shards</span></span></code></pre>
</div><h3>Cluster State API</h3>
<p>Cluster State API tráº£ vá» metadata biá»ƒu thá»‹ tráº¡ng thÃ¡i toÃ n bá»™ cluster.</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_cluster/state</span></span></code></pre>
</div><h2>Nodes API</h2>
<blockquote>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/cat-nodes.html" target="_blank" rel="noopener noreferrer">Elasticsearch Official cat Nodes API</a> - Tráº£ vá» thÃ´ng tin vá» cÃ¡c node trong cluster.</p>
</blockquote>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Xem cÃ¡c trÆ°á»ng máº·c Ä‘á»‹nh</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_cat/nodes?v=</span><span style="color:#D19A66;--shiki-dark:#D19A66">true</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Xem cÃ¡c trÆ°á»ng chá»‰ Ä‘á»‹nh</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_cat/nodes?v=</span><span style="color:#D19A66;--shiki-dark:#D19A66">true</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&amp;</span><span style="color:#E06C75;--shiki-dark:#E06C75">h</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379">id,ip,port,v,m</span></span></code></pre>
</div><h2>Shards API</h2>
<blockquote>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/cat-shards.html" target="_blank" rel="noopener noreferrer">Elasticsearch Official cat Shards API</a> - Lá»‡nh shards cung cáº¥p má»™t cÃ¡i nhÃ¬n chi tiáº¿t vá» shard nÃ o thuá»™c vá» node nÃ o. NÃ³ sáº½ cho báº¡n biáº¿t nÃ³ lÃ  primary hay replica, sá»‘ lÆ°á»£ng tÃ i liá»‡u, sá»‘ byte mÃ  nÃ³ chiáº¿m trÃªn Ä‘Ä©a vÃ  node mÃ  nÃ³ Ä‘ang náº±m trÃªn.</p>
</blockquote>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Xem cÃ¡c trÆ°á»ng máº·c Ä‘á»‹nh</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_cat/shards</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Truy váº¥n shard theo tÃªn (há»— trá»£ kÃ½ tá»± Ä‘áº¡i diá»‡n)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_cat/shards/my-index-</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">*</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Xem cÃ¡c trÆ°á»ng chá»‰ Ä‘á»‹nh</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_cat/shards?h=index,shard,prirep,state,unassigned.reason</span></span></code></pre>
</div><h2>Monitoring API</h2>
<p>Trong Elasticsearch, cÃ¡c thÃ´ng tin liÃªn quan Ä‘áº¿n sá»©c khá»e, thá»‘ng kÃª, v.v. cá»§a cluster Ä‘á»u xoay quanh <code>cat</code> API.</p>
<p>Báº±ng cÃ¡ch gá»­i yÃªu cáº§u GET Ä‘áº¿n cat, dÆ°á»›i Ä‘Ã¢y lÃ  táº¥t cáº£ cÃ¡c API cÃ³ sáºµn:</p>
<div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> /_cat</span></span>
<span class="line"></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">=^</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">.</span><span style="color:#98C379;--shiki-dark:#98C379">^=</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">/_cat/allocation</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">/_cat/shards</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">/_cat/shards/</span><span style="color:#98C379;--shiki-dark:#98C379">{index}</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">/_cat/master</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">/_cat/nodes</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">/_cat/tasks</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">/_cat/indices</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">/_cat/indices/</span><span style="color:#98C379;--shiki-dark:#98C379">{index}</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">/_cat/segments</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">/_cat/segments/</span><span style="color:#98C379;--shiki-dark:#98C379">{index}</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">/_cat/count</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">/_cat/count/</span><span style="color:#98C379;--shiki-dark:#98C379">{index}</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">/_cat/recovery</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">/_cat/recovery/</span><span style="color:#98C379;--shiki-dark:#98C379">{index}</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">/_cat/health</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">/_cat/pending_tasks</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">/_cat/aliases</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">/_cat/aliases/</span><span style="color:#98C379;--shiki-dark:#98C379">{</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">alias</span><span style="color:#98C379;--shiki-dark:#98C379">}</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">/_cat/thread_pool</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">/_cat/thread_pool/</span><span style="color:#98C379;--shiki-dark:#98C379">{thread_pools}</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">/_cat/plugins</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">/_cat/fielddata</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">/_cat/fielddata/</span><span style="color:#98C379;--shiki-dark:#98C379">{fields}</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">/_cat/nodeattrs</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">/_cat/repositories</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">/_cat/snapshots/</span><span style="color:#98C379;--shiki-dark:#98C379">{repository}</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">/_cat/templates</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>TÃ i liá»‡u tham kháº£o</h2>
<ul>
<li><strong>ChÃ­nh thá»©c</strong>
<ul>
<li><a href="https://www.elastic.co/products/elasticsearch" target="_blank" rel="noopener noreferrer">Trang chá»§ Elasticsearch</a></li>
<li><a href="https://github.com/elastic/elasticsearch" target="_blank" rel="noopener noreferrer">Elasticsearch Github</a></li>
<li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html" target="_blank" rel="noopener noreferrer">TÃ i liá»‡u chÃ­nh thá»©c Elasticsearch</a></li>
</ul>
</li>
</ul>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20220530072511.png" type="image/png"/>
    </item>
    <item>
      <title>Elasticsearch Sorting</title>
      <link>https://vanhung4499.github.io/database/elasticsearch/sorting.html</link>
      <guid>https://vanhung4499.github.io/database/elasticsearch/sorting.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Elasticsearch Sorting</source>
      <description>Elasticsearch Sorting Sáº¯p xáº¿p Elasticsearch Trong Elasticsearch, máº·c Ä‘á»‹nh Ä‘Æ°á»£c sáº¯p xáº¿p theo Ä‘Ã¡nh giÃ¡ liÃªn quan (_score) theo thá»© tá»± giáº£m dáº§n, hoáº·c cÃ³ thá»ƒ sáº¯p xáº¿p theo giÃ¡ trá»‹ cá»§...</description>
      <category>elasticssearch</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[<p>Elasticsearch Sorting</p>
<h1>Sáº¯p xáº¿p Elasticsearch</h1>
<p>Trong Elasticsearch, máº·c Ä‘á»‹nh Ä‘Æ°á»£c sáº¯p xáº¿p theo <strong>Ä‘Ã¡nh giÃ¡ liÃªn quan (_score)</strong> theo thá»© tá»± giáº£m dáº§n, hoáº·c cÃ³ thá»ƒ sáº¯p xáº¿p theo <strong>giÃ¡ trá»‹ cá»§a trÆ°á»ng</strong>, <strong>sáº¯p xáº¿p nhiá»u cáº¥p</strong>, <strong>sáº¯p xáº¿p trÆ°á»ng nhiá»u giÃ¡ trá»‹</strong>, <strong>sáº¯p xáº¿p dá»±a trÃªn vá»‹ trÃ­ Ä‘á»‹a lÃ½ (geo)</strong> vÃ  <strong>sáº¯p xáº¿p tÃ¹y chá»‰nh báº±ng script</strong>. NgoÃ i ra, Ä‘Ã¡nh giÃ¡ liÃªn quan cÅ©ng cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ láº¡i vá»›i rescore hai, ba láº§n, nÃ³ cÃ³ thá»ƒ giá»›i háº¡n kÃ­ch thÆ°á»›c cá»­a sá»• (window size) cho viá»‡c Ä‘Ã¡nh giÃ¡ láº¡i vÃ  chá»‰nh sá»­a Ä‘iá»ƒm sá»‘ cá»§a cÃ¡c tÃ i liá»‡u trong pháº¡m vi tÃ¡c Ä‘á»™ng, tá»« Ä‘Ã³ Ä‘áº¡t Ä‘Æ°á»£c má»¥c tiÃªu kiá»ƒm soÃ¡t káº¿t quáº£ liÃªn quan má»™t cÃ¡ch tinh vi.</p>
<h2>Sáº¯p xáº¿p liÃªn quan máº·c Ä‘á»‹nh</h2>
<p>Trong Elasticsearch, máº·c Ä‘á»‹nh, cÃ¡c tÃ i liá»‡u Ä‘Æ°á»£c sáº¯p xáº¿p theo thá»© tá»± giáº£m dáº§n cá»§a Ä‘iá»ƒm liÃªn quan, trÆ°á»ng tÆ°Æ¡ng á»©ng vá»›i Ä‘iá»ƒm liÃªn quan Ä‘Æ°á»£c biá»ƒu thá»‹ báº±ng <code>_score</code>, Ä‘Ã¢y lÃ  kiá»ƒu sá»‘ thá»±c, Ä‘iá»ƒm <code>_score</code> cÃ ng cao, liÃªn quan cÃ ng cao. MÃ´ hÃ¬nh Ä‘Ã¡nh giÃ¡ cÃ³ thá»ƒ Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh thÃ´ng qua tham sá»‘ <code>similarity</code> trong Ã¡nh xáº¡.</p>
<p>Thuáº­t toÃ¡n tÆ°Æ¡ng tá»± cÃ³ thá»ƒ Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh theo trÆ°á»ng, chá»‰ cáº§n chá»n trong Ã¡nh xáº¡ cho cÃ¡c trÆ°á»ng khÃ¡c nhau, náº¿u báº¡n muá»‘n chá»‰nh sá»­a thuáº­t toÃ¡n tÆ°Æ¡ng tá»± cá»§a trÆ°á»ng hiá»‡n cÃ³, báº¡n chá»‰ cÃ³ thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c má»¥c tiÃªu nÃ y báº±ng cÃ¡ch xÃ¢y dá»±ng láº¡i chá»‰ má»¥c cho dá»¯ liá»‡u. Äá»‘i vá»›i thuáº­t toÃ¡n tÆ°Æ¡ng tá»± es hÆ¡n, báº¡n cÃ³ thá»ƒ tham kháº£o <a href="https://www.knowledgedict.com/tutorial/elasticsearch-similarity.html" target="_blank" rel="noopener noreferrer">Sá»± hiá»ƒu biáº¿t sÃ¢u sáº¯c vá» thuáº­t toÃ¡n tÆ°Æ¡ng tá»± es (tÃ­nh Ä‘iá»ƒm liÃªn quan)</a>.</p>
<h3>MÃ´ hÃ¬nh TF-IDF</h3>
<p>TrÆ°á»›c phiÃªn báº£n 5.4 cá»§a Elasticsearch, cÃ¡c trÆ°á»ng kiá»ƒu text máº·c Ä‘á»‹nh sá»­ dá»¥ng mÃ´ hÃ¬nh khÃ´ng gian vector dá»±a trÃªn tf-idf.</p>
<p>Khi báº¯t Ä‘áº§u tÃ­nh Ä‘iá»ƒm, Elasticsearch sá»­ dá»¥ng táº§n suáº¥t cá»§a tá»« khÃ³a Ä‘Æ°á»£c tÃ¬m kiáº¿m vÃ  má»©c Ä‘á»™ phá»• biáº¿n cá»§a nÃ³ Ä‘á»ƒ áº£nh hÆ°á»Ÿng Ä‘áº¿n Ä‘iá»ƒm. Má»™t giáº£i thÃ­ch ngáº¯n gá»n lÃ , <strong>cÃ ng nhiá»u láº§n má»™t tá»« khÃ³a xuáº¥t hiá»‡n trong má»™t tÃ i liá»‡u, nÃ³ cÃ ng liÃªn quan; tuy nhiÃªn, náº¿u tá»« khÃ³a xuáº¥t hiá»‡n trong nhiá»u tÃ i liá»‡u khÃ¡c nhau, nÃ³ cÃ ng khÃ´ng liÃªn quan</strong>. Äiá»u nÃ y Ä‘Æ°á»£c gá»i lÃ  TF-IDF, TF lÃ  <strong>táº§n suáº¥t tá»«</strong> (term frequency), IDF lÃ  <strong>táº§n suáº¥t tÃ i liá»‡u nghá»‹ch Ä‘áº£o</strong> (inverse document frequency).</p>
<p>CÃ¡ch tiáº¿p cáº­n chÃ­nh Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ má»™t tÃ i liá»‡u lÃ  Ä‘áº¿m sá»‘ láº§n má»™t tá»« khÃ³a xuáº¥t hiá»‡n trong vÄƒn báº£n. VÃ­ dá»¥, náº¿u ngÆ°á»i dÃ¹ng tÃ¬m kiáº¿m má»™t buá»•i há»p vá» Elasticsearch trong khu vá»±c cá»§a há», há» muá»‘n nhÃ³m tháº£o luáº­n vá» Elasticsearch Ä‘Æ°á»£c hiá»ƒn thá»‹ Ä‘áº§u tiÃªn.</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>"We will discuss Elasticsearch at the next Big Data group."</span></span>
<span class="line"><span>"Tuesday the Elasticsearch team will gather to answer questions about Elasticsearch."</span></span></code></pre>
</div><p>CÃ¢u Ä‘áº§u tiÃªn Ä‘á» cáº­p Ä‘áº¿n Elasticsearch má»™t láº§n, trong khi cÃ¢u thá»© hai Ä‘á» cáº­p Ä‘áº¿n Elasticsearch hai láº§n, vÃ¬ váº­y tÃ i liá»‡u chá»©a cÃ¢u thá»© hai nÃªn cÃ³ Ä‘iá»ƒm sá»‘ cao hÆ¡n so vá»›i tÃ i liá»‡u chá»©a cÃ¢u Ä‘áº§u tiÃªn. Náº¿u chÃºng ta Ä‘á» cáº­p Ä‘áº¿n sá»‘ lÆ°á»£ng, táº§n suáº¥t tá»« (TF) cá»§a cÃ¢u Ä‘áº§u tiÃªn lÃ  1, trong khi táº§n suáº¥t tá»« cá»§a cÃ¢u thá»© hai sáº½ lÃ  2.</p>
<p>Táº§n suáº¥t tÃ i liá»‡u nghá»‹ch Ä‘áº£o phá»©c táº¡p hÆ¡n má»™t chÃºt so vá»›i táº§n suáº¥t tá»«. MÃ´ táº£ tuyá»‡t vá»i nÃ y cÃ³ nghÄ©a lÃ , náº¿u má»™t tá»« (thÃ´ng thÆ°á»ng lÃ  má»™t tá»«, nhÆ°ng khÃ´ng nháº¥t thiáº¿t pháº£i lÃ  má»™t tá»«) xuáº¥t hiá»‡n nhiá»u láº§n trong cÃ¡c tÃ i liá»‡u khÃ¡c nhau cá»§a chá»‰ má»¥c, thÃ¬ nÃ³ sáº½ khÃ´ng quan trá»ng. VÃ­ dá»¥ sau sáº½ giáº£i thÃ­ch Ä‘iá»u nÃ y má»™t cÃ¡ch dá»… dÃ ng hÆ¡n.</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>"We use Elasticsearch to power the search for our website."</span></span>
<span class="line"><span>"The developers like Elasticsearch so far."</span></span>
<span class="line"><span>"The scoring of documents is calculated by the scoring formula."</span></span></code></pre>
</div><p>Trong vÃ­ dá»¥ trÃªn, cáº§n hiá»ƒu nhá»¯ng Ä‘iá»ƒm sau:</p>
<ul>
<li>Táº§n suáº¥t tÃ i liá»‡u cá»§a tá»« khÃ³a "Elasticsearch" lÃ  2 (vÃ¬ nÃ³ xuáº¥t hiá»‡n trong hai tÃ i liá»‡u). Táº§n suáº¥t tÃ i liá»‡u nghá»‹ch Ä‘áº£o xuáº¥t phÃ¡t tá»« viá»‡c nhÃ¢n Ä‘iá»ƒm vá»›i 1/DF, nÆ¡i DF lÃ  táº§n suáº¥t tÃ i liá»‡u cá»§a tá»« khÃ³a. Äiá»u nÃ y cÃ³ nghÄ©a lÃ , do tá»« khÃ³a cÃ³ táº§n suáº¥t tÃ i liá»‡u cao hÆ¡n, trá»ng sá»‘ cá»§a nÃ³ sáº½ giáº£m.</li>
<li>Táº§n suáº¥t tÃ i liá»‡u cá»§a tá»« khÃ³a "the" lÃ  3, vÃ¬ nÃ³ xuáº¥t hiá»‡n trong táº¥t cáº£ ba tÃ i liá»‡u. LÆ°u Ã½ ráº±ng, máº·c dÃ¹ "the" xuáº¥t hiá»‡n hai láº§n trong tÃ i liá»‡u cuá»‘i cÃ¹ng, táº§n suáº¥t tÃ i liá»‡u cá»§a nÃ³ váº«n lÃ  3. Äiá»u nÃ y lÃ  bá»Ÿi vÃ¬ táº§n suáº¥t tÃ i liá»‡u nghá»‹ch Ä‘áº£o chá»‰ kiá»ƒm tra xem má»™t tá»« khÃ³a cÃ³ xuáº¥t hiá»‡n trong má»™t tÃ i liá»‡u nÃ o Ä‘Ã³ hay khÃ´ng, chá»© khÃ´ng kiá»ƒm tra xem nÃ³ xuáº¥t hiá»‡n bao nhiÃªu láº§n. Äiá»u Ä‘Ã³ nÃªn lÃ  má»‘i quan tÃ¢m cá»§a táº§n suáº¥t tá»«.</li>
</ul>
<p>Táº§n suáº¥t tÃ i liá»‡u nghá»‹ch Ä‘áº£o lÃ  má»™t yáº¿u tá»‘ quan trá»ng, Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ cÃ¢n nháº¯c táº§n suáº¥t tá»«. VÃ­ dá»¥, xem xÃ©t má»™t ngÆ°á»i dÃ¹ng tÃ¬m kiáº¿m tá»« khÃ³a "the score", tá»« "the" xuáº¥t hiá»‡n gáº§n nhÆ° trong má»i vÄƒn báº£n tiáº¿ng Anh thÃ´ng thÆ°á»ng, náº¿u nÃ³ khÃ´ng Ä‘Æ°á»£c cÃ¢n nháº¯c, táº§n suáº¥t tá»« cá»§a tá»« "the" sáº½ hoÃ n toÃ n che má» táº§n suáº¥t tá»« cá»§a tá»« "score". Táº§n suáº¥t tÃ i liá»‡u nghá»‹ch Ä‘áº£o IDF cÃ¢n nháº¯c áº£nh hÆ°á»Ÿng liÃªn quan cá»§a tá»« thÃ´ng dá»¥ng nhÆ° "the", vÃ¬ váº­y Ä‘iá»ƒm liÃªn quan thá»±c táº¿ sáº½ mÃ´ táº£ chÃ­nh xÃ¡c hÆ¡n tá»« khÃ³a cá»§a truy váº¥n.</p>
<p>Má»™t khi táº§n suáº¥t tá»« TF vÃ  táº§n suáº¥t tÃ i liá»‡u nghá»‹ch Ä‘áº£o IDF Ä‘Ã£ Ä‘Æ°á»£c tÃ­nh toÃ¡n, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng cÃ´ng thá»©c TF-IDF Ä‘á»ƒ tÃ­nh Ä‘iá»ƒm cá»§a tÃ i liá»‡u.</p>
<h3>MÃ´ hÃ¬nh BM25</h3>
<p>Sau phiÃªn báº£n 5.4 cá»§a Elasticsearch, Ä‘á»‘i vá»›i trÆ°á»ng kiá»ƒu text, máº·c Ä‘á»‹nh sá»­ dá»¥ng mÃ´ hÃ¬nh Ä‘Ã¡nh giÃ¡ BM25, khÃ´ng pháº£i mÃ´ hÃ¬nh khÃ´ng gian vector dá»±a trÃªn tf-idf, mÃ´ hÃ¬nh Ä‘Ã¡nh giÃ¡ cÃ³ thá»ƒ Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh thÃ´ng qua tham sá»‘ <code>similarity</code> trong Ã¡nh xáº¡.</p>
<h2>Sáº¯p xáº¿p theo giÃ¡ trá»‹ cá»§a trÆ°á»ng</h2>
<p>Trong Elasticsearch, Ä‘á»ƒ sáº¯p xáº¿p theo giÃ¡ trá»‹ cá»§a má»™t trÆ°á»ng, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng tham sá»‘ <code>sort</code>.</p>
<div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> books/_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  "sort"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    "price"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">      "order"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "desc"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><p>Káº¿t quáº£ tráº£ vá» nhÆ° sau:</p>
<div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "took"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">132</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "timed_out"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">false</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "_shards"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "total"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "successful"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "skipped"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "failed"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  },</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "hits"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "total"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">749244</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "max_score"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">null</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "hits"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">        "_index"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"books"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">        "_type"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"book"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">        "_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"8456479"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">        "_score"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">null</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">        "_source"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">          "id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">8456479</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">          "price"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1580.00</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">          ...</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        },</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">        "sort"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66">          1580.00</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        ]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      },</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">      ...</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    ]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Tá»« káº¿t quáº£ tráº£ vá» trÃªn, cÃ³ thá»ƒ tháº¥y, <code>max_score</code> vÃ  <code>_score</code> Ä‘á»u tráº£ vá» <code>null</code>, vÃ  trÆ°á»ng <code>sort</code> Ä‘Æ°á»£c thÃªm vÃ o, chá»©a giÃ¡ trá»‹ cá»§a trÆ°á»ng Ä‘Æ°á»£c sáº¯p xáº¿p. Viá»‡c tÃ­nh toÃ¡n <code>_score</code> tá»‘n kÃ©m, náº¿u khÃ´ng sáº¯p xáº¿p theo má»©c Ä‘á»™ liÃªn quan, viá»‡c ghi láº¡i <code>_score</code> khÃ´ng cÃ³ Ã½ nghÄ©a. Náº¿u báº¡n váº«n muá»‘n tÃ­nh toÃ¡n <code>_score</code> dÃ¹ sao, báº¡n cÃ³ thá»ƒ Ä‘áº·t tham sá»‘ <code>track_scores</code> thÃ nh <code>true</code>.</p>
<h2>Sáº¯p xáº¿p nhiá»u trÆ°á»ng</h2>
<p>Náº¿u chÃºng ta muá»‘n káº¿t há»£p price, date vÃ  _score Ä‘á»ƒ truy váº¥n, vÃ  káº¿t quáº£ phÃ¹ há»£p Ä‘áº§u tiÃªn Ä‘Æ°á»£c sáº¯p xáº¿p theo giÃ¡, sau Ä‘Ã³ Ä‘Æ°á»£c sáº¯p xáº¿p theo ngÃ y, vÃ  cuá»‘i cÃ¹ng Ä‘Æ°á»£c sáº¯p xáº¿p theo má»©c Ä‘á»™ liÃªn quan, vÃ­ dá»¥ cá»¥ thá»ƒ nhÆ° sau:</p>
<div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">GET</span><span style="color:#98C379;--shiki-dark:#98C379"> books/_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">	"query"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">		"bool"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">			"must"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">				"match"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "content":</span><span style="color:#98C379;--shiki-dark:#98C379"> "java"</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">			},</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">			"filter"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">				"term"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span><span style="color:#98C379;--shiki-dark:#98C379"> "user_id":</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 4868438</span><span style="color:#98C379;--shiki-dark:#98C379"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">			}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">		}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">	},</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">	"sort"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">			"price"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">				"order"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "desc"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">			}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">		}, {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">			"date"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">				"order"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "desc"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">			}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">		}, {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">			"_score"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">				"order"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">:</span><span style="color:#98C379;--shiki-dark:#98C379"> "desc"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">			}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">		}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">	]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Thá»© tá»± cá»§a cÃ¡c Ä‘iá»u kiá»‡n sáº¯p xáº¿p ráº¥t quan trá»ng. Káº¿t quáº£ Ä‘áº§u tiÃªn Ä‘Æ°á»£c sáº¯p xáº¿p theo Ä‘iá»u kiá»‡n Ä‘áº§u tiÃªn, chá»‰ khi giÃ¡ trá»‹ <code>sort</code> Ä‘áº§u tiÃªn cá»§a táº­p káº¿t quáº£ hoÃ n toÃ n giá»‘ng nhau, káº¿t quáº£ má»›i Ä‘Æ°á»£c sáº¯p xáº¿p theo Ä‘iá»u kiá»‡n thá»© hai, vÃ  cá»© tiáº¿p tá»¥c nhÆ° váº­y.</p>
<p>Sáº¯p xáº¿p nhiá»u cáº¥p khÃ´ng nháº¥t thiáº¿t pháº£i bao gá»“m <code>_score</code>. Báº¡n cÃ³ thá»ƒ sáº¯p xáº¿p theo má»™t sá»‘ trÆ°á»ng khÃ¡c nhau, nhÆ° khoáº£ng cÃ¡ch Ä‘á»‹a lÃ½ hoáº·c giÃ¡ trá»‹ Ä‘Æ°á»£c tÃ­nh toÃ¡n báº±ng script.</p>
<h2>Sáº¯p xáº¿p trÆ°á»ng cÃ³ nhiá»u giÃ¡ trá»‹</h2>
<p>Má»™t trÆ°á»ng há»£p lÃ  sáº¯p xáº¿p khi trÆ°á»ng cÃ³ nhiá»u giÃ¡ trá»‹, cáº§n nhá»› ráº±ng cÃ¡c giÃ¡ trá»‹ nÃ y khÃ´ng cÃ³ thá»© tá»± cá»‘ Ä‘á»‹nh; má»™t trÆ°á»ng cÃ³ nhiá»u giÃ¡ trá»‹ chá»‰ Ä‘Æ¡n giáº£n lÃ  má»™t bá»™ giÃ¡ trá»‹ nhiá»u, váº­y nÃªn chá»n giÃ¡ trá»‹ nÃ o Ä‘á»ƒ sáº¯p xáº¿p?</p>
<p>Äá»‘i vá»›i sá»‘ hoáº·c ngÃ y, báº¡n cÃ³ thá»ƒ giáº£m trÆ°á»ng nhiá»u giÃ¡ trá»‹ thÃ nh má»™t giÃ¡ trá»‹ duy nháº¥t, Ä‘iá»u nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng cÃ¡ch sá»­ dá»¥ng cháº¿ Ä‘á»™ sáº¯p xáº¿p <code>min</code>, <code>max</code>, <code>avg</code> hoáº·c <code>sum</code>. VÃ­ dá»¥, báº¡n cÃ³ thá»ƒ sáº¯p xáº¿p theo ngÃ y sá»›m nháº¥t trong má»—i trÆ°á»ng date, thÃ´ng qua cÃ¡ch sau:</p>
<div class="language-json" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#98C379;--shiki-dark:#98C379">"sort"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "dates"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "order"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"asc"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "mode"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:  </span><span style="color:#98C379;--shiki-dark:#98C379">"min"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h2>Sáº¯p xáº¿p theo khoáº£ng cÃ¡ch Ä‘á»‹a lÃ½</h2>
<p>Elasticsearch sá»­ dá»¥ng <code>_geo_distance</code> Ä‘á»ƒ sáº¯p xáº¿p theo khoáº£ng cÃ¡ch Ä‘á»‹a lÃ½, nhÆ° vÃ­ dá»¥ sau:</p>
<div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "sort"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : [</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "_geo_distance"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">        "es_location_field"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : [</span><span style="color:#D19A66;--shiki-dark:#D19A66">116.407526</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#D19A66;--shiki-dark:#D19A66">39.904030</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">],</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">        "order"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#98C379;--shiki-dark:#98C379">"asc"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">        "unit"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#98C379;--shiki-dark:#98C379">"km"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">        "mode"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#98C379;--shiki-dark:#98C379">"min"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">        "distance_type"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#98C379;--shiki-dark:#98C379">"plane"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  ],</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "query"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : {</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">    ......</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>CÃ¡c tÃ¹y chá»n cá»§a <code>_geo_distance</code> cá»¥ thá»ƒ nhÆ° sau:</p>
<ul>
<li>TrÆ°á»ng <code>es_location_field</code> trong vÃ­ dá»¥ trÃªn lÃ  tÃªn cá»§a trÆ°á»ng lÆ°u trá»¯ dá»¯ liá»‡u kinh Ä‘á»™ vÃ  vÄ© Ä‘á»™ trong Elasticsearch.</li>
<li><code>order</code>: chá»‰ Ä‘á»‹nh sáº¯p xáº¿p theo khoáº£ng cÃ¡ch tÄƒng dáº§n hoáº·c giáº£m dáº§n, tÆ°Æ¡ng á»©ng vá»›i <code>asc</code> vÃ  <code>desc</code>.</li>
<li><code>unit</code>: Ä‘Æ¡n vá»‹ tÃ­nh khoáº£ng cÃ¡ch, máº·c Ä‘á»‹nh lÃ  <code>m</code>, biá»ƒu thá»‹ mÃ©t (meters), cÃ¡c tÃ¹y chá»n khÃ¡c bao gá»“m <code>mi</code>, <code>cm</code>, <code>mm</code>, <code>NM</code>, <code>km</code>, <code>ft</code>, <code>yd</code> vÃ  <code>in</code>.</li>
<li><code>mode</code>: khi xá»­ lÃ½ dá»¯ liá»‡u máº£ng (nhiá»u giÃ¡ trá»‹), chá»‰ Ä‘á»‹nh cháº¿ Ä‘á»™ láº¥y giÃ¡ trá»‹, cÃ¡c tÃ¹y chá»n bao gá»“m <code>min</code>, <code>max</code>, <code>sum</code>, <code>avg</code> vÃ  <code>median</code>. Khi sáº¯p xáº¿p theo thá»© tá»± tÄƒng dáº§n, máº·c Ä‘á»‹nh lÃ  <code>min</code>; khi sáº¯p xáº¿p theo thá»© tá»± giáº£m dáº§n, máº·c Ä‘á»‹nh lÃ  <code>max</code>.</li>
<li><code>distance_type</code>: Ä‘áº·t cÃ¡ch tÃ­nh toÃ¡n khoáº£ng cÃ¡ch, cÃ¡c tÃ¹y chá»n bao gá»“m <code>sloppy_arc</code>, <code>arc</code> vÃ  <code>plane</code>. Máº·c Ä‘á»‹nh lÃ  <code>sloppy_arc</code>. <code>arc</code> cÃ³ Ä‘á»™ chÃ­nh xÃ¡c tÆ°Æ¡ng Ä‘á»‘i cao hÆ¡n nhÆ°ng tá»‘c Ä‘á»™ sáº½ giáº£m Ä‘Ã¡ng ká»ƒ, <code>plane</code> thÃ¬ tá»‘c Ä‘á»™ tÃ­nh toÃ¡n nhanh nhÆ°ng khÃ´ng chÃ­nh xÃ¡c vá»›i khoáº£ng cÃ¡ch dÃ i.</li>
<li><code>ignore_unmapped</code>: khi gáº·p trÆ°á»ng chÆ°a Ä‘Æ°á»£c Ã¡nh xáº¡, cÃ³ nÃªn bá» qua khÃ´ng, cÃ¡c tÃ¹y chá»n bao gá»“m <code>true</code> vÃ  <code>false</code>. Máº·c Ä‘á»‹nh lÃ  <code>false</code>, tá»©c lÃ  náº¿u gáº·p trÆ°á»ng chÆ°a Ä‘Æ°á»£c Ã¡nh xáº¡, truy váº¥n sáº½ gÃ¢y ra ngoáº¡i lá»‡; náº¿u Ä‘áº·t lÃ  <code>true</code>, nÃ³ sáº½ bá» qua cÃ¡c trÆ°á»ng chÆ°a Ä‘Æ°á»£c Ã¡nh xáº¡ vÃ  khÃ´ng khá»›p vá»›i báº¥t ká»³ tÃ i liá»‡u nÃ o trong truy váº¥n nÃ y.</li>
<li><code>validation_method</code>: chá»‰ Ä‘á»‹nh cÃ¡ch kiá»ƒm tra dá»¯ liá»‡u kinh Ä‘á»™ vÃ  vÄ© Ä‘á»™, cÃ¡c tÃ¹y chá»n bao gá»“m <code>IGNORE_MALFORMED</code>, <code>COERCE</code> vÃ  <code>STRICT</code>. <code>IGNORE_MALFORMED</code> cho phÃ©p cháº¥p nháº­n Ä‘iá»ƒm Ä‘á»‹a lÃ½ cÃ³ vÄ© Ä‘á»™ hoáº·c kinh Ä‘á»™ khÃ´ng há»£p lá»‡, tá»©c lÃ  bá» qua dá»¯ liá»‡u; <code>COERCE</code> cá»‘ gáº¯ng Ä‘oÃ¡n vÃ  chuyá»ƒn Ä‘á»•i thÃ nh tá»a Ä‘á»™ Ä‘á»‹a lÃ½ chÃ­nh xÃ¡c; <code>STRICT</code> lÃ  giÃ¡ trá»‹ máº·c Ä‘á»‹nh, tá»©c lÃ  sáº½ nÃ©m ra ngoáº¡i lá»‡ khi gáº·p tá»a Ä‘á»™ Ä‘á»‹a lÃ½ khÃ´ng chÃ­nh xÃ¡c.</li>
</ul>
<h2>TÃ i liá»‡u tham kháº£o</h2>
<ul>
<li><a href="https://www.knowledgedict.com/tutorial/elasticsearch-intro.html" target="_blank" rel="noopener noreferrer">HÆ°á»›ng dáº«n Elasticsearch</a></li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>MongoDB</title>
      <link>https://vanhung4499.github.io/database/mongodb/</link>
      <guid>https://vanhung4499.github.io/database/mongodb/</guid>
      <source url="https://vanhung4499.github.io/rss.xml">MongoDB</source>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
    </item>
    <item>
      <title>MongoDB Aggreation</title>
      <link>https://vanhung4499.github.io/database/mongodb/aggreation.html</link>
      <guid>https://vanhung4499.github.io/database/mongodb/aggreation.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">MongoDB Aggreation</source>
      <description>CÃ¡c hoáº¡t Ä‘á»™ng tá»•ng há»£p trong MongoDB CÃ¡c hoáº¡t Ä‘á»™ng tá»•ng há»£p trong MongoDB xá»­ lÃ½ cÃ¡c báº£n ghi dá»¯ liá»‡u vÃ  tráº£ vá» káº¿t quáº£ tÃ­nh toÃ¡n. CÃ¡c hoáº¡t Ä‘á»™ng tá»•ng há»£p nhÃ³m cÃ¡c giÃ¡ trá»‹ tá»« nhiá»u...</description>
      <category>mongodb</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<p>CÃ¡c hoáº¡t Ä‘á»™ng tá»•ng há»£p trong MongoDB xá»­ lÃ½ cÃ¡c báº£n ghi dá»¯ liá»‡u vÃ  tráº£ vá» káº¿t quáº£ tÃ­nh toÃ¡n. CÃ¡c hoáº¡t Ä‘á»™ng tá»•ng há»£p nhÃ³m cÃ¡c giÃ¡ trá»‹ tá»« nhiá»u tÃ i liá»‡u vÃ  cÃ³ thá»ƒ thá»±c hiá»‡n cÃ¡c thao tÃ¡c khÃ¡c nhau trÃªn dá»¯ liá»‡u nhÃ³m Ä‘á»ƒ tráº£ vá» má»™t káº¿t quáº£ duy nháº¥t. MongoDB cung cáº¥p ba cÃ¡ch thá»±c hiá»‡n hoáº¡t Ä‘á»™ng tá»•ng há»£p: Pipeline, Map-Reduce vÃ  cÃ¡c phÆ°Æ¡ng phÃ¡p tá»•ng há»£p Ä‘Æ¡n láº».</p>
<h2>Pipeline</h2>
<h3>Giá»›i thiá»‡u vá» Pipeline</h3>
<p>Khung tá»•ng há»£p cá»§a MongoDB Ä‘Æ°á»£c xÃ¢y dá»±ng dá»±a trÃªn khÃ¡i niá»‡m cá»§a Pipeline xá»­ lÃ½ dá»¯ liá»‡u.</p>
<p><strong>MongoDB há»— trá»£ hoáº¡t Ä‘á»™ng tá»•ng há»£p thÃ´ng qua phÆ°Æ¡ng thá»©c <a href="https://docs.mongodb.com/manual/reference/method/db.collection.aggregate/#db.collection.aggregate" target="_blank" rel="noopener noreferrer"><code>db.collection.aggregate()</code></a></strong>. NgoÃ i ra, MongoDB cung cáº¥p lá»‡nh <a href="https://docs.mongodb.com/manual/reference/command/aggregate/#dbcmd.aggregate" target="_blank" rel="noopener noreferrer"><code>aggregate</code></a> Ä‘á»ƒ thá»±c hiá»‡n pipeline.</p>
<p>Pipeline cá»§a MongoDB bao gá»“m nhiá»u giai Ä‘oáº¡n (<a href="https://docs.mongodb.com/manual/reference/operator/aggregation-pipeline/#aggregation-pipeline-operator-reference" target="_blank" rel="noopener noreferrer">stages</a>). Má»—i giai Ä‘oáº¡n sáº½ chuyá»ƒn Ä‘á»•i cÃ¡c tÃ i liá»‡u khi chÃºng Ä‘i qua pipeline. Má»™t giai Ä‘oáº¡n khÃ´ng cáº§n táº¡o ra má»™t tÃ i liá»‡u Ä‘áº§u ra cho má»—i tÃ i liá»‡u Ä‘áº§u vÃ o. VÃ­ dá»¥, má»™t sá»‘ giai Ä‘oáº¡n cÃ³ thá»ƒ táº¡o ra cÃ¡c tÃ i liá»‡u má»›i hoáº·c lá»c cÃ¡c tÃ i liá»‡u.</p>
<p>CÃ¹ng má»™t giai Ä‘oáº¡n cÃ³ thá»ƒ xuáº¥t hiá»‡n nhiá»u láº§n trong pipeline, trá»« cÃ¡c giai Ä‘oáº¡n <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/out/#pipe._S_out" target="_blank" rel="noopener noreferrer"><code>$out</code></a>, <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/merge/#pipe._S_merge" target="_blank" rel="noopener noreferrer"><code>$merge</code></a>, vÃ  <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/geoNear/#pipe._S_geoNear" target="_blank" rel="noopener noreferrer"><code>$geoNear</code></a>. Táº¥t cáº£ cÃ¡c giai Ä‘oáº¡n pipeline cÃ³ sáºµn cÃ³ thá»ƒ Ä‘Æ°á»£c tham kháº£o táº¡i: <a href="https://docs.mongodb.com/manual/reference/operator/aggregation-pipeline/#aggregation-pipeline-operator-reference" target="_blank" rel="noopener noreferrer">Aggregation Pipeline Stages</a>.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200921092725.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>
<ul>
<li>Giai Ä‘oáº¡n Ä‘áº§u tiÃªn: Giai Ä‘oáº¡n <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/match/#pipe._S_match" target="_blank" rel="noopener noreferrer"><code>$match</code></a> lá»c cÃ¡c tÃ i liá»‡u theo trÆ°á»ng tráº¡ng thÃ¡i vÃ  chuyá»ƒn cÃ¡c tÃ i liá»‡u cÃ³ tráº¡ng thÃ¡i lÃ  "A" sang giai Ä‘oáº¡n tiáº¿p theo.</li>
<li>Giai Ä‘oáº¡n thá»© hai: Giai Ä‘oáº¡n <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/group/#pipe._S_group" target="_blank" rel="noopener noreferrer"><code>$group</code></a> nhÃ³m cÃ¡c tÃ i liá»‡u theo trÆ°á»ng cust_id Ä‘á»ƒ tÃ­nh tá»•ng sá»‘ tiá»n cho má»—i cust_id duy nháº¥t.</li>
</ul>
<p>CÃ¡c giai Ä‘oáº¡n pipeline cÆ¡ báº£n cung cáº¥p bá»™ lá»c, tÆ°Æ¡ng tá»± nhÆ° truy váº¥n, vÃ  chuyá»ƒn Ä‘á»•i tÃ i liá»‡u Ä‘áº§u ra (thay Ä‘á»•i hÃ¬nh thá»©c tÃ i liá»‡u Ä‘áº§u ra).</p>
<p>CÃ¡c hoáº¡t Ä‘á»™ng pipeline khÃ¡c cung cáº¥p cÃ¡c cÃ´ng cá»¥ Ä‘á»ƒ nhÃ³m vÃ  sáº¯p xáº¿p cÃ¡c tÃ i liá»‡u theo trÆ°á»ng cá»¥ thá»ƒ, cÅ©ng nhÆ° tá»•ng há»£p ná»™i dung cá»§a máº£ng (bao gá»“m cáº£ máº£ng tÃ i liá»‡u). NgoÃ i ra, cÃ¡c giai Ä‘oáº¡n pipeline cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c toÃ¡n tá»­ Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c nhiá»‡m vá»¥ nhÆ° tÃ­nh trung bÃ¬nh hoáº·c káº¿t há»£p chuá»—i.</p>
<p>Pipeline tá»•ng há»£p cÅ©ng cÃ³ thá»ƒ hoáº¡t Ä‘á»™ng trÃªn táº­p há»£p phÃ¢n Ä‘oáº¡n.</p>
<h3>Tá»‘i Æ°u hÃ³a Pipeline</h3>
<h4>Tá»‘i Æ°u hÃ³a Projection</h4>
<p>Pipeline cÃ³ thá»ƒ xÃ¡c Ä‘á»‹nh xem chá»‰ cáº§n cÃ¡c trÆ°á»ng báº¯t buá»™c trong tÃ i liá»‡u Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c káº¿t quáº£.</p>
<h4>Tá»‘i Æ°u hÃ³a tuáº§n tá»± Pipeline</h4>
<p>Tá»‘i Æ°u hÃ³a tuáº§n tá»± (<code>$project</code>, <code>$unset</code>, <code>$addFields</code>, <code>$set</code>) + <code>$match</code></p>
<p>Äá»‘i vá»›i Pipeline cÃ³ chá»©a cÃ¡c giai Ä‘oáº¡n chiáº¿u (<a href="https://docs.mongodb.com/manual/reference/operator/aggregation/unset/#pipe._S_unset" target="_blank" rel="noopener noreferrer"><span v-pre="" class="katex-error" title="ParseError: KaTeX parse error: Expected 'EOF', got '#' at position 81: â€¦gation/project/#Ì²pipe._S_projectâ€¦" style="color:#cc0000">project](https://docs.mongodb.com/manual/reference/operator/aggregation/project/#pipe._S_project) hoáº·c [</span>unset</a> hoáº·c <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/set/#pipe._S_set" target="_blank" rel="noopener noreferrer"><span v-pre="" class="katex-error" title="ParseError: KaTeX parse error: Expected 'EOF', got '#' at position 85: â€¦tion/addFields/#Ì²pipe._S_addFielâ€¦" style="color:#cc0000">addFields](https://docs.mongodb.com/manual/reference/operator/aggregation/addFields/#pipe._S_addFields) hoáº·c [</span>set</a>) vÃ  theo sau lÃ  giai Ä‘oáº¡n <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/match/#pipe._S_match" target="_blank" rel="noopener noreferrer"><span v-pre="" class="katex-error" title="ParseError: KaTeX parse error: Expected 'EOF', got '#' at position 77: â€¦regation/match/#Ì²pipe._S_match),â€¦" style="color:#cc0000">match](https://docs.mongodb.com/manual/reference/operator/aggregation/match/#pipe._S_match), MongoDB sáº½ di chuyá»ƒn bá»™ lá»c cá»§a táº¥t cáº£ cÃ¡c giai Ä‘oáº¡n [</span>match</a> khÃ´ng cáº§n thiáº¿t tÃ­nh toÃ¡n cÃ¡c giÃ¡ trá»‹ trong giai Ä‘oáº¡n chiáº¿u, thÃ nh má»™t giai Ä‘oáº¡n <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/match/#pipe._S_match" target="_blank" rel="noopener noreferrer">$match</a> má»›i trÆ°á»›c giai Ä‘oáº¡n chiáº¿u.</p>
<p>Náº¿u Pipeline chá»©a nhiá»u giai Ä‘oáº¡n chiáº¿u vÃ /hoáº·c giai Ä‘oáº¡n <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/match/#pipe._S_match" target="_blank" rel="noopener noreferrer"><span v-pre="" class="katex-error" title="ParseError: KaTeX parse error: Expected 'EOF', got '#' at position 77: â€¦regation/match/#Ì²pipe._S_match),â€¦" style="color:#cc0000">match](https://docs.mongodb.com/manual/reference/operator/aggregation/match/#pipe._S_match), MongoDB sáº½ thá»±c hiá»‡n tá»‘i Æ°u hÃ³a nÃ y cho má»—i giai Ä‘oáº¡n [</span>match</a>, di chuyá»ƒn bá»™ lá»c <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/match/#pipe._S_match" target="_blank" rel="noopener noreferrer">$match</a> vÃ o trÆ°á»›c táº¥t cáº£ cÃ¡c giai Ä‘oáº¡n chiáº¿u khÃ´ng phá»¥ thuá»™c vÃ o nÃ³.</p>
<p>ã€VÃ­ dá»¥ã€‘VÃ­ dá»¥ tá»‘i Æ°u hÃ³a tuáº§n tá»± Pipeline</p>
<p>TrÆ°á»›c tá»‘i Æ°u hÃ³a:</p>
<div class="language-javascript" data-ext="javascript" data-title="javascript"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#E06C75;--shiki-dark:#E06C75">$addFields</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    maxTime</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">$max</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"$times"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    minTime</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">$min</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"$times"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">} },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#E06C75;--shiki-dark:#E06C75">$project</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    _id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">name</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">times</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">maxTime</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">minTime</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    avgTime</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">$avg</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span><span style="color:#98C379;--shiki-dark:#98C379">"$maxTime"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">"$minTime"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">] }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">} },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#E06C75;--shiki-dark:#E06C75">$match</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    name</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Joe Schmoe"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    maxTime</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">$lt</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">20</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    minTime</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">$gt</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    avgTime</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">$gt</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">7</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">} }</span></span></code></pre>
</div><p>Sau tá»‘i Æ°u hÃ³a:</p>
<div class="language-javascript" data-ext="javascript" data-title="javascript"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#E06C75;--shiki-dark:#E06C75">$match</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">name</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Joe Schmoe"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> } },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#E06C75;--shiki-dark:#E06C75">$addFields</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    maxTime</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">$max</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"$times"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    minTime</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">$min</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"$times"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">} },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#E06C75;--shiki-dark:#E06C75">$match</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">maxTime</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">$lt</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">20</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }, </span><span style="color:#E06C75;--shiki-dark:#E06C75">minTime</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">$gt</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> } } },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#E06C75;--shiki-dark:#E06C75">$project</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    _id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">name</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">times</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">maxTime</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">minTime</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    avgTime</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">$avg</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span><span style="color:#98C379;--shiki-dark:#98C379">"$maxTime"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">"$minTime"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">] }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">} },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#E06C75;--shiki-dark:#E06C75">$match</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">avgTime</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">$gt</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">7</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> } } }</span></span></code></pre>
</div><p>Giáº£i thÃ­ch:</p>
<p><code>{ name: "Joe Schmoe" }</code> khÃ´ng cáº§n tÃ­nh toÃ¡n báº¥t ká»³ giÃ¡ trá»‹ nÃ o trong giai Ä‘oáº¡n chiáº¿u, vÃ¬ váº­y nÃ³ cÃ³ thá»ƒ Ä‘áº·t á»Ÿ Ä‘áº§u tiÃªn.</p>
<p><code>{ avgTime: { $gt: 7 } }</code> phá»¥ thuá»™c vÃ o trÆ°á»ng <code>avgTime</code> cá»§a giai Ä‘oáº¡n <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/project/#pipe._S_project" target="_blank" rel="noopener noreferrer">$project</a>, nÃªn khÃ´ng thá»ƒ di chuyá»ƒn.</p>
<p>TrÆ°á»ng <code>maxTime</code> vÃ  <code>minTime</code> Ä‘Æ°á»£c phá»¥ thuá»™c vÃ o giai Ä‘oáº¡n <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/match/#pipe._S_match" target="_blank" rel="noopener noreferrer"><span v-pre="" class="katex-error" title="ParseError: KaTeX parse error: Expected 'EOF', got '#' at position 85: â€¦tion/addFields/#Ì²pipe._S_addFielâ€¦" style="color:#cc0000">undefined</span>match</a> má»›i Ä‘Æ°á»£c táº¡o ra vÃ  Ä‘áº·t trÆ°á»›c giai Ä‘oáº¡n <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/project/#pipe._S_project" target="_blank" rel="noopener noreferrer">$project</a>.</p>
<h4>Tá»‘i Æ°u hÃ³a song song Pipeline</h4>
<p>Náº¿u cÃ³ thá»ƒ, giai Ä‘oáº¡n tá»‘i Æ°u hÃ³a sáº½ káº¿t há»£p cÃ¡c giai Ä‘oáº¡n Pipeline vÃ o giai Ä‘oáº¡n trÆ°á»›c Ä‘Ã³. ThÃ´ng thÆ°á»ng, viá»‡c káº¿t há»£p xáº£y ra sau tá»‘i Æ°u hÃ³a láº¡i thá»© tá»± cá»§a báº¥t ká»³ chuá»—i nÃ o.</p>
<h5><code>$sort</code> + <code>$limit</code></h5>
<p>Khi <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/limit/#pipe._S_limit" target="_blank" rel="noopener noreferrer"><span v-pre="" class="katex-error" title="ParseError: KaTeX parse error: Expected 'EOF', got '#' at position 75: â€¦gregation/sort/#Ì²pipe._S_sort) Ä‘â€¦" style="color:#cc0000">sort](https://docs.mongodb.com/manual/reference/operator/aggregation/sort/#pipe._S_sort) Ä‘á»©ng trÆ°á»›c [</span>limit</a> vÃ  khÃ´ng cÃ³ giai Ä‘oáº¡n trung gian nÃ o thay Ä‘á»•i sá»‘ lÆ°á»£ng tÃ i liá»‡u (vÃ­ dá»¥: <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/group/#pipe._S_group" target="_blank" rel="noopener noreferrer"><span v-pre="" class="katex-error" title="ParseError: KaTeX parse error: Expected 'EOF', got '#' at position 79: â€¦egation/unwind/#Ì²pipe._S_unwind)â€¦" style="color:#cc0000">unwind](https://docs.mongodb.com/manual/reference/operator/aggregation/unwind/#pipe._S_unwind), [</span>group</a>), trÃ¬nh tá»‘i Æ°u hÃ³a cÃ³ thá»ƒ káº¿t há»£p <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/sort/#pipe._S_sort" target="_blank" rel="noopener noreferrer"><span v-pre="" class="katex-error" title="ParseError: KaTeX parse error: Expected 'EOF', got '#' at position 77: â€¦regation/limit/#Ì²pipe._S_limit) â€¦" style="color:#cc0000">limit](https://docs.mongodb.com/manual/reference/operator/aggregation/limit/#pipe._S_limit) vÃ o [</span>sort</a>. Náº¿u cÃ³ giai Ä‘oáº¡n trung gian thay Ä‘á»•i sá»‘ lÆ°á»£ng tÃ i liá»‡u giá»¯a <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/limit/#pipe._S_limit" target="_blank" rel="noopener noreferrer"><span v-pre="" class="katex-error" title="ParseError: KaTeX parse error: Expected 'EOF', got '#' at position 75: â€¦gregation/sort/#Ì²pipe._S_sort) vâ€¦" style="color:#cc0000">sort](https://docs.mongodb.com/manual/reference/operator/aggregation/sort/#pipe._S_sort) vÃ  [</span>limit</a>, MongoDB sáº½ khÃ´ng káº¿t há»£p <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/sort/#pipe._S_sort" target="_blank" rel="noopener noreferrer"><span v-pre="" class="katex-error" title="ParseError: KaTeX parse error: Expected 'EOF', got '#' at position 77: â€¦regation/limit/#Ì²pipe._S_limit) â€¦" style="color:#cc0000">limit](https://docs.mongodb.com/manual/reference/operator/aggregation/limit/#pipe._S_limit) vÃ o [</span>sort</a>.</p>
<p>ã€VÃ­ dá»¥ã€‘<code>$sort</code> + <code>$limit</code></p>
<p>TrÆ°á»›c tá»‘i Æ°u hÃ³a:</p>
<div class="language-javascript" data-ext="javascript" data-title="javascript"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#E06C75;--shiki-dark:#E06C75">$sort</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : { </span><span style="color:#E06C75;--shiki-dark:#E06C75">age</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> } },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#E06C75;--shiki-dark:#E06C75">$project</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : { </span><span style="color:#E06C75;--shiki-dark:#E06C75">age</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">status</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">name</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> } },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#E06C75;--shiki-dark:#E06C75">$limit</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }</span></span></code></pre>
</div><p>Sau tá»‘i Æ°u hÃ³a:</p>
<div class="language-javascript" data-ext="javascript" data-title="javascript"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">    "$sort"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">       "sortKey"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">          "age"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">       },</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">       "limit"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">NumberLong</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#D19A66;--shiki-dark:#D19A66">5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">},</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#98C379;--shiki-dark:#98C379">"$project"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">         "age"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">         "status"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">         "name"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> : </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h5><code>$limit</code> + <code>$limit</code></h5>
<p>Náº¿u má»™t <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/limit/#pipe._S_limit" target="_blank" rel="noopener noreferrer"><span v-pre="" class="katex-error" title="ParseError: KaTeX parse error: Expected 'EOF', got '#' at position 77: â€¦regation/limit/#Ì²pipe._S_limit) â€¦" style="color:#cc0000">limit](https://docs.mongodb.com/manual/reference/operator/aggregation/limit/#pipe._S_limit) ngay sau má»™t [</span>limit</a> khÃ¡c, chÃºng cÃ³ thá»ƒ Ä‘Æ°á»£c káº¿t há»£p thÃ nh má»™t.</p>
<p>TrÆ°á»›c tá»‘i Æ°u hÃ³a:</p>
<div class="language-javascript" data-ext="javascript" data-title="javascript"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#E06C75;--shiki-dark:#E06C75">$limit</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">100</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#E06C75;--shiki-dark:#E06C75">$limit</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }</span></span></code></pre>
</div><p>Sau tá»‘i Æ°u hÃ³a:</p>
<div class="language-javascript" data-ext="javascript" data-title="javascript"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  $limit</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">10</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h5><code>$skip</code> + <code>$skip</code></h5>
<p>Náº¿u má»™t <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/skip/#pipe._S_skip" target="_blank" rel="noopener noreferrer"><span v-pre="" class="katex-error" title="ParseError: KaTeX parse error: Expected 'EOF', got '#' at position 75: â€¦gregation/skip/#Ì²pipe._S_skip) nâ€¦" style="color:#cc0000">skip](https://docs.mongodb.com/manual/reference/operator/aggregation/skip/#pipe._S_skip) ngay sau má»™t [</span>skip</a> khÃ¡c, chÃºng cÃ³ thá»ƒ Ä‘Æ°á»£c káº¿t há»£p thÃ nh má»™t.</p>
<p>TrÆ°á»›c tá»‘i Æ°u hÃ³a:</p>
<div class="language-javascript" data-ext="javascript" data-title="javascript"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#E06C75;--shiki-dark:#E06C75">$skip</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#E06C75;--shiki-dark:#E06C75">$skip</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }</span></span></code></pre>
</div><p>Sau tá»‘i Æ°u hÃ³a:</p>
<div class="language-javascript" data-ext="javascript" data-title="javascript"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  $skip</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">7</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h5><code>$match</code> + <code>$match</code></h5>
<p>Náº¿u má»™t <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/match/#pipe._S_match" target="_blank" rel="noopener noreferrer"><span v-pre="" class="katex-error" title="ParseError: KaTeX parse error: Expected 'EOF', got '#' at position 77: â€¦regation/match/#Ì²pipe._S_match) â€¦" style="color:#cc0000">match](https://docs.mongodb.com/manual/reference/operator/aggregation/match/#pipe._S_match) ngay sau má»™t [</span>match</a> khÃ¡c, chÃºng cÃ³ thá»ƒ Ä‘Æ°á»£c káº¿t há»£p thÃ nh má»™t báº±ng <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/and/#exp._S_and" target="_blank" rel="noopener noreferrer">$and</a>.</p>
<p>TrÆ°á»›c tá»‘i Æ°u hÃ³a:</p>
<div class="language-javascript" data-ext="javascript" data-title="javascript"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#E06C75;--shiki-dark:#E06C75">$match</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">year</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">2014</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> } },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#E06C75;--shiki-dark:#E06C75">$match</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">status</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"A"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> } }</span></span></code></pre>
</div><p>Sau tá»‘i Æ°u hÃ³a:</p>
<div class="language-javascript" data-ext="javascript" data-title="javascript"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  $match</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    $and</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [{ </span><span style="color:#E06C75;--shiki-dark:#E06C75">year</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">2014</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }, { </span><span style="color:#E06C75;--shiki-dark:#E06C75">status</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'A'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h5><code>$lookup</code> + <code>$unwind</code></h5>
<p>Náº¿u má»™t <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/lookup/#pipe._S_lookup" target="_blank" rel="noopener noreferrer"><span v-pre="" class="katex-error" title="ParseError: KaTeX parse error: Expected 'EOF', got '#' at position 79: â€¦egation/unwind/#Ì²pipe._S_unwind)â€¦" style="color:#cc0000">unwind](https://docs.mongodb.com/manual/reference/operator/aggregation/unwind/#pipe._S_unwind) ngay sau má»™t [</span>lookup</a> vÃ  <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/lookup/#pipe._S_lookup" target="_blank" rel="noopener noreferrer"><span v-pre="" class="katex-error" title="ParseError: KaTeX parse error: Expected 'EOF', got '#' at position 79: â€¦egation/unwind/#Ì²pipe._S_unwind)â€¦" style="color:#cc0000">unwind](https://docs.mongodb.com/manual/reference/operator/aggregation/unwind/#pipe._S_unwind) Ä‘Æ°á»£c thá»±c hiá»‡n trÃªn trÆ°á»ng as cá»§a [</span>lookup</a>, trÃ¬nh tá»‘i Æ°u hÃ³a cÃ³ thá»ƒ káº¿t há»£p <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/lookup/#pipe._S_lookup" target="_blank" rel="noopener noreferrer"><span v-pre="" class="katex-error" title="ParseError: KaTeX parse error: Expected 'EOF', got '#' at position 79: â€¦egation/unwind/#Ì²pipe._S_unwind)â€¦" style="color:#cc0000">unwind](https://docs.mongodb.com/manual/reference/operator/aggregation/unwind/#pipe._S_unwind) vÃ o [</span>lookup</a> Ä‘á»ƒ trÃ¡nh táº¡o ra cÃ¡c tÃ i liá»‡u trung gian lá»›n hÆ¡n.</p>
<p>TrÆ°á»›c tá»‘i Æ°u hÃ³a:</p>
<div class="language-javascript" data-ext="javascript" data-title="javascript"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  $lookup</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    from</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"otherCollection"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    as</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"resultingArray"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    localField</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"x"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    foreignField</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"y"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">},</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#E06C75;--shiki-dark:#E06C75">$unwind</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"$resultingArray"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><p>Sau tá»‘i Æ°u hÃ³a:</p>
<div class="language-javascript" data-ext="javascript" data-title="javascript"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  $lookup</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    from</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"otherCollection"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    as</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"resultingArray"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    localField</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"x"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    foreignField</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"y"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    unwinding</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">preserveNullAndEmptyArrays</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">false</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h3>Giá»›i háº¡n cá»§a Pipeline</h3>
<p>Má»—i tÃ i liá»‡u trong táº­p káº¿t quáº£ bá»‹ giá»›i háº¡n bá»Ÿi kÃ­ch thÆ°á»›c tÃ i liá»‡u BSON (hiá»‡n táº¡i lÃ  16 MB).</p>
<p>Giá»›i háº¡n bá»™ nhá»› cá»§a Pipeline lÃ  100 MB.</p>
<h2>Map-Reduce</h2>
<blockquote>
<p>Pipeline tá»•ng há»£p cung cáº¥p hiá»‡u suáº¥t tá»‘t hÆ¡n vÃ  giao diá»‡n nháº¥t quÃ¡n hÆ¡n so vá»›i map-reduce.</p>
</blockquote>
<p>Map-reduce lÃ  má»™t mÃ´ hÃ¬nh xá»­ lÃ½ dá»¯ liá»‡u Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tá»•ng há»£p má»™t lÆ°á»£ng lá»›n dá»¯ liá»‡u thÃ nh káº¿t quáº£ tá»•ng há»£p há»¯u Ã­ch. Äá»ƒ thá»±c hiá»‡n thao tÃ¡c map-reduce, MongoDB cung cáº¥p lá»‡nh cÆ¡ sá»Ÿ dá»¯ liá»‡u <a href="https://docs.mongodb.com/manual/reference/command/mapReduce/#dbcmd.mapReduce" target="_blank" rel="noopener noreferrer"><code>mapReduce</code></a>.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230724012524.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure>
<p>Trong quÃ¡ trÃ¬nh trÃªn, MongoDB Ã¡p dá»¥ng giai Ä‘oáº¡n map cho má»—i tÃ i liá»‡u Ä‘áº§u vÃ o (tá»©c lÃ  tÃ i liá»‡u trong bá»™ sÆ°u táº­p khá»›p vá»›i Ä‘iá»u kiá»‡n truy váº¥n). HÃ m map phÃ¢n phá»‘i nhiá»u cáº·p khÃ³a-giÃ¡ trá»‹. Äá»‘i vá»›i cÃ¡c khÃ³a cÃ³ nhiá»u giÃ¡ trá»‹, MongoDB Ã¡p dá»¥ng giai Ä‘oáº¡n reduce, giai Ä‘oáº¡n nÃ y thu tháº­p vÃ  tá»•ng há»£p dá»¯ liá»‡u tá»•ng há»£p. Sau Ä‘Ã³, MongoDB lÆ°u káº¿t quáº£ vÃ o bá»™ sÆ°u táº­p. TÃ¹y chá»n, Ä‘áº§u ra cá»§a hÃ m reduce cÃ³ thá»ƒ Ä‘Æ°á»£c tá»•ng há»£p thÃªm báº±ng hÃ m finalize.</p>
<p>Táº¥t cáº£ cÃ¡c hÃ m map-reduce trong MongoDB Ä‘á»u lÃ  JavaScript vÃ  cháº¡y trong quÃ¡ trÃ¬nh mongod. Thao tÃ¡c map-reduce nháº­n Ä‘áº§u vÃ o lÃ  tÃ i liá»‡u cá»§a má»™t bá»™ sÆ°u táº­p vÃ  cÃ³ thá»ƒ thá»±c hiá»‡n báº¥t ká»³ sáº¯p xáº¿p vÃ  giá»›i háº¡n nÃ o trÆ°á»›c giai Ä‘oáº¡n map. mapReduce cÃ³ thá»ƒ tráº£ vá» káº¿t quáº£ cá»§a thao tÃ¡c map-reduce dÆ°á»›i dáº¡ng tÃ i liá»‡u hoáº·c ghi káº¿t quáº£ vÃ o bá»™ sÆ°u táº­p.</p>
<h2>PhÆ°Æ¡ng phÃ¡p tá»•ng há»£p Ä‘Æ¡n má»¥c Ä‘Ã­ch</h2>
<p>MongoDB há»— trá»£ cÃ¡c phÆ°Æ¡ng phÃ¡p tá»•ng há»£p Ä‘Æ¡n má»¥c Ä‘Ã­ch sau Ä‘Ã¢y:</p>
<ul>
<li><a href="https://docs.mongodb.com/manual/reference/method/db.collection.estimatedDocumentCount/#db.collection.estimatedDocumentCount" target="_blank" rel="noopener noreferrer"><code>db.collection.estimatedDocumentCount()</code></a>: Äáº¿m Æ°á»›c lÆ°á»£ng sá»‘ lÆ°á»£ng tÃ i liá»‡u trong má»™t bá»™ sÆ°u táº­p.</li>
<li><a href="https://docs.mongodb.com/manual/reference/method/db.collection.count/#db.collection.count" target="_blank" rel="noopener noreferrer"><code>db.collection.count()</code></a>: Äáº¿m sá»‘ lÆ°á»£ng tÃ i liá»‡u trong má»™t bá»™ sÆ°u táº­p.</li>
<li><a href="https://docs.mongodb.com/manual/reference/method/db.collection.distinct/#db.collection.distinct" target="_blank" rel="noopener noreferrer"><code>db.collection.distinct()</code></a>: Láº¥y cÃ¡c giÃ¡ trá»‹ duy nháº¥t tá»« má»™t trÆ°á»ng trong má»™t bá»™ sÆ°u táº­p.</li>
</ul>
<p>Táº¥t cáº£ cÃ¡c thao tÃ¡c nÃ y tá»•ng há»£p cÃ¡c tÃ i liá»‡u trong má»™t bá»™ sÆ°u táº­p duy nháº¥t. Máº·c dÃ¹ cÃ¡c thao tÃ¡c nÃ y cung cáº¥p cÃ¡ch tiáº¿p cáº­n Ä‘Æ¡n giáº£n cho cÃ¡c quy trÃ¬nh tá»•ng há»£p thÃ´ng thÆ°á»ng, nhÆ°ng chÃºng thiáº¿u tÃ­nh linh hoáº¡t vÃ  tÃ­nh nÄƒng phong phÃº so vá»›i pipeline tá»•ng há»£p vÃ  map-reduce.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230724012551.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure>
<h2>So sÃ¡nh Aggregation trong SQL vÃ  MongoDB</h2>
<p>Pipeline trong MongoDB cung cáº¥p nhiá»u phÃ©p toÃ¡n tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i cÃ¡c cÃ¢u lá»‡nh hoáº·c hÃ m tá»•ng há»£p phá»• biáº¿n trong SQL.</p>
<p>Báº£ng dÆ°á»›i Ä‘Ã¢y tÃ³m táº¯t sá»± tÆ°Æ¡ng á»©ng giá»¯a cÃ¡c cÃ¢u lá»‡nh hoáº·c khÃ¡i niá»‡m tá»•ng há»£p SQL phá»• biáº¿n vÃ  cÃ¡c phÃ©p toÃ¡n tá»•ng há»£p MongoDB:</p>
<p>| SQL Terms, Functions, and Concepts | MongoDB Aggregation Operators                                                                                                                                                                             |<br>
| :</p>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200921092725.png" type="image/png"/>
    </item>
    <item>
      <title>MongoDB CRUD Operations</title>
      <link>https://vanhung4499.github.io/database/mongodb/crud.html</link>
      <guid>https://vanhung4499.github.io/database/mongodb/crud.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">MongoDB CRUD Operations</source>
      <description>CÃ¡c thao tÃ¡c CRUD trong MongoDB I. CÃ¡c thao tÃ¡c CRUD cÆ¡ báº£n CÃ¡c thao tÃ¡c CRUD trong MongoDB lÃ  cÃ¡c thao tÃ¡c Ä‘á»c vÃ  ghi dá»¯ liá»‡u vÃ o tÃ i liá»‡u (document). Thao tÃ¡c Create (Táº¡o) Mon...</description>
      <category>mongodb</category>
      <category>nosql</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>I. CÃ¡c thao tÃ¡c CRUD cÆ¡ báº£n</h2>
<p>CÃ¡c thao tÃ¡c CRUD trong MongoDB lÃ  cÃ¡c thao tÃ¡c Ä‘á»c vÃ  ghi dá»¯ liá»‡u vÃ o tÃ i liá»‡u (document).</p>
<h3>Thao tÃ¡c Create (Táº¡o)</h3>
<p>MongoDB cung cáº¥p cÃ¡c thao tÃ¡c sau Ä‘á»ƒ chÃ¨n tÃ i liá»‡u vÃ o má»™t bá»™ sÆ°u táº­p (collection):</p>
<ul>
<li><a href="https://docs.mongodb.com/manual/reference/method/db.collection.insertOne/#db.collection.insertOne" target="_blank" rel="noopener noreferrer"><code>db.collection.insertOne()</code></a>: ChÃ¨n má»™t tÃ i liá»‡u vÃ o bá»™ sÆ°u táº­p.</li>
<li><a href="https://docs.mongodb.com/manual/reference/method/db.collection.insertMany/#db.collection.insertMany" target="_blank" rel="noopener noreferrer"><code>db.collection.insertMany()</code></a>: ChÃ¨n nhiá»u tÃ i liá»‡u vÃ o bá»™ sÆ°u táº­p.</li>
</ul>
<blockquote>
<p>LÆ°u Ã½: CÃ¡c thao tÃ¡c trÃªn Ä‘á»u lÃ  thao tÃ¡c nguyÃªn tá»­.</p>
</blockquote>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200924112342.svg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>
<p>Äáº·c Ä‘iá»ƒm cá»§a thao tÃ¡c chÃ¨n:</p>
<ul>
<li>Táº¥t cáº£ cÃ¡c thao tÃ¡c ghi trong MongoDB Ä‘á»u lÃ  thao tÃ¡c nguyÃªn tá»­ cáº¥p tÃ i liá»‡u duy nháº¥t.</li>
<li>Náº¿u bá»™ sÆ°u táº­p mÃ  báº¡n muá»‘n chÃ¨n khÃ´ng tá»“n táº¡i, thÃ¬ thao tÃ¡c chÃ¨n sáº½ tá»± Ä‘á»™ng táº¡o bá»™ sÆ°u táº­p Ä‘Ã³.</li>
<li>Trong MongoDB, má»—i tÃ i liá»‡u Ä‘Æ°á»£c lÆ°u trá»¯ trong má»™t bá»™ sÆ°u táº­p cáº§n cÃ³ má»™t trÆ°á»ng <a href="https://docs.mongodb.com/manual/reference/glossary/#term-id" target="_blank" rel="noopener noreferrer"><code>_id</code></a> duy nháº¥t lÃ m khÃ³a chÃ­nh. Náº¿u tÃ i liá»‡u chÃ¨n thiáº¿u trÆ°á»ng <code>_id</code>, thÃ¬ trÃ¬nh Ä‘iá»u khiá»ƒn MongoDB sáº½ tá»± Ä‘á»™ng táº¡o ra trÆ°á»ng <code>_id</code> dÆ°á»›i dáº¡ng ObjectId.</li>
<li>Báº¡n cÃ³ thá»ƒ Ä‘iá»u chá»‰nh cáº¥p Ä‘á»™ xÃ¡c nháº­n cá»§a thao tÃ¡c ghi trong MongoDB.</li>
</ul>
<p>ã€VÃ­ dá»¥ã€‘VÃ­ dá»¥ chÃ¨n má»™t tÃ i liá»‡u:</p>
<div class="language-javascript" data-ext="javascript" data-title="javascript"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">db</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">inventory</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">insertOne</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">({</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  item</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'canvas'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  qty</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">100</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  tags</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span><span style="color:#98C379;--shiki-dark:#98C379">'cotton'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">],</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  size</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">h</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">28</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">w</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">35.5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">uom</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'cm'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">})</span></span></code></pre>
</div><p>ã€VÃ­ dá»¥ã€‘VÃ­ dá»¥ chÃ¨n nhiá»u tÃ i liá»‡u:</p>
<div class="language-javascript line-numbers-mode" data-ext="javascript" data-title="javascript"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">db</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">inventory</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">insertMany</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">([</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    item</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'journal'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    qty</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">25</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    tags</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span><span style="color:#98C379;--shiki-dark:#98C379">'blank'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">'red'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">],</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    size</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">h</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">14</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">w</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">21</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">uom</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'cm'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    item</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'mat'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    qty</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">85</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    tags</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span><span style="color:#98C379;--shiki-dark:#98C379">'gray'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">],</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    size</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">h</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">27.9</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">w</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">35.5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">uom</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'cm'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    item</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'mousepad'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    qty</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">25</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    tags</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span><span style="color:#98C379;--shiki-dark:#98C379">'gel'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">'blue'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">],</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    size</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">h</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">19</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">w</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">22.85</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">uom</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'cm'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">])</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>Thao tÃ¡c Read (Äá»c)</h3>
<p>MongoDB cung cáº¥p phÆ°Æ¡ng thá»©c <a href="https://docs.mongodb.com/manual/reference/method/db.collection.find/#db.collection.find" target="_blank" rel="noopener noreferrer"><code>db.collection.find()</code></a> Ä‘á»ƒ truy váº¥n tÃ i liá»‡u.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200924113832.svg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>
<h3>Thao tÃ¡c Update (Cáº­p nháº­t)</h3>
<p>MongoDB cung cáº¥p cÃ¡c thao tÃ¡c sau Ä‘á»ƒ cáº­p nháº­t tÃ i liá»‡u trong má»™t bá»™ sÆ°u táº­p:</p>
<ul>
<li><a href="https://docs.mongodb.com/manual/reference/method/db.collection.updateOne/#db.collection.updateOne" target="_blank" rel="noopener noreferrer"><code>db.collection.updateOne()</code></a>: Cáº­p nháº­t má»™t tÃ i liá»‡u.</li>
<li><a href="https://docs.mongodb.com/manual/reference/method/db.collection.updateMany/#db.collection.updateMany" target="_blank" rel="noopener noreferrer"><code>db.collection.updateMany()</code></a>: Cáº­p nháº­t nhiá»u tÃ i liá»‡u.</li>
<li><a href="https://docs.mongodb.com/manual/reference/method/db.collection.replaceOne/#db.collection.replaceOne" target="_blank" rel="noopener noreferrer"><code>db.collection.replaceOne()</code></a>: Thay tháº¿ má»™t tÃ i liá»‡u.</li>
</ul>
<p>CÃº phÃ¡p:</p>
<ul>
<li><a href="https://docs.mongodb.com/manual/reference/method/db.collection.updateOne/#db.collection.updateOne" target="_blank" rel="noopener noreferrer"><code>db.collection.updateOne(&lt;filter&gt;, &lt;update&gt;, &lt;options&gt;)</code></a></li>
<li><a href="https://docs.mongodb.com/manual/reference/method/db.collection.updateMany/#db.collection.updateMany" target="_blank" rel="noopener noreferrer"><code>db.collection.updateMany(&lt;filter&gt;, &lt;update&gt;, &lt;options&gt;)</code></a></li>
<li><a href="https://docs.mongodb.com/manual/reference/method/db.collection.replaceOne/#db.collection.replaceOne" target="_blank" rel="noopener noreferrer"><code>db.collection.replaceOne(&lt;filter&gt;, &lt;update&gt;, &lt;options&gt;)</code></a></li>
</ul>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200924114043.svg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>
<p>ã€VÃ­ dá»¥ã€‘ChÃ¨n dá»¯ liá»‡u thá»­ nghiá»‡m:</p>
<div class="language-javascript line-numbers-mode" data-ext="javascript" data-title="javascript"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">db</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">inventory</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">insertMany</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">([</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    item</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'canvas'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    qty</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">100</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    size</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">h</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">28</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">w</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">35.5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">uom</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'cm'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    status</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'A'</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">item</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'journal'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">qty</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">25</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">size</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">h</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">14</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">w</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">21</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">uom</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'cm'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }, </span><span style="color:#E06C75;--shiki-dark:#E06C75">status</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'A'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">item</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'mat'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">qty</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">85</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">size</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">h</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">27.9</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">w</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">35.5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">uom</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'cm'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }, </span><span style="color:#E06C75;--shiki-dark:#E06C75">status</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'A'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    item</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'mousepad'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    qty</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">25</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    size</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">h</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">19</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">w</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">22.85</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">uom</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'cm'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    status</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'P'</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    item</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'notebook'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    qty</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">50</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    size</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">h</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">8.5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">w</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">11</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">uom</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'in'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    status</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'P'</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">item</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'paper'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">qty</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">100</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">size</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">h</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">8.5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">w</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">11</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">uom</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'in'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }, </span><span style="color:#E06C75;--shiki-dark:#E06C75">status</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'D'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    item</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'planner'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    qty</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">75</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    size</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">h</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">22.85</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">w</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">30</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">uom</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'cm'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    status</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'D'</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    item</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'postcard'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    qty</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">45</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    size</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">h</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">w</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">15.25</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">uom</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'cm'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    status</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'A'</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    item</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'sketchbook'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    qty</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">80</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    size</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">h</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">14</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">w</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">21</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">uom</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'cm'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    status</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'A'</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    item</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'sketch pad'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    qty</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">95</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    size</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">h</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">22.85</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">w</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">30.5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">uom</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'cm'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    status</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'A'</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">])</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ã€VÃ­ dá»¥ã€‘Cáº­p nháº­t má»™t tÃ i liá»‡u:</p>
<div class="language-javascript" data-ext="javascript" data-title="javascript"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">db</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">inventory</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">updateOne</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">item</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'paper'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    $set</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#98C379;--shiki-dark:#98C379">'size.uom'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'cm'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">status</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'P'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    $currentDate</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">lastModified</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">true</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)</span></span></code></pre>
</div><p>ã€VÃ­ dá»¥ã€‘Cáº­p nháº­t nhiá»u tÃ i liá»‡u:</p>
<div class="language-javascript" data-ext="javascript" data-title="javascript"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">db</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">inventory</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">updateMany</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">qty</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">$lt</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">50</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> } },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    $set</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#98C379;--shiki-dark:#98C379">'size.uom'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'in'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">status</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'P'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    $currentDate</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">lastModified</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">true</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)</span></span></code></pre>
</div><p>ã€VÃ­ dá»¥ã€‘Thay tháº¿ má»™t tÃ i liá»‡u:</p>
<div class="language-javascript" data-ext="javascript" data-title="javascript"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">db</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">inventory</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">replaceOne</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">item</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'paper'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    item</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'paper'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    instock</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      { </span><span style="color:#E06C75;--shiki-dark:#E06C75">warehouse</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'A'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">qty</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">60</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      { </span><span style="color:#E06C75;--shiki-dark:#E06C75">warehouse</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'B'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">qty</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">40</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    ]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)</span></span></code></pre>
</div><p>Äáº·c Ä‘iá»ƒm cá»§a thao tÃ¡c cáº­p nháº­t:</p>
<ul>
<li>Táº¥t cáº£ cÃ¡c thao tÃ¡c ghi trong MongoDB Ä‘á»u lÃ  thao tÃ¡c nguyÃªn tá»­ cáº¥p tÃ i liá»‡u duy nháº¥t.</li>
<li>Má»™t khi Ä‘Ã£ Ä‘Æ°á»£c thiáº¿t láº­p, khÃ´ng thá»ƒ cáº­p nháº­t hoáº·c thay tháº¿ trÆ°á»ng <a href="https://docs.mongodb.com/manual/reference/glossary/#term-id" target="_blank" rel="noopener noreferrer"><code>_id</code></a>.</li>
<li>MongoDB sáº½ giá»¯ nguyÃªn thá»© tá»± cÃ¡c trÆ°á»ng trong tÃ i liá»‡u sau khi thá»±c hiá»‡n thao tÃ¡c ghi, trá»« khi:
<ul>
<li>TrÆ°á»ng <code>_id</code> luÃ´n lÃ  trÆ°á»ng Ä‘áº§u tiÃªn trong tÃ i liá»‡u.</li>
<li>CÃ¡c thao tÃ¡c cáº­p nháº­t bao gá»“m viá»‡c Ä‘á»•i tÃªn trÆ°á»ng cÃ³ thá»ƒ dáº«n Ä‘áº¿n sáº¯p xáº¿p láº¡i cÃ¡c trÆ°á»ng trong tÃ i liá»‡u.</li>
</ul>
</li>
<li>Náº¿u thao tÃ¡c cáº­p nháº­t chá»©a <code>upsert: true</code> vÃ  khÃ´ng cÃ³ tÃ i liá»‡u nÃ o khá»›p vá»›i bá»™ lá»c, MongoDB sáº½ chÃ¨n má»™t tÃ i liá»‡u má»›i; náº¿u cÃ³ tÃ i liá»‡u khá»›p, MongoDB sáº½ cáº­p nháº­t hoáº·c thay tháº¿ cÃ¡c tÃ i liá»‡u Ä‘Ã³.</li>
</ul>
<h3>Thao tÃ¡c Delete (XÃ³a)</h3>
<p>MongoDB cung cáº¥p cÃ¡c thao tÃ¡c sau Ä‘á»ƒ xÃ³a tÃ i liá»‡u trong má»™t bá»™ sÆ°u táº­p:</p>
<ul>
<li><a href="https://docs.mongodb.com/manual/reference/method/db.collection.deleteOne/#db.collection.deleteOne" target="_blank" rel="noopener noreferrer"><code>db.collection.deleteOne()</code></a>: XÃ³a má»™t tÃ i liá»‡u.</li>
<li><a href="https://docs.mongodb.com/manual/reference/method/db.collection.deleteMany/#db.collection.deleteMany" target="_blank" rel="noopener noreferrer"><code>db.collection.deleteMany()</code></a>: XÃ³a nhiá»u tÃ i liá»‡u.</li>
</ul>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200924120007.svg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>
<p>Äáº·c Ä‘iá»ƒm cá»§a thao tÃ¡c xÃ³a:</p>
<ul>
<li>Táº¥t cáº£ cÃ¡c thao tÃ¡c ghi trong MongoDB Ä‘á»u lÃ  thao tÃ¡c nguyÃªn tá»­ cáº¥p tÃ i liá»‡u duy nháº¥t.</li>
</ul>
<h2>II. Thao tÃ¡c ghi hÃ ng loáº¡t</h2>
<p>MongoDB há»— trá»£ thao tÃ¡c ghi hÃ ng loáº¡t (bao gá»“m chÃ¨n hÃ ng loáº¡t, cáº­p nháº­t hÃ ng loáº¡t, xÃ³a hÃ ng loáº¡t) thÃ´ng qua phÆ°Æ¡ng thá»©c <a href="https://docs.mongodb.com/manual/reference/method/db.collection.bulkWrite/#db.collection.bulkWrite" target="_blank" rel="noopener noreferrer"><code>db.collection.bulkWrite()</code></a>.</p>
<p>NgoÃ i ra, phÆ°Æ¡ng thá»©c <a href="https://docs.mongodb.com/manual/reference/method/db.collection.insertMany/#db.collection.insertMany" target="_blank" rel="noopener noreferrer"><code>db.collection.insertMany()</code></a> cÅ©ng há»— trá»£ thao tÃ¡c chÃ¨n hÃ ng loáº¡t.</p>
<h3>Thao tÃ¡c cÃ³ thá»© tá»± vÃ  khÃ´ng cÃ³ thá»© tá»±</h3>
<p>Thao tÃ¡c ghi hÃ ng loáº¡t cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n theo thá»© tá»± hoáº·c khÃ´ng cÃ³ thá»© tá»±.</p>
<ul>
<li>Äá»‘i vá»›i danh sÃ¡ch cÃ³ thá»© tá»±, MongoDB thá»±c hiá»‡n cÃ¡c thao tÃ¡c theo thá»© tá»±. Náº¿u cÃ³ lá»—i xáº£y ra trong quÃ¡ trÃ¬nh xá»­ lÃ½ thao tÃ¡c ghi, MongoDB sáº½ khÃ´ng xá»­ lÃ½ cÃ¡c thao tÃ¡c ghi cÃ²n láº¡i trong danh sÃ¡ch.</li>
<li>Äá»‘i vá»›i danh sÃ¡ch khÃ´ng cÃ³ thá»© tá»±, MongoDB cÃ³ thá»ƒ thá»±c hiá»‡n cÃ¡c thao tÃ¡c song song, nhÆ°ng khÃ´ng Ä‘áº£m báº£o hÃ nh vi nÃ y. Náº¿u cÃ³ lá»—i xáº£y ra trong quÃ¡ trÃ¬nh xá»­ lÃ½ thao tÃ¡c ghi, MongoDB sáº½ tiáº¿p tá»¥c xá»­ lÃ½ cÃ¡c thao tÃ¡c ghi cÃ²n láº¡i trong danh sÃ¡ch.</li>
</ul>
<p>Thá»±c hiá»‡n cÃ¡c thao tÃ¡c cÃ³ thá»© tá»± trÃªn má»™t táº­p há»£p phÃ¢n Ä‘oáº¡n thÆ°á»ng cháº­m hÆ¡n thá»±c hiá»‡n cÃ¡c thao tÃ¡c khÃ´ng cÃ³ thá»© tá»±, vÃ¬ Ä‘á»‘i vá»›i cÃ¡c thao tÃ¡c cÃ³ thá»© tá»±, má»—i thao tÃ¡c pháº£i chá» Ä‘á»£i thao tÃ¡c trÆ°á»›c hoÃ n thÃ nh.</p>
<p>Máº·c Ä‘á»‹nh, <a href="https://docs.mongodb.com/manual/reference/method/db.collection.bulkWrite/#db.collection.bulkWrite" target="_blank" rel="noopener noreferrer"><code>bulkWrite()</code></a> thá»±c hiá»‡n cÃ¡c thao tÃ¡c cÃ³ thá»© tá»±. Äá»ƒ chá»‰ Ä‘á»‹nh cÃ¡c thao tÃ¡c ghi khÃ´ng cÃ³ thá»© tá»±, hÃ£y Ä‘áº·t <code>ordered: false</code> trong tÃ i liá»‡u tÃ¹y chá»n.</p>
<h3>PhÆ°Æ¡ng thá»©c bulkWrite()</h3>
<p><a href="https://docs.mongodb.com/manual/reference/method/db.collection.bulkWrite/#db.collection.bulkWrite" target="_blank" rel="noopener noreferrer"><code>bulkWrite()</code></a> há»— trá»£ cÃ¡c thao tÃ¡c ghi sau Ä‘Ã¢y:</p>
<ul>
<li><a href="https://docs.mongodb.com/manual/reference/method/db.collection.bulkWrite/#bulkwrite-write-operations-insertone" target="_blank" rel="noopener noreferrer">insertOne</a></li>
<li><a href="https://docs.mongodb.com/manual/reference/method/db.collection.bulkWrite/#bulkwrite-write-operations-updateonemany" target="_blank" rel="noopener noreferrer">updateOne</a></li>
<li><a href="https://docs.mongodb.com/manual/reference/method/db.collection.bulkWrite/#bulkwrite-write-operations-updateonemany" target="_blank" rel="noopener noreferrer">updateMany</a></li>
<li><a href="https://docs.mongodb.com/manual/reference/method/db.collection.bulkWrite/#bulkwrite-write-operations-replaceone" target="_blank" rel="noopener noreferrer">replaceOne</a></li>
<li><a href="https://docs.mongodb.com/manual/reference/method/db.collection.bulkWrite/#bulkwrite-write-operations-deleteonemany" target="_blank" rel="noopener noreferrer">deleteOne</a></li>
<li><a href="https://docs.mongodb.com/manual/reference/method/db.collection.bulkWrite/#bulkwrite-write-operations-deleteonemany" target="_blank" rel="noopener noreferrer">deleteMany</a></li>
</ul>
<p>ã€VÃ­ dá»¥ã€‘VÃ­ dá»¥ vá» thao tÃ¡c ghi hÃ ng loáº¡t:</p>
<div class="language-javascript line-numbers-mode" data-ext="javascript" data-title="javascript"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">try</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">  db</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">characters</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">bulkWrite</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">([</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      insertOne</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">        document</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">          _id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">          char</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'Dithras'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">          class</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'barbarian'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">          lvl</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">4</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      insertOne</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">        document</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">          _id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">          char</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'Taeln'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">          class</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'fighter'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">          lvl</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">3</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      updateOne</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">        filter</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">char</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'Eldon'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">        update</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">$set</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">status</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'Critical Injury'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> } }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    { </span><span style="color:#E06C75;--shiki-dark:#E06C75">deleteOne</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">filter</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">char</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'Brisbane'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> } } },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      replaceOne</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">        filter</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">char</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'Meldane'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">        replacement</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">char</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'Tanys'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">class</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'oracle'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">lvl</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  ])</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">} </span><span style="color:#C678DD;--shiki-dark:#C678DD">catch</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> (</span><span style="color:#E06C75;--shiki-dark:#E06C75">e</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">  print</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#E06C75;--shiki-dark:#E06C75">e</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>Chiáº¿n lÆ°á»£c thao tÃ¡c ghi hÃ ng loáº¡t</h3>
<p>CÃ¡c thao tÃ¡c chÃ¨n hÃ ng loáº¡t lá»›n (bao gá»“m chÃ¨n dá»¯ liá»‡u ban Ä‘áº§u hoáº·c nháº­p dá»¯ liá»‡u thÆ°á»ng xuyÃªn) cÃ³ thá»ƒ áº£nh hÆ°á»Ÿng Ä‘áº¿n hiá»‡u suáº¥t cá»§a cá»¥m phÃ¢n Ä‘oáº¡n. Äá»‘i vá»›i thao tÃ¡c chÃ¨n hÃ ng loáº¡t, hÃ£y xem xÃ©t cÃ¡c chiáº¿n lÆ°á»£c sau:</p>
<h4>TrÆ°á»›c khi tÃ¡ch collection</h4>
<p>Náº¿u táº­p há»£p phÃ¢n Ä‘oáº¡n rá»—ng, táº­p há»£p Ä‘Ã³ chá»‰ cÃ³ má»™t phÃ¢n Ä‘oáº¡n ban Ä‘áº§u náº±m trÃªn má»™t phÃ¢n Ä‘oáº¡n duy nháº¥t. Sau Ä‘Ã³, MongoDB pháº£i máº¥t má»™t khoáº£ng thá»i gian Ä‘á»ƒ nháº­n dá»¯ liá»‡u, táº¡o cÃ¡c phÃ¢n Ä‘oáº¡n vÃ  phÃ¢n phá»‘i cÃ¡c phÃ¢n Ä‘oáº¡n Ä‘Ã£ tÃ¡ch Ä‘áº¿n cÃ¡c phÃ¢n Ä‘oáº¡n kháº£ dá»¥ng. Äá»ƒ trÃ¡nh chi phÃ­ hiá»‡u suáº¥t nÃ y, báº¡n cÃ³ thá»ƒ tiá»n tÃ¡ch collection theo hÆ°á»›ng dáº«n vá» tÃ¡ch phÃ¢n Ä‘oáº¡n trong cá»¥m phÃ¢n Ä‘oáº¡n.</p>
<h4>Thao tÃ¡c ghi khÃ´ng cÃ³ thá»© tá»±</h4>
<p>Äá»ƒ cáº£i thiá»‡n hiá»‡u suáº¥t ghi vÃ o cá»¥m phÃ¢n Ä‘oáº¡n, hÃ£y sá»­ dá»¥ng <a href="https://docs.mongodb.com/manual/reference/method/db.collection.bulkWrite/#db.collection.bulkWrite" target="_blank" rel="noopener noreferrer"><code>bulkWrite()</code></a> vÃ  Ä‘áº·t tham sá»‘ tÃ¹y chá»n <code>ordered</code> thÃ nh false. <a href="https://docs.mongodb.com/manual/reference/program/mongos/#bin.mongos" target="_blank" rel="noopener noreferrer"><code>mongos</code></a> cÃ³ thá»ƒ cá»‘ gáº¯ng gá»­i cÃ¡c thao tÃ¡c ghi Ä‘áº¿n nhiá»u phÃ¢n Ä‘oáº¡n cÃ¹ng má»™t lÃºc. Äá»‘i vá»›i táº­p há»£p trá»‘ng, hÃ£y tiá»n tÃ¡ch collection theo hÆ°á»›ng dáº«n tÃ¡ch phÃ¢n Ä‘oáº¡n trong cá»¥m phÃ¢n Ä‘oáº¡n.</p>
<h4>TrÃ¡nh luá»“ng dá»¯ liá»‡u Ä‘Æ¡n Ä‘iá»‡u</h4>
<p>Náº¿u trong má»™t thao tÃ¡c chÃ¨n, khÃ³a phÃ¢n Ä‘oáº¡n tÄƒng dáº§n, táº¥t cáº£ dá»¯ liá»‡u chÃ¨n sáº½ Ä‘Æ°á»£c lÆ°u trá»¯ trong phÃ¢n Ä‘oáº¡n cuá»‘i cÃ¹ng cá»§a táº­p há»£p, tá»©c lÃ  chá»‰ lÆ°u trá»¯ trong má»™t phÃ¢n Ä‘oáº¡n. Do Ä‘Ã³, kháº£ nÄƒng chÃ¨n cá»§a cá»¥m sáº½ khÃ´ng bao giá» vÆ°á»£t quÃ¡ kháº£ nÄƒng chÃ¨n cá»§a má»™t phÃ¢n Ä‘oáº¡n duy nháº¥t.</p>
<p>Náº¿u lÆ°á»£ng dá»¯ liá»‡u chÃ¨n lá»›n hÆ¡n kháº£ nÄƒng chÃ¨n cá»§a má»™t phÃ¢n Ä‘oáº¡n duy nháº¥t vÃ  khÃ´ng thá»ƒ trÃ¡nh Ä‘Æ°á»£c khÃ³a phÃ¢n Ä‘oáº¡n tÄƒng dáº§n, hÃ£y xem xÃ©t cÃ¡c sá»­a Ä‘á»•i sau Ä‘Ã¢y cho á»©ng dá»¥ng:</p>
<ul>
<li>Äáº£o ngÆ°á»£c cÃ¡c bit nhá»‹ phÃ¢n cá»§a khÃ³a phÃ¢n Ä‘oáº¡n. Äiá»u nÃ y giá»¯ nguyÃªn thÃ´ng tin vÃ  trÃ¡nh liÃªn káº¿t thá»© tá»± chÃ¨n vá»›i sá»± gia tÄƒng giÃ¡ trá»‹.</li>
<li>HoÃ¡n Ä‘á»•i 16 bit Ä‘áº§u tiÃªn vÃ  cuá»‘i cÃ¹ng cá»§a khÃ³a Ä‘á»ƒ chÃ¨n "ngáº«u nhiÃªn".</li>
</ul>
<h2>So sÃ¡nh SQL vÃ  MongoDB</h2>
<h3>Thuáº­t ngá»¯ vÃ  KhÃ¡i niá»‡m</h3>
<p>| Thuáº­t ngá»¯ vÃ  KhÃ¡i niá»‡m SQL    | Thuáº­t ngá»¯ vÃ  KhÃ¡i niá»‡m MongoDB                                                                                                                                                                                                                         |<br>
|:</p>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200924112342.svg" type="image/svg+xml"/>
    </item>
    <item>
      <title>MongoDB Guide</title>
      <link>https://vanhung4499.github.io/database/mongodb/guide.html</link>
      <guid>https://vanhung4499.github.io/database/mongodb/guide.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">MongoDB Guide</source>
      <description>HÆ°á»›ng dáº«n MongoDB Giá»›i thiá»‡u MongoDB lÃ  má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u dá»±a trÃªn há»‡ thá»‘ng lÆ°u trá»¯ tá»‡p phÃ¢n tÃ¡n. ÄÆ°á»£c viáº¿t báº±ng ngÃ´n ngá»¯ C++. Má»¥c tiÃªu lÃ  cung cáº¥p má»™t giáº£i phÃ¡p lÆ°u trá»¯ dá»¯ liá»‡u...</description>
      <category>mongodb</category>
      <category>nosql</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>Giá»›i thiá»‡u</h2>
<p>MongoDB lÃ  má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u dá»±a trÃªn há»‡ thá»‘ng lÆ°u trá»¯ tá»‡p phÃ¢n tÃ¡n. ÄÆ°á»£c viáº¿t báº±ng ngÃ´n ngá»¯ C++. Má»¥c tiÃªu lÃ  cung cáº¥p má»™t giáº£i phÃ¡p lÆ°u trá»¯ dá»¯ liá»‡u cÃ³ kháº£ nÄƒng má»Ÿ rá»™ng vÃ  hiá»‡u suáº¥t cao cho cÃ¡c á»©ng dá»¥ng web.</p>
<p>MongoDB lÆ°u trá»¯ dá»¯ liá»‡u dÆ°á»›i dáº¡ng tÃ i liá»‡u, cáº¥u trÃºc dá»¯ liá»‡u bao gá»“m cÃ¡c cáº·p khÃ³a-giÃ¡ trá»‹ (key-value). TÃ i liá»‡u trong MongoDB tÆ°Æ¡ng tá»± nhÆ° Ä‘á»‘i tÆ°á»£ng JSON. GiÃ¡ trá»‹ cá»§a trÆ°á»ng cÃ³ thá»ƒ chá»©a cÃ¡c tÃ i liá»‡u khÃ¡c, máº£ng vÃ  máº£ng tÃ i liá»‡u.</p>
<h3>PhÃ¡t triá»ƒn cá»§a MongoDB</h3>
<ul>
<li>PhiÃªn báº£n 1.x - Há»— trá»£ sao chÃ©p vÃ  phÃ¢n Ä‘oáº¡n</li>
<li>PhiÃªn báº£n 2.x - CÃ¡c tÃ­nh nÄƒng cÆ¡ sá»Ÿ dá»¯ liá»‡u phong phÃº hÆ¡n</li>
<li>PhiÃªn báº£n 3.x - WiredTiger vÃ  há»‡ sinh thÃ¡i xung quanh</li>
<li>PhiÃªn báº£n 4.x - Há»— trá»£ giao dá»‹ch phÃ¢n tÃ¡n</li>
</ul>
<h3>MongoDB vÃ  RDBMS</h3>
<p>| TÃ­nh nÄƒng   | MongoDB                                          | RDBMS    |<br>
|</p>
]]></content:encoded>
    </item>
    <item>
      <title>MongoDB Model Example</title>
      <link>https://vanhung4499.github.io/database/mongodb/model-example.html</link>
      <guid>https://vanhung4499.github.io/database/mongodb/model-example.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">MongoDB Model Example</source>
      <description>VÃ­ dá»¥ vá» mÃ´ hÃ¬nh hÃ³a MongoDB MÃ´ hÃ¬nh quan há»‡ MÃ´ hÃ¬nh nhÃºng tÃ i liá»‡u má»™t má»™t MÃ´ hÃ¬nh nhÃºng tÃ i liá»‡u má»™t-má»™t - MÃ´ hÃ¬nh nhÃºng tÃ i liá»‡u Káº¿t há»£p thÃ nh: MÃ´ hÃ¬nh nhÃºng tÃ i liá»‡u má»™t-má»™t...</description>
      <category>db</category>
      <category>mongodb</category>
      <category>nosql</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>MÃ´ hÃ¬nh quan há»‡</h2>
<h3>MÃ´ hÃ¬nh nhÃºng tÃ i liá»‡u má»™t má»™t</h3>
<h4>MÃ´ hÃ¬nh nhÃºng tÃ i liá»‡u má»™t-má»™t - MÃ´ hÃ¬nh nhÃºng tÃ i liá»‡u</h4>
<div class="language-json" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">// patron document</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   _id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"joe"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   name</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Joe Bookreader"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">// address document</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   patron_id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"joe"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">// reference to patron document</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   street</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"123 Fake Street"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   city</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Faketon"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   state</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"MA"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   zip</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"12345"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><p>Káº¿t há»£p thÃ nh:</p>
<div class="language-json" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"joe"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "name"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Joe Bookreader"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "address"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "street"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"123 Fake Street"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "city"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Faketon"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "state"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"MA"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "zip"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"12345"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><h4>MÃ´ hÃ¬nh nhÃºng tÃ i liá»‡u má»™t-má»™t - MÃ´ hÃ¬nh con</h4>
<p>Giáº£ sá»­, cÃ³ má»™t bá»™ sÆ°u táº­p Ä‘á»‹nh nghÄ©a thÃ´ng tin vá» phim:</p>
<div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "title"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"The Arrival of a Train"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "year"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1896</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "runtime"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "released"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">ISODate(</span><span style="color:#98C379;--shiki-dark:#98C379">"01-25-1896"</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "poster"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"http://ia.media-imdb.com/images/M/MV5BMjEyNDk5MDYzOV5BMl5BanBnXkFtZTgwNjIxMTEwMzE@._V1_SX300.jpg"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "plot"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"A group of people are standing in a straight line along the platform of a railway station, waiting for a train, which is seen coming at some distance. When the train stops at the platform, ..."</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "fullplot"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"A group of people are standing in a straight line along the platform of a railway station, waiting for a train, which is seen coming at some distance. When the train stops at the platform, the line dissolves. The doors of the railway-cars open, and people on the platform help passengers to get off."</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "lastupdated"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">ISODate(</span><span style="color:#98C379;--shiki-dark:#98C379">"2015-08-15T10:06:53"</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "type"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"movie"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "directors"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span><span style="color:#98C379;--shiki-dark:#98C379">"Auguste LumiÃ¨re"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">"Louis LumiÃ¨re"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">],</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "imdb"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "rating"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">7.3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "votes"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">5043</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">12</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  },</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "countries"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span><span style="color:#98C379;--shiki-dark:#98C379">"France"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">],</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "genres"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span><span style="color:#98C379;--shiki-dark:#98C379">"Documentary"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">"Short"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">],</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "tomatoes"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "viewer"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "rating"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">3.7</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "numReviews"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">59</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    },</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "lastUpdated"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">ISODate(</span><span style="color:#98C379;--shiki-dark:#98C379">"2020-01-09T00:02:53"</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Trong á»©ng dá»¥ng, cÃ³ má»™t sá»‘ tÃ¬nh huá»‘ng chá»‰ cáº§n hiá»ƒn thá»‹ thÃ´ng tin tÃ³m táº¯t vá» phim, khÃ´ng cáº§n hiá»ƒn thá»‹ thÃ´ng tin chi tiáº¿t nhÆ° fullplot, poster. VÃ¬ váº­y, chÃºng ta cÃ³ thá»ƒ xem xÃ©t viá»‡c chia cáº¥u trÃºc ban Ä‘áº§u thÃ nh hai pháº§n vÃ  liÃªn káº¿t chÃºng thÃ´ng qua trÆ°á»ng id.</p>
<p>Bá»™ sÆ°u táº­p movie dÃ¹ng Ä‘á»ƒ hiá»ƒn thá»‹ thÃ´ng tin tÃ³m táº¯t</p>
<div class="language-json" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">// movie collection</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "title"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"The Arrival of a Train"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "year"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1896</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "runtime"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "released"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">ISODate(</span><span style="color:#98C379;--shiki-dark:#98C379">"1896-01-25"</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "type"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"movie"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "directors"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span><span style="color:#98C379;--shiki-dark:#98C379">"Auguste LumiÃ¨re"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">"Louis LumiÃ¨re"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">],</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "countries"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span><span style="color:#98C379;--shiki-dark:#98C379">"France"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">],</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "genres"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span><span style="color:#98C379;--shiki-dark:#98C379">"Documentary"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">"Short"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
</div><p>Bá»™ sÆ°u táº­p movie_details dÃ¹ng Ä‘á»ƒ hiá»ƒn thá»‹ thÃ´ng tin chi tiáº¿t</p>
<div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">// movie_details collection</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">156</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "movie_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">// tham chiáº¿u Ä‘áº¿n bá»™ sÆ°u táº­p movie</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "poster"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"http://ia.media-imdb.com/images/M/MV5BMjEyNDk5MDYzOV5BMl5BanBnXkFtZTgwNjIxMTEwMzE@._V1_SX300.jpg"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "plot"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"A group of people are standing in a straight line along the platform of a railway station, waiting for a train, which is seen coming at some distance. When the train stops at the platform, ..."</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "fullplot"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"A group of people are standing in a straight line along the platform of a railway station, waiting for a train, which is seen coming at some distance. When the train stops at the platform, the line dissolves. The doors of the railway-cars open, and people on the platform help passengers to get off."</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "lastupdated"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">ISODate(</span><span style="color:#98C379;--shiki-dark:#98C379">"2015-08-15T10:06:53"</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "imdb"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "rating"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">7.3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "votes"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">5043</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">12</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  },</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "tomatoes"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "viewer"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "rating"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">3.7</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "numReviews"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">59</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    },</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "lastUpdated"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">ISODate(</span><span style="color:#98C379;--shiki-dark:#98C379">"2020-01-29T00:02:53"</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>MÃ´ hÃ¬nh nhÃºng tÃ i liá»‡u má»™t-nhiá»u</h3>
<h4>MÃ´ hÃ¬nh nhÃºng tÃ i liá»‡u má»™t-nhiá»u - MÃ´ hÃ¬nh nhÃºng tÃ i liá»‡u</h4>
<div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">// TÃ i liá»‡u patron</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   _id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"joe"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   name</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Joe Bookreader"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">// TÃ i liá»‡u Ä‘á»‹a chá»‰</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   patron_id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"joe"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">// tham chiáº¿u Ä‘áº¿n tÃ i liá»‡u patron</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   street</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"123 Fake Street"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   city</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Faketon"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   state</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"MA"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   zip</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"12345"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   patron_id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"joe"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   street</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"1 Some Other Street"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   city</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Boston"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   state</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"MA"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   zip</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"12345"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Káº¿t há»£p thÃ nh:</p>
<div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"joe"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "name"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Joe Bookreader"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "addresses"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "street"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"123 Fake Street"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "city"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Faketon"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "state"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"MA"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "zip"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"12345"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "street"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"1 Some Other Street"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "city"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Boston"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "state"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"MA"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "zip"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"12345"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  ]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4>MÃ´ hÃ¬nh nhÃºng tÃ i liá»‡u má»™t-nhiá»u - MÃ´ hÃ¬nh con</h4>
<p>Xem xÃ©t má»™t bá»™ sÆ°u táº­p Ä‘áº¡i diá»‡n cho thÃ´ng tin sáº£n pháº©m trÃªn má»™t trang web thÆ°Æ¡ng máº¡i Ä‘iá»‡n tá»­:</p>
<div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "name"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Super Widget"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "description"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"This is the most useful item in your toolbox."</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "price"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">"value"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">NumberDecimal(</span><span style="color:#98C379;--shiki-dark:#98C379">"119.99"</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">"currency"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"USD"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "reviews"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "review_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">786</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "review_author"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Kristina"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "review_text"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"This is indeed an amazing widget."</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "published_date"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">ISODate(</span><span style="color:#98C379;--shiki-dark:#98C379">"2019-02-18"</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "review_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">785</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "review_author"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Trina"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "review_text"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Nice product. Slow shipping."</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "published_date"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">ISODate(</span><span style="color:#98C379;--shiki-dark:#98C379">"2019-02-17"</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    },</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">    ...</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "review_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "review_author"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Hans"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "review_text"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Meh, it's okay."</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "published_date"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">ISODate(</span><span style="color:#98C379;--shiki-dark:#98C379">"2017-12-06"</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  ]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>CÃ¡c Ä‘Ã¡nh giÃ¡ Ä‘Æ°á»£c sáº¯p xáº¿p theo thá»© tá»± thá»i gian giáº£m dáº§n. Khi ngÆ°á»i dÃ¹ng truy cáº­p trang sáº£n pháº©m, á»©ng dá»¥ng sáº½ táº£i lÃªn mÆ°á»i Ä‘Ã¡nh giÃ¡ gáº§n Ä‘Ã¢y nháº¥t. Thay vÃ¬ lÆ°u trá»¯ táº¥t cáº£ cÃ¡c Ä‘Ã¡nh giÃ¡ cÃ¹ng vá»›i thÃ´ng tin sáº£n pháº©m, chÃºng ta cÃ³ thá»ƒ chia bá»™ sÆ°u táº­p thÃ nh hai bá»™ sÆ°u táº­p, má»™t bá»™ sÆ°u táº­p chá»©a thÃ´ng tin sáº£n pháº©m vÃ  mÆ°á»i Ä‘Ã¡nh giÃ¡ gáº§n Ä‘Ã¢y nháº¥t:</p>
<p>Bá»™ sÆ°u táº­p sáº£n pháº©m lÆ°u trá»¯ thÃ´ng tin vá» má»—i sáº£n pháº©m, bao gá»“m mÆ°á»i Ä‘Ã¡nh giÃ¡ gáº§n Ä‘Ã¢y nháº¥t:</p>
<div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "name"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Super Widget"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "description"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"This is the most useful item in your toolbox."</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "price"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">"value"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">NumberDecimal(</span><span style="color:#98C379;--shiki-dark:#98C379">"119.99"</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">"currency"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"USD"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "reviews"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "review_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">786</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "review_author"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Kristina"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "review_text"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"This is indeed an amazing widget."</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "published_date"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">ISODate(</span><span style="color:#98C379;--shiki-dark:#98C379">"2019-02-18"</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">    ...</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "review_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">776</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "review_author"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Pablo"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "review_text"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Amazing!"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      "published_date"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">ISODate(</span><span style="color:#98C379;--shiki-dark:#98C379">"2019-02-16"</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  ]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Bá»™ sÆ°u táº­p chi tiáº¿t Ä‘Ã¡nh giÃ¡ lÆ°u trá»¯ táº¥t cáº£ cÃ¡c Ä‘Ã¡nh giÃ¡:</p>
<div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "review_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">786</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "product_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "review_author"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Kristina"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "review_text"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"This is indeed an amazing widget."</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "published_date"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">ISODate(</span><span style="color:#98C379;--shiki-dark:#98C379">"2019-02-18"</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "review_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">785</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "product_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "review_author"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Trina"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "review_text"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Nice product. Slow shipping."</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "published_date"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">ISODate(</span><span style="color:#98C379;--shiki-dark:#98C379">"2019-02-17"</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">...</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "review_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "product_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "review_author"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Hans"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "review_text"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Meh, it's okay."</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  "published_date"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">ISODate(</span><span style="color:#98C379;--shiki-dark:#98C379">"2017-12-06"</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>MÃ´ hÃ¬nh má»™t-nhiá»u dá»±a trÃªn tÃ i liá»‡u tham chiáº¿u</h3>
<p>Xem xÃ©t vÃ­ dá»¥ sau vá» má»‘i quan há»‡ giá»¯a nhÃ  xuáº¥t báº£n vÃ  sÃ¡ch.</p>
<p>VÃ­ dá»¥ nÃ y cho tháº¥y lá»£i Ã­ch cá»§a viá»‡c sá»­ dá»¥ng tÃ i liá»‡u tham chiáº¿u Ä‘á»ƒ trÃ¡nh viá»‡c láº·p láº¡i thÃ´ng tin vá» nhÃ  xuáº¥t báº£n.</p>
<div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   title</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"MongoDB: The Definitive Guide"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   author</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [ </span><span style="color:#98C379;--shiki-dark:#98C379">"Kristina Chodorow"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">"Mike Dirolf"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> ],</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   published_date</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">ISODate(</span><span style="color:#98C379;--shiki-dark:#98C379">"2010-09-24"</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   pages</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">216</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   language</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"English"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   publisher</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">              name</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"O'Reilly Media"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">              founded</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1980</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">              location</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"CA"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">            }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   title</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"50 Tips and Tricks for MongoDB Developer"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   author</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Kristina Chodorow"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   published_date</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">ISODate(</span><span style="color:#98C379;--shiki-dark:#98C379">"2011-05-06"</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   pages</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">68</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   language</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"English"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   publisher</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">              name</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"O'Reilly Media"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">              founded</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1980</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">              location</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"CA"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">            }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Äá»ƒ trÃ¡nh viá»‡c láº·p láº¡i thÃ´ng tin vá» nhÃ  xuáº¥t báº£n, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng tÃ i liá»‡u tham chiáº¿u vÃ  lÆ°u trá»¯ thÃ´ng tin vá» nhÃ  xuáº¥t báº£n riÃªng biá»‡t khá»i sÃ¡ch. Khi sá»­ dá»¥ng tham chiáº¿u, cÃ¡ch mÃ  má»‘i quan há»‡ tÄƒng lÃªn sáº½ quyáº¿t Ä‘á»‹nh nÆ¡i lÆ°u trá»¯ tham chiáº¿u. Náº¿u sá»‘ lÆ°á»£ng sÃ¡ch cá»§a má»—i nhÃ  xuáº¥t báº£n Ã­t vÃ  tÄƒng trÆ°á»Ÿng cÃ³ giá»›i háº¡n, Ä‘Ã´i khi viá»‡c lÆ°u trá»¯ tham chiáº¿u sÃ¡ch trong tÃ i liá»‡u nhÃ  xuáº¥t báº£n cÃ³ thá»ƒ há»¯u Ã­ch. NgÆ°á»£c láº¡i, náº¿u sá»‘ lÆ°á»£ng sÃ¡ch cá»§a má»—i nhÃ  xuáº¥t báº£n khÃ´ng bá»‹ giá»›i háº¡n, mÃ´ hÃ¬nh dá»¯ liá»‡u nÃ y sáº½ dáº«n Ä‘áº¿n má»™t máº£ng khÃ´ng Ä‘á»•i vÃ  khÃ´ng ngá»«ng tÄƒng, nhÆ° vÃ­ dá»¥ dÆ°á»›i Ä‘Ã¢y:</p>
<div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   name</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"O'Reilly Media"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   founded</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1980</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   location</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"CA"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   books</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span><span style="color:#D19A66;--shiki-dark:#D19A66">123456789</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#D19A66;--shiki-dark:#D19A66">234567890</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">...</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">    _id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">123456789</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">    title</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"MongoDB: The Definitive Guide"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">    author</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [ </span><span style="color:#98C379;--shiki-dark:#98C379">"Kristina Chodorow"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">"Mike Dirolf"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> ],</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">    published_date</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">ISODate(</span><span style="color:#98C379;--shiki-dark:#98C379">"2010-09-24"</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">    pages</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">216</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">    language</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"English"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   _id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">234567890</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   title</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"50 Tips and Tricks for MongoDB Developer"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   author</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Kristina Chodorow"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   published_date</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">ISODate(</span><span style="color:#98C379;--shiki-dark:#98C379">"2011-05-06"</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   pages</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">68</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   language</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"English"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Äá»ƒ trÃ¡nh máº£ng khÃ´ng Ä‘á»•i vÃ  khÃ´ng ngá»«ng tÄƒng, hÃ£y lÆ°u trá»¯ tham chiáº¿u Ä‘áº¿n nhÃ  xuáº¥t báº£n trong tÃ i liá»‡u sÃ¡ch:</p>
<div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   _id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"oreilly"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   name</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"O'Reilly Media"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   founded</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1980</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   location</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"CA"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   _id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">123456789</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   title</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"MongoDB: The Definitive Guide"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   author</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [ </span><span style="color:#98C379;--shiki-dark:#98C379">"Kristina Chodorow"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">"Mike Dirolf"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> ],</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   published_date</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">ISODate(</span><span style="color:#98C379;--shiki-dark:#98C379">"2010-09-24"</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   pages</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">216</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   language</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"English"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   publisher_id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"oreilly"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   _id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">234567890</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   title</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"50 Tips and Tricks for MongoDB Developer"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   author</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Kristina Chodorow"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   published_date</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">ISODate(</span><span style="color:#98C379;--shiki-dark:#98C379">"2011-05-06"</span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   pages</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">68</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   language</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"English"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">   publisher_id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"oreilly"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>MÃ´ hÃ¬nh cÃ¢y cÃ³ cáº¥u trÃºc</h2>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200911194846.svg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>
<h3>MÃ´ hÃ¬nh cÃ¢y cÃ³ cáº¥u trÃºc vá»›i nÃºt cha</h3>
<p>Cáº¥u trÃºc trÃªn cÃ³ thá»ƒ Ä‘Æ°á»£c biá»ƒu diá»…n báº±ng cÃ¡ch sá»­ dá»¥ng tham chiáº¿u cha:</p>
<div class="language-json" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">db.categories.insertMany([</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">"_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"MongoDB"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">"parent"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Databases"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">"_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"dbm"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">"parent"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Databases"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">"_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Databases"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">"parent"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Programming"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">"_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Languages"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">"parent"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Programming"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">"_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Programming"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">"parent"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Books"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">"_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Books"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">"parent"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">null</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">])</span></span></code></pre>
</div><ul>
<li>
<p>Truy váº¥n nÃºt cha cá»§a má»™t nÃºt:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>db.categories.findOne( { _id: "MongoDB" } ).parent</span></span></code></pre>
</div></li>
<li>
<p>CÃ³ thá»ƒ táº¡o chá»‰ má»¥c trÃªn trÆ°á»ng cha Ä‘á»ƒ tÃ¬m kiáº¿m nhanh nÃºt cha:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>db.categories.createIndex( { parent: 1 } )</span></span></code></pre>
</div></li>
<li>
<p>CÃ³ thá»ƒ tÃ¬m tháº¥y cÃ¡c nÃºt con trá»±c tiáº¿p thÃ´ng qua truy váº¥n trÆ°á»ng cha:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>db.categories.find( { parent: "Databases" } )</span></span></code></pre>
</div></li>
<li>
<p>Äá»ƒ truy váº¥n cÃ¢y con, báº¡n cÃ³ thá»ƒ tham kháº£o: <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/graphLookup/#pipe._S_graphLookup" target="_blank" rel="noopener noreferrer"><code>$graphLookup</code></a>.</p>
</li>
</ul>
<h3>MÃ´ hÃ¬nh cÃ¢y cÃ³ cáº¥u trÃºc vá»›i nÃºt con</h3>
<div class="language-json" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">db.categories.insertMany([</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">"_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"MongoDB"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">"children"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [] },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">"_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"dbm"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">"children"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [] },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">"_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Databases"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">"children"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span><span style="color:#98C379;--shiki-dark:#98C379">"MongoDB"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">"dbm"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">] },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">"_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Languages"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">"children"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [] },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">"_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Programming"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">"children"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span><span style="color:#98C379;--shiki-dark:#98C379">"Databases"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">"Languages"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">] },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">"_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Books"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">"children"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span><span style="color:#98C379;--shiki-dark:#98C379">"Programming"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">] }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">])</span></span></code></pre>
</div><ul>
<li>
<p>Truy váº¥n cÃ¡c nÃºt con cá»§a má»™t nÃºt:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>db.categories.findOne( { _id: "Databases" } ).children</span></span></code></pre>
</div></li>
<li>
<p>CÃ³ thá»ƒ táº¡o chá»‰ má»¥c trÃªn trÆ°á»ng children Ä‘á»ƒ tÃ¬m kiáº¿m nhanh cÃ¡c nÃºt con:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>db.categories.createIndex( { children: 1 } )</span></span></code></pre>
</div></li>
<li>
<p>CÃ³ thá»ƒ truy váº¥n cÃ¡c nÃºt thÃ´ng qua trÆ°á»ng children Ä‘á»ƒ tÃ¬m kiáº¿m nÃºt cha vÃ  cÃ¡c nÃºt anh em:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>db.categories.find( { children: "MongoDB" } )</span></span></code></pre>
</div></li>
</ul>
<h3>MÃ´ hÃ¬nh cÃ¢y cÃ³ cáº¥u trÃºc vá»›i tá»• tiÃªn</h3>
<div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">db.categories.insertMany([</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"MongoDB"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "ancestors"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span><span style="color:#98C379;--shiki-dark:#98C379">"Books"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">"Programming"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">"Databases"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">],</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "parent"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Databases"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"dbm"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "ancestors"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span><span style="color:#98C379;--shiki-dark:#98C379">"Books"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">"Programming"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">"Databases"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">],</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "parent"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Databases"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Databases"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "ancestors"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span><span style="color:#98C379;--shiki-dark:#98C379">"Books"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">"Programming"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">],</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "parent"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Programming"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Languages"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "ancestors"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span><span style="color:#98C379;--shiki-dark:#98C379">"Books"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">"Programming"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">],</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    "parent"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Programming"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">"_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Programming"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">"ancestors"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [</span><span style="color:#98C379;--shiki-dark:#98C379">"Books"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">], </span><span style="color:#E06C75;--shiki-dark:#E06C75">"parent"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Books"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">"_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Books"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">"ancestors"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: [], </span><span style="color:#E06C75;--shiki-dark:#E06C75">"parent"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">null</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">])</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul>
<li>
<p>Truy váº¥n tá»• tiÃªn cá»§a má»™t nÃºt hoáº·c Ä‘Æ°á»ng dáº«n lÃ  nhanh chÃ³ng vÃ  trá»±c tiáº¿p:</p>
<div class="language-json" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">db.categories.findOne({ </span><span style="color:#E06C75;--shiki-dark:#E06C75">"_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"MongoDB"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }).ancestors</span></span></code></pre>
</div></li>
<li>
<p>CÃ³ thá»ƒ táº¡o chá»‰ má»¥c trÃªn trÆ°á»ng ancestors Ä‘á»ƒ tÃ¬m kiáº¿m nhanh cÃ¡c nÃºt tá»• tiÃªn:</p>
<div class="language-json" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">db.categories.createIndex({ </span><span style="color:#E06C75;--shiki-dark:#E06C75">"ancestors"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> })</span></span></code></pre>
</div></li>
<li>
<p>CÃ³ thá»ƒ truy váº¥n táº¥t cáº£ cÃ¡c con chÃ¡u cá»§a má»™t nÃºt thÃ´ng qua trÆ°á»ng ancestors:</p>
<div class="language-json" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">db.categories.find({ </span><span style="color:#E06C75;--shiki-dark:#E06C75">"ancestors"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Programming"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> })</span></span></code></pre>
</div></li>
</ul>
<h3>MÃ´ hÃ¬nh cÃ¢y cÃ³ Ä‘Æ°á»ng dáº«n cá»¥ thá»ƒ</h3>
<div class="language-json" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">db.categories.insertMany([</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">"_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Books"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">"path"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">null</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">"_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Programming"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">"path"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">",Books,"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">"_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Databases"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">"path"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">",Books,Programming,"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">"_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"Languages"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">"path"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">",Books,Programming,"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">"_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"MongoDB"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">"path"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">",Books,Programming,Databases,"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">"_id"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">"dbm"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">"path"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">",Books,Programming,Databases,"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">])</span></span></code></pre>
</div><ul>
<li>
<p>CÃ³ thá»ƒ truy váº¥n Ä‘á»ƒ láº¥y toÃ n bá»™ cÃ¢y vÃ  sáº¯p xáº¿p theo trÆ°á»ng Ä‘Æ°á»ng dáº«n:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>db.categories.find().sort( { path: 1 } )</span></span></code></pre>
</div></li>
<li>
<p>CÃ³ thá»ƒ sá»­ dá»¥ng biá»ƒu thá»©c chÃ­nh quy trÃªn trÆ°á»ng path Ä‘á»ƒ tÃ¬m kiáº¿m cÃ¡c con chÃ¡u cá»§a Programming:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>db.categories.find( { path: /,Programming,/ } )</span></span></code></pre>
</div></li>
<li>
<p>CÃ³ thá»ƒ truy váº¥n cÃ¡c con chÃ¡u cá»§a Books, trong Ä‘Ã³ Books cÅ©ng náº±m á»Ÿ cáº¥p cao nháº¥t cá»§a cáº¥u trÃºc:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>db.categories.find( { path: /^,Books,/ } )</span></span></code></pre>
</div></li>
<li>
<p>Äá»ƒ táº¡o chá»‰ má»¥c trÃªn trÆ°á»ng path, hÃ£y sá»­ dá»¥ng lá»‡nh sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>db.categories.createIndex( { path: 1 } )</span></span></code></pre>
</div></li>
</ul>
<h3>MÃ´ hÃ¬nh cÃ¢y cÃ³ táº­p há»£p lá»“ng nhau</h3>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200911204252.svg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>
<div class="language-javascript" data-ext="javascript" data-title="javascript"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">db</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">categories</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">insertMany</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">([</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">_id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'Books'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">parent</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">left</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">right</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">12</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">_id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'Programming'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">parent</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'Books'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">left</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">right</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">11</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">_id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'Languages'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">parent</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'Programming'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">left</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">right</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">_id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'Databases'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">parent</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'Programming'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">left</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">right</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">_id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'MongoDB'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">parent</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'Databases'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">left</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">6</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">right</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">7</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  { </span><span style="color:#E06C75;--shiki-dark:#E06C75">_id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'dbm'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">parent</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'Databases'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">left</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">8</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75">right</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">9</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">])</span></span></code></pre>
</div><p>CÃ³ thá»ƒ truy váº¥n Ä‘á»ƒ láº¥y cÃ¡c con chÃ¡u cá»§a má»™t nÃºt:</p>
<div class="language-javascript" data-ext="javascript" data-title="javascript"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">var</span><span style="color:#E06C75;--shiki-dark:#E06C75"> databaseCategory</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> =</span><span style="color:#E5C07B;--shiki-dark:#E5C07B"> db</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">categories</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">findOne</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">({ </span><span style="color:#E06C75;--shiki-dark:#E06C75">_id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'Databases'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> })</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">db</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">categories</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">find</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">({</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  left</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">$gt</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#E5C07B;--shiki-dark:#E5C07B">databaseCategory</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#E06C75;--shiki-dark:#E06C75">left</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> },</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">  right</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">$lt</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#E5C07B;--shiki-dark:#E5C07B">databaseCategory</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#E06C75;--shiki-dark:#E06C75">right</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">})</span></span></code></pre>
</div><h2>Máº«u thiáº¿t káº¿</h2>
<h3>TÃ i liá»‡u lá»›n, nhiá»u cá»™t, nhiá»u chá»‰ má»¥c</h3>
<p>Giáº£i phÃ¡p lÃ : Chuyá»ƒn Ä‘á»•i tá»« cá»™t sang hÃ ng</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200919225901.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>
<h3>Quáº£n lÃ½ cÃ¡c phiÃªn báº£n tÃ i liá»‡u khÃ¡c nhau</h3>
<p>Äá»‹nh dáº¡ng tÃ i liá»‡u MongoDB ráº¥t linh hoáº¡t, Ä‘iá»u nÃ y cÃ³ thá»ƒ gÃ¢y khÃ³ khÄƒn trong viá»‡c duy trÃ¬ cÃ¡c phiÃªn báº£n.</p>
<p>Giáº£i phÃ¡p lÃ : CÃ³ thá»ƒ thÃªm má»™t trÆ°á»ng sá»‘ phiÃªn báº£n</p>
<ul>
<li>Nhanh chÃ³ng lá»c bá» cÃ¡c tÃ i liá»‡u khÃ´ng cáº§n nÃ¢ng cáº¥p</li>
<li>Khi nÃ¢ng cáº¥p, xá»­ lÃ½ khÃ¡c nhau cho cÃ¡c tÃ i liá»‡u cÃ³ phiÃªn báº£n khÃ¡c nhau</li>
</ul>
<h3>Thá»‘ng kÃª lÆ°á»£t nháº¥p vÃ o trang web</h3>
<p>YÃªu cáº§u Ä‘á»™ chÃ­nh xÃ¡c cá»§a dá»¯ liá»‡u thá»‘ng kÃª khÃ´ng quÃ¡ quan trá»ng.</p>
<p>Giáº£i phÃ¡p: Sá»­ dá»¥ng tÃ­nh toÃ¡n gáº§n Ä‘Ãºng</p>
<p>Ghi láº¡i sau má»—i 10 láº§n nháº¥p:</p>
<div class="language-json" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">{ </span><span style="color:#E06C75;--shiki-dark:#E06C75">"$inc"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">"views"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> } }</span></span></code></pre>
</div><h3>Thá»‘ng kÃª chÃ­nh xÃ¡c</h3>
<p>Giáº£i phÃ¡p: Sá»­ dá»¥ng tá»•ng há»£p trÆ°á»›c</p>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200911194846.svg" type="image/svg+xml"/>
    </item>
    <item>
      <title>MongoDB Modeling</title>
      <link>https://vanhung4499.github.io/database/mongodb/modeling.html</link>
      <guid>https://vanhung4499.github.io/database/mongodb/modeling.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">MongoDB Modeling</source>
      <description>MÃ´ hÃ¬nh hÃ³a MongoDB MÃ´ hÃ¬nh dá»¯ liá»‡u cá»§a MongoDB lÃ  má»™t mÃ´ hÃ¬nh linh hoáº¡t, trong khi cÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡ yÃªu cáº§u báº¡n Ä‘á»‹nh nghÄ©a cáº¥u trÃºc mÃ´ hÃ¬nh báº£ng trÆ°á»›c khi chÃ¨n dá»¯ liá»‡u. Tu...</description>
      <category>mongodb</category>
      <category>nosql</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<p>MÃ´ hÃ¬nh dá»¯ liá»‡u cá»§a MongoDB lÃ  má»™t mÃ´ hÃ¬nh linh hoáº¡t, trong khi cÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡ yÃªu cáº§u báº¡n Ä‘á»‹nh nghÄ©a cáº¥u trÃºc mÃ´ hÃ¬nh báº£ng trÆ°á»›c khi chÃ¨n dá»¯ liá»‡u. Tuy nhiÃªn, trong MongoDB, tÃ i liá»‡u khÃ´ng giá»›i háº¡n cáº¥u trÃºc. Äiá»u nÃ y giÃºp dá»… dÃ ng Ã¡nh xáº¡ giá»¯a Ä‘á»‘i tÆ°á»£ng vÃ  tÃ i liá»‡u cÆ¡ sá»Ÿ dá»¯ liá»‡u. Ngay cáº£ khi cÃ³ sá»± thay Ä‘á»•i lá»›n giá»¯a cÃ¡c báº£n ghi dá»¯ liá»‡u, má»—i tÃ i liá»‡u váº«n cÃ³ thá»ƒ Ã¡nh xáº¡ tá»‘t vÃ o cÃ¡c báº£n ghi khÃ¡c nhau. Tuy nhiÃªn, trong thá»±c táº¿, cÃ¡c tÃ i liá»‡u trong cÃ¹ng má»™t bá»™ sÆ°u táº­p thÆ°á»ng cÃ³ cáº¥u trÃºc tÆ°Æ¡ng tá»± nhau.</p>
<p>Viá»‡c thiáº¿t káº¿ mÃ´ hÃ¬nh dá»¯ liá»‡u lÃ  má»™t quÃ¡ trÃ¬nh Ä‘áº§y thÃ¡ch thá»©c, Ä‘Ã²i há»i cÃ¢n nháº¯c vÃ  cÃ¢n nháº¯c giá»¯a yÃªu cáº§u á»©ng dá»¥ng, hiá»‡u suáº¥t cá»§a cÆ¡ sá»Ÿ dá»¯ liá»‡u vÃ  mÃ´ hÃ¬nh Ä‘á»c/ghi dá»¯ liá»‡u. Khi thiáº¿t káº¿ mÃ´ hÃ¬nh dá»¯ liá»‡u, hÃ£y cÃ¢n nháº¯c yÃªu cáº§u á»©ng dá»¥ng vá»›i mÃ´ hÃ¬nh sá»­ dá»¥ng dá»¯ liá»‡u (nhÆ° truy váº¥n, cáº­p nháº­t vÃ  xá»­ lÃ½) cÅ©ng nhÆ° cáº¥u trÃºc tá»± nhiÃªn cá»§a dá»¯ liá»‡u.</p>
<h2>Nháº­p mÃ´n mÃ´ hÃ¬nh hoÃ¡ dá»¯ liá»‡u MongoDB</h2>
<blockquote>
<p>Tham kháº£o: <a href="https://docs.mongodb.com/guides/server/introduction/#what-you-ll-need" target="_blank" rel="noopener noreferrer">https://docs.mongodb.com/guides/server/introduction/#what-you-ll-need</a></p>
</blockquote>
<h3>(1) XÃ¡c Ä‘á»‹nh táº­p dá»¯ liá»‡u</h3>
<p>Khi cáº§n táº¡o lÆ°u trá»¯ dá»¯ liá»‡u, trÆ°á»›c háº¿t cáº§n Ä‘áº·t cÃ¢u há»i: Dá»¯ liá»‡u nÃ o cáº§n Ä‘Æ°á»£c lÆ°u trá»¯? CÃ¡c trÆ°á»ng nÃ y liÃªn quan nhÆ° tháº¿ nÃ o?</p>
<p>ÄÃ¢y lÃ  quÃ¡ trÃ¬nh thiáº¿t káº¿ dá»¯ liá»‡u. Má»¥c tiÃªu lÃ  <strong>trá»«u tÆ°á»£ng hÃ³a yÃªu cáº§u kinh doanh thÃ nh mÃ´ hÃ¬nh logic</strong>.</p>
<p>Giáº£ sá»­ cÃ³ má»™t tÃ¬nh huá»‘ng nhÆ° sau: ChÃºng ta cáº§n xÃ¢y dá»±ng cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘á»ƒ theo dÃµi váº­t liá»‡u vÃ  sá»‘ lÆ°á»£ng, kÃ­ch thÆ°á»›c, nhÃ£n hiá»‡u vÃ  xáº¿p háº¡ng cá»§a chÃºng.</p>
<p>Náº¿u lÆ°u trá»¯ trong RDBMS, cÃ³ thá»ƒ cÃ³ báº£ng dá»¯ liá»‡u nhÆ° sau:</p>
<p>| name     | quantity | size        | status | tags                     | rating |<br>
| :</p>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200910193231.png" type="image/png"/>
    </item>
    <item>
      <title>MongoDB Index</title>
      <link>https://vanhung4499.github.io/database/mongodb/mongo-index.html</link>
      <guid>https://vanhung4499.github.io/database/mongodb/mongo-index.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">MongoDB Index</source>
      <description>MongoDB Index Giá»›i thiá»‡u vá» Index trong MongoDB TÃ¡c dá»¥ng cá»§a Index MongoDB Ä‘á»‹nh nghÄ©a cÃ¡c chá»‰ má»¥c trÃªn cáº¥p dá»¯ liá»‡u cá»§a collection. Chá»‰ má»¥c thÆ°á»ng cÃ³ thá»ƒ cáº£i thiá»‡n Ä‘Ã¡ng ká»ƒ hiá»‡u s...</description>
      <category>mongodb</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>Giá»›i thiá»‡u vá» Index trong MongoDB</h2>
<h3>TÃ¡c dá»¥ng cá»§a Index</h3>
<p><strong>MongoDB Ä‘á»‹nh nghÄ©a cÃ¡c chá»‰ má»¥c trÃªn cáº¥p dá»¯ liá»‡u cá»§a collection</strong>.</p>
<p>Chá»‰ má»¥c thÆ°á»ng cÃ³ thá»ƒ cáº£i thiá»‡n Ä‘Ã¡ng ká»ƒ hiá»‡u suáº¥t cá»§a truy váº¥n. Náº¿u <strong>khÃ´ng cÃ³ chá»‰ má»¥c</strong>, MongoDB sáº½ pháº£i quÃ©t qua tá»«ng tÃ i liá»‡u trong collection vÃ  chá»n ra nhá»¯ng báº£n ghi phÃ¹ há»£p vá»›i Ä‘iá»u kiá»‡n truy váº¥n.</p>
<p>Viá»‡c quÃ©t toÃ n bá»™ collection nhÆ° váº­y lÃ  khÃ´ng hiá»‡u quáº£, Ä‘áº·c biá»‡t khi xá»­ lÃ½ lÆ°á»£ng dá»¯ liá»‡u lá»›n. Truy váº¥n cÃ³ thá»ƒ máº¥t vÃ i chá»¥c giÃ¢y hoáº·c tháº­m chÃ­ vÃ i phÃºt, Ä‘iá»u nÃ y lÃ  khÃ´ng cháº¥p nháº­n Ä‘Æ°á»£c vá» hiá»‡u suáº¥t.</p>
<p>Chá»‰ má»¥c lÃ  má»™t cáº¥u trÃºc dá»¯ liá»‡u Ä‘áº·c biá»‡t, Ä‘Æ°á»£c lÆ°u trá»¯ trong má»™t táº­p há»£p dá»¯ liá»‡u dá»… dÃ ng duyá»‡t vÃ  Ä‘á»c. Chá»‰ má»¥c sáº¯p xáº¿p cÃ¡c giÃ¡ trá»‹ cá»§a má»™t cá»™t hoáº·c nhiá»u cá»™t trong báº£ng cÆ¡ sá»Ÿ dá»¯ liá»‡u.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200921210621.svg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>
<h3>PhÆ°Æ¡ng thá»©c createIndex()</h3>
<p><strong>MongoDB sá»­ dá»¥ng phÆ°Æ¡ng thá»©c <code>createIndex()</code> Ä‘á»ƒ táº¡o chá»‰ má»¥c</strong>.</p>
<p>CÃº phÃ¡p cá»§a <code>createIndex()</code> nhÆ° sau:</p>
<div class="language-javascript" data-ext="javascript" data-title="javascript"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">db</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">collection</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">createIndex</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">( &lt;</span><span style="color:#E06C75;--shiki-dark:#E06C75">key</span><span style="color:#D19A66;--shiki-dark:#D19A66;font-style:italic;--shiki-dark-font-style:italic"> and</span><span style="color:#D19A66;--shiki-dark:#D19A66;font-style:italic;--shiki-dark-font-style:italic"> index</span><span style="color:#D19A66;--shiki-dark:#D19A66;font-style:italic;--shiki-dark-font-style:italic"> type</span><span style="color:#D19A66;--shiki-dark:#D19A66;font-style:italic;--shiki-dark-font-style:italic"> specification</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&gt;, &lt;</span><span style="color:#E06C75;--shiki-dark:#E06C75">options</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&gt; )</span></span></code></pre>
</div><p>Danh sÃ¡ch cÃ¡c tham sá»‘ tÃ¹y chá»n cá»§a <code>createIndex()</code> nhÆ° sau:</p>
<p>| Tham sá»‘            | Kiá»ƒu dá»¯ liá»‡u | MÃ´ táº£                                                                                                                                           |<br>
| :</p>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200921210621.svg" type="image/svg+xml"/>
    </item>
    <item>
      <title>MongoDB Operation</title>
      <link>https://vanhung4499.github.io/database/mongodb/operation.html</link>
      <guid>https://vanhung4499.github.io/database/mongodb/operation.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">MongoDB Operation</source>
      <description>Váº­n hÃ nh MongoDB CÃ i Ä‘áº·t MongoDB Windows (1) Táº£i xuá»‘ng vÃ  giáº£i nÃ©n Truy cáº­p vÃ o trang web chÃ­nh thá»©c Ä‘á»ƒ táº£i xuá»‘ng MongoDB vÃ  chá»n phiÃªn báº£n phÃ¹ há»£p táº¡i: Download MongoDB Communi...</description>
      <category>mongodb</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>CÃ i Ä‘áº·t MongoDB</h2>
<h3>Windows</h3>
<p>(1) Táº£i xuá»‘ng vÃ  giáº£i nÃ©n</p>
<p>Truy cáº­p vÃ o trang web chÃ­nh thá»©c Ä‘á»ƒ táº£i xuá»‘ng MongoDB vÃ  chá»n phiÃªn báº£n phÃ¹ há»£p táº¡i: <a href="https://www.mongodb.com/try/download/community" target="_blank" rel="noopener noreferrer">Download MongoDB Community Server | MongoDB</a></p>
<p>(2) Táº¡o thÆ° má»¥c dá»¯ liá»‡u</p>
<p>MongoDB lÆ°u trá»¯ dá»¯ liá»‡u trong thÆ° má»¥c db. Tuy nhiÃªn, thÆ° má»¥c nÃ y khÃ´ng Ä‘Æ°á»£c tá»± Ä‘á»™ng táº¡o ra, chÃºng ta cáº§n táº¡o nÃ³ sau khi cÃ i Ä‘áº·t.</p>
<p>VÃ­ dá»¥: <code>D:\Tools\Server\mongodb\mongodb-4.4.0\data\db</code></p>
<p>(3) Cháº¡y dá»‹ch vá»¥ MongoDB</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">mongod</span><span style="color:#D19A66;--shiki-dark:#D19A66"> --dbpath</span><span style="color:#98C379;--shiki-dark:#98C379"> D:</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">\T</span><span style="color:#98C379;--shiki-dark:#98C379">ools</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">\S</span><span style="color:#98C379;--shiki-dark:#98C379">erver</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">\m</span><span style="color:#98C379;--shiki-dark:#98C379">ongodb</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">\m</span><span style="color:#98C379;--shiki-dark:#98C379">ongodb-4.4.0</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">\d</span><span style="color:#98C379;--shiki-dark:#98C379">ata</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">\d</span><span style="color:#98C379;--shiki-dark:#98C379">b</span></span></code></pre>
</div><p>(4) Káº¿t ná»‘i vá»›i MongoDB tá»« mÃ¡y khÃ¡ch</p>
<p>Báº¡n cÃ³ thá»ƒ káº¿t ná»‘i vá»›i MongoDB báº±ng cÃ¡ch cháº¡y lá»‡nh <code>mongo.exe</code> trong cá»­a sá»• dÃ²ng lá»‡nh.</p>
<p>(5) Cáº¥u hÃ¬nh dá»‹ch vá»¥ MongoDB</p>
<h3>Linux</h3>
<p>(1) CÃ i Ä‘áº·t báº±ng gÃ³i cÃ i Ä‘áº·t</p>
<p>TrÆ°á»›c khi cÃ i Ä‘áº·t, chÃºng ta cáº§n cÃ i Ä‘áº·t cÃ¡c gÃ³i phá»¥ thuá»™c cho cÃ¡c ná»n táº£ng Linux.</p>
<p><strong>Red Hat/CentOS:</strong></p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>sudo yum install libcurl openssl</span></span></code></pre>
</div><p><strong>Ubuntu 18.04 LTS ("Bionic")/Debian 10 "Buster":</strong></p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>sudo apt-get install libcurl4 openssl</span></span></code></pre>
</div><p><strong>Ubuntu 16.04 LTS ("Xenial")/Debian 9 "Stretch":</strong></p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>sudo apt-get install libcurl3 openssl</span></span></code></pre>
</div><p>(2) Táº¡o thÆ° má»¥c dá»¯ liá»‡u</p>
<p>Máº·c Ä‘á»‹nh, MongoDB sáº½ khá»Ÿi táº¡o hai thÆ° má»¥c sau khi khá»Ÿi Ä‘á»™ng:</p>
<ul>
<li>ThÆ° má»¥c lÆ°u trá»¯ dá»¯ liá»‡u: /var/lib/mongodb</li>
<li>ThÆ° má»¥c ghi nháº­t kÃ½: /var/log/mongodb</li>
</ul>
<p>TrÆ°á»›c khi khá»Ÿi Ä‘á»™ng, chÃºng ta cÃ³ thá»ƒ táº¡o hai thÆ° má»¥c nÃ y vÃ  Ä‘áº·t quyá»n Ä‘á»c vÃ  ghi cho ngÆ°á»i dÃ¹ng hiá»‡n táº¡i:</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">sudo</span><span style="color:#98C379;--shiki-dark:#98C379"> mkdir</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -p</span><span style="color:#98C379;--shiki-dark:#98C379"> /var/lib/mongo</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">sudo</span><span style="color:#98C379;--shiki-dark:#98C379"> mkdir</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -p</span><span style="color:#98C379;--shiki-dark:#98C379"> /var/log/mongodb</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">sudo</span><span style="color:#98C379;--shiki-dark:#98C379"> chown</span><span style="color:#98C379;--shiki-dark:#98C379"> `</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">whoami</span><span style="color:#98C379;--shiki-dark:#98C379">`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> /var/lib/mongo</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">     # Äáº·t quyá»n</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">sudo</span><span style="color:#98C379;--shiki-dark:#98C379"> chown</span><span style="color:#98C379;--shiki-dark:#98C379"> `</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">whoami</span><span style="color:#98C379;--shiki-dark:#98C379">`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> /var/log/mongodb</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">   # Äáº·t quyá»n</span></span></code></pre>
</div><p>(3) Cháº¡y dá»‹ch vá»¥ MongoDB</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">mongod</span><span style="color:#D19A66;--shiki-dark:#D19A66"> --dbpath</span><span style="color:#98C379;--shiki-dark:#98C379"> /var/lib/mongo</span><span style="color:#D19A66;--shiki-dark:#D19A66"> --logpath</span><span style="color:#98C379;--shiki-dark:#98C379"> /var/log/mongodb/mongod.log</span><span style="color:#D19A66;--shiki-dark:#D19A66"> --fork</span></span></code></pre>
</div><p>Má»Ÿ tá»‡p /var/log/mongodb/mongod.log vÃ  kiá»ƒm tra thÃ´ng tin sau, náº¿u xuáº¥t hiá»‡n, Ä‘iá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ  khá»Ÿi Ä‘á»™ng thÃ nh cÃ´ng.</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># tail -10f /var/log/mongodb/mongod.log</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">2020-07-09T12:20:17.391+0800</span><span style="color:#98C379;--shiki-dark:#98C379"> I</span><span style="color:#98C379;--shiki-dark:#98C379">  NETWORK</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  [listener] Listening on /tmp/mongodb-27017.sock</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">2020-07-09T12:20:17.392+0800</span><span style="color:#98C379;--shiki-dark:#98C379"> I</span><span style="color:#98C379;--shiki-dark:#98C379">  NETWORK</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  [listener] Listening on 127.0.0.1</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">2020-07-09T12:20:17.392+0800</span><span style="color:#98C379;--shiki-dark:#98C379"> I</span><span style="color:#98C379;--shiki-dark:#98C379">  NETWORK</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  [listener] waiting </span><span style="color:#C678DD;--shiki-dark:#C678DD">for</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> connections on port </span><span style="color:#D19A66;--shiki-dark:#D19A66">27017</span></span></code></pre>
</div><p>(4) Káº¿t ná»‘i vá»›i MongoDB tá»« mÃ¡y khÃ¡ch</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2">cd</span><span style="color:#98C379;--shiki-dark:#98C379"> /usr/local/mongodb4/bin</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">./mongo</span></span></code></pre>
</div><h3>Thiáº¿t láº­p tÃªn ngÆ°á»i dÃ¹ng vÃ  máº­t kháº©u</h3>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&gt; use admin</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">chuyá»ƒn</span><span style="color:#98C379;--shiki-dark:#98C379"> sang</span><span style="color:#98C379;--shiki-dark:#98C379"> db</span><span style="color:#98C379;--shiki-dark:#98C379"> admin</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&gt; db.createUser({"user":"root","pwd":"root","roles":[{"role":"userAdminAnyDatabase","db":"admin"}]})</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">ThÃªm</span><span style="color:#98C379;--shiki-dark:#98C379"> ngÆ°á»i</span><span style="color:#98C379;--shiki-dark:#98C379"> dÃ¹ng</span><span style="color:#98C379;--shiki-dark:#98C379"> thÃ nh</span><span style="color:#98C379;--shiki-dark:#98C379"> cÃ´ng:</span><span style="color:#98C379;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "user"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "root",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        "roles"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">                {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">                        "role"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "userAdminAnyDatabase",</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">                        "db"</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> "admin"</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">                }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        ]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&gt;</span></span></code></pre>
</div><h2>Sao lÆ°u vÃ  khÃ´i phá»¥c dá»¯ liá»‡u</h2>
<h3>Sao lÆ°u dá»¯ liá»‡u</h3>
<p>Trong MongoDB, chÃºng ta sá»­ dá»¥ng lá»‡nh <code>mongodump</code> Ä‘á»ƒ sao lÆ°u dá»¯ liá»‡u MongoDB. Lá»‡nh nÃ y cho phÃ©p xuáº¥t táº¥t cáº£ dá»¯ liá»‡u vÃ o má»™t thÆ° má»¥c Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh.</p>
<p>CÃº phÃ¡p lá»‡nh <code>mongodump</code> nhÆ° sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>mongodump -h dbhost -d dbname -o dbdirectory</span></span></code></pre>
</div><ul>
<li>-h: Äá»‹a chá»‰ mÃ¡y chá»§ MongoDB, vÃ­ dá»¥: 127.0.0.1, cÅ©ng cÃ³ thá»ƒ chá»‰ Ä‘á»‹nh cá»•ng: 127.0.0.1:27017.</li>
<li>-d: TÃªn cÆ¡ sá»Ÿ dá»¯ liá»‡u cáº§n sao lÆ°u, vÃ­ dá»¥: test.</li>
<li>-o: ÄÆ°á»ng dáº«n lÆ°u trá»¯ dá»¯ liá»‡u sao lÆ°u, vÃ­ dá»¥: c:\data\dump. TrÆ°á»›c khi sao lÆ°u, thÆ° má»¥c nÃ y cáº§n Ä‘Æ°á»£c táº¡o trÆ°á»›c. Sau khi sao lÆ°u hoÃ n táº¥t, MongoDB sáº½ tá»± Ä‘á»™ng táº¡o má»™t thÆ° má»¥c test trong thÆ° má»¥c dump, chá»©a dá»¯ liá»‡u sao lÆ°u cá»§a cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘Ã³.</li>
</ul>
<p>CÃ¡c tham sá»‘ tÃ¹y chá»n cho lá»‡nh <code>mongodump</code> nhÆ° sau:</p>
<p>| CÃº phÃ¡p                                              | MÃ´ táº£                           | VÃ­ dá»¥                                             |<br>
| :</p>
]]></content:encoded>
    </item>
    <item>
      <title>MongoDB Overview</title>
      <link>https://vanhung4499.github.io/database/mongodb/overview.html</link>
      <guid>https://vanhung4499.github.io/database/mongodb/overview.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">MongoDB Overview</source>
      <description>MongoDB MOC MongoDB lÃ  má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u phÃ¢n tÃ¡n dá»±a trÃªn tÃ i liá»‡u, Ä‘Æ°á»£c viáº¿t báº±ng ngÃ´n ngá»¯ C++. NÃ³ nháº±m má»¥c Ä‘Ã­ch cung cáº¥p má»™t giáº£i phÃ¡p lÆ°u trá»¯ dá»¯ liá»‡u cÃ³ hiá»‡u suáº¥t cao vÃ  cÃ³ ...</description>
      <category>mongodb</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>MongoDB lÃ  má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u phÃ¢n tÃ¡n dá»±a trÃªn tÃ i liá»‡u, Ä‘Æ°á»£c viáº¿t báº±ng ngÃ´n ngá»¯ C++. NÃ³ nháº±m má»¥c Ä‘Ã­ch cung cáº¥p má»™t giáº£i phÃ¡p lÆ°u trá»¯ dá»¯ liá»‡u cÃ³ hiá»‡u suáº¥t cao vÃ  cÃ³ kháº£ nÄƒng má»Ÿ rá»™ng cho cÃ¡c á»©ng dá»¥ng web.</p>
<p>MongoDB lÃ  má»™t sáº£n pháº©m náº±m giá»¯a cÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡ vÃ  cÆ¡ sá»Ÿ dá»¯ liá»‡u phi quan há»‡. NÃ³ lÃ  cÆ¡ sá»Ÿ dá»¯ liá»‡u phi quan há»‡ cÃ³ tÃ­nh nÄƒng phong phÃº nháº¥t vÃ  giá»‘ng nháº¥t vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡. NÃ³ há»— trá»£ cáº¥u trÃºc dá»¯ liá»‡u ráº¥t linh hoáº¡t, sá»­ dá»¥ng Ä‘á»‹nh dáº¡ng bson tÆ°Æ¡ng tá»± nhÆ° json, do Ä‘Ã³ cÃ³ thá»ƒ lÆ°u trá»¯ cÃ¡c loáº¡i dá»¯ liá»‡u phá»©c táº¡p.</p>
<p>Äiá»ƒm Ä‘áº·c biá»‡t lá»›n nháº¥t cá»§a MongoDB lÃ  ngÃ´n ngá»¯ truy váº¥n máº¡nh máº½ mÃ  nÃ³ há»— trá»£. CÃº phÃ¡p cá»§a nÃ³ tÆ°Æ¡ng tá»± nhÆ° ngÃ´n ngá»¯ truy váº¥n hÆ°á»›ng Ä‘á»‘i tÆ°á»£ng, gáº§n nhÆ° cÃ³ thá»ƒ thá»±c hiá»‡n háº§u háº¿t cÃ¡c chá»©c nÄƒng truy váº¥n cá»§a cÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡ trÃªn má»™t báº£ng duy nháº¥t, vÃ  cÃ²n há»— trá»£ táº¡o chá»‰ má»¥c cho dá»¯ liá»‡u.</p>
</blockquote>
<h2>ğŸ“– Contents</h2>
]]></content:encoded>
    </item>
    <item>
      <title>MongoDB Replication</title>
      <link>https://vanhung4499.github.io/database/mongodb/replication.html</link>
      <guid>https://vanhung4499.github.io/database/mongodb/replication.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">MongoDB Replication</source>
      <description>Sao lÆ°u trong MongoDB Sao lÆ°u cÃ³ thá»ƒ cung cáº¥p tÃ­nh sáºµn cÃ³ dá»± phÃ²ng vÃ  tÄƒng cÆ°á»ng kháº£ nÄƒng sáºµn cÃ³ cá»§a dá»¯ liá»‡u. Sá»­ dá»¥ng nhiá»u báº£n sao dá»¯ liá»‡u trÃªn cÃ¡c mÃ¡y chá»§ cÆ¡ sá»Ÿ dá»¯ liá»‡u khÃ¡c n...</description>
      <category>db</category>
      <category>mongodb</category>
      <category>nosql</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<p>Sao lÆ°u cÃ³ thá»ƒ <strong>cung cáº¥p tÃ­nh sáºµn cÃ³ dá»± phÃ²ng vÃ  tÄƒng cÆ°á»ng kháº£ nÄƒng sáºµn cÃ³ cá»§a dá»¯ liá»‡u</strong>. Sá»­ dá»¥ng nhiá»u báº£n sao dá»¯ liá»‡u trÃªn cÃ¡c mÃ¡y chá»§ cÆ¡ sá»Ÿ dá»¯ liá»‡u khÃ¡c nhau cÃ³ thá»ƒ cung cáº¥p kháº£ nÄƒng chá»‘ng lá»—i trong trÆ°á»ng há»£p má»™t mÃ¡y chá»§ cÆ¡ sá»Ÿ dá»¯ liá»‡u bá»‹ sá»± cá»‘ vÃ  dá»¯ liá»‡u bá»‹ máº¥t.</p>
<p>Trong má»™t sá»‘ trÆ°á»ng há»£p, sao lÆ°u cÅ©ng cÃ³ thá»ƒ <strong>cung cáº¥p kháº£ nÄƒng xá»­ lÃ½ Ä‘á»c lá»›n hÆ¡n</strong>. VÃ¬ khÃ¡ch hÃ ng cÃ³ thá»ƒ gá»­i cÃ¡c hoáº¡t Ä‘á»™ng Ä‘á»c Ä‘áº¿n cÃ¡c mÃ¡y chá»§ khÃ¡c nhau. Viá»‡c duy trÃ¬ cÃ¡c báº£n sao dá»¯ liá»‡u trÃªn cÃ¡c trung tÃ¢m dá»¯ liá»‡u khÃ¡c nhau cÅ©ng cÃ³ thá»ƒ cáº£i thiá»‡n tÃ­nh cá»¥c bá»™ cá»§a dá»¯ liá»‡u vÃ  kháº£ nÄƒng sáºµn cÃ³ cá»§a á»©ng dá»¥ng phÃ¢n tÃ¡n. Báº¡n cÅ©ng cÃ³ thá»ƒ duy trÃ¬ cÃ¡c báº£n sao khÃ¡c nhau cho má»¥c Ä‘Ã­ch Ä‘áº·c biá»‡t nhÆ° phá»¥c há»“i sau tháº£m há»a, bÃ¡o cÃ¡o hoáº·c sao lÆ°u.</p>
<h2>Báº£n sao dá»¯ liá»‡u MongoDB</h2>
<p>Báº£n sao dá»¯ liá»‡u trong MongoDB lÃ  má»™t nhÃ³m quy trÃ¬nh mongod duy trÃ¬ cÃ¹ng má»™t táº­p há»£p dá»¯ liá»‡u. Má»™t báº£n sao dá»¯ liá»‡u bao gá»“m nhiá»u thÃ nh viÃªn dá»¯ liá»‡u vÃ  má»™t thÃ nh viÃªn trá»ng tÃ¢m (tÃ¹y chá»n). Trong cÃ¡c thÃ nh viÃªn dá»¯ liá»‡u, chá»‰ cÃ³ má»™t thÃ nh viÃªn Ä‘Æ°á»£c coi lÃ  chÃ­nh vÃ  cÃ¡c thÃ nh viÃªn khÃ¡c Ä‘Æ°á»£c coi lÃ  phá»¥.</p>
<p><strong>ThÃ nh viÃªn chÃ­nh chá»‹u trÃ¡ch nhiá»‡m nháº­n táº¥t cáº£ cÃ¡c hoáº¡t Ä‘á»™ng ghi</strong>. Má»™t báº£n sao dá»¯ liá»‡u chá»‰ cÃ³ thá»ƒ cÃ³ má»™t thÃ nh viÃªn chÃ­nh vÃ  cÃ³ thá»ƒ xÃ¡c nháº­n ráº±ng cÃ¡c hoáº¡t Ä‘á»™ng ghi trÃªn cÃ¡c nÃºt trong cá»¥m báº±ng cÃ¡ch sá»­ dá»¥ng <a href="https://docs.mongodb.com/manual/reference/write-concern/#writeconcern.%22majority%22" target="_blank" rel="noopener noreferrer"><code>{ w: "majority" }</code></a>.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200920165054.svg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>
<p><strong>CÃ¡c thÃ nh viÃªn phá»¥ sao chÃ©p nháº­t kÃ½ hoáº¡t Ä‘á»™ng cá»§a thÃ nh viÃªn chÃ­nh vÃ  Ã¡p dá»¥ng cÃ¡c hoáº¡t Ä‘á»™ng nÃ y vÃ o táº­p dá»¯ liá»‡u cá»§a mÃ¬nh</strong> Ä‘á»ƒ Ä‘á»“ng bá»™ dá»¯ liá»‡u vá»›i thÃ nh viÃªn chÃ­nh. Náº¿u thÃ nh viÃªn chÃ­nh khÃ´ng kháº£ dá»¥ng, má»™t thÃ nh viÃªn phá»¥ Ä‘á»§ Ä‘iá»u kiá»‡n sáº½ Ä‘Æ°á»£c báº§u lÃ m thÃ nh viÃªn chÃ­nh má»›i.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200920165055.svg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>
<p>Trong má»™t sá»‘ trÆ°á»ng há»£p (vÃ­ dá»¥: chá»‰ cÃ³ má»™t thÃ nh viÃªn chÃ­nh vÃ  má»™t thÃ nh viÃªn phá»¥ do háº¡n cháº¿ vá» chi phÃ­), báº¡n cÃ³ thá»ƒ chá»n thÃªm má»™t quy trÃ¬nh mongod lÃ m thÃ nh viÃªn trá»ng tÃ¢m trong báº£n sao dá»¯ liá»‡u. ThÃ nh viÃªn trá»ng tÃ¢m tham gia vÃ o quÃ¡ trÃ¬nh báº§u cá»­ nhÆ°ng khÃ´ng lÆ°u trá»¯ dá»¯ liá»‡u (khÃ´ng cung cáº¥p dá»± phÃ²ng dá»¯ liá»‡u).</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200920165053.svg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>
<p>ThÃ nh viÃªn trá»ng tÃ¢m luÃ´n lÃ  thÃ nh viÃªn trá»ng tÃ¢m. Trong quÃ¡ trÃ¬nh báº§u cá»­, thÃ nh viÃªn chÃ­nh cÃ³ thá»ƒ bá»‹ giÃ¡ng cáº¥p thÃ nh thÃ nh viÃªn phá»¥ vÃ  thÃ nh viÃªn phá»¥ cÃ³ thá»ƒ Ä‘Æ°á»£c thÄƒng cáº¥p thÃ nh thÃ nh viÃªn chÃ­nh.</p>
<h2>Sao lÆ°u khÃ´ng Ä‘á»“ng bá»™</h2>
<h3>Hoáº¡t Ä‘á»™ng cháº­m</h3>
<p>CÃ¡c thÃ nh viÃªn phá»¥ sao chÃ©p nháº­t kÃ½ hoáº¡t Ä‘á»™ng cá»§a thÃ nh viÃªn chÃ­nh vÃ  Ã¡p dá»¥ng cÃ¡c hoáº¡t Ä‘á»™ng nÃ y vÃ o táº­p dá»¯ liá»‡u cá»§a mÃ¬nh. Báº±ng cÃ¡ch Ä‘á»“ng bá»™ hÃ³a dá»¯ liá»‡u tá»« thÃ nh viÃªn chÃ­nh, ngay cáº£ khi má»™t hoáº·c nhiá»u thÃ nh viÃªn gáº·p sá»± cá»‘, báº£n sao dá»¯ liá»‡u (cá»¥m MongoDB) váº«n cÃ³ thá»ƒ tiáº¿p tá»¥c hoáº¡t Ä‘á»™ng.</p>
<p>Tá»« phiÃªn báº£n 4.2 trá»Ÿ Ä‘i, cÃ¡c thÃ nh viÃªn phá»¥ trong báº£n sao dá»¯ liá»‡u ghi láº¡i cÃ¡c hoáº¡t Ä‘á»™ng cháº­m (thá»i gian hoáº¡t Ä‘á»™ng dÃ i hÆ¡n ngÆ°á»¡ng Ä‘Æ°á»£c Ä‘áº·t). Nhá»¯ng hoáº¡t Ä‘á»™ng cháº­m nÃ y Ä‘Æ°á»£c ghi láº¡i trong <a href="https://docs.mongodb.com/manual/reference/program/mongod/#cmdoption-mongod-logpath" target="_blank" rel="noopener noreferrer">nháº­t kÃ½ cháº©n Ä‘oÃ¡n</a> cá»§a <a href="https://docs.mongodb.com/manual/reference/log-messages/#REPL" target="_blank" rel="noopener noreferrer">REPL</a> vÃ  Ä‘Æ°á»£c ghi nháº­n trong thÃ´ng bÃ¡o nháº­t kÃ½ vÄƒn báº£n vá»›i vÄƒn báº£n <code>op: &lt;oplog entry&gt;</code> Ä‘Ã£ máº¥t <code>&lt;num&gt;ms</code>. Nhá»¯ng má»¥c nháº­t kÃ½ hoáº¡t Ä‘á»™ng cháº­m nÃ y chá»‰ phá»¥ thuá»™c vÃ o ngÆ°á»¡ng hoáº¡t Ä‘á»™ng cháº­m vÃ  khÃ´ng phá»¥ thuá»™c vÃ o cáº¥p Ä‘á»™ nháº­t kÃ½ (cáº¥p Ä‘á»™ há»‡ thá»‘ng hoáº·c cáº¥p Ä‘á»™ thÃ nh pháº§n), cáº¥u hÃ¬nh hoáº·c tá»· lá»‡ máº«u hoáº¡t Ä‘á»™ng cháº­m. CÃ¡c bá»™ thu tháº­p khÃ´ng ghi láº¡i cÃ¡c má»¥c nháº­t kÃ½ hoáº¡t Ä‘á»™ng cháº­m.</p>
<h3>Äá»™ trá»… vÃ  kiá»ƒm soÃ¡t luá»“ng</h3>
<p>Äá»™ trá»… sao lÆ°u (Replication lag) lÃ  thá»i gian máº¥t Ä‘á»ƒ sao chÃ©p cÃ¡c hoáº¡t Ä‘á»™ng ghi tá»« thÃ nh viÃªn chÃ­nh sang thÃ nh viÃªn phá»¥. Thá»i gian trá»… ngáº¯n lÃ  cháº¥p nháº­n Ä‘Æ°á»£c, nhÆ°ng vá»›i Ä‘á»™ trá»… sao lÆ°u tÄƒng lÃªn, cÃ³ thá»ƒ gáº·p váº¥n Ä‘á» nghiÃªm trá»ng, vÃ­ dá»¥ nhÆ° Ã¡p lá»±c bá»™ nhá»› Ä‘á»‡m trÃªn thÃ nh viÃªn chÃ­nh.</p>
<p>Tá»« MongoDB 4.2 trá»Ÿ Ä‘i, quáº£n trá»‹ viÃªn cÃ³ thá»ƒ giá»›i háº¡n tá»‘c Ä‘á»™ ghi cá»§a thÃ nh viÃªn chÃ­nh Ä‘á»ƒ giá»¯ cho háº§u háº¿t thá»i gian trá»… dÆ°á»›i ngÆ°á»¡ng tá»‘i Ä‘a Ä‘Æ°á»£c cáº¥u hÃ¬nh <a href="https://docs.mongodb.com/manual/reference/parameters/#param.flowControlTargetLagSeconds" target="_blank" rel="noopener noreferrer"><code>flowControlTargetLagSeconds</code></a>.</p>
<p>Máº·c Ä‘á»‹nh, kiá»ƒm soÃ¡t luá»“ng Ä‘Æ°á»£c báº­t.</p>
<p>Khi kiá»ƒm soÃ¡t luá»“ng Ä‘Æ°á»£c kÃ­ch hoáº¡t, khi thá»i gian trá»… tiáº¿n Ä‘áº¿n <a href="https://docs.mongodb.com/manual/reference/parameters/#param.flowControlTargetLagSeconds" target="_blank" rel="noopener noreferrer"><code>flowControlTargetLagSeconds</code></a>, cÃ¡c hoáº¡t Ä‘á»™ng ghi trÃªn thÃ nh viÃªn chÃ­nh pháº£i nháº­n Ä‘Æ°á»£c mÃ£ thÃ´ng bÃ¡o trÆ°á»›c khi khÃ³a vÃ  thá»±c hiá»‡n hoáº¡t Ä‘á»™ng ghi. Báº±ng cÃ¡ch giá»›i háº¡n sá»‘ lÆ°á»£ng mÃ£ thÃ´ng bÃ¡o Ä‘Æ°á»£c phÃ¡t ra má»—i giÃ¢y, cÆ¡ cháº¿ kiá»ƒm soÃ¡t luá»“ng cá»‘ gáº¯ng giá»¯ cho thá»i gian trá»… dÆ°á»›i má»¥c tiÃªu.</p>
<h2>Chuyá»ƒn Ä‘á»•i lá»—i</h2>
<p>Khi thá»i gian giao tiáº¿p giá»¯a thÃ nh viÃªn chÃ­nh vÃ  cÃ¡c thÃ nh viÃªn khÃ¡c trong cá»¥m vÆ°á»£t quÃ¡ <a href="https://docs.mongodb.com/manual/reference/replica-configuration/#rsconf.settings.electionTimeoutMillis" target="_blank" rel="noopener noreferrer"><code>electionTimeoutMillis</code></a> Ä‘Æ°á»£c cáº¥u hÃ¬nh (máº·c Ä‘á»‹nh lÃ  10 giÃ¢y), cÃ¡c thÃ nh viÃªn phÃ¹ há»£p sáº½ yÃªu cáº§u má»™t cuá»™c báº§u cá»­ vÃ  Ä‘á» cá»­ chÃ­nh mÃ¬nh lÃ m thÃ nh viÃªn chÃ­nh má»›i. Cá»¥m cá»‘ gáº¯ng hoÃ n thÃ nh cuá»™c báº§u cá»­ vÃ  khÃ´i phá»¥c hoáº¡t Ä‘á»™ng bÃ¬nh thÆ°á»ng.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200920175429.svg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>
<p>TrÆ°á»›c khi hoÃ n thÃ nh cuá»™c báº§u cá»­, báº£n sao dá»¯ liá»‡u khÃ´ng thá»ƒ xá»­ lÃ½ cÃ¡c hoáº¡t Ä‘á»™ng ghi. Náº¿u báº£n sao dá»¯ liá»‡u Ä‘Æ°á»£c cáº¥u hÃ¬nh Ä‘á»ƒ cháº¡y khi thÃ nh viÃªn chÃ­nh khÃ´ng kháº£ dá»¥ng, nÃ³ cÃ³ thá»ƒ tiáº¿p tá»¥c cung cáº¥p truy váº¥n Ä‘á»c.</p>
<p>Náº¿u cáº¥u hÃ¬nh báº£n sao dá»¯ liá»‡u máº·c Ä‘á»‹nh lÃ  cháº¡y khi thÃ nh viÃªn chÃ­nh khÃ´ng kháº£ dá»¥ng, nÃ³ sáº½ tiáº¿p tá»¥c Ä‘Ã¡p á»©ng cÃ¡c truy váº¥n Ä‘á»c trong khi chá» cuá»™c báº§u cá»­ vÃ  sau Ä‘Ã³ tiáº¿p tá»¥c ghi láº¡i hoáº¡t Ä‘á»™ng ghi tá»« thÃ nh viÃªn chÃ­nh má»›i.</p>
<p>á»¨ng dá»¥ng káº¿t ná»‘i nÃªn bao gá»“m xá»­ lÃ½ lá»—i tá»± Ä‘á»™ng vÃ  tÃ¡i thá»­ láº¡i cho viá»‡c chuyá»ƒn Ä‘á»•i lá»—i tá»± Ä‘á»™ng vÃ  cuá»™c báº§u cá»­ tiáº¿p theo. Tá»« MongoDB 3.6 trá»Ÿ Ä‘i, cÃ¡c trÃ¬nh Ä‘iá»u khiá»ƒn MongoDB cÃ³ thá»ƒ phÃ¡t hiá»‡n sá»± máº¥t káº¿t ná»‘i vá»›i thÃ nh viÃªn chÃ­nh vÃ  cÃ³ thá»ƒ tá»± Ä‘á»™ng thá»­ láº¡i má»™t sá»‘ hoáº¡t Ä‘á»™ng ghi.</p>
<p>Tá»« MongoDB 4.4 trá»Ÿ Ä‘i, MongoDB cung cáº¥p Ä‘á»c gÆ°Æ¡ng: nÃ³ sáº½ nÃ³i trÆ°á»›c dá»¯ liá»‡u gáº§n Ä‘Ã¢y cá»§a thÃ nh viÃªn cÃ³ thá»ƒ báº§u cá»­ (thÃ nh viÃªn Æ°u tiÃªn lá»›n hÆ¡n 0). Viá»‡c nÃ³i trÆ°á»›c bá»™ nhá»› Ä‘á»‡m cá»§a thÃ nh viÃªn cÃ³ thá»ƒ báº§u cá»­ cÃ³ thá»ƒ giÃºp khÃ´i phá»¥c nhanh hÆ¡n sau cuá»™c báº§u cá»­.</p>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200920165054.svg" type="image/svg+xml"/>
    </item>
    <item>
      <title>MongoDB Sharding</title>
      <link>https://vanhung4499.github.io/database/mongodb/sharding.html</link>
      <guid>https://vanhung4499.github.io/database/mongodb/sharding.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">MongoDB Sharding</source>
      <description>MongoDB PhÃ¢n Ä‘oáº¡n Giá»›i thiá»‡u vá» cá»¥m phÃ¢n Ä‘oáº¡n Khi MongoDB cáº§n lÆ°u trá»¯ dá»¯ liá»‡u lá»›n, má»™t nÃºt Ä‘Æ¡n khÃ´ng Ä‘á»§ Ä‘á»ƒ lÆ°u trá»¯ toÃ n bá»™ dá»¯ liá»‡u vÃ  cÃ³ thá»ƒ khÃ´ng cung cáº¥p Ä‘Æ°á»£c hiá»‡u suáº¥t Ä‘Ã¡ng h...</description>
      <category>db</category>
      <category>mongodb</category>
      <category>nosql</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>Giá»›i thiá»‡u vá» cá»¥m phÃ¢n Ä‘oáº¡n</h2>
<p>Khi MongoDB cáº§n lÆ°u trá»¯ dá»¯ liá»‡u lá»›n, má»™t nÃºt Ä‘Æ¡n khÃ´ng Ä‘á»§ Ä‘á»ƒ lÆ°u trá»¯ toÃ n bá»™ dá»¯ liá»‡u vÃ  cÃ³ thá»ƒ khÃ´ng cung cáº¥p Ä‘Æ°á»£c hiá»‡u suáº¥t Ä‘Ã¡ng hÃ i lÃ²ng. Do Ä‘Ã³, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng cÆ¡ cháº¿ phÃ¢n Ä‘oáº¡n cá»§a MongoDB Ä‘á»ƒ há»— trá»£ má»Ÿ rá»™ng theo chiá»u ngang.</p>
<h3>Äáº·c Ä‘iá»ƒm cá»§a cá»¥m phÃ¢n Ä‘oáº¡n</h3>
<p>HoÃ n toÃ n trong suá»‘t vá»›i á»©ng dá»¥ng</p>
<p>CÃ¢n báº±ng dá»¯ liá»‡u tá»± Ä‘á»™ng</p>
<p>Má»Ÿ rá»™ng Ä‘á»™ng</p>
<p>Cung cáº¥p ba phÆ°Æ¡ng phÃ¡p phÃ¢n Ä‘oáº¡n khÃ¡c nhau</p>
<h3>CÃ¡c thÃ nh pháº§n cá»§a cá»¥m phÃ¢n Ä‘oáº¡n</h3>
<p>Cá»¥m phÃ¢n Ä‘oáº¡n MongoDB bao gá»“m cÃ¡c thÃ nh pháº§n sau:</p>
<ul>
<li><a href="https://docs.mongodb.com/manual/core/sharded-cluster-shards/" target="_blank" rel="noopener noreferrer">shard</a>: Má»—i phÃ¢n Ä‘oáº¡n chá»©a má»™t pháº§n con cá»§a dá»¯ liá»‡u phÃ¢n Ä‘oáº¡n. Má»—i phÃ¢n Ä‘oáº¡n cÃ³ thá»ƒ triá»ƒn khai nhÆ° má»™t bá»™ nhÃ¢n báº£n.</li>
<li><a href="https://docs.mongodb.com/manual/core/sharded-cluster-query-router/" target="_blank" rel="noopener noreferrer">mongos</a>: mongos hoáº¡t Ä‘á»™ng nhÆ° má»™t bá»™ Ä‘á»‹nh tuyáº¿n truy váº¥n, cung cáº¥p giao diá»‡n giá»¯a á»©ng dá»¥ng khÃ¡ch hÃ ng vÃ  cá»¥m phÃ¢n Ä‘oáº¡n. Tá»« phiÃªn báº£n MongoDB 4.4 trá»Ÿ Ä‘i, mongos cÃ³ thá»ƒ há»— trá»£ <a href="https://docs.mongodb.com/manual/core/sharded-cluster-query-router/#mongos-hedged-reads" target="_blank" rel="noopener noreferrer">hedged reads</a> Ä‘á»ƒ giáº£m thiá»ƒu Ä‘á»™ trá»….</li>
<li><a href="https://docs.mongodb.com/manual/core/sharded-cluster-config-servers/" target="_blank" rel="noopener noreferrer">config servers</a>: Cung cáº¥p lÆ°u trá»¯ dá»¯ liá»‡u siÃªu dá»¯ liá»‡u vÃ  Ã¡nh xáº¡ phÃ¢n phá»‘i dá»¯ liá»‡u.</li>
</ul>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230724020005.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure>
<h3>PhÃ¢n phá»‘i cá»§a cá»¥m phÃ¢n Ä‘oáº¡n</h3>
<p><strong>Cá»¥m sao chÃ©p MongoDB Ä‘Æ°á»£c phÃ¢n phá»‘i theo bá»™ sÆ°u táº­p</strong>, phÃ¢n phá»‘i dá»¯ liá»‡u trÃªn cÃ¡c phÃ¢n Ä‘oáº¡n trong cá»¥m. Tá»‘i Ä‘a cho phÃ©p 1024 phÃ¢n Ä‘oáº¡n.</p>
<p>Dá»¯ liá»‡u giá»¯a cÃ¡c phÃ¢n Ä‘oáº¡n trong cá»¥m sao chÃ©p MongoDB khÃ´ng trÃ¹ng láº·p, chá»‰ khi táº¥t cáº£ cÃ¡c phÃ¢n Ä‘oáº¡n Ä‘á»u hoáº¡t Ä‘á»™ng bÃ¬nh thÆ°á»ng, cá»¥m má»›i hoáº¡t Ä‘á»™ng Ä‘áº§y Ä‘á»§.</p>
<p>CÆ¡ sá»Ÿ dá»¯ liá»‡u MongoDB cÃ³ thá»ƒ chá»©a cáº£ bá»™ sÆ°u táº­p Ä‘Ã£ phÃ¢n Ä‘oáº¡n vÃ  chÆ°a phÃ¢n Ä‘oáº¡n. CÃ¡c bá»™ sÆ°u táº­p Ä‘Ã£ phÃ¢n Ä‘oáº¡n sáº½ Ä‘Æ°á»£c phÃ¢n phá»‘i trÃªn cÃ¡c nÃºt trong cá»¥m. Trong khi Ä‘Ã³, cÃ¡c bá»™ sÆ°u táº­p chÆ°a phÃ¢n Ä‘oáº¡n Ä‘Æ°á»£c lÆ°u trá»¯ trÃªn nÃºt chÃ­nh. Má»—i cÆ¡ sá»Ÿ dá»¯ liá»‡u cÃ³ nÃºt chÃ­nh riÃªng cá»§a nÃ³.</p>
<p>Bá»™ sÆ°u táº­p Ä‘Ã£ phÃ¢n Ä‘oáº¡n vÃ  chÆ°a phÃ¢n Ä‘oáº¡n:</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200920212159.svg" alt="20200920212159.svg" tabindex="0" loading="lazy"><figcaption>20200920212159.svg</figcaption></figure>
<h3>NÃºt Ä‘á»‹nh tuyáº¿n mongos</h3>
<p>Äá»ƒ káº¿t ná»‘i vá»›i <a href="https://docs.mongodb.com/manual/reference/glossary/#term-sharded-cluster" target="_blank" rel="noopener noreferrer">cá»¥m phÃ¢n Ä‘oáº¡n MongoDB</a>, báº¡n pháº£i káº¿t ná»‘i vá»›i bá»™ Ä‘á»‹nh tuyáº¿n <a href="https://docs.mongodb.com/manual/reference/glossary/#term-mongos" target="_blank" rel="noopener noreferrer"><code>mongos</code></a>. Äiá»u nÃ y bao gá»“m cáº£ cÃ¡c bá»™ sÆ°u táº­p Ä‘Ã£ phÃ¢n Ä‘oáº¡n vÃ  chÆ°a phÃ¢n Ä‘oáº¡n. KhÃ¡ch hÃ ng khÃ´ng nÃªn káº¿t ná»‘i trá»±c tiáº¿p vá»›i cÃ¡c nÃºt phÃ¢n Ä‘oáº¡n Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c hoáº¡t Ä‘á»™ng Ä‘á»c vÃ  ghi.</p>
<p>CÃ¡ch káº¿t ná»‘i vá»›i <a href="https://docs.mongodb.com/manual/reference/program/mongos/#bin.mongos" target="_blank" rel="noopener noreferrer"><code>mongos</code></a> tÆ°Æ¡ng tá»± nhÆ° káº¿t ná»‘i vá»›i <a href="https://docs.mongodb.com/manual/reference/program/mongod/#bin.mongod" target="_blank" rel="noopener noreferrer"><code>mongod</code></a>, vÃ­ dá»¥ nhÆ° thÃ´ng qua <a href="https://docs.mongodb.com/manual/reference/program/mongo/#bin.mongo" target="_blank" rel="noopener noreferrer"><code>mongo</code></a> shell hoáº·c <a href="https://docs.mongodb.com/drivers/?jump=docs" target="_blank" rel="noopener noreferrer">MongoDB driver</a>.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200920212157.svg" alt="20200920212157.svg" tabindex="0" loading="lazy"><figcaption>20200920212157.svg</figcaption></figure>
<p>Vai trÃ² cá»§a nÃºt Ä‘á»‹nh tuyáº¿n:</p>
<ul>
<li>Cung cáº¥p Ä‘iá»ƒm vÃ o duy nháº¥t cho cá»¥m</li>
<li>Chuyá»ƒn tiáº¿p yÃªu cáº§u tá»« á»©ng dá»¥ng</li>
<li>Chá»n nÃºt dá»¯ liá»‡u phÃ¹ há»£p Ä‘á»ƒ Ä‘á»c vÃ  ghi</li>
<li>Káº¿t há»£p káº¿t quáº£ tá»« nhiá»u nÃºt dá»¯ liá»‡u</li>
</ul>
<p>ThÆ°á»ng thÃ¬, nÃªn cÃ³ Ã­t nháº¥t 2 nÃºt Ä‘á»‹nh tuyáº¿n mongos.</p>
<h1>KhÃ³a phÃ¢n Ä‘oáº¡n</h1>
<p>MongoDB sá»­ dá»¥ng khÃ³a phÃ¢n Ä‘oáº¡n Ä‘á»ƒ phÃ¢n phá»‘i cÃ¡c tÃ i liá»‡u trong bá»™ sÆ°u táº­p giá»¯a cÃ¡c phÃ¢n Ä‘oáº¡n. KhÃ³a phÃ¢n Ä‘oáº¡n Ä‘Æ°á»£c táº¡o thÃ nh tá»« má»™t hoáº·c nhiá»u trÆ°á»ng trong tÃ i liá»‡u.</p>
<ul>
<li>Tá»« phiÃªn báº£n MongoDB 4.4 trá»Ÿ Ä‘i, cÃ¡c tÃ i liá»‡u trong bá»™ sÆ°u táº­p phÃ¢n Ä‘oáº¡n cÃ³ thá»ƒ thiáº¿u trÆ°á»ng khÃ³a phÃ¢n Ä‘oáº¡n. Khi phÃ¢n phá»‘i tÃ i liá»‡u qua cÃ¡c phÃ¢n Ä‘oáº¡n, viá»‡c thiáº¿u trÆ°á»ng khÃ³a phÃ¢n Ä‘oáº¡n sáº½ Ä‘Æ°á»£c coi nhÆ° cÃ³ giÃ¡ trá»‹ rá»—ng, nhÆ°ng khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng trong cÃ¡c truy váº¥n Ä‘á»‹nh tuyáº¿n.</li>
<li>Trong MongoDB 4.2 vÃ  cÃ¡c phiÃªn báº£n cÅ© hÆ¡n, trÆ°á»ng khÃ³a phÃ¢n Ä‘oáº¡n pháº£i tá»“n táº¡i trong má»—i tÃ i liá»‡u trong bá»™ sÆ°u táº­p phÃ¢n Ä‘oáº¡n.</li>
</ul>
<p>Lá»±a chá»n khÃ³a phÃ¢n Ä‘oáº¡n khi phÃ¢n Ä‘oáº¡n bá»™ sÆ°u táº­p.</p>
<ul>
<li>Tá»« phiÃªn báº£n MongoDB 4.4 trá»Ÿ Ä‘i, báº¡n cÃ³ thá»ƒ tá»‘i Æ°u hÃ³a khÃ³a phÃ¢n Ä‘oáº¡n cá»§a bá»™ sÆ°u táº­p báº±ng cÃ¡ch thÃªm má»™t hoáº·c nhiá»u trÆ°á»ng háº­u tá»‘ vÃ o khÃ³a hiá»‡n cÃ³.</li>
<li>Trong MongoDB 4.2 vÃ  cÃ¡c phiÃªn báº£n cÅ© hÆ¡n, khÃ´ng thá»ƒ thay Ä‘á»•i lá»±a chá»n khÃ³a phÃ¢n Ä‘oáº¡n sau khi Ä‘Ã£ phÃ¢n Ä‘oáº¡n.</li>
</ul>
<p>GiÃ¡ trá»‹ khÃ³a phÃ¢n Ä‘oáº¡n cá»§a tÃ i liá»‡u xÃ¡c Ä‘á»‹nh phÃ¢n phá»‘i cá»§a nÃ³ trÃªn cÃ¡c phÃ¢n Ä‘oáº¡n</p>
<ul>
<li>Tá»« phiÃªn báº£n MongoDB 4.2 trá»Ÿ Ä‘i, báº¡n cÃ³ thá»ƒ cáº­p nháº­t giÃ¡ trá»‹ khÃ³a phÃ¢n Ä‘oáº¡n cá»§a tÃ i liá»‡u trá»« khi trÆ°á»ng khÃ³a phÃ¢n Ä‘oáº¡n cá»§a báº¡n lÃ  trÆ°á»ng khÃ´ng thá»ƒ thay Ä‘á»•i nhÆ° _id.</li>
<li>Trong MongoDB 4.0 vÃ  cÃ¡c phiÃªn báº£n cÅ© hÆ¡n, giÃ¡ trá»‹ trÆ°á»ng khÃ³a phÃ¢n Ä‘oáº¡n cá»§a tÃ i liá»‡u lÃ  khÃ´ng thá»ƒ thay Ä‘á»•i.</li>
</ul>
<p>Chá»‰ má»¥c khÃ³a phÃ¢n Ä‘oáº¡n: Äá»ƒ phÃ¢n Ä‘oáº¡n má»™t bá»™ sÆ°u táº­p Ä‘Ã£ Ä‘Æ°á»£c Ä‘iá»n, bá»™ sÆ°u táº­p Ä‘Ã³ pháº£i cÃ³ má»™t chá»‰ má»¥c báº¯t Ä‘áº§u báº±ng khÃ³a phÃ¢n Ä‘oáº¡n. Khi phÃ¢n Ä‘oáº¡n má»™t bá»™ sÆ°u táº­p trá»‘ng, MongoDB sáº½ táº¡o má»™t chá»‰ má»¥c há»— trá»£ cho khÃ³a phÃ¢n Ä‘oáº¡n Ä‘Ã£ chá»‰ Ä‘á»‹nh náº¿u bá»™ sÆ°u táº­p Ä‘Ã³ chÆ°a cÃ³ chá»‰ má»¥c phÃ¹ há»£p.</p>
<p>Chiáº¿n lÆ°á»£c phÃ¢n Ä‘oáº¡n: Lá»±a chá»n khÃ³a phÃ¢n Ä‘oáº¡n áº£nh hÆ°á»Ÿng Ä‘áº¿n hiá»‡u suáº¥t, hiá»‡u quáº£ vÃ  kháº£ nÄƒng má»Ÿ rá»™ng cá»§a cá»¥m phÃ¢n Ä‘oáº¡n. Lá»±a chá»n khÃ³a phÃ¢n Ä‘oáº¡n vÃ  chá»‰ má»¥c phá»¥ trá»£ cÅ©ng áº£nh hÆ°á»Ÿng Ä‘áº¿n chiáº¿n lÆ°á»£c phÃ¢n Ä‘oáº¡n mÃ  cá»¥m cÃ³ thá»ƒ sá»­ dá»¥ng.</p>
<p>MongoDB phÃ¢n Ä‘oáº¡n dá»¯ liá»‡u. Má»—i phÃ¢n Ä‘oáº¡n cÃ³ giá»›i háº¡n dá»±a trÃªn khÃ³a phÃ¢n Ä‘oáº¡n.</p>
<p>Äá»ƒ Ä‘áº£m báº£o phÃ¢n phá»‘i Ä‘á»“ng Ä‘á»u cá»§a cÃ¡c phÃ¢n Ä‘oáº¡n trÃªn toÃ n cá»¥m, trÃ¬nh cÃ¢n báº±ng cháº¡y trong ná»n vÃ  di chuyá»ƒn cÃ¡c phÃ¢n Ä‘oáº¡n trÃªn cÃ¡c phÃ¢n Ä‘oáº¡n.</p>
<h2>Chiáº¿n lÆ°á»£c phÃ¢n Ä‘oáº¡n</h2>
<p>MongoDB há»— trá»£ hai chiáº¿n lÆ°á»£c phÃ¢n Ä‘oáº¡n: PhÃ¢n Ä‘oáº¡n theo bÄƒm vÃ  phÃ¢n Ä‘oáº¡n theo pháº¡m vi.</p>
<h3>PhÃ¢n Ä‘oáº¡n theo bÄƒm</h3>
<p>Chiáº¿n lÆ°á»£c phÃ¢n Ä‘oáº¡n theo bÄƒm tÃ­nh toÃ¡n giÃ¡ trá»‹ bÄƒm cá»§a trÆ°á»ng khÃ³a phÃ¢n Ä‘oáº¡n; sau Ä‘Ã³, má»—i <a href="https://docs.mongodb.com/manual/reference/glossary/#term-chunk" target="_blank" rel="noopener noreferrer">chunk</a> Ä‘Æ°á»£c gÃ¡n má»™t pháº¡m vi dá»±a trÃªn giÃ¡ trá»‹ khÃ³a phÃ¢n Ä‘oáº¡n.</p>
<blockquote>
<p>LÆ°u Ã½: Khi giáº£i quyáº¿t truy váº¥n sá»­ dá»¥ng chá»‰ má»¥c bÄƒm, MongoDB tá»± Ä‘á»™ng tÃ­nh toÃ¡n giÃ¡ trá»‹ bÄƒm, khÃ´ng cáº§n á»©ng dá»¥ng tÃ­nh toÃ¡n giÃ¡ trá»‹ bÄƒm.</p>
</blockquote>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200920213343.svg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>
<p>Máº·c dÃ¹ cÃ¡c pháº¡m vi khÃ³a phÃ¢n Ä‘oáº¡n cÃ³ thá»ƒ "gáº§n nhau", nhÆ°ng giÃ¡ trá»‹ bÄƒm cá»§a chÃºng khÃ´ng thá»ƒ cÃ³ kháº£ nÄƒng náº±m trÃªn cÃ¹ng má»™t <a href="https://docs.mongodb.com/manual/reference/glossary/#term-chunk" target="_blank" rel="noopener noreferrer">chunk</a>. PhÃ¢n phá»‘i dá»¯ liá»‡u dá»±a trÃªn bÄƒm giÃºp phÃ¢n phá»‘i dá»¯ liá»‡u Ä‘á»“ng Ä‘á»u hÆ¡n, Ä‘áº·c biá»‡t lÃ  trong cÃ¡c táº­p dá»¯ liá»‡u mÃ  khÃ³a phÃ¢n Ä‘oáº¡n thay Ä‘á»•i má»™t cÃ¡ch Ä‘Æ¡n Ä‘iá»‡u.</p>
<p>Tuy nhiÃªn, phÃ¢n Ä‘oáº¡n theo bÄƒm cÃ³ nghÄ©a lÃ  cÃ¡c truy váº¥n pháº¡m vi trÃªn khÃ³a phÃ¢n Ä‘oáº¡n khÃ´ng thá»ƒ Ä‘Æ°á»£c hÆ°á»›ng Ä‘áº¿n má»™t phÃ¢n Ä‘oáº¡n duy nháº¥t, dáº«n Ä‘áº¿n nhiá»u hoáº¡t Ä‘á»™ng truyá»n phÃ¡t trong pháº¡m vi cá»¥m.</p>
<h3>PhÃ¢n Ä‘oáº¡n theo pháº¡m vi</h3>
<p>PhÃ¢n Ä‘oáº¡n theo pháº¡m vi chia dá»¯ liá»‡u thÃ nh nhiá»u pháº¡m vi dá»±a trÃªn giÃ¡ trá»‹ khÃ³a phÃ¢n Ä‘oáº¡n. Sau Ä‘Ã³, má»—i <a href="https://docs.mongodb.com/manual/reference/glossary/#term-chunk" target="_blank" rel="noopener noreferrer">chunk</a> Ä‘Æ°á»£c gÃ¡n má»™t pháº¡m vi dá»±a trÃªn giÃ¡ trá»‹ khÃ³a phÃ¢n Ä‘oáº¡n.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200920213345.svg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>
<p>CÃ¡c giÃ¡ trá»‹ khÃ³a phÃ¢n Ä‘oáº¡n tÆ°Æ¡ng Ä‘á»‘i gáº§n nhau cÃ³ kháº£ nÄƒng náº±m trÃªn cÃ¹ng má»™t <a href="https://docs.mongodb.com/manual/reference/glossary/#term-chunk" target="_blank" rel="noopener noreferrer">chunk</a>. Hiá»‡u suáº¥t cá»§a phÃ¢n Ä‘oáº¡n theo pháº¡m vi phá»¥ thuá»™c vÃ o lá»±a chá»n khÃ³a phÃ¢n Ä‘oáº¡n. Lá»±a chá»n khÃ³a phÃ¢n Ä‘oáº¡n khÃ´ng tá»‘t cÃ³ thá»ƒ dáº«n Ä‘áº¿n phÃ¢n phá»‘i dá»¯ liá»‡u khÃ´ng Ä‘á»“ng Ä‘á»u, gÃ¢y suy giáº£m má»™t sá»‘ lá»£i Ã­ch cá»§a phÃ¢n Ä‘oáº¡n hoáº·c gÃ¢y ra háº¡n cháº¿ hiá»‡u suáº¥t.</p>
<h2>VÃ¹ng trong cá»¥m phÃ¢n Ä‘oáº¡n</h2>
<p>VÃ¹ng cÃ³ thá»ƒ cáº£i thiá»‡n tÃ­nh cá»¥c bá»™ cá»§a dá»¯ liá»‡u trong cá»¥m phÃ¢n Ä‘oáº¡n cháº¡y trÃªn nhiá»u trung tÃ¢m dá»¯ liá»‡u.</p>
<p>Trong cá»¥m phÃ¢n Ä‘oáº¡n, cÃ³ thá»ƒ táº¡o ra cÃ¡c <a href="https://docs.mongodb.com/manual/reference/glossary/#term-zone" target="_blank" rel="noopener noreferrer">vÃ¹ng</a> dá»¯ liá»‡u dá»±a trÃªn khÃ³a phÃ¢n Ä‘oáº¡n. Má»—i vÃ¹ng cÃ³ thá»ƒ Ä‘Æ°á»£c liÃªn káº¿t vá»›i má»™t hoáº·c nhiá»u phÃ¢n Ä‘oáº¡n trong cá»¥m. Má»™t phÃ¢n Ä‘oáº¡n cÃ³ thá»ƒ Ä‘Æ°á»£c liÃªn káº¿t vá»›i báº¥t ká»³ sá»‘ lÆ°á»£ng vÃ¹ng nÃ o. Trong cá»¥m cÃ¢n báº±ng, MongoDB chá»‰ di chuyá»ƒn cÃ¡c <a href="https://docs.mongodb.com/manual/reference/glossary/#term-chunk" target="_blank" rel="noopener noreferrer">chunk</a> mÃ  vÃ¹ng bao phá»§ tá»›i phÃ¢n Ä‘oáº¡n liÃªn quan Ä‘áº¿n vÃ¹ng Ä‘Ã³.</p>
<p>Má»—i vÃ¹ng bao phá»§ má»™t hoáº·c nhiá»u pháº¡m vi giÃ¡ trá»‹ khÃ³a phÃ¢n Ä‘oáº¡n. Má»—i pháº¡m vi bao phá»§ luÃ´n bao gá»“m cáº£ giá»›i háº¡n trÃªn vÃ  giá»›i háº¡n dÆ°á»›i cá»§a nÃ³.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200920214854.svg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>
<p>Khi xÃ¡c Ä‘á»‹nh cÃ¡c pháº¡m vi má»›i Ä‘á»ƒ bao phá»§ vÃ¹ng, pháº£i sá»­ dá»¥ng cÃ¡c trÆ°á»ng cÃ³ trong khÃ³a phÃ¢n Ä‘oáº¡n. Náº¿u sá»­ dá»¥ng khÃ³a phÃ¢n Ä‘oáº¡n káº¿t há»£p, pháº¡m vi pháº£i bao gá»“m tiá»n tá»‘ cá»§a khÃ³a phÃ¢n Ä‘oáº¡n.</p>
<p>Khi lá»±a chá»n khÃ³a phÃ¢n Ä‘oáº¡n, nÃªn xem xÃ©t cÃ¡c vÃ¹ng cÃ³ thá»ƒ sá»­ dá»¥ng trong tÆ°Æ¡ng lai.</p>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230724020005.png" type="image/png"/>
    </item>
    <item>
      <title>MongoDB Transaction</title>
      <link>https://vanhung4499.github.io/database/mongodb/transaction.html</link>
      <guid>https://vanhung4499.github.io/database/mongodb/transaction.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">MongoDB Transaction</source>
      <description>Giao dá»‹ch trong MongoDB writeConcern cÃ³ thá»ƒ xÃ¡c Ä‘á»‹nh sá»‘ lÆ°á»£ng node cáº§n xÃ¡c nháº­n Ä‘á»ƒ ghi thÃ nh cÃ´ng. Máº·c Ä‘á»‹nh: KhÃ´ng cÃ³ thiáº¿t láº­p nÃ o cho replica set nhiá»u node, do Ä‘Ã³ cÃ³ thá»ƒ máº¥t ...</description>
      <category>mongodb</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<p>writeConcern cÃ³ thá»ƒ xÃ¡c Ä‘á»‹nh sá»‘ lÆ°á»£ng node cáº§n xÃ¡c nháº­n Ä‘á»ƒ ghi thÃ nh cÃ´ng.</p>
<ul>
<li>Máº·c Ä‘á»‹nh: KhÃ´ng cÃ³ thiáº¿t láº­p nÃ o cho replica set nhiá»u node, do Ä‘Ã³ cÃ³ thá»ƒ máº¥t dá»¯ liá»‡u.</li>
<li><code>w: "majority"</code>: ÄÆ°á»£c coi lÃ  ghi thÃ nh cÃ´ng náº¿u háº§u háº¿t cÃ¡c node xÃ¡c nháº­n.</li>
<li><code>w: "all"</code>: Chá»‰ Ä‘Æ°á»£c coi lÃ  ghi thÃ nh cÃ´ng náº¿u táº¥t cáº£ cÃ¡c node xÃ¡c nháº­n.</li>
</ul>
<p>journal xÃ¡c Ä‘á»‹nh cÃ¡ch xem ghi thÃ nh cÃ´ng. CÃ³ cÃ¡c giÃ¡ trá»‹ sau:</p>
<ul>
<li><code>true</code>: Chá»‰ Ä‘Æ°á»£c coi lÃ  ghi thÃ nh cÃ´ng khi hoáº¡t Ä‘á»™ng ghi Ä‘Æ°á»£c lÆ°u vÃ o táº­p tin nháº­t kÃ½ (journal).</li>
<li><code>false</code>: Chá»‰ Ä‘Æ°á»£c coi lÃ  ghi thÃ nh cÃ´ng khi hoáº¡t Ä‘á»™ng ghi Ä‘Æ°á»£c lÆ°u trong bá»™ nhá»›.</li>
</ul>
<p>ã€VÃ­ dá»¥ã€‘Sá»­ dá»¥ng tham sá»‘ writeConcern trong má»™t cá»¥m</p>
<div class="language-javascript" data-ext="javascript" data-title="javascript"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">db</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">transaction</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">insert</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">({ </span><span style="color:#E06C75;--shiki-dark:#E06C75">count</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }, { </span><span style="color:#E06C75;--shiki-dark:#E06C75">writeConcern</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">w</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'majoriy'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> } })</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">db</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">transaction</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">insert</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">({ </span><span style="color:#E06C75;--shiki-dark:#E06C75">count</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }, { </span><span style="color:#E06C75;--shiki-dark:#E06C75">writeConcern</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">w</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'4'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> } })</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">db</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">transaction</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">insert</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">({ </span><span style="color:#E06C75;--shiki-dark:#E06C75">count</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> }, { </span><span style="color:#E06C75;--shiki-dark:#E06C75">writeConcern</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: { </span><span style="color:#E06C75;--shiki-dark:#E06C75">w</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#98C379;--shiki-dark:#98C379">'all'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> } })</span></span></code></pre>
</div><p>ã€VÃ­ dá»¥ã€‘Cáº¥u hÃ¬nh node trá»… Ä‘á»ƒ mÃ´ phá»ng Ä‘á»™ trá»… máº¡ng</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>conf=rs.conf()</span></span>
<span class="line"><span>conf.memebers[2].slaveDelay=5</span></span>
<span class="line"><span>conf.memebers[2].priority=0</span></span>
<span class="line"><span>rs.reconfig(conf)</span></span></code></pre>
</div>]]></content:encoded>
    </item>
    <item>
      <title>MySQL</title>
      <link>https://vanhung4499.github.io/database/mysql/</link>
      <guid>https://vanhung4499.github.io/database/mysql/</guid>
      <source url="https://vanhung4499.github.io/rss.xml">MySQL</source>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
    </item>
    <item>
      <title>MySQL Architecture</title>
      <link>https://vanhung4499.github.io/database/mysql/architecture.html</link>
      <guid>https://vanhung4499.github.io/database/mysql/architecture.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">MySQL Architecture</source>
      <description>MySQL Architecture Kiáº¿n trÃºc cÆ¡ báº£n NÃ³i chung, MySQL cÃ³ thá»ƒ Ä‘Æ°á»£c chia thÃ nh hai pháº§n: lá»›p mÃ¡y chá»§ vÃ  lá»›p lÆ°u trá»¯. Lá»›p mÃ¡y chá»§ bao gá»“m cÃ¡c thÃ nh pháº§n nhÆ° káº¿t ná»‘i, bá»™ nhá»› cache tr...</description>
      <category>mysql</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>Kiáº¿n trÃºc cÆ¡ báº£n</h2>
<p>NÃ³i chung, MySQL cÃ³ thá»ƒ Ä‘Æ°á»£c chia thÃ nh hai pháº§n: lá»›p mÃ¡y chá»§ vÃ  lá»›p lÆ°u trá»¯.</p>
<p><strong>Lá»›p mÃ¡y chá»§</strong> bao gá»“m cÃ¡c thÃ nh pháº§n nhÆ° káº¿t ná»‘i, bá»™ nhá»› cache truy váº¥n, trÃ¬nh phÃ¢n tÃ­ch, trÃ¬nh tá»‘i Æ°u hÃ³a, trÃ¬nh thá»±c thi, vv. NÃ³ bao gá»“m háº§u háº¿t cÃ¡c chá»©c nÄƒng vÃ  dá»‹ch vá»¥ cá»‘t lÃµi cá»§a MySQL, cÅ©ng nhÆ° táº¥t cáº£ cÃ¡c hÃ m tÃ­ch há»£p (nhÆ° hÃ m ngÃ y thÃ¡ng, thá»i gian, toÃ¡n há»c vÃ  mÃ£ hÃ³a), táº¥t cáº£ cÃ¡c chá»©c nÄƒng chung cho táº¥t cáº£ cÃ¡c lÆ°u trá»¯ (nhÆ° thá»§ tá»¥c lÆ°u trá»¯, trigger, view, vv).</p>
<p><strong>Lá»›p lÆ°u trá»¯</strong> chá»‹u trÃ¡ch nhiá»‡m lÆ°u trá»¯ vÃ  truy xuáº¥t dá»¯ liá»‡u. Kiáº¿n trÃºc cá»§a nÃ³ lÃ  má»™t kiáº¿n trÃºc cáº¯m, há»— trá»£ nhiá»u lÆ°u trá»¯ nhÆ° InnoDB, MyISAM, Memory, vv. Hiá»‡n nay, lÆ°u trá»¯ phá»• biáº¿n nháº¥t lÃ  InnoDB, nÃ³ Ä‘Ã£ trá»Ÿ thÃ nh lÆ°u trá»¯ máº·c Ä‘á»‹nh tá»« phiÃªn báº£n MySQL 5.5.5 trá»Ÿ Ä‘i.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/mysql-workflow.drawio.png" alt="mysql-workflow" tabindex="0" loading="lazy"><figcaption>mysql-workflow</figcaption></figure>
<h2>QuÃ¡ trÃ¬nh truy váº¥n</h2>
<p>CÃ¢u lá»‡nh SQL Ä‘Æ°á»£c thá»±c hiá»‡n nhÆ° tháº¿ nÃ o trong MySQL?</p>
<p>QuÃ¡ trÃ¬nh thá»±c hiá»‡n truy váº¥n MySQL tá»•ng cá»™ng cÃ³ 6 bÆ°á»›c, tÆ°Æ¡ng á»©ng vá»›i 6 thÃ nh pháº§n:</p>
<ol>
<li>Káº¿t ná»‘i: Káº¿t ná»‘i giá»¯a mÃ¡y khÃ¡ch vÃ  mÃ¡y chá»§ MySQL; Káº¿t ná»‘i chá»‹u trÃ¡ch nhiá»‡m thiáº¿t láº­p káº¿t ná»‘i vá»›i mÃ¡y khÃ¡ch, xÃ¡c Ä‘á»‹nh quyá»n truy cáº­p vÃ  duy trÃ¬ quáº£n lÃ½ káº¿t ná»‘i.</li>
<li>MySQL kiá»ƒm tra bá»™ nhá»› cache truy váº¥n trÆ°á»›c tiÃªn. Náº¿u truy váº¥n Ä‘Æ°á»£c lÆ°u trong bá»™ nhá»› cache, káº¿t quáº£ sáº½ Ä‘Æ°á»£c tráº£ vá» ngay láº­p tá»©c. Náº¿u khÃ´ng, chuyá»ƒn sang bÆ°á»›c tiáº¿p theo.</li>
<li>MÃ¡y chá»§ MySQL thá»±c hiá»‡n phÃ¢n tÃ­ch SQL: phÃ¢n tÃ­ch cÃº phÃ¡p, phÃ¢n tÃ­ch tá»« vá»±ng.</li>
<li>MÃ¡y chá»§ MySQL sá»­ dá»¥ng trÃ¬nh tá»‘i Æ°u hÃ³a Ä‘á»ƒ táº¡o ra káº¿ hoáº¡ch thá»±c thi tÆ°Æ¡ng á»©ng.</li>
<li>MÃ¡y chá»§ MySQL gá»i API lÆ°u trá»¯ Ä‘á»ƒ thá»±c hiá»‡n truy váº¥n dá»±a trÃªn káº¿ hoáº¡ch thá»±c hiá»‡n.</li>
<li>MÃ¡y chá»§ MySQL tráº£ káº¿t quáº£ cho mÃ¡y khÃ¡ch, Ä‘á»“ng thá»i lÆ°u káº¿t quáº£ truy váº¥n vÃ o bá»™ nhá»› cache.</li>
</ol>
<h3>(1) Káº¿t ná»‘i</h3>
<p>BÆ°á»›c Ä‘áº§u tiÃªn khi sá»­ dá»¥ng MySQL lÃ  káº¿t ná»‘i vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u. <strong>Káº¿t ná»‘i chá»‹u trÃ¡ch nhiá»‡m thiáº¿t láº­p káº¿t ná»‘i vá»›i mÃ¡y chá»§ MySQL, xÃ¡c Ä‘á»‹nh quyá»n truy cáº­p vÃ  duy trÃ¬ quáº£n lÃ½ káº¿t ná»‘i</strong>.</p>
<p>Giao tiáº¿p giá»¯a mÃ¡y khÃ¡ch vÃ  mÃ¡y chá»§ MySQL lÃ  má»™t cháº¿ Ä‘á»™ bÃ¡n song cÃ´ng: vÃ o báº¥t ká»³ thá»i Ä‘iá»ƒm nÃ o, mÃ¡y chá»§ cÃ³ thá»ƒ gá»­i dá»¯ liá»‡u cho mÃ¡y khÃ¡ch hoáº·c mÃ¡y khÃ¡ch cÃ³ thá»ƒ gá»­i dá»¯ liá»‡u cho mÃ¡y chá»§. MÃ¡y khÃ¡ch gá»­i má»™t gÃ³i dá»¯ liá»‡u duy nháº¥t chá»©a yÃªu cáº§u truy váº¥n cho mÃ¡y chá»§, vÃ¬ váº­y náº¿u cÃ¢u lá»‡nh truy váº¥n dÃ i, báº¡n cáº§n thiáº¿t láº­p tham sá»‘ <code>max_allowed_packet</code>. Tuy nhiÃªn, náº¿u cÃ¢u lá»‡nh truy váº¥n quÃ¡ lá»›n, mÃ¡y chá»§ sáº½ tá»« chá»‘i nháº­n thÃªm dá»¯ liá»‡u vÃ  nÃ©m ra má»™t ngoáº¡i lá»‡.</p>
<p>Lá»‡nh káº¿t ná»‘i MySQL cá»§a khÃ¡ch hÃ ng: <code>mysql -h&lt;host&gt; -P&lt;port&gt; -u&lt;username&gt; -p&lt;password&gt;</code>. Náº¿u khÃ´ng chá»‰ Ä‘á»‹nh máº­t kháº©u, báº¡n sáº½ Ä‘Æ°á»£c yÃªu cáº§u nháº­p máº­t kháº©u trÆ°á»›c khi truy cáº­p.</p>
<p>Sau khi thiáº¿t láº­p káº¿t ná»‘i, náº¿u khÃ´ng cÃ³ hoáº¡t Ä‘á»™ng tiáº¿p theo, káº¿t ná»‘i sáº½ á»Ÿ tráº¡ng thÃ¡i khÃ´ng hoáº¡t Ä‘á»™ng vÃ  báº¡n cÃ³ thá»ƒ tháº¥y nÃ³ trong lá»‡nh <code>show processlist</code>. Náº¿u khÃ¡ch hÃ ng khÃ´ng hoáº¡t Ä‘á»™ng trong thá»i gian quÃ¡ lÃ¢u, káº¿t ná»‘i sáº½ tá»± Ä‘á»™ng bá»‹ Ä‘Ã³ng. Thá»i gian duy trÃ¬ káº¿t ná»‘i cá»§a khÃ¡ch hÃ ng Ä‘Æ°á»£c Ä‘iá»u chá»‰nh báº±ng tham sá»‘ <code>wait_timeout</code>, giÃ¡ trá»‹ máº·c Ä‘á»‹nh lÃ  8 giá». Náº¿u káº¿t ná»‘i bá»‹ Ä‘Ã³ng vÃ  khÃ¡ch hÃ ng gá»­i yÃªu cáº§u truy váº¥n, báº¡n sáº½ nháº­n Ä‘Æ°á»£c thÃ´ng bÃ¡o lá»—i "Lost connection to MySQL server during query". Trong trÆ°á»ng há»£p nÃ y, báº¡n cáº§n pháº£i káº¿t ná»‘i láº¡i vÃ  thá»±c hiá»‡n yÃªu cáº§u truy váº¥n.</p>
<p>QuÃ¡ trÃ¬nh thiáº¿t láº­p káº¿t ná»‘i thÆ°á»ng lÃ  phá»©c táº¡p, do Ä‘Ã³, khuyáº¿n nghá»‹ giáº£m thiá»ƒu sá»‘ láº§n thiáº¿t láº­p káº¿t ná»‘i trong quÃ¡ trÃ¬nh sá»­ dá»¥ng vÃ  sá»­ dá»¥ng káº¿t ná»‘i dÃ i hÆ¡n. Äá»ƒ tÄƒng cÆ°á»ng viá»‡c tÃ¡i sá»­ dá»¥ng káº¿t ná»‘i cÆ¡ sá»Ÿ dá»¯ liá»‡u trong chÆ°Æ¡ng trÃ¬nh, thÆ°á»ng sá»­ dá»¥ng bá»ƒ káº¿t ná»‘i cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘á»ƒ quáº£n lÃ½ vÃ  duy trÃ¬.</p>
<p>Tuy nhiÃªn, náº¿u chá»‰ sá»­ dá»¥ng káº¿t ná»‘i dÃ i hÆ¡n, báº¡n cÃ³ thá»ƒ nháº­n tháº¥y ráº±ng MySQL sá»­ dá»¥ng bá»™ nhá»› nhanh hÆ¡n. Äiá»u nÃ y lÃ  do MySQL sá»­ dá»¥ng bá»™ nhá»› táº¡m thá»i trong quÃ¡ trÃ¬nh thá»±c thi vÃ  giá»¯ tÃ i nguyÃªn káº¿t ná»‘i. Nhá»¯ng tÃ i nguyÃªn nÃ y chá»‰ Ä‘Æ°á»£c giáº£i phÃ³ng khi káº¿t ná»‘i bá»‹ Ä‘Ã³ng. Do Ä‘Ã³, náº¿u tÃ­ch lÅ©y káº¿t ná»‘i dÃ i hÆ¡n, cÃ³ thá»ƒ dáº«n Ä‘áº¿n sá»± sá»­ dá»¥ng bá»™ nhá»› quÃ¡ lá»›n vÃ  bá»‹ há»‡ thá»‘ng giáº¿t (OOM). Khi xáº£y ra hiá»‡n tÆ°á»£ng nÃ y, MySQL sáº½ khá»Ÿi Ä‘á»™ng láº¡i má»™t cÃ¡ch báº¥t thÆ°á»ng.</p>
<p>LÃ m tháº¿ nÃ o Ä‘á»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y? Báº¡n cÃ³ thá»ƒ xem xÃ©t hai giáº£i phÃ¡p sau Ä‘Ã¢y.</p>
<ul>
<li><strong>ÄÃ³ng káº¿t ná»‘i dÃ i hÆ¡n Ä‘á»‹nh ká»³</strong>: Sá»­ dá»¥ng má»™t khoáº£ng thá»i gian hoáº·c kiá»ƒm tra trong chÆ°Æ¡ng trÃ¬nh, sau khi thá»±c hiá»‡n má»™t hoáº¡t Ä‘á»™ng chiáº¿m nhiá»u bá»™ nhá»›, Ä‘Ã³ng káº¿t ná»‘i vÃ  sau Ä‘Ã³ thá»±c hiá»‡n káº¿t ná»‘i láº¡i khi cáº§n truy váº¥n.</li>
<li>Náº¿u báº¡n Ä‘ang sá»­ dá»¥ng phiÃªn báº£n MySQL 5.7 trá»Ÿ lÃªn, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng <code>mysql_reset_connection</code> Ä‘á»ƒ khá»Ÿi táº¡o láº¡i tÃ i nguyÃªn káº¿t ná»‘i sau má»—i hoáº¡t Ä‘á»™ng lá»›n. QuÃ¡ trÃ¬nh nÃ y khÃ´ng cáº§n pháº£i káº¿t ná»‘i láº¡i vÃ  xÃ¡c thá»±c quyá»n, nhÆ°ng sáº½ khÃ´i phá»¥c káº¿t ná»‘i vá» tráº¡ng thÃ¡i ban Ä‘áº§u khi táº¡o ra.</li>
</ul>
<h3>(2) Bá»™ nhá»› cache truy váº¥n</h3>
<blockquote>
<p><strong>KhÃ´ng khuyáº¿n nghá»‹ sá»­ dá»¥ng bá»™ nhá»› cache truy váº¥n, vÃ¬ thÆ°á»ng cÃ³ nhiá»u háº¡i hÆ¡n lá»£i Ã­ch</strong>.</p>
</blockquote>
<p>TrÆ°á»›c khi phÃ¢n tÃ­ch má»™t cÃ¢u lá»‡nh truy váº¥n, náº¿u bá»™ nhá»› cache truy váº¥n Ä‘Æ°á»£c báº­t, MySQL sáº½ kiá»ƒm tra xem cÃ¢u lá»‡nh truy váº¥n nÃ y cÃ³ trÃºng káº¿t quáº£ trong bá»™ nhá»› cache khÃ´ng. Náº¿u truy váº¥n hiá»‡n táº¡i trÃ¹ng khá»›p vá»›i dá»¯ liá»‡u trong bá»™ nhá»› cache, sau khi kiá»ƒm tra quyá»n cá»§a ngÆ°á»i dÃ¹ng, káº¿t quáº£ sáº½ Ä‘Æ°á»£c tráº£ vá» trá»±c tiáº¿p tá»« bá»™ nhá»› cache. Trong trÆ°á»ng há»£p nÃ y, truy váº¥n khÃ´ng Ä‘Æ°á»£c phÃ¢n tÃ­ch, khÃ´ng táº¡o káº¿ hoáº¡ch thá»±c hiá»‡n, vÃ  khÃ´ng thá»±c hiá»‡n.</p>
<p>MySQL lÆ°u trá»¯ bá»™ nhá»› cache trong má»™t báº£ng tham chiáº¿u (Ä‘á»«ng hiá»ƒu nháº§m lÃ  <code>table</code>, cÃ³ thá»ƒ coi nÃ³ lÃ  má»™t cáº¥u trÃºc dá»¯ liá»‡u giá»‘ng <code>HashMap</code>), Ä‘Æ°á»£c chá»‰ má»¥c báº±ng má»™t giÃ¡ trá»‹ bÄƒm Ä‘Æ°á»£c tÃ­nh toÃ¡n tá»« cÃ¡c yáº¿u tá»‘ cÃ³ thá»ƒ áº£nh hÆ°á»Ÿng Ä‘áº¿n káº¿t quáº£ truy váº¥n, bao gá»“m truy váº¥n hiá»‡n táº¡i, cÆ¡ sá»Ÿ dá»¯ liá»‡u hiá»‡n táº¡i vÃ  sá»‘ phiÃªn báº£n giao thá»©c khÃ¡ch hÃ ng. VÃ¬ váº­y, báº¥t ká»³ sá»± khÃ¡c biá»‡t nÃ o trong cÃ¡c kÃ½ tá»± (vÃ­ dá»¥: khoáº£ng tráº¯ng, chÃº thÃ­ch) cÅ©ng sáº½ khiáº¿n bá»™ nhá»› cache khÃ´ng trÃ¹ng khá»›p.</p>
<p><strong>Náº¿u truy váº¥n chá»©a báº¥t ká»³ hÃ m ngÆ°á»i dÃ¹ng, hÃ m lÆ°u trá»¯, biáº¿n ngÆ°á»i dÃ¹ng, báº£ng táº¡m thá»i hoáº·c báº£ng há»‡ thá»‘ng trong cÆ¡ sá»Ÿ dá»¯ liá»‡u mysql, káº¿t quáº£ truy váº¥n sáº½ khÃ´ng Ä‘Æ°á»£c lÆ°u vÃ o bá»™ nhá»› cache</strong>. VÃ­ dá»¥, cÃ¡c hÃ m <code>NOW()</code> hoáº·c <code>CURRENT_DATE()</code> sáº½ tráº£ vá» káº¿t quáº£ khÃ¡c nhau dá»±a trÃªn thá»i gian truy váº¥n, vÃ  cÃ¡c truy váº¥n chá»©a <code>CURRENT_USER</code> hoáº·c <code>CONNECTION_ID()</code> sáº½ tráº£ vá» káº¿t quáº£ khÃ¡c nhau dá»±a trÃªn ngÆ°á»i dÃ¹ng, viá»‡c lÆ°u káº¿t quáº£ truy váº¥n nhÆ° váº­y khÃ´ng cÃ³ Ã½ nghÄ©a.</p>
<p><strong>KhÃ´ng khuyáº¿n nghá»‹ sá»­ dá»¥ng bá»™ nhá»› cache truy váº¥n, vÃ¬ thÆ°á»ng cÃ³ nhiá»u háº¡i hÆ¡n lá»£i Ã­ch</strong>. Tá»· lá»‡ trÃºng káº¿t quáº£ cá»§a bá»™ nhá»› cache truy váº¥n thÆ°á»ng ráº¥t tháº¥p, chá»‰ cáº§n cÃ³ báº¥t ká»³ cáº­p nháº­t nÃ o trÃªn má»™t báº£ng, táº¥t cáº£ cÃ¡c bá»™ nhá»› cache truy váº¥n cá»§a báº£ng Ä‘Ã³ sáº½ bá»‹ xÃ³a. Do Ä‘Ã³, kháº£ nÄƒng trÃºng káº¿t quáº£ cá»§a bá»™ nhá»› cache truy váº¥n trong cÆ¡ sá»Ÿ dá»¯ liá»‡u cÃ³ Ã¡p lá»±c cáº­p nháº­t lá»›n sáº½ ráº¥t tháº¥p. Trá»« khi báº¡n cÃ³ má»™t báº£ng tÄ©nh vÃ  chá»‰ cáº§n cáº­p nháº­t má»™t láº§n trong thá»i gian dÃ i. VÃ­ dá»¥, má»™t báº£ng cáº¥u hÃ¬nh há»‡ thá»‘ng, trong trÆ°á»ng há»£p nÃ y, truy váº¥n trÃªn báº£ng nÃ y sáº½ phÃ¹ há»£p vá»›i viá»‡c sá»­ dá»¥ng bá»™ nhá»› cache truy váº¥n.</p>
<p>May máº¯n thay, MySQL cÅ©ng cung cáº¥p cÃ¡ch "sá»­ dá»¥ng theo yÃªu cáº§u". Báº¡n cÃ³ thá»ƒ Ä‘áº·t tham sá»‘ <code>query_cache_type</code> thÃ nh <code>DEMAND</code>, Ä‘iá»u nÃ y sáº½ khÃ´ng sá»­ dá»¥ng bá»™ nhá»› cache truy váº¥n cho cÃ¡c cÃ¢u lá»‡nh SQL máº·c Ä‘á»‹nh. Äá»‘i vá»›i cÃ¡c cÃ¢u lá»‡nh SQL mÃ  báº¡n muá»‘n sá»­ dá»¥ng bá»™ nhá»› cache truy váº¥n, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng <code>SQL_CACHE</code> Ä‘á»ƒ chá»‰ Ä‘á»‹nh, giá»‘ng nhÆ° cÃ¢u lá»‡nh dÆ°á»›i Ä‘Ã¢y:</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">select</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> SQL_CACHE * </span><span style="color:#C678DD;--shiki-dark:#C678DD">from</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> T </span><span style="color:#C678DD;--shiki-dark:#C678DD">where</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> ID</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66">10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span></code></pre>
</div><blockquote>
<p>LÆ°u Ã½: PhiÃªn báº£n MySQL 8.0 Ä‘Ã£ loáº¡i bá» hoÃ n toÃ n chá»©c nÄƒng bá»™ nhá»› cache truy váº¥n.</p>
</blockquote>
<h3>(3) PhÃ¢n tÃ­ch cÃº phÃ¡p</h3>
<p>Náº¿u khÃ´ng trÃºng káº¿t quáº£ bá»™ nhá»› cache truy váº¥n, quÃ¡ trÃ¬nh thá»±c thi cÃ¢u lá»‡nh sáº½ báº¯t Ä‘áº§u. TrÆ°á»›c tiÃªn, MySQL cáº§n biáº¿t báº¡n muá»‘n lÃ m gÃ¬, vÃ¬ váº­y nÃ³ cáº§n phÃ¢n tÃ­ch cÃ¢u lá»‡nh SQL. MySQL sá»­ dá»¥ng tá»« khÃ³a Ä‘á»ƒ phÃ¢n tÃ­ch cÃ¢u lá»‡nh SQL vÃ  táº¡o ra má»™t cÃ¢y phÃ¢n tÃ­ch cÃº phÃ¡p tÆ°Æ¡ng á»©ng. Trong quÃ¡ trÃ¬nh nÃ y, trÃ¬nh phÃ¢n tÃ­ch sá»­ dá»¥ng cÃ¡c quy táº¯c cÃº phÃ¡p Ä‘á»ƒ xÃ¡c minh vÃ  phÃ¢n tÃ­ch cÃ¢y phÃ¢n tÃ­ch cÃº phÃ¡p cá»§a báº¡n. VÃ­ dá»¥, trÃ¬nh phÃ¢n tÃ­ch sáº½ nháº­n ra tá»« khÃ³a "select" báº¡n nháº­p vÃ  xÃ¡c Ä‘á»‹nh Ä‘Ã¢y lÃ  má»™t cÃ¢u lá»‡nh truy váº¥n. NÃ³ cÅ©ng sáº½ nháº­n ra chuá»—i "T" lÃ  "tÃªn báº£ng T" vÃ  chuá»—i "ID" lÃ  "cá»™t ID".</p>
<ul>
<li>TrÃ¬nh phÃ¢n tÃ­ch Ä‘áº§u tiÃªn thá»±c hiá»‡n "phÃ¢n tÃ­ch tá»« vá»±ng". Báº¡n nháº­p vÃ o má»™t cÃ¢u lá»‡nh SQL gá»“m nhiá»u chuá»—i vÃ  dáº¥u cÃ¡ch, MySQL cáº§n xÃ¡c Ä‘á»‹nh cÃ¡c chuá»—i Ä‘Ã³ Ä‘áº¡i diá»‡n cho cÃ¡i gÃ¬. MySQL nháº­n ra tá»« khÃ³a "select" tá»« báº¡n nháº­p vÃ o, Ä‘Ã³ lÃ  má»™t cÃ¢u lá»‡nh truy váº¥n. NÃ³ cÅ©ng nháº­n ra chuá»—i "T" lÃ  "tÃªn báº£ng T" vÃ  chuá»—i "ID" lÃ  "cá»™t ID".</li>
<li>Tiáº¿p theo, thá»±c hiá»‡n "phÃ¢n tÃ­ch cÃº phÃ¡p". Dá»±a trÃªn káº¿t quáº£ phÃ¢n tÃ­ch tá»« vá»±ng, trÃ¬nh phÃ¢n tÃ­ch cÃº phÃ¡p sáº½ xÃ¡c Ä‘á»‹nh xem cÃ¢u lá»‡nh SQL báº¡n nháº­p cÃ³ Ä‘Ã¡p á»©ng cÃº phÃ¡p cá»§a MySQL khÃ´ng. Náº¿u cÃ¢u lá»‡nh cá»§a báº¡n khÃ´ng Ä‘Ãºng, báº¡n sáº½ nháº­n Ä‘Æ°á»£c thÃ´ng bÃ¡o lá»—i "You have an error in your SQL syntax", vÃ­ dá»¥ nhÆ° cÃ¢u lá»‡nh select bá»‹ thiáº¿u chá»¯ cÃ¡i "s".</li>
</ul>
<h3>(4) Tá»‘i Æ°u hÃ³a truy váº¥n</h3>
<p>Sau khi hoÃ n thÃ nh phÃ¢n tÃ­ch vÃ  xÃ¡c Ä‘á»‹nh cÃ¢u lá»‡nh SQL, MySQL sáº½ tiáº¿n hÃ nh tá»‘i Æ°u hÃ³a truy váº¥n.</p>
<p>Sau khi hoÃ n thÃ nh phÃ¢n tÃ­ch vÃ  xÃ¡c Ä‘á»‹nh cÃ¢y phÃ¢n tÃ­ch cÃº phÃ¡p, MySQL sáº½ chuyá»ƒn Ä‘á»•i nÃ³ thÃ nh káº¿ hoáº¡ch thá»±c hiá»‡n tÆ°Æ¡ng á»©ng. Trong háº§u háº¿t cÃ¡c trÆ°á»ng há»£p, má»™t truy váº¥n cÃ³ thá»ƒ cÃ³ nhiá»u cÃ¡ch thá»±c hiá»‡n, nhÆ°ng káº¿t quáº£ cuá»‘i cÃ¹ng váº«n lÃ  cÃ¹ng má»™t. Nhiá»‡m vá»¥ cá»§a trÃ¬nh tá»‘i Æ°u hÃ³a lÃ  tÃ¬m ra káº¿ hoáº¡ch thá»±c hiá»‡n tá»‘t nháº¥t trong sá»‘ Ä‘Ã³.</p>
<p>MySQL sá»­ dá»¥ng trÃ¬nh tá»‘i Æ°u hÃ³a dá»±a trÃªn chi phÃ­, nÃ³ cá»‘ gáº¯ng dá»± Ä‘oÃ¡n chi phÃ­ cá»§a má»™t truy váº¥n khi sá»­ dá»¥ng má»™t káº¿ hoáº¡ch thá»±c hiá»‡n cá»¥ thá»ƒ vÃ  chá»n káº¿ hoáº¡ch cÃ³ chi phÃ­ nhá» nháº¥t. Trong MySQL, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng giÃ¡ trá»‹ <code>last_query_cost</code> cá»§a phiÃªn truy váº¥n hiá»‡n táº¡i Ä‘á»ƒ tÃ­nh toÃ¡n chi phÃ­ truy váº¥n hiá»‡n táº¡i.</p>
<div class="language-ruby" data-ext="ruby" data-title="ruby"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">mysql</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> select</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> *</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> from t_message limit </span><span style="color:#D19A66;--shiki-dark:#D19A66">10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">...</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">Omit</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> result set</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">mysql</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> show status like </span><span style="color:#98C379;--shiki-dark:#98C379">'last_query_cost'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2">+</span></span></code></pre>
</div>]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/mysql-workflow.drawio.png" type="image/png"/>
    </item>
    <item>
      <title>MySQL Configuration</title>
      <link>https://vanhung4499.github.io/database/mysql/configuration.html</link>
      <guid>https://vanhung4499.github.io/database/mysql/configuration.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">MySQL Configuration</source>
      <description>Cáº¥u hÃ¬nh MySQL PhiÃªn báº£n: mysql Cáº¥u hÃ¬nh cÆ¡ báº£n Giáº£i thÃ­ch cÃ¡c cáº¥u hÃ¬nh</description>
      <category>mysql</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>PhiÃªn báº£n: <img src="https://img.shields.io/badge/mysql-8.0-blue" alt="mysql" loading="lazy"></p>
</blockquote>
<h2>Cáº¥u hÃ¬nh cÆ¡ báº£n</h2>
<div class="language-ini" data-ext="ini" data-title="ini"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">[mysqld]</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># GENERAL</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">#</span></span></code></pre>
</div>]]></content:encoded>
      <enclosure url="https://img.shields.io/badge/mysql-8.0-blue" type="image/"/>
    </item>
    <item>
      <title>MySQL Storage Engine</title>
      <link>https://vanhung4499.github.io/database/mysql/engine.html</link>
      <guid>https://vanhung4499.github.io/database/mysql/engine.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">MySQL Storage Engine</source>
      <description>MySQL Storage Engine CÃ¡c storage engine trong MySQL Trong há»‡ thá»‘ng tá»‡p, MySQL lÆ°u má»—i cÆ¡ sá»Ÿ dá»¯ liá»‡u (cÅ©ng cÃ³ thá»ƒ gá»i lÃ  schema) dÆ°á»›i dáº¡ng má»™t thÆ° má»¥c con trong thÆ° má»¥c dá»¯ liá»‡u. ...</description>
      <category>mysql</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>CÃ¡c storage engine trong MySQL</h2>
<p>Trong há»‡ thá»‘ng tá»‡p, MySQL lÆ°u má»—i cÆ¡ sá»Ÿ dá»¯ liá»‡u (cÅ©ng cÃ³ thá»ƒ gá»i lÃ  schema) dÆ°á»›i dáº¡ng má»™t thÆ° má»¥c con trong thÆ° má»¥c dá»¯ liá»‡u. Khi táº¡o báº£ng, MySQL sáº½ táº¡o má»™t tá»‡p <code>.frm</code> cÃ¹ng tÃªn vá»›i báº£ng trong thÆ° má»¥c cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘á»ƒ lÆ°u Ä‘á»‹nh nghÄ©a cá»§a báº£ng. VÃ¬ MySQL sá»­ dá»¥ng cÃ¡c thÆ° má»¥c vÃ  tá»‡p há»‡ thá»‘ng tá»‡p Ä‘á»ƒ lÆ°u Ä‘á»‹nh nghÄ©a cÆ¡ sá»Ÿ dá»¯ liá»‡u vÃ  báº£ng, tÃ­nh nháº¡y cáº£m chá»¯ hoa chá»¯ thÆ°á»ng phá»¥ thuá»™c vÃ o ná»n táº£ng cá»¥ thá»ƒ. Trong Windows, tÃ­nh nháº¡y cáº£m chá»¯ hoa chá»¯ thÆ°á»ng khÃ´ng Ä‘Æ°á»£c Ã¡p dá»¥ng; trong cÃ¡c há»‡ thá»‘ng tÆ°Æ¡ng tá»± Unix, tÃ­nh nháº¡y cáº£m chá»¯ hoa chá»¯ thÆ°á»ng Ä‘Æ°á»£c Ã¡p dá»¥ng. <strong>CÃ¡c storage engine khÃ¡c nhau lÆ°u trá»¯ dá»¯ liá»‡u vÃ  chá»‰ má»¥c theo cÃ¡ch khÃ¡c nhau, nhÆ°ng Ä‘á»‹nh nghÄ©a báº£ng thÃ¬ Ä‘Æ°á»£c xá»­ lÃ½ thá»‘ng nháº¥t á»Ÿ táº§ng dá»‹ch vá»¥ cá»§a MySQL.</strong></p>
<p>MySQL sá»­ dá»¥ng cÃ¡c storage engine dÆ°á»›i dáº¡ng plugin, má»—i storage engine nháº¯m Ä‘áº¿n má»™t mÃ´i trÆ°á»ng á»©ng dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»¥ thá»ƒ. Äá»“ng thá»i, MySQL mÃ£ nguá»“n má»Ÿ cÃ²n cho phÃ©p cÃ¡c nhÃ  phÃ¡t triá»ƒn thiáº¿t láº­p cÃ¡c storage engine riÃªng cá»§a há». DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ storage engine phá»• biáº¿n:</p>
<ul>
<li>storage engine InnoDB: ÄÃ¢y lÃ  storage engine máº·c Ä‘á»‹nh tá»« phiÃªn báº£n MySQL 5.5 trá»Ÿ Ä‘i, vá»›i Ä‘áº·c Ä‘iá»ƒm lá»›n nháº¥t lÃ  há»— trá»£ giao dá»‹ch, khÃ³a cáº¥p hÃ ng, vÃ  rÃ ng buá»™c khÃ³a ngoáº¡i.</li>
<li>storage engine MyISAM: LÃ  storage engine máº·c Ä‘á»‹nh trÆ°á»›c phiÃªn báº£n MySQL 5.5, khÃ´ng há»— trá»£ giao dá»‹ch, cÅ©ng khÃ´ng há»— trá»£ khÃ³a ngoáº¡i, nhÆ°ng cÃ³ Ä‘áº·c Ä‘iá»ƒm lá»›n nháº¥t lÃ  tá»‘c Ä‘á»™ nhanh vÃ  chiáº¿m Ã­t tÃ i nguyÃªn.</li>
<li>storage engine Memory: Sá»­ dá»¥ng bá»™ nhá»› há»‡ thá»‘ng lÃ m phÆ°Æ¡ng tiá»‡n lÆ°u trá»¯ Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c tá»‘c Ä‘á»™ pháº£n há»“i nhanh hÆ¡n. Tuy nhiÃªn, náº¿u quÃ¡ trÃ¬nh mysqld bá»‹ sáº­p, táº¥t cáº£ dá»¯ liá»‡u sáº½ bá»‹ máº¥t, do Ä‘Ã³ chá»‰ nÃªn sá»­ dá»¥ng storage engine Memory khi dá»¯ liá»‡u lÃ  táº¡m thá»i.</li>
<li>storage engine NDB: CÃ²n Ä‘Æ°á»£c gá»i lÃ  storage engine NDB Cluster, chá»§ yáº¿u Ä‘Æ°á»£c sá»­ dá»¥ng cho mÃ´i trÆ°á»ng cá»¥m phÃ¢n tÃ¡n MySQL Cluster, tÆ°Æ¡ng tá»± nhÆ° cá»¥m RAC cá»§a Oracle.</li>
<li>storage engine Archive: CÃ³ cÆ¡ cháº¿ nÃ©n tá»‘t, dÃ¹ng Ä‘á»ƒ lÆ°u trá»¯ tá»‡p. Khi yÃªu cáº§u ghi dá»¯ liá»‡u, sáº½ thá»±c hiá»‡n nÃ©n, do Ä‘Ã³ thÆ°á»ng Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ lÃ m kho lÆ°u trá»¯.</li>
</ul>
<h2>CÃ¡c thao tÃ¡c liÃªn quan Ä‘áº¿n storage engine</h2>
<h3>Lá»‡nh show storage engine</h3>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"># Xem cÃ¡c storage engine Ä‘Æ°á»£c há»— trá»£</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">SHOW ENGINES;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"># Xem storage engine máº·c Ä‘á»‹nh</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">SHOW VARIABLES </span><span style="color:#C678DD;--shiki-dark:#C678DD">LIKE</span><span style="color:#98C379;--shiki-dark:#98C379"> 'storage_engine'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"># Xem storage engine cá»§a má»™t báº£ng cá»¥ thá»ƒ</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">SHOW </span><span style="color:#C678DD;--shiki-dark:#C678DD">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> TABLE</span><span style="color:#98C379;--shiki-dark:#98C379"> `table_name`</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"># Xem storage engine cá»§a má»™t báº£ng cá»¥ thá»ƒ trong má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">SHOW </span><span style="color:#C678DD;--shiki-dark:#C678DD">TABLE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> STATUS</span><span style="color:#C678DD;--shiki-dark:#C678DD"> LIKE</span><span style="color:#98C379;--shiki-dark:#98C379"> 'table_name'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">SHOW </span><span style="color:#C678DD;--shiki-dark:#C678DD">TABLE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> STATUS</span><span style="color:#C678DD;--shiki-dark:#C678DD"> FROM</span><span style="color:#98C379;--shiki-dark:#98C379"> `database_name`</span><span style="color:#C678DD;--shiki-dark:#C678DD"> WHERE</span><span style="color:#98C379;--shiki-dark:#98C379"> `name`</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> =</span><span style="color:#98C379;--shiki-dark:#98C379"> "table_name"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span></code></pre>
</div><h2>CÃ¡c lá»‡nh thiáº¿t láº­p storage engine</h2>
<h3>Lá»‡nh táº¡o vÃ  thay Ä‘á»•i storage engine</h3>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"># Chá»‰ Ä‘á»‹nh storage engine khi táº¡o báº£ng, náº¿u khÃ´ng chá»‰ Ä‘á»‹nh rÃµ, máº·c Ä‘á»‹nh lÃ  INNODB</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> TABLE</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> t1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> (i </span><span style="color:#C678DD;--shiki-dark:#C678DD">INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) ENGINE </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> INNODB;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> TABLE</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> t2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> (i </span><span style="color:#C678DD;--shiki-dark:#C678DD">INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) ENGINE </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> CSV;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> TABLE</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> t3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> (i </span><span style="color:#C678DD;--shiki-dark:#C678DD">INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) ENGINE </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> MEMORY;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"># Thay Ä‘á»•i storage engine</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">ALTER</span><span style="color:#C678DD;--shiki-dark:#C678DD"> TABLE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> t ENGINE </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> InnoDB;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"># Thay Ä‘á»•i storage engine máº·c Ä‘á»‹nh, cÅ©ng cÃ³ thá»ƒ thay Ä‘á»•i trong tá»‡p cáº¥u hÃ¬nh </span><span style="color:#D19A66;--shiki-dark:#D19A66">my</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">cnf</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SET</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> default_storage_engine</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">NDBCLUSTER;</span></span></code></pre>
</div><p>Máº·c Ä‘á»‹nh, má»—i khi <code>CREATE TABLE</code> hoáº·c <code>ALTER TABLE</code> khÃ´ng thá»ƒ sá»­ dá»¥ng storage engine máº·c Ä‘á»‹nh, sáº½ táº¡o ra má»™t cáº£nh bÃ¡o. Äá»ƒ ngÄƒn cháº·n hÃ nh vi gÃ¢y nháº§m láº«n khi storage engine yÃªu cáº§u khÃ´ng kháº£ dá»¥ng, cÃ³ thá»ƒ kÃ­ch hoáº¡t cháº¿ Ä‘á»™ <code>NO_ENGINE_SUBSTITUTION SQL</code>. Náº¿u bá»™ mÃ¡y yÃªu cáº§u khÃ´ng kháº£ dá»¥ng, thiáº¿t láº­p nÃ y sáº½ táº¡o ra lá»—i thay vÃ¬ cáº£nh bÃ¡o vÃ  sáº½ khÃ´ng táº¡o hoáº·c thay Ä‘á»•i báº£ng.</p>
<h2>Giá»›i thiá»‡u vá» cÃ¡c storage engine MySQL</h2>
<h3>CÃ¡c storage engine tÃ­ch há»£p trong MySQL</h3>
<ul>
<li><strong>InnoDB</strong> - InnoDB lÃ  storage engine máº·c Ä‘á»‹nh tá»« phiÃªn báº£n MySQL 5.5 trá»Ÿ Ä‘i. NÃ³ cung cáº¥p khÃ³a cáº¥p hÃ ng vÃ  rÃ ng buá»™c khÃ³a ngoáº¡i. Hiá»‡u suáº¥t tá»‘t vÃ  há»— trá»£ tá»± Ä‘á»™ng phá»¥c há»“i sau khi gáº·p sá»± cá»‘.</li>
<li><strong>MyISAM</strong> - TrÆ°á»›c phiÃªn báº£n MySQL 5.5, MyISAM lÃ  storage engine máº·c Ä‘á»‹nh. NÃ³ cÃ³ nhiá»u tÃ­nh nÄƒng nhÆ°ng khÃ´ng há»— trá»£ giao dá»‹ch, khÃ´ng há»— trá»£ khÃ³a cáº¥p hÃ ng vÃ  khÃ³a ngoáº¡i, vÃ  khÃ´ng cÃ³ kháº£ nÄƒng phá»¥c há»“i sau sá»± cá»‘.</li>
<li><strong>CSV</strong> - CÃ³ thá»ƒ xá»­ lÃ½ tá»‡p CSV nhÆ° báº£ng MySQL, nhÆ°ng báº£ng nÃ y khÃ´ng há»— trá»£ chá»‰ má»¥c.</li>
<li><strong>Memory</strong> - LÆ°u trá»¯ dá»¯ liá»‡u trong bá»™ nhá»› Ä‘á»ƒ cÃ³ tá»‘c Ä‘á»™ pháº£n há»“i nhanh hÆ¡n. Tuy nhiÃªn, náº¿u quÃ¡ trÃ¬nh mysqld gáº·p sá»± cá»‘, táº¥t cáº£ dá»¯ liá»‡u sáº½ bá»‹ máº¥t.</li>
<li><strong>NDB</strong> - CÃ²n gá»i lÃ  storage engine NDB Cluster, chá»§ yáº¿u dÃ¹ng cho mÃ´i trÆ°á»ng cá»¥m phÃ¢n tÃ¡n MySQL Cluster, tÆ°Æ¡ng tá»± nhÆ° cá»¥m RAC cá»§a Oracle.</li>
<li><strong>Archive</strong> - storage engine Archive ráº¥t phÃ¹ há»£p Ä‘á»ƒ lÆ°u trá»¯ dá»¯ liá»‡u.
<ul>
<li>storage engine Archive chá»‰ há»— trá»£ thao tÃ¡c <code>INSERT</code> vÃ  <code>SELECT</code>.</li>
<li>storage engine Archive sá»­ dá»¥ng thuáº­t toÃ¡n nÃ©n zlib, vá»›i tá»· lá»‡ nÃ©n cÃ³ thá»ƒ Ä‘áº¡t 1:10.</li>
</ul>
</li>
</ul>
<h3>CÃ¡ch chá»n storage engine phÃ¹ há»£p</h3>
<p>Pháº§n lá»›n trÆ°á»ng há»£p, InnoDB lÃ  lá»±a chá»n Ä‘Ãºng Ä‘áº¯n, trá»« khi cáº§n cÃ¡c tÃ­nh nÄƒng mÃ  InnoDB khÃ´ng cÃ³.</p>
<p>Náº¿u á»©ng dá»¥ng cáº§n chá»n storage engine khÃ¡c InnoDB, cÃ³ thá»ƒ xem xÃ©t cÃ¡c yáº¿u tá»‘ sau:</p>
<ul>
<li><strong>Giao dá»‹ch</strong>: Náº¿u ká»‹ch báº£n kinh doanh lÃ  OLTP, thÃ¬ InnoDB lÃ  storage engine Ä‘Æ°á»£c Æ°u tiÃªn. Náº¿u khÃ´ng cáº§n há»— trá»£ giao dá»‹ch vÃ  chá»§ yáº¿u lÃ  cÃ¡c thao tÃ¡c SELECT vÃ  INSERT, MyISAM lÃ  lá»±a chá»n tá»‘t. VÃ¬ váº­y, náº¿u MySQL Ä‘Æ°á»£c triá»ƒn khai theo mÃ´ hÃ¬nh chá»§ - phá»¥ vÃ  tÃ¡ch biá»‡t Ä‘á»c/ghi, cÃ³ thá»ƒ lÃ m nhÆ° sau: nÃºt chÃ­nh chá»‰ há»— trá»£ ghi, bá»™ mÃ¡y máº·c Ä‘á»‹nh lÃ  InnoDB; nÃºt phá»¥ chá»‰ há»— trá»£ Ä‘á»c, bá»™ mÃ¡y máº·c Ä‘á»‹nh lÃ  MyISAM.</li>
<li><strong>Äá»“ng thá»i</strong>: MyISAM chá»‰ há»— trá»£ khÃ³a cáº¥p báº£ng, trong khi InnoDB há»— trá»£ khÃ³a cáº¥p hÃ ng. Do Ä‘Ã³, InnoDB cÃ³ hiá»‡u suáº¥t Ä‘á»“ng thá»i cao hÆ¡n.</li>
<li><strong>KhÃ³a ngoáº¡i</strong>: InnoDB há»— trá»£ khÃ³a ngoáº¡i.</li>
<li><strong>Sao lÆ°u</strong>: InnoDB há»— trá»£ sao lÆ°u nÃ³ng trá»±c tuyáº¿n.</li>
<li><strong>Phá»¥c há»“i sau sá»± cá»‘</strong>: Kháº£ nÄƒng hÆ° há»ng sau sá»± cá»‘ cá»§a MyISAM cao hÆ¡n nhiá»u so vá»›i InnoDB, vÃ  tá»‘c Ä‘á»™ phá»¥c há»“i cÅ©ng cháº­m hÆ¡n.</li>
<li><strong>TÃ­nh nÄƒng khÃ¡c</strong>: MyISAM há»— trá»£ báº£ng nÃ©n vÃ  chá»‰ má»¥c dá»¯ liá»‡u khÃ´ng gian.</li>
</ul>
<h2>Giá»›i thiá»‡u vá» InnoDB</h2>
<p>InnoDB lÃ  storage engine máº·c Ä‘á»‹nh tá»« phiÃªn báº£n MySQL 5.5 trá»Ÿ Ä‘i. Chá»‰ nÃªn sá»­ dá»¥ng storage engine khÃ¡c khi cáº§n cÃ¡c tÃ­nh nÄƒng mÃ  InnoDB khÃ´ng há»— trá»£.</p>
<p>InnoDB cÅ©ng sá»­ dá»¥ng cÃ¢y B+ (B+Tree) lÃ m cáº¥u trÃºc chá»‰ má»¥c, nhÆ°ng cÃ¡ch thá»±c hiá»‡n cá»¥ thá»ƒ ráº¥t khÃ¡c so vá»›i MyISAM. Trong MyISAM, tá»‡p chá»‰ má»¥c vÃ  tá»‡p dá»¯ liá»‡u lÃ  tÃ¡ch biá»‡t, tá»‡p chá»‰ má»¥c chá»‰ lÆ°u trá»¯ Ä‘á»‹a chá»‰ cá»§a báº£n ghi dá»¯ liá»‡u. Trong <strong>InnoDB, tá»‡p dá»¯ liá»‡u cá»§a báº£ng chÃ­nh lÃ  má»™t cáº¥u trÃºc chá»‰ má»¥c B+Tree</strong>. CÃ¡c nÃºt lÃ¡ (leaf node) cá»§a cÃ¢y nÃ y chá»©a toÃ n bá»™ báº£n ghi dá»¯ liá»‡u. <strong>Chá»‰ má»¥c nÃ y sá»­ dá»¥ng khÃ³a chÃ­nh cá»§a báº£ng lÃ m khÃ³a</strong>, do Ä‘Ã³, <strong>tá»‡p dá»¯ liá»‡u cá»§a báº£ng InnoDB chÃ­nh lÃ  chá»‰ má»¥c chÃ­nh</strong>.</p>
<p>InnoDB sá»­ dá»¥ng MVCC (Multi-Version Concurrency Control) Ä‘á»ƒ há»— trá»£ kháº£ nÄƒng xá»­ lÃ½ Ä‘á»“ng thá»i cao, vÃ  thá»±c hiá»‡n bá»‘n má»©c Ä‘á»™ cÃ´ láº­p tiÃªu chuáº©n. Má»©c Ä‘á»™ máº·c Ä‘á»‹nh lÃ  Ä‘á»c láº·p láº¡i (REPEATABLE READ) vÃ  sá»­ dá»¥ng khÃ³a khoáº£ng (next-key locking) Ä‘á»ƒ ngÄƒn cháº·n hiá»‡n tÆ°á»£ng Ä‘á»c áº£o.</p>
<p>InnoDB Ä‘Æ°á»£c xÃ¢y dá»±ng dá»±a trÃªn chá»‰ má»¥c nhÃ³m (clustered index), khÃ¡c biá»‡t lá»›n so vá»›i cÃ¡c storage engine khÃ¡c. Dá»¯ liá»‡u Ä‘Æ°á»£c lÆ°u trong chá»‰ má»¥c, giÃºp trÃ¡nh viá»‡c Ä‘á»c tá»« Ä‘Ä©a trá»±c tiáº¿p, do Ä‘Ã³ cáº£i thiá»‡n hiá»‡u suáº¥t truy váº¥n.</p>
<p>InnoDB Ä‘Ã£ thá»±c hiá»‡n nhiá»u tá»‘i Æ°u ná»™i bá»™, bao gá»“m Ä‘á»c dá»¯ liá»‡u tá»« Ä‘Ä©a theo dá»± Ä‘oÃ¡n, chá»‰ má»¥c bÄƒm thÃ­ch á»©ng tá»± Ä‘á»™ng táº¡o Ä‘á»ƒ tÄƒng tá»‘c Ä‘á»™ Ä‘á»c, vÃ  vÃ¹ng Ä‘á»‡m chÃ¨n giÃºp tÄƒng tá»‘c Ä‘á»™ chÃ¨n dá»¯ liá»‡u.</p>
<p>InnoDB há»— trá»£ sao lÆ°u nÃ³ng trá»±c tuyáº¿n thá»±c sá»±. CÃ¡c storage engine khÃ¡c khÃ´ng há»— trá»£ sao lÆ°u nÃ³ng trá»±c tuyáº¿n; Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c cháº¿ Ä‘á»™ xem nháº¥t quÃ¡n, cáº§n pháº£i dá»«ng táº¥t cáº£ cÃ¡c thao tÃ¡c ghi vÃ o báº£ng, vÃ  trong mÃ´i trÆ°á»ng Ä‘á»c ghi há»—n há»£p, viá»‡c dá»«ng ghi cÅ©ng cÃ³ thá»ƒ Ä‘á»“ng nghÄ©a vá»›i viá»‡c dá»«ng Ä‘á»c.</p>
<h3>Cáº¥u trÃºc tá»‡p váº­t lÃ½ cá»§a InnoDB:</h3>
<ul>
<li><strong>Tá»‡p <code>.frm</code></strong>: Chá»©a thÃ´ng tin siÃªu dá»¯ liá»‡u liÃªn quan Ä‘áº¿n báº£ng, bao gá»“m thÃ´ng tin Ä‘á»‹nh nghÄ©a cáº¥u trÃºc báº£ng.</li>
<li><strong>Tá»‡p <code>.ibd</code> hoáº·c <code>.ibdata</code></strong>: Chá»©a dá»¯ liá»‡u cá»§a InnoDB. CÃ³ hai cÃ¡ch lÆ°u trá»¯ dá»¯ liá»‡u InnoDB cÃ³ thá»ƒ Ä‘Æ°á»£c cáº¥u hÃ¬nh:
<ul>
<li><strong>KhÃ´ng gian báº£ng riÃªng láº» (file-per-table)</strong>: Sá»­ dá»¥ng tá»‡p <code>.ibd</code>, má»—i báº£ng cÃ³ má»™t tá»‡p <code>.ibd</code>.</li>
<li><strong>KhÃ´ng gian báº£ng chia sáº» (shared-tablespace)</strong>: Sá»­ dá»¥ng tá»‡p <code>.ibdata</code>, táº¥t cáº£ cÃ¡c báº£ng dÃ¹ng chung má»™t tá»‡p <code>.ibdata</code> (hoáº·c nhiá»u tá»‡p, cÃ³ thá»ƒ cáº¥u hÃ¬nh).</li>
</ul>
</li>
</ul>
<h2>Kiáº¿n trÃºc lÆ°u trá»¯ InnoDB</h2>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/202406241406713.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<p>Kiáº¿n trÃºc lÆ°u trá»¯ cá»§a InnoDB Ä‘Æ°á»£c chia thÃ nh cáº¥u trÃºc bá»™ nhá»› vÃ  cáº¥u trÃºc Ä‘Ä©a.</p>
<h3>Cáº¥u trÃºc bá»™ nhá»› cá»§a InnoDB:</h3>
<ul>
<li><strong>Buffer Pool</strong>: VÃ¹ng Ä‘á»‡m chÃ­nh lÆ°u trá»¯ dá»¯ liá»‡u vÃ  chá»‰ má»¥c Ä‘Æ°á»£c Ä‘á»c tá»« Ä‘Ä©a.</li>
<li><strong>Change Buffer</strong>: VÃ¹ng Ä‘á»‡m thay Ä‘á»•i lÆ°u trá»¯ cÃ¡c thay Ä‘á»•i Ä‘á»‘i vá»›i chá»‰ má»¥c khÃ´ng duy nháº¥t.</li>
<li><strong>Adaptive Hash Index</strong>: Chá»‰ má»¥c bÄƒm thÃ­ch á»©ng tá»± Ä‘á»™ng táº¡o Ä‘á»ƒ tÄƒng tá»‘c Ä‘á»™ truy váº¥n.</li>
<li><strong>Log Buffer</strong>: VÃ¹ng Ä‘á»‡m ghi láº¡i cÃ¡c thay Ä‘á»•i trÆ°á»›c khi Ä‘Æ°á»£c ghi vÃ o tá»‡p nháº­t kÃ½.</li>
</ul>
<h3>Cáº¥u trÃºc Ä‘Ä©a cá»§a InnoDB:</h3>
<ul>
<li><strong>Tablespace</strong>: KhÃ´ng gian lÆ°u trá»¯ cÃ¡c tá»‡p dá»¯ liá»‡u vÃ  chá»‰ má»¥c.</li>
<li><strong>Doublewrite Buffer</strong>: VÃ¹ng Ä‘á»‡m ghi Ä‘Ã´i Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh toÃ n váº¹n dá»¯ liá»‡u.</li>
<li><strong>Redo log</strong>: Nháº­t kÃ½ ghi láº¡i cÃ¡c thay Ä‘á»•i Ä‘á»ƒ phá»¥c há»“i sau sá»± cá»‘.</li>
<li><strong>Undo log</strong>: Nháº­t kÃ½ hoÃ n tÃ¡c giÃºp há»— trá»£ giao dá»‹ch vÃ  khÃ´i phá»¥c tráº¡ng thÃ¡i trÆ°á»›c Ä‘Ã³ cá»§a dá»¯ liá»‡u.</li>
</ul>
<p>InnoDB mang láº¡i nhiá»u lá»£i Ã­ch vá» hiá»‡u suáº¥t vÃ  Ä‘á»™ tin cáº­y nhá» cÃ¡c tÃ­nh nÄƒng vÃ  cáº¥u trÃºc lÆ°u trá»¯ tiÃªn tiáº¿n.</p>
<h2>KhÃ´ng gian báº£ng InnoDB</h2>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/202406241406812.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<h3>DÃ²ng (Row)</h3>
<p>CÃ¡c báº£n ghi trong báº£ng cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘Æ°á»£c lÆ°u trá»¯ theo dÃ²ng (row), má»—i dÃ²ng báº£n ghi cÃ³ cáº¥u trÃºc lÆ°u trá»¯ khÃ¡c nhau tÃ¹y thuá»™c vÃ o Ä‘á»‹nh dáº¡ng dÃ²ng. Sau nÃ y chÃºng ta sáº½ giá»›i thiá»‡u chi tiáº¿t vá» Ä‘á»‹nh dáº¡ng dÃ²ng cá»§a InnoDB, Ä‘Ã¢y cÅ©ng lÃ  ná»™i dung chÃ­nh cá»§a bÃ i viáº¿t nÃ y.</p>
<h3>Trang (Page)</h3>
<p>Báº£n ghi Ä‘Æ°á»£c lÆ°u trá»¯ theo dÃ²ng, nhÆ°ng viá»‡c Ä‘á»c cÆ¡ sá»Ÿ dá»¯ liá»‡u khÃ´ng pháº£i theo "dÃ²ng", vÃ¬ náº¿u váº­y má»—i láº§n Ä‘á»c (má»™t láº§n thao tÃ¡c I/O) chá»‰ xá»­ lÃ½ má»™t dÃ²ng dá»¯ liá»‡u, hiá»‡u quáº£ sáº½ ráº¥t tháº¥p. Do Ä‘Ã³, <strong>dá»¯ liá»‡u cá»§a InnoDB Ä‘Æ°á»£c Ä‘á»c vÃ  ghi theo Ä‘Æ¡n vá»‹ "trang"</strong>. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  khi cáº§n Ä‘á»c má»™t báº£n ghi, khÃ´ng pháº£i Ä‘á»c chá»‰ má»™t dÃ²ng tá»« Ä‘Ä©a, mÃ  lÃ  Ä‘á»c cáº£ má»™t trang vÃ o bá»™ nhá»›.</p>
<p><strong>Máº·c Ä‘á»‹nh má»—i trang cÃ³ kÃ­ch thÆ°á»›c 16KB</strong>, cÃ³ nghÄ©a lÃ  Ä‘áº£m báº£o khÃ´ng gian lÆ°u trá»¯ liÃªn tá»¥c tá»‘i Ä‘a 16KB. Trang lÃ  Ä‘Æ¡n vá»‹ quáº£n lÃ½ nhá» nháº¥t cá»§a Ä‘Ä©a trong storage engine InnoDB, nghÄ©a lÃ  má»—i láº§n cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘á»c ghi Ã­t nháº¥t lÃ  16KB, Ä‘á»c tá»« Ä‘Ä©a vÃ o bá»™ nhá»› Ã­t nháº¥t lÃ  16K, vÃ  ghi tá»« bá»™ nhá»› ra Ä‘Ä©a Ã­t nháº¥t lÃ  16K.</p>
<p>CÃ³ nhiá»u loáº¡i trang, phá»• biáº¿n nháº¥t lÃ  trang dá»¯ liá»‡u, trang nháº­t kÃ½ undo, trang trÃ n, v.v. CÃ¡c báº£n ghi trong báº£ng Ä‘Æ°á»£c quáº£n lÃ½ bá»Ÿi "trang dá»¯ liá»‡u", cáº¥u trÃºc cá»§a trang dá»¯ liá»‡u khÃ´ng Ä‘Æ°á»£c Ä‘á» cáº­p chi tiáº¿t á»Ÿ Ä‘Ã¢y. Báº¡n cÃ³ thá»ƒ tham kháº£o bÃ i viáº¿t nÃ y Ä‘á»ƒ biáº¿t thÃªm chi tiáº¿t: <a href="https://xiaolincoding.com/mysql/index/page.html" target="_blank" rel="noopener noreferrer">Thay Ä‘á»•i gÃ³c nhÃ¬n vá» cÃ¢y B+</a>.</p>
<p>NÃ³i chung, báº¡n chá»‰ cáº§n biáº¿t cÃ¡c báº£n ghi trong báº£ng Ä‘Æ°á»£c lÆ°u trá»¯ trong "trang dá»¯ liá»‡u".</p>
<h3>VÃ¹ng (Extent)</h3>
<p>ChÃºng ta biáº¿t ráº±ng storage engine InnoDB tá»• chá»©c dá»¯ liá»‡u báº±ng cÃ¢y B+ (B+Tree). Trong cÃ¢y B+, má»—i táº§ng Ä‘Æ°á»£c káº¿t ná»‘i báº±ng danh sÃ¡ch liÃªn káº¿t hai chiá»u. Náº¿u phÃ¢n bá»• khÃ´ng gian lÆ°u trá»¯ theo Ä‘Æ¡n vá»‹ trang, vá»‹ trÃ­ váº­t lÃ½ cá»§a hai trang liá»n ká» trong danh sÃ¡ch liÃªn káº¿t cÃ³ thá»ƒ khÃ´ng liÃªn tiáº¿p, cÃ³ thá»ƒ ráº¥t xa nhau, Ä‘iá»u nÃ y dáº«n Ä‘áº¿n nhiá»u thao tÃ¡c I/O ngáº«u nhiÃªn, ráº¥t cháº­m.</p>
<p>Giáº£i phÃ¡p ráº¥t Ä‘Æ¡n giáº£n, lÃ m cho vá»‹ trÃ­ váº­t lÃ½ cá»§a cÃ¡c trang liá»n ká» trong danh sÃ¡ch liÃªn káº¿t cÅ©ng liá»n ká», nhÆ° váº­y cÃ³ thá»ƒ sá»­ dá»¥ng I/O tuáº§n tá»±. Äiá»u nÃ y cáº£i thiá»‡n hiá»‡u suáº¥t khi thá»±c hiá»‡n cÃ¡c truy váº¥n pháº¡m vi (quÃ©t cÃ¡c nÃºt lÃ¡).</p>
<p>CÃ¡ch cá»¥ thá»ƒ Ä‘á»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y lÃ  gÃ¬?</p>
<p><strong>Khi lÆ°á»£ng dá»¯ liá»‡u trong báº£ng lá»›n, viá»‡c phÃ¢n bá»• khÃ´ng gian cho má»™t chá»‰ má»¥c khÃ´ng cÃ²n theo Ä‘Æ¡n vá»‹ trang, mÃ  theo Ä‘Æ¡n vá»‹ vÃ¹ng (extent). Má»—i vÃ¹ng cÃ³ kÃ­ch thÆ°á»›c 1MB, Ä‘á»‘i vá»›i trang 16KB, 64 trang liÃªn tiáº¿p sáº½ táº¡o thÃ nh má»™t vÃ¹ng. Äiá»u nÃ y lÃ m cho vá»‹ trÃ­ váº­t lÃ½ cá»§a cÃ¡c trang liá»n ká» trong danh sÃ¡ch liÃªn káº¿t cÅ©ng liá»n ká», vÃ  cÃ³ thá»ƒ sá»­ dá»¥ng I/O tuáº§n tá»±</strong>.</p>
<h3>Äoáº¡n (Segment)</h3>
<p>KhÃ´ng gian báº£ng Ä‘Æ°á»£c táº¡o thÃ nh tá»« cÃ¡c Ä‘oáº¡n (segment), má»—i Ä‘oáº¡n gá»“m nhiá»u vÃ¹ng (extent). CÃ¡c Ä‘oáº¡n thÆ°á»ng Ä‘Æ°á»£c chia thÃ nh Ä‘oáº¡n dá»¯ liá»‡u, Ä‘oáº¡n chá»‰ má»¥c vÃ  Ä‘oáº¡n hoÃ n tÃ¡c.</p>
<ul>
<li><strong>Äoáº¡n chá»‰ má»¥c</strong>: Chá»©a cÃ¡c vÃ¹ng cá»§a cÃ¡c nÃºt khÃ´ng pháº£i lÃ¡ cá»§a cÃ¢y B+.</li>
<li><strong>Äoáº¡n dá»¯ liá»‡u</strong>: Chá»©a cÃ¡c vÃ¹ng cá»§a cÃ¡c nÃºt lÃ¡ cá»§a cÃ¢y B+.</li>
<li><strong>Äoáº¡n hoÃ n tÃ¡c</strong>: Chá»©a cÃ¡c vÃ¹ng cá»§a dá»¯ liá»‡u hoÃ n tÃ¡c.</li>
</ul>
<p>Váº­y lÃ  chÃºng ta Ä‘Ã£ hoÃ n thÃ nh viá»‡c mÃ´ táº£ cáº¥u trÃºc cá»§a khÃ´ng gian báº£ng. Tiáº¿p theo, chÃºng ta sáº½ nÃ³i chi tiáº¿t vá» Ä‘á»‹nh dáº¡ng dÃ²ng cá»§a InnoDB.</p>
<p>Viá»‡c giá»›i thiá»‡u vÃ²ng quanh nÃ y nháº±m giÃºp báº¡n hiá»ƒu dÃ²ng báº£n ghi Ä‘Æ°á»£c lÆ°u trá»¯ á»Ÿ tá»‡p nÃ o vÃ  khu vá»±c nÃ o trong khÃ´ng gian báº£ng nÃ y, tá»« gÃ³c nhÃ¬n tá»« trÃªn xuá»‘ng. Äiá»u nÃ y giÃºp báº¡n hiá»ƒu rÃµ hÆ¡n vÃ  khÃ´ng tháº¥y mÆ¡ há»“.</p>
<h2>Cáº¥u trÃºc bá»™ nhá»› InnoDB</h2>
<h3>Bá»™ Ä‘á»‡m (Buffer Pool)</h3>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/202406241416178.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<p>Bá»™ Ä‘á»‡m dÃ¹ng Ä‘á»ƒ tÄƒng tá»‘c Ä‘á»™ truy cáº­p vÃ  chá»‰nh sá»­a dá»¯ liá»‡u báº±ng cÃ¡ch lÆ°u trá»¯ dá»¯ liá»‡u nÃ³ng trong bá»™ nhá»›, giáº£m thiá»ƒu tá»‘i Ä‘a I/O tá»« Ä‘Ä©a vÃ  tÄƒng tá»‘c Ä‘á»™ Ä‘á»c vÃ  ghi dá»¯ liá»‡u nÃ³ng.</p>
<p>Dá»¯ liá»‡u trong Buffer Pool Ä‘Æ°á»£c lÆ°u trá»¯ theo Ä‘Æ¡n vá»‹ trang vÃ  Ä‘Æ°á»£c quáº£n lÃ½ báº±ng cáº¥u trÃºc danh sÃ¡ch liÃªn káº¿t Ä‘Æ¡n theo Ä‘Æ¡n vá»‹ trang. Do giá»›i háº¡n cá»§a bá»™ nhá»›, Buffer Pool chá»‰ cÃ³ thá»ƒ chá»©a Ä‘Æ°á»£c dá»¯ liá»‡u nÃ³ng nháº¥t. Buffer Pool sá»­ dá»¥ng thuáº­t toÃ¡n LRU (Least Recently Used) Ä‘á»ƒ loáº¡i bá» dá»¯ liá»‡u khÃ´ng nÃ³ng.</p>
<p>Dá»±a trÃªn nguyÃªn lÃ½ cá»¥c bá»™ thá»i gian vÃ  khÃ´ng gian, Buffer Pool lÆ°u trá»¯ cÃ¡c trang dá»¯ liá»‡u hoáº¡t Ä‘á»™ng hiá»‡n táº¡i báº±ng cÃ¡ch sá»­ dá»¥ng cÆ¡ cháº¿ Ä‘á»c trÆ°á»›c (Read-ahead) Ä‘á»ƒ lÆ°u trá»¯ cÃ¡c trang dá»¯ liá»‡u gáº§n dá»¯ liá»‡u má»¥c tiÃªu.</p>
<p>CÆ¡ cháº¿ Ä‘á»c trÆ°á»›c dáº«n Ä‘áº¿n váº¥n Ä‘á» Ä‘á»c trÆ°á»›c tháº¥t báº¡i. InnoDB sá»­ dá»¥ng cÆ¡ cháº¿ phÃ¢n chia tháº¿ há»‡ Ä‘á»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y: chia Buffer Pool thÃ nh hai pháº§n lÃ  New SubList vÃ  Old SubList, Ä‘áº·t cÃ¡c trang dá»¯ liá»‡u má»›i Ä‘á»c vÃ o Ä‘áº§u Old SubList, cÃ¡c trang dá»¯ liá»‡u trong Old SubList Ä‘Æ°á»£c truy cáº­p láº¡i sáº½ Ä‘Æ°á»£c Ä‘áº·t vÃ o Ä‘áº§u New SubList; cÃ¡c trang dá»¯ liá»‡u láº¡nh tháº¥t báº¡i trong viá»‡c Ä‘á»c trÆ°á»›c sáº½ nhanh chÃ³ng bá»‹ loáº¡i bá» khá»i Old SubList mÃ  khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n dá»¯ liá»‡u nÃ³ng trong New SubList.</p>
<p>InnoDB sá»­ dá»¥ng cÆ¡ cháº¿ cá»­a sá»• thá»i gian (Time Window) Ä‘á»ƒ giáº£i quyáº¿t váº¥n Ä‘á» Ã´ nhiá»…m bá»™ Ä‘á»‡m: Ä‘á»‘i vá»›i cÃ¡c trang dá»¯ liá»‡u trong Old SubList, chÃºng pháº£i á»Ÿ láº¡i Old SubList trong má»™t khoáº£ng thá»i gian nháº¥t Ä‘á»‹nh rá»“i má»›i Ä‘Æ°á»£c chuyá»ƒn vÃ o New SubList náº¿u Ä‘Æ°á»£c truy cáº­p láº¡i. Cá»­a sá»• máº·c Ä‘á»‹nh lÃ  1 giÃ¢y.</p>
<p>Äá»‘i vá»›i truy váº¥n dá»¯ liá»‡u trong Buffer Pool, InnoDB sáº½ Ä‘á»c vÃ  tráº£ vá» trá»±c tiáº¿p; Ä‘á»‘i vá»›i sá»­a Ä‘á»•i dá»¯ liá»‡u trong Buffer Pool, InnoDB sáº½ sá»­a trá»±c tiáº¿p trong Buffer Pool vÃ  ghi sá»­a Ä‘á»•i vÃ o redo Log. Khi trang dá»¯ liá»‡u bá»‹ thuáº­t toÃ¡n LRU loáº¡i bá», nÃ³ sáº½ Ä‘Æ°á»£c ghi vÃ o Ä‘Ä©a, náº¿u há»‡ thá»‘ng gáº·p sá»± cá»‘ trÆ°á»›c khi Ä‘Æ°á»£c ghi vÃ o Ä‘Ä©a, sáº½ sá»­ dá»¥ng redo Log Ä‘á»ƒ khÃ´i phá»¥c khi khá»Ÿi Ä‘á»™ng láº¡i.</p>
<h3>Bá»™ Ä‘á»‡m thay Ä‘á»•i (Change Buffer)</h3>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/202406241416527.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<p>Change Buffer dÃ¹ng Ä‘á»ƒ tÄƒng tá»‘c Ä‘á»™ ghi vÃ o chá»‰ má»¥c thá»© cáº¥p cá»§a dá»¯ liá»‡u khÃ´ng nÃ³ng. Do tÃ­nh khÃ´ng liÃªn tá»¥c cá»§a dá»¯ liá»‡u chá»‰ má»¥c thá»© cáº¥p, viá»‡c sá»­a Ä‘á»•i chá»‰ má»¥c thá»© cáº¥p yÃªu cáº§u I/O Ä‘Ä©a thÆ°á»ng xuyÃªn, tiÃªu tá»‘n nhiá»u hiá»‡u nÄƒng. Change Buffer lÆ°u trá»¯ cÃ¡c thao tÃ¡c sá»­a Ä‘á»•i chá»‰ má»¥c thá»© cáº¥p vÃ  ghi vÃ o redo log. Khi Change Buffer Ä‘áº¡t Ä‘áº¿n má»™t lÆ°á»£ng nháº¥t Ä‘á»‹nh hoáº·c há»‡ thá»‘ng Ã­t báº­n rá»™n, nÃ³ sáº½ thá»±c hiá»‡n thao tÃ¡c <code>ibuf merge</code> Ä‘á»ƒ ghi sá»­a Ä‘á»•i vÃ o Ä‘Ä©a. Change Buffer cÃ³ vÃ¹ng lÆ°u trá»¯ bá»n bá»‰ trong khÃ´ng gian báº£ng há»‡ thá»‘ng.</p>
<p>KÃ­ch thÆ°á»›c Change Buffer máº·c Ä‘á»‹nh chiáº¿m 25% Buffer Pool, Ä‘Æ°á»£c khá»Ÿi táº¡o khi khá»Ÿi Ä‘á»™ng mÃ¡y chá»§. Cáº¥u trÃºc váº­t lÃ½ cá»§a nÃ³ lÃ  má»™t cÃ¢y B-Tree gá»i lÃ  <code>ibuf</code>. Äiá»u kiá»‡n sá»­ dá»¥ng Change Buffer lÃ :</p>
<ul>
<li>InnoDB báº­t <code>innodb_change_buffering</code> vÃ  báº£ng hiá»‡n táº¡i khÃ´ng cÃ³ thao tÃ¡c <code>flush</code>.</li>
<li>Chá»‰ sá»­a Ä‘á»•i cÃ¡c nÃºt lÃ¡ cá»§a cÃ¢y chá»‰ má»¥c thá»© cáº¥p vÃ  trang chá»‰ má»¥c khÃ´ng náº±m trong Buffer Pool.</li>
<li>Äá»‘i vá»›i chá»‰ má»¥c thá»© cáº¥p duy nháº¥t, chá»‰ cÃ³ thao tÃ¡c xÃ³a cÃ³ thá»ƒ Ä‘Æ°á»£c lÆ°u vÃ o bá»™ Ä‘á»‡m.</li>
</ul>
<p>Thá»i Ä‘iá»ƒm thá»±c hiá»‡n <code>ibuf merge</code>:</p>
<ul>
<li>Khi ngÆ°á»i dÃ¹ng sá»­ dá»¥ng chá»‰ má»¥c thá»© cáº¥p Ä‘á»ƒ truy váº¥n.</li>
<li>Khi dá»± Ä‘oÃ¡n ráº±ng khÃ´ng gian trang sáº½ khÃ´ng Ä‘á»§ khi lÆ°u trá»¯ thao tÃ¡c chÃ¨n, cÃ³ thá»ƒ dáº«n Ä‘áº¿n phÃ¢n chia trang chá»‰ má»¥c.</li>
<li>Khi thao tÃ¡c lÆ°u trá»¯ láº§n nÃ y dáº«n Ä‘áº¿n phÃ¢n chia trang cÃ¢y ibuf vÃ  kÃ­ch thÆ°á»›c Change Buffer vÆ°á»£t quÃ¡ giá»›i háº¡n sau khi phÃ¢n loáº¡i.</li>
<li>Khi luá»“ng master thá»±c hiá»‡n lá»‡nh <code>merge</code>.</li>
<li>Khi ngÆ°á»i dÃ¹ng thá»±c hiá»‡n thao tÃ¡c <code>flush</code> trÃªn báº£ng.</li>
</ul>
<h3>Chá»‰ má»¥c bÄƒm thÃ­ch nghi (Adaptive Hash Index)</h3>
<p>Chá»‰ má»¥c bÄƒm thÃ­ch nghi (Adaptive Hash Index, AHI) dÃ¹ng Ä‘á»ƒ tÄƒng tá»‘c Ä‘á»™ truy váº¥n cho cÃ¡c trang dá»¯ liá»‡u nÃ³ng. Khi sá»­ dá»¥ng chá»‰ má»¥c cá»¥m (clustered index) Ä‘á»ƒ Ä‘á»‹nh vá»‹ trang dá»¯ liá»‡u, cáº§n Ä‘i tá»« nÃºt gá»‘c Ä‘áº¿n nÃºt lÃ¡ cá»§a cÃ¢y chá»‰ má»¥c, thÆ°á»ng máº¥t 3-4 láº§n truy váº¥n. InnoDB phÃ¢n tÃ­ch viá»‡c sá»­ dá»¥ng chá»‰ má»¥c vÃ  cÃ¡c trÆ°á»ng chá»‰ má»¥c Ä‘á»ƒ táº¡o hoáº·c xÃ³a chá»‰ má»¥c bÄƒm má»™t cÃ¡ch tá»± Ä‘á»™ng.</p>
<p>AHI Ã¡p dá»¥ng cho cÃ¡c trang dá»¯ liá»‡u vÃ  chá»‰ má»¥c Ä‘Æ°á»£c truy váº¥n thÆ°á»ng xuyÃªn. VÃ¬ trang dá»¯ liá»‡u lÃ  má»™t pháº§n cá»§a chá»‰ má»¥c cá»¥m, AHI Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn chá»‰ má»¥c. <strong>Äá»‘i vá»›i chá»‰ má»¥c thá»© cáº¥p, náº¿u trÃºng AHI, sáº½ láº¥y trá»±c tiáº¿p con trá» báº£n ghi tá»« chá»‰ má»¥c thá»© cáº¥p trong AHI vÃ  sau Ä‘Ã³ theo khÃ³a chÃ­nh tÃ¬m dá»¯ liá»‡u dá»c theo chá»‰ má»¥c cá»¥m; náº¿u truy váº¥n chá»‰ má»¥c cá»¥m cÅ©ng trÃºng AHI, sáº½ tráº£ vá» trá»±c tiáº¿p con trá» báº£n ghi cá»§a trang dá»¯ liá»‡u má»¥c tiÃªu, tá»« Ä‘Ã³ cÃ³ thá»ƒ Ä‘á»‹nh vá»‹ trang dá»¯ liá»‡u trá»±c tiáº¿p theo con trá» báº£n ghi</strong>.</p>
<p>KÃ­ch thÆ°á»›c AHI lÃ  1/64 cá»§a Buffer Pool. Tá»« MySQL 5.7 trá»Ÿ Ä‘i, AHI há»— trá»£ phÃ¢n vÃ¹ng Ä‘á»ƒ giáº£m cáº¡nh tranh trÃªn khÃ³a AHI toÃ n cá»¥c, máº·c Ä‘á»‹nh lÃ  8 phÃ¢n vÃ¹ng.</p>
<h3>Bá»™ Ä‘á»‡m nháº­t kÃ½ (Log Buffer)</h3>
<p>Bá»™ Ä‘á»‡m nháº­t kÃ½ (Log Buffer) Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ lÆ°u trá»¯ táº¡m thá»i cÃ¡c dá»¯ liá»‡u nháº­t kÃ½ cáº§n ghi vÃ o Ä‘Ä©a. Táº¥t cáº£ cÃ¡c thao tÃ¡c sá»­a Ä‘á»•i cá»§a InnoDB sáº½ Ä‘Æ°á»£c ghi vÃ o cÃ¡c tá»‡p nháº­t kÃ½ nhÆ° redo log, undo log. Náº¿u má»—i láº§n sá»­a Ä‘á»•i Ä‘á»u Ä‘Æ°á»£c ghi trá»±c tiáº¿p vÃ o Ä‘Ä©a, sáº½ gÃ¢y ra ráº¥t nhiá»u I/O. Log Buffer tá»‘i Æ°u váº¥n Ä‘á» nÃ y báº±ng cÃ¡ch lÆ°u trá»¯ cÃ¡c thao tÃ¡c sá»­a Ä‘á»•i trong vÃ¹ng nhá»› nÃ y trÆ°á»›c, sau Ä‘Ã³ Ä‘á»‹nh ká»³ ghi hÃ ng loáº¡t vÃ o Ä‘Ä©a.</p>
<p>KÃ­ch thÆ°á»›c cá»§a bá»™ Ä‘á»‡m nháº­t kÃ½ cÃ³ thá»ƒ Ä‘Æ°á»£c Ä‘iá»u chá»‰nh báº±ng cáº¥u hÃ¬nh <code>innodb_log_buffer_size</code>, máº·c Ä‘á»‹nh lÃ  16MB.</p>
<h2>MyISAM</h2>
<p>MyISAM lÃ  há»‡ thá»‘ng lÆ°u trá»¯ máº·c Ä‘á»‹nh cá»§a MySQL trÆ°á»›c phiÃªn báº£n 5.5.</p>
<p>MyISAM Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘Æ¡n giáº£n vá»›i dá»¯ liá»‡u Ä‘Æ°á»£c lÆ°u trá»¯ theo Ä‘á»‹nh dáº¡ng nÃ©n. MyISAM thÃ­ch há»£p cho dá»¯ liá»‡u chá»‰ Ä‘á»c, hoáº·c báº£ng nhá» cÃ³ thá»ƒ cháº¥p nháº­n cÃ¡c thao tÃ¡c sá»­a chá»¯a.</p>
<p>MyISAM sá»­ dá»¥ng cáº¥u trÃºc B+Tree cho chá»‰ má»¥c, trong Ä‘Ã³ <strong>nÃºt lÃ¡ cá»§a trÆ°á»ng dá»¯ liá»‡u lÆ°u trá»¯ Ä‘á»‹a chá»‰ cá»§a cÃ¡c báº£n ghi dá»¯ liá»‡u</strong>.</p>
<p>MyISAM cung cáº¥p nhiá»u tÃ­nh nÄƒng nhÆ°: chá»‰ má»¥c toÃ n vÄƒn, báº£ng nÃ©n, vÃ  cÃ¡c hÃ m khÃ´ng gian. Tuy nhiÃªn, MyISAM khÃ´ng há»— trá»£ giao dá»‹ch vÃ  khÃ³a cáº¥p hÃ ng. MyISAM cÅ©ng khÃ´ng há»— trá»£ khÃ´i phá»¥c an toÃ n sau khi há»‡ thá»‘ng gáº·p sá»± cá»‘.</p>
<p>Cáº¥u trÃºc tá»‡p váº­t lÃ½ cá»§a MyISAM:</p>
<ul>
<li>Tá»‡p <code>.frm</code>: lÆ°u trá»¯ thÃ´ng tin siÃªu dá»¯ liá»‡u liÃªn quan Ä‘áº¿n báº£ng, bao gá»“m Ä‘á»‹nh nghÄ©a cáº¥u trÃºc báº£ng.</li>
<li>Tá»‡p <code>.MYD</code> (<code>MYData</code>): dÃ nh riÃªng cho MyISAM Ä‘á»ƒ lÆ°u trá»¯ dá»¯ liá»‡u cá»§a báº£ng MyISAM.</li>
<li>Tá»‡p <code>.MYI</code> (<code>MYIndex</code>): dÃ nh riÃªng cho MyISAM Ä‘á»ƒ lÆ°u trá»¯ thÃ´ng tin liÃªn quan Ä‘áº¿n chá»‰ má»¥c cá»§a báº£ng MyISAM.</li>
</ul>
<h2>So sÃ¡nh InnoDB vÃ  MyISAM</h2>
<p>Báº£ng so sÃ¡nh giá»¯a InnoDB vÃ  MyISAM:</p>
<p>| Äá»‘i chiáº¿u    | MyISAM                                        | InnoDB                           |<br>
|</p>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/202406241406713.png" type="image/png"/>
    </item>
    <item>
      <title>MySQL Guide</title>
      <link>https://vanhung4499.github.io/database/mysql/guide.html</link>
      <guid>https://vanhung4499.github.io/database/mysql/guide.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">MySQL Guide</source>
      <description>MySQL Guide Kiáº¿n trÃºc MySQL Äá»ƒ hiá»ƒu MySQL, tá»‘t nháº¥t lÃ  hiá»ƒu cÃ¡ch MySQL hoáº¡t Ä‘á»™ng á»Ÿ má»©c Ä‘á»™ tá»•ng quÃ¡t. Tham kháº£o: MySQL Architecture Storage Engine MySQL há»— trá»£ nhiá»u loáº¡i storage...</description>
      <category>mysql</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>Kiáº¿n trÃºc MySQL</h2>
<p>Äá»ƒ hiá»ƒu MySQL, tá»‘t nháº¥t lÃ  hiá»ƒu cÃ¡ch MySQL hoáº¡t Ä‘á»™ng á»Ÿ má»©c Ä‘á»™ tá»•ng quÃ¡t.</p>
<p>Tham kháº£o:&nbsp;<a href="architecture">MySQL Architecture</a></p>
<h2>Storage Engine</h2>
<p>MySQL há»— trá»£ nhiá»u loáº¡i storage engine, má»—i loáº¡i cÃ³ Æ°u vÃ  nhÆ°á»£c Ä‘iá»ƒm riÃªng.</p>
<p>Tham kháº£o:&nbsp;<a href="storage-engine">MySQL Storage Engine</a></p>
<h2>Kiá»ƒu dá»¯ liá»‡u</h2>
<h3>Kiá»ƒu sá»‘ nguyÃªn</h3>
<p><code>TINYINT</code>,&nbsp;<code>SMALLINT</code>,&nbsp;<code>MEDIUMINT</code>,&nbsp;<code>INT</code>,&nbsp;<code>BIGINT</code>&nbsp;láº§n lÆ°á»£t sá»­ dá»¥ng 8, 16, 24, 32, 64 bit khÃ´ng gian lÆ°u trá»¯, trong háº§u háº¿t cÃ¡c trÆ°á»ng há»£p, cÃ ng nhá» cÃ ng tá»‘t.</p>
<p><strong><code>UNSIGNED</code>&nbsp;chá»‰ ra ráº±ng khÃ´ng cho phÃ©p giÃ¡ trá»‹ Ã¢m, cÃ³ thá»ƒ tÄƒng giá»›i háº¡n trÃªn cÃ¹ng cá»§a sá»‘ dÆ°Æ¡ng</strong>.</p>
<p>Sá»‘ trong&nbsp;<code>INT(11)</code>&nbsp;chá»‰ quy Ä‘á»‹nh sá»‘ kÃ½ tá»± hiá»ƒn thá»‹ cho cá»™t trong cÃ´ng cá»¥ tÆ°Æ¡ng tÃ¡c, khÃ´ng cÃ³ Ã½ nghÄ©a vá»›i viá»‡c lÆ°u trá»¯ vÃ  tÃ­nh toÃ¡n.</p>
<h3>Kiá»ƒu sá»‘ thá»±c</h3>
<p><code>FLOAT</code>&nbsp;vÃ &nbsp;<code>DOUBLE</code>&nbsp;lÃ  kiá»ƒu sá»‘ thá»±c.</p>
<p>Kiá»ƒu&nbsp;<code>DECIMAL</code>&nbsp;chá»§ yáº¿u Ä‘Æ°á»£c sá»­ dá»¥ng cho tÃ­nh toÃ¡n chÃ­nh xÃ¡c, tuy nhiÃªn nÃ³ tá»‘n kÃ©m vÃ  chá»‰ nÃªn sá»­ dá»¥ng&nbsp;<code>DECIMAL</code>&nbsp;khi tÃ­nh toÃ¡n sá»‘ tháº­p phÃ¢n chÃ­nh xÃ¡c - vÃ­ dá»¥: lÆ°u trá»¯ dá»¯ liá»‡u tÃ i chÃ­nh. Khi cÃ³ sá»‘ lÆ°á»£ng dá»¯ liá»‡u lá»›n, cÃ³ thá»ƒ sá»­ dá»¥ng&nbsp;<code>BIGINT</code>&nbsp;thay tháº¿&nbsp;<code>DECIMAL</code>.</p>
<p><code>FLOAT</code>,&nbsp;<code>DOUBLE</code>&nbsp;vÃ &nbsp;<code>DECIMAL</code>&nbsp;cÃ³ thá»ƒ chá»‰ Ä‘á»‹nh chiá»u rá»™ng cá»™t, vÃ­ dá»¥&nbsp;<code>DECIMAL(18, 9)</code>&nbsp;chá»‰ ra tá»•ng cá»™ng 18 chá»¯ sá»‘, 9 chá»¯ sá»‘ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ lÆ°u trá»¯ pháº§n tháº­p phÃ¢n.</p>
<h3>Kiá»ƒu chuá»—i</h3>
<p>Chá»§ yáº¿u cÃ³ hai loáº¡i kiá»ƒu chuá»—i lÃ &nbsp;<code>CHAR</code>&nbsp;vÃ &nbsp;<code>VARCHAR</code>, má»™t loáº¡i lÃ  cá»‘ Ä‘á»‹nh, má»™t loáº¡i lÃ  biáº¿n Ä‘á»•i.</p>
<p><strong>Kiá»ƒu biáº¿n Ä‘á»•i&nbsp;<code>VARCHAR</code>&nbsp;nÃ y cÃ³ thá»ƒ tiáº¿t kiá»‡m khÃ´ng gian vÃ¬ chá»‰ cáº§n lÆ°u trá»¯ ná»™i dung cáº§n thiáº¿t. Tuy nhiÃªn, khi thá»±c hiá»‡n UPDATE, cÃ³ thá»ƒ lÃ m cho hÃ ng trá»Ÿ nÃªn dÃ i hÆ¡n so vá»›i ban Ä‘áº§u</strong>. Khi vÆ°á»£t quÃ¡ kÃ­ch thÆ°á»›c mÃ  má»™t trang cÃ³ thá»ƒ chá»©a, sáº½ cÃ³ thÃªm hoáº¡t Ä‘á»™ng. MyISAM sáº½ chia hÃ ng thÃ nh cÃ¡c Ä‘oáº¡n khÃ¡c nhau Ä‘á»ƒ lÆ°u trá»¯, trong khi InnoDB cáº§n pháº£i chia trang Ä‘á»ƒ Ä‘Æ°a hÃ ng vÃ o trang.</p>
<p><code>VARCHAR</code>&nbsp;sáº½ giá»¯ cÃ¡c khoáº£ng tráº¯ng á»Ÿ cuá»‘i chuá»—i, trong khi&nbsp;<code>CHAR</code>&nbsp;sáº½ xÃ³a chÃºng.</p>
<h3>Thá»i gian vÃ  ngÃ y thÃ¡ng</h3>
<p>MySQL cung cáº¥p hai loáº¡i ngÃ y thÃ¡ng tÆ°Æ¡ng tá»± nhau:&nbsp;<code>DATATIME</code>&nbsp;vÃ &nbsp;<code>TIMESTAMP</code>.</p>
<h4>DATATIME</h4>
<p>CÃ³ thá»ƒ lÆ°u trá»¯ ngÃ y thÃ¡ng vÃ  thá»i gian tá»« nÄƒm 1001 Ä‘áº¿n nÄƒm 9999, vá»›i Ä‘á»™ chÃ­nh xÃ¡c Ä‘áº¿n giÃ¢y, sá»­ dá»¥ng 8 byte khÃ´ng gian lÆ°u trá»¯.</p>
<p>NÃ³ khÃ´ng phá»¥ thuá»™c vÃ o mÃºi giá».</p>
<p>Máº·c Ä‘á»‹nh, MySQL hiá»ƒn thá»‹ giÃ¡ trá»‹ DATATIME dÆ°á»›i dáº¡ng cÃ³ thá»ƒ sáº¯p xáº¿p, khÃ´ng gÃ¢y hiá»ƒu láº§m, vÃ­ dá»¥: "2008-01-16 22:37:08", Ä‘Ã¢y lÃ  cÃ¡ch biá»ƒu diá»…n ngÃ y thÃ¡ng vÃ  thá»i gian Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a bá»Ÿi tiÃªu chuáº©n ANSI.</p>
<h4>TIMESTAMP</h4>
<p>TÆ°Æ¡ng tá»± nhÆ° dáº¥u thá»i gian UNIX, lÆ°u trá»¯ sá»‘ giÃ¢y ká»ƒ tá»« nÄƒm 1970, sá»­ dá»¥ng 4 byte, chá»‰ cÃ³ thá»ƒ biá»ƒu diá»…n tá»« nÄƒm 1970 Ä‘áº¿n nÄƒm 2038.</p>
<p>NÃ³ phá»¥ thuá»™c vÃ o mÃºi giá», cÃ³ nghÄ©a lÃ  má»™t dáº¥u thá»i gian cÃ³ thá»ƒ Ä‘áº¡i diá»‡n cho thá»i gian cá»¥ thá»ƒ khÃ¡c nhau trong cÃ¡c mÃºi giá» khÃ¡c nhau.</p>
<p>MySQL cung cáº¥p hÃ m FROM_UNIXTIME() Ä‘á»ƒ chuyá»ƒn Ä‘á»•i dáº¥u thá»i gian UNIX thÃ nh ngÃ y thÃ¡ng vÃ  cung cáº¥p hÃ m UNIX_TIMESTAMP() Ä‘á»ƒ chuyá»ƒn Ä‘á»•i ngÃ y thÃ¡ng thÃ nh dáº¥u thá»i gian UNIX.</p>
<p>Máº·c Ä‘á»‹nh, náº¿u khÃ´ng chá»‰ Ä‘á»‹nh giÃ¡ trá»‹ cá»™t TIMESTAMP khi chÃ¨n, giÃ¡ trá»‹ nÃ y sáº½ Ä‘Æ°á»£c Ä‘áº·t thÃ nh thá»i gian hiá»‡n táº¡i.</p>
<p>NÃªn sá»­ dá»¥ng TIMESTAMP náº¿u cÃ³ thá»ƒ, vÃ¬ nÃ³ cÃ³ hiá»‡u suáº¥t cao hÆ¡n so vá»›i DATETIME.</p>
<h3>BLOB vÃ  TEXT</h3>
<p><code>BLOB</code>&nbsp;vÃ &nbsp;<code>TEXT</code>&nbsp;Ä‘á»u Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ lÆ°u trá»¯ dá»¯ liá»‡u lá»›n, cÃ¡i trÆ°á»›c lÃ  dá»¯ liá»‡u nhá»‹ phÃ¢n, cÃ¡i sau lÃ  dá»¯ liá»‡u chuá»—i.</p>
<p>KhÃ´ng thá»ƒ sáº¯p xáº¿p hoáº·c táº¡o chá»‰ má»¥c cho toÃ n bá»™ ná»™i dung cá»§a kiá»ƒu&nbsp;<code>BLOB</code>&nbsp;vÃ &nbsp;<code>TEXT</code>.</p>
<h3>Kiá»ƒu enum</h3>
<p>Trong háº§u háº¿t cÃ¡c trÆ°á»ng há»£p, khÃ´ng cáº§n sá»­ dá»¥ng kiá»ƒu enum. Má»™t trong nhá»¯ng nhÆ°á»£c Ä‘iá»ƒm cá»§a kiá»ƒu enum lÃ  danh sÃ¡ch chuá»—i enum lÃ  cá»‘ Ä‘á»‹nh, viá»‡c thÃªm vÃ  xÃ³a chuá»—i (lá»±a chá»n enum) pháº£i sá»­ dá»¥ng&nbsp;<code>ALTER TABLE</code>&nbsp;(náº¿u chá»‰ thÃªm vÃ o cuá»‘i danh sÃ¡ch, khÃ´ng cáº§n xÃ¢y dá»±ng láº¡i báº£ng).</p>
<h3>Lá»±a chá»n kiá»ƒu dá»¯ liá»‡u</h3>
<ul>
<li>Kiá»ƒu sá»‘ nguyÃªn thÆ°á»ng lÃ  lá»±a chá»n tá»‘t nháº¥t cho cá»™t Ä‘á»‹nh danh, vÃ¬ chÃºng nhanh chÃ³ng vÃ  cÃ³ thá»ƒ sá»­ dá»¥ng&nbsp;<code>AUTO_INCREMENT</code>.</li>
<li>Kiá»ƒu&nbsp;<code>ENUM</code>&nbsp;vÃ &nbsp;<code>SET</code>&nbsp;thÆ°á»ng lÃ  lá»±a chá»n tá»“i, nÃªn trÃ¡nh sá»­ dá»¥ng chÃºng.</li>
<li>NÃªn trÃ¡nh sá»­ dá»¥ng kiá»ƒu chuá»—i lÃ m cá»™t Ä‘á»‹nh danh, vÃ¬ chÃºng chiáº¿m khÃ´ng gian vÃ  thÆ°á»ng cháº­m hÆ¡n kiá»ƒu sá»‘. Äá»‘i vá»›i cÃ¡c chuá»—i ngáº«u nhiÃªn nhÆ°&nbsp;<code>MD5</code>,&nbsp;<code>SHA</code>,&nbsp;<code>UUID</code>, do tÃ­nh ngáº«u nhiÃªn, nÃªn lÆ°u trá»¯ dÆ°á»›i dáº¡ng sá»‘ lÆ°á»£ng lá»›n, cÃ³ thá»ƒ sá»­ dá»¥ng&nbsp;<code>BIGINT</code>&nbsp;thay cho&nbsp;<code>DECIMAL</code>. Äá»ƒ lÆ°u trá»¯ UUID, nÃªn xÃ³a dáº¥u&nbsp;<code>-</code>; cÃ¡ch tá»‘t hÆ¡n lÃ  chuyá»ƒn Ä‘á»•i giÃ¡ trá»‹ UUID thÃ nh sá»‘ 16 byte báº±ng cÃ¡ch sá»­ dá»¥ng hÃ m&nbsp;<code>UNHEX()</code>&nbsp;vÃ  lÆ°u trá»¯ trong cá»™t&nbsp;<code>BINARY(16)</code>, khi truy váº¥n, cÃ³ thá»ƒ Ä‘á»‹nh dáº¡ng láº¡i thÃ nh Ä‘á»‹nh dáº¡ng hexa báº±ng cÃ¡ch sá»­ dá»¥ng hÃ m&nbsp;<code>HEX()</code>.</li>
</ul>
<h2>Chá»‰ má»¥c</h2>
<p>Chi tiáº¿t xem:&nbsp;<a href="mysql-index">MySQL Index</a></p>
<h2>KhÃ³a</h2>
<p>Chi tiáº¿t xem:&nbsp;<a href="locks">MySQL Locks</a></p>
<h2>Giao dá»‹ch</h2>
<p>Chi tiáº¿t xem:&nbsp;<a href="transactions">MySQL Transactions</a></p>
<h2>Tá»‘i Æ°u hiá»‡u suáº¥t</h2>
<p>Chi tiáº¿t xem:&nbsp;<a href="performance-optimization">MySQL Performance Optimization</a></p>
<h2>Replication</h2>
<h3>Sao chÃ©p Master-Slave</h3>
<p>MySQL há»— trá»£ hai phÆ°Æ¡ng phÃ¡p sao chÃ©p: sao chÃ©p dá»±a trÃªn hÃ ng vÃ  sao chÃ©p dá»±a trÃªn cÃ¢u lá»‡nh.</p>
<p>Cáº£ hai phÆ°Æ¡ng phÃ¡p Ä‘á»u ghi láº¡i nháº­t kÃ½ nhá»‹ phÃ¢n trÃªn mÃ¡y chá»§ chÃ­nh vÃ  sau Ä‘Ã³ cháº¡y láº¡i nháº­t kÃ½ trÃªn mÃ¡y chá»§ phá»¥ Ä‘á»ƒ thá»±c hiá»‡n sao chÃ©p dá»¯ liá»‡u khÃ´ng Ä‘á»“ng bá»™. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  quÃ¡ trÃ¬nh sao chÃ©p cÃ³ Ä‘á»™ trá»… vÃ  trong khoáº£ng thá»i gian nÃ y, dá»¯ liá»‡u trÃªn mÃ¡y chá»§ chÃ­nh vÃ  mÃ¡y chá»§ phá»¥ cÃ³ thá»ƒ khÃ´ng nháº¥t quÃ¡n.</p>
<p>Chá»§ yáº¿u liÃªn quan Ä‘áº¿n ba luá»“ng: luá»“ng nháº­t kÃ½ nhá»‹ phÃ¢n, luá»“ng I/O vÃ  luá»“ng SQL.</p>
<ul>
<li><strong>Luá»“ng nháº­t kÃ½ nhá»‹ phÃ¢n</strong>: Äáº£m nhiá»‡m viá»‡c ghi dá»¯ liá»‡u thay Ä‘á»•i tá»« mÃ¡y chá»§ chÃ­nh vÃ o tá»‡p nháº­t kÃ½ nhá»‹ phÃ¢n (binlog).</li>
<li><strong>Luá»“ng I/O</strong>: Äáº£m nhiá»‡m Ä‘á»c tá»‡p nháº­t kÃ½ nhá»‹ phÃ¢n tá»« mÃ¡y chá»§ chÃ­nh vÃ  ghi vÃ o nháº­t kÃ½ chuyá»ƒn tiáº¿p trÃªn mÃ¡y chá»§ phá»¥.</li>
<li><strong>Luá»“ng SQL</strong>: Äáº£m nhiá»‡m Ä‘á»c nháº­t kÃ½ chuyá»ƒn tiáº¿p vÃ  thá»±c thi cÃ¡c cÃ¢u lá»‡nh SQL.</li>
</ul>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230721153816.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure>
<h3>PhÃ¢n tÃ¡ch Ä‘á»c ghi</h3>
<p>MÃ¡y chá»§ chÃ­nh Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ xá»­ lÃ½ cÃ¡c hoáº¡t Ä‘á»™ng ghi vÃ  cÃ¡c hoáº¡t Ä‘á»™ng Ä‘á»c cÃ³ yÃªu cáº§u thá»i gian thá»±c cao, trong khi mÃ¡y chá»§ phá»¥ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ xá»­ lÃ½ cÃ¡c hoáº¡t Ä‘á»™ng Ä‘á»c.</p>
<p>PhÃ¢n tÃ¡ch Ä‘á»c ghi thÆ°á»ng Ä‘Æ°á»£c thá»±c hiá»‡n thÃ´ng qua proxy, trong Ä‘Ã³ mÃ¡y chá»§ proxy nháº­n cÃ¡c yÃªu cáº§u Ä‘á»c vÃ  ghi tá»« á»©ng dá»¥ng, sau Ä‘Ã³ quyáº¿t Ä‘á»‹nh chuyá»ƒn tiáº¿p yÃªu cáº§u Ä‘áº¿n mÃ¡y chá»§ nÃ o.</p>
<p>PhÃ¢n tÃ¡ch Ä‘á»c ghi trong MySQL cÃ³ thá»ƒ cáº£i thiá»‡n hiá»‡u suáº¥t vÃ¬:</p>
<ul>
<li>MÃ¡y chá»§ chÃ­nh vÃ  mÃ¡y chá»§ phá»¥ chá»‹u trÃ¡ch nhiá»‡m cho cÃ¡c hoáº¡t Ä‘á»™ng Ä‘á»c vÃ  ghi riÃªng biá»‡t, giáº£m Ä‘Ã¡ng ká»ƒ sá»± cáº¡nh tranh khÃ³a;</li>
<li>MÃ¡y chá»§ phá»¥ cÃ³ thá»ƒ Ä‘Æ°á»£c cáº¥u hÃ¬nh Ä‘á»ƒ sá»­ dá»¥ng há»‡ thá»‘ng lÆ°u trá»¯ MyISAM, cáº£i thiá»‡n hiá»‡u suáº¥t truy váº¥n vÃ  tiáº¿t kiá»‡m tÃ i nguyÃªn há»‡ thá»‘ng;</li>
<li>TÄƒng tÃ­nh dá»± phÃ²ng, cáº£i thiá»‡n kháº£ nÄƒng sáºµn cÃ³.</li>
</ul>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/master-slave-proxy.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230721153816.png" type="image/png"/>
    </item>
    <item>
      <title>Lock</title>
      <link>https://vanhung4499.github.io/database/mysql/lock.html</link>
      <guid>https://vanhung4499.github.io/database/mysql/lock.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Lock</source>
      <description>MySQL Lock KhÃ³a láº¡c quan vÃ  khÃ³a bi quan Äáº£m báº£o khÃ´ng lÃ m há»ng tÃ­nh cÃ´ láº­p, tÃ­nh thá»‘ng nháº¥t vÃ  tÃ­nh thá»‘ng nháº¥t cá»§a cÆ¡ sá»Ÿ dá»¯ liá»‡u khi nhiá»u giao dá»‹ch truy cáº­p cÃ¹ng má»™t dá»¯ liá»‡u t...</description>
      <category>mysql</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>KhÃ³a láº¡c quan vÃ  khÃ³a bi quan</h2>
<p>Äáº£m báº£o khÃ´ng lÃ m há»ng tÃ­nh cÃ´ láº­p, tÃ­nh thá»‘ng nháº¥t vÃ  tÃ­nh thá»‘ng nháº¥t cá»§a cÆ¡ sá»Ÿ dá»¯ liá»‡u khi nhiá»u giao dá»‹ch truy cáº­p cÃ¹ng má»™t dá»¯ liá»‡u trong cÃ¹ng má»™t thá»i Ä‘iá»ƒm, <strong>khÃ³a láº¡c quan vÃ  khÃ³a bi quan lÃ  cÃ¡c phÆ°Æ¡ng phÃ¡p ká»¹ thuáº­t Ä‘Æ°á»£c sá»­ dá»¥ng chÃ­nh cho kiá»ƒm soÃ¡t Ä‘á»“ng thá»i</strong>.</p>
<ul>
<li><strong><code>KhÃ³a bi quan</code></strong> - Giáº£ Ä‘á»‹nh xáº£y ra xung Ä‘á»™t Ä‘á»“ng thá»i vÃ  cháº·n má»i hoáº¡t Ä‘á»™ng cÃ³ thá»ƒ vi pháº¡m tÃ­nh toÃ n váº¹n dá»¯ liá»‡u.
<ul>
<li>KhÃ³a giao dá»‹ch ngay sau khi truy váº¥n dá»¯ liá»‡u, vÃ  chá»‰ má»Ÿ khÃ³a khi giao dá»‹ch Ä‘Æ°á»£c cam káº¿t (<code>COMMIT</code>).</li>
<li>CÃ¡ch thá»±c hiá»‡n: <strong>Sá»­ dá»¥ng cÆ¡ cháº¿ khÃ³a trong cÆ¡ sá»Ÿ dá»¯ liá»‡u</strong>.</li>
</ul>
</li>
<li><strong><code>KhÃ³a láº¡c quan</code></strong> - Giáº£ Ä‘á»‹nh khÃ´ng xáº£y ra xung Ä‘á»™t Ä‘á»“ng thá»i vÃ  chá»‰ kiá»ƒm tra vi pháº¡m tÃ­nh toÃ n váº¹n dá»¯ liá»‡u khi thá»±c hiá»‡n thao tÃ¡c gá»­i Ä‘i.
<ul>
<li>KhÃ³a giao dá»‹ch khi thay Ä‘á»•i dá»¯ liá»‡u vÃ  sá»­ dá»¥ng phiÃªn báº£n Ä‘á»ƒ khÃ³a.</li>
<li>CÃ¡ch thá»±c hiá»‡n: <strong>Sá»­ dá»¥ng phiÃªn báº£n hoáº·c dáº¥u thá»i gian</strong>.</li>
</ul>
</li>
</ul>
<p>ã€VÃ­ dá»¥ã€‘VÃ­ dá»¥ vá» khÃ³a láº¡c quan</p>
<p>Báº£ng hÃ ng hÃ³a (goods) cÃ³ má»™t trÆ°á»ng status, trong Ä‘Ã³ status = 1 cho biáº¿t hÃ ng hÃ³a chÆ°a Ä‘Æ°á»£c Ä‘áº·t hÃ ng, status = 2 cho biáº¿t hÃ ng hÃ³a Ä‘Ã£ Ä‘Æ°á»£c Ä‘áº·t hÃ ng, vÃ¬ váº­y khi Ä‘áº·t hÃ ng cho má»™t máº·t hÃ ng cáº§n Ä‘áº£m báº£o status cá»§a máº·t hÃ ng Ä‘Ã³ lÃ  1. Giáº£ sá»­ id cá»§a máº·t hÃ ng lÃ  1.</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">select</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> (</span><span style="color:#C678DD;--shiki-dark:#C678DD">status</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#C678DD;--shiki-dark:#C678DD">status</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#C678DD;--shiki-dark:#C678DD">version</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#C678DD;--shiki-dark:#C678DD">from</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> t_goods </span><span style="color:#C678DD;--shiki-dark:#C678DD">where</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> id</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">#{id}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">update</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> t_goods</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">set</span><span style="color:#C678DD;--shiki-dark:#C678DD"> status</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#C678DD;--shiki-dark:#C678DD">version</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#C678DD;--shiki-dark:#C678DD">version</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">+</span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">where</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> id</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">#{id} </span><span style="color:#C678DD;--shiki-dark:#C678DD">and</span><span style="color:#C678DD;--shiki-dark:#C678DD"> version</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">#{</span><span style="color:#C678DD;--shiki-dark:#C678DD">version</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">};</span></span></code></pre>
</div><h2>KhÃ³a báº£ng vÃ  khÃ³a hÃ ng</h2>
<p>Dá»±a trÃªn pháº¡m vi khÃ³a cá»§a cÆ¡ sá»Ÿ dá»¯ liá»‡u, MySQL cung cáº¥p hai loáº¡i khÃ³a: khÃ³a hÃ ng vÃ  khÃ³a báº£ng.</p>
<ul>
<li><strong>KhÃ³a báº£ng (table lock)</strong> - KhÃ³a toÃ n bá»™ báº£ng. TrÆ°á»›c khi ngÆ°á»i dÃ¹ng thá»±c hiá»‡n thao tÃ¡c ghi trÃªn báº£ng, cáº§n cÃ³ khÃ³a ghi, Ä‘iá»u nÃ y sáº½ cháº·n táº¥t cáº£ cÃ¡c hoáº¡t Ä‘á»™ng Ä‘á»c vÃ  ghi cá»§a ngÆ°á»i dÃ¹ng khÃ¡c trÃªn báº£ng Ä‘Ã³. Chá»‰ khi khÃ´ng cÃ³ khÃ³a ghi, ngÆ°á»i dÃ¹ng khÃ¡c má»›i cÃ³ thá»ƒ nháº­n Ä‘Æ°á»£c khÃ³a Ä‘á»c vÃ  cÃ¡c khÃ³a Ä‘á»c khÃ´ng cháº·n láº«n nhau.</li>
<li><strong>KhÃ³a hÃ ng (row lock)</strong> - KhÃ³a cÃ¡c báº£n ghi hÃ ng Ä‘á»‹nh. Äiá»u nÃ y cho phÃ©p cÃ¡c tiáº¿n trÃ¬nh khÃ¡c váº«n cÃ³ thá»ƒ thá»±c hiá»‡n cÃ¡c hoáº¡t Ä‘á»™ng trÃªn cÃ¡c báº£n ghi khÃ¡c trong cÃ¹ng má»™t báº£ng.</li>
</ul>
<p>NÃªn chá»‰ khÃ³a cÃ¡c dá»¯ liá»‡u cáº§n thay Ä‘á»•i, khÃ´ng pháº£i táº¥t cáº£ tÃ i nguyÃªn. <strong>CÃ ng khÃ³a Ã­t dá»¯ liá»‡u, táº§n suáº¥t cáº¡nh tranh khÃ³a cÃ ng Ã­t, Ä‘á»™ Ä‘á»“ng thá»i cá»§a há»‡ thá»‘ng cÃ ng cao</strong>. Tuy nhiÃªn, viá»‡c khÃ³a cáº§n tiÃªu tá»‘n tÃ i nguyÃªn vÃ  cÃ¡c hoáº¡t Ä‘á»™ng liÃªn quan Ä‘áº¿n khÃ³a (bao gá»“m láº¥y khÃ³a, giáº£i phÃ³ng khÃ³a vÃ  kiá»ƒm tra tráº¡ng thÃ¡i khÃ³a) Ä‘á»u lÃ m tÄƒng chi phÃ­ cá»§a há»‡ thá»‘ng. Do Ä‘Ã³, <strong>Ä‘á»™ Ä‘á»“ng thá»i cá»§a khÃ³a cÃ ng nhá», chi phÃ­ cá»§a há»‡ thá»‘ng cÃ ng lá»›n</strong>.</p>
<p>Khi chá»n má»©c Ä‘á»™ chi tiáº¿t cá»§a khÃ³a, cáº§n pháº£i cÃ¢n báº±ng giá»¯a chi phÃ­ khÃ³a vÃ  Ä‘á»™ Ä‘á»“ng thá»i cá»§a há»‡ thá»‘ng.</p>
<p>Trong <code>InnoDB</code>, <strong>khÃ³a hÃ ng Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng cÃ¡ch khÃ³a cÃ¡c má»¥c nháº­p chá»‰ má»¥c (index entry) trÃªn chá»‰ má»¥c (index)</strong>. <strong>Náº¿u khÃ´ng cÃ³ chá»‰ má»¥c, <code>InnoDB</code> sáº½ khÃ³a báº£n ghi thÃ´ng qua chá»‰ má»¥c cá»¥m áº©n</strong>.</p>
<h2>KhÃ³a Ä‘á»c vÃ  khÃ³a ghi</h2>
<ul>
<li>KhÃ³a Ä‘á»™c quyá»n (Exclusive), viáº¿t táº¯t lÃ  khÃ³a X, cÃ²n Ä‘Æ°á»£c gá»i lÃ  khÃ³a ghi. CÃ¡ch sá»­ dá»¥ng: <code>SELECT â€¦ FOR UPDATE;</code></li>
<li>KhÃ³a chia sáº» (Shared), viáº¿t táº¯t lÃ  khÃ³a S, cÃ²n Ä‘Æ°á»£c gá»i lÃ  khÃ³a Ä‘á»c. CÃ¡ch sá»­ dá»¥ng: <code>SELECT â€¦ LOCK IN SHARE MODE;</code></li>
</ul>
<p>Má»‘i quan há»‡ giá»¯a khÃ³a ghi vÃ  khÃ³a Ä‘á»c, nÃ³i má»™t cÃ¡ch Ä‘Æ¡n giáº£n: <strong>Khi cÃ³ khÃ³a Ä‘á»™c quyá»n tá»“n táº¡i, cÃ¡c giao dá»‹ch khÃ¡c khÃ´ng thá»ƒ thá»±c hiá»‡n báº¥t ká»³ hoáº¡t Ä‘á»™ng nÃ o</strong>.</p>
<p><strong>KhÃ³a hÃ ng, khÃ³a khoáº£ng (gap lock) vÃ  khÃ³a next-key trong <code>InnoDB</code> Ä‘á»u thuá»™c loáº¡i khÃ³a Ä‘á»™c quyá»n</strong>.</p>
<h2>KhÃ³a Ã½ Ä‘á»‹nh</h2>
<p><strong>Khi cÃ³ khÃ³a báº£ng vÃ  khÃ³a hÃ ng cÃ¹ng tá»“n táº¡i, trÆ°á»›c tiÃªn pháº£i yÃªu cáº§u khÃ³a Ã½ Ä‘á»‹nh (khÃ³a báº£ng, nhÆ°ng khÃ´ng pháº£i khÃ³a thá»±c sá»±), sau Ä‘Ã³ má»›i nháº­n Ä‘Æ°á»£c khÃ³a hÃ ng</strong>. Sá»­ dá»¥ng khÃ³a Ã½ Ä‘á»‹nh (Intention Lock) cÃ³ thá»ƒ dá»… dÃ ng há»— trá»£ nhiá»u má»©c khÃ³a.</p>
<p><strong>KhÃ³a Ã½ Ä‘á»‹nh Ä‘Æ°á»£c <code>InnoDB</code> tá»± Ä‘á»™ng thÃªm vÃ o, khÃ´ng cáº§n can thiá»‡p cá»§a ngÆ°á»i dÃ¹ng</strong>.</p>
<p>Khi cÃ³ khÃ³a hÃ ng vÃ  khÃ³a báº£ng, giao dá»‹ch T muá»‘n khÃ³a báº£ng A báº±ng khÃ³a X, chá»‰ cáº§n kiá»ƒm tra xem cÃ³ giao dá»‹ch khÃ¡c Ä‘Ã£ khÃ³a báº£ng A hoáº·c má»™t hÃ ng nÃ o Ä‘Ã³ trong báº£ng A báº±ng khÃ³a X/IX/S/IS chÆ°a. Náº¿u Ä‘Ã£ khÃ³a, cÃ³ nghÄ©a lÃ  cÃ³ giao dá»‹ch khÃ¡c Ä‘ang sá»­ dá»¥ng báº£ng nÃ y hoáº·c khÃ³a cá»§a má»™t hÃ ng trong báº£ng nÃ y, do Ä‘Ã³ giao dá»‹ch T khÃ´ng thá»ƒ khÃ³a thÃ nh cÃ´ng.</p>
<p>CÃ¡c quy táº¯c khÃ³a Ã½ Ä‘á»‹nh:</p>
<ul>
<li>IX/IS lÃ  khÃ³a báº£ng;</li>
<li>X/S lÃ  khÃ³a hÃ ng.</li>
<li>TrÆ°á»›c khi má»™t giao dá»‹ch nháº­n khÃ³a S cho má»™t hÃ ng dá»¯ liá»‡u nÃ o Ä‘Ã³, trÆ°á»›c tiÃªn pháº£i nháº­n khÃ³a IS hoáº·c khÃ³a máº¡nh hÆ¡n trÃªn báº£ng;</li>
<li>TrÆ°á»›c khi má»™t giao dá»‹ch nháº­n khÃ³a X cho má»™t hÃ ng dá»¯ liá»‡u nÃ o Ä‘Ã³, trÆ°á»›c tiÃªn pháº£i nháº­n khÃ³a IX hoáº·c khÃ³a máº¡nh hÆ¡n trÃªn báº£ng.</li>
</ul>
<p>Báº±ng cÃ¡ch giá»›i thiá»‡u khÃ³a Ã½ Ä‘á»‹nh, giao dá»‹ch T muá»‘n khÃ³a báº£ng A báº±ng khÃ³a X chá»‰ cáº§n kiá»ƒm tra xem cÃ³ giao dá»‹ch khÃ¡c Ä‘Ã£ khÃ³a A báº±ng khÃ³a X/IX/S/IS chÆ°a, náº¿u Ä‘Ã£ khÃ³a thÃ¬ cÃ³ nghÄ©a lÃ  cÃ³ giao dá»‹ch khÃ¡c Ä‘ang sá»­ dá»¥ng báº£ng nÃ y hoáº·c má»™t hÃ ng trong báº£ng nÃ y, do Ä‘Ã³ giao dá»‹ch T khÃ´ng thá»ƒ khÃ³a thÃ nh cÃ´ng.</p>
<p>CÃ¡c quan há»‡ khÃ³a khÃ¡c nhau nhÆ° sau:</p>
<table>
<thead>
<tr>
<th style="text-align:center">-</th>
<th style="text-align:center">X</th>
<th style="text-align:center">IX</th>
<th style="text-align:center">S</th>
<th style="text-align:center">IS</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">X</td>
<td style="text-align:center">âŒ</td>
<td style="text-align:center">âŒ</td>
<td style="text-align:center">âŒ</td>
<td style="text-align:center">âŒ</td>
</tr>
<tr>
<td style="text-align:center">IX</td>
<td style="text-align:center">âŒ</td>
<td style="text-align:center">âœ”ï¸</td>
<td style="text-align:center">âŒ</td>
<td style="text-align:center">âœ”ï¸</td>
</tr>
<tr>
<td style="text-align:center">S</td>
<td style="text-align:center">âŒ</td>
<td style="text-align:center">âŒ</td>
<td style="text-align:center">âœ”ï¸</td>
<td style="text-align:center">âœ”ï¸</td>
</tr>
<tr>
<td style="text-align:center">IS</td>
<td style="text-align:center">âŒ</td>
<td style="text-align:center">âœ”ï¸</td>
<td style="text-align:center">âœ”ï¸</td>
<td style="text-align:center">âœ”ï¸</td>
</tr>
</tbody>
</table>
<p>Giáº£i thÃ­ch:</p>
<ul>
<li>Báº¥t ká»³ khÃ³a IS/IX nÃ o cÅ©ng tÆ°Æ¡ng thÃ­ch vá»›i nhau, vÃ¬ chÃºng chá»‰ Ä‘áº¡i diá»‡n cho viá»‡c muá»‘n khÃ³a báº£ng, khÃ´ng pháº£i khÃ³a thá»±c sá»±;</li>
<li>Quan há»‡ tÆ°Æ¡ng thÃ­ch Ã¡p dá»¥ng cho khÃ³a cáº¥p báº£ng, trong khi khÃ³a IX cáº¥p báº£ng vÃ  khÃ³a X cáº¥p hÃ ng tÆ°Æ¡ng thÃ­ch vá»›i nhau. Hai giao dá»‹ch cÃ³ thá»ƒ Ä‘áº·t khÃ³a X trÃªn hai hÃ ng dá»¯ liá»‡u (Giao dá»‹ch T1 muá»‘n Ä‘áº·t khÃ³a X trÃªn hÃ ng R1, Giao dá»‹ch T2 muá»‘n Ä‘áº·t khÃ³a X trÃªn hÃ ng R2 cá»§a cÃ¹ng má»™t báº£ng. Cáº£ hai giao dá»‹ch Ä‘á»u cáº§n pháº£i Ä‘áº·t khÃ³a IX trÃªn báº£ng nÃ y, nhÆ°ng cÃ¡c loáº¡i khÃ³a nÃ y lÃ  tÆ°Æ¡ng thÃ­ch vÃ  tÆ°Æ¡ng thÃ­ch vá»›i khoÃ¡ X cáº¥p hÃ ng nghÄ©a lÃ  cáº£ hai giao dá»‹ch cÃ³ thá»ƒ khoÃ¡ thÃ nh cÃ´ng vÃ  chá»‰nh sá»­a hai hÃ ng dá»¯ liá»‡u trong cÃ¹ng má»™t báº£ng).</li>
</ul>
<h2>MVCC</h2>
<p><strong>Äiá»u khiá»ƒn Ä‘á»“ng thá»i Ä‘a phiÃªn báº£n (Multi-Version Concurrency Control, MVCC)</strong>&nbsp;cÃ³ thá»ƒ coi lÃ  má»™t biáº¿n thá»ƒ cá»§a khÃ³a cáº¥p hÃ ng. Trong nhiá»u trÆ°á»ng há»£p, nÃ³ trÃ¡nh Ä‘Æ°á»£c cÃ¡c hoáº¡t Ä‘á»™ng khÃ³a, do Ä‘Ã³ cÃ³ chi phÃ­ tháº¥p hÆ¡n. KhÃ´ng chá»‰ cÃ³ Mysql, cÃ¡c cÆ¡ sá»Ÿ dá»¯ liá»‡u khÃ¡c nhÆ° Oracle, PostgreSQL cÅ©ng Ä‘Ã£ triá»ƒn khai MVCC cá»§a riÃªng há», khÃ´ng cÃ³ tiÃªu chuáº©n thá»‘ng nháº¥t cho cÆ¡ cháº¿ triá»ƒn khai.</p>
<p>MVCC lÃ  má»™t cÃ¡ch cá»¥ thá»ƒ Ä‘á»ƒ triá»ƒn khai cáº¥p Ä‘á»™ cÃ´ láº­p trong Ä‘á»™ng cÆ¡ lÆ°u trá»¯ InnoDB, <strong>Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ triá»ƒn khai cáº¥p Ä‘á»™ Ä‘á»c Ä‘Ã£ cam káº¿t vÃ  Ä‘á»c láº·p láº¡i</strong>. Cáº¥p Ä‘á»™ Ä‘á»c chÆ°a cam káº¿t luÃ´n Ä‘á»c dÃ²ng dá»¯ liá»‡u má»›i nháº¥t, yÃªu cáº§u tháº¥p, khÃ´ng cáº§n sá»­ dá»¥ng MVCC. Cáº¥p Ä‘á»™ tuáº§n tá»± hÃ³a yÃªu cáº§u khÃ³a táº¥t cáº£ cÃ¡c dÃ²ng dá»¯ liá»‡u Ä‘á»c, khÃ´ng thá»ƒ triá»ƒn khai chá»‰ báº±ng MVCC.</p>
<h3>Ã tÆ°á»Ÿng cá»§a MVCC</h3>
<p>Viá»‡c khÃ³a cÃ³ thá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nháº¥t quÃ¡n Ä‘á»“ng thá»i xáº£y ra khi nhiá»u giao dá»‹ch Ä‘Æ°á»£c thá»±c hiá»‡n cÃ¹ng má»™t lÃºc. Trong cÃ¡c tÃ¬nh huá»‘ng thá»±c táº¿, thao tÃ¡c Ä‘á»c thÆ°á»ng nhiá»u hÆ¡n thao tÃ¡c ghi, do Ä‘Ã³, khÃ³a Ä‘á»c vÃ  ghi Ä‘Æ°á»£c giá»›i thiá»‡u Ä‘á»ƒ trÃ¡nh cÃ¡c hoáº¡t Ä‘á»™ng khÃ³a khÃ´ng cáº§n thiáº¿t, cháº³ng háº¡n nhÆ° khÃ´ng cÃ³ má»‘i quan há»‡ cáº¡nh tranh giá»¯a Ä‘á»c vÃ  Ä‘á»c. Thao tÃ¡c Ä‘á»c vÃ  ghi trong khÃ³a Ä‘á»c vÃ  ghi váº«n tÆ°Æ¡ng Ä‘á»‘i cáº¡nh tranh.</p>
<p>Ã tÆ°á»Ÿng cá»§a MVCC lÃ :</p>
<ul>
<li><strong>LÆ°u trá»¯ báº£n chá»¥p (snapshot) cá»§a dá»¯ liá»‡u táº¡i má»™t thá»i Ä‘iá»ƒm nÃ o Ä‘Ã³, cÃ¡c thao tÃ¡c ghi (DELETE, INSERT, UPDATE) cáº­p nháº­t báº£n chá»¥p phiÃªn báº£n má»›i nháº¥t; trong khi cÃ¡c thao tÃ¡c Ä‘á»c truy cáº­p báº£n chá»¥p phiÃªn báº£n cÅ©, khÃ´ng cÃ³ má»‘i quan há»‡ cáº¡nh tranh</strong>. Äiá»u nÃ y tÆ°Æ¡ng tá»± nhÆ°&nbsp;<code>CopyOnWrite</code>.</li>
<li>Äá»c báº©n vÃ  Ä‘á»c láº¡i khÃ´ng nháº¥t quÃ¡n lÃ  do&nbsp;<strong>giao dá»‹ch Ä‘á»c cÃ¡c thay Ä‘á»•i chÆ°a Ä‘Æ°á»£c giao dá»‹ch khÃ¡c cam káº¿t</strong>. Khi giao dá»‹ch thá»±c hiá»‡n thao tÃ¡c Ä‘á»c, Ä‘á»ƒ giáº£i quyáº¿t váº¥n Ä‘á» Ä‘á»c báº©n vÃ  Ä‘á»c khÃ´ng nháº¥t quÃ¡n,&nbsp;<strong>MVCC quy Ä‘á»‹nh chá»‰ cÃ³ thá»ƒ Ä‘á»c báº£n chá»¥p Ä‘Ã£ cam káº¿t</strong>. Táº¥t nhiÃªn, má»™t giao dá»‹ch cÃ³ thá»ƒ Ä‘á»c báº£n chá»¥p chÆ°a Ä‘Æ°á»£c cam káº¿t cá»§a chÃ­nh nÃ³, Ä‘iá»u nÃ y khÃ´ng Ä‘Æ°á»£c coi lÃ  Ä‘á»c báº©n.</li>
</ul>
<h3>Sá»‘ phiÃªn báº£n</h3>
<p>Triá»ƒn khai MVCC cá»§a InnoDB lÃ : lÆ°u trá»¯ hai cá»™t áº©n sau má»—i dÃ²ng ghi, má»™t cá»™t lÆ°u trá»¯ thá»i gian táº¡o dÃ²ng, cá»™t cÃ²n láº¡i lÆ°u trá»¯ thá»i gian háº¿t háº¡n cá»§a dÃ²ng (thá»i gian á»Ÿ Ä‘Ã¢y cÃ³ nghÄ©a lÃ  sá»‘ phiÃªn báº£n há»‡ thá»‘ng). Má»—i khi báº¯t Ä‘áº§u má»™t giao dá»‹ch má»›i, sá»‘ phiÃªn báº£n há»‡ thá»‘ng sáº½ tá»± Ä‘á»™ng tÄƒng lÃªn, sá»‘ phiÃªn báº£n há»‡ thá»‘ng táº¡i thá»i Ä‘iá»ƒm báº¯t Ä‘áº§u giao dá»‹ch sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng lÃ m sá»‘ phiÃªn báº£n cá»§a giao dá»‹ch, Ä‘á»ƒ so sÃ¡nh vá»›i sá»‘ phiÃªn báº£n cá»§a má»—i dÃ²ng ghi Ä‘Æ°á»£c truy váº¥n.</p>
<ul>
<li>Sá»‘ phiÃªn báº£n há»‡ thá»‘ng&nbsp;<code>SYS_ID</code>: lÃ  má»™t sá»‘ tÄƒng dáº§n, má»—i khi báº¯t Ä‘áº§u má»™t giao dá»‹ch má»›i, sá»‘ phiÃªn báº£n há»‡ thá»‘ng sáº½ tá»± Ä‘á»™ng tÄƒng lÃªn.</li>
<li>Sá»‘ phiÃªn báº£n giao dá»‹ch&nbsp;<code>TRX_ID</code>: sá»‘ phiÃªn báº£n há»‡ thá»‘ng táº¡i thá»i Ä‘iá»ƒm báº¯t Ä‘áº§u giao dá»‹ch.</li>
</ul>
<h3>Undo log</h3>
<p>MVCC cá»§a nhiá»u phiÃªn báº£n Ä‘á» cáº­p Ä‘áº¿n viá»‡c lÆ°u trá»¯ nhiá»u báº£n chá»¥p, báº£n chá»¥p Ä‘Æ°á»£c lÆ°u trá»¯ trong Undo log, log nÃ y káº¿t ná»‘i táº¥t cáº£ cÃ¡c báº£n chá»¥p cá»§a má»™t dÃ²ng dá»¯ liá»‡u thÃ´ng qua con trá» rollback&nbsp;<code>ROLL_PTR</code>.</p>
<p>VÃ­ dá»¥, trong MySQL, táº¡o má»™t báº£ng t, bao gá»“m khÃ³a chÃ­nh id vÃ  má»™t trÆ°á»ng x. ChÃºng ta chÃ¨n má»™t dÃ²ng dá»¯ liá»‡u trÆ°á»›c, sau Ä‘Ã³ thá»±c hiá»‡n hai láº§n cáº­p nháº­t trÃªn dÃ²ng Ä‘Ã³.</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">INSERT INTO</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> t(id, x) </span><span style="color:#C678DD;--shiki-dark:#C678DD">VALUES</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">"a"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">UPDATE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> t </span><span style="color:#C678DD;--shiki-dark:#C678DD">SET</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> x</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379">"b"</span><span style="color:#C678DD;--shiki-dark:#C678DD"> WHERE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> id</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">UPDATE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> t </span><span style="color:#C678DD;--shiki-dark:#C678DD">SET</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> x</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379">"c"</span><span style="color:#C678DD;--shiki-dark:#C678DD"> WHERE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> id</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span></code></pre>
</div><p>VÃ¬ khÃ´ng sá»­ dá»¥ng&nbsp;<code>START TRANSACTION</code>&nbsp;Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c hoáº¡t Ä‘á»™ng trÃªn nhÆ° má»™t giao dá»‹ch, theo cÆ¡ cháº¿&nbsp;<code>AUTOCOMMIT</code>&nbsp;cá»§a MySQL, má»—i hoáº¡t Ä‘á»™ng sáº½ Ä‘Æ°á»£c coi lÃ  má»™t giao dá»‹ch, vÃ¬ váº­y tá»•ng cá»™ng cÃ³ ba giao dá»‹ch.<br>
Trong báº£n chá»¥p, ngoÃ i viá»‡c ghi láº¡i sá»‘ phiÃªn báº£n cá»§a giao dá»‹ch <code>TRX_ID</code> vÃ  cÃ¡c hoáº¡t Ä‘á»™ng, cÃ²n cÃ³ má»™t trÆ°á»ng DEL kiá»ƒu bit Ä‘á»ƒ Ä‘Ã¡nh dáº¥u xem liá»‡u nÃ³ Ä‘Ã£ bá»‹ xÃ³a hay chÆ°a.</p>
<p><code>INSERT</code>, <code>UPDATE</code>, vÃ  <code>DELETE</code> sáº½ táº¡o ra má»™t báº£n ghi nháº­t kÃ½ vÃ  ghi sá»‘ phiÃªn báº£n giao dá»‹ch <code>TRX_ID</code>. <code>DELETE</code> cÃ³ thá»ƒ coi lÃ  má»™t loáº¡i Ä‘áº·c biá»‡t cá»§a <code>UPDATE</code>, ngoÃ i ra cÃ²n thiáº¿t láº­p trÆ°á»ng DEL thÃ nh 1.</p>
<h3>ReadView</h3>
<p>MVCC duy trÃ¬ má»™t&nbsp;<code>consistent read view</code>, chá»©a danh sÃ¡ch cÃ¡c giao dá»‹ch chÆ°a Ä‘Æ°á»£c cam káº¿t trong há»‡ thá»‘ng&nbsp;<code>TRX_IDs {TRX_ID_1, TRX_ID_2, â€¦}</code>, cÃ¹ng vá»›i giÃ¡ trá»‹ nhá» nháº¥t vÃ  lá»›n nháº¥t cá»§a danh sÃ¡ch Ä‘Ã³&nbsp;<code>TRX_ID_MIN</code>&nbsp;vÃ &nbsp;<code>TRX_ID_MAX</code>.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/mysql-mvcc-readview.png" alt="mysql-mvcc-readview.png" tabindex="0" loading="lazy"><figcaption>mysql-mvcc-readview.png</figcaption></figure>
<p>NhÆ° váº­y, Ä‘á»‘i vá»›i thá»i Ä‘iá»ƒm báº¯t Ä‘áº§u cá»§a giao dá»‹ch hiá»‡n táº¡i, má»™t phiÃªn báº£n dá»¯ liá»‡u hÃ ng <code>trx_id</code> cÃ³ thá»ƒ cÃ³ cÃ¡c trÆ°á»ng há»£p sau:</p>
<ol>
<li>Náº¿u náº±m trong pháº§n mÃ u xanh lÃ¡ cÃ¢y, Ä‘Ã³ chá»‰ lÃ  phiÃªn báº£n cá»§a má»™t giao dá»‹ch Ä‘Ã£ Ä‘Æ°á»£c cam káº¿t hoáº·c Ä‘Æ°á»£c táº¡o bá»Ÿi chÃ­nh giao dá»‹ch hiá»‡n táº¡i, dá»¯ liá»‡u nÃ y cÃ³ thá»ƒ nhÃ¬n tháº¥y.</li>
<li>Náº¿u náº±m trong pháº§n mÃ u Ä‘á», Ä‘Ã³ chá»‰ lÃ  phiÃªn báº£n Ä‘Æ°á»£c táº¡o bá»Ÿi má»™t giao dá»‹ch sáº½ Ä‘Æ°á»£c khá»Ÿi Ä‘á»™ng trong tÆ°Æ¡ng lai, nÃ³ cháº¯c cháº¯n khÃ´ng thá»ƒ nhÃ¬n tháº¥y.</li>
<li>Náº¿u náº±m trong pháº§n mÃ u cam, cÃ³ hai trÆ°á»ng há»£p:
<ul>
<li>Náº¿u hÃ ng <code>trx_id</code> cÃ³ trong máº£ng, Ä‘Ã³ chá»‰ lÃ  phiÃªn báº£n Ä‘Æ°á»£c táº¡o bá»Ÿi má»™t giao dá»‹ch chÆ°a Ä‘Æ°á»£c cam káº¿t, khÃ´ng thá»ƒ nhÃ¬n tháº¥y.</li>
<li>Náº¿u hÃ ng <code>trx_id</code> khÃ´ng cÃ³ trong máº£ng, Ä‘Ã³ chá»‰ lÃ  phiÃªn báº£n Ä‘Æ°á»£c táº¡o bá»Ÿi má»™t giao dá»‹ch Ä‘Ã£ Ä‘Æ°á»£c cam káº¿t, cÃ³ thá»ƒ nhÃ¬n tháº¥y.</li>
</ul>
</li>
</ol>
<p>Khi thá»±c hiá»‡n thao tÃ¡c&nbsp;<code>SELECT</code>, ta cÃ³ thá»ƒ xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c kháº£ nÄƒng sá»­ dá»¥ng báº£n chá»¥p hÃ ng dá»¯ liá»‡u dá»±a trÃªn má»‘i quan há»‡ giá»¯a <code>TRX_ID</code> cá»§a báº£n chá»¥p vÃ  <code>TRX_ID_MIN</code> cÅ©ng nhÆ° <code>TRX_ID_MAX</code>.</p>
<ul>
<li><code>TRX_ID</code>&nbsp;&lt;&nbsp;<code>TRX_ID_MIN</code>, Ä‘Ã³ lÃ  phiÃªn báº£n dÃ²ng dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c thay Ä‘á»•i trÆ°á»›c táº¥t cáº£ cÃ¡c giao dá»‹ch chÆ°a Ä‘Æ°á»£c cam káº¿t hiá»‡n táº¡i, do Ä‘Ã³ cÃ³ thá»ƒ sá»­ dá»¥ng.</li>
<li><code>TRX_ID</code>&nbsp;&gt;&nbsp;<code>TRX_ID_MAX</code>, Ä‘Ã³ lÃ  phiÃªn báº£n dÃ²ng dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c thay Ä‘á»•i sau khi giao dá»‹ch báº¯t Ä‘áº§u, do Ä‘Ã³ khÃ´ng thá»ƒ sá»­ dá»¥ng.</li>
<li><code>TRX_ID_MIN</code>&nbsp;&lt;=&nbsp;<code>TRX_ID</code>&nbsp;&lt;=&nbsp;<code>TRX_ID_MAX</code>, cáº§n xÃ¡c Ä‘á»‹nh dá»±a trÃªn cáº¥p Ä‘á»™ cÃ´ láº­p:
<ul>
<li>Äá»c Ä‘Ã£ cam káº¿t: Náº¿u&nbsp;<code>TRX_ID</code>&nbsp;cÃ³ trong danh sÃ¡ch&nbsp;<code>TRX_IDs</code>, Ä‘Ã³ lÃ  phiÃªn báº£n dÃ²ng dá»¯ liá»‡u tÆ°Æ¡ng á»©ng vá»›i giao dá»‹ch chÆ°a Ä‘Æ°á»£c cam káº¿t, do Ä‘Ã³ phiÃªn báº£n nÃ y khÃ´ng thá»ƒ sá»­ dá»¥ng. Náº¿u khÃ´ng, Ä‘Ã³ lÃ  phiÃªn báº£n Ä‘Ã£ Ä‘Æ°á»£c cam káº¿t, cÃ³ thá»ƒ sá»­ dá»¥ng.</li>
<li>Äá»c láº·p láº¡i: khÃ´ng thá»ƒ sá»­ dá»¥ng cáº£ hai. VÃ¬ náº¿u cÃ³ thá»ƒ sá»­ dá»¥ng, thÃ¬ cÃ¡c giao dá»‹ch khÃ¡c cÅ©ng cÃ³ thá»ƒ Ä‘á»c phiÃªn báº£n dÃ²ng dá»¯ liá»‡u nÃ y vÃ  thá»±c hiá»‡n thay Ä‘á»•i, khiáº¿n giÃ¡ trá»‹ Ä‘á»c cá»§a giao dá»‹ch hiá»‡n táº¡i thay Ä‘á»•i, tá»©c lÃ  xáº£y ra váº¥n Ä‘á» Ä‘á»c láº·p láº¡i khÃ´ng nháº¥t quÃ¡n.</li>
</ul>
</li>
</ul>
<p>Trong trÆ°á»ng há»£p khÃ´ng thá»ƒ sá»­ dá»¥ng báº£n chá»¥p hÃ ng dá»¯ liá»‡u, cáº§n tÃ¬m Ä‘áº¿n chá»‰ sá»‘ cuá»™n <code>ROLL_PTR</code> trong Undo Log Ä‘á»ƒ tÃ¬m báº£n chá»¥p tiáº¿p theo vÃ  tiáº¿n hÃ nh kiá»ƒm tra nhÆ° Ä‘Ã£ nÃªu á»Ÿ trÃªn.</p>
<h3>Äá»c báº£n chá»¥p vÃ  Ä‘á»c hiá»‡n táº¡i</h3>
<p><strong>Äá»c báº£n chá»¥p</strong></p>
<p>Thao tÃ¡c <code>SELECT</code> cá»§a MVCC lÃ  dá»¯ liá»‡u trong báº£n chá»¥p, khÃ´ng cáº§n thá»±c hiá»‡n hoáº¡t Ä‘á»™ng khÃ³a.</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SELECT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> * </span><span style="color:#C678DD;--shiki-dark:#C678DD">FROM</span><span style="color:#C678DD;--shiki-dark:#C678DD"> table</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> ...;</span></span></code></pre>
</div><p><strong>Äá»c hiá»‡n táº¡i</strong></p>
<p>CÃ¡c hoáº¡t Ä‘á»™ng khÃ¡c cá»§a MVCC sáº½ thay Ä‘á»•i cÆ¡ sá»Ÿ dá»¯ liá»‡u (<code>INSERT</code>, <code>UPDATE</code>, <code>DELETE</code>) cáº§n thá»±c hiá»‡n hoáº¡t Ä‘á»™ng khÃ³a Ä‘á»ƒ Ä‘á»c dá»¯ liá»‡u má»›i nháº¥t. CÃ³ thá»ƒ tháº¥y MVCC khÃ´ng hoÃ n toÃ n khÃ´ng sá»­ dá»¥ng khÃ³a, mÃ  chá»‰ trÃ¡nh viá»‡c Ã¡p dá»¥ng khÃ³a cho <code>SELECT</code>.</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">INSERT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">UPDATE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">DELETE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span></code></pre>
</div><p>Khi thá»±c hiá»‡n thao tÃ¡c <code>SELECT</code>, cÃ³ thá»ƒ báº¯t buá»™c chá»‰ Ä‘á»‹nh thá»±c hiá»‡n khÃ³a. CÃ¢u lá»‡nh Ä‘áº§u tiÃªn yÃªu cáº§u khÃ³a S, cÃ¢u lá»‡nh thá»© hai yÃªu cáº§u khÃ³a X.</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SELECT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> * </span><span style="color:#C678DD;--shiki-dark:#C678DD">FROM</span><span style="color:#C678DD;--shiki-dark:#C678DD"> table</span><span style="color:#C678DD;--shiki-dark:#C678DD"> WHERE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> ? lock </span><span style="color:#C678DD;--shiki-dark:#C678DD">in</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> share mode;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SELECT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> * </span><span style="color:#C678DD;--shiki-dark:#C678DD">FROM</span><span style="color:#C678DD;--shiki-dark:#C678DD"> table</span><span style="color:#C678DD;--shiki-dark:#C678DD"> WHERE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> ? </span><span style="color:#C678DD;--shiki-dark:#C678DD">for</span><span style="color:#C678DD;--shiki-dark:#C678DD"> update</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span></code></pre>
</div><h2>KhÃ³a hÃ ng</h2>
<p>CÃ³ ba thuáº­t toÃ¡n cá»¥ thá»ƒ Ä‘á»ƒ triá»ƒn khai khÃ³a hÃ ng (row lock): khÃ³a báº£n ghi (record lock), KhoÃ¡ khoáº£ng (gap lock) vÃ  khÃ³a next-key.</p>
<ul>
<li><code>KhÃ³a báº£n ghi (Record Lock)</code> - <strong>KhÃ³a hÃ ng báº±ng cÃ¡ch khÃ³a cÃ¡c má»¥c chá»‰ má»¥c (index entry), náº¿u khÃ´ng cÃ³ chá»‰ má»¥c thÃ¬ sá»­ dá»¥ng khÃ³a báº£ng</strong>.</li>
<li><code>KhoÃ¡ khoáº£ng (Gap Lock)</code> - <strong>KhoÃ¡ khoáº£ng giá»¯a cÃ¡c má»¥c chá»‰ má»¥c (index entry)</strong>. KhoÃ¡ khoáº£ng giá»¯a cÃ¡c má»¥c chá»‰ má»¥c, nhÆ°ng khÃ´ng bao gá»“m chÃ­nh má»¥c chá»‰ má»¥c Ä‘Ã³. VÃ­ dá»¥, khi má»™t giao dá»‹ch thá»±c hiá»‡n cÃ¢u lá»‡nh sau, cÃ¡c giao dá»‹ch khÃ¡c khÃ´ng thá»ƒ chÃ¨n giÃ¡ trá»‹ 15 vÃ o cá»™t c trong báº£ng t: <code>SELECT c FROM t WHERE c BETWEEN 10 and 20 FOR UPDATE;</code>. Trong MySQL, KhoÃ¡ khoáº£ng máº·c Ä‘á»‹nh lÃ  Ä‘Æ°á»£c báº­t, tá»©c lÃ  giÃ¡ trá»‹ cá»§a tham sá»‘ <code>innodb_locks_unsafe_for_binlog</code> lÃ  <code>disable</code>, vÃ  máº·c Ä‘á»‹nh trong MySQL lÃ  cáº¥p Ä‘á»™ cÃ´ láº­p giao dá»‹ch RR.</li>
<li><code>KhÃ³a next-key</code> - ÄÃ¢y lÃ  sá»± káº¿t há»£p cá»§a <code>KhÃ³a báº£n ghi (record lock)</code> vÃ  <code>KhoÃ¡ khoáº£ng (gap lock)</code>. NÃ³ khÃ´ng chá»‰ khÃ³a má»™t má»¥c chá»‰ má»¥c trÃªn má»™t báº£n ghi, mÃ  cÃ²n khoÃ¡ khoáº£ng giá»¯a cÃ¡c chá»‰ má»¥c. NÃ³ khÃ³a má»™t khoáº£ng má»Ÿ phÃ­a trÆ°á»›c vÃ  Ä‘Ã³ng phÃ­a sau.</li>
</ul>
<p>Chá»‰ cÃ³ cÃ¡choáº¡t Ä‘á»™ng cá»¥ thá»ƒ trong cáº¥p Ä‘á»™ cÃ´ láº­p Ä‘á»c cÃ³ thá»ƒ láº·p láº¡i hoáº·c cao hÆ¡n má»›i sáº½ nháº­n Ä‘Æ°á»£c khÃ³a khoáº£ng (gap lock) hoáº·c khÃ³a next-key. Trong cÃ¡c cÃ¢u lá»‡nh <code>SELECT</code>, <code>UPDATE</code> vÃ  <code>DELETE</code>, ngoáº¡i trá»« cÃ¡c truy váº¥n dá»±a trÃªn chá»‰ má»¥c duy nháº¥t, cÃ¡c truy váº¥n dá»±a trÃªn chá»‰ má»¥c khÃ¡c Ä‘á»u láº¥y khoÃ¡ khoáº£ng hoáº·c khÃ³a next-key, tá»©c lÃ  khÃ³a pháº¡m vi quÃ©t cá»§a chÃºng. Chá»‰ má»¥c khÃ³a chÃ­nh cÅ©ng Ä‘Æ°á»£c coi lÃ  chá»‰ má»¥c duy nháº¥t, vÃ¬ váº­y chá»‰ má»¥c khÃ³a chÃ­nh khÃ´ng sá»­ dá»¥ng khÃ³a khoáº£ng (gap lock) hoáº·c khÃ³a next-key.</p>
<p>MVCC khÃ´ng thá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» Ä‘á»c láº¡i khÃ´ng nháº¥t quÃ¡n, <strong>khÃ³a next-key Ä‘Æ°á»£c táº¡o ra Ä‘á»ƒ giáº£i quyáº¿t váº¥n Ä‘á» Ä‘á»c láº¡i khÃ´ng nháº¥t quÃ¡n</strong>. Trong cáº¥p Ä‘á»™ cÃ´ láº­p Ä‘á»c cÃ³ thá»ƒ láº·p láº¡i (<code>REPEATABLE READ</code>), sá»­ dá»¥ng <strong>MVCC + KhÃ³a next-key</strong> cÃ³ thá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» Ä‘á»c láº¡i khÃ´ng nháº¥t quÃ¡n.</p>
<p>Chá»‰ má»¥c Ä‘Æ°á»£c chia thÃ nh chá»‰ má»¥c khÃ³a chÃ­nh (primary index) vÃ  chá»‰ má»¥c khoÃ¡ phá»¥ (khÃ´ng pháº£i khÃ³a chÃ­nh - non-primary index). Náº¿u má»™t cÃ¢u lá»‡nh SQL thao tÃ¡c trÃªn chá»‰ má»¥c khÃ³a chÃ­nh, MySQL sáº½ khÃ³a chá»‰ má»¥c khÃ³a chÃ­nh Ä‘Ã³; náº¿u má»™t cÃ¢u lá»‡nh thao tÃ¡c trÃªn chá»‰ má»¥c khoÃ¡ phá»¥, MySQL sáº½ khÃ³a chá»‰ má»¥c khoÃ¡ phá»¥ Ä‘Ã³ trÆ°á»›c, sau Ä‘Ã³ khÃ³a chá»‰ má»¥c khÃ³a chÃ­nh liÃªn quan. Trong cÃ¡c cÃ¢u lá»‡nh <code>UPDATE</code> vÃ  <code>DELETE</code>, MySQL khÃ´ng chá»‰ khÃ³a táº¥t cáº£ cÃ¡c báº£n ghi chá»‰ má»¥c Ä‘Æ°á»£c quÃ©t bá»Ÿi Ä‘iá»u kiá»‡n <code>WHERE</code>, mÃ  cÃ²n khÃ³a cÃ¡c giÃ¡ trá»‹ liá»n ká», cÃ²n Ä‘Æ°á»£c gá»i lÃ  <code>khÃ³a next-key</code>.</p>
<p>Khi hai giao dá»‹ch Ä‘Æ°á»£c thá»±c hiá»‡n Ä‘á»“ng thá»i, má»™t giao dá»‹ch khÃ³a chá»‰ má»¥c khoÃ¡ chÃ­nh vÃ  Ä‘ang chá» Ä‘á»£i cÃ¡c chá»‰ má»¥c liÃªn quan. Giao dá»‹ch khÃ¡c khÃ³a chá»‰ má»¥c khoÃ¡ phá»¥ vÃ  Ä‘ang chá» Ä‘á»£i chá»‰ má»¥c khoÃ¡ chÃ­nh liÃªn quan. Äiá»u nÃ y dáº«n Ä‘áº¿n tÃ¬nh tráº¡ng báº¿ táº¯c. Sau khi xáº£y ra tÃ¬nh tráº¡ng báº¿ táº¯c, <code>InnoDB</code> thÆ°á»ng cÃ³ thá»ƒ phÃ¡t hiá»‡n vÃ  lÃ m cho má»™t giao dá»‹ch giáº£i phÃ³ng khÃ³a vÃ  rollback, vÃ  giao dá»‹ch khÃ¡c tiáº¿p tá»¥c láº¥y khÃ³a Ä‘á»ƒ hoÃ n thÃ nh giao dá»‹ch.</p>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/mysql-mvcc-readview.png" type="image/png"/>
    </item>
    <item>
      <title>MySQL Index</title>
      <link>https://vanhung4499.github.io/database/mysql/mysql-index.html</link>
      <guid>https://vanhung4499.github.io/database/mysql/mysql-index.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">MySQL Index</source>
      <description>MySQL Index Chá»‰ má»¥c lÃ  má»™t phÆ°Æ¡ng phÃ¡p quan trá»ng Ä‘á»ƒ cáº£i thiá»‡n hiá»‡u suáº¥t truy váº¥n trong MySQL, nhÆ°ng quÃ¡ nhiá»u chá»‰ má»¥c cÃ³ thá»ƒ dáº«n Ä‘áº¿n sá»­ dá»¥ng Ä‘Ä©a cao vÃ  chiáº¿m nhiá»u bá»™ nhá»›, áº£nh ...</description>
      <category>mysql</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>Chá»‰ má»¥c lÃ  má»™t phÆ°Æ¡ng phÃ¡p quan trá»ng Ä‘á»ƒ cáº£i thiá»‡n hiá»‡u suáº¥t truy váº¥n trong MySQL, nhÆ°ng quÃ¡ nhiá»u chá»‰ má»¥c cÃ³ thá»ƒ dáº«n Ä‘áº¿n sá»­ dá»¥ng Ä‘Ä©a cao vÃ  chiáº¿m nhiá»u bá»™ nhá»›, áº£nh hÆ°á»Ÿng Ä‘áº¿n hiá»‡u suáº¥t tá»•ng thá»ƒ cá»§a á»©ng dá»¥ng. NÃªn trÃ¡nh viá»‡c thÃªm chá»‰ má»¥c sau khi Ä‘Ã£ triá»ƒn khai, vÃ¬ sau Ä‘Ã³ cÃ³ thá»ƒ cáº§n giÃ¡m sÃ¡t nhiá»u truy váº¥n SQL Ä‘á»ƒ xÃ¡c Ä‘á»‹nh vá»‹ trÃ­ cá»§a váº¥n Ä‘á», vÃ  thá»i gian thÃªm chá»‰ má»¥c nháº¥t Ä‘á»‹nh lÃ  lá»›n hÆ¡n thá»i gian ban Ä‘áº§u Ä‘á»ƒ thÃªm chá»‰ má»¥c, Ä‘iá»u nÃ y cho tháº¥y viá»‡c thÃªm chá»‰ má»¥c cÅ©ng ráº¥t cÃ³ tÃ­nh ká»¹ thuáº­t.</p>
<p>Tiáº¿p theo, tÃ´i sáº½ giá»›i thiá»‡u cho báº¡n má»™t loáº¡t cÃ¡c chiáº¿n lÆ°á»£c táº¡o chá»‰ má»¥c hiá»‡u suáº¥t cao vÃ  nguyÃªn táº¯c lÃ m viá»‡c Ä‘áº±ng sau má»—i chiáº¿n lÆ°á»£c. Tuy nhiÃªn, trÆ°á»›c khi Ä‘i vÃ o chi tiáº¿t, hÃ£y tÃ¬m hiá»ƒu má»™t sá»‘ thuáº­t toÃ¡n vÃ  cáº¥u trÃºc dá»¯ liá»‡u liÃªn quan Ä‘áº¿n chá»‰ má»¥c, Ä‘iá»u nÃ y sáº½ giÃºp báº¡n hiá»ƒu rÃµ hÆ¡n ná»™i dung sau nÃ y.</p>
</blockquote>
<h2>Giá»›i thiá»‡u vá» chá»‰ má»¥c</h2>
<p><strong>Chá»‰ má»¥c lÃ  má»™t cáº¥u trÃºc dá»¯ liá»‡u trong cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ cáº£i thiá»‡n hiá»‡u suáº¥t tÃ¬m kiáº¿m</strong>.</p>
<p>Chá»‰ má»¥c lÃ  yáº¿u tá»‘ quan trá»ng cho hiá»‡u suáº¥t tá»‘t, khi dá»¯ liá»‡u nhá» vÃ  táº£i khÃ´ng cao, tÃ¡c Ä‘á»™ng cá»§a chá»‰ má»¥c khÃ´ng thá»ƒ tháº¥y rÃµ; nhÆ°ng khi dá»¯ liá»‡u tÄƒng dáº§n, hiá»‡u suáº¥t sáº½ giáº£m Ä‘Ã¡ng ká»ƒ. Do Ä‘Ã³, tá»‘i Æ°u chá»‰ má»¥c lÃ  biá»‡n phÃ¡p hiá»‡u quáº£ nháº¥t Ä‘á»ƒ tá»‘i Æ°u hiá»‡u suáº¥t truy váº¥n.</p>
<h3>Æ¯u vÃ  nhÆ°á»£c Ä‘iá»ƒm cá»§a chá»‰ má»¥c</h3>
<p>B-Tree lÃ  cáº¥u trÃºc dá»¯ liá»‡u chá»‰ má»¥c phá»• biáº¿n nháº¥t, lÆ°u trá»¯ dá»¯ liá»‡u theo thá»© tá»±, vÃ¬ váº­y MySQL cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c hoáº¡t Ä‘á»™ng&nbsp;<code>ORDER BY</code>&nbsp;vÃ &nbsp;<code>GROUP BY</code>. VÃ¬ dá»¯ liá»‡u Ä‘Æ°á»£c sáº¯p xáº¿p, B-Tree cÅ©ng sáº½ lÆ°u trá»¯ cÃ¡c giÃ¡ trá»‹ cá»™t liÃªn quan cÃ¹ng nhau. Cuá»‘i cÃ¹ng, vÃ¬ chá»‰ má»¥c lÆ°u trá»¯ cÃ¡c giÃ¡ trá»‹ cá»™t thá»±c táº¿, nÃªn má»™t sá»‘ truy váº¥n chá»‰ cáº§n sá»­ dá»¥ng chá»‰ má»¥c Ä‘á»ƒ hoÃ n thÃ nh toÃ n bá»™ truy váº¥n.</p>
<p>âœ” Æ¯u Ä‘iá»ƒm cá»§a chá»‰ má»¥c:</p>
<ul>
<li><strong>Chá»‰ má»¥c giáº£m Ä‘Ã¡ng ká»ƒ lÆ°á»£ng dá»¯ liá»‡u cáº§n quÃ©t bá»Ÿi mÃ¡y chá»§, tá»« Ä‘Ã³ tÄƒng tá»‘c Ä‘á»™ truy váº¥n</strong>.</li>
<li><strong>Chá»‰ má»¥c cÃ³ thá»ƒ giÃºp mÃ¡y chá»§ trÃ¡nh sáº¯p xáº¿p vÃ  báº£ng táº¡m thá»i</strong>.</li>
<li><strong>Chá»‰ má»¥c cÃ³ thá»ƒ biáº¿n I/O ngáº«u nhiÃªn thÃ nh I/O tuáº§n tá»±</strong>.</li>
<li>CÃ¡c cÆ¡ sá»Ÿ dá»¯ liá»‡u há»— trá»£ khÃ³a hÃ ng, cháº³ng háº¡n nhÆ° InnoDB, sáº½ khÃ³a khi truy cáº­p hÃ ng.&nbsp;<strong>Sá»­ dá»¥ng chá»‰ má»¥c cÃ³ thá»ƒ giáº£m sá»‘ lÆ°á»£ng hÃ ng truy cáº­p, tá»« Ä‘Ã³ giáº£m sá»± cáº¡nh tranh khÃ³a vÃ  tÄƒng cÆ°á»ng Ä‘á»“ng thá»i</strong>.</li>
<li>Chá»‰ má»¥c duy nháº¥t Ä‘áº£m báº£o tÃ­nh duy nháº¥t cá»§a má»—i hÃ ng dá»¯ liá»‡u, sá»­ dá»¥ng chá»‰ má»¥c cÃ³ thá»ƒ táº­n dá»¥ng Ä‘Æ°á»£c trÃ¬nh tá»‘i Æ°u hÃ³a áº©n, cáº£i thiá»‡n hiá»‡u suáº¥t há»‡ thá»‘ng.</li>
</ul>
<p>âŒ NhÆ°á»£c Ä‘iá»ƒm cá»§a chá»‰ má»¥c:</p>
<ul>
<li><strong>Táº¡o vÃ  duy trÃ¬ chá»‰ má»¥c máº¥t thá»i gian</strong>, Ä‘iá»u nÃ y tÄƒng theo lÆ°á»£ng dá»¯ liá»‡u.</li>
<li><strong>Chá»‰ má»¥c chiáº¿m khÃ´ng gian váº­t lÃ½ bá»• sung</strong>, ngoÃ i khÃ´ng gian dá»¯ liá»‡u cá»§a báº£ng, má»—i chá»‰ má»¥c cÅ©ng cáº§n má»™t khÃ´ng gian váº­t lÃ½ nháº¥t Ä‘á»‹nh, náº¿u táº¡o chá»‰ má»¥c káº¿t há»£p, khÃ´ng gian cáº§n thiáº¿t sáº½ lá»›n hÆ¡n.</li>
<li><strong>CÃ³ thá»ƒ cáº§n cáº­p nháº­t chá»‰ má»¥c khi thá»±c hiá»‡n cÃ¡c hoáº¡t Ä‘á»™ng ghi (<code>INSERT</code>/<code>UPDATE</code>/<code>DELETE</code>)</strong>, dáº«n Ä‘áº¿n giáº£m hiá»‡u suáº¥t ghi cá»§a cÆ¡ sá»Ÿ dá»¯ liá»‡u.</li>
</ul>
<h3>Khi nÃ o sá»­ dá»¥ng chá»‰ má»¥c</h3>
<blockquote>
<p>Chá»‰ má»¥c cÃ³ thá»ƒ dá»… dÃ ng nÃ¢ng cao hiá»‡u suáº¥t truy váº¥n má»™t vÃ i cáº¥p sá»‘ nhÃ¢n.</p>
</blockquote>
<p>âœ” TrÆ°á»ng há»£p&nbsp;<strong>thÃ­ch há»£p</strong>&nbsp;sá»­ dá»¥ng chá»‰ má»¥c:</p>
<ul>
<li><strong>Thao tÃ¡c Ä‘á»c thÆ°á»ng xuyÃªn (<code>SELECT</code>)</strong>.</li>
<li><strong>Dá»¯ liá»‡u trong báº£ng lá»›n</strong>.</li>
<li><strong>TÃªn cá»™t thÆ°á»ng xuáº¥t hiá»‡n trong Ä‘iá»u kiá»‡n&nbsp;<code>WHERE</code>&nbsp;hoáº·c Ä‘iá»u kiá»‡n káº¿t ná»‘i (<code>JOIN</code>)</strong>.</li>
</ul>
<p>âŒ TrÆ°á»ng há»£p&nbsp;<strong>khÃ´ng thÃ­ch há»£p</strong>&nbsp;sá»­ dá»¥ng chá»‰ má»¥c:</p>
<ul>
<li><strong>Thao tÃ¡c ghi thÆ°á»ng xuyÃªn (<code>INSERT</code>/<code>UPDATE</code>/<code>DELETE</code>)</strong>, Ä‘iá»u nÃ y cÃ³ nghÄ©a lÃ  cáº§n cáº­p nháº­t chá»‰ má»¥c.</li>
<li><strong>TÃªn cá»™t khÃ´ng thÆ°á»ng xuáº¥t hiá»‡n trong Ä‘iá»u kiá»‡n&nbsp;<code>WHERE</code>&nbsp;hoáº·c Ä‘iá»u kiá»‡n káº¿t ná»‘i (<code>JOIN</code>)</strong>, Ä‘iá»u nÃ y cÃ³ nghÄ©a lÃ  chá»‰ má»¥c thÆ°á»ng khÃ´ng Ä‘Æ°á»£c tÃ¬m tháº¥y, khÃ´ng cÃ³ Ã½ nghÄ©a vÃ  tÄƒng chi phÃ­ khÃ´ng gian.</li>
<li><strong>Báº£ng ráº¥t nhá»</strong>, trong háº§u háº¿t cÃ¡c trÆ°á»ng há»£p, quÃ©t toÃ n bá»™ báº£ng Ä‘Æ¡n giáº£n hÆ¡n vÃ  hiá»‡u quáº£ hÆ¡n cho báº£ng ráº¥t nhá».</li>
<li><strong>Báº£ng cá»¡ lá»›n Ä‘áº·c biá»‡t</strong>, chi phÃ­ táº¡o vÃ  sá»­ dá»¥ng chá»‰ má»¥c sáº½ tÄƒng lÃªn. CÃ³ thá»ƒ xem xÃ©t sá»­ dá»¥ng ká»¹ thuáº­t phÃ¢n vÃ¹ng hoáº·c NoSQL.</li>
</ul>
<h2>Cáº¥u trÃºc dá»¯ liá»‡u cá»§a chá»‰ má»¥c</h2>
<p>Trong MySQL, chá»‰ má»¥c Ä‘Æ°á»£c thá»±c hiá»‡n á»Ÿ bá»™ lÆ°u trá»¯ (storage engine), chá»© khÃ´ng pháº£i á»Ÿ lá»›p mÃ¡y chá»§. Do Ä‘Ã³, khÃ´ng cÃ³ tiÃªu chuáº©n chá»‰ má»¥c chung; cáº¥u trÃºc dá»¯ liá»‡u chá»‰ má»¥c cÃ³ thá»ƒ khÃ¡c nhau cho cÃ¡c storage engine khÃ¡c nhau.</p>
<h3>Máº£ng (Array)</h3>
<p>Máº£ng lÃ  má»™t cáº¥u trÃºc dá»¯ liá»‡u lÆ°u trá»¯ dá»¯ liá»‡u trong má»™t khÃ´ng gian bá»™ nhá»› liÃªn tá»¥c vÃ  há»— trá»£ truy cáº­p ngáº«u nhiÃªn.</p>
<p>Máº£ng Ä‘Æ°á»£c sáº¯p xáº¿p cÃ³ thá»ƒ sá»­ dá»¥ng thuáº­t toÃ¡n tÃ¬m kiáº¿m nhá»‹ phÃ¢n, cÃ³ Ä‘á»™ phá»©c táº¡p thá»i gian lÃ  <strong>O(log n)</strong>, cho cáº£ truy váº¥n báº±ng giÃ¡ trá»‹ vÃ  truy váº¥n theo pháº¡m vi.</p>
<p>Tuy nhiÃªn, máº£ng cÃ³ hai háº¡n cháº¿ quan trá»ng:</p>
<ul>
<li>KÃ­ch thÆ°á»›c khÃ´ng gian máº£ng cá»‘ Ä‘á»‹nh, náº¿u cáº§n má»Ÿ rá»™ng chá»‰ cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡ch sao chÃ©p máº£ng.</li>
<li>Thá»i gian phá»©c táº¡p cá»§a viá»‡c chÃ¨n vÃ  xÃ³a lÃ  O(n).</li>
</ul>
<p>Äiá»u nÃ y cÃ³ nghÄ©a lÃ , náº¿u sá»­ dá»¥ng máº£ng lÃ m chá»‰ má»¥c vÃ  muá»‘n Ä‘áº£m báº£o máº£ng Ä‘Æ°á»£c sáº¯p xáº¿p, thÃ¬ viá»‡c cáº­p nháº­t sáº½ tá»‘n kÃ©m.</p>
<h3>Chá»‰ má»¥c bÄƒm (Hash Index)</h3>
<p>Báº£ng bÄƒm lÃ  má»™t cáº¥u trÃºc dá»¯ liá»‡u lÆ°u trá»¯ dá»¯ liá»‡u dÆ°á»›i dáº¡ng cáº·p khÃ³a - giÃ¡ trá»‹ (key-value), trong Ä‘Ã³ chÃºng ta chá»‰ cáº§n nháº­p giÃ¡ trá»‹ cáº§n tÃ¬m kiáº¿m lÃ  khÃ³a (key), chÃºng ta sáº½ tÃ¬m tháº¥y giÃ¡ trá»‹ tÆ°Æ¡ng á»©ng.</p>
<p><strong>Báº£ng bÄƒm</strong>&nbsp;sá»­ dá»¥ng&nbsp;<strong>hÃ m bÄƒm</strong>&nbsp;Ä‘á»ƒ tá»• chá»©c dá»¯ liá»‡u, há»— trá»£ viá»‡c chÃ¨n vÃ  tÃ¬m kiáº¿m nhanh chÃ³ng. Cáº¥u trÃºc dá»¯ liá»‡u báº£ng bÄƒm thá»±c cháº¥t lÃ  má»™t máº£ng, vá»›i Ã½ tÆ°á»Ÿng lÃ : sá»­ dá»¥ng hÃ m bÄƒm Ä‘á»ƒ chuyá»ƒn Ä‘á»•i khÃ³a thÃ nh chá»‰ má»¥c máº£ng, sá»­ dá»¥ng tÃ­nh cháº¥t truy cáº­p ngáº«u nhiÃªn cá»§a máº£ng, cho phÃ©p chÃºng ta tÃ¬m kiáº¿m trong thá»i gian O(1).</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20220320201844.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<p>CÃ³ hai loáº¡i báº£ng bÄƒm khÃ¡c nhau:&nbsp;<strong>báº£ng bÄƒm táº­p há»£p</strong>&nbsp;vÃ &nbsp;<strong>báº£ng bÄƒm Ã¡nh xáº¡</strong>.</p>
<ul>
<li><strong>Báº£ng bÄƒm táº­p há»£p</strong>&nbsp;lÃ  má»™t cáº¥u trÃºc dá»¯ liá»‡u Ä‘á»ƒ lÆ°u trá»¯ cÃ¡c giÃ¡ trá»‹ khÃ´ng trÃ¹ng láº·p.</li>
<li><strong>Báº£ng bÄƒm Ã¡nh xáº¡</strong>&nbsp;lÃ  má»™t cáº¥u trÃºc dá»¯ liá»‡u Ä‘á»ƒ lÆ°u trá»¯ cáº·p khÃ³a - giÃ¡ trá»‹, trong Ä‘Ã³ giÃ¡ trá»‹ Ä‘Æ°á»£c liÃªn káº¿t vá»›i khÃ³a.</li>
</ul>
<p>Chá»‰ má»¥c bÄƒm dá»±a trÃªn báº£ng bÄƒm Ä‘á»ƒ triá»ƒn khai,&nbsp;<strong>chá»‰ há»— trá»£ truy váº¥n so sÃ¡nh báº±ng</strong>. Äá»‘i vá»›i má»—i hÃ ng dá»¯ liá»‡u, chá»‰ má»¥c bÄƒm sáº½ tÃ­nh toÃ¡n má»™t mÃ£ bÄƒm (hashcode) cho táº¥t cáº£ cÃ¡c cá»™t chá»‰ má»¥c vÃ  lÆ°u trá»¯ mÃ£ bÄƒm trong chá»‰ má»¥c, Ä‘á»“ng thá»i lÆ°u trá»¯ con trá» Ä‘áº¿n má»—i hÃ ng dá»¯ liá»‡u trong báº£ng bÄƒm.</p>
<p>Trong Mysql, chá»‰ cÃ³ lÆ°u trá»¯ bá»™ nhá»› (Memory) hiá»ƒn thá»‹ há»— trá»£ chá»‰ má»¥c bÄƒm.</p>
<p>âœ” Æ¯u Ä‘iá»ƒm cá»§a chá»‰ má»¥c bÄƒm:</p>
<ul>
<li>VÃ¬ cáº¥u trÃºc dá»¯ liá»‡u chá»‰ má»¥c gá»n nháº¹, nÃªn&nbsp;<strong>tá»‘c Ä‘á»™ truy váº¥n ráº¥t nhanh</strong>.</li>
</ul>
<p>âŒ NhÆ°á»£c Ä‘iá»ƒm cá»§a chá»‰ má»¥c bÄƒm:</p>
<ul>
<li>GiÃ¡ trá»‹ chá»‰ má»¥c khÃ´ng bao gá»“m giÃ¡ trá»‹ cá»™t, do Ä‘Ã³ khÃ´ng thá»ƒ sá»­ dá»¥ng giÃ¡ trá»‹ chá»‰ má»¥c Ä‘á»ƒ trÃ¡nh Ä‘á»c hÃ ng. Tuy nhiÃªn, viá»‡c truy cáº­p hÃ ng trong bá»™ nhá»› nhanh, vÃ¬ váº­y trong háº§u háº¿t cÃ¡c trÆ°á»ng há»£p, Ä‘iá»u nÃ y khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n hiá»‡u suáº¥t.</li>
<li>Dá»¯ liá»‡u chá»‰ má»¥c bÄƒm khÃ´ng Ä‘Æ°á»£c sáº¯p xáº¿p theo giÃ¡ trá»‹ chá»‰ má»¥c, do Ä‘Ã³&nbsp;<strong>khÃ´ng thá»ƒ sá»­ dá»¥ng Ä‘á»ƒ sáº¯p xáº¿p</strong>.</li>
<li>Chá»‰ má»¥c bÄƒm&nbsp;<strong>khÃ´ng há»— trá»£ truy váº¥n pháº¡m vi</strong>, vÃ¬ chá»‰ má»¥c bÄƒm sá»­ dá»¥ng toÃ n bá»™ ná»™i dung cá»™t chá»‰ má»¥c Ä‘á»ƒ tÃ­nh toÃ¡n bÄƒm. VÃ­ dá»¥, trÃªn cá»™t dá»¯ liá»‡u (A, B) xÃ¢y dá»±ng chá»‰ má»¥c bÄƒm, náº¿u truy váº¥n chá»‰ cÃ³ cá»™t dá»¯ liá»‡u A, khÃ´ng thá»ƒ sá»­ dá»¥ng chá»‰ má»¥c nÃ y.</li>
<li>Chá»‰ má»¥c bÄƒm cÃ³ thá»ƒ gáº·p&nbsp;<strong>xung Ä‘á»™t bÄƒm</strong>:
<ul>
<li>Khi xáº£y ra xung Ä‘á»™t bÄƒm, pháº£i duyá»‡t qua táº¥t cáº£ cÃ¡c con trá» hÃ ng trong danh sÃ¡ch liÃªn káº¿t, so sÃ¡nh tá»«ng hÃ ng má»™t cho Ä‘áº¿n khi tÃ¬m tháº¥y hÃ ng phÃ¹ há»£p.</li>
<li>Náº¿u xung Ä‘á»™t bÄƒm nhiá»u, viá»‡c duy trÃ¬ chá»‰ má»¥c sáº½ tá»‘n kÃ©m.</li>
</ul>
</li>
</ul>
<blockquote>
<p>VÃ¬ cÃ¡c háº¡n cháº¿ trÃªn, chá»‰ má»¥c bÄƒm chá»‰ phÃ¹ há»£p cho cÃ¡c tÃ¬nh huá»‘ng cá»¥ thá»ƒ. Tuy nhiÃªn, má»™t khi sá»­ dá»¥ng chá»‰ má»¥c bÄƒm, hiá»‡u suáº¥t cáº£i thiá»‡n sáº½ ráº¥t Ä‘Ã¡ng ká»ƒ.</p>
</blockquote>
<h3>Chá»‰ má»¥c B-Tree</h3>
<p>ThÆ°á»ng khi nÃ³i vá» chá»‰ má»¥c, chÃºng ta Ä‘á» cáº­p Ä‘áº¿n chá»‰ má»¥c B-Tree, Ä‘Ã¢y lÃ  loáº¡i chá»‰ má»¥c phá»• biáº¿n nháº¥t trong cÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡, háº§u háº¿t cÃ¡c Ä‘á»™ng cÆ¡ lÆ°u trá»¯ Ä‘á»u há»— trá»£ loáº¡i chá»‰ má»¥c nÃ y. Tá»« <code>B-Tree</code> Ä‘Æ°á»£c sá»­ dá»¥ng trong MySQL trong cÃ¡c cÃ¢u lá»‡nh&nbsp;<code>CREATE TABLE</code>&nbsp;hoáº·c cÃ¡c cÃ¢u lá»‡nh khÃ¡c, nhÆ°ng thá»±c táº¿ cÃ¡c storage engine khÃ¡c nhau cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c cáº¥u trÃºc dá»¯ liá»‡u khÃ¡c nhau, vÃ­ dá»¥ nhÆ° InnoDB sá»­ dá»¥ng <code>B+Tree</code>.</p>
<p>Trong B+Tree, chá»¯ <code>B</code> Ä‘á» cáº­p Ä‘áº¿n tá»« <code>balance</code>, cÃ³ nghÄ©a lÃ  cÃ¢n báº±ng. Cáº§n lÆ°u Ã½ ráº±ng chá»‰ má»¥c B+Tree khÃ´ng thá»ƒ tÃ¬m ra hÃ ng cá»¥ thá»ƒ cho má»™t giÃ¡ trá»‹ khÃ³a Ä‘Ã£ cho, nÃ³ chá»‰ tÃ¬m ra trang chá»©a dÃ²ng dá»¯ liá»‡u Ä‘Æ°á»£c tÃ¬m kiáº¿m vÃ  sau Ä‘Ã³ cÆ¡ sá»Ÿ dá»¯ liá»‡u sáº½ Ä‘á»c trang vÃ o bá»™ nhá»› vÃ  tiáº¿p tá»¥c tÃ¬m kiáº¿m trong bá»™ nhá»› Ä‘á»ƒ cuá»‘i cÃ¹ng thu Ä‘Æ°á»£c dá»¯ liá»‡u mong muá»‘n.</p>
<h4>CÃ¢y tÃ¬m kiáº¿m nhá»‹ phÃ¢n</h4>
<p>CÃ¢y tÃ¬m kiáº¿m nhá»‹ phÃ¢n cÃ³ Ä‘áº·c Ä‘iá»ƒm lÃ  má»—i nÃºt con trÃ¡i nhá» hÆ¡n nÃºt cha vÃ  nÃºt cha nhá» hÆ¡n nÃºt con pháº£i. Äá»™ phá»©c táº¡p thá»i gian truy váº¥n cá»§a nÃ³ lÃ  $$O(log(N))$$.</p>
<p>Tuy nhiÃªn, Ä‘á»ƒ duy trÃ¬ Ä‘á»™ phá»©c táº¡p truy váº¥n $$O(log(N))$$, báº¡n cáº§n Ä‘áº£m báº£o ráº±ng cÃ¢y nÃ y lÃ  má»™t cÃ¢y tÃ¬m kiáº¿m nhá»‹ phÃ¢n cÃ¢n báº±ng. Äá»ƒ Ä‘áº£m báº£o Ä‘iá»u nÃ y, Ä‘á»™ phá»©c táº¡p thá»i gian cáº­p nháº­t cÅ©ng lÃ  $$O(log(N))$$.</p>
<p>Khi dá»¯ liá»‡u trong cÆ¡ sá»Ÿ dá»¯ liá»‡u tÄƒng lÃªn, kÃ­ch thÆ°á»›c chá»‰ má»¥c cÅ©ng tÄƒng lÃªn vÃ  khÃ´ng thá»ƒ lÆ°u trá»¯ toÃ n bá»™ chá»‰ má»¥c trong bá»™ nhá»›. Do Ä‘Ã³, chá»‰ má»¥c thÆ°á»ng Ä‘Æ°á»£c lÆ°u trá»¯ dÆ°á»›i dáº¡ng tá»‡p trÃªn Ä‘Ä©a. Trong quÃ¡ trÃ¬nh tÃ¬m kiáº¿m chá»‰ má»¥c, sáº½ cÃ³ sá»± tiÃªu tá»‘n I/O Ä‘Ä©a, so vá»›i truy cáº­p bá»™ nhá»›, tiÃªu tá»‘n I/O Ä‘Ä©a cao hÆ¡n má»™t vÃ i láº§n. HÃ£y tÆ°á»Ÿng tÆ°á»£ng xem má»™t cÃ¢y nhá»‹ phÃ¢n cÃ³ hÃ ng triá»‡u nÃºt sÃ¢u Ä‘áº¿n Ä‘Ã¢u? Náº¿u Ä‘áº·t cÃ¢y nhá»‹ phÃ¢n cÃ³ Ä‘á»™ sÃ¢u lá»›n nhÆ° váº­y lÃªn Ä‘Ä©a, má»—i láº§n Ä‘á»c má»™t nÃºt, sáº½ cáº§n má»™t láº§n Ä‘á»c I/O Ä‘Ä©a, rÃµ rÃ ng thá»i gian tÃ¬m kiáº¿m nhÆ° váº­y lÃ  khÃ´ng cháº¥p nháº­n Ä‘Æ°á»£c. Váº­y lÃ m tháº¿ nÃ o Ä‘á»ƒ giáº£m sá»‘ láº§n truy cáº­p I/O trong quÃ¡ trÃ¬nh tÃ¬m kiáº¿m?</p>
<p>Má»™t phÆ°Æ¡ng phÃ¡p hiá»‡u quáº£ lÃ  giáº£m Ä‘á»™ sÃ¢u cá»§a cÃ¢y, biáº¿n cÃ¢y nhá»‹ phÃ¢n thÃ nh cÃ¢y nhiá»u nhÃ¡nh (multiway search tree), vÃ &nbsp;<strong>B+ tree lÃ  má»™t loáº¡i cÃ¢y nhiá»u nhÃ¡nh</strong>.</p>
<h4>B+Tree</h4>
<p>B+Tree lÃ  má»™t cáº¥u trÃºc dá»¯ liá»‡u dÃ¹ng Ä‘á»ƒ táº¡o chá»‰ má»¥c, phÃ¹ há»£p cho viá»‡c tÃ¬m kiáº¿m toÃ n bá»™ khÃ³a, tÃ¬m kiáº¿m pháº¡m vi khÃ³a vÃ  tÃ¬m kiáº¿m tiá»n tá»‘ khÃ³a. Tuy nhiÃªn, tÃ¬m kiáº¿m tiá»n tá»‘ khÃ³a chá»‰ Ã¡p dá»¥ng cho viá»‡c tÃ¬m kiáº¿m tiá»n tá»‘ bÃªn trÃ¡i.</p>
<p>Äá»ƒ hiá»ƒu B+Tree, chá»‰ cáº§n hiá»ƒu hai Ä‘áº·c Ä‘iá»ƒm quan trá»ng nháº¥t cá»§a nÃ³:</p>
<ul>
<li>Thá»© nháº¥t, táº¥t cáº£ cÃ¡c khÃ³a (cÃ³ thá»ƒ hiá»ƒu lÃ  dá»¯ liá»‡u) Ä‘Æ°á»£c lÆ°u trá»¯ trong cÃ¡c nÃºt lÃ¡, cÃ¡c nÃºt khÃ´ng pháº£i lÃ¡ khÃ´ng lÆ°u trá»¯ dá»¯ liá»‡u thá»±c sá»±, táº¥t cáº£ cÃ¡c nÃºt ghi nháº­n Ä‘Æ°á»£c sáº¯p xáº¿p theo thá»© tá»± giÃ¡ trá»‹ khÃ³a vÃ  Ä‘Æ°á»£c lÆ°u trá»¯ trÃªn cÃ¹ng má»™t táº§ng nÃºt lÃ¡.</li>
<li>Thá»© hai, táº¥t cáº£ cÃ¡c nÃºt lÃ¡ Ä‘Æ°á»£c káº¿t ná»‘i báº±ng con trá». HÃ¬nh áº£nh dÆ°á»›i Ä‘Ã¢y lÃ  má»™t cÃ¢y B+ Ä‘Æ°á»£c Ä‘Æ¡n giáº£n hÃ³a.</li>
</ul>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200304235424.jpg" alt="b-tree-index" tabindex="0" loading="lazy"><figcaption>b-tree-index</figcaption></figure>
<p>Dá»±a trÃªn ná»™i dung cá»§a cÃ¡c nÃºt lÃ¡, loáº¡i chá»‰ má»¥c Ä‘Æ°á»£c chia thÃ nh chá»‰ má»¥c khÃ³a chÃ­nh vÃ  chá»‰ má»¥c khÃ´ng pháº£i khÃ³a chÃ­nh.</p>
<ul>
<li><strong>Chá»‰ má»¥c khÃ³a chÃ­nh</strong>&nbsp;(clustered index), cÃ²n Ä‘Æ°á»£c gá»i lÃ  chá»‰ má»¥c chÃ­nh, chá»‰ má»¥c cá»¥m, nÃºt lÃ¡ lÆ°u trá»¯ toÃ n bá»™ dá»¯ liá»‡u hÃ ng. VÃ¬ khÃ´ng thá»ƒ lÆ°u trá»¯ hÃ ng dá»¯ liá»‡u á»Ÿ hai vá»‹ trÃ­ khÃ¡c nhau cÃ¹ng má»™t lÃºc, nÃªn&nbsp;<strong>má»™t báº£ng chá»‰ cÃ³ thá»ƒ cÃ³ má»™t chá»‰ má»¥c khÃ³a chÃ­nh</strong>.&nbsp;<strong>Chá»‰ má»¥c khÃ³a chÃ­nh cá»§a InnoDB thá»±c táº¿ lÃ  lÆ°u trá»¯ cáº£ chá»‰ má»¥c B-Tree vÃ  hÃ ng dá»¯ liá»‡u trong cÃ¹ng má»™t cáº¥u trÃºc</strong>.</li>
<li>Chá»‰ má»¥c khÃ´ng pháº£i khÃ³a chÃ­nh (non-clustered index) lÆ°u trá»¯ giÃ¡ trá»‹ khÃ³a chÃ­nh tÆ°Æ¡ng á»©ng vá»›i khÃ³a. Trong InnoDB, chá»‰ má»¥c khÃ´ng pháº£i khÃ³a chÃ­nh cÃ²n Ä‘Æ°á»£c gá»i lÃ  chá»‰ má»¥c phá»¥ (secondary index). Dá»¯ liá»‡u Ä‘Æ°á»£c lÆ°u trá»¯ á»Ÿ má»™t vá»‹ trÃ­, chá»‰ má»¥c Ä‘Æ°á»£c lÆ°u trá»¯ á»Ÿ má»™t vá»‹ trÃ­ khÃ¡c, chá»‰ má»¥c chá»©a con trá» Ä‘áº¿n vá»‹ trÃ­ dá»¯ liá»‡u. CÃ³ thá»ƒ cÃ³ nhiá»u chá»‰ má»¥c phá»¥, tá»‘i Ä‘a 249.</li>
</ul>
<p><strong>PhÃ¢n cá»¥m (clustered) cÃ³ nghÄ©a lÃ  cÃ¡c hÃ ng dá»¯ liá»‡u vÃ  giÃ¡ trá»‹ khÃ³a liá»n ká» Ä‘Æ°á»£c lÆ°u trá»¯ cÃ¹ng nhau má»™t cÃ¡ch nhá» gá»n. Do Ä‘Ã³ viá»‡c truy cáº­p nhanh chÃ³ng</strong>. VÃ¬ khÃ´ng thá»ƒ lÆ°u trá»¯ hÃ ng dá»¯ liá»‡u trong hai vá»‹ trÃ­ khÃ¡c nhau cÃ¹ng má»™t lÃºc, nÃªn <strong>má»™t báº£ng chá»‰ cÃ³ thá»ƒ cÃ³ má»™t chá»‰ sá»‘ cá»¥m</strong>.</p>
<p><strong>Sá»± khÃ¡c biá»‡t giá»¯a truy váº¥n chá»‰ má»¥c phÃ¢n cá»¥m vÃ  truy váº¥n chá»‰ má»¥c khÃ´ng phÃ¢n cá»¥m</strong></p>
<ul>
<li>Náº¿u cÃ¢u lá»‡nh lÃ &nbsp;<code>SELECT * FROM T WHERE ID = 500</code>, tá»©c lÃ  truy váº¥n chá»‰ má»¥c phÃ¢n cá»¥m, chá»‰ cáº§n tÃ¬m kiáº¿m B+Tree cá»§a ID;</li>
<li>Náº¿u cÃ¢u lá»‡nh lÃ &nbsp;<code>SELECT * FROM T WHERE k = 5</code>, tá»©c lÃ  truy váº¥n chá»‰ má»¥c khÃ´ng phÃ¢n cá»¥m, cáº§n tÃ¬m kiáº¿m cÃ¢y chá»‰ má»¥c k trÆ°á»›c, tÃ¬m giÃ¡ trá»‹ ID lÃ  500, sau Ä‘Ã³ tÃ¬m kiáº¿m cÃ¢y chá»‰ má»¥c ID. QuÃ¡ trÃ¬nh nÃ y Ä‘Æ°á»£c gá»i lÃ &nbsp;<strong>truy váº¥n láº¡i</strong>.</li>
</ul>
<p>NghÄ©a lÃ ,&nbsp;<strong>truy váº¥n dá»±a trÃªn chá»‰ má»¥c khÃ´ng phÃ¢n cá»¥m cáº§n quÃ©t hai cÃ¢y chá»‰ má»¥c</strong>. Do Ä‘Ã³, chÃºng ta nÃªn Æ°u tiÃªn sá»­ dá»¥ng truy váº¥n khÃ³a chÃ­nh.</p>
<p><strong>RÃµ rÃ ng, Ä‘á»™ dÃ i khÃ³a chÃ­nh cÃ ng nhá» thÃ¬ nÃºt lÃ¡ chá»‰ má»¥c khÃ´ng pháº£i khÃ³a chÃ­nh cÃ ng nhá», chá»‰ má»¥c khÃ´ng phÃ¢n cá»¥m chiáº¿m Ã­t khÃ´ng gian hÆ¡n.</strong></p>
<p>KhÃ³a chÃ­nh tá»± tÄƒng lÃ  khÃ³a chÃ­nh Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trÃªn cá»™t tá»± tÄƒng, trong cÃ¢u lá»‡nh táº¡o báº£ng thÆ°á»ng Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a nhÆ° sau: <code>NOT NULL PRIMARY KEY AUTO_INCREMENT</code>. Vá» máº·t hiá»‡u suáº¥t vÃ  khÃ´ng gian lÆ°u trá»¯, khÃ³a chÃ­nh tá»± tÄƒng thÆ°á»ng lÃ  lá»±a chá»n há»£p lÃ½ hÆ¡n. CÃ³ trÆ°á»ng há»£p nÃ o phÃ¹ há»£p Ä‘á»ƒ sá»­ dá»¥ng trÆ°á»ng kinh doanh lÃ m khÃ³a chÃ­nh khÃ´ng? CÃ³. VÃ­ dá»¥, má»™t sá»‘ yÃªu cáº§u ká»‹ch báº£n kinh doanh nhÆ° sau:</p>
<ul>
<li>Chá»‰ cÃ³ má»™t chá»‰ má»¥c;</li>
<li>Chá»‰ má»¥c nÃ y pháº£i lÃ  chá»‰ má»¥c duy nháº¥t.</li>
</ul>
<p>VÃ¬ khÃ´ng cÃ³ chá»‰ má»¥c khÃ¡c, khÃ´ng cáº§n xem xÃ©t váº¥n Ä‘á» kÃ­ch thÆ°á»›c nÃºt lÃ¡ chá»‰ má»¥c khÃ´ng pháº£i khÃ³a chÃ­nh.</p>
<p>LÃºc nÃ y, chÃºng ta nÃªn Æ°u tiÃªn Ã¡p dá»¥ng nguyÃªn táº¯c "Æ°u tiÃªn sá»­ dá»¥ng truy váº¥n khÃ³a chÃ­nh", trá»±c tiáº¿p Ä‘áº·t chá»‰ má»¥c nÃ y lÃ m khÃ³a chÃ­nh, cÃ³ thá»ƒ trÃ¡nh viá»‡c má»—i láº§n truy váº¥n Ä‘á»u cáº§n tÃ¬m kiáº¿m hai cÃ¢y.</p>
<h3>Chá»‰ má»¥c toÃ n vÄƒn báº£n (Full-Text Index)</h3>
<p>MyISAM há»— trá»£ chá»‰ má»¥c toÃ n vÄƒn báº£n, Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ¬m kiáº¿m tá»« khÃ³a trong vÄƒn báº£n thay vÃ¬ so sÃ¡nh trá»±c tiáº¿p. Äiá»u kiá»‡n tÃ¬m kiáº¿m Ä‘Æ°á»£c sá»­ dá»¥ng lÃ  <code>MATCH AGAINST</code> thay vÃ¬ <code>WHERE</code> thÃ´ng thÆ°á»ng.</p>
<p>Chá»‰ má»¥c toÃ n vÄƒn báº£n thÆ°á»ng sá»­ dá»¥ng cáº¥u trÃºc dá»¯ liá»‡u chá»‰ má»¥c Ä‘áº£o ngÆ°á»£c (inverted index), nÃ³ ghi láº¡i Ã¡nh xáº¡ tá»« khÃ³a Ä‘áº¿n tÃ i liá»‡u chá»©a nÃ³.</p>
<p>InnoDB Storage Engine há»— trá»£ chá»‰ má»¥c toÃ n vÄƒn báº£n tá»« phiÃªn báº£n MySQL 5.6.4.</p>
<h3>Chá»‰ má»¥c khÃ´ng gian</h3>
<p>LÆ°u trá»¯ MyISAM há»— trá»£ chá»‰ má»¥c khÃ´ng gian (R-Tree), Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ lÆ°u trá»¯ dá»¯ liá»‡u Ä‘á»‹a lÃ½. Chá»‰ má»¥c khÃ´ng gian sáº½ tá»• chá»©c dá»¯ liá»‡u tá»« táº¥t cáº£ cÃ¡c chiá»u Ä‘á»ƒ tÃ¬m kiáº¿m hiá»‡u quáº£ báº±ng báº¥t ká»³ káº¿t há»£p nÃ o cá»§a cÃ¡c chiá»u.</p>
<p>Cáº§n sá»­ dá»¥ng cÃ¡c hÃ m liÃªn quan Ä‘áº¿n GIS Ä‘á»ƒ duy trÃ¬ dá»¯ liá»‡u.</p>
<h2>CÃ¡c loáº¡i chá»‰ má»¥c</h2>
<p>CÃ¡c há»‡ thá»‘ng cÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡ phá»• biáº¿n thÆ°á»ng há»— trá»£ cÃ¡c loáº¡i chá»‰ má»¥c sau:</p>
<h3>Chá»‰ má»¥c khÃ³a chÃ­nh (<code>PRIMARY</code>)</h3>
<p>Chá»‰ má»¥c khÃ³a chÃ­nh: ÄÃ¢y lÃ  má»™t loáº¡i chá»‰ má»¥c Ä‘áº·c biá»‡t, khÃ´ng cho phÃ©p giÃ¡ trá»‹ trá»‘ng. Má»™t báº£ng chá»‰ cÃ³ thá»ƒ cÃ³ má»™t chá»‰ má»¥c khÃ³a chÃ­nh (thá»±c táº¿ lÃ  chá»‰ má»¥c gom cá»¥m trong InnoDB) vÃ  thÆ°á»ng Ä‘Æ°á»£c táº¡o cÃ¹ng vá»›i viá»‡c táº¡o báº£ng.</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> TABLE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> `</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">table</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">` (</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">    `id`</span><span style="color:#C678DD;--shiki-dark:#C678DD"> int</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#D19A66;--shiki-dark:#D19A66">11</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#C678DD;--shiki-dark:#C678DD">NOT NULL</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> AUTO_INCREMENT,</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    ...</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    PRIMARY KEY</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> (</span><span style="color:#98C379;--shiki-dark:#98C379">`id`</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)</span></span></code></pre>
</div><h3>Chá»‰ má»¥c duy nháº¥t (<code>UNIQUE</code>)</h3>
<p>Chá»‰ má»¥c duy nháº¥t: CÃ¡c giÃ¡ trá»‹ trong cá»™t chá»‰ má»¥c pháº£i lÃ  duy nháº¥t, nhÆ°ng cho phÃ©p giÃ¡ trá»‹ trá»‘ng. Náº¿u Ä‘Ã³ lÃ  chá»‰ má»¥c káº¿t há»£p, thÃ¬ sá»± káº¿t há»£p cá»§a cÃ¡c giÃ¡ trá»‹ cá»™t pháº£i lÃ  duy nháº¥t.</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> TABLE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> `</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">table</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">` (</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    ...</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    UNIQUE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> indexName (title(</span><span style="color:#C678DD;--shiki-dark:#C678DD">length</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">))</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)</span></span></code></pre>
</div><h3>Chá»‰ má»¥c thÃ´ng thÆ°á»ng (<code>INDEX</code>)</h3>
<p>Chá»‰ má»¥c thÃ´ng thÆ°á»ng: ÄÃ¢y lÃ  loáº¡i chá»‰ má»¥c cÆ¡ báº£n, khÃ´ng cÃ³ báº¥t ká»³ rÃ ng buá»™c nÃ o.</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> TABLE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> `</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">table</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">` (</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    ...</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    INDEX</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> index_name (title(</span><span style="color:#C678DD;--shiki-dark:#C678DD">length</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">))</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)</span></span></code></pre>
</div><h3>Chá»‰ má»¥c toÃ n vÄƒn (<code>FULLTEXT</code>)</h3>
<p>Chá»‰ má»¥c toÃ n vÄƒn: Chá»§ yáº¿u Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ¬m kiáº¿m tá»« khÃ³a trong vÄƒn báº£n, thay vÃ¬ so sÃ¡nh trá»±c tiáº¿p vá»›i cÃ¡c giÃ¡ trá»‹ trong chá»‰ má»¥c.</p>
<p>Chá»‰ má»¥c toÃ n vÄƒn khÃ¡c biá»‡t ráº¥t nhiá»u so vá»›i cÃ¡c loáº¡i chá»‰ má»¥c khÃ¡c, nÃ³ giá»‘ng nhÆ° má»™t cÃ´ng cá»¥ tÃ¬m kiáº¿m hÆ¡n lÃ  má»™t tham sá»‘ so sÃ¡nh trong cÃ¢u lá»‡nh WHERE. Chá»‰ má»¥c toÃ n vÄƒn Ä‘Æ°á»£c sá»­ dá»¥ng káº¿t há»£p vá»›i phÃ©p toÃ¡n <code>match against</code>, thay vÃ¬ sá»­ dá»¥ng cÃ¢u lá»‡nh WHERE thÃ´ng thÆ°á»ng kÃ¨m theo LIKE. Chá»‰ má»¥c toÃ n vÄƒn cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng trong <code>CREATE TABLE</code>, <code>ALTER TABLE</code>, <code>CREATE INDEX</code>, nhÆ°ng hiá»‡n táº¡i chá»‰ cÃ³ thá»ƒ táº¡o chá»‰ má»¥c toÃ n vÄƒn trÃªn cÃ¡c cá»™t kiá»ƒu <code>char</code>, <code>varchar</code> vÃ  <code>text</code>. ÄÃ¡ng lÆ°u Ã½ lÃ , khi cÃ³ sá»‘ lÆ°á»£ng dá»¯ liá»‡u lá»›n, viá»‡c Ä‘Æ°a dá»¯ liá»‡u vÃ o má»™t báº£ng khÃ´ng cÃ³ chá»‰ má»¥c toÃ n cá»¥c trÆ°á»›c, sau Ä‘Ã³ táº¡o chá»‰ má»¥c toÃ n vÄƒn báº±ng cÃ¡ch sá»­ dá»¥ng <code>CREATE INDEX</code> sáº½ nhanh hÆ¡n viá»‡c táº¡o chá»‰ má»¥c toÃ n vÄƒn trÆ°á»›c khi Ä‘Æ°a dá»¯ liá»‡u vÃ o.</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> TABLE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> `</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">table</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">` (</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">    `content`</span><span style="color:#C678DD;--shiki-dark:#C678DD"> text</span><span style="color:#C678DD;--shiki-dark:#C678DD"> CHARACTER</span><span style="color:#C678DD;--shiki-dark:#C678DD"> NULL</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    ...</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    FULLTEXT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> (content)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)</span></span></code></pre>
</div><h3>Chá»‰ má»¥c káº¿t há»£p</h3>
<p>Chá»‰ má»¥c káº¿t há»£p: ÄÃ¢y lÃ  chá»‰ má»¥c Ä‘Æ°á»£c táº¡o trÃªn nhiá»u trÆ°á»ng, chá»‰ khi trÆ°á»ng Ä‘áº§u tiÃªn trong Ä‘iá»u kiá»‡n truy váº¥n sá»­ dá»¥ng chá»‰ má»¥c, chá»‰ má»¥c má»›i Ä‘Æ°á»£c sá»­ dá»¥ng. Khi sá»­ dá»¥ng chá»‰ má»¥c káº¿t há»£p, cáº§n tuÃ¢n theo táº­p há»£p tiá»n tá»‘ tá»‘i Ä‘a bÃªn trÃ¡i.</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> TABLE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> `</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">table</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">` (</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    ...</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    INDEX</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> index_name (title(</span><span style="color:#C678DD;--shiki-dark:#C678DD">length</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">), title(</span><span style="color:#C678DD;--shiki-dark:#C678DD">length</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">), ...)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)</span></span></code></pre>
</div><h2>Chiáº¿n lÆ°á»£c láº­p chá»‰ má»¥c</h2>
<p>Giáº£ sá»­ cÃ³ báº£ng sau:</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> TABLE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> `</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">t</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">` (</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">  `id`</span><span style="color:#C678DD;--shiki-dark:#C678DD"> int</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#D19A66;--shiki-dark:#D19A66">11</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#C678DD;--shiki-dark:#C678DD">NOT NULL</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">  `city`</span><span style="color:#C678DD;--shiki-dark:#C678DD"> varchar</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#D19A66;--shiki-dark:#D19A66">16</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#C678DD;--shiki-dark:#C678DD">NOT NULL</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">  `name`</span><span style="color:#C678DD;--shiki-dark:#C678DD"> varchar</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#D19A66;--shiki-dark:#D19A66">16</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#C678DD;--shiki-dark:#C678DD">NOT NULL</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">  `age`</span><span style="color:#C678DD;--shiki-dark:#C678DD"> int</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#D19A66;--shiki-dark:#D19A66">11</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#C678DD;--shiki-dark:#C678DD">NOT NULL</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">  `addr`</span><span style="color:#C678DD;--shiki-dark:#C678DD"> varchar</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#D19A66;--shiki-dark:#D19A66">128</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#C678DD;--shiki-dark:#C678DD">DEFAULT</span><span style="color:#C678DD;--shiki-dark:#C678DD"> NULL</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">  PRIMARY KEY</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> (</span><span style="color:#98C379;--shiki-dark:#98C379">`id`</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">),</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">  KEY</span><span style="color:#98C379;--shiki-dark:#98C379"> `city`</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> (</span><span style="color:#98C379;--shiki-dark:#98C379">`city`</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) ENGINE</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">InnoDB;</span></span></code></pre>
</div><h3>NguyÃªn táº¯c cÆ¡ báº£n cá»§a láº­p chá»‰ má»¥c</h3>
<ul>
<li><strong>KhÃ´ng pháº£i cÃ ng nhiá»u chá»‰ má»¥c cÃ ng tá»‘t, khÃ´ng nÃªn táº¡o chá»‰ má»¥c cho táº¥t cáº£ cÃ¡c cá»™t</strong>. Cáº§n xem xÃ©t chi phÃ­ duy trÃ¬ chá»‰ má»¥c, khÃ´ng gian chiáº¿m dá»¥ng vÃ  chi phÃ­ cá»§a viá»‡c truy váº¥n láº¡i dá»¯ liá»‡u. Chá»‰ táº¡o chá»‰ má»¥c khi cáº§n thiáº¿t vÃ  cáº§n Ä‘áº£m báº£o chá»‰ má»¥c nháº¹ nhÃ ng. Khi táº¡o chá»‰ má»¥c káº¿t há»£p nhiá»u cá»™t, cáº§n cá»‘ gáº¯ng sá»­ dá»¥ng chá»‰ má»¥c Ä‘á»ƒ thá»±c hiá»‡n truy váº¥n dá»¯ liá»‡u vÃ  giáº£m thiá»ƒu chi phÃ­ truy váº¥n láº¡i dá»¯ liá»‡u.</li>
<li><strong>TrÃ¡nh táº¡o chá»‰ má»¥c trÃ¹ng láº·p vÃ  khÃ´ng cáº§n thiáº¿t</strong>.</li>
<li><strong>Xem xÃ©t xÃ³a cÃ¡c chá»‰ má»¥c khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng</strong>.</li>
<li><strong>Má»Ÿ rá»™ng chá»‰ má»¥c hiá»‡n cÃ³ thay vÃ¬ táº¡o má»›i chá»‰ má»¥c</strong>.</li>
<li><strong>CÃ¡c cá»™t Ä‘Æ°á»£c sá»­ dá»¥ng thÆ°á»ng xuyÃªn lÃ m Ä‘iá»u kiá»‡n lá»c nÃªn xem xÃ©t viá»‡c táº¡o chá»‰ má»¥c</strong>.</li>
</ul>
<h3>Cá»™t Ä‘á»™c láº­p</h3>
<p><strong>"Cá»™t Ä‘á»™c láº­p" cÃ³ nghÄ©a lÃ  cÃ¡c cá»™t Ä‘Æ°á»£c láº­p chá»‰ má»¥c khÃ´ng thá»ƒ lÃ  má»™t pháº§n cá»§a biá»ƒu thá»©c, chÃºng cÅ©ng khÃ´ng thá»ƒ lÃ  tham sá»‘ cá»§a hÃ m</strong>&nbsp;.</p>
<p><strong>Viá»‡c thá»±c hiá»‡n cÃ¡c phÃ©p toÃ¡n trÃªn trÆ°á»ng chá»‰ má»¥c cÃ³ thá»ƒ gÃ¢y thiá»‡t háº¡i Ä‘áº¿n tÃ­nh tuáº§n tá»± cá»§a giÃ¡ trá»‹ chá»‰ má»¥c, do Ä‘Ã³ trÃ¬nh tá»‘i Æ°u quyáº¿t Ä‘á»‹nh tá»« chá»‘i sá»­ dá»¥ng chá»©c nÄƒng tÃ¬m kiáº¿m cÃ¢y.</strong></p>
<p>Náº¿u cÃ¡c cá»™t trong truy váº¥n khÃ´ng pháº£i lÃ  cÃ¡c cá»™t Ä‘á»™c láº­p, cÆ¡ sá»Ÿ dá»¯ liá»‡u sáº½ khÃ´ng sá»­ dá»¥ng chá»‰ má»¥c.</p>
<p>âŒ VÃ­ dá»¥ khÃ´ng Ä‘Ãºng:</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SELECT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> actor_id </span><span style="color:#C678DD;--shiki-dark:#C678DD">FROM</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> actor </span><span style="color:#C678DD;--shiki-dark:#C678DD">WHERE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> actor_id + </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SELECT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> ... </span><span style="color:#C678DD;--shiki-dark:#C678DD">WHERE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> TO_DAYS(current_date) - TO_DAYS(date_col) </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&lt;=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span></code></pre>
</div><h3>Chá»‰ má»¥c che phá»§</h3>
<p><strong>Chá»‰ má»¥c che phá»§ lÃ  chá»‰ má»¥c mÃ  thÃ´ng tin trÃªn chá»‰ má»¥c Ä‘á»§ Ä‘á»ƒ Ä‘Ã¡p á»©ng yÃªu cáº§u truy váº¥n, khÃ´ng cáº§n truy váº¥n láº¡i dá»¯ liá»‡u</strong>.</p>
<p>ã€VÃ­ dá»¥ã€‘Truy váº¥n pháº¡m vi</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">create</span><span style="color:#C678DD;--shiki-dark:#C678DD"> table</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> T</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> (</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">ID </span><span style="color:#C678DD;--shiki-dark:#C678DD">int</span><span style="color:#C678DD;--shiki-dark:#C678DD"> primary key</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">k </span><span style="color:#C678DD;--shiki-dark:#C678DD">int</span><span style="color:#C678DD;--shiki-dark:#C678DD"> NOT NULL</span><span style="color:#C678DD;--shiki-dark:#C678DD"> DEFAULT</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">s </span><span style="color:#C678DD;--shiki-dark:#C678DD">varchar</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#D19A66;--shiki-dark:#D19A66">16</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#C678DD;--shiki-dark:#C678DD">NOT NULL</span><span style="color:#C678DD;--shiki-dark:#C678DD"> DEFAULT</span><span style="color:#98C379;--shiki-dark:#98C379"> ''</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">index</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> k(k))</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">engine</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">InnoDB;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">insert into</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> T </span><span style="color:#C678DD;--shiki-dark:#C678DD">values</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#D19A66;--shiki-dark:#D19A66">100</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">'aa'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">),(</span><span style="color:#D19A66;--shiki-dark:#D19A66">200</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#D19A66;--shiki-dark:#D19A66">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#98C379;--shiki-dark:#98C379">'bb'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">),(</span><span style="color:#D19A66;--shiki-dark:#D19A66">300</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#D19A66;--shiki-dark:#D19A66">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#98C379;--shiki-dark:#98C379">'cc'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">),(</span><span style="color:#D19A66;--shiki-dark:#D19A66">500</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#D19A66;--shiki-dark:#D19A66">5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#98C379;--shiki-dark:#98C379">'ee'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">),(</span><span style="color:#D19A66;--shiki-dark:#D19A66">600</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#D19A66;--shiki-dark:#D19A66">6</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#98C379;--shiki-dark:#98C379">'ff'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">),(</span><span style="color:#D19A66;--shiki-dark:#D19A66">700</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#D19A66;--shiki-dark:#D19A66">7</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#98C379;--shiki-dark:#98C379">'gg'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">select</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> * </span><span style="color:#C678DD;--shiki-dark:#C678DD">from</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> T </span><span style="color:#C678DD;--shiki-dark:#C678DD">where</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> k </span><span style="color:#C678DD;--shiki-dark:#C678DD">between</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 3</span><span style="color:#C678DD;--shiki-dark:#C678DD"> and</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 5</span></span></code></pre>
</div><p>Cáº§n thá»±c hiá»‡n bao nhiÃªu láº§n tÃ¬m kiáº¿m cÃ¢y, quÃ©t qua bao nhiÃªu hÃ ng?</p>
<ol>
<li>TÃ¬m kiáº¿m báº£n ghi vá»›i k=3 trÃªn cÃ¢y chá»‰ má»¥c k, láº¥y ID = 300;</li>
<li>TÃ¬m kiáº¿m báº£n ghi vá»›i ID = 300 trÃªn cÃ¢y chá»‰ má»¥c ID, láº¥y R3;</li>
<li>TÃ¬m kiáº¿m báº£n ghi vá»›i k=5 trÃªn cÃ¢y chá»‰ má»¥c k, láº¥y ID = 500;</li>
<li>TÃ¬m kiáº¿m báº£n ghi vá»›i ID = 500 trÃªn cÃ¢y chá»‰ má»¥c ID, láº¥y R4;</li>
<li>TÃ¬m kiáº¿m báº£n ghi vá»›i k=6 trÃªn cÃ¢y chá»‰ má»¥c k, khÃ´ng thá»a mÃ£n Ä‘iá»u kiá»‡n, káº¿t thÃºc vÃ²ng láº·p.</li>
</ol>
<p>Trong quÃ¡ trÃ¬nh nÃ y, quÃ¡ trÃ¬nh tÃ¬m kiáº¿m láº¡i trÃªn cÃ¢y chá»‰ má»¥c chÃ­nh Ä‘Æ°á»£c gá»i lÃ  truy váº¥n láº¡i. CÃ³ thá»ƒ tháº¥y, quÃ¡ trÃ¬nh truy váº¥n nÃ y Ä‘á»c 3 báº£n ghi trÃªn cÃ¢y chá»‰ má»¥c k (bÆ°á»›c 1, 3 vÃ  5) vÃ  truy váº¥n láº¡i hai láº§n (bÆ°á»›c 2 vÃ  4).</p>
<p>Náº¿u cÃ¢u lá»‡nh thá»±c hiá»‡n lÃ  select ID from T where k between 3 and 5, chá»‰ cáº§n láº¥y giÃ¡ trá»‹ ID, vÃ  giÃ¡ trá»‹ ID Ä‘Ã£ cÃ³ trÃªn cÃ¢y chá»‰ má»¥c k, do Ä‘Ã³ cÃ³ thá»ƒ tráº£ káº¿t quáº£ truy váº¥n trá»±c tiáº¿p mÃ  khÃ´ng cáº§n truy váº¥n láº¡i. Chá»‰ má»¥c chá»©a táº¥t cáº£ cÃ¡c giÃ¡ trá»‹ cáº§n truy váº¥n, Ä‘Æ°á»£c gá»i lÃ  chá»‰ má»¥c che phá»§.</p>
<p><strong>Do chá»‰ má»¥c che phá»§ giáº£m sá»‘ láº§n tÃ¬m kiáº¿m cÃ¢y, Ä‘Ã¡ng ká»ƒ cáº£i thiá»‡n hiá»‡u suáº¥t truy váº¥n, nÃªn sá»­ dá»¥ng chá»‰ má»¥c che phá»§ lÃ  má»™t biá»‡n phÃ¡p tá»‘i Æ°u hiá»‡u suáº¥t phá»• biáº¿n</strong>.</p>
<h3>Sá»­ dá»¥ng chá»‰ má»¥c Ä‘á»ƒ sáº¯p xáº¿p</h3>
<p>MySQL cÃ³ hai cÃ¡ch Ä‘á»ƒ táº¡o káº¿t quáº£ sáº¯p xáº¿p: thÃ´ng qua thao tÃ¡c sáº¯p xáº¿p hoáº·c quÃ©t theo thá»© tá»± chá»‰ má»¥c.</p>
<p><strong>Chá»‰ má»¥c tá»‘t lÃ  chá»‰ má»¥c cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ sáº¯p xáº¿p vÃ  tÃ¬m kiáº¿m hÃ ng</strong>. Äiá»u nÃ y cho phÃ©p káº¿t quáº£ Ä‘Æ°á»£c truy xuáº¥t trá»±c tiáº¿p tá»« chá»‰ má»¥c mÃ  khÃ´ng cáº§n sáº¯p xáº¿p láº¡i.</p>
<p>Khi sá»­ dá»¥ng chá»‰ má»¥c Ä‘á»ƒ sáº¯p xáº¿p, cáº§n Ä‘áº£m báº£o chá»‰ má»¥c Ä‘Æ°á»£c chá»n Ä‘á»§ Ä‘á»ƒ thá»±c hiá»‡n truy váº¥n dá»¯ liá»‡u vÃ  giáº£m thiá»ƒu chi phÃ­ truy váº¥n láº¡i dá»¯ liá»‡u.</p>
<p>QuÃ¡ trÃ¬nh thá»±c hiá»‡n truy váº¥n sáº½ nhÆ° sau:</p>
<ol>
<li>TÃ¬m kiáº¿m báº£n ghi Ä‘áº§u tiÃªn trong chá»‰ má»¥c (city, name, age) thá»a mÃ£n Ä‘iá»u kiá»‡n city='HÃ  Ná»™i' vÃ  láº¥y giÃ¡ trá»‹ city, name vÃ  age lÃ m má»™t pháº§n cá»§a káº¿t quáº£ trá»±c tiáº¿p tráº£ vá»;</li>
<li>Láº¥y báº£n ghi tiáº¿p theo tá»« chá»‰ má»¥c (city, name, age) vÃ  láº¥y giÃ¡ trá»‹ city, name vÃ  age lÃ m má»™t pháº§n cá»§a káº¿t quáº£ trá»±c tiáº¿p tráº£ vá»;</li>
<li>Láº·p láº¡i bÆ°á»›c 2 cho Ä‘áº¿n khi tÃ¬m tháº¥y báº£n ghi thá»© 1000 hoáº·c khÃ´ng thá»a mÃ£n Ä‘iá»u kiá»‡n city='HÃ  Ná»™i' thÃ¬ káº¿t thÃºc vÃ²ng láº·p.</li>
</ol>
<h3>Chá»‰ má»¥c tiá»n tá»‘</h3>
<p>ÄÃ´i khi cáº§n táº¡o chá»‰ má»¥c cho cÃ¡c cá»™t cÃ³ Ä‘á»™ dÃ i lá»›n, Ä‘iá»u nÃ y sáº½ lÃ m cho chá»‰ má»¥c trá»Ÿ nÃªn lá»›n vÃ  cháº­m.</p>
<p>Trong trÆ°á»ng há»£p nÃ y, cÃ³ thá»ƒ sá»­ dá»¥ng chá»‰ má»¥c tiá»n tá»‘, chá»‰ lÆ°u trá»¯ má»™t pháº§n Ä‘áº§u cá»§a chuá»—i, Ä‘iá»u nÃ y cÃ³ thá»ƒ <strong>tiáº¿t kiá»‡m khÃ´ng gian chá»‰ má»¥c Ä‘Ã¡ng ká»ƒ vÃ  cáº£i thiá»‡n hiá»‡u suáº¥t chá»‰ má»¥c</strong>. Tuy nhiÃªn, Ä‘iá»u nÃ y cÅ©ng <strong>giáº£m tÃ­nh chá»n lá»c cá»§a chá»‰ má»¥c</strong>. Äá»‘i vá»›i cÃ¡c cá»™t vÄƒn báº£n nhÆ° <code>BLOB</code>/<code>TEXT</code>/<code>VARCHAR</code> khÃ´ng thá»ƒ táº¡o chá»‰ má»¥c Ä‘áº§y Ä‘á»§, vÃ¬ háº§u háº¿t cÃ¡c cÆ¡ sá»Ÿ dá»¯ liá»‡u khÃ´ng cho phÃ©p táº¡o chá»‰ má»¥c Ä‘áº§y Ä‘á»§ cho cÃ¡c cá»™t nÃ y.</p>
<p><strong>TÃ­nh chá»n lá»c cá»§a chá»‰ má»¥c</strong> lÃ  tá»· lá»‡ giá»¯a cÃ¡c giÃ¡ trá»‹ chá»‰ má»¥c khÃ´ng trÃ¹ng nhau vÃ  tá»•ng sá»‘ báº£n ghi trong báº£ng dá»¯ liá»‡u. GiÃ¡ trá»‹ tá»‘i Ä‘a lÃ  1, khi Ä‘Ã³ má»—i báº£n ghi cÃ³ má»™t chá»‰ má»¥c duy nháº¥t tÆ°Æ¡ng á»©ng. Äá»™ chá»n lá»c cÃ ng cao, hiá»‡u suáº¥t truy váº¥n cÅ©ng cÃ ng cao. Náº¿u cÃ³ nhiá»u chá»‰ má»¥c tiá»n tá»‘ khá»›p vá»›i Ä‘iá»u kiá»‡n, ta pháº£i quÃ©t tá»«ng cÃ¡i cho Ä‘áº¿n khi tÃ¬m Ä‘Æ°á»£c báº£n ghi chÃ­nh xÃ¡c cuá»‘i cÃ¹ng.</p>
<p><strong>Sá»­ dá»¥ng chá»‰ má»¥c tiá»n tá»‘ vÃ  xÃ¡c Ä‘á»‹nh Ä‘á»™ dÃ i, báº¡n cÃ³ thá»ƒ tiáº¿t kiá»‡m khÃ´ng gian mÃ  khÃ´ng cáº§n tÄƒng thÃªm quÃ¡ nhiá»u chi phÃ­ truy váº¥n.</strong></p>
<p>Lá»±a chá»n Ä‘á»™ dÃ i chá»‰ má»¥c tiá»n tá»‘ phÃ¹ há»£p lÃ m tháº¿ nÃ o?</p>
<p>CÃ³ thá»ƒ sá»­ dá»¥ng cÃ¢u lá»‡nh sau Ä‘á»ƒ tÃ­nh toÃ¡n sá»‘ lÆ°á»£ng giÃ¡ trá»‹ khÃ¡c nhau trÃªn cá»™t:</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">select</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> count</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#C678DD;--shiki-dark:#C678DD">distinct</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> email) </span><span style="color:#C678DD;--shiki-dark:#C678DD">as</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> L </span><span style="color:#C678DD;--shiki-dark:#C678DD">from</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> SUser;</span></span></code></pre>
</div><p>Sau Ä‘Ã³, láº§n lÆ°á»£t chá»n cÃ¡c Ä‘á»™ dÃ i tiá»n tá»‘ khÃ¡c nhau Ä‘á»ƒ xem giÃ¡ trá»‹ nÃ y, vÃ­ dá»¥: chÃºng ta muá»‘n xem tiá»n tá»‘ tá»« 4 Ä‘áº¿n 7 kÃ½ tá»±, cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¢u lá»‡nh sau:</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">select</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2">  count</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#C678DD;--shiki-dark:#C678DD">distinct</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> left</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(email,</span><span style="color:#D19A66;--shiki-dark:#D19A66">4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)ï¼‰</span><span style="color:#C678DD;--shiki-dark:#C678DD">as</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> L4,</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2">  count</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#C678DD;--shiki-dark:#C678DD">distinct</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> left</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(email,</span><span style="color:#D19A66;--shiki-dark:#D19A66">5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)ï¼‰</span><span style="color:#C678DD;--shiki-dark:#C678DD">as</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> L5,</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2">  count</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#C678DD;--shiki-dark:#C678DD">distinct</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> left</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(email,</span><span style="color:#D19A66;--shiki-dark:#D19A66">6</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)ï¼‰</span><span style="color:#C678DD;--shiki-dark:#C678DD">as</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> L6,</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2">  count</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#C678DD;--shiki-dark:#C678DD">distinct</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> left</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(email,</span><span style="color:#D19A66;--shiki-dark:#D19A66">7</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)ï¼‰</span><span style="color:#C678DD;--shiki-dark:#C678DD">as</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> L7,</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">from</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> SUser;</span></span></code></pre>
</div><p>Táº¥t nhiÃªn, <strong>sá»­ dá»¥ng chá»‰ má»¥c tiá»n tá»‘ cÃ³ thá»ƒ lÃ m giáº£m Ä‘á»™ phÃ¢n biá»‡t</strong>, vÃ¬ váº­y báº¡n cáº§n thiáº¿t láº­p trÆ°á»›c tá»· lá»‡ cháº¥p nháº­n Ä‘Æ°á»£c cá»§a sá»± giáº£m nÃ y, vÃ­ dá»¥ nhÆ° 5%. Sau Ä‘Ã³, trong cÃ¡c káº¿t quáº£ tráº£ vá» tá»« L4~L7, hÃ£y tÃ¬m cÃ¡c giÃ¡ trá»‹ khÃ´ng nhá» hÆ¡n L * 95%, giáº£ sá»­ á»Ÿ Ä‘Ã¢y cáº£ L6 vÃ  L7 Ä‘á»u thá»a mÃ£n Ä‘iá»u kiá»‡n nÃ y, báº¡n cÃ³ thá»ƒ chá»n chiá»u dÃ i tiá»n tá»‘ lÃ  6.</p>
<p>NgoÃ i ra, <strong><code>ORDER BY</code> khÃ´ng thá»ƒ sá»­ dá»¥ng chá»‰ má»¥c tiá»n tá»‘, khÃ´ng thá»ƒ sá»­ dá»¥ng chá»‰ má»¥c tiá»n tá»‘ lÃ m chá»‰ má»¥c che phá»§</strong>.</p>
<h3>NguyÃªn táº¯c khá»›p trÆ°á»›c tá»‘i Ä‘a</h3>
<p>KhÃ´ng chá»‰ lÃ  toÃ n bá»™ Ä‘á»‹nh nghÄ©a chá»‰ má»¥c, chá»‰ cáº§n Ä‘Ã¡p á»©ng khá»›p trÆ°á»›c tá»‘i Ä‘a, chá»‰ má»¥c cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÄƒng tá»‘c tÃ¬m kiáº¿m. Khá»›p trÆ°á»›c tá»‘i Ä‘a cÃ³ thá»ƒ lÃ  N cá»™t Ä‘áº§u tiÃªn cá»§a chá»‰ má»¥c káº¿t há»£p hoáº·c M kÃ½ tá»± Ä‘áº§u tiÃªn cá»§a chá»‰ má»¥c chuá»—i.</p>
<p>MySQL sáº½ tiáº¿p tá»¥c khá»›p tá»« trÃ¡i sang pháº£i cho Ä‘áº¿n khi gáº·p cÃ¡c truy váº¥n pháº¡m vi (<code>&gt;</code>,<code>&lt;</code>,<code>BETWEEN</code>,<code>LIKE</code>).</p>
<ul>
<li>Chá»‰ má»¥c cÃ³ thá»ƒ Ä‘Æ¡n giáº£n nhÆ° má»™t cá»™t (a) hoáº·c phá»©c táº¡p nhÆ° nhiá»u cá»™t (a, b, c, d), tá»©c lÃ  chá»‰ má»¥c káº¿t há»£p.</li>
<li>Náº¿u Ä‘Ã³ lÃ  chá»‰ má»¥c káº¿t há»£p, thÃ¬ khÃ³a cÅ©ng bao gá»“m nhiá»u cá»™t, Ä‘á»“ng thá»i, chá»‰ má»¥c chá»‰ cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ¬m kiáº¿m khÃ³a cÃ³ sáºµn (báº±ng nhau), khi gáº·p truy váº¥n pháº¡m vi (<code>&gt;</code>,<code>&lt;</code>,<code>BETWEEN</code>,<code>LIKE</code>), nÃ³ sáº½ khÃ´ng thá»ƒ khá»›p tiáº¿p theo, sau Ä‘Ã³ rÆ¡i vÃ o tÃ¬m kiáº¿m tuyáº¿n tÃ­nh.</li>
<li>Do Ä‘Ã³, <strong>thá»© tá»± cá»™t quyáº¿t Ä‘á»‹nh sá»‘ cá»™t cÃ³ thá»ƒ khá»›p Ä‘Æ°á»£c</strong>.</li>
</ul>
<p><strong>KhÃ´ng nÃªn táº¡o chá»‰ má»¥c Ä‘á»™c láº­p cho má»—i cá»™t</strong>.</p>
<p><strong>HÃ£y Ä‘áº·t cá»™t cÃ³ kháº£ nÄƒng chá»n lá»c cao hoáº·c cÆ¡ sá»Ÿ sá»‘ lÆ°á»£ng lá»›n á»Ÿ Ä‘áº§u danh sÃ¡ch cÃ¡c cá»™t káº¿t há»£p</strong>. Tuy nhiÃªn, Ä‘Ã´i khi cÅ©ng cáº§n xem xÃ©t cÃ¡c yáº¿u tá»‘ nhÆ° sáº¯p xáº¿p, nhÃ³m vÃ  Ä‘iá»u kiá»‡n pháº¡m vi trong má»‡nh Ä‘á» <code>WHERE</code>, nhá»¯ng yáº¿u tá»‘ nÃ y cÅ©ng áº£nh hÆ°á»Ÿng Ä‘Ã¡ng ká»ƒ Ä‘áº¿n hiá»‡u suáº¥t truy váº¥n.</p>
<p>VÃ­ dá»¥: <code>a = 1 and b = 2 and c &gt; 3 and d = 4</code>ï¼Œnáº¿u táº¡o chá»‰ má»¥c theo thá»© tá»± (a,b,c,d)ï¼ŒthÃ¬ d sáº½ khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng chá»‰ má»¥c. Náº¿u táº¡o chá»‰ má»¥c theo thá»© tá»± (a,b,d,c)ï¼ŒthÃ¬ cÅ©ng cÃ³ thá»ƒ sá»­ dá»¥ng chá»‰ má»¥c cho táº¥t cáº£ cÃ¡c cá»™t. Thá»© tá»± a,b,d cÃ³ thá»ƒ Ä‘Æ°á»£c sáº¯p xáº¿p theo báº¥t ká»³ cÃ¡ch nÃ o.</p>
<p>HÃ£y Ä‘áº·t cá»™t chá»‰ má»¥c cÃ³ tÃ­nh chá»n lá»c cao nháº¥t á»Ÿ phÃ­a trÆ°á»›c, tÃ­nh chá»n lá»c cá»§a chá»‰ má»¥c Ä‘Æ°á»£c hiá»ƒu lÃ  tá»· lá»‡ giá»¯a giÃ¡ trá»‹ chá»‰ má»¥c khÃ´ng trÃ¹ng vÃ  tá»•ng sá»‘ báº£n ghi. GiÃ¡ trá»‹ tá»‘i Ä‘a lÃ  1, khi Ä‘Ã³ má»—i báº£n ghi sáº½ cÃ³ duy nháº¥t má»™t chá»‰ má»¥c tÆ°Æ¡ng á»©ng. Äá»™ chá»n lá»c cÃ ng cao thÃ¬ hiá»‡u suáº¥t truy váº¥n cÅ©ng cÃ ng cao.</p>
<p>VÃ­ dá»¥ nhÆ° káº¿t quáº£ hiá»ƒn thá»‹ dÆ°á»›i Ä‘Ã¢y, tÃ­nh chá»n lá»c cá»§a customer_id cÃ³ má»©c Ä‘á»™ Æ°u tiÃªn cao hÆ¡n so vá»›i staff_id, do Ä‘Ã³ tá»‘t nháº¥t lÃ  Ä‘á»ƒ cá»™t customer_id Ä‘Æ°á»£c Ä‘áº·t trÆ°á»›c trong chá»‰ má»¥c káº¿t há»£p.</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SELECT</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> COUNT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#C678DD;--shiki-dark:#C678DD">DISTINCT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> staff_id)/</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">COUNT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(*) </span><span style="color:#C678DD;--shiki-dark:#C678DD">AS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> staff_id_selectivity,</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2">COUNT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#C678DD;--shiki-dark:#C678DD">DISTINCT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> customer_id)/</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">COUNT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(*) </span><span style="color:#C678DD;--shiki-dark:#C678DD">AS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> customer_id_selectivity,</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2">COUNT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(*)</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">FROM</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> payment;</span></span></code></pre>
</div><div class="language-batch" data-ext="batch" data-title="batch"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">   staff_id_selectivity: 0.0001</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">customer_id_selectivity: 0.0373</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">               COUNT(*): </span><span style="color:#D19A66;--shiki-dark:#D19A66">16049</span></span></code></pre>
</div><h3>PhÃ©p = vÃ  in cÃ³ thá»ƒ khÃ´ng tuÃ¢n theo thá»© tá»±</h3>
<p><strong>KhÃ´ng cáº§n quan tÃ¢m Ä‘áº¿n thá»© tá»± cá»§a <code>=</code> vÃ  <code>IN</code></strong>ï¼ŒMySQL sáº½ tá»± Ä‘á»™ng tá»‘i Æ°u thá»© tá»± cá»§a cÃ¡c Ä‘iá»u kiá»‡n nÃ y Ä‘á»ƒ khá»›p vá»›i sá»‘ lÆ°á»£ng cá»™t chá»‰ má»¥c cÃ ng nhiá»u cÃ ng tá»‘t.</p>
<p>ã€VÃ­ dá»¥ã€‘Náº¿u cÃ³ chá»‰ má»¥c (a, b, c, d), cÃ¢u truy váº¥n cÃ³ Ä‘iá»u kiá»‡n <code>c &gt; 3 and b = 2 and a = 1 and d &lt; 4</code> vÃ  <code>a = 1 and c &gt; 3 and b = 2 and d &lt; 4</code> Ä‘á»u cÃ³ thá»ƒ. MySQL sáº½ tá»± Ä‘á»™ng tá»‘i Æ°u thÃ nh <code>a = 1 and b = 2 and c &gt; 3 and d &lt; 4</code>, vÃ  tÃ¬m kiáº¿m theo thá»© tá»± a, b, c, d.</p>
<h2>Thá»±c hÃ nh tá»‘t nháº¥t cho chá»‰ má»¥c</h2>
<p>Viá»‡c táº¡o chá»‰ má»¥c khÃ´ng Ä‘áº£m báº£o sáº½ mang láº¡i hiá»‡u quáº£. VÃ­ dá»¥, khÃ´ng tuÃ¢n thá»§ chá»‰ má»¥c tiá»n tá»‘, nguyÃªn táº¯c khá»›p trÆ°á»›c tá»‘i Ä‘a, Ä‘iá»u kiá»‡n truy váº¥n liÃªn quan Ä‘áº¿n tÃ­nh toÃ¡n hÃ m, v.v. Ä‘á»u khÃ´ng thá»ƒ sá»­ dá»¥ng chá»‰ má»¥c. NgoÃ i ra, ngay cáº£ khi cÃ¢u lá»‡nh SQL thá»a mÃ£n Ä‘iá»u kiá»‡n sá»­ dá»¥ng chá»‰ má»¥c, MySQL cÅ©ng sáº½ Ä‘Ã¡nh giÃ¡ chi phÃ­ cá»§a cÃ¡c phÆ°Æ¡ng phÃ¡p truy váº¥n khÃ¡c nhau Ä‘á»ƒ quyáº¿t Ä‘á»‹nh xem cÃ³ sá»­ dá»¥ng chá»‰ má»¥c hay khÃ´ng vÃ  sá»­ dá»¥ng chá»‰ má»¥c nÃ o.</p>
<p>Do Ä‘Ã³, khi cá»‘ gáº¯ng tá»‘i Æ°u hiá»‡u suáº¥t SQL báº±ng cÃ¡ch sá»­ dá»¥ng chá»‰ má»¥c, hÃ£y cháº¯c cháº¯n xÃ¡c nháº­n xem chá»‰ má»¥c cÃ³ thá»ƒ cáº£i thiá»‡n hiá»‡u suáº¥t thá»±c táº¿ hay khÃ´ng thÃ´ng qua chiáº¿n lÆ°á»£c thá»±c thi (<code>EXPLAIN</code>) hoáº·c hiá»‡u quáº£ thá»±c táº¿. Náº¿u cÃ³ tháº¯c máº¯c vá» káº¿ hoáº¡ch thá»±c thi Ä‘Æ°á»£c cung cáº¥p bá»Ÿi <code>EXPLAIN</code>, báº¡n cÅ©ng cÃ³ thá»ƒ sá»­ dá»¥ng <code>optimizer_trace</code> Ä‘á»ƒ xem káº¿ hoáº¡ch thá»±c thi chi tiáº¿t Ä‘á»ƒ phÃ¢n tÃ­ch tiáº¿p.</p>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20220320201844.png" type="image/png"/>
    </item>
    <item>
      <title>MySQL Opearation</title>
      <link>https://vanhung4499.github.io/database/mysql/opearation.html</link>
      <guid>https://vanhung4499.github.io/database/mysql/opearation.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">MySQL Opearation</source>
      <description>MySQL Operation Náº¿u cÃ´ng ty cá»§a báº¡n cÃ³ DBA, thÃ¬ tÃ´i xin chÃºc má»«ng báº¡n, báº¡n cÃ³ thá»ƒ bá» qua viá»‡c quáº£n trá»‹ Mysql. Náº¿u cÃ´ng ty cá»§a báº¡n khÃ´ng cÃ³ DBA, hÃ£y há»c cÃ¡ch thá»±c hiá»‡n cÃ¡c hoáº¡t Ä‘...</description>
      <category>mysql</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>Náº¿u cÃ´ng ty cá»§a báº¡n cÃ³ DBA, thÃ¬ tÃ´i xin chÃºc má»«ng báº¡n, báº¡n cÃ³ thá»ƒ bá» qua viá»‡c quáº£n trá»‹ Mysql. Náº¿u cÃ´ng ty cá»§a báº¡n khÃ´ng cÃ³ DBA, hÃ£y há»c cÃ¡ch thá»±c hiá»‡n cÃ¡c hoáº¡t Ä‘á»™ng quáº£n trá»‹ cÆ¡ báº£n cá»§a Mysql, Ä‘Ã³ lÃ  Ä‘iá»u cáº§n thiáº¿t Ä‘á»ƒ tá»± báº£o vá»‡ mÃ¬nh khi hoáº¡t Ä‘á»™ng trong lÄ©nh vá»±c nÃ y.</p>
</blockquote>
<h2>CÃ i Ä‘áº·t vÃ  triá»ƒn khai</h2>
<h3>CÃ i Ä‘áº·t trÃªn Windows</h3>
<p>(1) Táº£i phiÃªn báº£n Mysql 5.7 Portable (khÃ´ng cáº§n cÃ i Ä‘áº·t)</p>
<p>Link táº£i: <a href="https://dev.mysql.com/downloads/mysql/5.7.html#downloads" target="_blank" rel="noopener noreferrer">https://dev.mysql.com/downloads/mysql/5.7.html#downloads</a></p>
<p>(2) Giáº£i nÃ©n vÃ  táº¡o file my.ini trong thÆ° má»¥c gá»‘c</p>
<p>VÃ­ dá»¥ file my.ini:</p>
<div class="language-ini line-numbers-mode" data-ext="ini" data-title="ini"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">[mysqld]</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Thiáº¿t láº­p cá»•ng 3306</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">port</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> =</span><span style="color:#98C379;--shiki-dark:#98C379"> 3306</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Thiáº¿t láº­p Ä‘Æ°á»ng dáº«n cÃ i Ä‘áº·t mysql, thay Ä‘á»•i Ä‘Æ°á»ng dáº«n nÃ y cho phÃ¹ há»£p vá»›i thÆ° má»¥c báº¡n giáº£i nÃ©n</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">basedir</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">=</span><span style="color:#98C379;--shiki-dark:#98C379">D:\\Tools\\DB\\mysql\\mysql-5.7.31</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Sá»‘ káº¿t ná»‘i tá»‘i Ä‘a</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">max_connections</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">=</span><span style="color:#98C379;--shiki-dark:#98C379">200</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Mysql sá»­ dá»¥ng bá»™ kÃ½ tá»± máº·c Ä‘á»‹nh lÃ  latin1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">character-set-server</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">=</span><span style="color:#98C379;--shiki-dark:#98C379">utf8</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Thiáº¿t láº­p engine lÆ°u trá»¯ máº·c Ä‘á»‹nh cho báº£ng má»›i</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">default-storage-engine</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">=</span><span style="color:#98C379;--shiki-dark:#98C379">INNODB</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">[client]</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Thiáº¿t láº­p bá»™ kÃ½ tá»± máº·c Ä‘á»‹nh cho client mysql</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">default-character-set</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">=</span><span style="color:#98C379;--shiki-dark:#98C379">utf8</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>(3) Thá»±c hiá»‡n cÃ¡c lá»‡nh cÃ i Ä‘áº·t</p>
<p>TrÃªn cá»­a sá»• CMD, thá»±c hiá»‡n láº§n lÆ°á»£t cÃ¡c lá»‡nh cÃ i Ä‘áº·t sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>cd D:\\Tools\\DB\\mysql\\mysql-5.7.31</span></span>
<span class="line"><span>mysqld --initialize</span></span>
<span class="line"><span>mysqld -install</span></span></code></pre>
</div><p>Giáº£i thÃ­ch:</p>
<ul>
<li><code>mysqld --initialize</code> sáº½ tá»± Ä‘á»™ng khá»Ÿi táº¡o vÃ  táº¡o thÆ° má»¥c data.</li>
<li><code>mysqld -install</code> sáº½ cÃ i Ä‘áº·t dá»‹ch vá»¥ mysql.</li>
</ul>
<p>(4) Khá»Ÿi Ä‘á»™ng dá»‹ch vá»¥</p>
<p>TrÃªn cá»­a sá»• CMD, thá»±c hiá»‡n lá»‡nh <code>net start mysql</code> Ä‘á»ƒ khá»Ÿi Ä‘á»™ng dá»‹ch vá»¥.</p>
<h3>CÃ i Ä‘áº·t trÃªn CentOS</h3>
<blockquote>
<p>BÃ i viáº¿t nÃ y chá»‰ giá»›i thiá»‡u cÃ¡ch cÃ i Ä‘áº·t thÃ´ng qua gÃ³i rpm</p>
</blockquote>
<h4>CÃ i Ä‘áº·t nguá»“n yum cá»§a mysql</h4>
<p>Link táº£i chÃ­nh thá»©c: <a href="https://dev.mysql.com/downloads/repo/yum/" target="_blank" rel="noopener noreferrer">https://dev.mysql.com/downloads/repo/yum/</a></p>
<p>(1) Táº£i gÃ³i yum</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">wget</span><span style="color:#98C379;--shiki-dark:#98C379"> https://dev.mysql.com/get/mysql80-community-release-el7-1.noarch.rpm</span></span></code></pre>
</div><p>(2) CÃ i Ä‘áº·t tá»‡p repo yum vÃ  cáº­p nháº­t bá»™ nhá»› cache yum</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">rpm</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -ivh</span><span style="color:#98C379;--shiki-dark:#98C379"> mysql80-community-release-el7-1.noarch.rpm</span></span></code></pre>
</div><p>Káº¿t quáº£ thá»±c hiá»‡n:</p>
<p>Sáº½ táº¡o ra hai tá»‡p repo trong thÆ° má»¥c /etc/yum.repos.d/</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">$</span><span style="color:#98C379;--shiki-dark:#98C379"> ls</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">grep</span><span style="color:#98C379;--shiki-dark:#98C379"> mysql</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">mysql-community.repo</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">mysql-community-source.repo</span></span></code></pre>
</div><p>Cáº­p nháº­t yum:</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">yum</span><span style="color:#98C379;--shiki-dark:#98C379"> clean</span><span style="color:#98C379;--shiki-dark:#98C379"> all</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">yum</span><span style="color:#98C379;--shiki-dark:#98C379"> makecache</span></span></code></pre>
</div><p>(3) Kiá»ƒm tra tráº¡ng thÃ¡i cÃ i Ä‘áº·t rpm</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">$</span><span style="color:#98C379;--shiki-dark:#98C379"> yum</span><span style="color:#98C379;--shiki-dark:#98C379"> search</span><span style="color:#98C379;--shiki-dark:#98C379"> mysql</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">grep</span><span style="color:#98C379;--shiki-dark:#98C379"> server</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">mysql-community-common.i686</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> MySQL</span><span style="color:#98C379;--shiki-dark:#98C379"> database</span><span style="color:#98C379;--shiki-dark:#98C379"> common</span><span style="color:#98C379;--shiki-dark:#98C379"> files</span><span style="color:#98C379;--shiki-dark:#98C379"> for</span><span style="color:#98C379;--shiki-dark:#98C379"> server</span><span style="color:#98C379;--shiki-dark:#98C379"> and</span><span style="color:#98C379;--shiki-dark:#98C379"> client</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">mysql-community-common.x86_64</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> MySQL</span><span style="color:#98C379;--shiki-dark:#98C379"> database</span><span style="color:#98C379;--shiki-dark:#98C379"> common</span><span style="color:#98C379;--shiki-dark:#98C379"> files</span><span style="color:#98C379;--shiki-dark:#98C379"> for</span><span style="color:#98C379;--shiki-dark:#98C379"> server</span><span style="color:#98C379;--shiki-dark:#98C379"> and</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">mysql-community-test.x86_64</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> Test</span><span style="color:#98C379;--shiki-dark:#98C379"> suite</span><span style="color:#98C379;--shiki-dark:#98C379"> for</span><span style="color:#98C379;--shiki-dark:#98C379"> the</span><span style="color:#98C379;--shiki-dark:#98C379"> MySQL</span><span style="color:#98C379;--shiki-dark:#98C379"> database</span><span style="color:#98C379;--shiki-dark:#98C379"> server</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2">                       :</span><span style="color:#98C379;--shiki-dark:#98C379"> administering</span><span style="color:#98C379;--shiki-dark:#98C379"> MySQL</span><span style="color:#98C379;--shiki-dark:#98C379"> servers</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">mysql-community-server.x86_64</span><span style="color:#98C379;--shiki-dark:#98C379"> :</span><span style="color:#98C379;--shiki-dark:#98C379"> A</span><span style="color:#98C379;--shiki-dark:#98C379"> very</span><span style="color:#98C379;--shiki-dark:#98C379"> fast</span><span style="color:#98C379;--shiki-dark:#98C379"> and</span><span style="color:#98C379;--shiki-dark:#98C379"> reliable</span><span style="color:#98C379;--shiki-dark:#98C379"> SQL</span><span style="color:#98C379;--shiki-dark:#98C379"> database</span><span style="color:#98C379;--shiki-dark:#98C379"> server</span></span></code></pre>
</div><p>Sau khi cÃ i Ä‘áº·t mysql báº±ng yum, sáº½ cÃ³ má»™t sá»‘ thÆ° má»¥c quan trá»ng:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>## Tá»‡p cáº¥u hÃ¬nh</span></span>
<span class="line"><span>/etc/my.cnf</span></span>
<span class="line"><span>## ThÆ° má»¥c cÆ¡ sá»Ÿ dá»¯ liá»‡u</span></span>
<span class="line"><span>/var/lib/mysql/</span></span>
<span class="line"><span>## Tá»‡p cáº¥u hÃ¬nh</span></span>
<span class="line"><span>/usr/share/mysql (lá»‡nh mysql.server vÃ  tá»‡p cáº¥u hÃ¬nh)</span></span>
<span class="line"><span>## CÃ¡c lá»‡nh liÃªn quan</span></span>
<span class="line"><span>/usr/bin (mysqladmin, mysqldump vÃ  cÃ¡c lá»‡nh khÃ¡c)</span></span>
<span class="line"><span>## Tá»‡p khá»Ÿi Ä‘á»™ng</span></span>
<span class="line"><span>/usr/lib/systemd/system/mysqld.service (Ä‘Äƒng kÃ½ dá»‹ch vá»¥ systemd)</span></span></code></pre>
</div><p>(4) CÃ i Ä‘áº·t mÃ¡y chá»§ mysql</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">yum</span><span style="color:#98C379;--shiki-dark:#98C379"> install</span><span style="color:#98C379;--shiki-dark:#98C379"> mysql-community-server</span></span></code></pre>
</div><h4>Quáº£n lÃ½ dá»‹ch vá»¥ mysql</h4>
<p>Sau khi cÃ i Ä‘áº·t mysql báº±ng yum, sáº½ cÃ³ má»™t dá»‹ch vá»¥ systemd cÃ³ tÃªn <code>mysqld</code>.</p>
<p>Quáº£n lÃ½ dá»‹ch vá»¥ ráº¥t Ä‘Æ¡n giáº£n:</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">## Kiá»ƒm tra tráº¡ng thÃ¡i</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">systemctl</span><span style="color:#98C379;--shiki-dark:#98C379"> status</span><span style="color:#98C379;--shiki-dark:#98C379"> mysqld</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">## KÃ­ch hoáº¡t dá»‹ch vá»¥</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">systemctl</span><span style="color:#98C379;--shiki-dark:#98C379"> enable</span><span style="color:#98C379;--shiki-dark:#98C379"> mysqld</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">## VÃ´ hiá»‡u hÃ³a dá»‹ch vá»¥</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">systemctl</span><span style="color:#98C379;--shiki-dark:#98C379"> disable</span><span style="color:#98C379;--shiki-dark:#98C379"> mysqld</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">## Khá»Ÿi Ä‘á»™ng dá»‹ch vá»¥</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">systemctl</span><span style="color:#98C379;--shiki-dark:#98C379"> start</span><span style="color:#98C379;--shiki-dark:#98C379"> mysqld</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">## Khá»Ÿi Ä‘á»™ng láº¡i dá»‹ch vá»¥</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">systemctl</span><span style="color:#98C379;--shiki-dark:#98C379"> restart</span><span style="color:#98C379;--shiki-dark:#98C379"> mysqld</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">## Dá»«ng dá»‹ch vá»¥</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">systemctl</span><span style="color:#98C379;--shiki-dark:#98C379"> stop</span><span style="color:#98C379;--shiki-dark:#98C379"> mysqld</span></span></code></pre>
</div><h3>Khá»Ÿi táº¡o máº­t kháº©u cho cÆ¡ sá»Ÿ dá»¯ liá»‡u</h3>
<p>Xem máº­t kháº©u táº¡m thá»i:</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">$</span><span style="color:#98C379;--shiki-dark:#98C379"> grep</span><span style="color:#98C379;--shiki-dark:#98C379"> "password"</span><span style="color:#98C379;--shiki-dark:#98C379"> /var/log/mysqld.log</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">2018-09-30T03:13:41.727736Z</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [Note] [MY-010454] [Server] A temporary password is generated </span><span style="color:#C678DD;--shiki-dark:#C678DD">for</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> root@localhost: %:lt+srWu4k1</span></span></code></pre>
</div><p>Thá»±c hiá»‡n lá»‡nh sau:</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">mysql</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -uroot</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -p</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&lt;</span><span style="color:#D19A66;--shiki-dark:#D19A66">temporary_password</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&gt;</span></span></code></pre>
</div><p>Nháº­p máº­t kháº©u táº¡m thá»i Ä‘á»ƒ truy cáº­p vÃ o mysql. Náº¿u báº¡n muá»‘n thay Ä‘á»•i máº­t kháº©u, thá»±c hiá»‡n lá»‡nh sau:</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">ALTER</span><span style="color:#98C379;--shiki-dark:#98C379"> USER</span><span style="color:#98C379;--shiki-dark:#98C379"> 'root'@'localhost'</span><span style="color:#98C379;--shiki-dark:#98C379"> IDENTIFIED</span><span style="color:#98C379;--shiki-dark:#98C379"> BY</span><span style="color:#98C379;--shiki-dark:#98C379"> 'your_password'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span></code></pre>
</div><p>LÆ°u Ã½: Máº­t kháº©u máº·c Ä‘á»‹nh cÃ³ Ä‘á»™ máº¡nh trung bÃ¬nh, bao gá»“m chá»¯ hoa, chá»¯ thÆ°á»ng, chá»¯ sá»‘ vÃ  kÃ½ tá»± Ä‘áº·c biá»‡t. Báº¡n chá»‰ cÃ³ thá»ƒ thay Ä‘á»•i cáº¥u hÃ¬nh Ä‘á»ƒ sá»­ dá»¥ng máº­t kháº©u Ä‘Æ¡n giáº£n hÆ¡n sau khi Ä‘Ã£ thay Ä‘á»•i thÃ nh cÃ´ng máº­t kháº©u.</p>
<h3>Cáº¥u hÃ¬nh truy cáº­p tá»« xa</h3>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> USER</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> '</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">root</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">'@</span><span style="color:#98C379;--shiki-dark:#98C379">'%'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> IDENTIFIED </span><span style="color:#C678DD;--shiki-dark:#C678DD">BY</span><span style="color:#98C379;--shiki-dark:#98C379"> 'your_password'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">GRANT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> ALL </span><span style="color:#C678DD;--shiki-dark:#C678DD">ON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> *.* </span><span style="color:#C678DD;--shiki-dark:#C678DD">TO</span><span style="color:#98C379;--shiki-dark:#98C379"> 'root'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">@</span><span style="color:#98C379;--shiki-dark:#98C379">'%'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">ALTER</span><span style="color:#C678DD;--shiki-dark:#C678DD"> USER</span><span style="color:#98C379;--shiki-dark:#98C379"> 'root'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">@</span><span style="color:#98C379;--shiki-dark:#98C379">'%'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> IDENTIFIED </span><span style="color:#C678DD;--shiki-dark:#C678DD">WITH</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> mysql_native_password </span><span style="color:#C678DD;--shiki-dark:#C678DD">BY</span><span style="color:#98C379;--shiki-dark:#98C379"> 'your_password'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">FLUSH PRIVILEGES;</span></span></code></pre>
</div><h3>Bá» qua xÃ¡c thá»±c Ä‘Äƒng nháº­p</h3>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">vim</span><span style="color:#98C379;--shiki-dark:#98C379"> /etc/my.cnf</span></span></code></pre>
</div><p>ThÃªm dÃ²ng <code>skip-grant-tables</code> dÆ°á»›i pháº§n <code>[mysqld]</code>.</p>
<p>Chá»©c nÄƒng nÃ y cho phÃ©p bá» qua xÃ¡c thá»±c Ä‘Äƒng nháº­p, nghÄ©a lÃ  báº¡n cÃ³ thá»ƒ Ä‘Äƒng nháº­p vÃ o root vá»›i báº¥t ká»³ máº­t kháº©u nÃ o.</p>
<p>Thá»±c hiá»‡n <code>systemctl restart mysqld</code> Ä‘á»ƒ khá»Ÿi Ä‘á»™ng láº¡i mysql.</p>
<h3>Káº¿t ná»‘i tá»« mÃ¡y khÃ¡ch</h3>
<p>CÃº phÃ¡p: <code>mysql -h&lt;host&gt; -P&lt;port&gt; -u&lt;username&gt; -p&lt;password&gt;</code></p>
<p>Náº¿u khÃ´ng chá»‰ Ä‘á»‹nh máº­t kháº©u má»™t cÃ¡ch rÃµ rÃ ng, báº¡n sáº½ Ä‘Æ°á»£c yÃªu cáº§u nháº­p máº­t kháº©u trÆ°á»›c khi truy cáº­p.</p>
<p>ã€VÃ­ dá»¥ã€‘Káº¿t ná»‘i Ä‘áº¿n Mysql cá»¥c bá»™</p>
<div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">$</span><span style="color:#98C379;--shiki-dark:#98C379"> mysql</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -h</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 127.0.0.1</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -P</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 3306</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -u</span><span style="color:#98C379;--shiki-dark:#98C379"> root</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -p</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">Enter</span><span style="color:#98C379;--shiki-dark:#98C379"> password:</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">Welcome</span><span style="color:#98C379;--shiki-dark:#98C379"> to</span><span style="color:#98C379;--shiki-dark:#98C379"> the</span><span style="color:#98C379;--shiki-dark:#98C379"> MySQL</span><span style="color:#98C379;--shiki-dark:#98C379"> monitor.</span><span style="color:#98C379;--shiki-dark:#98C379">  Commands</span><span style="color:#98C379;--shiki-dark:#98C379"> end</span><span style="color:#98C379;--shiki-dark:#98C379"> with</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> ; </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">or</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> \g</span><span style="color:#98C379;--shiki-dark:#98C379">.</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">Your</span><span style="color:#98C379;--shiki-dark:#98C379"> MySQL</span><span style="color:#98C379;--shiki-dark:#98C379"> connection</span><span style="color:#98C379;--shiki-dark:#98C379"> id</span><span style="color:#98C379;--shiki-dark:#98C379"> is</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 13501</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">Server</span><span style="color:#98C379;--shiki-dark:#98C379"> version:</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 8.0.19</span><span style="color:#98C379;--shiki-dark:#98C379"> MySQL</span><span style="color:#98C379;--shiki-dark:#98C379"> Community</span><span style="color:#98C379;--shiki-dark:#98C379"> Server</span><span style="color:#98C379;--shiki-dark:#98C379"> -</span><span style="color:#98C379;--shiki-dark:#98C379"> GPL</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">Copyright</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">Oracle</span><span style="color:#98C379;--shiki-dark:#98C379"> is</span><span style="color:#98C379;--shiki-dark:#98C379"> a</span><span style="color:#98C379;--shiki-dark:#98C379"> registered</span><span style="color:#98C379;--shiki-dark:#98C379"> trademark</span><span style="color:#98C379;--shiki-dark:#98C379"> of</span><span style="color:#98C379;--shiki-dark:#98C379"> Oracle</span><span style="color:#98C379;--shiki-dark:#98C379"> Corporation</span><span style="color:#98C379;--shiki-dark:#98C379"> and/or</span><span style="color:#98C379;--shiki-dark:#98C379"> its</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">affiliates.</span><span style="color:#98C379;--shiki-dark:#98C379"> Other</span><span style="color:#98C379;--shiki-dark:#98C379"> names</span><span style="color:#98C379;--shiki-dark:#98C379"> may</span><span style="color:#98C379;--shiki-dark:#98C379"> be</span><span style="color:#98C379;--shiki-dark:#98C379"> trademarks</span><span style="color:#98C379;--shiki-dark:#98C379"> of</span><span style="color:#98C379;--shiki-dark:#98C379"> their</span><span style="color:#98C379;--shiki-dark:#98C379"> respective</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">owners.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">Type</span><span style="color:#98C379;--shiki-dark:#98C379"> 'help;'</span><span style="color:#98C379;--shiki-dark:#98C379"> or</span><span style="color:#98C379;--shiki-dark:#98C379"> '\h'</span><span style="color:#98C379;--shiki-dark:#98C379"> for</span><span style="color:#98C379;--shiki-dark:#98C379"> help.</span><span style="color:#98C379;--shiki-dark:#98C379"> Type</span><span style="color:#98C379;--shiki-dark:#98C379"> '\c'</span><span style="color:#98C379;--shiki-dark:#98C379"> to</span><span style="color:#98C379;--shiki-dark:#98C379"> clear</span><span style="color:#98C379;--shiki-dark:#98C379"> the</span><span style="color:#98C379;--shiki-dark:#98C379"> current</span><span style="color:#98C379;--shiki-dark:#98C379"> input</span><span style="color:#98C379;--shiki-dark:#98C379"> statement.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">mysql</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&gt;</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>Xem káº¿t ná»‘i</h3>
<p>Sau khi káº¿t ná»‘i thÃ nh cÃ´ng, náº¿u báº¡n khÃ´ng cÃ³ hoáº¡t Ä‘á»™ng tiáº¿p theo, káº¿t ná»‘i sáº½ á»Ÿ tráº¡ng thÃ¡i ráº£nh rá»—i vÃ  báº¡n cÃ³ thá»ƒ tháº¥y nÃ³ trong lá»‡nh <code>show processlist</code>. Náº¿u mÃ¡y khÃ¡ch khÃ´ng cÃ³ hoáº¡t Ä‘á»™ng trong má»™t khoáº£ng thá»i gian dÃ i, trÃ¬nh káº¿t ná»‘i sáº½ tá»± Ä‘á»™ng Ä‘Ã³ng nÃ³. Thá»i gian nÃ y Ä‘Æ°á»£c Ä‘iá»u chá»‰nh bá»Ÿi tham sá»‘ <code>wait_timeout</code>, giÃ¡ trá»‹ máº·c Ä‘á»‹nh lÃ  8 giá».</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200714115031.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>
<h3>Táº¡o ngÆ°á»i dÃ¹ng</h3>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> USER</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> '</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">username</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">'@</span><span style="color:#98C379;--shiki-dark:#98C379">'host'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> IDENTIFIED </span><span style="color:#C678DD;--shiki-dark:#C678DD">BY</span><span style="color:#98C379;--shiki-dark:#98C379"> 'password'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span></code></pre>
</div><p>Giáº£i thÃ­ch:</p>
<ul>
<li>username: TÃªn ngÆ°á»i dÃ¹ng báº¡n muá»‘n táº¡o</li>
<li>host: XÃ¡c Ä‘á»‹nh ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ Ä‘Äƒng nháº­p tá»« mÃ¡y chá»§ nÃ o. Náº¿u lÃ  ngÆ°á»i dÃ¹ng cá»¥c bá»™, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng localhost. Náº¿u báº¡n muá»‘n ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ Ä‘Äƒng nháº­p tá»« báº¥t ká»³ mÃ¡y chá»§ tá»« xa nÃ o, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng kÃ½ tá»± Ä‘áº¡i diá»‡n <code>%</code>.</li>
<li>password: Máº­t kháº©u Ä‘Äƒng nháº­p cá»§a ngÆ°á»i dÃ¹ng. Máº­t kháº©u cÃ³ thá»ƒ Ä‘á»ƒ trá»‘ng. Náº¿u Ä‘á»ƒ trá»‘ng, ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ Ä‘Äƒng nháº­p vÃ o mÃ¡y chá»§ mÃ  khÃ´ng cáº§n máº­t kháº©u.</li>
</ul>
<p>VÃ­ dá»¥:</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> USER</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> '</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">dog</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">'@</span><span style="color:#98C379;--shiki-dark:#98C379">'localhost'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> IDENTIFIED </span><span style="color:#C678DD;--shiki-dark:#C678DD">BY</span><span style="color:#98C379;--shiki-dark:#98C379"> '123456'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> USER</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> '</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">pig</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">'@</span><span style="color:#98C379;--shiki-dark:#98C379">'192.168.1.101_'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> IDENDIFIED </span><span style="color:#C678DD;--shiki-dark:#C678DD">BY</span><span style="color:#98C379;--shiki-dark:#98C379"> '123456'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> USER</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> '</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">pig</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">'@</span><span style="color:#98C379;--shiki-dark:#98C379">'%'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> IDENTIFIED </span><span style="color:#C678DD;--shiki-dark:#C678DD">BY</span><span style="color:#98C379;--shiki-dark:#98C379"> '123456'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> USER</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> '</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">pig</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">'@</span><span style="color:#98C379;--shiki-dark:#98C379">'%'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> IDENTIFIED </span><span style="color:#C678DD;--shiki-dark:#C678DD">BY</span><span style="color:#98C379;--shiki-dark:#98C379"> ''</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> USER</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> '</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">pig</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">'@</span><span style="color:#98C379;--shiki-dark:#98C379">'%'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span></code></pre>
</div><blockquote>
<p>LÆ°u Ã½: Trong Mysql 8, xÃ¡c thá»±c máº·c Ä‘á»‹nh khÃ´ng cÃ²n lÃ  <code>password</code>. VÃ¬ váº­y, khi táº¡o ngÆ°á»i dÃ¹ng, <code>create user 'username'@'%' identified by 'password';</code> khÃ´ng thá»ƒ káº¿t ná»‘i tá»« mÃ¡y khÃ¡ch.</p>
<p>VÃ¬ váº­y, báº¡n cáº§n thÃªm <code>IDENTIFIED WITH mysql_native_password</code>, vÃ­ dá»¥: <code>CREATE USER 'slave'@'%' IDENTIFIED WITH mysql_native_password BY '123456';</code></p>
</blockquote>
<h3>Xem ngÆ°á»i dÃ¹ng</h3>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- Xem táº¥t cáº£ ngÆ°á»i dÃ¹ng</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SELECT DISTINCT</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> CONCAT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#98C379;--shiki-dark:#98C379">'User: '''</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, user, </span><span style="color:#98C379;--shiki-dark:#98C379">'''@'''</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, host, </span><span style="color:#98C379;--shiki-dark:#98C379">''';'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#C678DD;--shiki-dark:#C678DD">AS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> query</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">FROM</span><span style="color:#D19A66;--shiki-dark:#D19A66"> mysql</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">user</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span></code></pre>
</div><h3>Cáº¥p quyá»n</h3>
<p>CÃº phÃ¡p:</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">GRANT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> privileges </span><span style="color:#C678DD;--shiki-dark:#C678DD">ON</span><span style="color:#D19A66;--shiki-dark:#D19A66"> databasename</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">tablename</span><span style="color:#C678DD;--shiki-dark:#C678DD"> TO</span><span style="color:#98C379;--shiki-dark:#98C379"> 'username'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">@</span><span style="color:#98C379;--shiki-dark:#98C379">'host'</span></span></code></pre>
</div><p>Giáº£i thÃ­ch:</p>
<ul>
<li>privileges: CÃ¡c quyá»n thá»±c hiá»‡n cá»§a ngÆ°á»i dÃ¹ng, nhÆ° <code>SELECT</code>, <code>INSERT</code>, <code>UPDATE</code>, vv. Náº¿u muá»‘n cáº¥p táº¥t cáº£ quyá»n, sá»­ dá»¥ng <code>ALL</code>.</li>
<li>databasename: TÃªn cÆ¡ sá»Ÿ dá»¯ liá»‡u.</li>
<li>tablename: TÃªn báº£ng. Náº¿u muá»‘n cáº¥p quyá»n cho ngÆ°á»i dÃ¹ng trÃªn táº¥t cáº£ cÆ¡ sá»Ÿ dá»¯ liá»‡u vÃ  báº£ng, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng <code>*.*</code>.</li>
</ul>
<p>VÃ­ dá»¥:</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">GRANT</span><span style="color:#C678DD;--shiki-dark:#C678DD"> SELECT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#C678DD;--shiki-dark:#C678DD">INSERT</span><span style="color:#C678DD;--shiki-dark:#C678DD"> ON</span><span style="color:#D19A66;--shiki-dark:#D19A66"> test</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">user</span><span style="color:#C678DD;--shiki-dark:#C678DD"> TO</span><span style="color:#98C379;--shiki-dark:#98C379"> 'pig'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">@</span><span style="color:#98C379;--shiki-dark:#98C379">'%'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">GRANT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> ALL </span><span style="color:#C678DD;--shiki-dark:#C678DD">ON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> *.* </span><span style="color:#C678DD;--shiki-dark:#C678DD">TO</span><span style="color:#98C379;--shiki-dark:#98C379"> 'pig'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">@</span><span style="color:#98C379;--shiki-dark:#98C379">'%'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">GRANT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> ALL </span><span style="color:#C678DD;--shiki-dark:#C678DD">ON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> maindataplus.* </span><span style="color:#C678DD;--shiki-dark:#C678DD">TO</span><span style="color:#98C379;--shiki-dark:#98C379"> 'pig'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">@</span><span style="color:#98C379;--shiki-dark:#98C379">'%'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span></code></pre>
</div><p>LÆ°u Ã½:</p>
<p>NgÆ°á»i dÃ¹ng Ä‘Æ°á»£c cáº¥p quyá»n báº±ng cÃ¡c lá»‡nh trÃªn khÃ´ng thá»ƒ cáº¥p quyá»n cho ngÆ°á»i dÃ¹ng khÃ¡c. Náº¿u báº¡n muá»‘n cho phÃ©p ngÆ°á»i dÃ¹ng cáº¥p quyá»n, sá»­ dá»¥ng lá»‡nh sau:</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- Cáº¥u hÃ¬nh quyá»n cá»¥ thá»ƒ cho ngÆ°á»i dÃ¹ng Ä‘Ã£ chá»‰ Ä‘á»‹nh</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">GRANT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> privileges </span><span style="color:#C678DD;--shiki-dark:#C678DD">ON</span><span style="color:#D19A66;--shiki-dark:#D19A66"> databasename</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">tablename</span><span style="color:#C678DD;--shiki-dark:#C678DD"> TO</span><span style="color:#98C379;--shiki-dark:#98C379"> 'username'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">@</span><span style="color:#98C379;--shiki-dark:#98C379">'host'</span><span style="color:#C678DD;--shiki-dark:#C678DD"> WITH</span><span style="color:#C678DD;--shiki-dark:#C678DD"> GRANT</span><span style="color:#C678DD;--shiki-dark:#C678DD"> OPTION</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- GÃ¡n táº¥t cáº£ quyá»n cho ngÆ°á»i dÃ¹ng root</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">GRANT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> ALL </span><span style="color:#C678DD;--shiki-dark:#C678DD">ON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> *.* </span><span style="color:#C678DD;--shiki-dark:#C678DD">TO</span><span style="color:#98C379;--shiki-dark:#98C379"> 'root'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">@</span><span style="color:#98C379;--shiki-dark:#98C379">'%'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> IDENTIFIED </span><span style="color:#C678DD;--shiki-dark:#C678DD">BY</span><span style="color:#98C379;--shiki-dark:#98C379"> 'password'</span><span style="color:#C678DD;--shiki-dark:#C678DD"> WITH</span><span style="color:#C678DD;--shiki-dark:#C678DD"> GRANT</span><span style="color:#C678DD;--shiki-dark:#C678DD"> OPTION</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span></code></pre>
</div><h3>Thu há»“i quyá»n</h3>
<p>CÃº phÃ¡p:</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">REVOKE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> privilege </span><span style="color:#C678DD;--shiki-dark:#C678DD">ON</span><span style="color:#D19A66;--shiki-dark:#D19A66"> databasename</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">tablename</span><span style="color:#C678DD;--shiki-dark:#C678DD"> FROM</span><span style="color:#98C379;--shiki-dark:#98C379"> 'username'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">@</span><span style="color:#98C379;--shiki-dark:#98C379">'host'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span></code></pre>
</div><p>Giáº£i thÃ­ch:</p>
<p>privilege, databasename, tablename: TÆ°Æ¡ng tá»± nhÆ° pháº§n cáº¥p quyá»n.</p>
<p>VÃ­ dá»¥:</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">REVOKE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> SELECT</span><span style="color:#C678DD;--shiki-dark:#C678DD"> ON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> *.* </span><span style="color:#C678DD;--shiki-dark:#C678DD">FROM</span><span style="color:#98C379;--shiki-dark:#98C379"> 'pig'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">@</span><span style="color:#98C379;--shiki-dark:#98C379">'%'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span></code></pre>
</div><p>LÆ°u Ã½:</p>
<p>Náº¿u báº¡n Ä‘Ã£ cáº¥p quyá»n cho ngÆ°á»i dÃ¹ng <code>'pig'@'%'</code> nhÆ° sau (hoáº·c tÆ°Æ¡ng tá»±): <code>GRANT SELECT ON test.user TO 'pig'@'%'</code>, thÃ¬ viá»‡c sá»­ dá»¥ng lá»‡nh <code>REVOKE SELECT ON *.* FROM 'pig'@'%';</code> sáº½ khÃ´ng thu há»“i quyá»n <code>SELECT</code> cá»§a ngÆ°á»i dÃ¹ng trÃªn báº£ng <code>user</code> trong cÆ¡ sá»Ÿ dá»¯ liá»‡u <code>test</code>. NgÆ°á»£c láº¡i, náº¿u quyá»n Ä‘Æ°á»£c cáº¥p báº±ng <code>GRANT SELECT ON *.* TO 'pig'@'%';</code>, thÃ¬ lá»‡nh <code>REVOKE SELECT ON test.user FROM 'pig'@'%';</code> cÅ©ng khÃ´ng thu há»“i quyá»n <code>SELECT</code> cá»§a ngÆ°á»i dÃ¹ng trÃªn báº£ng <code>user</code> trong cÆ¡ sá»Ÿ dá»¯ liá»‡u <code>test</code>.</p>
<p>Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng lá»‡nh <code>SHOW GRANTS FOR 'pig'@'%';</code> Ä‘á»ƒ xem thÃ´ng tin chi tiáº¿t.</p>
<h3>Xem quyá»n</h3>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- Xem quyá»n cá»§a ngÆ°á»i dÃ¹ng</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">SHOW GRANTS </span><span style="color:#C678DD;--shiki-dark:#C678DD">FOR</span><span style="color:#98C379;--shiki-dark:#98C379"> 'root'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">@</span><span style="color:#98C379;--shiki-dark:#98C379">'%'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span></code></pre>
</div><h3>Thay Ä‘á»•i máº­t kháº©u ngÆ°á»i dÃ¹ng</h3>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SET</span><span style="color:#C678DD;--shiki-dark:#C678DD"> PASSWORD</span><span style="color:#C678DD;--shiki-dark:#C678DD"> FOR</span><span style="color:#98C379;--shiki-dark:#98C379"> 'username'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">@</span><span style="color:#98C379;--shiki-dark:#98C379">'host'</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD"> PASSWORD</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#98C379;--shiki-dark:#98C379">'newpassword'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">);</span></span></code></pre>
</div><p>Náº¿u Ä‘ang Ä‘Äƒng nháº­p vá»›i ngÆ°á»i dÃ¹ng hiá»‡n táº¡i, sá»­ dá»¥ng:</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SET</span><span style="color:#C678DD;--shiki-dark:#C678DD"> PASSWORD</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD"> PASSWORD</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#98C379;--shiki-dark:#98C379">"newpassword"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">);</span></span></code></pre>
</div><p>VÃ­ dá»¥:</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SET</span><span style="color:#C678DD;--shiki-dark:#C678DD"> PASSWORD</span><span style="color:#C678DD;--shiki-dark:#C678DD"> FOR</span><span style="color:#98C379;--shiki-dark:#98C379"> 'pig'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">@</span><span style="color:#98C379;--shiki-dark:#98C379">'%'</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD"> PASSWORD</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#98C379;--shiki-dark:#98C379">"123456"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">);</span></span></code></pre>
</div><h3>Sao lÆ°u vÃ  khÃ´i phá»¥c</h3>
<p>Äá»ƒ sao lÆ°u dá»¯ liá»‡u MySQL, chÃºng ta sá»­ dá»¥ng lá»‡nh mysqldump.</p>
<p>Mysqldump sáº½ sao lÆ°u dá»¯ liá»‡u trong cÆ¡ sá»Ÿ dá»¯ liá»‡u thÃ nh má»™t tá»‡p vÄƒn báº£n, cáº¥u trÃºc báº£ng vÃ  dá»¯ liá»‡u cá»§a báº£ng sáº½ Ä‘Æ°á»£c lÆ°u trá»¯ trong tá»‡p vÄƒn báº£n Ä‘Æ°á»£c táº¡o ra.</p>
<p>Sao lÆ°u:</p>
<h4>Sao lÆ°u má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u</h4>
<p>CÃº phÃ¡p:</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">mysqldump -h </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&lt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">host</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> -P</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&lt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">port</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> -u</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&lt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">username</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> -p</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&lt;</span><span style="color:#C678DD;--shiki-dark:#C678DD">database</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#E06C75;--shiki-dark:#E06C75"> [&lt;table1&gt; &lt;table2&gt; ...]</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> &gt;</span><span style="color:#D19A66;--shiki-dark:#D19A66"> backup</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">sql</span></span></code></pre>
</div><ul>
<li><strong><code>host</code></strong> - MÃ¡y chá»§ Mysql</li>
<li><strong><code>port</code></strong> - Cá»•ng cá»§a mÃ¡y chá»§ Mysql</li>
<li><strong><code>username</code></strong> - TÃªn ngÆ°á»i dÃ¹ng cÆ¡ sá»Ÿ dá»¯ liá»‡u</li>
<li><strong><code>dbname</code></strong> - TÃªn cÆ¡ sá»Ÿ dá»¯ liá»‡u</li>
<li>Tham sá»‘ table1 vÃ  table2 Ä‘áº¡i diá»‡n cho tÃªn cÃ¡c báº£ng cáº§n sao lÆ°u, náº¿u Ä‘á»ƒ trá»‘ng thÃ¬ sao lÆ°u toÃ n bá»™ cÆ¡ sá»Ÿ dá»¯ liá»‡u;</li>
<li>Tham sá»‘ BackupName.sql Ä‘áº¡i diá»‡n cho tÃªn tá»‡p sao lÆ°u Ä‘Æ°á»£c táº¡o ra, báº¡n cÃ³ thá»ƒ thÃªm Ä‘Æ°á»ng dáº«n tuyá»‡t Ä‘á»‘i trÆ°á»›c tÃªn tá»‡p. ThÃ´ng thÆ°á»ng, cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘Æ°á»£c sao lÆ°u thÃ nh má»™t tá»‡p cÃ³ pháº§n má»Ÿ rá»™ng lÃ  sql.</li>
</ul>
<h4>Sao lÆ°u nhiá»u cÆ¡ sá»Ÿ dá»¯ liá»‡u</h4>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">mysqldump -u </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&lt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">username</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> -p </span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">--databases &lt;database1&gt; &lt;database2&gt; ... &gt; backup.sql</span></span></code></pre>
</div><h4>Sao lÆ°u táº¥t cáº£ cÆ¡ sá»Ÿ dá»¯ liá»‡u</h4>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">mysqldump -u </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&lt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">username</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> -p </span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">--all-databases &gt; backup.sql</span></span></code></pre>
</div><h4>KhÃ´i phá»¥c má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u</h4>
<p>Äá»ƒ khÃ´i phá»¥c dá»¯ liá»‡u MySQL, chÃºng ta sá»­ dá»¥ng lá»‡nh mysql.</p>
<p>CÃº phÃ¡p:</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">mysql -h </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&lt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">host</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> -P</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&lt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">port</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> -u</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&lt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">username</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> -p</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&lt;</span><span style="color:#C678DD;--shiki-dark:#C678DD">database</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> &lt;</span><span style="color:#D19A66;--shiki-dark:#D19A66"> backup</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">sql</span></span></code></pre>
</div><h4>KhÃ´i phá»¥c táº¥t cáº£ cÆ¡ sá»Ÿ dá»¯ liá»‡u</h4>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">mysql -u</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&lt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">username</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> -p </span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">--all-databases &lt; backup.sql</span></span></code></pre>
</div><h3>Gá»¡ cÃ i Ä‘áº·t</h3>
<p>(1) Xem MySQL Ä‘Ã£ Ä‘Æ°á»£c cÃ i Ä‘áº·t</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">$</span><span style="color:#98C379;--shiki-dark:#98C379"> rpm</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -qa</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">grep</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -i</span><span style="color:#98C379;--shiki-dark:#98C379"> mysql</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">perl-DBD-MySQL-4.023-6.el7.x86_64</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">mysql80-community-release-el7-1.noarch</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">mysql-community-common-8.0.12-1.el7.x86_64</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">mysql-community-client-8.0.12-1.el7.x86_64</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">mysql-community-libs-compat-8.0.12-1.el7.x86_64</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">mysql-community-libs-8.0.12-1.el7.x86_64</span></span></code></pre>
</div><p>(2) Gá»¡ cÃ i Ä‘áº·t MySQL</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">yum</span><span style="color:#98C379;--shiki-dark:#98C379"> remove</span><span style="color:#98C379;--shiki-dark:#98C379"> mysql-community-server.x86_64</span></span></code></pre>
</div><h3>Triá»ƒn khai Master-Slave</h3>
<p>Giáº£ sá»­ báº¡n cáº§n cáº¥u hÃ¬nh má»™t mÃ´i trÆ°á»ng mÃ¡y chá»§ Master-Slave cho MySQL:</p>
<ul>
<li>Node Master: 192.168.8.10</li>
<li>Node Slave: 192.168.8.11</li>
</ul>
<h4>CÃ¡c bÆ°á»›c trÃªn Node Master</h4>
<p>(1) Sá»­a Ä‘á»•i cáº¥u hÃ¬nh vÃ  khá»Ÿi Ä‘á»™ng láº¡i</p>
<p>Cháº¡y lá»‡nh <code>vi /etc/my.cnf</code> vÃ  thÃªm cáº¥u hÃ¬nh sau:</p>
<div class="language-ini" data-ext="ini" data-title="ini"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">[mysqld]</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">server-id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">=</span><span style="color:#98C379;--shiki-dark:#98C379">1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">log_bin</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">=</span><span style="color:#98C379;--shiki-dark:#98C379">/var/lib/mysql/binlog</span></span></code></pre>
</div><ul>
<li><code>server-id</code> - Sá»‘ ID cá»§a mÃ¡y chá»§. Trong kiáº¿n trÃºc Master-Slave, má»—i mÃ¡y pháº£i cÃ³ má»™t ID duy nháº¥t.</li>
<li><code>log_bin</code> - ÄÆ°á»ng dáº«n vÃ  tÃªn tá»‡p nháº­t kÃ½ Ä‘á»“ng bá»™, hÃ£y Ä‘áº£m báº£o ráº±ng thÆ° má»¥c nÃ y cÃ³ quyá»n ghi cho MySQL;</li>
</ul>
<p>Sau khi chá»‰nh sá»­a, khá»Ÿi Ä‘á»™ng láº¡i MySQL Ä‘á»ƒ Ã¡p dá»¥ng cáº¥u hÃ¬nh má»›i:</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">systemctl </span><span style="color:#C678DD;--shiki-dark:#C678DD">restart</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> mysql</span></span></code></pre>
</div><p>(2) Táº¡o ngÆ°á»i dÃ¹ng cho Ä‘á»“ng bá»™ hoÃ¡</p>
<p>Truy cáº­p vÃ o báº£ng Ä‘iá»u khiá»ƒn MySQL:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>$ mysql -u root -p</span></span>
<span class="line"><span>Password:</span></span></code></pre>
</div><p>Thá»±c hiá»‡n cÃ¡c cÃ¢u lá»‡nh SQL sau:</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- a. Táº¡o ngÆ°á»i dÃ¹ng slave</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> USER</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> '</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">slave</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">'@</span><span style="color:#98C379;--shiki-dark:#98C379">'%'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> IDENTIFIED </span><span style="color:#C678DD;--shiki-dark:#C678DD">WITH</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> mysql_native_password </span><span style="color:#C678DD;--shiki-dark:#C678DD">BY</span><span style="color:#98C379;--shiki-dark:#98C379"> 'password'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- Cáº¥p quyá»n REPLICATION SLAVE cho slave</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">GRANT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> REPLICATION SLAVE </span><span style="color:#C678DD;--shiki-dark:#C678DD">ON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> *.* </span><span style="color:#C678DD;--shiki-dark:#C678DD">TO</span><span style="color:#98C379;--shiki-dark:#98C379"> 'slave'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">@</span><span style="color:#98C379;--shiki-dark:#98C379">'%'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- b. Hoáº·c, táº¡o ngÆ°á»i dÃ¹ng slave vÃ  cho phÃ©p ngÆ°á»i dÃ¹ng Ä‘Äƒng nháº­p tá»« báº¥t ká»³ mÃ¡y chá»§ nÃ o</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- Náº¿u cÃ³ nhiá»u slave vÃ  báº¡n muá»‘n táº¥t cáº£ cÃ¡c slave sá»­ dá»¥ng cÃ¹ng má»™t tÃªn ngÆ°á»i dÃ¹ng vÃ  máº­t kháº©u, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡ch nÃ y</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> USER</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> '</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">slave</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">'@</span><span style="color:#98C379;--shiki-dark:#98C379">'%'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> IDENTIFIED </span><span style="color:#C678DD;--shiki-dark:#C678DD">WITH</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> mysql_native_password </span><span style="color:#C678DD;--shiki-dark:#C678DD">BY</span><span style="color:#98C379;--shiki-dark:#98C379"> 'password'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">GRANT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> REPLICATION SLAVE </span><span style="color:#C678DD;--shiki-dark:#C678DD">ON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> *.* </span><span style="color:#C678DD;--shiki-dark:#C678DD">TO</span><span style="color:#98C379;--shiki-dark:#98C379"> 'slave'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">@</span><span style="color:#98C379;--shiki-dark:#98C379">'%'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- LÃ m má»›i thÃ´ng tin báº£ng phÃ¢n quyá»n</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">FLUSH PRIVILEGES;</span></span></code></pre>
</div><blockquote>
<p>LÆ°u Ã½: Trong MySQL 8, phÆ°Æ¡ng thá»©c xÃ¡c thá»±c máº·c Ä‘á»‹nh khÃ´ng cÃ²n lÃ  <code>password</code>. VÃ¬ váº­y, khi táº¡o ngÆ°á»i dÃ¹ng, <code>create user 'username'@'%' identified by 'password';</code> khÃ´ng thá»ƒ káº¿t ná»‘i tá»« mÃ¡y khÃ¡ch. VÃ¬ váº­y, báº¡n cáº§n thÃªm <code>IDENTIFIED WITH mysql_native_password BY 'password'</code> khi táº¡o ngÆ°á»i dÃ¹ng.</p>
</blockquote>
<p>SQL quáº£n lÃ½ ngÆ°á»i dÃ¹ng bá»• sung:</p>
<div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- Xem táº¥t cáº£ ngÆ°á»i dÃ¹ng</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SELECT DISTINCT</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> CONCAT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#98C379;--shiki-dark:#98C379">'User: '''</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, user, </span><span style="color:#98C379;--shiki-dark:#98C379">'''@'''</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, host, </span><span style="color:#98C379;--shiki-dark:#98C379">''';'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#C678DD;--shiki-dark:#C678DD">AS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> query</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">FROM</span><span style="color:#D19A66;--shiki-dark:#D19A66"> mysql</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">user</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- Xem quyá»n cá»§a ngÆ°á»i dÃ¹ng</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">SHOW GRANTS </span><span style="color:#C678DD;--shiki-dark:#C678DD">FOR</span><span style="color:#98C379;--shiki-dark:#98C379"> 'root'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">@</span><span style="color:#98C379;--shiki-dark:#98C379">'%'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- Táº¡o ngÆ°á»i dÃ¹ng</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- a. Táº¡o ngÆ°á»i dÃ¹ng slave vÃ  chá»‰ cho phÃ©p ngÆ°á»i dÃ¹ng Ä‘Äƒng nháº­p tá»« mÃ¡y chá»§ 192.168.8.11</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> USER</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> '</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">slave</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">'@</span><span style="color:#98C379;--shiki-dark:#98C379">'192.168.8.11'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> IDENTIFIED </span><span style="color:#C678DD;--shiki-dark:#C678DD">WITH</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> mysql_native_password </span><span style="color:#C678DD;--shiki-dark:#C678DD">BY</span><span style="color:#98C379;--shiki-dark:#98C379"> 'password'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- Cáº¥p quyá»n REPLICATION SLAVE cho slave</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">GRANT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> REPLICATION SLAVE </span><span style="color:#C678DD;--shiki-dark:#C678DD">ON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> *.* </span><span style="color:#C678DD;--shiki-dark:#C678DD">TO</span><span style="color:#98C379;--shiki-dark:#98C379"> 'slave'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">@</span><span style="color:#98C379;--shiki-dark:#98C379">'192.168.8.11'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- XÃ³a ngÆ°á»i dÃ¹ng</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">DROP</span><span style="color:#C678DD;--shiki-dark:#C678DD"> USER</span><span style="color:#98C379;--shiki-dark:#98C379"> 'slave'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">@</span><span style="color:#98C379;--shiki-dark:#98C379">'192.168.8.11'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>(3) ThÃªm khÃ³a Ä‘á»c</p>
<p>Äá»ƒ Ä‘áº£m báº£o dá»¯ liá»‡u trÃªn mÃ¡y chá»§ chÃ­nh vÃ  mÃ¡y chá»§ phá»¥ giá»¯ nguyÃªn, chÃºng ta sáº½ thÃªm khÃ³a Ä‘á»c cho MySQL, biáº¿n nÃ³ thÃ nh chá»‰ cÃ³ thá»ƒ Ä‘á»c.</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">mysql</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> FLUSH TABLES </span><span style="color:#C678DD;--shiki-dark:#C678DD">WITH</span><span style="color:#C678DD;--shiki-dark:#C678DD"> READ</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> LOCK;</span></span></code></pre>
</div><p>(4) Xem tráº¡ng thÃ¡i cá»§a mÃ¡y chá»§ chÃ­nh</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">mysql</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> show </span><span style="color:#C678DD;--shiki-dark:#C678DD">master</span><span style="color:#C678DD;--shiki-dark:#C678DD"> status</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">+</span></span></code></pre>
</div>]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200714115031.png" type="image/png"/>
    </item>
    <item>
      <title>MySQL Optimization</title>
      <link>https://vanhung4499.github.io/database/mysql/optimization.html</link>
      <guid>https://vanhung4499.github.io/database/mysql/optimization.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">MySQL Optimization</source>
      <description>MySQL Optimization Slow Query (Truy váº¥n cháº­m) Nháº­t kÃ½ truy váº¥n cháº­m cÃ³ thá»ƒ giÃºp chÃºng ta tÃ¬m ra cÃ¡c cÃ¢u lá»‡nh SQL thá»±c thi cháº­m. Báº¡n cÃ³ thá»ƒ kiá»ƒm tra xem nháº­t kÃ½ truy váº¥n cháº­m cÃ³ ...</description>
      <category>mysql</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>Slow Query (Truy váº¥n cháº­m)</h2>
<p>Nháº­t kÃ½ truy váº¥n cháº­m cÃ³ thá»ƒ giÃºp chÃºng ta tÃ¬m ra cÃ¡c cÃ¢u lá»‡nh SQL thá»±c thi cháº­m.</p>
<p>Báº¡n cÃ³ thá»ƒ kiá»ƒm tra xem nháº­t kÃ½ truy váº¥n cháº­m cÃ³ Ä‘Æ°á»£c báº­t hay khÃ´ng báº±ng cÃ¡ch sá»­ dá»¥ng lá»‡nh sau:</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">mysql</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> show variables </span><span style="color:#C678DD;--shiki-dark:#C678DD">like</span><span style="color:#98C379;--shiki-dark:#98C379"> '%slow_query_log%'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">+</span></span></code></pre>
</div>]]></content:encoded>
    </item>
    <item>
      <title>MySQL Overview</title>
      <link>https://vanhung4499.github.io/database/mysql/overview.html</link>
      <guid>https://vanhung4499.github.io/database/mysql/overview.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">MySQL Overview</source>
      <description>MySQL Overview Contents</description>
      <category>mysql</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>Contents</h2>
]]></content:encoded>
    </item>
    <item>
      <title>MySQL Replication</title>
      <link>https://vanhung4499.github.io/database/mysql/replication.html</link>
      <guid>https://vanhung4499.github.io/database/mysql/replication.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">MySQL Replication</source>
      <description>MySQL Replication Replication Replication lÃ  má»™t phÆ°Æ¡ng phÃ¡p phá»• biáº¿n Ä‘á»ƒ giáº£i quyáº¿t váº¥n Ä‘á» cÃ³ sáºµn cao cá»§a há»‡ thá»‘ng. Ã tÆ°á»Ÿng cÆ¡ báº£n lÃ : khÃ´ng nÃªn Ä‘á»ƒ táº¥t cáº£ trá»©ng vÃ o má»™t giá». Váº¥n...</description>
      <category>mysql</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>Replication</h2>
<p>Replication lÃ  má»™t phÆ°Æ¡ng phÃ¡p phá»• biáº¿n Ä‘á»ƒ giáº£i quyáº¿t váº¥n Ä‘á» cÃ³ sáºµn cao cá»§a há»‡ thá»‘ng. Ã tÆ°á»Ÿng cÆ¡ báº£n lÃ : khÃ´ng nÃªn Ä‘á»ƒ táº¥t cáº£ trá»©ng vÃ o má»™t giá».</p>
<p>Váº¥n Ä‘á» cÆ¡ báº£n mÃ  replication giáº£i quyáº¿t lÃ  Ä‘á»“ng bá»™ hÃ³a dá»¯ liá»‡u cá»§a má»™t mÃ¡y chá»§ vá»›i cÃ¡c mÃ¡y chá»§ khÃ¡c. Dá»¯ liá»‡u tá»« má»™t mÃ¡y chá»§ chÃ­nh cÃ³ thá»ƒ Ä‘Æ°á»£c replication Ä‘áº¿n nhiá»u mÃ¡y chá»§ dá»± phÃ²ng, vÃ  cÃ¡c mÃ¡y chá»§ dá»± phÃ²ng cÃ³ thá»ƒ Ä‘Æ°á»£c cáº¥u hÃ¬nh thÃ nh má»™t mÃ¡y chá»§ chÃ­nh cho má»™t mÃ¡y chá»§ khÃ¡c. CÃ³ nhiá»u cÃ¡ch khÃ¡c nhau Ä‘á»ƒ káº¿t há»£p mÃ¡y chá»§ chÃ­nh vÃ  mÃ¡y chá»§ dá»± phÃ²ng.</p>
<p>MySQL há»— trá»£ hai phÆ°Æ¡ng phÃ¡p replication: replication dá»±a trÃªn hÃ ng vÃ  replication dá»±a trÃªn cÃ¢u lá»‡nh. Cáº£ hai phÆ°Æ¡ng phÃ¡p Ä‘á»u sá»­ dá»¥ng cÃ¡ch ghi láº¡i bin log trÃªn mÃ¡y chá»§ chÃ­nh vÃ  cháº¡y láº¡i log trÃªn mÃ¡y chá»§ dá»± phÃ²ng Ä‘á»ƒ thá»±c hiá»‡n replication dá»¯ liá»‡u báº¥t Ä‘á»“ng bá»™. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  quÃ¡ trÃ¬nh replication cÃ³ Ä‘á»™ trá»… vÃ  trong khoáº£ng thá»i gian nÃ y, dá»¯ liá»‡u giá»¯a mÃ¡y chá»§ chÃ­nh vÃ  mÃ¡y chá»§ phá»¥ cÃ³ thá»ƒ khÃ´ng Ä‘á»“ng nháº¥t.</p>
<h3>CÃ¡ch thá»©c hoáº¡t Ä‘á»™ng cá»§a replication</h3>
<p>Trong MySQL, quÃ¡ trÃ¬nh replication Ä‘Æ°á»£c chia thÃ nh ba bÆ°á»›c, má»—i bÆ°á»›c do má»™t luá»“ng hoÃ n thÃ nh:</p>
<ul>
<li><strong>Luá»“ng binlog dump</strong> - TrÃªn mÃ¡y chá»§ chÃ­nh cÃ³ má»™t luá»“ng Ä‘áº·c biá»‡t gá»i lÃ  luá»“ng binlog dump, chá»‹u trÃ¡ch nhiá»‡m ghi cÃ¡c thay Ä‘á»•i dá»¯ liá»‡u tá»« mÃ¡y chá»§ chÃ­nh vÃ o binlog.</li>
<li><strong>Luá»“ng I/O</strong> - TrÃªn mÃ¡y chá»§ dá»± phÃ²ng cÃ³ má»™t luá»“ng I/O, chá»‹u trÃ¡ch nhiá»‡m Ä‘á»c binlog tá»« mÃ¡y chá»§ chÃ­nh vÃ  ghi vÃ o log trung gian (relay log) cá»§a mÃ¡y chá»§ dá»± phÃ²ng.</li>
<li><strong>Luá»“ng SQL</strong> - TrÃªn mÃ¡y chá»§ dá»± phÃ²ng cÃ³ má»™t luá»“ng SQL, chá»‹u trÃ¡ch nhiá»‡m Ä‘á»c log trung gian (relay log) vÃ  thá»±c hiá»‡n láº¡i cÃ¡c cÃ¢u lá»‡nh SQL tá»« Ä‘Ã³.</li>
</ul>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624154231.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure>
<p>Kiáº¿n â€‹â€‹trÃºc nÃ y giáº£i quyáº¿t váº¥n Ä‘á» giáº£i phÃ³ng dá»¯ liá»‡u vÃ  Ä‘á»“ng bá»™ hÃ³a dá»¯ liá»‡u báº¥t Ä‘á»“ng bá»™. Tuy nhiÃªn, kiáº¿n â€‹â€‹trÃºc nÃ y cÅ©ng giá»›i háº¡n quÃ¡ trÃ¬nh replication, Ä‘iá»ƒm quan trá»ng nháº¥t lÃ  cÃ¡c truy váº¥n Ä‘ang cháº¡y song song trÃªn mÃ¡y chá»§ chÃ­nh pháº£i Ä‘Æ°á»£c thá»±c hiá»‡n tuáº§n tá»± trÃªn mÃ¡y chá»§ dá»± phÃ²ng, vÃ¬ chá»‰ cÃ³ má»™t luá»“ng SQL Ä‘á»ƒ cháº¡y láº¡i cÃ¡c sá»± kiá»‡n trong relay log.</p>
<h3>Cáº¥u hÃ¬nh replication Master-Slave</h3>
<p>Giáº£ sá»­ báº¡n cáº§n cáº¥u hÃ¬nh má»™t cáº·p nÃºt MySQL Master-Slave vá»›i mÃ´i trÆ°á»ng sau Ä‘Ã¢y:</p>
<ul>
<li>NÃºt Master: 192.168.8.10</li>
<li>NÃºt Slave: 192.168.8.11</li>
</ul>
<h4>CÃ¡c bÆ°á»›c trÃªn nÃºt Master</h4>
<ol>
<li>
<p><strong>Sá»­a Ä‘á»•i cáº¥u hÃ¬nh vÃ  khá»Ÿi Ä‘á»™ng láº¡i</strong></p>
<p>Sá»­ dá»¥ng lá»‡nh <code>vi /etc/my.cnf</code>, thÃªm cÃ¡c cáº¥u hÃ¬nh sau:</p>
</li>
</ol>
<div class="language-ini" data-ext="ini" data-title="ini"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">[mysqld]</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">server-id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">=</span><span style="color:#98C379;--shiki-dark:#98C379">1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">log_bin</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">=</span><span style="color:#98C379;--shiki-dark:#98C379">/var/lib/mysql/binlog</span></span></code></pre>
</div><ul>
<li><code>server-id</code> - ID duy nháº¥t cá»§a mÃ¡y chá»§ trong kiáº¿n â€‹â€‹trÃºc Master-Slave.</li>
<li><code>log_bin</code> - ÄÆ°á»ng dáº«n vÃ  tÃªn táº­p tin log Ä‘á»ƒ Ä‘á»“ng bá»™, Ä‘áº£m báº£o thÆ° má»¥c nÃ y cÃ³ quyá»n ghi cá»§a MySQL.</li>
</ul>
<p>Sau khi chá»‰nh sá»­a, khá»Ÿi Ä‘á»™ng láº¡i MySQL Ä‘á»ƒ cáº­p nháº­t cáº¥u hÃ¬nh:</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">systemctl</span><span style="color:#98C379;--shiki-dark:#98C379"> restart</span><span style="color:#98C379;--shiki-dark:#98C379"> mysql</span></span></code></pre>
</div><ol start="2">
<li><strong>Táº¡o ngÆ°á»i dÃ¹ng Ä‘á»“ng bá»™</strong></li>
</ol>
<p>Truy cáº­p vÃ o MySQL console:</p>
<div class="language-sh" data-ext="sh" data-title="sh"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">$</span><span style="color:#98C379;--shiki-dark:#98C379"> mysql</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -u</span><span style="color:#98C379;--shiki-dark:#98C379"> root</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -p</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">Password:</span></span></code></pre>
</div><p>Thá»±c thi cÃ¡c lá»‡nh SQL sau:</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- a. Táº¡o ngÆ°á»i dÃ¹ng 'slave' cÃ³ thá»ƒ Ä‘Äƒng nháº­p tá»« báº¥t ká»³ Ä‘á»‹a chá»‰ IP nÃ o</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">   CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> USER</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> '</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">slave</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">'@</span><span style="color:#98C379;--shiki-dark:#98C379">'%'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> IDENTIFIED </span><span style="color:#C678DD;--shiki-dark:#C678DD">WITH</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> mysql_native_password </span><span style="color:#C678DD;--shiki-dark:#C678DD">BY</span><span style="color:#98C379;--shiki-dark:#98C379"> 'password'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">   GRANT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> REPLICATION SLAVE </span><span style="color:#C678DD;--shiki-dark:#C678DD">ON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> *.* </span><span style="color:#C678DD;--shiki-dark:#C678DD">TO</span><span style="color:#98C379;--shiki-dark:#98C379"> 'slave'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">@</span><span style="color:#98C379;--shiki-dark:#98C379">'%'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">   -- b. Hoáº·c, táº¡o ngÆ°á»i dÃ¹ng 'slave' cÃ³ thá»ƒ Ä‘Äƒng nháº­p tá»« má»™t Ä‘á»‹a chá»‰ IP cá»¥ thá»ƒ</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">   CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> USER</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> '</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">slave</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">'@</span><span style="color:#98C379;--shiki-dark:#98C379">'192.168.8.11'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> IDENTIFIED </span><span style="color:#C678DD;--shiki-dark:#C678DD">WITH</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> mysql_native_password </span><span style="color:#C678DD;--shiki-dark:#C678DD">BY</span><span style="color:#98C379;--shiki-dark:#98C379"> 'password'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">   GRANT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> REPLICATION SLAVE </span><span style="color:#C678DD;--shiki-dark:#C678DD">ON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> *.* </span><span style="color:#C678DD;--shiki-dark:#C678DD">TO</span><span style="color:#98C379;--shiki-dark:#98C379"> 'slave'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">@</span><span style="color:#98C379;--shiki-dark:#98C379">'192.168.8.11'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">   -- LÃ m má»›i láº¡i cÃ¡c quyá»n</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">   FLUSH PRIVILEGES;</span></span></code></pre>
</div><p>Äá»ƒ Ä‘áº£m báº£o tÆ°Æ¡ng thÃ­ch vá»›i MySQL 8 trá»Ÿ lÃªn, sá»­ dá»¥ng <code>mysql_native_password</code> cho phÆ°Æ¡ng thá»©c xÃ¡c thá»±c.</p>
<ol start="3">
<li><strong>KhÃ³a Ä‘á»c</strong></li>
</ol>
<p>Äá»ƒ Ä‘á»“ng bá»™ dá»¯ liá»‡u giá»¯a Master vÃ  Slave, khÃ³a Ä‘á»c trÃªn Master:</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">   mysql</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> FLUSH TABLES </span><span style="color:#C678DD;--shiki-dark:#C678DD">WITH</span><span style="color:#C678DD;--shiki-dark:#C678DD"> READ</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> LOCK;</span></span></code></pre>
</div><ol start="4">
<li><strong>Xem tráº¡ng thÃ¡i cá»§a Master</strong></li>
</ol>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">   mysql</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> SHOW </span><span style="color:#C678DD;--shiki-dark:#C678DD">MASTER</span><span style="color:#C678DD;--shiki-dark:#C678DD"> STATUS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">   +</span></span></code></pre>
</div>]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624154231.png" type="image/png"/>
    </item>
    <item>
      <title>MySQL Transaction</title>
      <link>https://vanhung4499.github.io/database/mysql/transaction.html</link>
      <guid>https://vanhung4499.github.io/database/mysql/transaction.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">MySQL Transaction</source>
      <description>MySQL Transaction KhÃ´ng pháº£i táº¥t cáº£ cÃ¡c engine lÆ°u trá»¯ cá»§a MySQL Ä‘á»u há»— trá»£ giao dá»‹ch. CÃ¡c engine lÆ°u trá»¯ há»— trá»£ giao dá»‹ch bao gá»“m: InnoDB vÃ  NDB Cluster. CÃ¡c engine lÆ°u trá»¯ khÃ´...</description>
      <category>mysql</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>KhÃ´ng pháº£i táº¥t cáº£ cÃ¡c engine lÆ°u trá»¯ cá»§a MySQL Ä‘á»u há»— trá»£ giao dá»‹ch. CÃ¡c engine lÆ°u trá»¯ há»— trá»£ giao dá»‹ch bao gá»“m:&nbsp;<code>InnoDB</code>&nbsp;vÃ &nbsp;<code>NDB Cluster</code>. CÃ¡c engine lÆ°u trá»¯ khÃ´ng há»— trá»£ giao dá»‹ch bao gá»“m:&nbsp;<code>MyISAM</code>.</p>
<p>NgÆ°á»i dÃ¹ng cÃ³ thá»ƒ chá»n engine lÆ°u trá»¯ phÃ¹ há»£p dá»±a trÃªn viá»‡c cÃ³ cáº§n xá»­ lÃ½ giao dá»‹ch hay khÃ´ng (xá»­ lÃ½ giao dá»‹ch cÃ³ thá»ƒ Ä‘áº£m báº£o an toÃ n dá»¯ liá»‡u nhÆ°ng sáº½ tÄƒng chi phÃ­ há»‡ thá»‘ng).</p>
</blockquote>
<h2>Giá»›i thiá»‡u vá» giao dá»‹ch</h2>
<blockquote>
<p>Giao dá»‹ch Ä‘Æ¡n giáº£n lÃ :&nbsp;<strong>Táº¥t cáº£ cÃ¡c hoáº¡t Ä‘á»™ng trong má»™t phiÃªn lÃ m viá»‡c pháº£i thÃ nh cÃ´ng hoáº·c tháº¥t báº¡i cÃ¹ng nhau</strong>. Cá»¥ thá»ƒ hÆ¡n, giao dá»‹ch lÃ  má»™t nhÃ³m cÃ¡c hoáº¡t Ä‘á»™ng tuÃ¢n thá»§ cÃ¡c Ä‘áº·c Ä‘iá»ƒm ACID, cÃ³ thá»ƒ Ä‘Æ°á»£c gá»­i Ä‘i báº±ng cÃ¡ch sá»­ dá»¥ng&nbsp;<code>Commit</code>&nbsp;Ä‘á»ƒ xÃ¡c nháº­n giao dá»‹ch hoáº·c sá»­ dá»¥ng&nbsp;<code>Rollback</code>&nbsp;Ä‘á»ƒ hoÃ n tÃ¡c giao dá»‹ch.</p>
</blockquote>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/185b9c49-4c13-4241-a848-fbff85c03a64.png" alt="185b9c49-4c13-4241-a848-fbff85c03a64.png" tabindex="0" loading="lazy"><figcaption>185b9c49-4c13-4241-a848-fbff85c03a64.png</figcaption></figure>
<p><strong>Giao dá»‹ch lÃ  má»™t nhÃ³m cÃ¡c cÃ¢u lá»‡nh SQL nguyÃªn tá»­</strong>. Cá»¥ thá»ƒ hÆ¡n, giao dá»‹ch lÃ  má»™t nhÃ³m cÃ¡c hoáº¡t Ä‘á»™ng tuÃ¢n thá»§ cÃ¡c Ä‘áº·c Ä‘iá»ƒm ACID.</p>
<p><strong>CÃ¡c cÃ¢u lá»‡nh SQL trong giao dá»‹ch pháº£i Ä‘Æ°á»£c thá»±c thi hoÃ n toÃ n thÃ nh cÃ´ng hoáº·c tháº¥t báº¡i hoÃ n toÃ n</strong>.</p>
<p><strong>CÃ¡c cÆ¡ cháº¿ cÃ¡ch ly giao dá»‹ch khÃ¡c nhau cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng cÃ¡ch sá»­ dá»¥ng khÃ³a</strong>.</p>
<p>HÃ£y tÆ°á»Ÿng tÆ°á»£ng náº¿u khÃ´ng cÃ³ giao dá»‹ch, trong mÃ´i trÆ°á»ng Ä‘á»“ng thá»i, cÃ³ thá»ƒ xáº£y ra viá»‡c máº¥t mÃ¡t thay Ä‘á»•i.</p>
<p>Hai luá»“ng T1&nbsp;vÃ  T2&nbsp;Ä‘á»u thay Ä‘á»•i dá»¯ liá»‡u, T1&nbsp;thay Ä‘á»•i trÆ°á»›c, T2&nbsp;thay Ä‘á»•i sau, thay Ä‘á»•i cá»§a T2&nbsp;ghi Ä‘Ã¨ lÃªn thay Ä‘á»•i cá»§a T1.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230721002023.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure>
<h2>CÃ¡ch sá»­ dá»¥ng giao dá»‹ch</h2>
<h3>CÃ¡c lá»‡nh xá»­ lÃ½ giao dá»‹ch</h3>
<p>Trong MySQL, sá»­ dá»¥ng cÃ¢u lá»‡nh&nbsp;<code>START TRANSACTION</code>&nbsp;Ä‘á»ƒ báº¯t Ä‘áº§u má»™t giao dá»‹ch; sá»­ dá»¥ng cÃ¢u lá»‡nh&nbsp;<code>COMMIT</code>&nbsp;Ä‘á»ƒ xÃ¡c nháº­n táº¥t cáº£ cÃ¡c thay Ä‘á»•i; sá»­ dá»¥ng cÃ¢u lá»‡nh&nbsp;<code>ROLLBACK</code>&nbsp;Ä‘á»ƒ hoÃ n tÃ¡c táº¥t cáº£ cÃ¡c thay Ä‘á»•i. KhÃ´ng thá»ƒ hoÃ n tÃ¡c cÃ¢u lá»‡nh&nbsp;<code>SELECT</code>, viá»‡c hoÃ n tÃ¡c cÃ¢u lá»‡nh&nbsp;<code>SELECT</code>&nbsp;cÅ©ng khÃ´ng cÃ³ Ã½ nghÄ©a; cÅ©ng khÃ´ng thá»ƒ hoÃ n tÃ¡c cÃ¢u lá»‡nh&nbsp;<code>CREATE</code>&nbsp;vÃ &nbsp;<code>DROP</code>.</p>
<ul>
<li><code>START TRANSACTION</code>&nbsp;- CÃ¢u lá»‡nh dÃ¹ng Ä‘á»ƒ Ä‘Ã¡nh dáº¥u Ä‘iá»ƒm báº¯t Ä‘áº§u cá»§a giao dá»‹ch.</li>
<li><code>SAVEPOINT</code>&nbsp;- CÃ¢u lá»‡nh dÃ¹ng Ä‘á»ƒ táº¡o Ä‘iá»ƒm lÆ°u trá»¯.</li>
<li><code>ROLLBACK TO</code>&nbsp;- CÃ¢u lá»‡nh dÃ¹ng Ä‘á»ƒ hoÃ n tÃ¡c Ä‘áº¿n Ä‘iá»ƒm lÆ°u trá»¯ Ä‘Ã£ chá»‰ Ä‘á»‹nh; náº¿u khÃ´ng cÃ³ Ä‘iá»ƒm lÆ°u trá»¯ Ä‘Æ°á»£c Ä‘áº·t, nÃ³ sáº½ hoÃ n tÃ¡c Ä‘áº¿n cÃ¢u lá»‡nh&nbsp;<code>START TRANSACTION</code>.</li>
<li><code>COMMIT</code>&nbsp;- XÃ¡c nháº­n giao dá»‹ch.</li>
</ul>
<p>VÃ­ dá»¥ xá»­ lÃ½ giao dá»‹ch:</p>
<p>(1) Táº¡o má»™t báº£ng vÃ­ dá»¥</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- XÃ³a báº£ng user náº¿u tá»“n táº¡i</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">DROP</span><span style="color:#C678DD;--shiki-dark:#C678DD"> TABLE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> IF</span><span style="color:#C678DD;--shiki-dark:#C678DD"> EXISTS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> user;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- Táº¡o báº£ng user</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> TABLE</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> user</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> (</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  id </span><span style="color:#C678DD;--shiki-dark:#C678DD">int</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#D19A66;--shiki-dark:#D19A66">10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) unsigned </span><span style="color:#C678DD;--shiki-dark:#C678DD">NOT NULL</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> COMMENT </span><span style="color:#98C379;--shiki-dark:#98C379">'Id'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  username </span><span style="color:#C678DD;--shiki-dark:#C678DD">varchar</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#D19A66;--shiki-dark:#D19A66">64</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#C678DD;--shiki-dark:#C678DD">NOT NULL</span><span style="color:#C678DD;--shiki-dark:#C678DD"> DEFAULT</span><span style="color:#98C379;--shiki-dark:#98C379"> 'default'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> COMMENT </span><span style="color:#98C379;--shiki-dark:#98C379">'TÃªn Ä‘Äƒng nháº­p'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">  password</span><span style="color:#C678DD;--shiki-dark:#C678DD"> varchar</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#D19A66;--shiki-dark:#D19A66">64</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#C678DD;--shiki-dark:#C678DD">NOT NULL</span><span style="color:#C678DD;--shiki-dark:#C678DD"> DEFAULT</span><span style="color:#98C379;--shiki-dark:#98C379"> 'default'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> COMMENT </span><span style="color:#98C379;--shiki-dark:#98C379">'Máº­t kháº©u'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">  email </span><span style="color:#C678DD;--shiki-dark:#C678DD">varchar</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#D19A66;--shiki-dark:#D19A66">64</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#C678DD;--shiki-dark:#C678DD">NOT NULL</span><span style="color:#C678DD;--shiki-dark:#C678DD"> DEFAULT</span><span style="color:#98C379;--shiki-dark:#98C379"> 'default'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> COMMENT </span><span style="color:#98C379;--shiki-dark:#98C379">'Email'</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) COMMENT</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379">'Báº£ng ngÆ°á»i dÃ¹ng'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span></code></pre>
</div><p>(2) Thá»±c hiá»‡n cÃ¡c hoáº¡t Ä‘á»™ng giao dá»‹ch</p>
<div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- Báº¯t Ä‘áº§u giao dá»‹ch</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">START TRANSACTION</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- Thá»±c hiá»‡n hoáº¡t Ä‘á»™ng A</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">INSERT INTO</span><span style="color:#98C379;--shiki-dark:#98C379"> `user`</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">VALUES</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> (</span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">'root1'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">'root1'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">'xxxx@163.com'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- Táº¡o Ä‘iá»ƒm lÆ°u trá»¯ updateA</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">SAVEPOINT updateA;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- Thá»±c hiá»‡n hoáº¡t Ä‘á»™ng B</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">INSERT INTO</span><span style="color:#98C379;--shiki-dark:#98C379"> `user`</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">VALUES</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> (</span><span style="color:#D19A66;--shiki-dark:#D19A66">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">'root2'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">'root2'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#98C379;--shiki-dark:#98C379">'xxxx@163.com'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- HoÃ n tÃ¡c Ä‘áº¿n Ä‘iá»ƒm lÆ°u trá»¯ updateA</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">ROLLBACK</span><span style="color:#C678DD;--shiki-dark:#C678DD"> TO</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> updateA;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- XÃ¡c nháº­n giao dá»‹ch, chá»‰ hoáº¡t Ä‘á»™ng A Ä‘Æ°á»£c Ã¡p dá»¥ng</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">COMMIT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>(3) Káº¿t quáº£ thá»±c thi</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SELECT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> * </span><span style="color:#C678DD;--shiki-dark:#C678DD">FROM</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> user;</span></span></code></pre>
</div><p>Káº¿t quáº£:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>1	root1	root1	xxxx@163.com</span></span></code></pre>
</div><h3>AUTOCOMMIT</h3>
<p><strong>Máº·c Ä‘á»‹nh, MySQL sá»­ dá»¥ng cháº¿ Ä‘á»™ xÃ¡c nháº­n ngáº§m (<code>autocommit</code>)</strong>. Má»—i cÃ¢u lá»‡nh Ä‘Æ°á»£c thá»±c thi Ä‘Æ°á»£c coi lÃ  má»™t giao dá»‹ch vÃ  Ä‘Æ°á»£c xÃ¡c nháº­n. Khi gáº·p cÃ¢u lá»‡nh&nbsp;<code>START TRANSACTION</code>, cháº¿ Ä‘á»™ xÃ¡c nháº­n ngáº§m sáº½ bá»‹ táº¯t; sau khi thá»±c hiá»‡n cÃ¢u lá»‡nh&nbsp;<code>COMMIT</code>&nbsp;hoáº·c&nbsp;<code>ROLLBACK</code>, giao dá»‹ch sáº½ tá»± Ä‘á»™ng Ä‘Ã³ng vÃ  cháº¿ Ä‘á»™ xÃ¡c nháº­n ngáº§m sáº½ Ä‘Æ°á»£c khÃ´i phá»¥c.</p>
<p>Báº±ng cÃ¡ch sá»­ dá»¥ng&nbsp;<code>set autocommit=0</code>, báº¡n cÃ³ thá»ƒ há»§y bá» xÃ¡c nháº­n tá»± Ä‘á»™ng cho Ä‘áº¿n khi&nbsp;<code>set autocommit=1</code>&nbsp;Ä‘Æ°á»£c thá»±c hiá»‡n; cá»&nbsp;<code>autocommit</code>&nbsp;Ä‘Æ°á»£c Ã¡p dá»¥ng cho má»—i káº¿t ná»‘i chá»© khÃ´ng pháº£i cho mÃ¡y chá»§.</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- Xem cá» AUTOCOMMIT</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">SHOW VARIABLES </span><span style="color:#C678DD;--shiki-dark:#C678DD">LIKE</span><span style="color:#98C379;--shiki-dark:#98C379"> 'AUTOCOMMIT'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- Táº¯t AUTOCOMMIT</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SET</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> autocommit </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- Báº­t AUTOCOMMIT</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SET</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> autocommit </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span></code></pre>
</div><h1>ACID</h1>
<p>ACID lÃ  bá»‘n yáº¿u tá»‘ cÆ¡ báº£n Ä‘á»ƒ Ä‘áº£m báº£o thá»±c hiá»‡n giao dá»‹ch Ä‘Ãºng Ä‘áº¯n trong cÆ¡ sá»Ÿ dá»¯ liá»‡u.</p>
<ul>
<li><strong>TÃ­nh nguyÃªn tá»­ (Atomicity)</strong>
<ul>
<li>Giao dá»‹ch Ä‘Æ°á»£c coi lÃ  Ä‘Æ¡n vá»‹ nhá» nháº¥t khÃ´ng thá»ƒ chia tÃ¡ch, táº¥t cáº£ cÃ¡c hoáº¡t Ä‘á»™ng trong giao dá»‹ch pháº£i Ä‘Æ°á»£c thá»±c hiá»‡n hoÃ n toÃ n thÃ nh cÃ´ng hoáº·c hoÃ n toÃ n tháº¥t báº¡i.</li>
<li>Rollback cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng cÃ¡ch sá»­ dá»¥ng nháº­t kÃ½, nháº­t kÃ½ ghi láº¡i cÃ¡c thay Ä‘á»•i Ä‘Æ°á»£c thá»±c hiá»‡n trong giao dá»‹ch vÃ  thá»±c hiá»‡n ngÆ°á»£c láº¡i cÃ¡c thay Ä‘á»•i nÃ y khi rollback.</li>
</ul>
</li>
<li><strong>TÃ­nh nháº¥t quÃ¡n (Consistency)</strong>
<ul>
<li>CÆ¡ sá»Ÿ dá»¯ liá»‡u duy trÃ¬ tráº¡ng thÃ¡i nháº¥t quÃ¡n trÆ°á»›c vÃ  sau khi thá»±c hiá»‡n giao dá»‹ch.</li>
<li>Trong tráº¡ng thÃ¡i nháº¥t quÃ¡n, káº¿t quáº£ Ä‘á»c cá»§a táº¥t cáº£ cÃ¡c giao dá»‹ch Ä‘á»‘i vá»›i má»™t dá»¯ liá»‡u lÃ  giá»‘ng nhau.</li>
</ul>
</li>
<li><strong>TÃ­nh cÃ´ láº­p (Isolation)</strong>
<ul>
<li>Sá»± thay Ä‘á»•i mÃ  má»™t giao dá»‹ch thá»±c hiá»‡n khÃ´ng Ä‘Æ°á»£c nhÃ¬n tháº¥y bá»Ÿi cÃ¡c giao dá»‹ch khÃ¡c cho Ä‘áº¿n khi nÃ³ Ä‘Æ°á»£c cam káº¿t.</li>
</ul>
</li>
<li><strong>TÃ­nh bá»n vá»¯ng (Durability)</strong>
<ul>
<li>Khi má»™t giao dá»‹ch Ä‘Æ°á»£c cam káº¿t, cÃ¡c thay Ä‘á»•i mÃ  nÃ³ thá»±c hiá»‡n sáº½ Ä‘Æ°á»£c lÆ°u trá»¯ vÄ©nh viá»…n trong cÆ¡ sá»Ÿ dá»¯ liá»‡u. Ngay cáº£ khi há»‡ thá»‘ng gáº·p sá»± cá»‘, káº¿t quáº£ cá»§a giao dá»‹ch váº«n khÃ´ng bá»‹ máº¥t.</li>
<li>Äiá»u nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c Ä‘áº¡t Ä‘Æ°á»£c báº±ng sao lÆ°u vÃ  khÃ´i phá»¥c cÆ¡ sá»Ÿ dá»¯ liá»‡u, trong trÆ°á»ng há»£p há»‡ thá»‘ng gáº·p sá»± cá»‘.</li>
</ul>
</li>
</ul>
<p><strong>Há»‡ thá»‘ng cÆ¡ sá»Ÿ dá»¯ liá»‡u há»— trá»£ giao dá»‹ch pháº£i cÃ³ bá»‘n tÃ­nh cháº¥t nÃ y, náº¿u khÃ´ng, khÃ´ng thá»ƒ Ä‘áº£m báº£o tÃ­nh chÃ­nh xÃ¡c cá»§a dá»¯ liá»‡u trong quÃ¡ trÃ¬nh giao dá»‹ch.</strong></p>
<ul>
<li>Chá»‰ khi tuÃ¢n thá»§ tÃ­nh nháº¥t quÃ¡n, káº¿t quáº£ thá»±c hiá»‡n cá»§a giao dá»‹ch má»›i lÃ  chÃ­nh xÃ¡c.</li>
<li>Trong trÆ°á»ng há»£p khÃ´ng cÃ³ sá»± cáº¡nh tranh, khi giao dá»‹ch Ä‘Æ°á»£c thá»±c hiá»‡n tuáº§n tá»±, tÃ­nh cÃ´ láº­p sáº½ Ä‘Æ°á»£c Ä‘áº£m báº£o. Khi Ä‘Ã³, chá»‰ cáº§n Ä‘áº£m báº£o tÃ­nh nguyÃªn tá»­, tÃ­nh nháº¥t quÃ¡n cÅ©ng sáº½ Ä‘Æ°á»£c Ä‘áº£m báº£o.</li>
<li>Trong trÆ°á»ng há»£p cÃ³ sá»± cáº¡nh tranh, khi nhiá»u giao dá»‹ch Ä‘Æ°á»£c thá»±c hiá»‡n song song, giao dá»‹ch khÃ´ng chá»‰ cáº§n Ä‘áº£m báº£o tÃ­nh nguyÃªn tá»­ mÃ  cÃ²n cáº§n Ä‘áº£m báº£o tÃ­nh cÃ´ láº­p Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh nháº¥t quÃ¡n.</li>
<li>TÃ­nh bá»n vá»¯ng cá»§a giao dá»‹ch lÃ  Ä‘á»ƒ xá»­ lÃ½ trÆ°á»ng há»£p há»‡ thá»‘ng gáº·p sá»± cá»‘.</li>
</ul>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/acid.png" alt="acid.png" tabindex="0" loading="lazy"><figcaption>acid.png</figcaption></figure>
<blockquote>
<p>Mysql máº·c Ä‘á»‹nh sá»­ dá»¥ng cháº¿ Ä‘á»™ tá»± Ä‘á»™ng cam káº¿t (<code>AUTO COMMIT</code>). Äiá»u nÃ y cÃ³ nghÄ©a lÃ  náº¿u khÃ´ng sá»­ dá»¥ng rÃµ rÃ ng cÃ¢u lá»‡nh&nbsp;<code>START TRANSACTION</code>&nbsp;Ä‘á»ƒ báº¯t Ä‘áº§u má»™t giao dá»‹ch, má»—i cÃ¢u lá»‡nh truy váº¥n sáº½ Ä‘Æ°á»£c coi lÃ  má»™t giao dá»‹ch vÃ  tá»± Ä‘á»™ng cam káº¿t.</p>
</blockquote>
<h2>CÃ¡c cáº¥p Ä‘á»™ cÃ´ láº­p giao dá»‹ch</h2>
<h3>Giá»›i thiá»‡u vá» cáº¥p Ä‘á»™ cÃ´ láº­p giao dá»‹ch</h3>
<p>Trong mÃ´i trÆ°á»ng Ä‘á»“ng thá»i, ráº¥t khÃ³ Ä‘áº£m báº£o tÃ­nh cÃ´ láº­p cá»§a giao dá»‹ch, do Ä‘Ã³ sáº½ xuáº¥t hiá»‡n nhiá»u váº¥n Ä‘á» vá» tÃ­nh nháº¥t quÃ¡n:</p>
<ul>
<li><strong>Máº¥t mÃ¡t thay Ä‘á»•i</strong></li>
<li><strong>Äá»c báº©n (Dirty Read)</strong></li>
<li><strong>Äá»c khÃ´ng nháº¥t quÃ¡n (Non-Repeatable Read)</strong></li>
<li><strong>Äá»c áº£o (Phantom Read)</strong></li>
</ul>
<p>Trong tiÃªu chuáº©n SQL, xÃ¡c Ä‘á»‹nh bá»‘n cáº¥p Ä‘á»™ cÃ´ láº­p giao dá»‹ch (tá»« tháº¥p Ä‘áº¿n cao):</p>
<ul>
<li><strong>Äá»c chÆ°a cam káº¿t (Read Uncommitted)</strong></li>
<li><strong>Äá»c Ä‘Ã£ cam káº¿t (Read Committed)</strong></li>
<li><strong>Äá»c láº·p láº¡i (Repeatable Read)</strong></li>
<li><strong>Serializable (Serializable)</strong></li>
</ul>
<p>Xem vÃ  thiáº¿t láº­p cáº¥p Ä‘á»™ cÃ´ láº­p giao dá»‹ch trong MySQL:</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- Xem cáº¥p Ä‘á»™ cÃ´ láº­p giao dá»‹ch</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">SHOW VARIABLES </span><span style="color:#C678DD;--shiki-dark:#C678DD">LIKE</span><span style="color:#98C379;--shiki-dark:#98C379"> 'transaction_isolation'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- Thiáº¿t láº­p cáº¥p Ä‘á»™ cÃ´ láº­p giao dá»‹ch lÃ  READ UNCOMMITTED</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SET</span><span style="color:#C678DD;--shiki-dark:#C678DD"> SESSION</span><span style="color:#C678DD;--shiki-dark:#C678DD"> TRANSACTION</span><span style="color:#C678DD;--shiki-dark:#C678DD"> ISOLATION</span><span style="color:#C678DD;--shiki-dark:#C678DD"> LEVEL</span><span style="color:#C678DD;--shiki-dark:#C678DD"> READ</span><span style="color:#C678DD;--shiki-dark:#C678DD"> UNCOMMITTED</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- Thiáº¿t láº­p cáº¥p Ä‘á»™ cÃ´ láº­p giao dá»‹ch lÃ  READ COMMITTED</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SET</span><span style="color:#C678DD;--shiki-dark:#C678DD"> SESSION</span><span style="color:#C678DD;--shiki-dark:#C678DD"> TRANSACTION</span><span style="color:#C678DD;--shiki-dark:#C678DD"> ISOLATION</span><span style="color:#C678DD;--shiki-dark:#C678DD"> LEVEL</span><span style="color:#C678DD;--shiki-dark:#C678DD"> READ</span><span style="color:#C678DD;--shiki-dark:#C678DD"> COMMITTED</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- Thiáº¿t láº­p cáº¥p Ä‘á»™ cÃ´ láº­p giao dá»‹ch lÃ  REPEATABLE READ</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SET</span><span style="color:#C678DD;--shiki-dark:#C678DD"> SESSION</span><span style="color:#C678DD;--shiki-dark:#C678DD"> TRANSACTION</span><span style="color:#C678DD;--shiki-dark:#C678DD"> ISOLATION</span><span style="color:#C678DD;--shiki-dark:#C678DD"> LEVEL</span><span style="color:#C678DD;--shiki-dark:#C678DD"> REPEATABLE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> READ</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- Thiáº¿t láº­p cáº¥p Ä‘á»™ cÃ´ láº­p giao dá»‹ch lÃ  SERIALIZABLE</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SET</span><span style="color:#C678DD;--shiki-dark:#C678DD"> SESSION</span><span style="color:#C678DD;--shiki-dark:#C678DD"> TRANSACTION</span><span style="color:#C678DD;--shiki-dark:#C678DD"> ISOLATION</span><span style="color:#C678DD;--shiki-dark:#C678DD"> LEVEL</span><span style="color:#C678DD;--shiki-dark:#C678DD"> SERIALIZABLE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span></code></pre>
</div><h3>Äá»c chÆ°a cam káº¿t</h3>
<p><strong><code>Äá»c chÆ°a cam káº¿t (Read Uncommitted)</code></strong>&nbsp;cÃ³ nghÄ©a lÃ : CÃ¡c thay Ä‘á»•i trong giao dá»‹ch, ngay cáº£ khi chÆ°a Ä‘Æ°á»£c cam káº¿t, cÅ©ng cÃ³ thá»ƒ nhÃ¬n tháº¥y bá»Ÿi cÃ¡c giao dá»‹ch khÃ¡c.</p>
<p>Váº¥n Ä‘á» cá»§a Ä‘á»c chÆ°a cam káº¿t: Giao dá»‹ch cÃ³ thá»ƒ Ä‘á»c dá»¯ liá»‡u chÆ°a Ä‘Æ°á»£c cam káº¿t, cÃ²n Ä‘Æ°á»£c gá»i lÃ &nbsp;<strong>Ä‘á»c báº©n (Dirty Read)</strong>.</p>
<p>T1&nbsp;thay Ä‘á»•i má»™t dá»¯ liá»‡u, T2&nbsp;sau Ä‘Ã³ Ä‘á»c dá»¯ liá»‡u nÃ y. Náº¿u T1&nbsp;há»§y bá» thay Ä‘á»•i nÃ y, thÃ¬ dá»¯ liá»‡u Ä‘á»c bá»Ÿi T2&nbsp;lÃ  dá»¯ liá»‡u báº©n.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/202307210021321.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure>
<h3>Äá»c Ä‘Ã£ cam káº¿t</h3>
<p><strong><code>Äá»c Ä‘Ã£ cam káº¿t (Read Committed)</code></strong>&nbsp;cÃ³ nghÄ©a lÃ : CÃ¡c thay Ä‘á»•i trong giao dá»‹ch chá»‰ cÃ³ thá»ƒ nhÃ¬n tháº¥y bá»Ÿi cÃ¡c giao dá»‹ch khÃ¡c sau khi Ä‘Ã£ Ä‘Æ°á»£c cam káº¿t. NÃ³ giáº£i quyáº¿t váº¥n Ä‘á» Ä‘á»c dÆ¡ báº©n.</p>
<p>Äá»c Ä‘Ã£ cam káº¿t lÃ  cáº¥p Ä‘á»™ cÃ´ láº­p máº·c Ä‘á»‹nh cá»§a háº§u háº¿t cÃ¡c cÆ¡ sá»Ÿ dá»¯ liá»‡u.</p>
<p>Váº¥n Ä‘á» cá»§a Ä‘á»c Ä‘Ã£ cam káº¿t: Khi thá»±c hiá»‡n hai láº§n truy váº¥n giá»‘ng nhau, káº¿t quáº£ cÃ³ thá»ƒ khÃ´ng nháº¥t quÃ¡n.</p>
<p>T2&nbsp;Ä‘á»c má»™t dá»¯ liá»‡u, T1&nbsp;thay Ä‘á»•i dá»¯ liá»‡u nÃ y. Náº¿u T2&nbsp;Ä‘á»c dá»¯ liá»‡u nÃ y láº§n ná»¯a, káº¿t quáº£ Ä‘á»c sáº½ khÃ¡c vá»›i káº¿t quáº£ Ä‘á»c láº§n Ä‘áº§u.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230721002326.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure>
<h3>Äá»c láº·p láº¡i</h3>
<p><strong><code>Äá»c láº·p láº¡i (Repeatable Read)</code></strong>&nbsp;cÃ³ nghÄ©a lÃ : Äáº£m báº£o káº¿t quáº£ cá»§a viá»‡c Ä‘á»c nhiá»u láº§n cÃ¹ng má»™t dá»¯ liá»‡u trong cÃ¹ng má»™t giao dá»‹ch lÃ  giá»‘ng nhau. Äá»c láº·p láº¡i giáº£i quyáº¿t váº¥n Ä‘á» Ä‘á»c khÃ´ng nháº¥t quÃ¡n.</p>
<p>Äá»c láº·p láº¡i lÃ  cáº¥p Ä‘á»™ cÃ´ láº­p máº·c Ä‘á»‹nh cá»§a MySQL.</p>
<p>Váº¥n Ä‘á» cá»§a Ä‘á»c láº·p láº¡i: Khi má»™t giao dá»‹ch T1 Ä‘á»c má»™t pháº¡m vi dá»¯ liá»‡u, giao dá»‹ch T2 chÃ¨n má»™t báº£n ghi má»›i vÃ o pháº¡m vi Ä‘Ã³, sau Ä‘Ã³ giao dá»‹ch T1 Ä‘á»c láº¡i pháº¡m vi dá»¯ liá»‡u nÃ y, káº¿t quáº£ Ä‘á»c sáº½ khÃ¡c vá»›i káº¿t quáº£ Ä‘á»c láº§n Ä‘áº§u, Ä‘Æ°á»£c gá»i lÃ &nbsp;<strong>Ä‘á»c áº£o (Phantom Read)</strong>.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230721002333.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure>
<h3>Tuáº§n tá»± hoÃ¡</h3>
<p><strong><code>Tuáº§n tá»± hoÃ¡ (Serializable)</code></strong>&nbsp;cÃ³ nghÄ©a lÃ : Buá»™c giao dá»‹ch thá»±c hiá»‡n tuáº§n tá»±, khÃ³a Ä‘á»c vÃ  ghi cho cÃ¹ng má»™t hÃ ng dá»¯ liá»‡u. Náº¿u xáº£y ra xung Ä‘á»™t khÃ³a, giao dá»‹ch phÃ­a trÆ°á»›c pháº£i chá» giao dá»‹ch phÃ­a sau giáº£i phÃ³ng khÃ³a.</p>
<p>Thá»±c hiá»‡n giao dá»‹ch tuáº§n tá»± sáº½ trÃ¡nh táº¥t cáº£ cÃ¡c váº¥n Ä‘á» Ä‘á»“ng thá»i. Chiáº¿n lÆ°á»£c tuáº§n tá»± hÃ³a sáº½ khÃ³a tá»«ng hÃ ng dá»¯ liá»‡u Ä‘Æ°á»£c Ä‘á»c, Ä‘iá»u nÃ y cÃ³ thá»ƒ dáº«n Ä‘áº¿n nhiá»u thá»i gian chá» vÃ  cáº¡nh tranh khÃ³a. Äiá»u nÃ y gáº§n nhÆ° khÃ´ng thá»ƒ cháº¥p nháº­n Ä‘Æ°á»£c Ä‘á»‘i vá»›i cÃ¡c á»©ng dá»¥ng cÃ³ Ä‘á»™ táº£i cao, vÃ¬ váº­y thÆ°á»ng khÃ´ng sá»­ dá»¥ng cáº¥p Ä‘á»™ nÃ y.</p>
<h3>TÃ³m táº¯t vá» cÃ¡c cáº¥p Ä‘á»™ cÃ´ láº­p</h3>
<ul>
<li><strong><code>Äá»c chÆ°a cam káº¿t (Read Uncommitted)</code></strong>&nbsp;- CÃ¡c thay Ä‘á»•i trong giao dá»‹ch, ngay cáº£ khi chÆ°a Ä‘Æ°á»£c cam káº¿t, cÅ©ng cÃ³ thá»ƒ nhÃ¬n tháº¥y bá»Ÿi cÃ¡c giao dá»‹ch khÃ¡c.</li>
<li><strong><code>Äá»c Ä‘Ã£ cam káº¿t (Read Committed)</code></strong>&nbsp;- CÃ¡c thay Ä‘á»•i trong giao dá»‹ch chá»‰ cÃ³ thá»ƒ nhÃ¬n tháº¥y bá»Ÿi cÃ¡c giao dá»‹ch khÃ¡c sau khi Ä‘Ã£ Ä‘Æ°á»£c cam káº¿t.</li>
<li><strong><code>Äá»c láº·p láº¡i (Repeatable Read)</code></strong>&nbsp;- Äáº£m báº£o káº¿t quáº£ cá»§a viá»‡c Ä‘á»c nhiá»u láº§n cÃ¹ng má»™t dá»¯ liá»‡u trong cÃ¹ng má»™t giao dá»‹ch lÃ  giá»‘ng nhau.</li>
<li><strong><code>Tuáº§n tá»± hoÃ¡ (Serializable)</code></strong>&nbsp;- Buá»™c giao dá»‹ch thá»±c hiá»‡n tuáº§n tá»±, khÃ³a Ä‘á»c vÃ  ghi cho cÃ¹ng má»™t hÃ ng dá»¯ liá»‡u.</li>
</ul>
<p>CÃ¡c váº¥n Ä‘á» Ä‘Æ°á»£c giáº£i quyáº¿t bá»Ÿi cÃ¡c cáº¥p Ä‘á»™ cÃ´ láº­p giao dá»‹ch:</p>
<p>| Cáº¥p Ä‘á»™ cÃ´ láº­p | Máº¥t mÃ¡t thay Ä‘á»•i | Äá»c báº©n | Äá»c khÃ´ng nháº¥t quÃ¡n | Äá»c áº£o |<br>
| :</p>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/185b9c49-4c13-4241-a848-fbff85c03a64.png" type="image/png"/>
    </item>
    <item>
      <title>Redis</title>
      <link>https://vanhung4499.github.io/database/redis/</link>
      <guid>https://vanhung4499.github.io/database/redis/</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Redis</source>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
    </item>
    <item>
      <title>Redis In Action</title>
      <link>https://vanhung4499.github.io/database/redis/action.html</link>
      <guid>https://vanhung4499.github.io/database/redis/action.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Redis In Action</source>
      <description>Redis in action Redis cÃ³ thá»ƒ Ä‘Æ°á»£c Ã¡p dá»¥ng trong nhiá»u tÃ¬nh huá»‘ng, dÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ tÃ¬nh huá»‘ng sá»­ dá»¥ng phá»• biáº¿n. Bá»™ nhá»› Ä‘á»‡m Bá»™ nhá»› Ä‘á»‡m lÃ  ká»‹ch báº£n á»©ng dá»¥ng phá»• biáº¿n nháº¥t cá»§a Re...</description>
      <category>db</category>
      <category>redis</category>
      <category>nosql</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>Redis cÃ³ thá»ƒ Ä‘Æ°á»£c Ã¡p dá»¥ng trong nhiá»u tÃ¬nh huá»‘ng, dÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ tÃ¬nh huá»‘ng sá»­ dá»¥ng phá»• biáº¿n.</p>
</blockquote>
<h2>Bá»™ nhá»› Ä‘á»‡m</h2>
<p>Bá»™ nhá»› Ä‘á»‡m lÃ  ká»‹ch báº£n á»©ng dá»¥ng phá»• biáº¿n nháº¥t cá»§a Redis.</p>
<p>Redis cÃ³ nhiá»u loáº¡i dá»¯ liá»‡u vÃ  lá»‡nh hoáº¡t Ä‘á»™ng phong phÃº, Ä‘á»“ng thá»i cÃ³ cÃ¡c tÃ­nh nÄƒng hiá»‡u suáº¥t cao vÃ  tÃ­nh sáºµn sÃ ng cao, khiáº¿n nÃ³ ráº¥t phÃ¹ há»£p cho bá»™ nhá»› Ä‘á»‡m phÃ¢n tÃ¡n.</p>
<blockquote>
<p>NguyÃªn táº¯c cÆ¡ báº£n cá»§a viá»‡c sá»­ dá»¥ng cache, vui lÃ²ng tham kháº£o pháº§n <a href=""><strong>NguyÃªn táº¯c cÆ¡ báº£n cá»§a cache</strong></a>.</p>
</blockquote>
<h2>BitMap vÃ  BloomFilter</h2>
<p>Redis khÃ´ng chá»‰ há»— trá»£ 5 loáº¡i dá»¯ liá»‡u cÆ¡ báº£n mÃ  cÃ²n cÃ³ BitMap vÃ  BloomFilter (bá»™ lá»c Bloom, cÃ³ thá»ƒ Ä‘Æ°á»£c há»— trá»£ thÃ´ng qua Redis Module).</p>
<p>BitMap vÃ  BloomFilter Ä‘á»u cÃ³ thá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» xuyÃªn tháº¥u bá»™ nhá»› Ä‘á»‡m. Äiá»ƒm quan trá»ng lÃ : lá»c ra cÃ¡c dá»¯ liá»‡u khÃ´ng thá»ƒ tá»“n táº¡i.</p>
<blockquote>
<p>Váº¥n Ä‘á» cache penetration cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m hiá»ƒu táº¡i: [<strong>NguyÃªn táº¯c cÆ¡ báº£n cá»§a cache</strong>]</p>
</blockquote>
<h3>BitMap</h3>
<ul>
<li>BitMap thÃ­ch há»£p cho cÃ¡c táº­p dá»¯ liá»‡u nhá».</li>
<li>DÃ¹ng Ä‘á»ƒ hiá»‡u quáº£ Ä‘Ã¡nh dáº¥u sá»± tá»“n táº¡i cá»§a cÃ¡c dá»¯ liá»‡u, tá»« Ä‘Ã³ giÃºp loáº¡i bá» cÃ¡c truy váº¥n khÃ´ng cáº§n thiáº¿t.</li>
</ul>
<h3>BloomFilter</h3>
<ul>
<li>BloomFilter thÃ­ch há»£p cho cÃ¡c táº­p dá»¯ liá»‡u lá»›n.</li>
<li>Sá»­ dá»¥ng Ä‘á»ƒ kiá»ƒm tra xem má»™t pháº§n tá»­ cÃ³ tá»“n táº¡i trong táº­p dá»¯ liá»‡u hay khÃ´ng, mÃ  khÃ´ng cáº§n pháº£i láº¥y toÃ n bá»™ dá»¯ liá»‡u tá»« bá»™ nhá»› Ä‘á»‡m.</li>
</ul>
<h2>KhÃ³a phÃ¢n tÃ¡n (Distributed Lock)</h2>
<p>Sá»­ dá»¥ng Redis nhÆ° má»™t khÃ³a phÃ¢n tÃ¡n cÃ³ nhá»¯ng Ä‘iá»ƒm cÆ¡ báº£n sau:</p>
<ul>
<li><strong>Sá»± Ä‘á»™c quyá»n</strong>: Sá»­ dá»¥ng <code>setnx</code> Ä‘á»ƒ chiáº¿m giá»¯ khÃ³a.</li>
<li><strong>TrÃ¡nh khÃ´ng giáº£i phÃ³ng khÃ³a mÃ£i mÃ£i</strong>: Sá»­ dá»¥ng <code>expire</code> Ä‘á»ƒ Ä‘áº·t thá»i gian háº¿t háº¡n, trÃ¡nh tÃ¬nh tráº¡ng giá»¯ khÃ³a mÃ£i mÃ£i gÃ¢y táº¯c ngháº½n.</li>
<li><strong>TÃ­nh nguyÃªn tá»­</strong>: <code>setnx</code> vÃ  <code>expire</code> pháº£i Ä‘Æ°á»£c thá»±c hiá»‡n nhÆ° má»™t lá»‡nh nguyÃªn tá»­, trÃ¡nh tÃ¬nh tráº¡ng chiáº¿m giá»¯ khÃ³a xong mÃ¡y chá»§ bá»‹ sáº­p mÃ  khÃ´ng ká»‹p Ä‘áº·t expire, dáº«n Ä‘áº¿n khÃ´ng giáº£i phÃ³ng khÃ³a.</li>
</ul>
<blockquote>
<p>Äá»ƒ biáº¿t thÃªm vá» cÃ¡c cÃ¡ch triá»ƒn khai khÃ³a phÃ¢n tÃ¡n vÃ  chi tiáº¿t, vui lÃ²ng tham kháº£o: <a href=""><strong>NguyÃªn táº¯c cÆ¡ báº£n cá»§a khÃ³a phÃ¢n tÃ¡n</strong></a></p>
</blockquote>
<h2>keys vÃ  scan</h2>
<p>Sá»­ dá»¥ng lá»‡nh <code>keys</code> Ä‘á»ƒ quÃ©t danh sÃ¡ch cÃ¡c key theo má»™t máº«u nháº¥t Ä‘á»‹nh.</p>
<p>Náº¿u Redis Ä‘Ã³ Ä‘ang phá»¥c vá»¥ dá»‹ch vá»¥ trá»±c tuyáº¿n, viá»‡c sá»­ dá»¥ng lá»‡nh <code>keys</code> sáº½ gáº·p váº¥n Ä‘á»:</p>
<p>Äáº§u tiÃªn, Redis lÃ  há»‡ thá»‘ng Ä‘Æ¡n luá»“ng. Lá»‡nh <code>keys</code> sáº½ gÃ¢y cháº·n luá»“ng má»™t khoáº£ng thá»i gian, dáº«n Ä‘áº¿n dá»«ng dá»‹ch vá»¥ trá»±c tuyáº¿n cho Ä‘áº¿n khi lá»‡nh Ä‘Æ°á»£c thá»±c thi xong.</p>
<p>Trong trÆ°á»ng há»£p nÃ y, cÃ³ thá»ƒ sá»­ dá»¥ng lá»‡nh <code>scan</code>. Lá»‡nh <code>scan</code> cho phÃ©p trÃ­ch xuáº¥t danh sÃ¡ch cÃ¡c key theo máº«u mÃ  khÃ´ng cháº·n luá»“ng. Tuy nhiÃªn, cÃ³ thá»ƒ xáº£y ra sá»± trÃ¹ng láº·p nháº¥t Ä‘á»‹nh, vÃ  cáº§n thá»±c hiá»‡n loáº¡i bá» trÃ¹ng láº·p á»Ÿ phÃ­a mÃ¡y khÃ¡ch, tuy nhiÃªn tá»•ng thá»i gian thá»±c hiá»‡n cÃ³ thá»ƒ dÃ i hÆ¡n so vá»›i viá»‡c sá»­ dá»¥ng trá»±c tiáº¿p lá»‡nh <code>keys</code>.</p>
<p>Tuy nhiÃªn, cÃ¡c lá»‡nh duyá»‡t tÄƒng dáº§n cÅ©ng khÃ´ng pháº£i lÃ  khÃ´ng cÃ³ Ä‘iá»ƒm yáº¿u: vÃ­ dá»¥, lá»‡nh <code>SMEMBERS</code> cÃ³ thá»ƒ tráº£ vá» táº¥t cáº£ cÃ¡c pháº§n tá»­ hiá»‡n cÃ³ trong táº­p há»£p, nhÆ°ng Ä‘á»‘i vá»›i cÃ¡c lá»‡nh duyá»‡t tÄƒng dáº§n nhÆ° <code>SCAN</code>, do quÃ¡ trÃ¬nh duyá»‡t tÄƒng dáº§n cÃ³ thá»ƒ sá»­a Ä‘á»•i cÃ¡c key, nÃªn chá»‰ cÃ³ thá»ƒ Ä‘áº£m báº£o giá»›i háº¡n Ä‘á»‘i vá»›i cÃ¡c pháº§n tá»­ Ä‘Æ°á»£c tráº£ vá».</p>
<h2>Xá»­ lÃ½ cÃ¡c Key lá»›n trong Redis</h2>
<h3>Key lá»›n Redis lÃ  gÃ¬?</h3>
<p>Key lá»›n trong Redis khÃ´ng chá»‰ Ä‘Æ¡n thuáº§n lÃ  giÃ¡ trá»‹ cá»§a key lá»›n mÃ  lÃ  giÃ¡ trá»‹ mÃ  key Ä‘Ã³ Ä‘ang lÆ°u trá»¯.</p>
<p>ThÆ°á»ng thÃ¬ hai trÆ°á»ng há»£p sau Ä‘Æ°á»£c gá»i lÃ  "Key lá»›n":</p>
<ul>
<li>GiÃ¡ trá»‹ cá»§a kiá»ƒu String lá»›n hÆ¡n 10 KB;</li>
<li>Sá»‘ lÆ°á»£ng pháº§n tá»­ trong cÃ¡c kiá»ƒu Hash, List, Set, ZSet lá»›n hÆ¡n 5000 pháº§n tá»­</li>
</ul>
<h3>Key lá»›n cÃ³ thá»ƒ gÃ¢y ra váº¥n Ä‘á» gÃ¬?</h3>
<p>Key lá»›n cÃ³ thá»ƒ gÃ¢y ra cÃ¡c váº¥n Ä‘á» sau Ä‘Ã¢y:</p>
<ul>
<li><strong>Cháº·n thá»i gian chá» cá»§a khÃ¡ch hÃ ng</strong>: Do Redis xá»­ lÃ½ cÃ¡c lá»‡nh theo luá»“ng Ä‘Æ¡n, cÃ¡c thao tÃ¡c vá»›i key lá»›n cÃ³ thá»ƒ tá»‘n nhiá»u thá»i gian, lÃ m cho Redis bá»‹ cháº·n vÃ  khÃ¡ch hÃ ng khÃ´ng nháº­n Ä‘Æ°á»£c pháº£n há»“i trong má»™t thá»i gian dÃ i.</li>
<li><strong>GÃ¢y ra ngháº½n máº¡ng</strong>: Viá»‡c truy xuáº¥t key lá»›n táº¡o ra lÆ°u lÆ°á»£ng máº¡ng lá»›n. VÃ­ dá»¥, náº¿u má»™t key cÃ³ kÃ­ch thÆ°á»›c lÃ  1 MB vÃ  cÃ³ 1000 láº§n truy cáº­p má»—i giÃ¢y, Ä‘iá»u nÃ y cÃ³ thá»ƒ táº¡o ra 1000 MB lÆ°u lÆ°á»£ng máº¡ng má»—i giÃ¢y, gÃ¢y khÃ³ khÄƒn cho mÃ¡y chá»§ cÃ³ card máº¡ng gigabit.</li>
<li><strong>Cháº·n luá»“ng lÃ m viá»‡c</strong>: XÃ³a má»™t key lá»›n cÃ³ thá»ƒ cháº·n luá»“ng lÃ m viá»‡c, khÃ´ng cho phÃ©p xá»­ lÃ½ cÃ¡c lá»‡nh tiáº¿p theo.</li>
<li><strong>PhÃ¢n phá»‘i bá»™ nhá»› khÃ´ng Ä‘á»“ng Ä‘á»u</strong>: Trong mÃ´ hÃ¬nh cá»¥m, náº¿u má»™t sá»‘ node Redis chá»©a cÃ¡c key lá»›n, chÃºng cÃ³ thá»ƒ chiáº¿m nhiá»u bá»™ nhá»› hÆ¡n vÃ  táº¡o ra má»™t sá»‘ lÆ°á»£ng truy váº¥n má»—i giÃ¢y (QPS) lá»›n hÆ¡n.</li>
</ul>
<h3>LÃ m tháº¿ nÃ o Ä‘á»ƒ tÃ¬m kiáº¿m cÃ¡c Key lá»›n?</h3>
<p><strong><em>1. Sá»­ dá»¥ng redis-cli --bigkeys Ä‘á»ƒ tÃ¬m kiáº¿m cÃ¡c key lá»›n</em></strong></p>
<p>Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng lá»‡nh <code>redis-cli --bigkeys</code> Ä‘á»ƒ tÃ¬m kiáº¿m cÃ¡c key lá»›n trong Redis:</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">redis-cli</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -h</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 127.0.0.1</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -p</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 6379</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -a</span><span style="color:#98C379;--shiki-dark:#98C379"> "password"</span><span style="color:#D19A66;--shiki-dark:#D19A66"> --</span><span style="color:#98C379;--shiki-dark:#98C379"> bigkeys</span></span></code></pre>
</div><p>LÆ°u Ã½ khi sá»­ dá»¥ng:</p>
<ul>
<li>NÃªn thá»±c hiá»‡n lá»‡nh nÃ y trÃªn cÃ¡c node slave thay vÃ¬ node master. Viá»‡c thá»±c hiá»‡n trÃªn node master cÃ³ thá»ƒ gÃ¢y ra sá»± cháº­m trá»….</li>
<li>Náº¿u khÃ´ng cÃ³ node slave, báº¡n nÃªn chá»n thá»i Ä‘iá»ƒm tháº¥p Ä‘iá»ƒm cá»§a táº£i hoáº¡t Ä‘á»™ng cá»§a Redis Ä‘á»ƒ thá»±c hiá»‡n quÃ©t, nháº±m trÃ¡nh áº£nh hÆ°á»Ÿng Ä‘áº¿n hoáº¡t Ä‘á»™ng bÃ¬nh thÆ°á»ng cá»§a há»‡ thá»‘ng. Hoáº·c báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng tham sá»‘ <code>-i</code> Ä‘á»ƒ Ä‘iá»u chá»‰nh khoáº£ng thá»i gian quÃ©t vÃ  trÃ¡nh giáº£m hiá»‡u suáº¥t trong thá»i gian dÃ i.</li>
</ul>
<p><strong>NhÆ°á»£c Ä‘iá»ƒm cá»§a phÆ°Æ¡ng phÃ¡p nÃ y:</strong></p>
<ul>
<li>PhÆ°Æ¡ng phÃ¡p nÃ y chá»‰ tráº£ vá» key lá»›n nháº¥t trong má»—i loáº¡i, khÃ´ng pháº£i lÃ  danh sÃ¡ch cÃ¡c key lá»›n nháº¥t.</li>
<li>Äá»‘i vá»›i cÃ¡c loáº¡i táº­p há»£p, phÆ°Æ¡ng phÃ¡p nÃ y chá»‰ thá»‘ng kÃª sá»‘ lÆ°á»£ng cÃ¡c pháº§n tá»­ trong táº­p há»£p, khÃ´ng pháº£i dung lÆ°á»£ng thá»±c táº¿ chiáº¿m giá»¯. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  má»™t táº­p há»£p cÃ³ nhiá»u pháº§n tá»­ khÃ´ng nháº¥t thiáº¿t pháº£i chiáº¿m nhiá»u bá»™ nhá»› náº¿u má»—i pháº§n tá»­ cÃ³ dung lÆ°á»£ng nhá».</li>
</ul>
<p><strong><em>2. Sá»­ dá»¥ng lá»‡nh SCAN Ä‘á»ƒ tÃ¬m kiáº¿m cÃ¡c key lá»›n</em></strong></p>
<p>Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng lá»‡nh SCAN Ä‘á»ƒ quÃ©t toÃ n bá»™ cÆ¡ sá»Ÿ dá»¯ liá»‡u Redis vÃ  sau Ä‘Ã³ sá»­ dá»¥ng lá»‡nh TYPE Ä‘á»ƒ láº¥y loáº¡i cá»§a tá»«ng key Ä‘Æ°á»£c tráº£ vá».</p>
<p>Äá»‘i vá»›i cÃ¡c key lÃ  kiá»ƒu String, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng lá»‡nh STRLEN Ä‘á»ƒ láº¥y Ä‘á»™ dÃ i cá»§a chuá»—i, tá»©c lÃ  sá»‘ byte chiáº¿m giá»¯ trong bá»™ nhá»›.</p>
<p>Äá»‘i vá»›i cÃ¡c kiá»ƒu táº­p há»£p, cÃ³ hai cÃ¡ch Ä‘á»ƒ biáº¿t Ä‘Æ°á»£c kÃ­ch thÆ°á»›c bá»™ nhá»› mÃ  chÃºng chiáº¿m giá»¯:</p>
<ul>
<li>
<p>Náº¿u báº¡n cÃ³ thá»ƒ biáº¿t trÆ°á»›c kÃ­ch thÆ°á»›c trung bÃ¬nh cá»§a cÃ¡c pháº§n tá»­ trong táº­p há»£p tá»« lá»›p kinh doanh, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c lá»‡nh sau Ä‘á»ƒ láº¥y sá»‘ lÆ°á»£ng cÃ¡c pháº§n tá»­ trong táº­p há»£p vÃ  sau Ä‘Ã³ nhÃ¢n vá»›i kÃ­ch thÆ°á»›c trung bÃ¬nh cá»§a tá»«ng pháº§n tá»­: Lá»‡nh LLEN cho List, HLEN cho Hash, SCARD cho Set vÃ  ZCARD cho Sorted Set.</p>
</li>
<li>
<p>Náº¿u báº¡n khÃ´ng thá»ƒ biáº¿t trÆ°á»›c kÃ­ch thÆ°á»›c cÃ¡c pháº§n tá»­ trong táº­p há»£p, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng lá»‡nh MEMORY USAGE (yÃªu cáº§u Redis phiÃªn báº£n 4.0 trá»Ÿ lÃªn) Ä‘á»ƒ truy váº¥n kÃ­ch thÆ°á»›c bá»™ nhá»› mÃ  má»™t key Ä‘ang chiáº¿m giá»¯.</p>
</li>
</ul>
<p><strong><em>3. Sá»­ dá»¥ng cÃ´ng cá»¥ RdbTools Ä‘á»ƒ tÃ¬m kiáº¿m cÃ¡c key lá»›n</em></strong></p>
<p>Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng cÃ´ng cá»¥ RdbTools, má»™t cÃ´ng cá»¥ mÃ£ nguá»“n má»Ÿ cá»§a bÃªn thá»© ba, Ä‘á»ƒ phÃ¢n tÃ­ch cÃ¡c táº­p tin chá»¥p Redis (RDB) vÃ  tÃ¬m kiáº¿m cÃ¡c key lá»›n trong Ä‘Ã³.</p>
<p>VÃ­ dá»¥, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng lá»‡nh sau Ä‘á»ƒ xuáº¥t cÃ¡c key cÃ³ kÃ­ch thÆ°á»›c lá»›n hÆ¡n 10 KB vÃ o má»™t tá»‡p báº£ng:</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">rdb</span><span style="color:#98C379;--shiki-dark:#98C379"> dump.rdb</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -c</span><span style="color:#98C379;--shiki-dark:#98C379"> memory</span><span style="color:#D19A66;--shiki-dark:#D19A66"> --bytes</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 10240</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -f</span><span style="color:#98C379;--shiki-dark:#98C379"> redis.csv</span></span></code></pre>
</div><h3>LÃ m tháº¿ nÃ o Ä‘á»ƒ xÃ³a key lá»›n?</h3>
<p>QuÃ¡ trÃ¬nh xÃ³a key trong Redis thá»±c cháº¥t lÃ  giáº£i phÃ³ng khÃ´ng gian bá»™ nhá»› mÃ  key Ä‘Ã³ Ä‘ang chiáº¿m dá»¥ng. Tuy nhiÃªn, viá»‡c giáº£i phÃ³ng bá»™ nhá»› chá»‰ lÃ  bÆ°á»›c Ä‘áº§u tiÃªn. Äá»ƒ quáº£n lÃ½ khÃ´ng gian bá»™ nhá»› má»™t cÃ¡ch hiá»‡u quáº£ hÆ¡n, khi á»©ng dá»¥ng giáº£i phÃ³ng bá»™ nhá»›, há»‡ Ä‘iá»u hÃ nh cáº§n pháº£i chÃ¨n cÃ¡c khá»‘i bá»™ nhá»› Ä‘Æ°á»£c giáº£i phÃ³ng vÃ o má»™t danh sÃ¡ch liÃªn káº¿t cÃ¡c khá»‘i bá»™ nhá»› trá»‘ng, Ä‘á»ƒ sau nÃ y cÃ³ thá»ƒ quáº£n lÃ½ vÃ  phÃ¢n bá»• láº¡i. QuÃ¡ trÃ¬nh nÃ y máº¥t má»™t khoáº£ng thá»i gian nháº¥t Ä‘á»‹nh vÃ  cÃ³ thá»ƒ lÃ m cháº·n á»©ng dá»¥ng hiá»‡n táº¡i Ä‘ang giáº£i phÃ³ng bá»™ nhá»›.</p>
<p>Do Ä‘Ã³, náº¿u giáº£i phÃ³ng má»™t lÆ°á»£ng lá»›n bá»™ nhá»› cÃ¹ng má»™t lÃºc, thá»i gian thá»±c hiá»‡n cÃ¡c thao tÃ¡c trÃªn danh sÃ¡ch khá»‘i bá»™ nhá»› trá»‘ng sáº½ tÄƒng lÃªn. Äiá»u nÃ y cÃ³ thá»ƒ dáº«n Ä‘áº¿n cháº·n trong quÃ¡ trÃ¬nh chÃ­nh cá»§a Redis. Náº¿u quÃ¡ trÃ¬nh chÃ­nh bá»‹ cháº·n, cÃ¡c yÃªu cáº§u khÃ¡c cÃ³ thá»ƒ gáº·p pháº£i váº¥n Ä‘á» vÆ°á»£t thá»i gian, dáº«n Ä‘áº¿n tÃ¬nh tráº¡ng káº¿t ná»‘i Redis bá»‹ tiÃªu tá»‘n háº¿t vÃ  gÃ¢y ra cÃ¡c váº¥n Ä‘á» khÃ¡c.</p>
<p>VÃ¬ váº­y, khi thá»±c hiá»‡n hÃ nh Ä‘á»™ng xÃ³a key lá»›n trong Redis, chÃºng ta cáº§n pháº£i cáº©n tháº­n. DÆ°á»›i Ä‘Ã¢y lÃ  hai phÆ°Æ¡ng phÃ¡p Ä‘á»ƒ lÃ m Ä‘iá»u nÃ y:</p>
<ul>
<li>XÃ³a key theo tá»«ng Ä‘á»£t (phÃ¢n lÃ´ xÃ³a)</li>
<li>XÃ³a key báº¥t Ä‘á»“ng bá»™ (Redis phiÃªn báº£n 4.0 trá»Ÿ lÃªn)</li>
</ul>
<h4>XoÃ¡ theo Ä‘á»£t</h4>
<p><strong>1. XÃ³a Hash lá»›n:</strong></p>
<ul>
<li>Sá»­ dá»¥ng lá»‡nh <code>hscan</code> Ä‘á»ƒ láº¥y 100 trÆ°á»ng (fields) má»—i láº§n.</li>
<li>Sau Ä‘Ã³ sá»­ dá»¥ng lá»‡nh <code>hdel</code> Ä‘á»ƒ xÃ³a tá»«ng trÆ°á»ng má»™t.</li>
</ul>
<div class="language-python" data-ext="python" data-title="python"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">import</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> redis</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">def</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> del_large_hash</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">():</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    r </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> redis.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">StrictRedis</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic">host</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379">'redis-host1'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic">port</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66">6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    large_hash_key </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379"> "xxx"</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">  # TÃªn key hash lá»›n cáº§n xÃ³a</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    cursor </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379"> '0'</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    while</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> cursor </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">!=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        cursor, data </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> r.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">hscan</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(large_hash_key, </span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic">cursor</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">cursor, </span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic">count</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66">100</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">        for</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> field, value </span><span style="color:#C678DD;--shiki-dark:#C678DD">in</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> data.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">items</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">():</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">            r.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">hdel</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(large_hash_key, field)</span></span></code></pre>
</div><p><strong>2. XÃ³a List lá»›n:</strong></p>
<ul>
<li>Sá»­ dá»¥ng lá»‡nh <code>ltrim</code> Ä‘á»ƒ má»—i láº§n chá»‰ giá»¯ láº¡i má»™t pháº§n nhá» cá»§a list.</li>
</ul>
<div class="language-python" data-ext="python" data-title="python"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">import</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> redis</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">def</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> del_large_list</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">():</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    r </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> redis.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">StrictRedis</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic">host</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379">'redis-host1'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic">port</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66">6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    large_list_key </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379"> 'xxx'</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">  # TÃªn key list lá»›n cáº§n xÃ³a</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    while</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> r.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">llen</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(large_list_key) </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        r.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">ltrim</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(large_list_key, </span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#D19A66;--shiki-dark:#D19A66">101</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)  </span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Chá»‰ giá»¯ láº¡i 100 pháº§n tá»­ cuá»‘i cÃ¹ng cá»§a list</span></span></code></pre>
</div><p><strong>3. XÃ³a Set lá»›n:</strong></p>
<ul>
<li>Sá»­ dá»¥ng lá»‡nh <code>sscan</code> Ä‘á»ƒ quÃ©t tá»«ng pháº§n tá»­ cá»§a set (100 pháº§n tá»­ má»—i láº§n).</li>
<li>Sá»­ dá»¥ng lá»‡nh <code>srem</code> Ä‘á»ƒ xÃ³a tá»«ng pháº§n tá»­ má»™t.</li>
</ul>
<div class="language-python" data-ext="python" data-title="python"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">import</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> redis</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">def</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> del_large_set</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">():</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    r </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> redis.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">StrictRedis</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic">host</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379">'redis-host1'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic">port</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66">6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    large_set_key </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379"> 'xxx'</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">   # TÃªn key set lá»›n cáº§n xÃ³a</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    cursor </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379"> '0'</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    while</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> cursor </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">!=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        cursor, data </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> r.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">sscan</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(large_set_key, </span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic">cursor</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">cursor, </span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic">count</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66">100</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">        for</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> member </span><span style="color:#C678DD;--shiki-dark:#C678DD">in</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> data:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">            r.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">srem</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(large_set_key, member)</span></span></code></pre>
</div><p><strong>4. XÃ³a Sorted Set lá»›n:</strong></p>
<ul>
<li>Sá»­ dá»¥ng lá»‡nh <code>zremrangebyrank</code> Ä‘á»ƒ xÃ³a má»™t lÆ°á»£ng pháº§n tá»­ hÃ ng Ä‘áº§u cá»§a Sorted Set.</li>
</ul>
<div class="language-python" data-ext="python" data-title="python"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">import</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> redis</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">def</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> del_large_sortedset</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">():</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    r </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> redis.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">StrictRedis</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic">host</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379">'redis-host1'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic">port</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66">6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    large_sortedset_key </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379"> 'xxx'</span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">  # TÃªn key Sorted Set lá»›n cáº§n xÃ³a</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    while</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> r.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">zcard</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(large_sortedset_key) </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        r.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">zremrangebyrank</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(large_sortedset_key, </span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#D19A66;--shiki-dark:#D19A66">99</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)  </span><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># XÃ³a 100 pháº§n tá»­ Ä‘áº§u tiÃªn cá»§a Sorted Set</span></span></code></pre>
</div><h4>XoÃ¡ báº¥t Ä‘á»“ng bá»™</h4>
<p>Tá»« phiÃªn báº£n Redis 4.0 trá»Ÿ Ä‘i, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng <strong>xÃ³a báº¥t Ä‘á»“ng bá»™</strong> báº±ng cÃ¡ch sá»­ dá»¥ng lá»‡nh <strong>unlink</strong> thay vÃ¬ <strong>del</strong> Ä‘á»ƒ xÃ³a cÃ¡c key.</p>
<p>Khi Ä‘Ã³, Redis sáº½ Ä‘Æ°a key nÃ y vÃ o má»™t luá»“ng báº¥t Ä‘á»“ng bá»™ Ä‘á»ƒ thá»±c hiá»‡n xÃ³a, Ä‘iá»u nÃ y giÃºp trÃ¡nh cháº·n luá»“ng chÃ­nh.</p>
<p>NgoÃ i viá»‡c sá»­ dá»¥ng lá»‡nh unlink Ä‘á»ƒ thá»±c hiá»‡n xÃ³a báº¥t Ä‘á»“ng bá»™, báº¡n cÅ©ng cÃ³ thá»ƒ cáº¥u hÃ¬nh tham sá»‘ Ä‘á»ƒ tá»± Ä‘á»™ng thá»±c hiá»‡n xÃ³a báº¥t Ä‘á»“ng bá»™ trong má»™t sá»‘ trÆ°á»ng há»£p cá»¥ thá»ƒ.</p>
<p>CÃ³ tá»•ng cá»™ng 4 cÃ i Ä‘áº·t máº·c Ä‘á»‹nh nhÆ° sau:</p>
<div class="language-text" data-ext="text" data-title="text"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>lazyfree-lazy-eviction no</span></span>
<span class="line"><span>lazyfree-lazy-expire no</span></span>
<span class="line"><span>lazyfree-lazy-server-del</span></span>
<span class="line"><span>noslave-lazy-flush no</span></span></code></pre>
</div><ul>
<li>
<p><strong>lazyfree-lazy-eviction</strong>: ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh liá»‡u Redis cÃ³ nÃªn kÃ­ch hoáº¡t cÆ¡ cháº¿ xÃ³a lÆ°á»i biáº¿ng khi bá»™ nhá»› vÆ°á»£t quÃ¡ giá»›i háº¡n maxmemory hay khÃ´ng.</p>
</li>
<li>
<p><strong>lazyfree-lazy-expire</strong>: XÃ¡c Ä‘á»‹nh liá»‡u Redis cÃ³ nÃªn kÃ­ch hoáº¡t cÆ¡ cháº¿ xÃ³a lÆ°á»i biáº¿ng cho cÃ¡c key háº¿t háº¡n khÃ´ng.</p>
</li>
<li>
<p><strong>lazyfree-lazy-server-del</strong>: Má»™t sá»‘ lá»‡nh khi xá»­ lÃ½ cÃ¡c key Ä‘Ã£ tá»“n táº¡i, vÃ­ dá»¥ nhÆ° lá»‡nh rename, náº¿u key Ä‘Ã­ch Ä‘Ã£ tá»“n táº¡i thÃ¬ Redis sáº½ trÆ°á»›c tiÃªn xÃ³a key Ä‘Ã­ch nÃ y. Náº¿u key nÃ y lÃ  má»™t big key, viá»‡c xÃ³a cÃ³ thá»ƒ gÃ¢y ra váº¥n Ä‘á» cháº·n. CÃ i Ä‘áº·t nÃ y xÃ¡c Ä‘á»‹nh liá»‡u Redis cÃ³ nÃªn kÃ­ch hoáº¡t cÆ¡ cháº¿ xÃ³a lÆ°á»i biáº¿ng trong trÆ°á»ng há»£p nÃ y hay khÃ´ng.</p>
</li>
<li>
<p><strong>noslave-lazy-flush</strong>: Äá»‘i vá»›i slave (nÃºt con), khi nÃ³ táº£i tá»‡p RDB cá»§a master thÃ¬ trÆ°á»›c Ä‘Ã³ nÃ³ sáº½ thá»±c hiá»‡n lá»‡nh flushall Ä‘á»ƒ xÃ³a dá»¯ liá»‡u cá»§a nÃ³. CÃ i Ä‘áº·t nÃ y xÃ¡c Ä‘á»‹nh liá»‡u Redis cÃ³ nÃªn kÃ­ch hoáº¡t cÆ¡ cháº¿ xÃ³a lÆ°á»i biáº¿ng trong trÆ°á»ng há»£p nÃ y hay khÃ´ng.</p>
</li>
</ul>
<p>Äá» xuáº¥t nÃªn kÃ­ch hoáº¡t cÃ¡c cÃ i Ä‘áº·t nhÆ° lazyfree-lazy-eviction, lazyfree-lazy-expire, lazyfree-lazy-server-del Ä‘á»ƒ cáº£i thiá»‡n hiá»‡u suáº¥t thá»±c thi cá»§a luá»“ng chÃ­nh trong Redis.</p>
]]></content:encoded>
    </item>
    <item>
      <title>Redis Advanced Data Types</title>
      <link>https://vanhung4499.github.io/database/redis/advanced-data-types.html</link>
      <guid>https://vanhung4499.github.io/database/redis/advanced-data-types.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Redis Advanced Data Types</source>
      <description>Redis Advanced Data Types Redis há»— trá»£ cÃ¡c kiá»ƒu dá»¯ liá»‡u nÃ¢ng cao nhÆ° BitMap, HyperLogLog, GEO vÃ  Stream. Hiá»ƒu Ä‘Æ°á»£c Ä‘áº·c tÃ­nh cá»§a cÃ¡c kiá»ƒu dá»¯ liá»‡u nÃ y vÃ  Ã¡p dá»¥ng linh hoáº¡t vÃ  hiá»‡u...</description>
      <category>redis</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<p>Redis há»— trá»£ cÃ¡c kiá»ƒu dá»¯ liá»‡u nÃ¢ng cao nhÆ° BitMap, HyperLogLog, GEO vÃ  Stream. Hiá»ƒu Ä‘Æ°á»£c Ä‘áº·c tÃ­nh cá»§a cÃ¡c kiá»ƒu dá»¯ liá»‡u nÃ y vÃ  Ã¡p dá»¥ng linh hoáº¡t vÃ  hiá»‡u quáº£ vÃ o tá»«ng ká»‹ch báº£n nghiá»‡p vá»¥ cá»¥ thá»ƒ lÃ  ráº¥t quan trá»ng khi sá»­ dá»¥ng Redis Ä‘á»ƒ mÃ´ hÃ¬nh hÃ³a dá»¯ liá»‡u.</p>
<h2>BitMap</h2>
<h3>Giá»›i thiá»‡u vá» BitMap</h3>
<p>BitMap, nhÆ° tÃªn gá»i, lÃ  má»™t chuá»—i liÃªn tá»¥c cÃ¡c sá»‘ nhá»‹ phÃ¢n (0 vÃ  1) trong Ä‘Ã³ cÃ¡c pháº§n tá»­ Ä‘Æ°á»£c truy cáº­p báº±ng cÃ¡c offset. VÃ¬ bit lÃ  Ä‘Æ¡n vá»‹ nhá» nháº¥t trong mÃ¡y tÃ­nh, viá»‡c sá»­ dá»¥ng BitMap Ä‘á»ƒ lÆ°u trá»¯ cÃ³ thá»ƒ <strong>tiáº¿t kiá»‡m ráº¥t nhiá»u khÃ´ng gian</strong>, Ä‘áº·c biá»‡t phÃ¹ há»£p cho cÃ¡c ká»‹ch báº£n thá»‘ng kÃª nhá»‹ phÃ¢n vá»›i táº­p dá»¯ liá»‡u lá»›n. VÃ­ dá»¥, trong má»™t há»‡ thá»‘ng nÆ¡i mÃ  ngÆ°á»i dÃ¹ng Ä‘Æ°á»£c biá»ƒu diá»…n báº±ng cÃ¡c ID ngÆ°á»i dÃ¹ng tÄƒng dáº§n, BitMap cÃ³ thá»ƒ lÆ°u trá»¯ hiá»‡u quáº£ tráº¡ng thÃ¡i Ä‘Äƒng nháº­p cá»§a tá»«ng ngÆ°á»i dÃ¹ng. Vá»›i BitMap, há»‡ thá»‘ng cÃ³ thá»ƒ xá»­ lÃ½ Ä‘áº¿n 4 tá»· ngÆ°á»i dÃ¹ng (khoáº£ng $$2^{32}$$), chá»‰ cáº§n 512 MB bá»™ nhá»› Ä‘á»ƒ lÆ°u trá»¯ tráº¡ng thÃ¡i Ä‘Äƒng nháº­p.</p>
<h3>Thá»±c hiá»‡n BitMap</h3>
<p>Trong thá»±c táº¿, <strong>BitMap khÃ´ng pháº£i lÃ  má»™t cáº¥u trÃºc dá»¯ liá»‡u Ä‘á»™c láº­p mÃ  lÃ  má»™t táº­p há»£p cÃ¡c phÃ©p toÃ¡n bit Ä‘Æ°á»£c thá»±c hiá»‡n trÃªn chuá»—i String</strong>.</p>
<p>Vá»›i Redis, cÃ¡c chuá»—i lÃ  an toÃ n cho dá»¯ liá»‡u nhá»‹ phÃ¢n vÃ  cÃ³ thá»ƒ lÆ°u trá»¯ Ä‘áº¿n 512 MB Ä‘á»™ dÃ i. Do Ä‘Ã³, BitMap cho phÃ©p thiáº¿t láº­p Ä‘áº¿n $$2^{32}$$ bit khÃ¡c nhau, giÃºp quáº£n lÃ½ dá»¯ liá»‡u nhá»‹ phÃ¢n quy mÃ´ lá»›n má»™t cÃ¡ch hiá»‡u quáº£ trong Redis, táº­n dá»¥ng kháº£ nÄƒng lÆ°u trá»¯ vÃ  thao tÃ¡c tá»‘i Æ°u cá»§a nÃ³.</p>
<h3>CÃ¡c Lá»‡nh BitMap</h3>
<p>| Lá»‡nh     | HÃ nh Ä‘á»™ng                                                |<br>
|</p>
]]></content:encoded>
    </item>
    <item>
      <title>Redis Basic Data Types</title>
      <link>https://vanhung4499.github.io/database/redis/basic-data-types.html</link>
      <guid>https://vanhung4499.github.io/database/redis/basic-data-types.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Redis Basic Data Types</source>
      <description>Redis Basic Data Types Redis cung cáº¥p nhiá»u loáº¡i dá»¯ liá»‡u, má»—i loáº¡i dá»¯ liá»‡u Ä‘á»u cÃ³ cÃ¡c lá»‡nh há»— trá»£ phong phÃº. Khi sá»­ dá»¥ng Redis, khÃ´ng chá»‰ cáº§n hiá»ƒu cÃ¡c Ä‘áº·c Ä‘iá»ƒm cá»§a cÃ¡c loáº¡i dá»¯ l...</description>
      <category>redis</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<p>Redis cung cáº¥p nhiá»u loáº¡i dá»¯ liá»‡u, má»—i loáº¡i dá»¯ liá»‡u Ä‘á»u cÃ³ cÃ¡c lá»‡nh há»— trá»£ phong phÃº.</p>
<p>Khi sá»­ dá»¥ng Redis, khÃ´ng chá»‰ cáº§n hiá»ƒu cÃ¡c Ä‘áº·c Ä‘iá»ƒm cá»§a cÃ¡c loáº¡i dá»¯ liá»‡u, mÃ  cÃ²n cáº§n linh hoáº¡t vÃ  hiá»‡u quáº£ trong viá»‡c sá»­ dá»¥ng cÃ¡c loáº¡i dá»¯ liá»‡u nÃ y Ä‘á»ƒ xÃ¢y dá»±ng mÃ´ hÃ¬nh dá»¯ liá»‡u phÃ¹ há»£p vá»›i ká»‹ch báº£n nghiá»‡p vá»¥.</p>
<p>CÃ¡c loáº¡i dá»¯ liá»‡u cÆ¡ báº£n mÃ  Redis há»— trá»£:</p>
<ul>
<li><strong>STRING</strong>: Chuá»—i</li>
<li><strong>HASH</strong>: Báº£ng bÄƒm</li>
<li><strong>LIST</strong>: List</li>
<li><strong>SET</strong>: Táº­p há»£p</li>
<li><strong>ZSET</strong>: Táº­p há»£p cÃ³ thá»© tá»±</li>
</ul>
<p>CÃ¡c loáº¡i dá»¯ liá»‡u nÃ¢ng cao mÃ  Redis há»— trá»£:</p>
<ul>
<li><strong>BitMap</strong>: Báº£n Ä‘á»“ bit</li>
<li><strong>HyperLogLog</strong>: Äáº¿m dá»¯ liá»‡u khá»•ng lá»“</li>
<li><strong>GEO</strong>: Dá»¯ liá»‡u vá»‹ trÃ­ Ä‘á»‹a lÃ½</li>
<li><strong>Stream</strong>: Dá»¯ liá»‡u luá»“ng</li>
</ul>
<p>Sá»­ dá»¥ng Redis, khÃ´ng chá»‰ cáº§n hiá»ƒu cÃ¡c Ä‘áº·c tÃ­nh cá»§a cÃ¡c loáº¡i dá»¯ liá»‡u mÃ  cÃ²n cáº§n linh hoáº¡t vÃ  hiá»‡u quáº£ trong viá»‡c sá»­ dá»¥ng cÃ¡c loáº¡i dá»¯ liá»‡u nÃ y Ä‘á»ƒ xÃ¢y dá»±ng mÃ´ hÃ¬nh theo tá»«ng tÃ¬nh huá»‘ng cá»¥ thá»ƒ cá»§a nghiá»‡p vá»¥.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624195542.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure>
<h2>CÃ¡c kiá»ƒu dá»¯ liá»‡u cÆ¡ báº£n cá»§a Redis</h2>
<p>|Kiá»ƒu dá»¯ liá»‡u|GiÃ¡ trá»‹ cÃ³ thá»ƒ lÆ°u trá»¯|CÃ¡c hoáº¡t Ä‘á»™ng|<br>
|</p>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624195542.png" type="image/png"/>
    </item>
    <item>
      <title>Redis Cluster</title>
      <link>https://vanhung4499.github.io/database/redis/cluster.html</link>
      <guid>https://vanhung4499.github.io/database/redis/cluster.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Redis Cluster</source>
      <description>Redis Cluster Redis Cluster lÃ  má»™t giáº£i phÃ¡p cÆ¡ sá»Ÿ dá»¯ liá»‡u phÃ¢n tÃ¡n Ä‘Æ°á»£c cung cáº¥p bá»Ÿi Redis. VÃ¬ lÃ  má»™t há»‡ thá»‘ng phÃ¢n tÃ¡n, nÃ³ tá»± nhiÃªn cÃ³ cÃ¡c tÃ­nh cháº¥t cÆ¡ báº£n cá»§a há»‡ thá»‘ng phÃ¢n t...</description>
      <category>redis</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p><strong>Redis Cluster</strong> lÃ  má»™t giáº£i phÃ¡p cÆ¡ sá»Ÿ dá»¯ liá»‡u phÃ¢n tÃ¡n Ä‘Æ°á»£c cung cáº¥p bá»Ÿi Redis.</p>
<p>VÃ¬ lÃ  má»™t há»‡ thá»‘ng phÃ¢n tÃ¡n, nÃ³ tá»± nhiÃªn cÃ³ cÃ¡c tÃ­nh cháº¥t cÆ¡ báº£n cá»§a há»‡ thá»‘ng phÃ¢n tÃ¡n: cÃ³ thá»ƒ má»Ÿ rá»™ng, cÃ³ sáºµn vÃ  nháº¥t quÃ¡n.</p>
<ul>
<li>Redis Cluster phÃ¢n vÃ¹ng dá»¯ liá»‡u báº±ng cÃ¡ch chia cÃ¡c khe bÄƒm (hash slot) Ä‘á»ƒ chia sáº» dá»¯ liá»‡u.</li>
<li>Redis Cluster sá»­ dá»¥ng mÃ´ hÃ¬nh master-slave Ä‘á»“ng bá»™ Ä‘á»ƒ cung cáº¥p tÃ­nh nÄƒng sao chÃ©p vÃ  chuyá»ƒn giao lá»—i, Ä‘áº£m báº£o tÃ­nh sáºµn cÃ³ cao cho Redis Cluster.</li>
<li>Theo lÃ½ thuyáº¿t CAP, khÃ´ng thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c Consistency, Availability vÃ  Partition tolerance cÃ¹ng má»™t lÃºc, vÃ  Redis Cluster chá»n lá»±a chá»n AP. CÃ¡c nÃºt trong Redis Cluster giao tiáº¿p báº¥t Ä‘á»“ng bá»™, khÃ´ng Ä‘áº£m báº£o tÃ­nh nháº¥t quÃ¡n máº¡nh, nhÆ°ng cá»‘ gáº¯ng Ä‘áº¡t Ä‘Æ°á»£c tÃ­nh nháº¥t quÃ¡n cuá»‘i cÃ¹ng.</li>
</ul>
</blockquote>
<h2>1. PhÃ¢n vÃ¹ng Redis Cluster</h2>
<h3>1.1. CÃ¡c nÃºt trong Cluster</h3>
<p>Redis Cluster bao gá»“m nhiá»u nÃºt, khi má»™t nÃºt khá»Ÿi Ä‘á»™ng, cÃ¡c nÃºt nÃ y ban Ä‘áº§u lÃ  Ä‘á»™c láº­p vá»›i nhau. <strong>CÃ¡c nÃºt káº¿t ná»‘i vá»›i nhau báº±ng cÃ¡ch gá»­i tin nháº¯n "CLUSTER MEET" Ä‘á»ƒ thÃªm cÃ¡c nÃºt khÃ¡c vÃ o cá»¥m cá»§a mÃ¬nh</strong>.</p>
<p>Báº±ng cÃ¡ch gá»­i lá»‡nh "CLUSTER MEET" Ä‘áº¿n má»™t nÃºt, nÃºt hiá»‡n táº¡i sáº½ káº¿t ná»‘i vá»›i nÃºt Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh bá»Ÿi IP vÃ  PORT, vÃ  khi káº¿t ná»‘i thÃ nh cÃ´ng, nÃºt hiá»‡n táº¡i sáº½ thÃªm nÃºt Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh vÃ o cá»¥m cá»§a mÃ¬nh.</p>
<p><strong>CÃ¡c nÃºt trong Redis Cluster lÆ°u trá»¯ cáº·p khÃ³a-giÃ¡ trá»‹ vÃ  thá»i gian háº¿t háº¡n giá»‘ng nhÆ° trong Redis Ä‘Æ¡n</strong>.</p>
<p>Redis Cluster cÃ³ cÃ¡c nÃºt chÃ­nh (master) vÃ  nÃºt phá»¥ (slave), trong Ä‘Ã³ nÃºt chÃ­nh Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ xá»­ lÃ½ cÃ¡c khe bÄƒm (slot), vÃ  nÃºt phá»¥ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ sao chÃ©p má»™t nÃºt chÃ­nh cá»¥ thá»ƒ vÃ  thay tháº¿ nÃºt chÃ­nh khi nÃºt chÃ­nh bá»‹ lá»—i.</p>
<h3>1.2. PhÃ¢n chia Hash Slot</h3>
<p>Váº¥n Ä‘á» chÃ­nh cáº§n giáº£i quyáº¿t trong lÆ°u trá»¯ phÃ¢n tÃ¡n lÃ  phÃ¢n chia&nbsp;<strong>toÃ n bá»™ táº­p dá»¯ liá»‡u</strong>&nbsp;theo&nbsp;<strong>quy táº¯c phÃ¢n vÃ¹ng</strong>&nbsp;thÃ nh&nbsp;<strong>nhiá»u phÃ¢n vÃ¹ng</strong>&nbsp;trÃªn&nbsp;<strong>nhiá»u nÃºt</strong>, má»—i nÃºt chá»‹u trÃ¡ch nhiá»‡m cho má»™t pháº§n dá»¯ liá»‡u cá»§a toÃ n bá»™.</p>
<p><strong>Redis Cluster sá»­ dá»¥ng phÃ¢n chia hash slot Ä‘á»ƒ phÃ¢n vÃ¹ng dá»¯ liá»‡u</strong>. Redis Cluster chia toÃ n bá»™ cÆ¡ sá»Ÿ dá»¯ liá»‡u thÃ nh 16384 hash slot (khe hash), má»—i khÃ³a trong cÆ¡ sá»Ÿ dá»¯ liá»‡u thuá»™c má»™t trong sá»‘ 16384 khe hash nÃ y, vÃ  má»—i nÃºt trong cá»¥m cÃ³ thá»ƒ xá»­ lÃ½ tá»« 0 Ä‘áº¿n tá»‘i Ä‘a 16384 khe hash.&nbsp;<strong>Náº¿u cÃ³ báº¥t ká»³ khe hash nÃ o khÃ´ng Ä‘Æ°á»£c xá»­ lÃ½, cá»¥m Redis sáº½ Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u lÃ  offline</strong>.</p>
<p>Báº±ng cÃ¡ch gá»­i lá»‡nh&nbsp;<a href="https://redis.io/commands/cluster-addslots" target="_blank" rel="noopener noreferrer"><code>CLUSTER ADDSLOTS</code></a>&nbsp;Ä‘áº¿n má»™t nÃºt, báº¡n cÃ³ thá»ƒ gÃ¡n má»™t hoáº·c nhiá»u khe hash cho nÃºt Ä‘Ã³.</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>&gt; CLUSTER ADDSLOTS 1 2 3</span></span>
<span class="line"><span>OK</span></span></code></pre>
</div><p>Má»—i nÃºt trong cá»¥m chá»‹u trÃ¡ch nhiá»‡m cho má»™t pháº§n khe hash. VÃ­ dá»¥, trong má»™t cá»¥m cÃ³ 3 nÃºt:</p>
<ul>
<li>NÃºt A chá»‹u trÃ¡ch nhiá»‡m cho khe hash tá»« 0 Ä‘áº¿n 5500.</li>
<li>NÃºt B chá»‹u trÃ¡ch nhiá»‡m cho khe hash tá»« 5501 Ä‘áº¿n 11000.</li>
<li>NÃºt C chá»‹u trÃ¡ch nhiá»‡m cho khe hash tá»« 11001 Ä‘áº¿n 16384.</li>
</ul>
<h3>1.3. Äá»‹a chá»‰</h3>
<p>Khi mÃ¡y khÃ¡ch gá»­i má»™t lá»‡nh liÃªn quan Ä‘áº¿n khÃ³a cÆ¡ sá»Ÿ dá»¯ liá»‡u cho nÃºt, nÃºt nháº­n lá»‡nh sáº½ tÃ­nh toÃ¡n xem lá»‡nh cáº§n xá»­ lÃ½ thuá»™c vá» khe nÃ o cá»§a cÆ¡ sá»Ÿ dá»¯ liá»‡u vÃ  kiá»ƒm tra xem khe nÃ y cÃ³ Ä‘Æ°á»£c giao cho nÃºt hiá»‡n táº¡i khÃ´ng:</p>
<ul>
<li>Náº¿u khe chá»©a khÃ³a Ä‘Æ°á»£c giao cho nÃºt hiá»‡n táº¡i, nÃºt hiá»‡n táº¡i sáº½ thá»±c hiá»‡n lá»‡nh.</li>
<li>Náº¿u khe chá»©a khÃ³a khÃ´ng Ä‘Æ°á»£c giao cho nÃºt hiá»‡n táº¡i, nÃºt sáº½ tráº£ vá» má»™t lá»—i MOVED cho mÃ¡y khÃ¡ch, hÆ°á»›ng dáº«n mÃ¡y khÃ¡ch chuyá»ƒn hÆ°á»›ng Ä‘áº¿n nÃºt Ä‘Ãºng.</li>
</ul>
<h4>1.3.1. TÃ­nh toÃ¡n khe mÃ  khÃ³a thuá»™c vá»</h4>
<p>Giáº£i thuáº­t Ä‘á»ƒ quyáº¿t Ä‘á»‹nh má»™t khÃ³a nÃªn Ä‘Æ°á»£c giao cho khe nÃ o lÃ : <strong>tÃ­nh toÃ¡n káº¿t quáº£ CRC16 cá»§a khÃ³a vÃ  sau Ä‘Ã³ láº¥y pháº§n dÆ° cá»§a káº¿t quáº£ chia cho 16834</strong>.</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>HASH_SLOT = CRC16(KEY) mod 16384</span></span></code></pre>
</div><p>Khi nÃºt tÃ­nh toÃ¡n khe mÃ  khÃ³a thuá»™c vá» lÃ  i, nÃºt sáº½ kiá»ƒm tra cÃ¡c Ä‘iá»u kiá»‡n sau Ä‘á»ƒ xÃ¡c Ä‘á»‹nh xem khe cÃ³ Ä‘Æ°á»£c giao cho nÃºt hay khÃ´ng:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>clusterState.slots[i] == clusterState.myself</span></span></code></pre>
</div><h4>1.3.2. Lá»—i MOVED</h4>
<p>Khi nÃºt phÃ¡t hiá»‡n ráº±ng khe chá»©a khÃ³a khÃ´ng Ä‘Æ°á»£c giao cho nÃºt hiá»‡n táº¡i, nÃºt sáº½ tráº£ vá» má»™t lá»—i <code>MOVED</code>, hÆ°á»›ng dáº«n mÃ¡y khÃ¡ch chuyá»ƒn hÆ°á»›ng Ä‘áº¿n nÃºt Ä‘ang chá»‹u trÃ¡ch nhiá»‡m khe Ä‘Ã³.</p>
<p>Äá»‹nh dáº¡ng lá»—i <code>MOVED</code> nhÆ° sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>MOVED &lt;khe&gt; &lt;ip&gt;:&lt;port&gt;</span></span></code></pre>
</div><blockquote>
<p>Hiá»ƒu theo cÃ¡ch cÃ¡ nhÃ¢n: HÃ nh Ä‘á»™ng MOVED nÃ y tÆ°Æ¡ng tá»± nhÆ° chuyá»ƒn hÆ°á»›ng trong giao thá»©c HTTP.</p>
</blockquote>
<h3>1.4. TÃ¡i phÃ¢n vÃ¹ng</h3>
<p><strong>Hoáº¡t Ä‘á»™ng tÃ¡i phÃ¢n vÃ¹ng trong Redis Cluster cho phÃ©p chuyá»ƒn má»™t sá»‘ lÆ°á»£ng báº¥t ká»³ cÃ¡c khe bÄƒm Ä‘Ã£ Ä‘Æ°á»£c giao cho má»™t nÃºt (nÃºt nguá»“n) sang má»™t nÃºt khÃ¡c (nÃºt Ä‘Ã­ch), vÃ  cÃ¡c cáº·p khÃ³a-giÃ¡ trá»‹ liÃªn quan Ä‘áº¿n cÃ¡c khe bÄƒm Ä‘Ã³ cÅ©ng sáº½ Ä‘Æ°á»£c di chuyá»ƒn tá»« nÃºt nguá»“n sang nÃºt Ä‘Ã­ch</strong>.</p>
<p>Hoáº¡t Ä‘á»™ng tÃ¡i phÃ¢n vÃ¹ng&nbsp;<strong>cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n trá»±c tuyáº¿n</strong>, trong quÃ¡ trÃ¬nh tÃ¡i phÃ¢n vÃ¹ng, Redis Cluster khÃ´ng cáº§n táº¯t mÃ¡y vÃ  cáº£ nÃºt nguá»“n vÃ  nÃºt Ä‘Ã­ch Ä‘á»u cÃ³ thá»ƒ tiáº¿p tá»¥c xá»­ lÃ½ cÃ¡c yÃªu cáº§u lá»‡nh.</p>
<p>Hoáº¡t Ä‘á»™ng tÃ¡i phÃ¢n vÃ¹ng trong Redis Cluster Ä‘Æ°á»£c thá»±c hiá»‡n bá»Ÿi cÃ´ng cá»¥ quáº£n lÃ½ Redis Cluster&nbsp;<strong>redis-trib</strong>, nÃ³ gá»­i cÃ¡c lá»‡nh Ä‘áº¿n nÃºt nguá»“n vÃ  nÃºt Ä‘Ã­ch Ä‘á»ƒ thá»±c hiá»‡n tÃ¡i phÃ¢n vÃ¹ng.</p>
<h3>1.5. Lá»—i ASK</h3>
<p>Lá»—i&nbsp;<code>ASK</code>&nbsp;khÃ¡c vá»›i lá»—i&nbsp;<code>MOVED</code>&nbsp;á»Ÿ chá»—:&nbsp;<strong>Lá»—i&nbsp;<code>ASK</code>&nbsp;chá»‰ lÃ  má»™t biá»‡n phÃ¡p táº¡m thá»i Ä‘Æ°á»£c sá»­ dá»¥ng trong quÃ¡ trÃ¬nh di chuyá»ƒn khe bÄƒm</strong>, sau khi khÃ¡ch hÃ ng nháº­n Ä‘Æ°á»£c lá»—i&nbsp;<code>ASK</code>&nbsp;vá» khe bÄƒm X, khÃ¡ch hÃ ng chá»‰ sáº½ chuyá»ƒn hÆ°á»›ng yÃªu cáº§u lá»‡nh liÃªn quan Ä‘áº¿n khe bÄƒm X sang nÃºt Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh trong láº§n yÃªu cáº§u lá»‡nh tiáº¿p theo, nhÆ°ng viá»‡c chuyá»ƒn hÆ°á»›ng nÃ y sáº½ khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c yÃªu cáº§u lá»‡nh liÃªn quan Ä‘áº¿n khe bÄƒm X trong tÆ°Æ¡ng lai, khÃ¡ch hÃ ng váº«n sáº½ gá»­i yÃªu cáº§u lá»‡nh liÃªn quan Ä‘áº¿n khe bÄƒm X Ä‘áº¿n nÃºt hiá»‡n táº¡i Ä‘ang chá»‹u trÃ¡ch nhiá»‡m xá»­ lÃ½ khe bÄƒm X, trá»« khi lá»—i&nbsp;<code>ASK</code>&nbsp;xuáº¥t hiá»‡n má»™t láº§n ná»¯a.</p>
<h2>2. Redis Cluster - QuÃ¡ trÃ¬nh chuyá»ƒn giao khi xáº£y ra sá»± cá»‘</h2>
<h3>2.1. Sao chÃ©p</h3>
<p>CÆ¡ cháº¿ sao chÃ©p Redis cÃ³ thá»ƒ Ä‘Æ°á»£c tham kháº£o táº¡i: [[Redis Replication]]</p>
<h3>2.2. PhÃ¡t hiá»‡n sá»± cá»‘</h3>
<p><strong>Má»—i nÃºt trong cá»¥m Redis sáº½ Ä‘á»‹nh ká»³ gá»­i tin nháº¯n PING Ä‘áº¿n cÃ¡c nÃºt khÃ¡c trong cá»¥m Ä‘á»ƒ kiá»ƒm tra xem chÃºng cÃ³ hoáº¡t Ä‘á»™ng khÃ´ng</strong>.</p>
<p>Tráº¡ng thÃ¡i cá»§a má»—i nÃºt cÃ³ thá»ƒ Ä‘Æ°á»£c chia thÃ nh:</p>
<ul>
<li>Tráº¡ng thÃ¡i trá»±c tuyáº¿n;</li>
<li>Tráº¡ng thÃ¡i ngoáº¡i tuyáº¿n (FAIL);</li>
<li>Tráº¡ng thÃ¡i nghi ngá» ngoáº¡i tuyáº¿n (PFAIL), tá»©c lÃ  khÃ´ng cÃ³ pháº£n há»“i PING trong khoáº£ng thá»i gian quy Ä‘á»‹nh;</li>
</ul>
<h3>2.3. Chuyá»ƒn giao khi xáº£y ra sá»± cá»‘</h3>
<ol>
<li>Trong sá»‘ táº¥t cáº£ cÃ¡c nÃºt con cá»§a nÃºt chÃ­nh bá»‹ xáº£y ra sá»± cá»‘, má»™t nÃºt con sáº½ Ä‘Æ°á»£c chá»n.</li>
<li>NÃºt con Ä‘Æ°á»£c chá»n sáº½ thá»±c hiá»‡n lá»‡nh <code>SLAVEOF no one</code>, trá»Ÿ thÃ nh nÃºt chÃ­nh má»›i.</li>
<li>NÃºt chÃ­nh má»›i sáº½ há»§y bá» viá»‡c gÃ¡n khe cho nÃºt chÃ­nh Ä‘Ã£ bá»‹ xáº£y ra sá»± cá»‘ vÃ  gÃ¡n táº¥t cáº£ cÃ¡c khe nÃ y cho chÃ­nh nÃ³.</li>
<li>NÃºt chÃ­nh má»›i sáº½ phÃ¡t sÃ³ng má»™t tin nháº¯n PONG Ä‘áº¿n cá»¥m Redis, thÃ´ng bÃ¡o ráº±ng nÃºt con nÃ y Ä‘Ã£ trá»Ÿ thÃ nh nÃºt chÃ­nh má»›i.</li>
</ol>
<h3>2.4. Báº§u chá»n nÃºt chÃ­nh má»›i</h3>
<p>QuÃ¡ trÃ¬nh báº§u chá»n nÃºt chÃ­nh má»›i trong Redis Cluster dá»±a trÃªn thuáº­t toÃ¡n Ä‘á»“ng thuáº­n: Raft.</p>
<h2>3. Giao tiáº¿p trong Redis Cluster</h2>
<p>CÃ¡c nÃºt trong cá»¥m Redis giao tiáº¿p thÃ´ng qua viá»‡c gá»­i vÃ  nháº­n cÃ¡c tin nháº¯n.</p>
<p>CÃ³ nÄƒm loáº¡i tin nháº¯n chÃ­nh mÃ  cÃ¡c nÃºt trong cá»¥m Redis gá»­i Ä‘i:</p>
<ul>
<li><code>MEET</code> - YÃªu cáº§u nÃºt nháº­n tham gia vÃ o cá»¥m mÃ  nÃºt gá»­i Ä‘ang tham gia.</li>
<li><code>PING</code> - Má»—i nÃºt trong cá»¥m Redis sáº½ chá»n ngáº«u nhiÃªn nÄƒm nÃºt tá»« danh sÃ¡ch nÃºt Ä‘Ã£ biáº¿t vÃ  gá»­i tin nháº¯n PING Ä‘áº¿n nÄƒm nÃºt nÃ y, nháº±m kiá»ƒm tra xem cÃ¡c nÃºt Ä‘Ã£ chá»n cÃ³ hoáº¡t Ä‘á»™ng khÃ´ng.</li>
<li><code>PONG</code> - Khi nÃºt nháº­n Ä‘Æ°á»£c tin nháº¯n MEET hoáº·c PING tá»« nÃºt gá»­i, nÃ³ sáº½ tráº£ lá»i báº±ng má»™t tin nháº¯n PONG.</li>
<li><code>FAIL</code> - Khi má»™t nÃºt chÃ­nh A xÃ¡c Ä‘á»‹nh ráº±ng má»™t nÃºt chÃ­nh B Ä‘Ã£ vÃ o tráº¡ng thÃ¡i FAIL, nÃºt A sáº½ phÃ¡t sÃ³ng má»™t tin nháº¯n FAIL vá» nÃºt B cho toÃ n bá»™ cá»¥m Redis, táº¥t cáº£ cÃ¡c nÃºt nháº­n Ä‘Æ°á»£c tin nháº¯n nÃ y sáº½ Ä‘Ã¡nh dáº¥u nÃºt B lÃ  Ä‘Ã£ ngoáº¡i tuyáº¿n.</li>
<li><code>PUBLISH</code> - Khi má»™t nÃºt nháº­n Ä‘Æ°á»£c má»™t lá»‡nh PUBLISH, nÃ³ sáº½ thá»±c hiá»‡n lá»‡nh nÃ y vÃ  phÃ¡t sÃ³ng má»™t tin nháº¯n PUBLISH Ä‘áº¿n cá»¥m Redis, táº¥t cáº£ cÃ¡c nÃºt nháº­n Ä‘Æ°á»£c tin nháº¯n nÃ y sáº½ thá»±c hiá»‡n cÃ¹ng má»™t lá»‡nh PUBLISH.</li>
</ul>
<h2>4. á»¨ng dá»¥ng cá»§a Redis Cluster</h2>
<h3>4.1. Giá»›i háº¡n chá»©c nÄƒng cá»§a cá»¥m</h3>
<p>Redis Cluster so vá»›i Redis Ä‘Æ¡n láº» cÃ³ má»™t sá»‘ giá»›i háº¡n chá»©c nÄƒng, cÃ¡c nhÃ  phÃ¡t triá»ƒn cáº§n hiá»ƒu trÆ°á»›c vÃ  trÃ¡nh khi sá»­ dá»¥ng.</p>
<ul>
<li>Há»— trá»£ háº¡n cháº¿ cho cÃ¡c hoáº¡t Ä‘á»™ng <strong>Ä‘a khÃ³a</strong>: CÃ¡c hoáº¡t Ä‘á»™ng nhÆ° <code>mset</code>, <code>mget</code> chá»‰ há»— trá»£ cho cÃ¡c khÃ³a cÃ³ cÃ¹ng giÃ¡ trá»‹ <code>slot</code>. CÃ¡c khÃ³a Ä‘Æ°á»£c Ã¡nh xáº¡ vÃ o cÃ¡c <code>slot</code> khÃ¡c nhau khÃ´ng Ä‘Æ°á»£c há»— trá»£.</li>
<li>Há»— trá»£ háº¡n cháº¿ cho cÃ¡c hoáº¡t Ä‘á»™ng <strong>giao dá»‹ch</strong>: Chá»‰ há»— trá»£ giao dá»‹ch cho nhiá»u khÃ³a trÃªn cÃ¹ng má»™t nÃºt. Khi nhiá»u khÃ³a phÃ¢n tÃ¡n trÃªn cÃ¡c nÃºt khÃ¡c nhau, khÃ´ng thá»ƒ sá»­ dá»¥ng chá»©c nÄƒng giao dá»‹ch.</li>
<li>KhÃ´ng thá»ƒ Ã¡nh xáº¡ má»™t Ä‘á»‘i tÆ°á»£ng khÃ³a lá»›n nhÆ° <code>hash</code>, <code>list</code> vÃ o cÃ¡c nÃºt khÃ¡c nhau. <code>Key</code> Ä‘Æ°á»£c coi lÃ  Ä‘Æ¡n vá»‹ phÃ¢n vÃ¹ng dá»¯ liá»‡u.</li>
<li>KhÃ´ng há»— trá»£ <strong>nhiá»u khÃ´ng gian cÆ¡ sá»Ÿ dá»¯ liá»‡u</strong>: Redis Ä‘Æ¡n láº» cÃ³ thá»ƒ há»— trá»£ <code>16</code> khÃ´ng gian cÆ¡ sá»Ÿ dá»¯ liá»‡u (<code>db0 ~ db15</code>), trong khi cháº¿ Ä‘á»™ cá»¥m chá»‰ há»— trá»£ sá»­ dá»¥ng má»™t khÃ´ng gian cÆ¡ sá»Ÿ dá»¯ liá»‡u duy nháº¥t, tá»©c lÃ  <code>db0</code>.</li>
<li><strong>Sao chÃ©p</strong> chá»‰ há»— trá»£ má»™t cáº¥p: CÃ¡c nÃºt con chá»‰ cÃ³ thá»ƒ sao chÃ©p tá»« nÃºt chÃ­nh, khÃ´ng há»— trá»£ cáº¥u trÃºc sao chÃ©p cÃ¢y lá»“ng nhau.</li>
</ul>
<h3>4.2. Giá»›i háº¡n quy mÃ´ cá»¥m</h3>
<p>Redis Cluster dá»… sá»­ dá»¥ng. CÃ¡c chá»©c nÄƒng phÃ¢n vÃ¹ng, sao chÃ©p chÃ­nh vÃ  má»Ÿ rá»™ng linh hoáº¡t Ä‘á»u Ä‘Æ°á»£c tá»± Ä‘á»™ng hÃ³a, chá»‰ cáº§n triá»ƒn khai Ä‘Æ¡n giáº£n lÃ  cÃ³ thá»ƒ cÃ³ má»™t cá»¥m Redis lá»›n vá»›i kháº£ nÄƒng chá»©a lÆ°á»£ng dá»¯ liá»‡u lá»›n, Ä‘Ã¡ng tin cáº­y vÃ  cÃ³ sáºµn cao, vÃ  Ä‘á»‘i vá»›i á»©ng dá»¥ng, nÃ³ gáº§n nhÆ° lÃ  trong suá»‘t.</p>
<p>VÃ¬ váº­y, Redis Cluster ráº¥t phÃ¹ há»£p Ä‘á»ƒ xÃ¢y dá»±ng cÃ¡c cá»¥m Redis trung bÃ¬nh vÃ  nhá», trong Ä‘Ã³ cÃ³ khoáº£ng vÃ i Ä‘áº¿n vÃ i chá»¥c nÃºt.</p>
<p>Tuy nhiÃªn, Redis Cluster khÃ´ng phÃ¹ há»£p Ä‘á»ƒ xÃ¢y dá»±ng cÃ¡c cá»¥m quy mÃ´ lá»›n, chá»§ yáº¿u lÃ  do nÃ³ sá»­ dá»¥ng má»™t thiáº¿t káº¿ phi táº­p trung.</p>
<p>TrÃªn má»—i nÃºt Redis, nÃ³ lÆ°u trá»¯ má»™t báº£ng Ã¡nh xáº¡ giá»¯a táº¥t cáº£ cÃ¡c khe vÃ  nÃºt, khÃ¡ch hÃ ng cÃ³ thá»ƒ truy cáº­p vÃ o báº¥t ká»³ nÃºt nÃ o vÃ  sau Ä‘Ã³ thÃ´ng qua lá»‡nh chuyá»ƒn hÆ°á»›ng, tÃ¬m ra nÃºt chá»©a dá»¯ liá»‡u. Váº­y, báº£ng Ã¡nh xáº¡ nÃ y Ä‘Æ°á»£c cáº­p nháº­t nhÆ° tháº¿ nÃ o? Redis Cluster sá»­ dá»¥ng giao thá»©c lan truyá»n tin Ä‘á»“n (Gossip) Ä‘á»ƒ truyá»n bÃ¡ cÃ¡c thay Ä‘á»•i cáº¥u hÃ¬nh cá»¥m.</p>
<p>Æ¯u Ä‘iá»ƒm cá»§a Gossip lÃ  phi táº­p trung; nhÆ°á»£c Ä‘iá»ƒm lÃ  tá»‘c Ä‘á»™ truyá»n bÃ¡ cháº­m vÃ  cÃ ng lá»›n quy mÃ´ cá»¥m, tá»‘c Ä‘á»™ truyá»n bÃ¡ cÃ ng cháº­m.</p>
<h3>4.3. Cáº¥u hÃ¬nh cá»¥m</h3>
<p>TrÆ°á»›c khi triá»ƒn khai má»™t cá»¥m Redis, chÃºng ta sáº½ giá»›i thiá»‡u cÃ¡c tham sá»‘ cáº¥u hÃ¬nh trong tá»‡p redis.conf cá»§a cá»¥m.</p>
<ul>
<li><strong>cluster-enabled</strong> <code>&lt;yes/no&gt;</code> - Náº¿u Ä‘Æ°á»£c cáº¥u hÃ¬nh lÃ  "yes", chá»©c nÄƒng cá»¥m sáº½ Ä‘Æ°á»£c báº­t vÃ  Redis instance sáº½ lÃ  má»™t nÃºt trong cá»¥m, náº¿u khÃ´ng, nÃ³ sáº½ lÃ  má»™t instance Redis Ä‘Æ¡n láº».</li>
<li><strong>cluster-config-file</strong> <code>&lt;filename&gt;</code> - LÆ°u Ã½: Máº·c dÃ¹ tÃªn cáº¥u hÃ¬nh nÃ y Ä‘Æ°á»£c gá»i lÃ  "tá»‡p cáº¥u hÃ¬nh cá»¥m", nhÆ°ng tá»‡p cáº¥u hÃ¬nh nÃ y khÃ´ng thá»ƒ chá»‰nh sá»­a thá»§ cÃ´ng, nÃ³ lÃ  má»™t tá»‡p cáº¥u hÃ¬nh tá»± Ä‘á»™ng Ä‘Æ°á»£c duy trÃ¬ bá»Ÿi cÃ¡c nÃºt cá»¥m, chá»§ yáº¿u Ä‘á»ƒ ghi láº¡i thÃ´ng tin vá» cÃ¡c nÃºt trong cá»¥m, tráº¡ng thÃ¡i cá»§a chÃºng vÃ  má»™t sá»‘ tham sá»‘ bá»n vá»¯ng, Ä‘á»ƒ khÃ´i phá»¥c tráº¡ng thÃ¡i nÃ y khi khá»Ÿi Ä‘á»™ng láº¡i. ThÃ´ng thÆ°á»ng, tá»‡p nÃ y sáº½ Ä‘Æ°á»£c cáº­p nháº­t sau khi nháº­n Ä‘Æ°á»£c yÃªu cáº§u.</li>
<li><strong>cluster-node-timeout</strong> <code>&lt;milliseconds&gt;</code> - ÄÃ¢y lÃ  thá»i gian tá»‘i Ä‘a mÃ  má»™t nÃºt trong cá»¥m cÃ³ thá»ƒ máº¥t káº¿t ná»‘i. Náº¿u vÆ°á»£t quÃ¡ thá»i gian nÃ y, nÃºt sáº½ Ä‘Æ°á»£c coi lÃ  gáº·p sá»± cá»‘. Náº¿u má»™t nÃºt chÃ­nh váº«n khÃ´ng thá»ƒ káº¿t ná»‘i sau thá»i gian nÃ y, nÃºt con cá»§a nÃ³ sáº½ tiáº¿p tá»¥c chuyá»ƒn Ä‘á»•i thÃ nh nÃºt chÃ­nh. LÆ°u Ã½, náº¿u má»™t nÃºt khÃ´ng thá»ƒ káº¿t ná»‘i vá»›i háº§u háº¿t cÃ¡c nÃºt chÃ­nh trong thá»i gian nÃ y, nÃ³ sáº½ ngá»«ng nháº­n báº¥t ká»³ yÃªu cáº§u nÃ o.</li>
<li><strong>cluster-slave-validity-factor</strong> <code>&lt;factor&gt;</code> - Náº¿u Ä‘Æ°á»£c Ä‘áº·t thÃ nh 0, báº¥t ká»ƒ máº¥t káº¿t ná»‘i giá»¯a nÃºt con vÃ  nÃºt chÃ­nh Ä‘Ã£ kÃ©o dÃ i bao lÃ¢u, nÃºt con sáº½ cá»‘ gáº¯ng trá»Ÿ thÃ nh nÃºt chÃ­nh. Náº¿u Ä‘Æ°á»£c Ä‘áº·t thÃ nh má»™t sá»‘ dÆ°Æ¡ng, thÃ¬ thá»i gian mÃ  cluster-node-timeout nhÃ¢n vá»›i cluster-slave-validity-factor sáº½ lÃ  thá»i gian hiá»‡u quáº£ cá»§a nÃºt con sau khi máº¥t káº¿t ná»‘i vá»›i nÃºt chÃ­nh, vÆ°á»£t quÃ¡ thá»i gian nÃ y, nÃºt con sáº½ khÃ´ng chuyá»ƒn Ä‘á»•i thÃ nh nÃºt chÃ­nh. Giáº£ sá»­ cluster-node-timeout = 5, cluster-slave-validity-factor = 10, náº¿u nÃºt con máº¥t káº¿t ná»‘i vá»›i nÃºt chÃ­nh quÃ¡ 50 giÃ¢y, nÃ³ sáº½ khÃ´ng thá»ƒ trá»Ÿ thÃ nh nÃºt chÃ­nh. LÆ°u Ã½, náº¿u tham sá»‘ nÃ y Ä‘Æ°á»£c cáº¥u hÃ¬nh thÃ nh má»™t sá»‘ dÆ°Æ¡ng, cÃ³ thá»ƒ xáº£y ra tÃ¬nh huá»‘ng mÃ  má»™t nÃºt chÃ­nh khÃ´ng thá»ƒ Ä‘Æ°á»£c thay tháº¿ bá»Ÿi báº¥t ká»³ nÃºt con nÃ o, dáº«n Ä‘áº¿n cá»¥m khÃ´ng hoáº¡t Ä‘á»™ng, trong trÆ°á»ng há»£p nÃ y, chá»‰ khi nÃºt chÃ­nh ban Ä‘áº§u trá»Ÿ láº¡i cá»¥m, cá»¥m má»›i hoáº¡t Ä‘á»™ng trá»Ÿ láº¡i.</li>
<li><strong>cluster-migration-barrier</strong> <code>&lt;count&gt;</code> - Sá»‘ lÆ°á»£ng tá»‘i thiá»ƒu cá»§a nÃºt con cáº§n thiáº¿t cho má»™t nÃºt chÃ­nh, chá»‰ khi Ä‘áº¡t Ä‘Æ°á»£c sá»‘ lÆ°á»£ng nÃ y, khi nÃºt chÃ­nh gáº·p sá»± cá»‘, nÃºt con cá»§a nÃ³ má»›i Ä‘Æ°á»£c chuyá»ƒn Ä‘á»•i. Chi tiáº¿t hÆ¡n vá» viá»‡c sao chÃ©p nÃºt con sang má»™t pháº§n, hÃ£y xem pháº§n sau cá»§a hÆ°á»›ng dáº«n nÃ y.</li>
<li><strong>cluster-require-full-coverage</strong> <code>&lt;yes/no&gt;</code> - Khi má»™t sá»‘ nÃºt khÃ´ng kháº£ dá»¥ng trong má»™t pháº§n key, náº¿u tham sá»‘ nÃ y Ä‘Æ°á»£c cáº¥u hÃ¬nh thÃ nh "yes" (giÃ¡ trá»‹ máº·c Ä‘á»‹nh), cá»¥m sáº½ ngá»«ng nháº­n cÃ¡c hoáº¡t Ä‘á»™ng; náº¿u tham sá»‘ nÃ y Ä‘Æ°á»£c cáº¥u hÃ¬nh thÃ nh "no", cá»¥m váº«n cung cáº¥p hoáº¡t Ä‘á»™ng Ä‘á»c cho cÃ¡c key trÃªn cÃ¡c nÃºt cÃ³ thá»ƒ truy cáº­p.</li>
</ul>
<h2>5. CÃ¡c giáº£i phÃ¡p cá»¥m Redis khÃ¡c</h2>
<p>Redis Cluster khÃ´ng phÃ¹ há»£p cho viá»‡c xÃ¢y dá»±ng cÃ¡c cá»¥m Redis quy mÃ´ lá»›n, do Ä‘Ã³, náº¿u báº¡n muá»‘n xÃ¢y dá»±ng má»™t cá»¥m Redis quy mÃ´ lá»›n, báº¡n cáº§n chá»n cÃ¡c giáº£i phÃ¡p thay tháº¿. ThÃ´ng thÆ°á»ng cÃ³ ba loáº¡i giáº£i phÃ¡p:</p>
<ul>
<li>Giáº£i phÃ¡p phÃ¢n vÃ¹ng khÃ¡ch hÃ ng (Client-side sharding)</li>
<li>Giáº£i phÃ¡p phÃ¢n vÃ¹ng trung gian (Proxy-based sharding)</li>
<li>Giáº£i phÃ¡p Ä‘á»‹nh tuyáº¿n truy váº¥n (Query routing)</li>
</ul>
<h3>5.1. Giáº£i phÃ¡p phÃ¢n vÃ¹ng khÃ¡ch hÃ ng (Client-side sharding)</h3>
<p>Trong giáº£i phÃ¡p nÃ y, <strong>khÃ¡ch hÃ ng</strong> tá»± quyáº¿t Ä‘á»‹nh dá»¯ liá»‡u sáº½ Ä‘Æ°á»£c <strong>lÆ°u trá»¯</strong> trÃªn nÃºt Redis nÃ o hoáº·c dá»¯ liá»‡u sáº½ Ä‘Æ°á»£c <strong>Ä‘á»c</strong> tá»« nÃºt Redis nÃ o. Ã tÆ°á»Ÿng chÃ­nh lÃ  sá»­ dá»¥ng thuáº­t toÃ¡n <strong>hashing</strong> Ä‘á»ƒ phÃ¢n tÃ¡n cÃ¡c khÃ³a Redis, thÃ´ng qua hÃ m <strong>hash</strong>, cÃ¡c khÃ³a cá»¥ thá»ƒ sáº½ Ä‘Æ°á»£c <strong>Ã¡nh xáº¡</strong> vÃ o cÃ¡c nÃºt Redis cá»¥ thá»ƒ.</p>
<p>Giáº£i phÃ¡p phÃ¢n vÃ¹ng khÃ¡ch hÃ ng phá»• biáº¿n lÃ  Redis Sharding, Ä‘Ã¢y lÃ  phÆ°Æ¡ng phÃ¡p <strong>cá»¥m nhiá»u phiÃªn báº£n</strong> Redis Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i trÆ°á»›c khi Redis Cluster ra Ä‘á»i. ThÆ° viá»‡n Ä‘iá»u khiá»ƒn Redis cho Java <a href="https://github.com/redis/jedis" target="_blank" rel="noopener noreferrer"><strong>Jedis</strong></a> há»— trá»£ chá»©c nÄƒng Redis Sharding, bao gá»“m ShardedJedis vÃ  ShardedJedisPool káº¿t há»£p vá»›i <strong>bá»ƒ cache</strong>.</p>
<ul>
<li><strong>Æ¯u Ä‘iá»ƒm</strong>: KhÃ´ng sá»­ dá»¥ng <strong>pháº§n má»m trung gian</strong>, quy táº¯c phÃ¢n vÃ¹ng cÃ³ thá»ƒ Ä‘Æ°á»£c kiá»ƒm soÃ¡t, cáº¥u hÃ¬nh Ä‘Æ¡n giáº£n, khÃ´ng cÃ³ sá»± phá»¥ thuá»™c giá»¯a cÃ¡c nÃºt, dá»… dÃ ng má»Ÿ rá»™ng tuyáº¿n tÃ­nh, linh hoáº¡t.</li>
<li><strong>NhÆ°á»£c Ä‘iá»ƒm</strong>: <strong>KhÃ¡ch hÃ ng</strong> khÃ´ng thá»ƒ <strong>tá»± Ä‘á»™ng thÃªm/xÃ³a</strong> nÃºt dá»‹ch vá»¥, khÃ¡ch hÃ ng pháº£i tá»± quáº£n lÃ½ quy táº¯c <strong>phÃ¢n phá»‘i</strong>, khÃ´ng cÃ³ <strong>chia sáº» káº¿t ná»‘i</strong> giá»¯a cÃ¡c khÃ¡ch hÃ ng, dáº«n Ä‘áº¿n lÃ£ng phÃ­ káº¿t ná»‘i.</li>
</ul>
<h3>5.2. Giáº£i phÃ¡p phÃ¢n vÃ¹ng trung gian (Proxy-based sharding)</h3>
<p>Trong giáº£i phÃ¡p nÃ y, <strong>khÃ¡ch hÃ ng</strong> gá»­i yÃªu cáº§u Ä‘áº¿n má»™t <strong>thÃ nh pháº§n trung gian</strong>, <strong>thÃ nh pháº§n trung gian</strong> phÃ¢n tÃ­ch dá»¯ liá»‡u cá»§a khÃ¡ch hÃ ng vÃ  chuyá»ƒn tiáº¿p yÃªu cáº§u Ä‘áº¿n nÃºt Redis chÃ­nh xÃ¡c, sau Ä‘Ã³ tráº£ káº¿t quáº£ vá» cho khÃ¡ch hÃ ng.</p>
<ul>
<li><strong>Æ¯u Ä‘iá»ƒm</strong>: Giáº£m Ä‘Æ¡n giáº£n hÃ³a <strong>phÃ¢n tÃ¡n logic</strong> cá»§a khÃ¡ch hÃ ng, khÃ¡ch hÃ ng káº¿t ná»‘i má»™t cÃ¡ch <strong>trong suá»‘t</strong>, chi phÃ­ chuyá»ƒn tiáº¿p vÃ  lÆ°u trá»¯ Ä‘Æ°á»£c <strong>tÃ¡ch biá»‡t</strong>.</li>
<li><strong>NhÆ°á»£c Ä‘iá»ƒm</strong>: ThÃªm má»™t <strong>lá»›p trung gian</strong>, tÄƒng Ä‘á»™ phá»©c táº¡p cá»§a kiáº¿n trÃºc vÃ  hiá»‡u suáº¥t.</li>
</ul>
<p>CÃ¡c giáº£i phÃ¡p phÃ¢n vÃ¹ng trung gian phá»• biáº¿n bao gá»“m <strong><a href="https://github.com/twitter/twemproxy" target="_blank" rel="noopener noreferrer">Twemproxy</a></strong> vÃ  <strong><a href="https://github.com/CodisLabs/codis" target="_blank" rel="noopener noreferrer">Codis</a></strong>.</p>
<h4>5.2.1. Twemproxy</h4>
<p><strong><a href="https://github.com/twitter/twemproxy" target="_blank" rel="noopener noreferrer">Twemproxy</a></strong>, cÃ²n Ä‘Æ°á»£c gá»i lÃ  "nutcraker", lÃ  má»™t chÆ°Æ¡ng trÃ¬nh trung gian Redis vÃ  Memcache mÃ£ nguá»“n má»Ÿ cá»§a Twitter.</p>
<p><strong><a href="https://github.com/twitter/twemproxy" target="_blank" rel="noopener noreferrer">Twemproxy</a></strong> hoáº¡t Ä‘á»™ng nhÆ° má»™t trung gian, cÃ³ thá»ƒ cháº¥p nháº­n truy cáº­p tá»« nhiá»u chÆ°Æ¡ng trÃ¬nh vÃ  dá»±a trÃªn quy táº¯c Ä‘á»‹nh tuyáº¿n, chuyá»ƒn tiáº¿p yÃªu cáº§u Ä‘áº¿n cÃ¡c mÃ¡y chá»§ Redis phÃ­a sau vÃ  tráº£ káº¿t quáº£ trá»Ÿ láº¡i. <strong><a href="https://github.com/twitter/twemproxy" target="_blank" rel="noopener noreferrer">Twemproxy</a></strong> cÃ³ váº¥n Ä‘á» vá» <strong>Ä‘iá»ƒm Ä‘Æ¡n</strong> vÃ  cáº§n pháº£i káº¿t há»£p vá»›i Lvs vÃ  Keepalived Ä‘á»ƒ cÃ³ giáº£i phÃ¡p <strong>cao nháº¥t</strong>.</p>
<ul>
<li><strong>Æ¯u Ä‘iá»ƒm</strong>: Pháº¡m vi á»©ng dá»¥ng rá»™ng, á»•n Ä‘á»‹nh, <strong>cao nháº¥t</strong> cho lá»›p trung gian.</li>
<li><strong>NhÆ°á»£c Ä‘iá»ƒm</strong>: KhÃ´ng thá»ƒ <strong>má»Ÿ rá»™ng/ thu háº¹p</strong> má»™t cÃ¡ch mÆ°á»£t mÃ , khÃ´ng cÃ³ giao diá»‡n quáº£n lÃ½ <strong>trá»±c quan</strong>, khÃ´ng thá»ƒ tá»± Ä‘á»™ng chuyá»ƒn tiáº¿p khi xáº£y ra sá»± cá»‘.</li>
</ul>
<h4>5.2.2. Codis</h4>
<p><a href="https://github.com/CodisLabs/codis" target="_blank" rel="noopener noreferrer"><strong>Codis</strong></a> lÃ  má»™t giáº£i phÃ¡p Redis <strong>phÃ¢n tÃ¡n</strong>. Äá»‘i vá»›i á»©ng dá»¥ng trÃªn cÃ¹ng, káº¿t ná»‘i vá»›i Codis-Proxy vÃ  káº¿t ná»‘i trá»±c tiáº¿p vá»›i Redis-Server gá»‘c khÃ´ng cÃ³ sá»± khÃ¡c biá»‡t. <a href="https://github.com/CodisLabs/codis" target="_blank" rel="noopener noreferrer"><strong>Codis</strong></a> xá»­ lÃ½ viá»‡c chuyá»ƒn tiáº¿p yÃªu cáº§u vÃ  lÃ m viá»‡c khÃ´ng ngá»«ng Ä‘á»ƒ di chuyá»ƒn dá»¯ liá»‡u mÃ  khÃ´ng cáº§n táº¯t mÃ¡y. <a href="https://github.com/CodisLabs/codis" target="_blank" rel="noopener noreferrer"><strong>Codis</strong></a> sá»­ dá»¥ng má»™t lá»›p trung gian <strong>khÃ´ng cÃ³ tráº¡ng thÃ¡i</strong>, Ä‘á»‘i vá»›i <strong>khÃ¡ch hÃ ng</strong>, má»i thá»© Ä‘á»u trong suá»‘t.</p>
<ul>
<li><strong>Æ¯u Ä‘iá»ƒm</strong>: Cung cáº¥p <strong>kháº£ nÄƒng cao</strong> cho Proxy vÃ  Redis gá»‘c, <strong>phÃ¢n vÃ¹ng dá»¯ liá»‡u</strong> vÃ  <strong>cÃ¢n báº±ng tá»± Ä‘á»™ng</strong>, cung cáº¥p giao diá»‡n dÃ²ng lá»‡nh vÃ  RESTful API, cung cáº¥p giao diá»‡n <strong>giÃ¡m sÃ¡t</strong> vÃ  <strong>quáº£n lÃ½</strong>, cho phÃ©p <strong>thÃªm/xÃ³a</strong> nÃºt Redis Ä‘á»™ng.</li>
<li><strong>NhÆ°á»£c Ä‘iá»ƒm</strong>: <strong>Triá»ƒn khai kiáº¿n trÃºc</strong> vÃ  <strong>cáº¥u hÃ¬nh</strong> phá»©c táº¡p, khÃ´ng há»— trá»£ <strong>Ä‘a trá»¥ sá»Ÿ</strong> vÃ  <strong>Ä‘a ngÆ°á»i dÃ¹ng</strong>, khÃ´ng há»— trá»£ <strong>quáº£n lÃ½ xÃ¡c thá»±c</strong>.</li>
</ul>
<h3>5.3. Giáº£i phÃ¡p Ä‘á»‹nh tuyáº¿n truy váº¥n (Query routing)</h3>
<p>Trong giáº£i phÃ¡p nÃ y, <strong>khÃ¡ch hÃ ng</strong> gá»­i yÃªu cáº§u Ä‘áº¿n má»™t <strong>nÃºt Redis</strong> báº¥t ká»³, sau Ä‘Ã³ Redis sáº½ <strong>chuyá»ƒn tiáº¿p</strong> yÃªu cáº§u Ä‘áº¿n <strong>nÃºt Redis</strong> chÃ­nh xÃ¡c. Redis Cluster thá»±c hiá»‡n má»™t hÃ¬nh thá»©c <strong>Ä‘á»‹nh tuyáº¿n truy váº¥n káº¿t há»£p</strong>, nhÆ°ng khÃ´ng pháº£i lÃ  chuyá»ƒn tiáº¿p yÃªu cáº§u tá»« má»™t nÃºt Redis sang má»™t nÃºt Redis khÃ¡c, mÃ  lÃ  thÃ´ng qua <strong>chuyá»ƒn hÆ°á»›ng</strong> trá»±c tiáº¿p tá»« <strong>khÃ¡ch hÃ ng</strong> Ä‘áº¿n nÃºt Redis chá»©a dá»¯ liá»‡u.</p>
<ul>
<li><strong>Æ¯u Ä‘iá»ƒm</strong>: <strong>Phi táº­p trung</strong>, dá»¯ liá»‡u Ä‘Æ°á»£c lÆ°u trá»¯ vÃ  phÃ¢n phá»‘i trÃªn nhiá»u nÃºt Redis, cÃ³ thá»ƒ má»Ÿ rá»™ng/thu háº¹p nÃºt má»™t cÃ¡ch mÆ°á»£t mÃ , há»— trá»£ <strong>cao nháº¥t</strong> vÃ  <strong>chuyá»ƒn tiáº¿p tá»± Ä‘á»™ng</strong> khi xáº£y ra sá»± cá»‘, chi phÃ­ quáº£n trá»‹ tháº¥p.</li>
<li><strong>NhÆ°á»£c Ä‘iá»ƒm</strong>: Phá»¥ thuá»™c náº·ng vÃ o cÃ´ng cá»¥ Redis-trib, thiáº¿u <strong>giÃ¡m sÃ¡t quáº£n lÃ½</strong>, pháº£i dá»±a vÃ o Smart Client (<strong>duy trÃ¬ káº¿t ná»‘i</strong>, <strong>bá»™ nhá»› Ä‘á»‡m báº£ng Ä‘á»‹nh tuyáº¿n</strong>, há»— trá»£ <code>MultiOp</code> vÃ  <code>Pipeline</code>). Kiá»ƒm tra <strong>Failover</strong> cá»§a nÃºt máº¥t thá»i gian, khÃ´ng thá»ƒ phÃ¢n biá»‡t dá»¯ liá»‡u <strong>láº¡nh/hot</strong> dá»±a trÃªn thá»‘ng kÃª.</li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>Redis Data Structures</title>
      <link>https://vanhung4499.github.io/database/redis/data-structures.html</link>
      <guid>https://vanhung4499.github.io/database/redis/data-structures.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Redis Data Structures</source>
      <description>Redis Data Structures SDS Giá»›i thiá»‡u vá» SDS SDS lÃ  viáº¿t táº¯t cá»§a Simple Dynamic String, tá»©c lÃ  Chuá»—i Äá»™ng ÄÆ¡n Giáº£n. Redis Ä‘Ã£ tá»‘i Æ°u SDS Ä‘á»ƒ thay tháº¿ chuá»—i C trong viá»‡c biá»ƒu diá»…n n...</description>
      <category>redis</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>SDS</h2>
<h3>Giá»›i thiá»‡u vá» SDS</h3>
<p>SDS lÃ  viáº¿t táº¯t cá»§a Simple Dynamic String, tá»©c lÃ  <strong>Chuá»—i Äá»™ng ÄÆ¡n Giáº£n</strong>. Redis Ä‘Ã£ tá»‘i Æ°u SDS Ä‘á»ƒ thay tháº¿ chuá»—i C trong viá»‡c biá»ƒu diá»…n ná»™i dung chuá»—i. NgoÃ i ra, SDS cÃ²n Ä‘Æ°á»£c Redis sá»­ dá»¥ng nhÆ° lÃ  vÃ¹ng Ä‘á»‡m (buffer), cháº³ng háº¡n nhÆ° vÃ¹ng Ä‘á»‡m AOF trong mÃ´ Ä‘un AOF vÃ  vÃ¹ng Ä‘á»‡m Ä‘áº§u vÃ o trong tráº¡ng thÃ¡i cá»§a khÃ¡ch hÃ ng.</p>
<p>So vá»›i chuá»—i C, SDS cÃ³ nhá»¯ng Æ°u Ä‘iá»ƒm sau:</p>
<p>| Chuá»—i C                                              | SDS                                                  |<br>
| :</p>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20240624213746.png" type="image/png"/>
    </item>
    <item>
      <title>Redis Event</title>
      <link>https://vanhung4499.github.io/database/redis/event.html</link>
      <guid>https://vanhung4499.github.io/database/redis/event.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Redis Event</source>
      <description>Redis Event MÃ¡y chá»§ Redis lÃ  má»™t chÆ°Æ¡ng trÃ¬nh Ä‘iá»u khiá»ƒn sá»± kiá»‡n, mÃ¡y chá»§ cáº§n xá»­ lÃ½ hai loáº¡i sá»± kiá»‡n: Sá»± kiá»‡n tá»‡p (file event) - MÃ¡y chá»§ Redis giao tiáº¿p vá»›i cÃ¡c khÃ¡ch hÃ ng hoáº·c ...</description>
      <category>redis</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>MÃ¡y chá»§ Redis lÃ  má»™t chÆ°Æ¡ng trÃ¬nh Ä‘iá»u khiá»ƒn sá»± kiá»‡n, mÃ¡y chá»§ cáº§n xá»­ lÃ½ hai loáº¡i sá»± kiá»‡n:</p>
<ul>
<li><strong>Sá»± kiá»‡n tá»‡p (file event)</strong> - MÃ¡y chá»§ Redis giao tiáº¿p vá»›i cÃ¡c khÃ¡ch hÃ ng hoáº·c cÃ¡c mÃ¡y chá»§ khÃ¡c thÃ´ng qua cÃ¡c socket. Sá»± kiá»‡n tá»‡p lÃ  má»™t sá»± trá»«u tÆ°á»£ng cá»§a cÃ¡c thao tÃ¡c trÃªn socket. Giao tiáº¿p giá»¯a mÃ¡y chá»§ vÃ  khÃ¡ch hÃ ng (hoáº·c cÃ¡c mÃ¡y chá»§ khÃ¡c) sáº½ táº¡o ra cÃ¡c sá»± kiá»‡n tá»‡p, vÃ  mÃ¡y chá»§ sáº½ hoÃ n thÃ nh má»™t loáº¡t cÃ¡c thao tÃ¡c giao tiáº¿p máº¡ng báº±ng cÃ¡ch láº¯ng nghe vÃ  xá»­ lÃ½ cÃ¡c sá»± kiá»‡n nÃ y.</li>
<li><strong>Sá»± kiá»‡n thá»i gian (time event)</strong> - MÃ¡y chá»§ Redis cÃ³ má»™t sá»‘ thao tÃ¡c cáº§n Ä‘Æ°á»£c thá»±c hiá»‡n vÃ o má»™t thá»i Ä‘iá»ƒm nháº¥t Ä‘á»‹nh. Sá»± kiá»‡n thá»i gian lÃ  má»™t sá»± trá»«u tÆ°á»£ng cá»§a cÃ¡c thao tÃ¡c Ä‘á»‹nh ká»³ nÃ y.</li>
</ul>
</blockquote>
<h2>Sá»± kiá»‡n tá»‡p</h2>
<p>Redis Ä‘Ã£ phÃ¡t triá»ƒn bá»™ xá»­ lÃ½ sá»± kiá»‡n máº¡ng cá»§a riÃªng mÃ¬nh dá»±a trÃªn mÃ´ hÃ¬nh Reactor.</p>
<ul>
<li>Bá»™ xá»­ lÃ½ sá»± kiá»‡n tá»‡p cá»§a Redis sá»­ dá»¥ng chÆ°Æ¡ng trÃ¬nh I/O Ä‘a luá»“ng Ä‘á»ƒ láº¯ng nghe Ä‘á»“ng thá»i nhiá»u socket vÃ  liÃªn káº¿t cÃ¡c trÃ¬nh xá»­ lÃ½ sá»± kiá»‡n khÃ¡c nhau cho cÃ¡c socket dá»±a trÃªn nhiá»‡m vá»¥ hiá»‡n táº¡i cá»§a socket.</li>
<li>Khi socket Ä‘ang Ä‘Æ°á»£c láº¯ng nghe sáºµn sÃ ng thá»±c hiá»‡n cÃ¡c thao tÃ¡c káº¿t ná»‘i pháº£n há»“i, Ä‘á»c, ghi, hoáº·c Ä‘Ã³ng, cÃ¡c sá»± kiá»‡n tá»‡p tÆ°Æ¡ng á»©ng vá»›i cÃ¡c thao tÃ¡c nÃ y sáº½ Ä‘Æ°á»£c táº¡o ra. LÃºc nÃ y, bá»™ xá»­ lÃ½ sá»± kiá»‡n tá»‡p sáº½ gá»i cÃ¡c trÃ¬nh xá»­ lÃ½ sá»± kiá»‡n Ä‘Ã£ liÃªn káº¿t trÆ°á»›c Ä‘Ã³ vá»›i socket Ä‘á»ƒ xá»­ lÃ½ cÃ¡c sá»± kiá»‡n nÃ y.</li>
</ul>
<p>Máº·c dÃ¹ bá»™ xá»­ lÃ½ sá»± kiá»‡n tá»‡p cháº¡y theo cÃ¡ch Ä‘Æ¡n luá»“ng, nhÆ°ng thÃ´ng qua viá»‡c sá»­ dá»¥ng chÆ°Æ¡ng trÃ¬nh I/O Ä‘a luá»“ng Ä‘á»ƒ láº¯ng nghe nhiá»u socket, bá»™ xá»­ lÃ½ sá»± kiá»‡n tá»‡p Ä‘Ã£ Ä‘áº¡t Ä‘Æ°á»£c mÃ´ hÃ¬nh giao tiáº¿p máº¡ng hiá»‡u suáº¥t cao.</p>
<p>Bá»™ xá»­ lÃ½ sá»± kiá»‡n tá»‡p bao gá»“m bá»‘n thÃ nh pháº§n: socket, chÆ°Æ¡ng trÃ¬nh I/O Ä‘a luá»“ng, bá»™ phÃ¢n phá»‘i sá»± kiá»‡n tá»‡p, vÃ  trÃ¬nh xá»­ lÃ½ sá»± kiá»‡n.</p>
<h2>Sá»± kiá»‡n thá»i gian</h2>
<p>Sá»± kiá»‡n thá»i gian Ä‘Æ°á»£c chia thÃ nh:</p>
<ul>
<li><strong>Sá»± kiá»‡n Ä‘á»‹nh thá»i</strong>: cho phÃ©p má»™t Ä‘oáº¡n chÆ°Æ¡ng trÃ¬nh Ä‘Æ°á»£c thá»±c thi má»™t láº§n vÃ o thá»i Ä‘iá»ƒm Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh.</li>
<li><strong>Sá»± kiá»‡n chu ká»³</strong>: cho phÃ©p má»™t Ä‘oáº¡n chÆ°Æ¡ng trÃ¬nh Ä‘Æ°á»£c thá»±c thi Ä‘á»‹nh ká»³ sau khoáº£ng thá»i gian Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh.</li>
</ul>
<p>Redis lÆ°u trá»¯ táº¥t cáº£ cÃ¡c sá»± kiá»‡n thá»i gian trong má»™t danh sÃ¡ch liÃªn káº¿t khÃ´ng cÃ³ thá»© tá»±. Má»—i khi bá»™ xá»­ lÃ½ sá»± kiá»‡n thá»i gian cháº¡y, nÃ³ sáº½ duyá»‡t qua toÃ n bá»™ danh sÃ¡ch Ä‘á»ƒ tÃ¬m cÃ¡c sá»± kiá»‡n thá»i gian Ä‘Ã£ Ä‘áº¿n háº¡n vÃ  gá»i cÃ¡c trÃ¬nh xá»­ lÃ½ sá»± kiá»‡n tÆ°Æ¡ng á»©ng.</p>
<h2>Láº­p lá»‹ch vÃ  thá»±c thi sá»± kiá»‡n</h2>
<p>MÃ¡y chá»§ Redis cáº§n liÃªn tá»¥c láº¯ng nghe cÃ¡c sá»± kiá»‡n tá»‡p trÃªn cÃ¡c socket Ä‘á»ƒ xá»­ lÃ½ cÃ¡c sá»± kiá»‡n tá»‡p Ä‘Ã³. Tuy nhiÃªn, khÃ´ng thá»ƒ chá»‰ láº¯ng nghe mÃ£i mÃ  khÃ´ng quan tÃ¢m Ä‘áº¿n cÃ¡c sá»± kiá»‡n thá»i gian, náº¿u khÃ´ng cÃ¡c sá»± kiá»‡n thá»i gian sáº½ khÃ´ng Ä‘Æ°á»£c thá»±c thi Ä‘Ãºng lÃºc. Do Ä‘Ã³, thá»i gian láº¯ng nghe cáº§n Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh dá»±a trÃªn sá»± kiá»‡n thá»i gian gáº§n nháº¥t so vá»›i thá»i Ä‘iá»ƒm hiá»‡n táº¡i.</p>
<p>Viá»‡c láº­p lá»‹ch vÃ  thá»±c thi sá»± kiá»‡n Ä‘Æ°á»£c quáº£n lÃ½ bá»Ÿi hÃ m <code>aeProcessEvents</code>, vá»›i mÃ£ giáº£ nhÆ° sau:</p>
<div class="language-python line-numbers-mode" data-ext="python" data-title="python"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">def</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> aeProcessEvents</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">():</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">    ## Láº¥y sá»± kiá»‡n thá»i gian gáº§n nháº¥t so vá»›i thá»i gian hiá»‡n táº¡i</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    time_event </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> aeSearchNearestTimer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">    ## TÃ­nh toÃ¡n khoáº£ng thá»i gian cÃ²n láº¡i cho Ä‘áº¿n khi sá»± kiá»‡n gáº§n nháº¥t xáº£y ra</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    remaind_ms </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> time_event.when </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> unix_ts_now</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">    ## Náº¿u sá»± kiá»‡n Ä‘Ã£ Ä‘áº¿n háº¡n, giÃ¡ trá»‹ cá»§a remaind_ms cÃ³ thá»ƒ Ã¢m, Ä‘áº·t nÃ³ báº±ng 0</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> remaind_ms </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&lt;</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        remaind_ms </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">    ## Táº¡o timeval dá»±a trÃªn giÃ¡ trá»‹ remaind_ms</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    timeval </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> create_timeval_with_ms</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(remaind_ms)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">    ## Cháº·n vÃ  chá» Ä‘á»£i sá»± kiá»‡n tá»‡p phÃ¡t sinh, thá»i gian cháº·n tá»‘i Ä‘a Ä‘Æ°á»£c quyáº¿t Ä‘á»‹nh bá»Ÿi timeval</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    aeApiPoll</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(timeval)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">    ## Xá»­ lÃ½ táº¥t cáº£ cÃ¡c sá»± kiá»‡n tá»‡p Ä‘Ã£ phÃ¡t sinh</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    procesFileEvents</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">    ## Xá»­ lÃ½ táº¥t cáº£ cÃ¡c sá»± kiá»‡n thá»i gian Ä‘Ã£ Ä‘áº¿n háº¡n</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    processTimeEvents</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">()</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Äáº·t hÃ m <code>aeProcessEvents</code> trong má»™t vÃ²ng láº·p, cÃ¹ng vá»›i cÃ¡c hÃ m khá»Ÿi táº¡o vÃ  dá»n dáº¹p, sáº½ táº¡o thÃ nh hÃ m chÃ­nh cá»§a mÃ¡y chá»§ Redis, mÃ£ giáº£ nhÆ° sau:</p>
<div class="language-python" data-ext="python" data-title="python"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">def</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> main</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">():</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">    ## Khá»Ÿi táº¡o mÃ¡y chá»§</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    init_server</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">    ## LiÃªn tá»¥c xá»­ lÃ½ sá»± kiá»‡n cho Ä‘áº¿n khi mÃ¡y chá»§ táº¯t</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    while</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> server_is_not_shutdown</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">():</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        aeProcessEvents</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">    ## MÃ¡y chá»§ táº¯t, thá»±c hiá»‡n cÃ¡c thao tÃ¡c dá»n dáº¹p</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    clean_server</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">()</span></span></code></pre>
</div><h2>Láº­p lá»‹ch vÃ  thá»±c thi sá»± kiá»‡n</h2>
<h3>CÃ¡ch thá»©c hoáº¡t Ä‘á»™ng</h3>
<p>MÃ¡y chá»§ cáº§n liÃªn tá»¥c láº¯ng nghe cÃ¡c sá»± kiá»‡n tá»‡p Ä‘á»ƒ xá»­ lÃ½ chÃºng. Tuy nhiÃªn, Ä‘á»ƒ Ä‘áº£m báº£o cÃ¡c sá»± kiá»‡n thá»i gian cÅ©ng Ä‘Æ°á»£c thá»±c thi Ä‘Ãºng lÃºc, thá»i gian láº¯ng nghe cÃ¡c sá»± kiá»‡n tá»‡p Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh dá»±a trÃªn thá»i Ä‘iá»ƒm xáº£y ra sá»± kiá»‡n thá»i gian gáº§n nháº¥t.</p>
<h3>QuÃ¡ trÃ¬nh xá»­ lÃ½ sá»± kiá»‡n</h3>
<ol>
<li>Láº¥y sá»± kiá»‡n thá»i gian gáº§n nháº¥t so vá»›i thá»i gian hiá»‡n táº¡i.</li>
<li>TÃ­nh toÃ¡n khoáº£ng thá»i gian cÃ²n láº¡i cho Ä‘áº¿n khi sá»± kiá»‡n xáº£y ra.</li>
<li>Náº¿u sá»± kiá»‡n Ä‘Ã£ Ä‘áº¿n háº¡n, Ä‘áº·t thá»i gian cÃ²n láº¡i báº±ng 0.</li>
<li>Táº¡o giÃ¡ trá»‹ timeval dá»±a trÃªn thá»i gian cÃ²n láº¡i.</li>
<li>Cháº·n vÃ  chá» Ä‘á»£i sá»± kiá»‡n tá»‡p, thá»i gian cháº·n tá»‘i Ä‘a Ä‘Æ°á»£c quyáº¿t Ä‘á»‹nh bá»Ÿi timeval.</li>
<li>Xá»­ lÃ½ táº¥t cáº£ cÃ¡c sá»± kiá»‡n tá»‡p Ä‘Ã£ phÃ¡t sinh.</li>
<li>Xá»­ lÃ½ táº¥t cáº£ cÃ¡c sá»± kiá»‡n thá»i gian Ä‘Ã£ Ä‘áº¿n háº¡n.</li>
</ol>
<h3>VÃ²ng láº·p chÃ­nh cá»§a mÃ¡y chá»§</h3>
<p>MÃ¡y chá»§ Redis liÃªn tá»¥c cháº¡y vÃ²ng láº·p Ä‘á»ƒ xá»­ lÃ½ cÃ¡c sá»± kiá»‡n cho Ä‘áº¿n khi mÃ¡y chá»§ táº¯t. Quy trÃ¬nh bao gá»“m khá»Ÿi táº¡o mÃ¡y chá»§, xá»­ lÃ½ sá»± kiá»‡n liÃªn tá»¥c vÃ  thá»±c hiá»‡n cÃ¡c thao tÃ¡c dá»n dáº¹p khi mÃ¡y chá»§ táº¯t.</p>
]]></content:encoded>
    </item>
    <item>
      <title>Redis Expire Delete</title>
      <link>https://vanhung4499.github.io/database/redis/expire.html</link>
      <guid>https://vanhung4499.github.io/database/redis/expire.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Redis Expire Delete</source>
      <description>Redis Expire Delete XÃ³a khi háº¿t háº¡n trong Redis Redis cho phÃ©p thiáº¿t láº­p thá»i gian tá»“n táº¡i (ttl) cho má»—i khÃ³a vÃ  tá»± Ä‘á»™ng xÃ³a khÃ³a khi nÃ³ háº¿t háº¡n. Thiáº¿t láº­p thá»i gian sá»‘ng hoáº·c t...</description>
      <category>redis</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<h3>XÃ³a khi háº¿t háº¡n trong Redis</h3>
<p>Redis cho phÃ©p thiáº¿t láº­p thá»i gian tá»“n táº¡i (ttl) cho má»—i khÃ³a vÃ  tá»± Ä‘á»™ng xÃ³a khÃ³a khi nÃ³ háº¿t háº¡n.</p>
<h4>Thiáº¿t láº­p thá»i gian sá»‘ng hoáº·c thá»i gian háº¿t háº¡n cá»§a khÃ³a</h4>
<p>Trong Redis, cÃ¡c lá»‡nh liÃªn quan Ä‘áº¿n thá»i gian sá»‘ng cá»§a khÃ³a nhÆ° sau:</p>
<p>| Lá»‡nh                                                | MÃ´ táº£                                    |<br>
|</p>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/dunwu/images/master/snap/202309171537744.png" type="image/png"/>
    </item>
    <item>
      <title>Redis Guide</title>
      <link>https://vanhung4499.github.io/database/redis/guide.html</link>
      <guid>https://vanhung4499.github.io/database/redis/guide.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Redis Guide</source>
      <description>HÆ°á»›ng dáº«n Redis 1. Giá»›i thiá»‡u vá» Redis Redis lÃ  má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u key-value nhanh chÃ³ng vÃ  khÃ´ng phá»¥ thuá»™c vÃ o quan há»‡ (NoSQL) Ä‘Æ°á»£c lÆ°u trá»¯ trong bá»™ nhá»›, cÃ³ thá»ƒ Ã¡nh xáº¡ giá»¯a cÃ¡c ...</description>
      <category>redis</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>1. Giá»›i thiá»‡u vá» Redis</h2>
<blockquote>
<p>Redis lÃ  má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u key-value nhanh chÃ³ng vÃ  khÃ´ng phá»¥ thuá»™c vÃ o quan há»‡ (NoSQL) Ä‘Æ°á»£c lÆ°u trá»¯ trong bá»™ nhá»›, cÃ³ thá»ƒ Ã¡nh xáº¡ giá»¯a cÃ¡c khÃ³a vÃ  nÄƒm loáº¡i giÃ¡ trá»‹ khÃ¡c nhau.</p>
<p>Loáº¡i khÃ³a chá»‰ cÃ³ thá»ƒ lÃ  chuá»—i, cÃ¡c loáº¡i giÃ¡ trá»‹ Ä‘Æ°á»£c há»— trá»£ bao gá»“m: chuá»—i, danh sÃ¡ch, táº­p há»£p, táº­p há»£p cÃ³ thá»© tá»± vÃ  báº£ng bÄƒm.</p>
</blockquote>
<h3>CÃ¡c trÆ°á»ng há»£p sá»­ dá»¥ng Redis</h3>
<ul>
<li><strong>Bá»™ nhá»› Ä‘á»‡m</strong> - Äáº·t dá»¯ liá»‡u hot vÃ o bá»™ nhá»›, Ä‘áº·t giá»›i háº¡n sá»­ dá»¥ng bá»™ nhá»› tá»‘i Ä‘a vÃ  chiáº¿n lÆ°á»£c loáº¡i bá» háº¿t háº¡n Ä‘á»ƒ Ä‘áº£m báº£o tá»· lá»‡ trÃºng Ä‘Ã­ch cá»§a bá»™ nhá»› Ä‘á»‡m.</li>
<li><strong>Bá»™ Ä‘áº¿m</strong> - CÆ¡ sá»Ÿ dá»¯ liá»‡u bá»™ nhá»› nÃ y há»— trá»£ cÃ¡c hoáº¡t Ä‘á»™ng Ä‘á»c vÃ  ghi bá»™ Ä‘áº¿m thÆ°á»ng xuyÃªn.</li>
<li><strong>Giá»›i háº¡n á»©ng dá»¥ng</strong> - Háº¡n cháº¿ lÆ°u lÆ°á»£ng truy cáº­p vÃ o má»™t trang web.</li>
<li><strong>HÃ ng Ä‘á»£i tin nháº¯n</strong> - Sá»­ dá»¥ng kiá»ƒu dá»¯ liá»‡u danh sÃ¡ch, Ä‘Ã³ lÃ  danh sÃ¡ch liÃªn káº¿t hai chiá»u.</li>
<li><strong>Báº£ng tÃ¬m kiáº¿m</strong> - Sá»­ dá»¥ng kiá»ƒu dá»¯ liá»‡u HASH.</li>
<li><strong>PhÃ©p giao cá»§a táº­p há»£p</strong> - Sá»­ dá»¥ng kiá»ƒu dá»¯ liá»‡u SET, vÃ­ dá»¥ nhÆ° tÃ¬m nhá»¯ng ngÆ°á»i báº¡n chung cá»§a hai ngÆ°á»i dÃ¹ng.</li>
<li><strong>Báº£ng xáº¿p háº¡ng</strong> - Sá»­ dá»¥ng kiá»ƒu dá»¯ liá»‡u ZSET.</li>
<li><strong>PhiÃªn phÃ¢n tÃ¡n</strong> - LÆ°u trá»¯ phiÃªn cá»§a nhiá»u mÃ¡y chá»§ á»©ng dá»¥ng vÃ o Redis Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh nháº¥t quÃ¡n cá»§a phiÃªn.</li>
<li><strong>KhÃ³a phÃ¢n tÃ¡n</strong> - NgoÃ i viá»‡c sá»­ dá»¥ng SETNX Ä‘á»ƒ triá»ƒn khai khÃ³a phÃ¢n tÃ¡n, báº¡n cÅ©ng cÃ³ thá»ƒ sá»­ dá»¥ng khÃ³a phÃ¢n tÃ¡n RedLock do chÃ­nh thá»©c cung cáº¥p.</li>
</ul>
<h3>Æ¯u Ä‘iá»ƒm cá»§a Redis</h3>
<ul>
<li>Hiá»‡u suáº¥t cao - Redis cÃ³ thá»ƒ Ä‘á»c vá»›i tá»‘c Ä‘á»™ 110.000 láº§n / giÃ¢y vÃ  ghi vá»›i tá»‘c Ä‘á»™ 81.000 láº§n / giÃ¢y.</li>
<li>Loáº¡i dá»¯ liá»‡u phong phÃº - Há»— trá»£ chuá»—i, danh sÃ¡ch, táº­p há»£p, táº­p há»£p cÃ³ thá»© tá»± vÃ  báº£ng bÄƒm.</li>
<li>TÃ­nh nguyÃªn tá»­ - Táº¥t cáº£ cÃ¡c hoáº¡t Ä‘á»™ng cá»§a Redis Ä‘á»u cÃ³ tÃ­nh nguyÃªn tá»­. Má»™t hoáº¡t Ä‘á»™ng Ä‘Æ¡n láº» lÃ  nguyÃªn tá»­. Nhiá»u hoáº¡t Ä‘á»™ng cÅ©ng há»— trá»£ giao dá»‹ch, tá»©c lÃ  nguyÃªn tá»­, báº±ng cÃ¡ch bao gá»“m cÃ¡c chá»‰ thá»‹ MULTI vÃ  EXEC.</li>
<li>Dá»¯ liá»‡u bá»n vá»¯ng - Redis há»— trá»£ viá»‡c lÆ°u trá»¯ dá»¯ liá»‡u. CÃ³ thá»ƒ lÆ°u trá»¯ dá»¯ liá»‡u trong bá»™ nhá»› vÃ  khÃ´i phá»¥c láº¡i khi khá»Ÿi Ä‘á»™ng láº¡i.</li>
<li>Sao lÆ°u - Redis há»— trá»£ sao lÆ°u dá»¯ liá»‡u, tá»©c lÃ  sao lÆ°u dá»¯ liá»‡u theo cháº¿ Ä‘á»™ master-slave.</li>
<li>TÃ­nh nÄƒng phong phÃº - Redis cÅ©ng há»— trá»£ xuáº¥t báº£n / Ä‘Äƒng kÃ½, thÃ´ng bÃ¡o, háº¿t háº¡n khÃ³a, v.v.</li>
</ul>
<h3>Redis vÃ  Memcached</h3>
<p>Redis vÃ  Memcached thÆ°á»ng Ä‘Æ°á»£c so sÃ¡nh vÃ¬ cáº£ hai Ä‘á»u cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng lÃ m bá»™ nhá»› Ä‘á»‡m, nhÆ°ng chÃºng cÃ³ má»™t sá»‘ khÃ¡c biá»‡t chÃ­nh nhÆ° sau:</p>
<p><strong>Loáº¡i dá»¯ liá»‡u</strong></p>
<ul>
<li>Memcached chá»‰ há»— trá»£ kiá»ƒu dá»¯ liá»‡u chuá»—i;</li>
<li>Trong khi Ä‘Ã³, Redis há»— trá»£ nÄƒm loáº¡i dá»¯ liá»‡u khÃ¡c nhau, giÃºp nÃ³ giáº£i quyáº¿t váº¥n Ä‘á» má»™t cÃ¡ch linh hoáº¡t hÆ¡n.</li>
</ul>
<p><strong>Dá»¯ liá»‡u bá»n vá»¯ng</strong></p>
<ul>
<li>Memcached khÃ´ng há»— trá»£ tÃ­nh nÄƒng bá»n vá»¯ng;</li>
<li>Redis há»— trá»£ hai chÃ­nh sÃ¡ch bá»n vá»¯ng: RDB Snapshot vÃ  AOF Log.</li>
</ul>
<p><strong>PhÃ¢n tÃ¡n</strong></p>
<ul>
<li>Memcached khÃ´ng há»— trá»£ phÃ¢n tÃ¡n, chá»‰ cÃ³ thá»ƒ triá»ƒn khai lÆ°u trá»¯ phÃ¢n tÃ¡n báº±ng cÃ¡ch sá»­ dá»¥ng thuáº­t toÃ¡n phÃ¢n tÃ¡n nhÆ° bÄƒm nháº¥t quÃ¡n trÃªn mÃ¡y khÃ¡ch, Ä‘iá»u nÃ y yÃªu cáº§u tÃ­nh toÃ¡n vá»‹ trÃ­ dá»¯ liá»‡u trÃªn mÃ¡y khÃ¡ch khi lÆ°u trá»¯ vÃ  truy váº¥n.</li>
<li>Redis Cluster há»— trá»£ phÃ¢n tÃ¡n.</li>
</ul>
<p><strong>Quáº£n lÃ½ bá»™ nhá»›</strong></p>
<ul>
<li>Memcached chia bá»™ nhá»› thÃ nh cÃ¡c khá»‘i cÃ³ Ä‘á»™ dÃ i cá»‘ Ä‘á»‹nh Ä‘á»ƒ lÆ°u trá»¯ dá»¯ liá»‡u, giáº£i quyáº¿t hoÃ n toÃ n váº¥n Ä‘á» máº£nh vá»¥n bá»™ nhá»›, nhÆ°ng phÆ°Æ¡ng phÃ¡p nÃ y lÃ m giáº£m hiá»‡u suáº¥t sá»­ dá»¥ng bá»™ nhá»›, vÃ­ dá»¥: náº¿u kÃ­ch thÆ°á»›c khá»‘i lÃ  128 byte vÃ  chá»‰ lÆ°u trá»¯ 100 byte dá»¯ liá»‡u, thÃ¬ 28 byte cÃ²n láº¡i sáº½ bá»‹ lÃ£ng phÃ­.</li>
<li>Trong Redis, khÃ´ng pháº£i táº¥t cáº£ dá»¯ liá»‡u Ä‘á»u Ä‘Æ°á»£c lÆ°u trá»¯ trong bá»™ nhá»›, má»™t sá»‘ giÃ¡ trá»‹ khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng trong thá»i gian dÃ i cÃ³ thá»ƒ Ä‘Æ°á»£c trao Ä‘á»•i sang Ä‘Ä©a. Dá»¯ liá»‡u cá»§a Memcached sáº½ luÃ´n náº±m trong bá»™ nhá»›.</li>
</ul>
<h3>Táº¡i sao Redis nhanh</h3>
<p>Redis cÃ³ thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c QPS Ä‘Æ¡n láº» lÃªn Ä‘áº¿n 100.000.</p>
<p>Redis sá»­ dá»¥ng mÃ´ hÃ¬nh Ä‘Æ¡n luá»“ng (Redis 6.0 Ä‘Ã£ há»— trá»£ mÃ´ hÃ¬nh Ä‘a luá»“ng), táº¡i sao nÃ³ váº«n cÃ³ thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c Ä‘á»“ng thá»i cao nhÆ° váº­y?</p>
<ul>
<li>Redis hoÃ n toÃ n dá»±a trÃªn hoáº¡t Ä‘á»™ng bá»™ nhá»›.</li>
<li>Cáº¥u trÃºc dá»¯ liá»‡u cá»§a Redis Ä‘Æ¡n giáº£n.</li>
<li>Sá»­ dá»¥ng mÃ´ hÃ¬nh Ä‘Æ¡n luá»“ng Ä‘á»ƒ trÃ¡nh viá»‡c chuyá»ƒn Ä‘á»•i ngá»¯ cáº£nh vÃ  cáº¡nh tranh giá»¯a cÃ¡c luá»“ng.</li>
<li>Sá»­ dá»¥ng mÃ´ hÃ¬nh I/O multiplexing (I/O khÃ´ng cháº·n).</li>
</ul>
<blockquote>
<p>I/O multiplexing</p>
<p>MÃ´ hÃ¬nh I/O multiplexing lÃ  kháº£ nÄƒng theo dÃµi cÃ¹ng má»™t lÃºc nhiá»u luá»“ng I/O sá»± kiá»‡n cá»§a select, poll, epoll. Khi khÃ´ng hoáº¡t Ä‘á»™ng, nÃ³ sáº½ cháº·n luá»“ng hiá»‡n táº¡i vÃ  khi má»™t hoáº·c nhiá»u luá»“ng cÃ³ sá»± kiá»‡n I/O, nÃ³ sáº½ Ä‘Æ°á»£c Ä‘Ã¡nh thá»©c tá»« tráº¡ng thÃ¡i cháº·n vÃ  sau Ä‘Ã³ chÆ°Æ¡ng trÃ¬nh sáº½ kiá»ƒm tra táº¥t cáº£ cÃ¡c luá»“ng I/O (epoll chá»‰ kiá»ƒm tra cÃ¡c luá»“ng thá»±c sá»± gá»­i sá»± kiá»‡n), vÃ  chá»‰ xá»­ lÃ½ tá»«ng luá»“ng sáºµn sÃ ng, Ä‘iá»u nÃ y trÃ¡nh cÃ¡c hoáº¡t Ä‘á»™ng khÃ´ng há»¯u Ã­ch lá»›n.</p>
</blockquote>
<h2>2. CÃ¡c kiá»ƒu dá»¯ liá»‡u trong Redis</h2>
<p>Redis cÃ³ cÃ¡c kiá»ƒu dá»¯ liá»‡u cÆ¡ báº£n: STRING, HASH, LIST, SET, ZSET</p>
<p>Redis cÅ©ng cÃ³ cÃ¡c kiá»ƒu dá»¯ liá»‡u nÃ¢ng cao: BitMap, HyperLogLog, GEO</p>
<p>ğŸ’¡ Äá»ƒ biáº¿t thÃªm thÃ´ng tin chi tiáº¿t vá» cÃ¡c tÃ­nh nÄƒng vÃ  nguyÃªn lÃ½, vui lÃ²ng tham kháº£o: [[Redis Data Types and Applications]]</p>
<h2>3. XÃ³a dá»¯ liá»‡u khÃ´ng sá»­ dá»¥ng trong Redis</h2>
<h3>Äiá»ƒm chÃ­nh vá» xÃ³a dá»¯ liá»‡u trong bá»™ nhá»›</h3>
<ul>
<li><strong>Bá»™ nhá»› tá»‘i Ä‘a</strong> - Redis cho phÃ©p Ä‘áº·t giÃ¡ trá»‹ tá»‘i Ä‘a cá»§a bá»™ nhá»› thÃ´ng qua tham sá»‘ <code>maxmemory</code>.</li>
<li><strong>Thá»i gian háº¿t háº¡n</strong> - LÃ  cÆ¡ cháº¿ quan trá»ng Ä‘á»ƒ xÃ³a dá»¯ liá»‡u vÃ´ hiá»‡u, trong cÃ¡c lá»‡nh Redis cung cáº¥p, <code>EXPIRE</code>, <code>EXPIREAT</code>, <code>PEXPIRE</code>, <code>PEXPIREAT</code>, <code>SETEX</code> vÃ  <code>PSETEX</code> Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘áº·t thá»i gian háº¿t háº¡n cho má»™t cáº·p khÃ³a-giÃ¡ trá»‹. Khi má»™t cáº·p khÃ³a-giÃ¡ trá»‹ Ä‘Æ°á»£c liÃªn káº¿t vá»›i thá»i gian háº¿t háº¡n, nÃ³ sáº½ tá»± Ä‘á»™ng bá»‹ xÃ³a sau khi háº¿t háº¡n (hoáº·c nÃ³i cÃ¡ch khÃ¡c, trá»Ÿ thÃ nh khÃ´ng thá»ƒ truy cáº­p).</li>
<li><strong>Chiáº¿n lÆ°á»£c xÃ³a</strong> - Khi lÆ°u trá»¯ dá»¯ liá»‡u vÃ o Redis, khi khÃ´ng gian bá»™ nhá»› cÃ²n láº¡i khÃ´ng Ä‘á»§ Ä‘á»ƒ lÆ°u trá»¯ dá»¯ liá»‡u má»›i, Redis sáº½ thá»±c hiá»‡n chiáº¿n lÆ°á»£c xÃ³a dá»¯ liá»‡u Ä‘á»ƒ giáº£i phÃ³ng má»™t pháº§n ná»™i dung vÃ  Ä‘áº£m báº£o dá»¯ liá»‡u má»›i cÃ³ thá»ƒ Ä‘Æ°á»£c lÆ°u trá»¯ trong bá»™ nhá»›. CÆ¡ cháº¿ xÃ³a dá»¯ liá»‡u trong bá»™ nhá»› nháº±m tá»‘i Æ°u hÃ³a viá»‡c sá»­ dá»¥ng bá»™ nhá»›, báº±ng cÃ¡ch Ä‘á»•i láº¥y má»™t sá»‘ láº§n khÃ´ng trÃºng Ä‘Ã­ch Ä‘á»ƒ sá»­ dá»¥ng bá»™ nhá»›, Ä‘áº£m báº£o ráº±ng dá»¯ liá»‡u Ä‘Æ°á»£c lÆ°u trá»¯ trong bá»™ nhá»› Redis lÃ  dá»¯ liá»‡u nÃ³ng.</li>
<li><strong>LRU khÃ´ng chÃ­nh xÃ¡c</strong> - TrÃªn thá»±c táº¿, Redis khÃ´ng triá»ƒn khai LRU Ä‘Ã¡ng tin cáº­y, cÃ³ nghÄ©a lÃ  viá»‡c xÃ³a khÃ³a khÃ´ng nháº¥t thiáº¿t lÃ  khÃ³a khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng lÃ¢u nháº¥t.</li>
</ul>
<h3>Thá»i gian háº¿t háº¡n cá»§a khÃ³a chÃ­nh</h3>
<p>Redis cÃ³ thá»ƒ Ä‘áº·t thá»i gian háº¿t háº¡n cho má»—i khÃ³a, khi khÃ³a háº¿t háº¡n, nÃ³ sáº½ tá»± Ä‘á»™ng bá»‹ xÃ³a.</p>
<p>Äá»‘i vá»›i cÃ¡c cáº¥u trÃºc dá»¯ liá»‡u nhÆ° báº£ng bÄƒm, chá»‰ cÃ³ thá»ƒ Ä‘áº·t thá»i gian háº¿t háº¡n cho toÃ n bá»™ khÃ³a (toÃ n bá»™ báº£ng bÄƒm), khÃ´ng thá»ƒ Ä‘áº·t thá»i gian háº¿t háº¡n cho tá»«ng pháº§n tá»­ trong khÃ³a.</p>
<p>CÃ³ thá»ƒ sá»­ dá»¥ng <code>EXPIRE</code> hoáº·c <code>EXPIREAT</code> Ä‘á»ƒ Ä‘áº·t thá»i gian háº¿t háº¡n cho khÃ³a.</p>
<blockquote>
<p>ğŸ”” LÆ°u Ã½: Náº¿u thá»i gian <code>EXPIRE</code> Ä‘Æ°á»£c Ä‘áº·t lÃ  sá»‘ Ã¢m, thá»i gian dáº¥u thá»i gian <code>EXPIREAT</code> lÃ  thá»i gian háº¿t háº¡n, khÃ³a sáº½ bá»‹ xÃ³a trá»±c tiáº¿p.</p>
</blockquote>
<p>VÃ­ dá»¥:</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">redis</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379">SET</span><span style="color:#98C379;--shiki-dark:#98C379"> mykey</span><span style="color:#98C379;--shiki-dark:#98C379"> "Hello"</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">"OK"</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">redis</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379">EXPIRE</span><span style="color:#98C379;--shiki-dark:#98C379"> mykey</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 10</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">1</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">redis</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379">TTL</span><span style="color:#98C379;--shiki-dark:#98C379"> mykey</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">10</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">redis</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379">SET</span><span style="color:#98C379;--shiki-dark:#98C379"> mykey</span><span style="color:#98C379;--shiki-dark:#98C379"> "Hello World"</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">"OK"</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">redis</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379">TTL</span><span style="color:#98C379;--shiki-dark:#98C379"> mykey</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">-1</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">redis</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&gt;</span></span></code></pre>
</div><h3>Chiáº¿n lÆ°á»£c xÃ³a dá»¯ liá»‡u</h3>
<p>XÃ³a dá»¯ liá»‡u trong bá»™ nhá»› chá»‰ lÃ  má»™t tÃ­nh nÄƒng mÃ  Redis cung cáº¥p, Ä‘á»ƒ triá»ƒn khai tá»‘t hÆ¡n tÃ­nh nÄƒng nÃ y, cáº§n cung cáº¥p cÃ¡c chiáº¿n lÆ°á»£c khÃ¡c nhau cho cÃ¡c tÃ¬nh huá»‘ng á»©ng dá»¥ng khÃ¡c nhau, váº¥n Ä‘á» cáº§n giáº£i quyáº¿t bao gá»“m cÃ¡ch chá»n khÃ´ng gian khÃ³a Ä‘á»ƒ xÃ³a? LÃ m tháº¿ nÃ o Ä‘á»ƒ chá»n khÃ³a Ä‘á»ƒ xÃ³a trong khÃ´ng gian khÃ³a?</p>
<p>Redis cung cáº¥p cÃ¡c chiáº¿n lÆ°á»£c xÃ³a dá»¯ liá»‡u sau Ä‘á»ƒ ngÆ°á»i dÃ¹ng lá»±a chá»n:</p>
<ul>
<li><strong><code>noeviction</code></strong> - Khi sá»­ dá»¥ng bá»™ nhá»› Ä‘áº¡t Ä‘áº¿n ngÆ°á»¡ng, táº¥t cáº£ cÃ¡c lá»‡nh yÃªu cáº§u cáº¥p phÃ¡t bá»™ nhá»› sáº½ bÃ¡o lá»—i. ÄÃ¢y lÃ  chiáº¿n lÆ°á»£c máº·c Ä‘á»‹nh cá»§a Redis.</li>
<li><strong><code>allkeys-lru</code></strong> - Trong khÃ´ng gian khÃ³a chÃ­nh, Æ°u tiÃªn xÃ³a khÃ³a khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng gáº§n Ä‘Ã¢y nháº¥t.</li>
<li><strong><code>allkeys-random</code></strong> - Trong khÃ´ng gian khÃ³a chÃ­nh, xÃ³a ngáº«u nhiÃªn má»™t khÃ³a.</li>
<li><strong><code>volatile-lru</code></strong> - Trong khÃ´ng gian khÃ³a cÃ³ thá»i gian háº¿t háº¡n, Æ°u tiÃªn xÃ³a khÃ³a khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng gáº§n Ä‘Ã¢y nháº¥t.</li>
<li><strong><code>volatile-random</code></strong> - Trong khÃ´ng gian khÃ³a cÃ³ thá»i gian háº¿t háº¡n, xÃ³a ngáº«u nhiÃªn má»™t khÃ³a.</li>
<li><strong><code>volatile-ttl</code></strong> - Trong khÃ´ng gian khÃ³a cÃ³ thá»i gian háº¿t háº¡n, Æ°u tiÃªn xÃ³a khÃ³a cÃ³ thá»i gian háº¿t háº¡n sá»›m hÆ¡n.</li>
</ul>
<h3>Lá»±a chá»n chiáº¿n lÆ°á»£c xÃ³a dá»¯ liá»‡u</h3>
<ul>
<li>Náº¿u <strong>dá»¯ liá»‡u phÃ¢n bá»‘ theo phÃ¢n phá»‘i mÅ© (cÃ³ dá»¯ liá»‡u nÃ³ng, má»™t sá»‘ dá»¯ liá»‡u truy cáº­p thÆ°á»ng xuyÃªn, má»™t sá»‘ dá»¯ liá»‡u truy cáº­p Ã­t), hÃ£y sá»­ dá»¥ng <code>allkeys-lru</code></strong>.</li>
<li>Náº¿u <strong>dá»¯ liá»‡u phÃ¢n bá»‘ Ä‘á»“ng Ä‘á»u (táº§n suáº¥t truy cáº­p dá»¯ liá»‡u tÆ°Æ¡ng Ä‘Æ°Æ¡ng), hÃ£y sá»­ dá»¥ng <code>allkeys-random</code></strong>.</li>
<li>Náº¿u muá»‘n <strong>sá»­ dá»¥ng cÃ¡c giÃ¡ trá»‹ TTL khÃ¡c nhau Ä‘á»ƒ gá»£i Ã½ cho Redis nhá»¯ng khÃ³a nÃ o nÃªn bá»‹ xÃ³a, hÃ£y sá»­ dá»¥ng <code>volatile-ttl</code></strong>.</li>
<li><strong><code>volatile-lru</code> vÃ  <code>volatile-random</code> phÃ¹ há»£p cho cÃ¡c tÃ¬nh huá»‘ng vá»«a sá»­ dá»¥ng bá»™ nhá»› cache vá»«a sá»­ dá»¥ng lÆ°u trá»¯ bá»n vá»¯ng</strong>, tuy nhiÃªn, chÃºng ta cÅ©ng cÃ³ thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c cÃ¹ng hiá»‡u quáº£ báº±ng cÃ¡ch sá»­ dá»¥ng hai phiÃªn báº£n Redis.</li>
<li><strong>Äáº·t thá»i gian háº¿t háº¡n cho khÃ³a thá»±c táº¿ sáº½ tiÃªu tá»‘n nhiá»u bá»™ nhá»› hÆ¡n, do Ä‘Ã³, khuyáº¿n nghá»‹ sá»­ dá»¥ng chiáº¿n lÆ°á»£c <code>allkeys-lru</code> Ä‘á»ƒ sá»­ dá»¥ng bá»™ nhá»› hiá»‡u quáº£ hÆ¡n</strong>.</li>
</ul>
<h3>Triá»ƒn khai ná»™i bá»™</h3>
<p>CÃ³ hai cÃ¡ch chÃ­nh Ä‘á»ƒ Redis xÃ³a khÃ³a khÃ´ng há»£p lá»‡:</p>
<ul>
<li>PhÆ°Æ¡ng phÃ¡p tiÃªu cá»±c (passive way), khi khÃ³a Ä‘Æ°á»£c truy cáº­p vÃ  phÃ¡t hiá»‡n ráº±ng nÃ³ khÃ´ng há»£p lá»‡, nÃ³ sáº½ bá»‹ xÃ³a.</li>
<li>PhÆ°Æ¡ng phÃ¡p tÃ­ch cá»±c (active way), Ä‘á»‹nh ká»³ lá»±a chá»n má»™t sá»‘ khÃ³a khÃ´ng há»£p lá»‡ tá»« khÃ´ng gian khÃ³a cÃ³ thá»i gian háº¿t háº¡n vÃ  xÃ³a chÃºng.</li>
<li>XÃ³a tÃ­ch cá»±c: Khi bá»™ nhá»› Ä‘Ã£ sá»­ dá»¥ng vÆ°á»£t quÃ¡ giá»›i háº¡n <code>maxmemory</code>, kÃ­ch hoáº¡t chiáº¿n lÆ°á»£c xÃ³a tÃ­ch cá»±c, chiáº¿n lÆ°á»£c nÃ y Ä‘Æ°á»£c cáº¥u hÃ¬nh báº±ng tham sá»‘ khá»Ÿi Ä‘á»™ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh thá»i gian háº¿t háº¡n chÃ­nh xÃ¡c cá»§a khÃ³a Ä‘Æ°á»£c duy trÃ¬ trong tá»« Ä‘iá»ƒn <code>expires</code>.</li>
</ul>
<h2>4. LÆ°u trá»¯ dá»¯ liá»‡u trong Redis</h2>
<p>Redis lÃ  má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u lÆ°u trá»¯ trong bá»™ nhá»›, Ä‘á»ƒ Ä‘áº£m báº£o dá»¯ liá»‡u khÃ´ng bá»‹ máº¥t sau khi mÃ¡y chá»§ gáº·p sá»± cá»‘, cáº§n lÆ°u trá»¯ dá»¯ liá»‡u tá»« bá»™ nhá»› xuá»‘ng Ä‘Ä©a cá»©ng.</p>
<p>Redis há»— trá»£ hai phÆ°Æ¡ng phÃ¡p lÆ°u trá»¯ dá»¯ liá»‡u: RDB vÃ  AOF.</p>
<ul>
<li><strong>RDB (Redis Database) lÃ  phÆ°Æ¡ng phÃ¡p chá»¥p nhanh, nÃ³ lÆ°u trá»¯ táº¥t cáº£ dá»¯ liá»‡u Redis táº¡i má»™t thá»i Ä‘iá»ƒm cá»¥ thá»ƒ vÃ o má»™t táº­p tin nhá»‹ phÃ¢n Ä‘Æ°á»£c nÃ©n (táº­p tin RDB)</strong>.</li>
<li>AOF (Append Only File) lÃ  má»™t táº­p tin nháº­t kÃ½ vÄƒn báº£n, nÃ³ ghi láº¡i táº¥t cáº£ cÃ¡c lá»‡nh ghi vÃ o cuá»‘i táº­p tin AOF Ä‘á»ƒ ghi láº¡i sá»± thay Ä‘á»•i dá»¯ liá»‡u. Khi mÃ¡y chá»§ khá»Ÿi Ä‘á»™ng láº¡i, nÃ³ sáº½ táº£i vÃ  thá»±c thi cÃ¡c lá»‡nh nÃ y Ä‘á»ƒ khÃ´i phá»¥c dá»¯ liá»‡u gá»‘c. AOF thÃ­ch há»£p Ä‘á»ƒ sá»­ dá»¥ng lÃ m <strong>báº£n sao lÆ°u nÃ³ng</strong>.</li>
</ul>
<p>ğŸ’¡ Äá»ƒ biáº¿t thÃªm thÃ´ng tin chi tiáº¿t vá» cÃ¡c tÃ­nh nÄƒng vÃ  nguyÃªn lÃ½, vui lÃ²ng tham kháº£o: [[Redis Persistence]]</p>
<h2>5. Sá»± kiá»‡n trong Redis</h2>
<p>Redis lÃ  má»™t mÃ¡y chá»§ sá»± kiá»‡n, nÃ³ xá»­ lÃ½ hai loáº¡i sá»± kiá»‡n:</p>
<ul>
<li>
<p><strong>Sá»± kiá»‡n táº­p tin (file event)</strong>&nbsp;- Redis giao tiáº¿p vá»›i khÃ¡ch hÃ ng hoáº·c cÃ¡c mÃ¡y chá»§ khÃ¡c thÃ´ng qua socket, sá»± kiá»‡n táº­p tin lÃ  má»™t trá»«u tÆ°á»£ng hÃ³a cá»§a hoáº¡t Ä‘á»™ng trÃªn socket. Giao tiáº¿p giá»¯a mÃ¡y chá»§ vÃ  khÃ¡ch hÃ ng (hoáº·c cÃ¡c mÃ¡y chá»§ khÃ¡c) táº¡o ra cÃ¡c sá»± kiá»‡n táº­p tin, vÃ  mÃ¡y chá»§ xá»­ lÃ½ vÃ  xá»­ lÃ½ cÃ¡c sá»± kiá»‡n nÃ y báº±ng cÃ¡ch láº¯ng nghe vÃ  xá»­ lÃ½ chÃºng.</p>
</li>
<li>
<p><strong>Sá»± kiá»‡n thá»i gian (time event)</strong>&nbsp;- Redis cáº§n thá»±c hiá»‡n má»™t sá»‘ hoáº¡t Ä‘á»™ng vÃ o má»™t thá»i Ä‘iá»ƒm nháº¥t Ä‘á»‹nh, sá»± kiá»‡n thá»i gian lÃ  má»™t trá»«u tÆ°á»£ng cá»§a cÃ¡c hoáº¡t Ä‘á»™ng Ä‘á»‹nh thá»i nÃ y.</p>
</li>
</ul>
<h3>Sá»± kiá»‡n táº­p tin</h3>
<p>Redis Ä‘Ã£ phÃ¡t triá»ƒn trÃ¬nh xá»­ lÃ½ sá»± kiá»‡n máº¡ng cá»§a riÃªng mÃ¬nh dá»±a trÃªn mÃ´ hÃ¬nh Reactor.</p>
<ul>
<li>TrÃ¬nh xá»­ lÃ½ sá»± kiá»‡n táº­p tin cá»§a Redis sá»­ dá»¥ng trÃ¬nh Ä‘iá»u khiá»ƒn I/O Ä‘a kÃªnh Ä‘á»ƒ láº¯ng nghe Ä‘á»“ng thá»i nhiá»u socket vÃ  liÃªn káº¿t cÃ¡c trÃ¬nh xá»­ lÃ½ sá»± kiá»‡n khÃ¡c nhau vá»›i cÃ¡c socket tÆ°Æ¡ng á»©ng dá»±a trÃªn nhiá»‡m vá»¥ hiá»‡n táº¡i cá»§a socket.</li>
<li>Khi socket Ä‘Æ°á»£c láº¯ng nghe Ä‘Ã£ sáºµn sÃ ng Ä‘á»ƒ thá»±c hiá»‡n káº¿t ná»‘i, Ä‘á»c, ghi hoáº·c Ä‘Ã³ng, sá»± kiá»‡n táº­p tin tÆ°Æ¡ng á»©ng sáº½ xáº£y ra vÃ  trÃ¬nh xá»­ lÃ½ sá»± kiá»‡n táº­p tin sáº½ gá»i trÃ¬nh xá»­ lÃ½ sá»± kiá»‡n Ä‘Ã£ Ä‘Æ°á»£c liÃªn káº¿t trÆ°á»›c Ä‘Ã³ vá»›i socket Ä‘á»ƒ xá»­ lÃ½ cÃ¡c sá»± kiá»‡n nÃ y.</li>
</ul>
<p>Máº·c dÃ¹ trÃ¬nh xá»­ lÃ½ sá»± kiá»‡n táº­p tin cháº¡y dÆ°á»›i dáº¡ng má»™t luá»“ng Ä‘Æ¡n, nhÆ°ng báº±ng cÃ¡ch sá»­ dá»¥ng trÃ¬nh Ä‘iá»u khiá»ƒn I/O Ä‘a kÃªnh Ä‘á»ƒ láº¯ng nghe nhiá»u socket, trÃ¬nh xá»­ lÃ½ sá»± kiá»‡n táº­p tin Ä‘Ã£ triá»ƒn khai mÃ´ hÃ¬nh giao tiáº¿p máº¡ng hiá»‡u suáº¥t cao.</p>
<p>TrÃ¬nh xá»­ lÃ½ sá»± kiá»‡n táº­p tin bao gá»“m bá»‘n thÃ nh pháº§n: socket, trÃ¬nh Ä‘iá»u khiá»ƒn I/O Ä‘a kÃªnh (I/O Multiplexing), bá»™ phÃ¢n phá»‘i sá»± kiá»‡n táº­p tin vÃ  trÃ¬nh xá»­ lÃ½ sá»± kiá»‡n.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230724111451.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure>
<h3>Sá»± kiá»‡n thá»i gian</h3>
<p>Sá»± kiá»‡n thá»i gian Ä‘Æ°á»£c chia thÃ nh hai loáº¡i:</p>
<ul>
<li><strong>Sá»± kiá»‡n Ä‘á»‹nh thá»i</strong>: lÃ  viá»‡c cho phÃ©p má»™t Ä‘oáº¡n chÆ°Æ¡ng trÃ¬nh Ä‘Æ°á»£c thá»±c thi má»™t láº§n trong khoáº£ng thá»i gian Ä‘Ã£ chá»‰ Ä‘á»‹nh;</li>
<li><strong>Sá»± kiá»‡n Ä‘á»‹nh ká»³</strong>: lÃ  sá»± kiá»‡n cho phÃ©p má»™t Ä‘oáº¡n chÆ°Æ¡ng trÃ¬nh thá»±c thi má»—i khoáº£ng thá»i gian cá»¥ thá»ƒ.</li>
</ul>
<p>Redis lÆ°u trá»¯ táº¥t cáº£ cÃ¡c sá»± kiá»‡n thá»i gian trong má»™t danh sÃ¡ch liÃªn káº¿t khÃ´ng tuáº§n tá»±. Khi trÃ¬nh thá»±c thi sá»± kiá»‡n thá»i gian cháº¡y, nÃ³ sáº½ duyá»‡t qua toÃ n bá»™ danh sÃ¡ch liÃªn káº¿t Ä‘á»ƒ tÃ¬m cÃ¡c sá»± kiá»‡n thá»i gian Ä‘Ã£ Ä‘áº¿n vÃ  gá»i trÃ¬nh xá»­ lÃ½ sá»± kiá»‡n tÆ°Æ¡ng á»©ng.</p>
<h3>Láº­p lá»‹ch vÃ  thá»±c thi sá»± kiá»‡n</h3>
<p>Äá»ƒ nháº­n Ä‘Æ°á»£c cÃ¡c sá»± kiá»‡n táº­p tin chá» xá»­ lÃ½, mÃ¡y chá»§ cáº§n láº¯ng nghe liÃªn tá»¥c cÃ¡c socket, nhÆ°ng khÃ´ng thá»ƒ láº¯ng nghe mÃ£i mÃ£i, náº¿u khÃ´ng sá»± kiá»‡n thá»i gian sáº½ khÃ´ng thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n trong thá»i gian quy Ä‘á»‹nh. Do Ä‘Ã³, thá»i gian láº¯ng nghe pháº£i Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh dá»±a trÃªn sá»± kiá»‡n thá»i gian gáº§n nháº¥t.</p>
<p>Láº­p lá»‹ch vÃ  thá»±c thi sá»± kiá»‡n Ä‘Æ°á»£c thá»±c hiá»‡n bá»Ÿi hÃ m aeProcessEvents, mÃ£ giáº£ nhÆ° sau:</p>
<div class="language-python line-numbers-mode" data-ext="python" data-title="python"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">def</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> aeProcessEvents</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">():</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">    ## TÃ¬m sá»± kiá»‡n thá»i gian gáº§n nháº¥t Ä‘Ã£ Ä‘áº¿n</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    time_event </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> aeSearchNearestTimer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">    ## TÃ­nh toÃ¡n thá»i gian cÃ²n láº¡i Ä‘áº¿n sá»± kiá»‡n thá»i gian gáº§n nháº¥t</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    remaind_ms </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> time_event.when </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> unix_ts_now</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">    ## Náº¿u sá»± kiá»‡n Ä‘Ã£ Ä‘áº¿n, giÃ¡ trá»‹ remaind_ms cÃ³ thá»ƒ lÃ  sá»‘ Ã¢m, Ä‘áº·t nÃ³ thÃ nh 0</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> remaind_ms </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&lt;</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        remaind_ms </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">    ## Táº¡o timeval dá»±a trÃªn remaind_ms</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    timeval </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> create_timeval_with_ms</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(remaind_ms)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">    ## Chá» vÃ  cháº·n Ä‘á»ƒ chá» sá»± kiá»‡n táº­p tin xáº£y ra, thá»i gian cháº·n tá»‘i Ä‘a Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh bá»Ÿi timeval Ä‘Æ°á»£c truyá»n vÃ o</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    aeApiPoll</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(timeval)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">    ## Xá»­ lÃ½ táº¥t cáº£ cÃ¡c sá»± kiá»‡n táº­p tin Ä‘Ã£ xáº£y ra</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    processFileEvents</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">    ## Xá»­ lÃ½ táº¥t cáº£ cÃ¡c sá»± kiá»‡n thá»i gian Ä‘Ã£ Ä‘áº¿n</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    processTimeEvents</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">()</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Äáº·t hÃ m aeProcessEvents trong má»™t vÃ²ng láº·p, kÃ¨m theo cÃ¡c hÃ m khá»Ÿi táº¡o vÃ  dá»n dáº¹p, sáº½ táº¡o thÃ nh hÃ m chÃ­nh cá»§a mÃ¡y chá»§ Redis, mÃ£ giáº£ nhÆ° sau:</p>
<div class="language-python" data-ext="python" data-title="python"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">def</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> main</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">():</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">    ## Khá»Ÿi táº¡o mÃ¡y chá»§</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    init_server</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">    ## Xá»­ lÃ½ sá»± kiá»‡n liÃªn tá»¥c cho Ä‘áº¿n khi mÃ¡y chá»§ táº¯t</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    while</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> server_is_not_shutdown</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">():</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        aeProcessEvents</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">    ## MÃ¡y chá»§ táº¯t, thá»±c hiá»‡n dá»n dáº¹p</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">    clean_server</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">()</span></span></code></pre>
</div><h2>6. Giao dá»‹ch trong Redis</h2>
<blockquote>
<p><strong>Redis khÃ´ng cung cáº¥p giao dá»‹ch nghiÃªm ngáº·t, Redis chá»‰ Ä‘áº£m báº£o thá»±c hiá»‡n cÃ¡c lá»‡nh theo thá»© tá»± vÃ  Ä‘áº£m báº£o thá»±c hiá»‡n táº¥t cáº£ cÃ¡c lá»‡nh, nhÆ°ng khi má»™t lá»‡nh thá»±c hiá»‡n khÃ´ng thÃ nh cÃ´ng, nÃ³ sáº½ tiáº¿p tá»¥c thá»±c hiá»‡n cÃ¡c lá»‡nh tiáº¿p theo mÃ  khÃ´ng cÃ³ quÃ¡ trÃ¬nh rollback</strong>.</p>
</blockquote>
<p><code>MULTI</code>, <code>EXEC</code>, <code>DISCARD</code> vÃ  <code>WATCH</code> lÃ  cÃ¡c lá»‡nh liÃªn quan Ä‘áº¿n giao dá»‹ch trong Redis.</p>
<p>Giao dá»‹ch cho phÃ©p thá»±c hiá»‡n nhiá»u lá»‡nh cÃ¹ng má»™t lÃºc vÃ  cÃ³ hai cam káº¿t quan trá»ng sau:</p>
<ul>
<li>Giao dá»‹ch lÃ  má»™t hoáº¡t Ä‘á»™ng cÃ´ láº­p Ä‘á»™c láº­p: Táº¥t cáº£ cÃ¡c lá»‡nh trong giao dá»‹ch sáº½ Ä‘Æ°á»£c thá»±c hiá»‡n theo thá»© tá»± vÃ  tuáº§n tá»±. Trong quÃ¡ trÃ¬nh thá»±c hiá»‡n giao dá»‹ch, nÃ³ sáº½ khÃ´ng bá»‹ giÃ¡n Ä‘oáº¡n bá»Ÿi cÃ¡c yÃªu cáº§u lá»‡nh tá»« khÃ¡ch hÃ ng khÃ¡c.</li>
<li>Giao dá»‹ch lÃ  má»™t hoáº¡t Ä‘á»™ng nguyÃªn tá»­: Táº¥t cáº£ cÃ¡c lá»‡nh trong giao dá»‹ch sáº½ Ä‘Æ°á»£c thá»±c hiá»‡n hoáº·c khÃ´ng Ä‘Æ°á»£c thá»±c hiá»‡n.</li>
</ul>
<h3>MULTI</h3>
<p><strong>Lá»‡nh <a href="https://redis.io/commands/multi" target="_blank" rel="noopener noreferrer"><code>MULTI</code></a> Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ báº¯t Ä‘áº§u má»™t giao dá»‹ch, nÃ³ luÃ´n tráº£ vá» OK.</strong></p>
<p>Sau khi thá»±c hiá»‡n <code>MULTI</code>, khÃ¡ch hÃ ng cÃ³ thá»ƒ tiáº¿p tá»¥c gá»­i báº¥t ká»³ sá»‘ lÆ°á»£ng lá»‡nh nÃ o Ä‘áº¿n mÃ¡y chá»§, cÃ¡c lá»‡nh nÃ y sáº½ khÃ´ng Ä‘Æ°á»£c thá»±c hiá»‡n ngay láº­p tá»©c mÃ  sáº½ Ä‘Æ°á»£c Ä‘áº·t vÃ o má»™t hÃ ng Ä‘á»£i. Khi lá»‡nh <code>EXEC</code> Ä‘Æ°á»£c gá»i, táº¥t cáº£ cÃ¡c lá»‡nh trong hÃ ng Ä‘á»£i sáº½ Ä‘Æ°á»£c thá»±c hiá»‡n.</p>
<p>DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ vá» giao dá»‹ch, nÃ³ tÄƒng giÃ¡ trá»‹ cá»§a hai khÃ³a <code>foo</code> vÃ  <code>bar</code> má»™t cÃ¡ch nguyÃªn tá»­:</p>
<div class="language-python" data-ext="python" data-title="python"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#D19A66;--shiki-dark:#D19A66"> MULTI</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66">OK</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#D19A66;--shiki-dark:#D19A66"> INCR</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> foo</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66">QUEUED</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#D19A66;--shiki-dark:#D19A66"> INCR</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> bar</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66">QUEUED</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#D19A66;--shiki-dark:#D19A66"> EXEC</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) (integer) </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) (integer) </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span></span></code></pre>
</div><h3>EXEC</h3>
<p><strong>Lá»‡nh <a href="https://redis.io/commands/exec" target="_blank" rel="noopener noreferrer"><code>EXEC</code></a> Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ kÃ­ch hoáº¡t vÃ  thá»±c hiá»‡n táº¥t cáº£ cÃ¡c lá»‡nh trong giao dá»‹ch.</strong></p>
<ul>
<li>Náº¿u khÃ¡ch hÃ ng má»Ÿ má»™t giao dá»‹ch báº±ng cÃ¡ch sá»­ dá»¥ng <code>MULTI</code> nhÆ°ng khÃ´ng thá»±c hiá»‡n thÃ nh cÃ´ng <code>EXEC</code>, táº¥t cáº£ cÃ¡c lá»‡nh trong giao dá»‹ch sáº½ khÃ´ng Ä‘Æ°á»£c thá»±c hiá»‡n.</li>
<li>TrÃªn má»™t khÃ­a cáº¡nh khÃ¡c, náº¿u khÃ¡ch hÃ ng thá»±c hiá»‡n thÃ nh cÃ´ng <code>EXEC</code> sau khi má»Ÿ giao dá»‹ch, táº¥t cáº£ cÃ¡c lá»‡nh trong giao dá»‹ch sáº½ Ä‘Æ°á»£c thá»±c hiá»‡n.</li>
</ul>
<h3>DISCARD</h3>
<p><strong>Khi thá»±c hiá»‡n lá»‡nh <a href="https://redis.io/commands/discard" target="_blank" rel="noopener noreferrer"><code>DISCARD</code></a>, giao dá»‹ch sáº½ bá»‹ há»§y bá», hÃ ng Ä‘á»£i giao dá»‹ch sáº½ Ä‘Æ°á»£c xÃ³a vÃ  khÃ¡ch hÃ ng sáº½ thoÃ¡t khá»i tráº¡ng thÃ¡i giao dá»‹ch.</strong></p>
<p>VÃ­ dá»¥:</p>
<div class="language-python" data-ext="python" data-title="python"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#D19A66;--shiki-dark:#D19A66"> SET</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> foo </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66">OK</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#D19A66;--shiki-dark:#D19A66"> MULTI</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66">OK</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#D19A66;--shiki-dark:#D19A66"> INCR</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> foo</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66">QUEUED</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#D19A66;--shiki-dark:#D19A66"> DISCARD</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66">OK</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#D19A66;--shiki-dark:#D19A66"> GET</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> foo</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379">"1"</span></span></code></pre>
</div><h3>WATCH</h3>
<p><strong>Lá»‡nh <a href="https://redis.io/commands/watch" target="_blank" rel="noopener noreferrer"><code>WATCH</code></a> trong Redis cung cáº¥p hÃ nh vi check-and-set (CAS) cho giao dá»‹ch.</strong></p>
<p>CÃ¡c khÃ³a Ä‘Æ°á»£c theo dÃµi bá»Ÿi WATCH sáº½ Ä‘Æ°á»£c giÃ¡m sÃ¡t vÃ  phÃ¡t hiá»‡n xem chÃºng cÃ³ bá»‹ thay Ä‘á»•i khÃ´ng. Náº¿u Ã­t nháº¥t má»™t khÃ³a Ä‘Æ°á»£c theo dÃµi Ä‘Ã£ Ä‘Æ°á»£c thay Ä‘á»•i trÆ°á»›c khi EXEC Ä‘Æ°á»£c thá»±c thi, toÃ n bá»™ giao dá»‹ch sáº½ bá»‹ há»§y bá» vÃ  EXEC sáº½ tráº£ vá» nil-reply Ä‘á»ƒ chá»‰ ra giao dá»‹ch Ä‘Ã£ tháº¥t báº¡i.</p>
<div class="language-python" data-ext="python" data-title="python"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66">WATCH</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> mykey</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">val </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> GET</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> mykey</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">val </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> val </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">+</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66">MULTI</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66">SET</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> mykey </span><span style="color:#FFFFFF;--shiki-dark:#FFFFFF">$</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">val</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66">EXEC</span></span></code></pre>
</div><p>Sá»­ dá»¥ng mÃ£ trÃªn, náº¿u giÃ¡ trá»‹ cá»§a mykey Ä‘Æ°á»£c thay Ä‘á»•i bá»Ÿi má»™t khÃ¡ch hÃ ng khÃ¡c sau khi WATCH Ä‘Æ°á»£c thá»±c thi vÃ  trÆ°á»›c khi EXEC Ä‘Æ°á»£c thá»±c thi, giao dá»‹ch cá»§a khÃ¡ch hÃ ng hiá»‡n táº¡i sáº½ tháº¥t báº¡i. ChÆ°Æ¡ng trÃ¬nh cáº§n lÃ m lÃ  láº·p láº¡i thao tÃ¡c nÃ y cho Ä‘áº¿n khi khÃ´ng cÃ³ xung Ä‘á»™t xáº£y ra.</p>
<p>HÃ¬nh thá»©c khÃ³a nÃ y Ä‘Æ°á»£c gá»i lÃ  khÃ³a láº¡c quan (optimistic lock), Ä‘Ã¢y lÃ  má»™t cÆ¡ cháº¿ khÃ³a ráº¥t máº¡nh máº½. VÃ  vÃ¬ háº§u háº¿t cÃ¡c khÃ¡ch hÃ ng thÆ°á»ng truy cáº­p vÃ o cÃ¡c khÃ³a khÃ¡c nhau, xung Ä‘á»™t xáº£y ra ráº¥t Ã­t, nÃªn thÆ°á»ng khÃ´ng cáº§n pháº£i thá»­ láº¡i.</p>
<p>WATCH yÃªu cáº§u EXEC chá»‰ Ä‘Æ°á»£c thá»±c thi khi táº¥t cáº£ cÃ¡c khÃ³a Ä‘Æ°á»£c giÃ¡m sÃ¡t khÃ´ng bá»‹ thay Ä‘á»•i. Náº¿u Ä‘iá»u kiá»‡n nÃ y khÃ´ng Ä‘Æ°á»£c Ä‘Ã¡p á»©ng, giao dá»‹ch sáº½ khÃ´ng Ä‘Æ°á»£c thá»±c thi.</p>
<p>Lá»‡nh WATCH cÃ³ thá»ƒ Ä‘Æ°á»£c gá»i nhiá»u láº§n. GiÃ¡m sÃ¡t cÃ¡c khÃ³a báº¯t Ä‘áº§u cÃ³ hiá»‡u lá»±c sau khi WATCH Ä‘Æ°á»£c thá»±c thi vÃ  káº¿t thÃºc khi EXEC Ä‘Æ°á»£c gá»i.</p>
<p>NgÆ°á»i dÃ¹ng cÅ©ng cÃ³ thá»ƒ giÃ¡m sÃ¡t nhiá»u khÃ³a trong má»™t lá»‡nh WATCH, vÃ­ dá»¥:</p>
<div class="language-python" data-ext="python" data-title="python"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">redis</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#D19A66;--shiki-dark:#D19A66"> WATCH</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> key1 key2 key3</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66">OK</span></span></code></pre>
</div><h4>CÃ¡c tÃ¬nh huá»‘ng há»§y WATCH</h4>
<p>Khi EXEC Ä‘Æ°á»£c gá»i, giÃ¡m sÃ¡t cho táº¥t cáº£ cÃ¡c khÃ³a sáº½ bá»‹ há»§y bá», báº¥t ká»ƒ giao dá»‹ch cÃ³ Ä‘Æ°á»£c thá»±c thi thÃ nh cÃ´ng hay khÃ´ng.</p>
<p>NgoÃ i ra, khi khÃ¡ch hÃ ng ngáº¯t káº¿t ná»‘i, giÃ¡m sÃ¡t cá»§a khÃ¡ch hÃ ng Ä‘á»‘i vá»›i cÃ¡c khÃ³a cÅ©ng sáº½ bá»‹ há»§y bá».</p>
<p>Sá»­ dá»¥ng lá»‡nh UNWATCH khÃ´ng cÃ³ tham sá»‘ cÃ³ thá»ƒ há»§y bá» giÃ¡m sÃ¡t cho táº¥t cáº£ cÃ¡c khÃ³a. Äá»‘i vá»›i má»™t sá»‘ giao dá»‹ch yÃªu cáº§u thay Ä‘á»•i nhiá»u khÃ³a, Ä‘Ã´i khi chÆ°Æ¡ng trÃ¬nh cáº§n khÃ³a Ä‘á»“ng thá»i nhiá»u khÃ³a vÃ  kiá»ƒm tra xem giÃ¡ trá»‹ hiá»‡n táº¡i cá»§a cÃ¡c khÃ³a Ä‘Ã³ cÃ³ Ä‘Ã¡p á»©ng yÃªu cáº§u cá»§a chÆ°Æ¡ng trÃ¬nh hay khÃ´ng. Khi giÃ¡ trá»‹ khÃ´ng Ä‘Ã¡p á»©ng yÃªu cáº§u, cÃ³ thá»ƒ sá»­ dá»¥ng lá»‡nh UNWATCH Ä‘á»ƒ há»§y bá» giÃ¡m sÃ¡t hiá»‡n táº¡i, tá»« bá» giao dá»‹ch nÃ y vÃ  chá» Ä‘á»£i láº§n thá»­ giao dá»‹ch tiáº¿p theo.</p>
<h4>Sá»­ dá»¥ng WATCH Ä‘á»ƒ táº¡o thao tÃ¡c nguyÃªn tá»­</h4>
<p>WATCH cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ táº¡o ra cÃ¡c thao tÃ¡c nguyÃªn tá»­ khÃ´ng Ä‘Æ°á»£c tÃ­ch há»£p sáºµn trong Redis.</p>
<p>VÃ­ dá»¥, Ä‘oáº¡n mÃ£ sau triá»ƒn khai lá»‡nh ZPOP tá»± táº¡o, nÃ³ cÃ³ thá»ƒ láº¥y ra pháº§n tá»­ cÃ³ Ä‘iá»ƒm sá»‘ nhá» nháº¥t trong táº­p há»£p cÃ³ thá»© tá»±:</p>
<div class="language-python" data-ext="python" data-title="python"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66">WATCH</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> zset</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">element </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> ZRANGE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> zset </span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 0</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66">MULTI</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66">ZREM</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> zset element</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66">EXEC</span></span></code></pre>
</div><h3>Rollback</h3>
<p><strong>Redis khÃ´ng há»— trá»£ rollback</strong>. LÃ½ do Redis khÃ´ng há»— trá»£ rollback:</p>
<ul>
<li>Lá»‡nh Redis chá»‰ tháº¥t báº¡i do cÃº phÃ¡p sai hoáº·c lá»‡nh Ä‘Æ°á»£c sá»­ dá»¥ng trÃªn loáº¡i khÃ³a sai.</li>
<li>VÃ¬ khÃ´ng cáº§n há»— trá»£ rollback, nÃªn Redis cÃ³ thá»ƒ giá»¯ cho ná»™i bá»™ Ä‘Æ¡n giáº£n vÃ  nhanh chÃ³ng.</li>
</ul>
<h2>7. Redis Pipeline</h2>
<p>Redis lÃ  má»™t dá»‹ch vá»¥ TCP dá»±a trÃªn mÃ´ hÃ¬nh C/S vÃ  giao thá»©c yÃªu cáº§u/pháº£n há»“i. Redis há»— trá»£ cÃ´ng nghá»‡ Pipeline. CÃ´ng nghá»‡ Pipeline cho phÃ©p gá»­i yÃªu cáº§u theo cÃ¡ch báº¥t Ä‘á»“ng bá»™, tá»©c lÃ  cho phÃ©p gá»­i yÃªu cáº§u má»›i trong khi Ä‘Ã¡p á»©ng cá»§a yÃªu cáº§u cÅ© váº«n chÆ°a tráº£ vá». PhÆ°Æ¡ng phÃ¡p nÃ y cÃ³ thá»ƒ cáº£i thiá»‡n Ä‘Ã¡ng ká»ƒ hiá»‡u suáº¥t truyá»n táº£i.</p>
<p>Khi cáº§n thá»±c thi má»™t loáº¡t lá»‡nh Redis, náº¿u thá»±c thi tá»«ng lá»‡nh má»™t, rÃµ rÃ ng lÃ  ráº¥t khÃ´ng hiá»‡u quáº£. Äá»ƒ giáº£m sá»‘ láº§n truyá»n thÃ´ng vÃ  giáº£m Ä‘á»™ trá»…, cÃ³ thá»ƒ sá»­ dá»¥ng chá»©c nÄƒng Pipeline cá»§a Redis. Chá»©c nÄƒng Pipeline cá»§a Redis khÃ´ng cung cáº¥p há»— trá»£ dÃ²ng lá»‡nh, nhÆ°ng nÃ³ Ä‘Æ°á»£c triá»ƒn khai trong cÃ¡c phiÃªn báº£n khÃ¡ch hÃ ng cá»§a nhiá»u ngÃ´n ngá»¯.</p>
<p>Láº¥y vÃ­ dá»¥ vá»›i Jedis:</p>
<div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">Pipeline</span><span style="color:#E06C75;--shiki-dark:#E06C75"> pipe </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#E5C07B;--shiki-dark:#E5C07B"> conn</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">pipelined</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">pipe</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">multi</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">pipe</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">hset</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#98C379;--shiki-dark:#98C379">"login:"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, token, user);</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">pipe</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">zadd</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#98C379;--shiki-dark:#98C379">"recent:"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, timestamp, token);</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">if</span><span style="color:#E06C75;--shiki-dark:#E06C75"> (item </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">!=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> null</span><span style="color:#E06C75;--shiki-dark:#E06C75">) {</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">    pipe</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">zadd</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#98C379;--shiki-dark:#98C379">"viewed:"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> +</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> token, timestamp, item);</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">    pipe</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">zremrangeByRank</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#98C379;--shiki-dark:#98C379">"viewed:"</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> +</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> token, </span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#D19A66;--shiki-dark:#D19A66">26</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">    pipe</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">zincrby</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#98C379;--shiki-dark:#98C379">"viewed:"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, item);</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">}</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">pipe</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">exec</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">();</span></span></code></pre>
</div><blockquote>
<p>ğŸ”” LÆ°u Ã½: Khi gá»­i cÃ¡c lá»‡nh báº±ng Pipeline, Redis Server sáº½ Ä‘áº·t má»™t sá»‘ yÃªu cáº§u vÃ o hÃ ng Ä‘á»£i bá»™ nhá»› cache (chiáº¿m bá»™ nhá»›), vÃ  sau khi thá»±c thi xong, gá»­i káº¿t quáº£ má»™t láº§n duy nháº¥t. Náº¿u cáº§n gá»­i má»™t sá»‘ lÆ°á»£ng lá»›n lá»‡nh, sáº½ chiáº¿m nhiá»u bá»™ nhá»›, do Ä‘Ã³ nÃªn xá»­ lÃ½ theo sá»‘ lÆ°á»£ng há»£p lÃ½ vÃ  chia thÃ nh cÃ¡c lÃ´ Ä‘á»ƒ xá»­ lÃ½.</p>
</blockquote>
<h2>8. Redis Publish/Subscribe</h2>
<p>Redis cung cáº¥p 5 lá»‡nh Publish/Subscribe:</p>
<p>| Lá»‡nh           | MÃ´ táº£                                                                |<br>
|</p>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230724111451.png" type="image/png"/>
    </item>
    <item>
      <title>Redis Interview</title>
      <link>https://vanhung4499.github.io/database/redis/interview.html</link>
      <guid>https://vanhung4499.github.io/database/redis/interview.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Redis Interview</source>
      <description>Redis Interview Giá»›i thiá»‡u vá» Redis Redis lÃ  gÃ¬ ã€CÃ¢u há»iã€‘ Redis lÃ  gÃ¬? Redis cÃ³ nhá»¯ng tÃ­nh nÄƒng vÃ  Ä‘áº·c Ä‘iá»ƒm gÃ¬? ã€Tráº£ lá»iã€‘ Redis lÃ  gÃ¬: Redis lÃ  má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u &amp;quot;in-memory&amp;quot; mÃ£ ...</description>
      <category>redis</category>
      <category>interview</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>Giá»›i thiá»‡u vá» Redis</h2>
<h3>Redis lÃ  gÃ¬</h3>
<p>ã€CÃ¢u há»iã€‘</p>
<ul>
<li>Redis lÃ  gÃ¬?</li>
<li>Redis cÃ³ nhá»¯ng tÃ­nh nÄƒng vÃ  Ä‘áº·c Ä‘iá»ƒm gÃ¬?</li>
</ul>
<p>ã€Tráº£ lá»iã€‘</p>
<p>Redis lÃ  gÃ¬:</p>
<p><strong>Redis lÃ  má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u "in-memory" mÃ£ nguá»“n má»Ÿ</strong>. VÃ¬ Redis triá»ƒn khai cÃ¡c thao tÃ¡c Ä‘á»c ghi hoÃ n toÃ n trong bá»™ nhá»›, do Ä‘Ã³, <strong>tá»‘c Ä‘á»™ Ä‘á»c ghi cá»§a nÃ³ ráº¥t nhanh</strong>.</p>
<ul>
<li><strong>Hiá»‡u suáº¥t cao</strong> - Do cÃ¡c thao tÃ¡c Ä‘á»c ghi cá»§a Redis Ä‘á»u triá»ƒn khai trong bá»™ nhá»›, nÃªn hiá»‡u suáº¥t ráº¥t cao.</li>
<li><strong>Kháº£ nÄƒng xá»­ lÃ½ song song cao</strong> - Redis Ä‘Æ¡n láº» cÃ³ thá»ƒ Ä‘áº¡t QPS (sá»‘ yÃªu cáº§u má»—i giÃ¢y) lÃªn Ä‘áº¿n 10.0000+, gáº§n gáº¥p 10 láº§n so vá»›i MySQL.</li>
</ul>
<p>Redis thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng trong cÃ¡c trÆ°á»ng há»£p nhÆ° <strong>bá»™ nhá»› Ä‘á»‡m, hÃ ng Ä‘á»£i tin nháº¯n, khÃ³a phÃ¢n tÃ¡n, v.v.</strong>.</p>
<p>TÃ­nh nÄƒng vÃ  Ä‘áº·c Ä‘iá»ƒm cá»§a Redis:</p>
<ul>
<li><strong>Redis há»— trá»£ nhiá»u kiá»ƒu dá»¯ liá»‡u</strong>. NhÆ°: String (chuá»—i), Hash (bÄƒm), List (danh sÃ¡ch), Set (táº­p há»£p), Zset (táº­p há»£p cÃ³ thá»© tá»±), Bitmaps (báº£n Ä‘á»“ bit), HyperLogLog (thá»‘ng kÃª cardinal), GEO (khÃ´ng gian Ä‘á»‹a lÃ½), Stream (dÃ²ng).</li>
<li><strong>Redis sá»­ dá»¥ng mÃ´ hÃ¬nh "Ä‘Æ¡n luá»“ng" Ä‘á»ƒ Ä‘á»c ghi</strong>, do Ä‘Ã³, cÃ¡c thao tÃ¡c cá»§a nÃ³ cÃ³ tÃ­nh <strong>nguyÃªn tá»­</strong>.</li>
<li>Redis há»— trá»£ hai chiáº¿n lÆ°á»£c lÆ°u trá»¯: RDB vÃ  AOF.</li>
<li>Redis cÃ³ nhiá»u giáº£i phÃ¡p kháº£ dá»¥ng cao: cháº¿ Ä‘á»™ <strong>sao chÃ©p Master-Slave</strong>, cháº¿ Ä‘á»™ <strong>sentinel</strong>, cháº¿ Ä‘á»™ <strong>cá»¥m</strong>.</li>
<li>Redis há»— trá»£ nhiá»u tÃ­nh nÄƒng phong phÃº nhÆ°: <strong>giao dá»‹ch</strong>, <strong>ká»‹ch báº£n Lua</strong>, <strong>xuáº¥t báº£n/Ä‘Äƒng kÃ½</strong>, <strong>xÃ³a dá»¯ liá»‡u háº¿t háº¡n</strong>, <strong>loáº¡i bá» bá»™ nhá»›</strong>, v.v.</li>
</ul>
<h3>CÃ¡c trÆ°á»ng há»£p á»©ng dá»¥ng cá»§a Redis</h3>
<p>ã€CÃ¢u há»iã€‘</p>
<ul>
<li>Redis cÃ³ nhá»¯ng trÆ°á»ng há»£p á»©ng dá»¥ng nÃ o?</li>
</ul>
<p>ã€Tráº£ lá»iã€‘</p>
<ul>
<li><strong>Bá»™ nhá»› Ä‘á»‡m</strong> - Äáº·t dá»¯ liá»‡u nÃ³ng vÃ o bá»™ nhá»›, thiáº¿t láº­p giá»›i háº¡n sá»­ dá»¥ng bá»™ nhá»› tá»‘i Ä‘a vÃ  chiáº¿n lÆ°á»£c loáº¡i bá» háº¿t háº¡n Ä‘á»ƒ Ä‘áº£m báº£o tá»· lá»‡ truy xuáº¥t bá»™ nhá»› Ä‘á»‡m.</li>
<li><strong>Bá»™ Ä‘áº¿m</strong> - Redis lÃ  cÆ¡ sá»Ÿ dá»¯ liá»‡u trong bá»™ nhá»› cÃ³ thá»ƒ há»— trá»£ cÃ¡c thao tÃ¡c Ä‘á»c ghi thÆ°á»ng xuyÃªn cá»§a bá»™ Ä‘áº¿m.</li>
<li><strong>Giá»›i háº¡n truy cáº­p á»©ng dá»¥ng</strong> - Giá»›i háº¡n lÆ°u lÆ°á»£ng truy cáº­p vÃ o má»™t trang web.</li>
<li><strong>HÃ ng Ä‘á»£i tin nháº¯n</strong> - Sá»­ dá»¥ng kiá»ƒu dá»¯ liá»‡u List, lÃ  má»™t danh sÃ¡ch liÃªn káº¿t hai chiá»u.</li>
<li><strong>Báº£ng tra cá»©u</strong> - Sá»­ dá»¥ng kiá»ƒu dá»¯ liá»‡u HASH.</li>
<li><strong>TÃ­nh toÃ¡n táº­p há»£p</strong> - Sá»­ dá»¥ng kiá»ƒu dá»¯ liá»‡u SET, vÃ­ dá»¥ nhÆ° Ä‘á»ƒ tÃ¬m báº¡n chung cá»§a hai ngÆ°á»i dÃ¹ng.</li>
<li><strong>Báº£ng xáº¿p háº¡ng</strong> - Sá»­ dá»¥ng kiá»ƒu dá»¯ liá»‡u ZSET.</li>
<li><strong>Session phÃ¢n tÃ¡n</strong> - Session cá»§a nhiá»u mÃ¡y chá»§ á»©ng dá»¥ng Ä‘á»u Ä‘Æ°á»£c lÆ°u trá»¯ trong Redis Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh nháº¥t quÃ¡n cá»§a Session.</li>
<li><strong>KhÃ³a phÃ¢n tÃ¡n</strong> - NgoÃ i viá»‡c sá»­ dá»¥ng SETNX Ä‘á»ƒ triá»ƒn khai khÃ³a phÃ¢n tÃ¡n, báº¡n cÃ²n cÃ³ thá»ƒ sá»­ dá»¥ng RedLock - khÃ³a phÃ¢n tÃ¡n chÃ­nh thá»©c do Redis cung cáº¥p.</li>
</ul>
<h3>Redis vs. Memcached</h3>
<p>ã€CÃ¢u há»iã€‘</p>
<ul>
<li>Redis vÃ  Memcached cÃ³ nhá»¯ng Ä‘iá»ƒm giá»‘ng nhau nÃ o?</li>
<li>Redis vÃ  Memcached cÃ³ nhá»¯ng khÃ¡c biá»‡t nÃ o?</li>
<li>Khi lá»±a chá»n cÃ´ng nghá»‡ bá»™ nhá»› Ä‘á»‡m phÃ¢n tÃ¡n, nÃªn chá»n Redis hay Memcached, táº¡i sao?</li>
</ul>
<p>ã€Tráº£ lá»iã€‘</p>
<p><strong>Äiá»ƒm giá»‘ng nhau giá»¯a Redis vÃ  Memcached</strong>:</p>
<ol>
<li>Cáº£ hai Ä‘á»u lÃ  cÆ¡ sá»Ÿ dá»¯ liá»‡u trong bá»™ nhá»›, do Ä‘Ã³ hiá»‡u suáº¥t Ä‘á»u ráº¥t cao.</li>
<li>Cáº£ hai Ä‘á»u cÃ³ chiáº¿n lÆ°á»£c háº¿t háº¡n.</li>
</ol>
<p>VÃ¬ hai Ä‘iá»ƒm trÃªn, chÃºng thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng lÃ m bá»™ nhá»› Ä‘á»‡m.</p>
<p><strong>Äiá»ƒm khÃ¡c nhau giá»¯a Redis vÃ  Memcached</strong>:</p>
<p>|                 | Redis                                                                             | Memcached                                                                                                                                                                                                                                                  |<br>
|</p>
]]></content:encoded>
      <enclosure url="https://redis.io/docs/management/optimization/benchmarks/Connections_chart.png" type="image/png"/>
    </item>
    <item>
      <title>Redis Operations</title>
      <link>https://vanhung4499.github.io/database/redis/operations.html</link>
      <guid>https://vanhung4499.github.io/database/redis/operations.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Redis Operations</source>
      <description>Quáº£n trá»‹ Redis Redis lÃ  má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u key-value cÃ³ hiá»‡u suáº¥t cao. Thao tÃ¡c SET cÃ³ thá»ƒ Ä‘áº¡t tá»›i 110.000 láº§n má»—i giÃ¢y; thao tÃ¡c GET cÃ³ thá»ƒ Ä‘áº¡t tá»›i 81.000 láº§n má»—i giÃ¢y. 1. CÃ i Ä‘...</description>
      <category>redis</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p><strong>Redis</strong> lÃ  má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u key-value cÃ³ hiá»‡u suáº¥t cao.</p>
<p>Thao tÃ¡c SET cÃ³ thá»ƒ Ä‘áº¡t tá»›i 110.000 láº§n má»—i giÃ¢y; thao tÃ¡c GET cÃ³ thá»ƒ Ä‘áº¡t tá»›i 81.000 láº§n má»—i giÃ¢y.</p>
</blockquote>
<h2>1. CÃ i Ä‘áº·t Redis</h2>
<h3>CÃ i Ä‘áº·t trÃªn Windows</h3>
<p><strong>ÄÆ°á»ng dáº«n táº£i vá»:</strong> <a href="https://github.com/MSOpenTech/redis/releases" target="_blank" rel="noopener noreferrer">https://github.com/MSOpenTech/redis/releases</a>.</p>
<p>Redis há»— trá»£ cáº£ phiÃªn báº£n 32-bit vÃ  64-bit. Báº¡n cáº§n chá»n phiÃªn báº£n phÃ¹ há»£p vá»›i há»‡ Ä‘iá»u hÃ nh cá»§a báº¡n. Táº¡i Ä‘Ã¢y, chÃºng ta táº£i xuá»‘ng tá»‡p nÃ©n <strong>Redis-x64-xxx.zip</strong> vÃ  giáº£i nÃ©n vÃ o á»• Ä‘Ä©a C, sau Ä‘Ã³ Ä‘á»•i tÃªn thÆ° má»¥c thÃ nh <strong>redis</strong>.</p>
<p>Má»Ÿ cá»­a sá»• <strong>cmd</strong> vÃ  sá»­ dá»¥ng lá»‡nh cd Ä‘á»ƒ chuyá»ƒn Ä‘áº¿n thÆ° má»¥c <strong>C:\redis</strong>, cháº¡y lá»‡nh <strong>redis-server.exe redis.windows.conf</strong>.</p>
<p>Náº¿u muá»‘n tiá»‡n lá»£i hÆ¡n, báº¡n cÃ³ thá»ƒ thÃªm Ä‘Æ°á»ng dáº«n cá»§a Redis vÃ o biáº¿n mÃ´i trÆ°á»ng há»‡ thá»‘ng, Ä‘iá»u nÃ y sáº½ giÃºp báº¡n khÃ´ng cáº§n pháº£i nháº­p Ä‘Æ°á»ng dáº«n má»—i láº§n sá»­ dá»¥ng. Báº¡n cÃ³ thá»ƒ bá» qua pháº§n redis.windows.conf náº¿u muá»‘n, náº¿u bá» qua, Redis sáº½ sá»­ dá»¥ng cáº¥u hÃ¬nh máº·c Ä‘á»‹nh.</p>
<p>BÃ¢y giá» má»Ÿ má»™t cá»­a sá»• cmd má»›i, khÃ´ng Ä‘Ã³ng cá»­a sá»• cÅ©, vÃ¬ náº¿u Ä‘Ã³ng thÃ¬ báº¡n sáº½ khÃ´ng thá»ƒ truy cáº­p vÃ o mÃ¡y chá»§ dá»‹ch vá»¥ ná»¯a.</p>
<p>Chuyá»ƒn Ä‘áº¿n thÆ° má»¥c redis vÃ  cháº¡y lá»‡nh <strong>redis-cli.exe -h 127.0.0.1 -p 6379</strong>.</p>
<h3>CÃ i Ä‘áº·t trÃªn Linux</h3>
<p><strong>ÄÆ°á»ng dáº«n táº£i vá»:</strong> <a href="http://redis.io/download" target="_blank" rel="noopener noreferrer">http://redis.io/download</a>, táº£i phiÃªn báº£n má»›i nháº¥t.</p>
<p>Táº£i xuá»‘ng, giáº£i nÃ©n vÃ  biÃªn dá»‹ch Redis:</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">wget</span><span style="color:#98C379;--shiki-dark:#98C379"> http://download.redis.io/releases/redis-5.0.4.tar.gz</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">tar</span><span style="color:#98C379;--shiki-dark:#98C379"> xzf</span><span style="color:#98C379;--shiki-dark:#98C379"> redis-5.0.4.tar.gz</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2">cd</span><span style="color:#98C379;--shiki-dark:#98C379"> redis-5.0.4</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">make</span></span></code></pre>
</div><p>Äá»ƒ biÃªn dá»‹ch mÃ£ nguá»“n Redis, báº¡n cáº§n cÃ i Ä‘áº·t gcc-c++ vÃ  tcl. Náº¿u báº¡n Ä‘ang sá»­ dá»¥ng CentOS, báº¡n cÃ³ thá»ƒ cÃ i Ä‘áº·t báº±ng lá»‡nh <code>yum install -y gcc-c++ tcl</code>.</p>
<p>Sau khi giáº£i nÃ©n, Ä‘iá»u hÆ°á»›ng Ä‘áº¿n thÆ° má»¥c <code>src</code> vÃ  khá»Ÿi Ä‘á»™ng Redis báº±ng lá»‡nh sau:</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">src/redis-server</span></span></code></pre>
</div><p>Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng client tÃ­ch há»£p Ä‘á»ƒ tÆ°Æ¡ng tÃ¡c vá»›i Redis:</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">$</span><span style="color:#98C379;--shiki-dark:#98C379"> src/redis-cli</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">redis</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379">set</span><span style="color:#98C379;--shiki-dark:#98C379"> foo</span><span style="color:#98C379;--shiki-dark:#98C379"> bar</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">OK</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">redis</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379">get</span><span style="color:#98C379;--shiki-dark:#98C379"> foo</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">"bar"</span></span></code></pre>
</div><h3>CÃ i Ä‘áº·t trÃªn Ubuntu</h3>
<p>TrÃªn há»‡ Ä‘iá»u hÃ nh Ubuntu, báº¡n cÃ³ thá»ƒ cÃ i Ä‘áº·t Redis báº±ng cÃ¡c lá»‡nh sau:</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">sudo</span><span style="color:#98C379;--shiki-dark:#98C379"> apt-get</span><span style="color:#98C379;--shiki-dark:#98C379"> update</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">sudo</span><span style="color:#98C379;--shiki-dark:#98C379"> apt-get</span><span style="color:#98C379;--shiki-dark:#98C379"> install</span><span style="color:#98C379;--shiki-dark:#98C379"> redis-server</span></span></code></pre>
</div><h3>Tá»± Ä‘á»™ng khá»Ÿi Ä‘á»™ng khi mÃ¡y khá»Ÿi Ä‘á»™ng</h3>
<ul>
<li>Cáº¥u hÃ¬nh tá»± Ä‘á»™ng khá»Ÿi Ä‘á»™ng: <code>echo "/usr/local/bin/redis-server /etc/redis.conf" &gt;&gt; /etc/rc.local</code></li>
</ul>
<h3>Má»Ÿ cá»•ng trÃªn tÆ°á»ng lá»­a</h3>
<ul>
<li>ThÃªm quy táº¯c: <code>iptables -I INPUT -p tcp -m tcp --dport 6379 -j ACCEPT</code></li>
<li>LÆ°u quy táº¯c: <code>service iptables save</code></li>
<li>Khá»Ÿi Ä‘á»™ng láº¡i iptables: <code>service iptables restart</code></li>
</ul>
<h3>Ká»‹ch báº£n cÃ i Ä‘áº·t Redis</h3>
<blockquote>
<p>Ká»‹ch báº£n cÃ i Ä‘áº·t cho mÃ´i trÆ°á»ng CentOS 7</p>
</blockquote>
<p><strong>HÆ°á»›ng dáº«n cÃ i Ä‘áº·t</strong></p>
<ul>
<li>CÃ i Ä‘áº·t Redis báº±ng cÃ¡ch biÃªn dá»‹ch vÃ  Ä‘Äƒng kÃ½ nÃ³ nhÆ° má»™t dá»‹ch vá»¥ systemd</li>
<li>ÄÆ°á»ng dáº«n cÃ i Ä‘áº·t lÃ : <code>/usr/local/redis</code></li>
<li>PhiÃªn báº£n máº·c Ä‘á»‹nh lÃ  <code>5.0.4</code>, cá»•ng máº·c Ä‘á»‹nh lÃ  <code>6379</code>, máº­t kháº©u truy cáº­p lÃ  trá»‘ng</li>
</ul>
<p><strong>CÃ¡ch sá»­ dá»¥ng</strong></p>
<ul>
<li>CÃ i Ä‘áº·t máº·c Ä‘á»‹nh - Cháº¡y báº¥t ká»³ lá»‡nh nÃ o sau Ä‘Ã¢y:</li>
</ul>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">curl</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -o-</span><span style="color:#98C379;--shiki-dark:#98C379"> https://gitee.com/turnon/linux-tutorial/raw/master/codes/linux/soft/redis-install.sh</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">bash</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">wget</span><span style="color:#D19A66;--shiki-dark:#D19A66"> -qO-</span><span style="color:#98C379;--shiki-dark:#98C379"> https://gitee.com/turnon/linux-tutorial/raw/master/codes/linux/soft/redis-install.sh</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">bash</span></span></code></pre>
</div><ul>
<li>CÃ i Ä‘áº·t tÃ¹y chá»‰nh - Táº£i xuá»‘ng ká»‹ch báº£n vÃ  cháº¡y theo Ä‘á»‹nh dáº¡ng sau:</li>
</ul>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">sh</span><span style="color:#98C379;--shiki-dark:#98C379"> redis-install.sh</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [version] [port] [password]</span></span></code></pre>
</div><p>Giáº£i thÃ­ch cÃ¡c tham sá»‘:</p>
<ul>
<li><code>version</code> - sá»‘ phiÃªn báº£n Redis</li>
<li><code>port</code> - sá»‘ cá»•ng dá»‹ch vá»¥ Redis</li>
<li><code>password</code> - máº­t kháº©u truy cáº­p</li>
</ul>
<h2>2. Sá»­ dá»¥ng vÃ  cáº¥u hÃ¬nh Redis Ä‘Æ¡n</h2>
<h3>Khá»Ÿi Ä‘á»™ng Redis</h3>
<p><strong>Khá»Ÿi Ä‘á»™ng dá»‹ch vá»¥ Redis</strong></p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2">cd</span><span style="color:#98C379;--shiki-dark:#98C379"> /usr/local/redis/src</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">./redis-server</span></span></code></pre>
</div><p><strong>Khá»Ÿi Ä‘á»™ng client Redis</strong></p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2">cd</span><span style="color:#98C379;--shiki-dark:#98C379"> /usr/local/redis/src</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">./redis-cli</span></span></code></pre>
</div><p><strong>Kiá»ƒm tra Redis Ä‘Ã£ khá»Ÿi Ä‘á»™ng chÆ°a</strong></p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">redis-cli</span></span></code></pre>
</div><p>Lá»‡nh trÃªn sáº½ má»Ÿ má»™t terminal nhÆ° sau:</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">redis</span><span style="color:#98C379;--shiki-dark:#98C379"> 127.0.0.1:637</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">9&gt;</span></span></code></pre>
</div><p>127.0.0.1 lÃ  Ä‘á»‹a chá»‰ IP cá»§a mÃ¡y local, 6379 lÃ  cá»•ng cá»§a dá»‹ch vá»¥ Redis. BÃ¢y giá» chÃºng ta gÃµ lá»‡nh PING.</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">redis</span><span style="color:#98C379;--shiki-dark:#98C379"> 127.0.0.1:637</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">9&gt; </span><span style="color:#98C379;--shiki-dark:#98C379">ping</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">PONG</span></span></code></pre>
</div><p>Äiá»u nÃ y chá»©ng tá» chÃºng ta Ä‘Ã£ khá»Ÿi Ä‘á»™ng Redis thÃ nh cÃ´ng.</p>
<h3>Cáº¥u hÃ¬nh Redis thÃ´ng thÆ°á»ng</h3>
<blockquote>
<p>Tá»‡p cáº¥u hÃ¬nh máº·c Ä‘á»‹nh cá»§a Redis lÃ  <code>redis.conf</code> trong thÆ° má»¥c gá»‘c.</p>
<p>Náº¿u báº¡n muá»‘n chá»‰ Ä‘á»‹nh má»™t tá»‡p cáº¥u hÃ¬nh cá»¥ thá»ƒ, báº¡n cáº§n sá»­ dá»¥ng lá»‡nh: <code>./redis-server -c xxx.conf</code></p>
<p>Sau má»—i láº§n thay Ä‘á»•i cáº¥u hÃ¬nh, báº¡n cáº§n khá»Ÿi Ä‘á»™ng láº¡i Redis Ä‘á»ƒ Ã¡p dá»¥ng thay Ä‘á»•i.</p>
<p>Cáº¥u hÃ¬nh máº·c Ä‘á»‹nh cá»§a Redis:</p>
<ul>
<li>TÃ i liá»‡u mÃ´ táº£ báº£n thÃ¢n <a href="https://raw.githubusercontent.com/antirez/redis/2.8/redis.conf" target="_blank" rel="noopener noreferrer">redis.conf cho Redis 2.8</a></li>
<li>TÃ i liá»‡u mÃ´ táº£ báº£n thÃ¢n <a href="https://raw.githubusercontent.com/antirez/redis/2.6/redis.conf" target="_blank" rel="noopener noreferrer">redis.conf cho Redis 2.6</a>.</li>
<li>TÃ i liá»‡u mÃ´ táº£ báº£n thÃ¢n <a href="https://raw.githubusercontent.com/antirez/redis/2.4/redis.conf" target="_blank" rel="noopener noreferrer">redis.conf cho Redis 2.4</a>.</li>
</ul>
<p>Tá»« Redis 2.6 trá»Ÿ Ä‘i, báº¡n cÃ³ thá»ƒ truyá»n cÃ¡c tham sá»‘ cáº¥u hÃ¬nh Redis trá»±c tiáº¿p tá»« dÃ²ng lá»‡nh. PhÆ°Æ¡ng phÃ¡p nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng cho má»¥c Ä‘Ã­ch kiá»ƒm tra.</p>
</blockquote>
<h3>Äáº·t Redis lÃ m tiáº¿n trÃ¬nh ná»n</h3>
<p>Redis máº·c Ä‘á»‹nh khÃ´ng cháº¡y nhÆ° má»™t tiáº¿n trÃ¬nh ná»n, nhÆ°ng thÃ´ng thÆ°á»ng chÃºng ta sáº½ Ä‘áº·t Redis lÃ m tiáº¿n trÃ¬nh ná»n. Cáº¥u hÃ¬nh: <code>daemonize yes</code></p>
<h4>Truy cáº­p tá»« xa</h4>
<p>Redis máº·c Ä‘á»‹nh rÃ ng buá»™c vá»›i Ä‘á»‹a chá»‰ 127.0.0.1, Ä‘iá»u nÃ y chá»‰ cho phÃ©p truy cáº­p tá»« mÃ¡y cá»¥c bá»™. Náº¿u báº¡n muá»‘n cho phÃ©p truy cáº­p tá»« xa vÃ o Redis, báº¡n cáº§n cáº¥u hÃ¬nh: <code>bind 0.0.0.0</code></p>
<h4>Äáº·t máº­t kháº©u</h4>
<p>Redis máº·c Ä‘á»‹nh khÃ´ng yÃªu cáº§u máº­t kháº©u khi truy cáº­p. Náº¿u báº¡n muá»‘n Ä‘áº·t máº­t kháº©u, báº¡n cáº§n cáº¥u hÃ¬nh nhÆ° sau:</p>
<ul>
<li><code>protected-mode yes</code></li>
<li><code>requirepass &lt;máº­t kháº©u&gt;</code></li>
</ul>
<h4>Báº£ng tham sá»‘ cáº¥u hÃ¬nh</h4>
<p>| Cáº¥u hÃ¬nh                                                                                                                                                                                                               | MÃ´ táº£                                                                                                                                                                                                                                                                                   |<br>
| :</p>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230725005340.png" type="image/png"/>
    </item>
    <item>
      <title>Redis Overview</title>
      <link>https://vanhung4499.github.io/database/redis/overview.html</link>
      <guid>https://vanhung4499.github.io/database/redis/overview.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Redis Overview</source>
      <description>Redis Overview Redis lÃ  má»™t á»©ng dá»¥ng phá»• biáº¿n nháº¥t trong viá»‡c sá»­ dá»¥ng nhÆ° má»™t bá»™ Ä‘á»‡m phÃ¢n tÃ¡n. Äá»ƒ hiá»ƒu rÃµ vá» Redis, cáº§n náº¯m vá»¯ng nguyÃªn lÃ½ cá»§a bá»™ Ä‘á»‡m vÃ  vai trÃ² cá»§a Redis nhÆ° má»™...</description>
      <category>redis</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>Redis lÃ  má»™t á»©ng dá»¥ng phá»• biáº¿n nháº¥t trong viá»‡c sá»­ dá»¥ng nhÆ° má»™t bá»™ Ä‘á»‡m phÃ¢n tÃ¡n.</p>
<p>Äá»ƒ hiá»ƒu rÃµ vá» Redis, cáº§n náº¯m vá»¯ng nguyÃªn lÃ½ cá»§a bá»™ Ä‘á»‡m vÃ  vai trÃ² cá»§a Redis nhÆ° má»™t giáº£i phÃ¡p bá»™ Ä‘á»‡m trong há»‡ thá»‘ng á»©ng dá»¥ng.</p>
</blockquote>
<h2>ğŸ“– Contents</h2>
]]></content:encoded>
    </item>
    <item>
      <title>Redis Persistence</title>
      <link>https://vanhung4499.github.io/database/redis/persistence.html</link>
      <guid>https://vanhung4499.github.io/database/redis/persistence.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Redis Persistence</source>
      <description>LÆ°u trá»¯ bá»n vá»¯ng trong Redis Redis lÃ  cÆ¡ sá»Ÿ dá»¯ liá»‡u trong bá»™ nhá»› (in-memory). Äá»ƒ Ä‘áº£m báº£o dá»¯ liá»‡u khÃ´ng bá»‹ máº¥t sau khi xáº£y ra sá»± cá»‘, dá»¯ liá»‡u trong bá»™ nhá»› cáº§n pháº£i Ä‘Æ°á»£c lÆ°u vÃ o Ä‘Ä©...</description>
      <category>redis</category>
      <category>nosql</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>Redis lÃ  cÆ¡ sá»Ÿ dá»¯ liá»‡u trong bá»™ nhá»› (in-memory). Äá»ƒ Ä‘áº£m báº£o dá»¯ liá»‡u khÃ´ng bá»‹ máº¥t sau khi xáº£y ra sá»± cá»‘, dá»¯ liá»‡u trong bá»™ nhá»› cáº§n pháº£i Ä‘Æ°á»£c lÆ°u vÃ o Ä‘Ä©a cá»©ng.</p>
<p>Redis há»— trá»£ hai phÆ°Æ¡ng phÃ¡p kiÃªn trÃ¬: RDB vÃ  AOF. Hai phÆ°Æ¡ng phÃ¡p kiÃªn trÃ¬ nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»“ng thá»i hoáº·c riÃªng biá»‡t.</p>
</blockquote>
<h2>RDB</h2>
<h3>Giá»›i thiá»‡u vá» RDB</h3>
<p><strong>RDB (Redis Database Backup)</strong> hay cÃ²n gá»i lÃ  "báº£n snapshot", lÃ  quÃ¡ trÃ¬nh lÆ°u trá»¯ táº¥t cáº£ cÃ¡c cáº·p khÃ³a-giÃ¡ trá»‹ cá»§a cÆ¡ sá»Ÿ dá»¯ liá»‡u Redis vÃ o má»™t tá»‡p nhá»‹ phÃ¢n nÃ©n gá»i lÃ  "tá»‡p RDB" vÃ o má»™t thá»i Ä‘iá»ƒm cá»¥ thá»ƒ trong quÃ¡ trÃ¬nh hoáº¡t Ä‘á»™ng.</p>
<p><strong>LÆ°u trá»¯ RDB</strong> cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n "thá»§ cÃ´ng" hoáº·c "tá»± Ä‘á»™ng" theo Ä‘á»‹nh ká»³.</p>
<p><strong>Tá»‡p RDB</strong> Ä‘Æ°á»£c táº£i khi mÃ¡y chá»§ Redis Ä‘Æ°á»£c "khá»Ÿi Ä‘á»™ng" lÃ m viá»‡c "tá»± Ä‘á»™ng".</p>
<p>Vá»›i tá»«ng loáº¡i cáº·p khÃ³a-giÃ¡ trá»‹ khÃ¡c nhau, tá»‡p RDB sáº½ sá»­ dá»¥ng cÃ¡ch lÆ°u trá»¯ khÃ¡c nhau.</p>
<p>Sau khi táº¡o tá»‡p RDB, ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ sao lÆ°u RDB, sao chÃ©p RDB sang cÃ¡c mÃ¡y chá»§ khÃ¡c Ä‘á»ƒ táº¡o báº£n sao cá»§a mÃ¡y chá»§ cÃ³ cÃ¹ng dá»¯ liá»‡u, hoáº·c sá»­ dá»¥ng khi khá»Ÿi Ä‘á»™ng láº¡i mÃ¡y chá»§. TÃ³m láº¡i, <strong>RDB thÃ­ch há»£p cho viá»‡c "sao lÆ°u láº¡nh"</strong>.</p>
<h3>Æ¯u Ä‘iá»ƒm vÃ  NhÆ°á»£c Ä‘iá»ƒm cá»§a RDB</h3>
<p><strong>Æ¯u Ä‘iá»ƒm cá»§a RDB</strong></p>
<ul>
<li>
<p><strong>KÃ­ch thÆ°á»›c nhá» vÃ  phÃ¹ há»£p cho viá»‡c sao lÆ°u â€œláº¡nhâ€</strong>: Tá»‡p RDB ráº¥t gá»n nháº¹ vÃ  thÃ­ch há»£p Ä‘á»ƒ sá»­ dá»¥ng lÃ m sao lÆ°u Ä‘á»‹nh ká»³. Báº¡n cÃ³ thá»ƒ lÃªn lá»‹ch sao lÆ°u theo nhu cáº§u, vÃ­ dá»¥ má»—i giá» lÆ°u trá»¯ dá»¯ liá»‡u trong vÃ²ng 24 giá» qua, vÃ  má»—i ngÃ y lÆ°u trá»¯ dá»¯ liá»‡u trong vÃ²ng 30 ngÃ y qua. NhÆ° váº­y, ngay cáº£ khi xáº£y ra sá»± cá»‘, báº¡n cÅ©ng cÃ³ thá»ƒ khÃ´i phá»¥c dá»¯ liá»‡u thÃ nh cÃ¡c phiÃªn báº£n khÃ¡c nhau theo nhu cáº§u.</p>
</li>
<li>
<p><strong>Tá»‘i Æ°u hiá»‡u nÄƒng</strong>: Khi táº¡o tá»‡p RDB, quÃ¡ trÃ¬nh chá»‰ yÃªu cáº§u tiáº¿n trÃ¬nh cha cá»§a Redis fork ra má»™t tiáº¿n trÃ¬nh con, vÃ  toÃ n bá»™ cÃ´ng viá»‡c sau Ä‘Ã³ Ä‘Æ°á»£c tiáº¿n trÃ¬nh con thá»±c hiá»‡n. Tiáº¿n trÃ¬nh cha khÃ´ng cáº§n thá»±c hiá»‡n thÃªm thao tÃ¡c IO nÃ o, do Ä‘Ã³ phÆ°Æ¡ng phÃ¡p lÆ°u trá»¯ báº±ng RDB cÃ³ thá»ƒ tá»‘i Ä‘a hÃ³a hiá»‡u suáº¥t cá»§a Redis.</p>
</li>
<li>
<p><strong>Phá»¥c há»“i nhanh chÃ³ng vá»›i táº­p dá»¯ liá»‡u lá»›n</strong>: Khi phá»¥c há»“i dá»¯ liá»‡u tá»« RDB, quÃ¡ trÃ¬nh nÃ y thÆ°á»ng nhanh hÆ¡n so vá»›i AOF.</p>
</li>
</ul>
<p><strong>NhÆ°á»£c Ä‘iá»ƒm cá»§a RDB</strong></p>
<ul>
<li>
<p><strong>Rá»§i ro máº¥t dá»¯ liá»‡u</strong>: Náº¿u há»‡ thá»‘ng gáº·p sá»± cá»‘, dá»¯ liá»‡u sau láº§n táº¡o báº£n sao RDB cuá»‘i cÃ¹ng sáº½ bá»‹ máº¥t Ä‘i. Náº¿u báº¡n muá»‘n giáº£m thiá»ƒu máº¥t dá»¯ liá»‡u trong trÆ°á»ng há»£p Redis dá»«ng Ä‘á»™t ngá»™t (vÃ­ dá»¥ nhÆ° máº¥t Ä‘iá»‡n), thÃ¬ phÆ°Æ¡ng phÃ¡p lÆ°u trá»¯ báº±ng RDB khÃ´ng phÃ¹ há»£p. Máº·c dÃ¹ báº¡n cÃ³ thá»ƒ cáº¥u hÃ¬nh cÃ¡c Ä‘iá»ƒm lÆ°u trá»¯ khÃ¡c nhau (vÃ­ dá»¥, má»—i 5 phÃºt vÃ  cÃ³ 100 thao tÃ¡c ghi vÃ o táº­p dá»¯ liá»‡u), viá»‡c lÆ°u trá»¯ toÃ n bá»™ dá»¯ liá»‡u hoÃ n chá»‰nh cá»§a Redis lÃ  má»™t cÃ´ng viá»‡c tÆ°Æ¡ng Ä‘á»‘i náº·ng ná». ThÃ´ng thÆ°á»ng, báº¡n sáº½ thá»±c hiá»‡n lÆ°u trá»¯ Ä‘áº§y Ä‘á»§ má»—i 5 phÃºt hoáº·c lÃ¢u hÆ¡n, vÃ  náº¿u Redis ngá»«ng hoáº¡t Ä‘á»™ng Ä‘á»™t ngá»™t, báº¡n cÃ³ thá»ƒ máº¥t vÃ i phÃºt dá»¯ liá»‡u.</p>
</li>
<li>
<p><strong>Thá»i gian lÆ°u trá»¯ dÃ i khi táº­p dá»¯ liá»‡u lá»›n</strong>: Khi táº­p dá»¯ liá»‡u lá»›n, quÃ¡ trÃ¬nh fork Ä‘á»ƒ lÆ°u trá»¯ RDB cÃ³ thá»ƒ tá»‘n nhiá»u thá»i gian. Äiá»u nÃ y cÃ³ thá»ƒ dáº«n Ä‘áº¿n viá»‡c Redis khÃ´ng thá»ƒ pháº£n há»“i yÃªu cáº§u tá»« ngÆ°á»i dÃ¹ng trong vÃ i mili giÃ¢y. Náº¿u táº­p dá»¯ liá»‡u quÃ¡ lá»›n vÃ  hiá»‡u suáº¥t CPU khÃ´ng tá»‘t, tÃ¬nh tráº¡ng nÃ y cÃ³ thá»ƒ kÃ©o dÃ i lÃªn Ä‘áº¿n 1 giÃ¢y. AOF cÅ©ng cáº§n pháº£i fork, nhÆ°ng báº¡n cÃ³ thá»ƒ Ä‘iá»u chá»‰nh táº§n suáº¥t viáº¿t láº¡i tá»‡p nháº­t kÃ½ Ä‘á»ƒ tÄƒng tÃ­nh bá»n bá»‰ cá»§a táº­p dá»¯ liá»‡u.</p>
</li>
</ul>
<h3>Táº¡o tá»‡p RDB</h3>
<p>Redis cung cáº¥p hai lá»‡nh Ä‘á»ƒ táº¡o tá»‡p RDB: <a href="https://redis.io/commands/save" target="_blank" rel="noopener noreferrer"><strong><code>SAVE</code></strong></a> vÃ  <a href="https://redis.io/commands/bgsave" target="_blank" rel="noopener noreferrer"><strong><code>BGSAVE</code></strong></a>.</p>
<p><strong>Lá»‡nh <code>SAVE</code></strong> Ä‘Æ°á»£c thá»±c thi bá»Ÿi tiáº¿n trÃ¬nh mÃ¡y chá»§ trá»±c tiáº¿p vÃ  sáº½ cháº·n (block) mÃ¡y chá»§ cho Ä‘áº¿n khi tá»‡p RDB Ä‘Æ°á»£c táº¡o xong. Trong thá»i gian cháº·n nÃ y, mÃ¡y chá»§ sáº½ khÃ´ng thá»ƒ pháº£n há»“i báº¥t ká»³ yÃªu cáº§u lá»‡nh nÃ o khÃ¡c.</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&gt; SAVE</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">"OK"</span></span></code></pre>
</div><p><strong>Lá»‡nh <code>BGSAVE</code></strong> khá»Ÿi Ä‘á»™ng má»™t tiáº¿n trÃ¬nh con (fork) Ä‘á»ƒ táº¡o tá»‡p RDB, do Ä‘Ã³ mÃ¡y chá»§ tiáº¿p tá»¥c xá»­ lÃ½ cÃ¡c yÃªu cáº§u lá»‡nh trong khi quÃ¡ trÃ¬nh táº¡o tá»‡p RDB diá»…n ra. VÃ¬ váº­y, lá»‡nh nÃ y khÃ´ng lÃ m cháº·n mÃ¡y chá»§.</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&gt; BGSAVE</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">"Background saving started"</span></span></code></pre>
</div><blockquote>
<p>ğŸ”” <strong>ã€ChÃº Ã½ã€‘</strong></p>
<p><code>BGSAVE</code> sá»­ dá»¥ng cÃ´ng nghá»‡ sao chÃ©p khi ghi (Copy-On-Write, viáº¿t khi sao chÃ©p).</p>
<p>Trong quÃ¡ trÃ¬nh thá»±c thi <code>BGSAVE</code>, cÃ¡c lá»‡nh <code>SAVE</code>, <code>BGSAVE</code>, vÃ  <code>BGREWRITEAOF</code> sáº½ bá»‹ tá»« chá»‘i Ä‘á»ƒ trÃ¡nh xung Ä‘á»™t Ä‘ua ra giá»¯a <code>BGSAVE</code> hiá»‡n táº¡i vÃ  cÃ¡c hoáº¡t Ä‘á»™ng khÃ¡c, nháº±m tá»‘i Æ°u hÃ³a hiá»‡u suáº¥t.</p>
</blockquote>
<p>QuÃ¡ trÃ¬nh táº¡o tá»‡p RDB Ä‘Æ°á»£c thá»±c hiá»‡n bá»Ÿi hÃ m <code>rdb.c/rdbSave</code> trong mÃ£ nguá»“n Redis.</p>
<h3>Táº£i tá»‡p RDB</h3>
<p>Redis thá»±c hiá»‡n viá»‡c táº£i tá»‡p RDB khi mÃ¡y chá»§ khá»Ÿi Ä‘á»™ng mÃ  khÃ´ng cáº§n lá»‡nh Ä‘áº·c biá»‡t Ä‘á»ƒ thá»±c hiá»‡n Ä‘iá»u nÃ y.</p>
<p><strong>Viá»‡c táº£i tá»‡p RDB xáº£y ra tá»± Ä‘á»™ng khi mÃ¡y chá»§ Redis khá»Ÿi Ä‘á»™ng</strong>. Trong quÃ¡ trÃ¬nh nÃ y, mÃ¡y chá»§ sáº½ á»Ÿ tráº¡ng thÃ¡i cháº·n (block) cho Ä‘áº¿n khi quÃ¡ trÃ¬nh táº£i RDB hoÃ n táº¥t.</p>
<p>QuÃ¡ trÃ¬nh táº£i RDB Ä‘Æ°á»£c thá»±c hiá»‡n bá»Ÿi hÃ m <code>rdb.c/rdbLoad</code> trong mÃ£ nguá»“n Redis.</p>
<blockquote>
<p>ğŸ”” <strong>ã€ChÃº Ã½ã€‘</strong></p>
<p>Do táº§n suáº¥t cáº­p nháº­t cá»§a AOF thÆ°á»ng cao hÆ¡n so vá»›i RDB:</p>
<ul>
<li>Náº¿u mÃ¡y chá»§ cÃ³ AOF Ä‘Æ°á»£c kÃ­ch hoáº¡t, mÃ¡y chá»§ sáº½ Æ°u tiÃªn sá»­ dá»¥ng AOF Ä‘á»ƒ khÃ´i phá»¥c dá»¯ liá»‡u.</li>
<li>Chá»‰ khi AOF bá»‹ táº¯t, mÃ¡y chá»§ má»›i sá»­ dá»¥ng tá»‡p RDB Ä‘á»ƒ khÃ´i phá»¥c dá»¯ liá»‡u.</li>
</ul>
</blockquote>
<p>Äiá»u nÃ y Ä‘áº£m báº£o ráº±ng Redis luÃ´n sá»­ dá»¥ng cÆ¡ cháº¿ lÆ°u trá»¯ phÃ¹ há»£p nháº¥t Ä‘á»ƒ Ä‘áº£m báº£o an toÃ n vÃ  khÃ´i phá»¥c dá»¯ liá»‡u má»™t cÃ¡ch hiá»‡u quáº£ khi khá»Ÿi Ä‘á»™ng láº¡i.</p>
<h3>Tá»± Ä‘á»™ng sao lÆ°u Ä‘á»‹nh kÃ¬</h3>
<p>Redis há»— trá»£ tá»± Ä‘á»™ng thá»±c hiá»‡n lá»‡nh <code>BGSAVE</code> theo khoáº£ng thá»i gian Ä‘Æ°á»£c cáº¥u hÃ¬nh trong tá»‡p <code>redis.conf</code> báº±ng cÃ¡ch sá»­ dá»¥ng tÃ¹y chá»n <code>save</code>. TÃ¹y chá»n <code>save</code> cho phÃ©p thiáº¿t láº­p nhiá»u Ä‘iá»u kiá»‡n lÆ°u trá»¯, vÃ  khi báº¥t ká»³ Ä‘iá»u kiá»‡n nÃ o Ä‘Æ°á»£c Ä‘Ã¡p á»©ng, mÃ¡y chá»§ Redis sáº½ thá»±c hiá»‡n lá»‡nh <code>BGSAVE</code>.</p>
<p><strong>VÃ­ dá»¥ cáº¥u hÃ¬nh tá»± Ä‘á»™ng lÆ°u trá»¯ trong <code>redis.conf</code>:</strong></p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Trong vÃ²ng 900 giÃ¢y, Ã­t nháº¥t cÃ³ 1 láº§n thay Ä‘á»•i cÆ¡ sá»Ÿ dá»¯ liá»‡u</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">save</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 900</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Trong vÃ²ng 300 giÃ¢y, Ã­t nháº¥t cÃ³ 10 láº§n thay Ä‘á»•i cÆ¡ sá»Ÿ dá»¯ liá»‡u</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">save</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 300</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 10</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic"># Trong vÃ²ng 60 giÃ¢y, Ã­t nháº¥t cÃ³ 10000 láº§n thay Ä‘á»•i cÆ¡ sá»Ÿ dá»¯ liá»‡u</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">save</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 60</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 10000</span></span></code></pre>
</div><p>Khi báº¥t ká»³ Ä‘iá»u kiá»‡n nÃ o Ä‘Æ°á»£c Ä‘Ã¡p á»©ng, Redis sáº½ thá»±c hiá»‡n lá»‡nh <code>BGSAVE</code>.</p>
<p><strong>Äá»‹nh nghÄ©a cÃ¡c Ä‘iá»u kiá»‡n lÆ°u trá»¯ trong <code>redis.h/redisServer</code>:</strong></p>
<div class="language-c line-numbers-mode" data-ext="c" data-title="c"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">struct</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> redisServer {</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">    // Máº£ng lÆ°u trá»¯ cÃ¡c Ä‘iá»u kiá»‡n lÆ°u trá»¯</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    struct</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> saveparam </span><span style="color:#C678DD;--shiki-dark:#C678DD">*</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">saveparams;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">    // Sá»‘ láº§n thay Ä‘á»•i cÆ¡ sá»Ÿ dá»¯ liá»‡u ká»ƒ tá»« láº§n SAVE cuá»‘i cÃ¹ng</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    long</span><span style="color:#C678DD;--shiki-dark:#C678DD"> long</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> dirty;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">    // Thá»i Ä‘iá»ƒm thá»±c hiá»‡n SAVE láº§n cuá»‘i</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    time_t</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> lastsave;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">// Cáº¥u trÃºc Ä‘iá»u kiá»‡n lÆ°u trá»¯ cá»§a mÃ¡y chá»§ (cÃ¡c Ä‘iá»u kiá»‡n tá»± Ä‘á»™ng thá»±c hiá»‡n BGSAVE)</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">struct</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> saveparam {</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">    // Thá»i gian giá»›i háº¡n (seconds)</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    time_t</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> seconds;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">    // Sá»‘ láº§n thay Ä‘á»•i</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    int</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> changes;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">};</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Máº£ng <code>saveparams</code> trong <code>redisServer</code> duy trÃ¬ cÃ¡c Ä‘iá»u kiá»‡n lÆ°u trá»¯ tá»± Ä‘á»™ng.</p>
<p>Má»—i khi thÃ nh cÃ´ng thá»±c hiá»‡n má»™t lá»‡nh chá»‰nh sá»­a, biáº¿n <code>dirty</code> sáº½ tÄƒng lÃªn 1 Ä‘Æ¡n vá»‹; <code>lastsave</code> ghi láº¡i thá»i Ä‘iá»ƒm láº§n SAVE cuá»‘i cÃ¹ng Ä‘Æ°á»£c thá»±c hiá»‡n. Redis sá»­ dá»¥ng hÃ m <code>serverCron</code> Ä‘á»ƒ Ä‘á»‹nh ká»³ kiá»ƒm tra xem cÃ¡c Ä‘iá»u kiá»‡n Ä‘Æ°á»£c cáº¥u hÃ¬nh trong <code>save</code> cÃ³ Ä‘Æ°á»£c Ä‘Ã¡p á»©ng khÃ´ng. Náº¿u Ä‘Ã¡p á»©ng, Redis sáº½ thá»±c hiá»‡n lá»‡nh <code>BGSAVE</code>.</p>
<h3>Cáº¥u trÃºc cá»§a tá»‡p RDB</h3>
<p><strong>Tá»‡p RDB lÃ  má»™t tá»‡p nhá»‹ phÃ¢n Ä‘Æ°á»£c nÃ©n</strong> vÃ  Ä‘Æ°á»£c chia thÃ nh nhiá»u pháº§n khÃ¡c nhau tÃ¹y thuá»™c vÃ o loáº¡i dá»¯ liá»‡u (STRING, HASH, LIST, SET, SORTED SET).</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/redis-rdb-structure.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>
<p>Redis cung cáº¥p cÃ´ng cá»¥ <code>redis-check-dump</code> Ä‘á»ƒ kiá»ƒm tra tá»‡p RDB.</p>
<h3>Cáº¥u hÃ¬nh RDB</h3>
<p>Máº·c Ä‘á»‹nh, Redis cáº¥u hÃ¬nh RDB nhÆ° sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>save 900 1</span></span>
<span class="line"><span>save 300 10</span></span>
<span class="line"><span>save 60 10000</span></span>
<span class="line"><span>stop-writes-on-bgsave-error yes</span></span>
<span class="line"><span>rdbcompression yes</span></span>
<span class="line"><span>rdbchecksum yes</span></span>
<span class="line"><span>dbfilename dump.rdb</span></span>
<span class="line"><span>dir ./</span></span></code></pre>
</div><p>CÃ¡c tÃ¹y chá»n liÃªn quan Ä‘áº¿n RDB trong tá»‡p cáº¥u hÃ¬nh <code>redis.conf</code> cá»§a Redis:</p>
<ul>
<li><code>save</code>: Redis sáº½ tá»± Ä‘á»™ng thá»±c hiá»‡n lá»‡nh <code>BGSAVE</code> theo cÃ¡c Ä‘iá»u kiá»‡n Ä‘Æ°á»£c cáº¥u hÃ¬nh trong <code>save</code>.</li>
<li><code>stop-writes-on-bgsave-error</code>: Dá»«ng ghi khi cÃ³ lá»—i trong quÃ¡ trÃ¬nh <code>BGSAVE</code>.</li>
<li><code>rdbcompression</code>: Báº­t/táº¯t nÃ©n RDB.</li>
<li><code>rdbchecksum</code>: Kiá»ƒm tra dá»¯ liá»‡u RDB.</li>
<li><code>dbfilename</code>: TÃªn tá»‡p RDB.</li>
<li><code>dir</code>: ThÆ° má»¥c lÆ°u trá»¯ tá»‡p RDB vÃ  AOF.</li>
</ul>
<h2>2. AOF</h2>
<h3>Giá»›i thiá»‡u vá» AOF</h3>
<p><code>AOF (Append Only File)</code> lÃ  má»™t tá»‡p ghi log mÃ  Redis sá»­ dá»¥ng Ä‘á»ƒ lÆ°u trá»¯ táº¥t cáº£ cÃ¡c lá»‡nh ghi vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u. Khi mÃ¡y chá»§ khá»Ÿi Ä‘á»™ng láº¡i, Redis sáº½ náº¡p vÃ  thá»±c thi cÃ¡c lá»‡nh tá»« tá»‡p AOF nÃ y Ä‘á»ƒ khÃ´i phá»¥c dá»¯ liá»‡u gá»‘c. AOF Ä‘Æ°á»£c coi lÃ  phÆ°Æ¡ng phÃ¡p "sao lÆ°u nÃ³ng".</p>
<p>AOF cÃ³ thá»ƒ Ä‘Æ°á»£c báº­t báº±ng cÃ¡ch Ä‘áº·t cáº¥u hÃ¬nh <code>appendonly yes</code>.</p>
<h3>Æ¯u Ä‘iá»ƒm vÃ  nhÆ°á»£c Ä‘iá»ƒm cá»§a AOF</h3>
<p><strong>Æ¯u Ä‘iá»ƒm cá»§a AOF</strong></p>
<ul>
<li><strong>Giáº£m thiá»ƒu máº¥t mÃ¡t dá»¯ liá»‡u so vá»›i RDB</strong>: Khi há»‡ thá»‘ng gáº·p sá»± cá»‘, AOF thÆ°á»ng máº¥t Ã­t dá»¯ liá»‡u hÆ¡n RDB. Báº¡n cÃ³ thá»ƒ cáº¥u hÃ¬nh cÃ¡c chiáº¿n lÆ°á»£c fsync khÃ¡c nhau nhÆ° khÃ´ng cÃ³ fsync, fsync má»—i giÃ¢y, hoáº·c fsync má»—i láº§n ghi. Vá»›i chiáº¿n lÆ°á»£c máº·c Ä‘á»‹nh fsync má»—i giÃ¢y, Redis váº«n duy trÃ¬ hiá»‡u suáº¥t tá»‘t vÃ  chá»‰ máº¥t tá»‘i Ä‘a 1 giÃ¢y dá»¯ liá»‡u khi cÃ³ sá»± cá»‘.</li>
<li><strong>Kháº£ nÄƒng sá»­a chá»¯a tá»‡p AOF</strong>: Tá»‡p AOF lÃ  má»™t tá»‡p log chá»‰ thÃªm vÃ o (append-only), do Ä‘Ã³ khÃ´ng cáº§n pháº£i thá»±c hiá»‡n seek khi ghi. Ngay cáº£ khi má»™t sá»‘ lá»‡nh ghi khÃ´ng Ä‘Æ°á»£c hoÃ n thÃ nh do lÃ½ do nÃ o Ä‘Ã³ (vÃ­ dá»¥ nhÆ° khÃ´ng gian á»• Ä‘Ä©a Ä‘áº§y), báº¡n váº«n cÃ³ thá»ƒ sá»­a chá»¯a váº¥n Ä‘á» nÃ y báº±ng cÃ´ng cá»¥ <code>redis-check-aof</code>.</li>
<li><strong>NÃ©n tá»‡p AOF</strong>: Redis cÃ³ thá»ƒ tá»± Ä‘á»™ng tÃ¡i viáº¿t (rewrite) tá»‡p AOF khi nÃ³ trá»Ÿ nÃªn quÃ¡ lá»›n. Tá»‡p AOF má»›i sau khi tÃ¡i viáº¿t chá»‰ chá»©a cÃ¡c lá»‡nh tá»‘i thiá»ƒu cáº§n thiáº¿t Ä‘á»ƒ khÃ´i phá»¥c dá»¯ liá»‡u hiá»‡n táº¡i. QuÃ¡ trÃ¬nh tÃ¡i viáº¿t hoÃ n toÃ n an toÃ n vÃ¬ Redis váº«n tiáº¿p tá»¥c ghi cÃ¡c lá»‡nh vÃ o tá»‡p AOF hiá»‡n cÃ³ trong khi táº¡o ra tá»‡p AOF má»›i. Khi tá»‡p AOF má»›i Ä‘Æ°á»£c táº¡o xong, Redis sáº½ chuyá»ƒn sang sá»­ dá»¥ng tá»‡p AOF má»›i vÃ  tiáº¿p tá»¥c ghi vÃ o Ä‘Ã³.</li>
<li><strong>Dá»… Ä‘á»c vÃ  phÃ¢n tÃ­ch</strong>: Tá»‡p AOF lÆ°u trá»¯ táº¥t cáº£ cÃ¡c lá»‡nh ghi vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u theo Ä‘Ãºng thá»© tá»±. Do Ä‘Ã³, ná»™i dung cá»§a tá»‡p AOF ráº¥t dá»… Ä‘á»c vÃ  phÃ¢n tÃ­ch. Báº¡n cÃ³ thá»ƒ dá»… dÃ ng xuáº¥t tá»‡p AOF hoáº·c phÃ¢n tÃ­ch nÃ³. VÃ­ dá»¥, náº¿u báº¡n vÃ´ tÃ¬nh thá»±c hiá»‡n lá»‡nh FLUSHALL, nhÆ°ng tá»‡p AOF chÆ°a bá»‹ tÃ¡i viáº¿t, báº¡n cÃ³ thá»ƒ dá»«ng mÃ¡y chá»§, loáº¡i bá» lá»‡nh FLUSHALL cuá»‘i cÃ¹ng tá»« tá»‡p AOF vÃ  khá»Ÿi Ä‘á»™ng láº¡i Redis Ä‘á»ƒ khÃ´i phá»¥c dá»¯ liá»‡u trÆ°á»›c khi thá»±c hiá»‡n FLUSHALL.</li>
</ul>
<p><strong>NhÆ°á»£c Ä‘iá»ƒm cá»§a AOF</strong></p>
<ul>
<li><strong>KÃ­ch thÆ°á»›c tá»‡p AOF thÆ°á»ng lá»›n hÆ¡n RDB</strong>: Äá»‘i vá»›i cÃ¹ng má»™t bá»™ dá»¯ liá»‡u, tá»‡p AOF thÆ°á»ng cÃ³ kÃ­ch thÆ°á»›c lá»›n hÆ¡n tá»‡p RDB.</li>
<li><strong>KhÃ´i phá»¥c bá»™ dá»¯ liá»‡u lá»›n tá»« AOF cÃ³ thá»ƒ cháº­m hÆ¡n RDB</strong>: TÃ¹y thuá»™c vÃ o chiáº¿n lÆ°á»£c fsync Ä‘Æ°á»£c sá»­ dá»¥ng, AOF cÃ³ thá»ƒ cháº­m hÆ¡n so vá»›i RDB trong quÃ¡ trÃ¬nh khÃ´i phá»¥c dá»¯ liá»‡u lá»›n. Tuy nhiÃªn, vá»›i fsync má»—i giÃ¢y, hiá»‡u suáº¥t cá»§a AOF váº«n ráº¥t cao vÃ  cÃ³ thá»ƒ xá»©ng Ä‘Ã¡ng vá»›i tá»‘c Ä‘á»™ cá»§a RDB. Tuy nhiÃªn, trong cÃ¡c táº£i ghi lá»›n, RDB cÃ³ thá»ƒ cung cáº¥p thá»i gian Ä‘Ã¡p á»©ng tá»‘i Ä‘a Ä‘Ã¡ng tin cáº­y hÆ¡n.</li>
</ul>
<h3>Táº¡o AOF</h3>
<p><strong>CÃ¡c yÃªu cáº§u lá»‡nh Redis sáº½ Ä‘Æ°á»£c lÆ°u vÃ o vÃ¹ng Ä‘á»‡m AOF, sau Ä‘Ã³ Ä‘Æ°á»£c ghi vÃ  Ä‘á»“ng bá»™ hÃ³a Ä‘á»‹nh ká»³ vÃ o tá»‡p AOF.</strong></p>
<p>Viá»‡c triá»ƒn khai AOF cÃ³ thá»ƒ chia thÃ nh ba bÆ°á»›c: ghi lá»‡nh (append), ghi tá»‡p vÃ  Ä‘á»“ng bá»™ hÃ³a tá»‡p (sync).</p>
<ul>
<li>
<p><strong>Ghi lá»‡nh (append)</strong> - Khi chá»©c nÄƒng AOF cá»§a mÃ¡y chá»§ Redis Ä‘Æ°á»£c báº­t, mÃ¡y chá»§ sáº½ thÃªm lá»‡nh ghi sáº½ thá»±c thi vÃ o cuá»‘i vÃ¹ng Ä‘á»‡m AOF dÆ°á»›i dáº¡ng giao thá»©c lá»‡nh Redis.</p>
</li>
<li>
<p><strong>Ghi tá»‡p vÃ  Ä‘á»“ng bá»™ hÃ³a tá»‡p</strong></p>
<ul>
<li>QuÃ¡ trÃ¬nh sá»± kiá»‡n cá»§a mÃ¡y chá»§ Redis lÃ  má»™t vÃ²ng láº·p sá»± kiá»‡n, trong Ä‘Ã³ sá»± kiá»‡n tá»‡p chá»‹u trÃ¡ch nhiá»‡m nháº­n yÃªu cáº§u lá»‡nh tá»« khÃ¡ch hÃ ng vÃ  gá»­i pháº£n há»“i lá»‡nh cho khÃ¡ch hÃ ng. Trong khi Ä‘Ã³, sá»± kiá»‡n thá»i gian chá»‹u trÃ¡ch nhiá»‡m thá»±c hiá»‡n cÃ¡c chá»©c nÄƒng cháº¡y Ä‘á»‹nh ká»³ nhÆ° <code>serverCron</code>.</li>
<li>VÃ¬ mÃ¡y chá»§ cÃ³ thá»ƒ thá»±c hiá»‡n lá»‡nh ghi khi xá»­ lÃ½ sá»± kiá»‡n tá»‡p, cÃ¡c lá»‡nh ghi nÃ y sáº½ Ä‘Æ°á»£c thÃªm vÃ o vÃ¹ng Ä‘á»‡m AOF. TrÆ°á»›c khi káº¿t thÃºc vÃ²ng láº·p sá»± kiá»‡n, mÃ¡y chá»§ sáº½ kiá»ƒm tra ná»™i dung vÃ¹ng Ä‘á»‡m AOF dá»±a trÃªn tÃ¹y chá»n <code>appendfsync</code> Ä‘á»ƒ quyáº¿t Ä‘á»‹nh xem liá»‡u ná»™i dung nÃ y cÃ³ cáº§n Ä‘Æ°á»£c ghi vÃ o vÃ  Ä‘á»“ng bá»™ hÃ³a vá»›i tá»‡p AOF hay khÃ´ng.</li>
</ul>
</li>
</ul>
<p>TÃ¹y chá»n <code>appendfsync</code> quyáº¿t Ä‘á»‹nh hÃ nh vi bá»n vá»¯ng cá»§a AOF nhÆ° sau:</p>
<ul>
<li><strong><code>always</code></strong> - Ghi táº¥t cáº£ ná»™i dung tá»« vÃ¹ng Ä‘á»‡m AOF vÃ o vÃ  Ä‘á»“ng bá»™ hÃ³a vá»›i tá»‡p AOF. PhÆ°Æ¡ng phÃ¡p nÃ y Ä‘áº£m báº£o an toÃ n dá»¯ liá»‡u nháº¥t nhÆ°ng hiá»‡u suáº¥t tháº¥p nháº¥t.</li>
<li><strong><code>no</code></strong> - Ghi táº¥t cáº£ ná»™i dung tá»« vÃ¹ng Ä‘á»‡m AOF vÃ o tá»‡p AOF nhÆ°ng khÃ´ng Ä‘á»“ng bá»™ hÃ³a, thá»i Ä‘iá»ƒm Ä‘á»“ng bá»™ hÃ³a phá»¥ thuá»™c vÃ o há»‡ Ä‘iá»u hÃ nh. ÄÃ¢y lÃ  phÆ°Æ¡ng phÃ¡p dá»¯ liá»‡u khÃ´ng an toÃ n nháº¥t, má»i dá»¯ liá»‡u chÆ°a ká»‹p Ä‘á»“ng bá»™ hÃ³a khi gáº·p sá»± cá»‘ sáº½ bá»‹ máº¥t.</li>
<li><strong><code>everysec</code></strong> - TÃ¹y chá»n máº·c Ä‘á»‹nh cá»§a <code>appendfsync</code>. Ghi táº¥t cáº£ ná»™i dung tá»« vÃ¹ng Ä‘á»‡m AOF vÃ o tá»‡p AOF, vÃ  náº¿u thá»i gian tá»« láº§n Ä‘á»“ng bá»™ hÃ³a AOF trÆ°á»›c Ä‘Ã³ Ä‘Ã£ quÃ¡ 1 giÃ¢y, sáº½ tiáº¿p tá»¥c Ä‘á»“ng bá»™ hÃ³a. Thao tÃ¡c nÃ y Ä‘Æ°á»£c thá»±c hiá»‡n bá»Ÿi má»™t luá»“ng Ä‘áº·c biá»‡t, Ä‘áº£m báº£o hiá»‡u suáº¥t Ä‘á»§ tá»‘t vÃ  chá»‰ máº¥t dá»¯ liá»‡u trong vÃ²ng má»™t giÃ¢y náº¿u cÃ³ sá»± cá»‘.</li>
</ul>
<p>Lá»±a chá»n cá»§a <code>appendfsync</code> áº£nh hÆ°á»Ÿng Ä‘Ã¡ng ká»ƒ Ä‘áº¿n tÃ­nh báº£o máº­t cá»§a chá»©c nÄƒng bá»n vá»¯ng cá»§a AOF vÃ  hiá»‡u suáº¥t cá»§a mÃ¡y chá»§ Redis.</p>
<h3>Táº£i láº¡i AOF</h3>
<p>AOF (Append Only File) lÃ  má»™t phÆ°Æ¡ng phÃ¡p lÆ°u trá»¯ dá»¯ liá»‡u trong Redis báº±ng cÃ¡ch ghi táº¥t cáº£ cÃ¡c lá»‡nh ghi vÃ o má»™t tá»‡p log. Khi mÃ¡y chá»§ Redis khá»Ÿi Ä‘á»™ng láº¡i sau má»™t sá»± cá»‘ hoáº·c tÃ¡i khá»Ÿi Ä‘á»™ng, AOF Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ¡i táº¡o láº¡i tráº¡ng thÃ¡i cÆ¡ sá»Ÿ dá»¯ liá»‡u trÆ°á»›c khi mÃ¡y chá»§ táº¯t.</p>
<p>QuÃ¡ trÃ¬nh táº£i láº¡i AOF Ä‘Æ°á»£c thá»±c hiá»‡n nhÆ° sau:</p>
<ol>
<li>
<p><strong>Khá»Ÿi Ä‘á»™ng chÆ°Æ¡ng trÃ¬nh táº£i láº¡i cá»§a mÃ¡y chá»§</strong>: Khi Redis báº¯t Ä‘áº§u, nÃ³ khá»Ÿi Ä‘á»™ng má»™t quy trÃ¬nh Ä‘áº·c biá»‡t Ä‘á»ƒ táº£i láº¡i dá»¯ liá»‡u tá»« tá»‡p AOF.</p>
</li>
<li>
<p><strong>Táº¡o má»™t khÃ¡ch hÃ ng giáº£</strong>: Do lá»‡nh Redis chá»‰ cÃ³ thá»ƒ thá»±c thi trong ngá»¯ cáº£nh khÃ¡ch hÃ ng, Redis cáº§n táº¡o ra má»™t khÃ¡ch hÃ ng giáº£ Ä‘á»ƒ thá»±c hiá»‡n vÃ  thá»±c thi cÃ¡c lá»‡nh trong tá»‡p AOF.</p>
</li>
<li>
<p><strong>PhÃ¢n tÃ­ch vÃ  Ä‘á»c lá»‡nh ghi tá»« tá»‡p AOF</strong>: ChÆ°Æ¡ng trÃ¬nh táº£i láº¡i sáº½ báº¯t Ä‘áº§u Ä‘á»c vÃ  phÃ¢n tÃ­ch cÃ¡c lá»‡nh ghi trong tá»‡p AOF. Má»—i lá»‡nh Ä‘Æ°á»£c lÆ°u trong tá»‡p AOF dÆ°á»›i Ä‘á»‹nh dáº¡ng giao thá»©c lá»‡nh Redis.</p>
</li>
<li>
<p><strong>Thá»±c thi lá»‡nh báº±ng khÃ¡ch hÃ ng giáº£</strong>: Sau khi phÃ¢n tÃ­ch, chÆ°Æ¡ng trÃ¬nh táº£i láº¡i sáº½ sá»­ dá»¥ng khÃ¡ch hÃ ng giáº£ Ä‘á»ƒ thá»±c thi má»—i lá»‡nh ghi tá»« tá»‡p AOF. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  Redis sáº½ thá»±c hiá»‡n má»i thay Ä‘á»•i dá»¯ liá»‡u Ä‘Æ°á»£c lÆ°u trong cÃ¡c lá»‡nh ghi nÃ y.</p>
</li>
<li>
<p><strong>Láº·p láº¡i quÃ¡ trÃ¬nh Ä‘á»c vÃ  thá»±c thi lá»‡nh</strong>: QuÃ¡ trÃ¬nh Ä‘á»c vÃ  thá»±c thi lá»‡nh sáº½ tiáº¿p tá»¥c cho Ä‘áº¿n khi táº¥t cáº£ cÃ¡c lá»‡nh ghi tá»« tá»‡p AOF Ä‘Æ°á»£c xá»­ lÃ½ hoÃ n táº¥t.</p>
</li>
<li>
<p><strong>HoÃ n thÃ nh quÃ¡ trÃ¬nh táº£i láº¡i</strong>: Sau khi táº¥t cáº£ cÃ¡c lá»‡nh Ä‘Ã£ Ä‘Æ°á»£c thá»±c thi tá»« tá»‡p AOF, quÃ¡ trÃ¬nh táº£i láº¡i sáº½ káº¿t thÃºc vÃ  Redis sáºµn sÃ ng hoáº¡t Ä‘á»™ng vá»›i dá»¯ liá»‡u Ä‘Æ°á»£c phá»¥c há»“i tá»« tá»‡p AOF.</p>
</li>
</ol>
<h3>Viáº¿t láº¡i AOF</h3>
<p>DÆ°á»›i sá»± hoáº¡t Ä‘á»™ng liÃªn tá»¥c cá»§a Redis, kÃ­ch thÆ°á»›c cá»§a tá»‡p AOF cÅ©ng sáº½ khÃ´ng ngá»«ng tÄƒng lÃªn, Ä‘iá»u nÃ y gÃ¢y ra hai váº¥n Ä‘á» chÃ­nh:</p>
<ul>
<li>AOF cÃ³ thá»ƒ lÃ m Ä‘áº§y khÃ´ng gian lÆ°u trá»¯ trÃªn Ä‘Ä©a.</li>
<li>Khi Redis khá»Ÿi Ä‘á»™ng láº¡i, táº¥t cáº£ cÃ¡c lá»‡nh ghi trong tá»‡p AOF pháº£i Ä‘Æ°á»£c thá»±c thi Ä‘á»ƒ khÃ´i phá»¥c láº¡i táº­p dá»¯ liá»‡u. Náº¿u kÃ­ch thÆ°á»›c cá»§a AOF quÃ¡ lá»›n, thá»i gian Ä‘á»ƒ thá»±c hiá»‡n quÃ¡ trÃ¬nh khÃ´i phá»¥c cÅ©ng sáº½ ráº¥t lÃ¢u.</li>
</ul>
<p>Äá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» vá» kÃ­ch thÆ°á»›c cá»§a tá»‡p AOF phÃ¬nh ra, Redis cung cáº¥p tÃ­nh nÄƒng ghi láº¡i AOF (AOF rewrite) Ä‘á»ƒ nÃ©n tá»‡p AOF. <strong>QuÃ¡ trÃ¬nh ghi láº¡i AOF táº¡o ra má»™t tá»‡p AOF má»›i, tá»‡p nÃ y giá»¯ nguyÃªn tráº¡ng thÃ¡i cÆ¡ sá»Ÿ dá»¯ liá»‡u nhÆ° trong tá»‡p AOF ban Ä‘áº§u, nhÆ°ng kÃ­ch thÆ°á»›c nhá» hÆ¡n</strong>.</p>
<p>QuÃ¡ trÃ¬nh ghi láº¡i AOF khÃ´ng pháº£i lÃ  Ä‘á»c vÃ  phÃ¢n tÃ­ch ná»™i dung cá»§a tá»‡p AOF hiá»‡n táº¡i, mÃ  lÃ  trá»±c tiáº¿p Ä‘á»c tráº¡ng thÃ¡i cÆ¡ sá»Ÿ dá»¯ liá»‡u hiá»‡n táº¡i tá»« Redis. NghÄ©a lÃ  tá»«ng giÃ¡ trá»‹ hiá»‡n táº¡i cá»§a cÃ¡c khÃ³a trong cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘Æ°á»£c Ä‘á»c vÃ  ghi vÃ o tá»‡p má»›i báº±ng má»™t lá»‡nh duy nháº¥t, thay tháº¿ cho nhá»¯ng lá»‡nh cÃ³ thá»ƒ Ä‘Ã£ trÃ¹ng láº·p tá»« trÆ°á»›c.</p>
<h3>AOF Äá»“ng Bá»™ HÃ³a Ná»n</h3>
<p>LÃ  má»™t tÃ­nh nÄƒng há»— trá»£, rÃµ rÃ ng Redis khÃ´ng muá»‘n khi thá»±c hiá»‡n viá»‡c ghi láº¡i AOF lÃ m áº£nh hÆ°á»Ÿng Ä‘áº¿n viá»‡c nháº­n cÃ¡c lá»‡nh Redis dá»‹ch vá»¥ khÃ¡c. Do Ä‘Ã³, Redis quyáº¿t Ä‘á»‹nh sá»­ dá»¥ng lá»‡nh <code>BGREWRITEAOF</code> Ä‘á»ƒ táº¡o má»™t tiáº¿n trÃ¬nh con Ä‘á»ƒ chá»‹u trÃ¡ch nhiá»‡m tÃ¡i viáº¿t tá»‡p AOF, tÆ°Æ¡ng tá»± nhÆ° cÃ¡ch lÃ m cá»§a <code>BGSAVE</code>.</p>
<ul>
<li>Khi thá»±c hiá»‡n lá»‡nh <code>BGREWRITEAOF</code>, mÃ¡y chá»§ Redis duy trÃ¬ má»™t vÃ¹ng Ä‘á»‡m tÃ¡i viáº¿t AOF. Khi tiáº¿n trÃ¬nh con tÃ¡i viáº¿t AOF báº¯t Ä‘áº§u lÃ m viá»‡c, Redis sau má»—i láº§n thá»±c hiá»‡n má»™t lá»‡nh ghi, cáº£ hai gá»­i lá»‡nh nÃ y Ä‘áº¿n vÃ¹ng Ä‘á»‡m ghi AOF vÃ  vÃ¹ng Ä‘á»‡m tÃ¡i viáº¿t AOF.</li>
<li>VÃ¬ tiáº¿n trÃ¬nh con vÃ  tiáº¿n trÃ¬nh chÃ­nh khÃ´ng hoáº¡t Ä‘á»™ng trong cÃ¹ng má»™t tiáº¿n trÃ¬nh, do Ä‘Ã³ quÃ¡ trÃ¬nh tÃ¡i viáº¿t AOF khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n quÃ¡ trÃ¬nh ghi vÃ  Ä‘á»“ng bá»™ hÃ³a AOF. Khi tiáº¿n trÃ¬nh con hoÃ n thÃ nh cÃ´ng viá»‡c táº¡o tá»‡p AOF má»›i, mÃ¡y chá»§ sáº½ thÃªm táº¥t cáº£ ná»™i dung tá»« vÃ¹ng Ä‘á»‡m tÃ¡i viáº¿t vÃ o cuá»‘i tá»‡p AOF má»›i, Ä‘áº£m báº£o ráº±ng tráº¡ng thÃ¡i cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘Æ°á»£c lÆ°u trá»¯ trong hai tá»‡p AOF cÅ© vÃ  má»›i lÃ  nhÆ° nhau.</li>
</ul>
<blockquote>
<p>QuÃ¡ trÃ¬nh thá»±c hiá»‡n lá»‡nh <code>BGREWRITEAOF</code> sá»­ dá»¥ng ká»¹ thuáº­t sao chÃ©p khi ghi (Copy-On-Write, viáº¿t táº¯t lÃ  CoW).</p>
</blockquote>
<p>Báº¡n cÃ³ thá»ƒ thiáº¿t láº­p <code>auto-aof-rewrite-percentage</code> vÃ  <code>auto-aof-rewrite-min-size</code> Ä‘á»ƒ Redis tá»± Ä‘á»™ng thá»±c hiá»‡n <code>BGREWRITEAOF</code> khi Ä‘áº¡t Ä‘iá»u kiá»‡n nháº¥t Ä‘á»‹nh.</p>
<p>VÃ­ dá»¥ cáº¥u hÃ¬nh nhÆ° sau:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>auto-aof-rewrite-percentage 100</span></span>
<span class="line"><span>auto-aof-rewrite-min-size 64mb</span></span></code></pre>
</div><p>Äiá»u nÃ y chá»‰ ra ráº±ng khi AOF lá»›n hÆ¡n <code>64MB</code>, vÃ  kÃ­ch thÆ°á»›c AOF lá»›n hÆ¡n Ã­t nháº¥t <code>100%</code> so vá»›i láº§n tÃ¡i viáº¿t trÆ°á»›c Ä‘Ã³, Redis sáº½ thá»±c hiá»‡n lá»‡nh <code>BGREWRITEAOF</code>.</p>
<h3>Cáº¥u hÃ¬nh AOF</h3>
<p>Cáº¥u hÃ¬nh máº·c Ä‘á»‹nh cá»§a AOF trong Redis:</p>
<div class="language-plaintext" data-ext="plaintext" data-title="plaintext"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>appendonly no</span></span>
<span class="line"><span>appendfsync everysec</span></span>
<span class="line"><span>no-appendfsync-on-rewrite no</span></span>
<span class="line"><span>auto-aof-rewrite-percentage 100</span></span>
<span class="line"><span>auto-aof-rewrite-min-size 64mb</span></span></code></pre>
</div><p>CÃ¡c cÃ i Ä‘áº·t máº·c Ä‘á»‹nh nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c Ä‘iá»u chá»‰nh trong tá»‡p cáº¥u hÃ¬nh Redis (<code>redis.conf</code>). DÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡c tÃ¹y chá»n cáº¥u hÃ¬nh AOF vÃ  Ã½ nghÄ©a cá»§a chÃºng:</p>
<ul>
<li>
<p><strong><code>appendonly</code></strong> - Má»Ÿ tÃ­nh nÄƒng AOF (append-only file). Khi Ä‘Æ°á»£c thiáº¿t láº­p thÃ nh <code>yes</code>, Redis sáº½ báº¯t Ä‘áº§u ghi láº¡i cÃ¡c cÃ¢u lá»‡nh vÃ o tá»‡p AOF Ä‘á»ƒ báº£o vá»‡ dá»¯ liá»‡u khi Redis khá»Ÿi Ä‘á»™ng láº¡i.</p>
</li>
<li>
<p><strong><code>appendfsync</code></strong> - XÃ¡c Ä‘á»‹nh táº§n suáº¥t Ä‘á»“ng bá»™ hÃ³a AOF vá»›i Ä‘Ä©a. CÃ¡c giÃ¡ trá»‹ cÃ³ thá»ƒ lÃ :</p>
<ul>
<li><strong><code>always</code></strong> - Má»—i lá»‡nh ghi vÃ o Redis sáº½ Ä‘Æ°á»£c Ä‘á»“ng bá»™ hÃ³a ngay láº­p tá»©c vá»›i Ä‘Ä©a. Tuy nhiÃªn, Ä‘iá»u nÃ y cÃ³ thá»ƒ lÃ m giáº£m hiá»‡u suáº¥t cá»§a Redis do táº§n suáº¥t ghi Ä‘Ä©a cao.</li>
<li><strong><code>everysec</code></strong> - Redis sáº½ Ä‘á»“ng bá»™ hÃ³a AOF vá»›i Ä‘Ä©a má»—i giÃ¢y má»™t láº§n. ÄÃ¢y lÃ  tÃ¹y chá»n Ä‘Æ°á»£c khuyáº¿n khÃ­ch vÃ¬ nÃ³ cÃ¢n báº±ng giá»¯a hiá»‡u suáº¥t vÃ  an toÃ n dá»¯ liá»‡u. Khi sá»­ dá»¥ng tÃ¹y chá»n nÃ y, Redis sáº½ ghi vÃ o AOF má»™t láº§n má»—i giÃ¢y, giÃºp báº£o vá»‡ dá»¯ liá»‡u mÃ  khÃ´ng áº£nh hÆ°á»Ÿng quÃ¡ nhiá»u Ä‘áº¿n hiá»‡u suáº¥t.</li>
<li><strong><code>no</code></strong> - Há»‡ Ä‘iá»u hÃ nh quyáº¿t Ä‘á»‹nh khi nÃ o cáº§n Ä‘á»“ng bá»™ hÃ³a vá»›i Ä‘Ä©a. ÄÃ¢y lÃ  tÃ¹y chá»n Ã­t an toÃ n vÃ¬ dá»¯ liá»‡u cÃ³ thá»ƒ bá»‹ máº¥t náº¿u há»‡ thá»‘ng gáº·p sá»± cá»‘.</li>
</ul>
</li>
<li>
<p><strong><code>no-appendfsync-on-rewrite</code></strong> - Khi thá»±c hiá»‡n quÃ¡ trÃ¬nh tÃ¡i viáº¿t AOF, Redis sáº½ khÃ´ng Ä‘á»“ng bá»™ hÃ³a AOF vá»›i Ä‘Ä©a Ä‘á»ƒ trÃ¡nh lÃ m giÃ¡n Ä‘oáº¡n hoáº¡t Ä‘á»™ng ghi má»›i. TÃ¹y chá»n nÃ y giÃºp duy trÃ¬ hiá»‡u suáº¥t cao trong khi tÃ¡i viáº¿t AOF.</p>
</li>
<li>
<p><strong><code>auto-aof-rewrite-percentage</code></strong> - Äá»™ lá»›n tá»‡p AOF hiá»‡n táº¡i so vá»›i tá»‡p AOF gáº§n nháº¥t sau khi thá»±c hiá»‡n tÃ¡i viáº¿t. Náº¿u tá»‡p AOF hiá»‡n táº¡i lá»›n hÆ¡n má»©c nÃ y, Redis sáº½ tá»± Ä‘á»™ng thá»±c hiá»‡n tÃ¡i viáº¿t AOF Ä‘á»ƒ nÃ©n tá»‡p AOF. GiÃ¡ trá»‹ máº·c Ä‘á»‹nh lÃ  100%, nghÄ©a lÃ  khi tá»‡p AOF hiá»‡n táº¡i lá»›n hÆ¡n hoáº·c báº±ng tá»‡p tÃ¡i viáº¿t gáº§n Ä‘Ã¢y nháº¥t, Redis sáº½ tÃ¡i viáº¿t AOF.</p>
</li>
<li>
<p><strong><code>auto-aof-rewrite-min-size</code></strong> - KÃ­ch thÆ°á»›c tá»‘i thiá»ƒu mÃ  tá»‡p AOF pháº£i Ä‘áº¡t Ä‘Æ°á»£c Ä‘á»ƒ Redis tá»± Ä‘á»™ng thá»±c hiá»‡n tÃ¡i viáº¿t. GiÃ¡ trá»‹ máº·c Ä‘á»‹nh lÃ  <code>64mb</code>, nghÄ©a lÃ  Redis sáº½ tá»± Ä‘á»™ng tÃ¡i viáº¿t AOF náº¿u kÃ­ch thÆ°á»›c tá»‡p AOF hiá»‡n táº¡i lá»›n hÆ¡n hoáº·c báº±ng <code>64MB</code>.</p>
</li>
<li>
<p><strong><code>dir</code></strong> - ÄÆ°á»ng dáº«n nÆ¡i lÆ°u trá»¯ tá»‡p RDB vÃ  AOF.</p>
</li>
</ul>
<h2>3. RDB vs AOF</h2>
<blockquote>
<p>Khi Redis khá»Ÿi Ä‘á»™ng, náº¿u cáº£ RDB vÃ  AOF Ä‘á»u Ä‘Æ°á»£c kÃ­ch hoáº¡t, chÆ°Æ¡ng trÃ¬nh sáº½ Æ°u tiÃªn sá»­ dá»¥ng táº­p tin AOF Ä‘á»ƒ khÃ´i phá»¥c táº­p dá»¯ liá»‡u, vÃ¬ táº­p tin AOF thÆ°á»ng chá»©a dá»¯ liá»‡u hoÃ n chá»‰nh nháº¥t.</p>
</blockquote>
<h3>Lá»±a chá»n cÆ¡ cháº¿ lÆ°u trá»¯</h3>
<ul>
<li>Náº¿u khÃ´ng quan tÃ¢m Ä‘áº¿n máº¥t dá»¯ liá»‡u, báº¡n cÃ³ thá»ƒ khÃ´ng cáº§n lÆ°u trá»¯.</li>
<li>Náº¿u cháº¥p nháº­n máº¥t dá»¯ liá»‡u trong vÃ i phÃºt, chá»‰ cáº§n sá»­ dá»¥ng RDB.</li>
<li>Náº¿u khÃ´ng thá»ƒ cháº¥p nháº­n máº¥t dá»¯ liá»‡u trong vÃ i phÃºt, hÃ£y sá»­ dá»¥ng cáº£ RDB vÃ  AOF.</li>
</ul>
<p>Nhiá»u ngÆ°á»i dÃ¹ng chá»‰ sá»­ dá»¥ng AOF cho lÆ°u trá»¯, nhÆ°ng Ä‘iá»u nÃ y khÃ´ng Ä‘Æ°á»£c khuyáº¿n khÃ­ch vÃ¬ viá»‡c táº¡o snapshot RDB Ä‘á»‹nh ká»³ ráº¥t thuáº­n tiá»‡n cho sao lÆ°u cÆ¡ sá»Ÿ dá»¯ liá»‡u vÃ  khÃ´i phá»¥c nhanh chÃ³ng hÆ¡n so vá»›i AOF. NgoÃ i ra, viá»‡c sá»­ dá»¥ng snapshot cÅ©ng giÃºp trÃ¡nh Ä‘Æ°á»£c nhá»¯ng lá»—i chÆ°Æ¡ng trÃ¬nh cá»§a AOF.</p>
<h3>Chuyá»ƒn tá»« RDB sang AOF</h3>
<p>Trong Redis phiÃªn báº£n 2.2 trá»Ÿ lÃªn, báº¡n cÃ³ thá»ƒ chuyá»ƒn tá»« RDB sang AOF mÃ  khÃ´ng cáº§n khá»Ÿi Ä‘á»™ng láº¡i Redis:</p>
<ul>
<li>Sao lÆ°u tá»‡p dump.rdb má»›i nháº¥t.</li>
<li>Äáº·t sao lÆ°u vÃ o má»™t vá»‹ trÃ­ an toÃ n.</li>
<li>Thá»±c hiá»‡n hai lá»‡nh sau:
<ul>
<li>redis-cli config set appendonly yes</li>
<li>redis-cli config set save</li>
</ul>
</li>
<li>Äáº£m báº£o ráº±ng cÃ¡c lá»‡nh ghi sáº½ Ä‘Æ°á»£c ghi Ä‘Ãºng vÃ o cuá»‘i tá»‡p AOF.</li>
<li>Lá»‡nh Ä‘áº§u tiÃªn Ä‘Æ°á»£c thá»±c hiá»‡n Ä‘á»ƒ báº­t chá»©c nÄƒng AOF: Redis sáº½ cháº·n cho Ä‘áº¿n khi tá»‡p AOF ban Ä‘áº§u Ä‘Æ°á»£c táº¡o xong, sau Ä‘Ã³ Redis sáº½ tiáº¿p tá»¥c xá»­ lÃ½ cÃ¡c yÃªu cáº§u lá»‡nh vÃ  báº¯t Ä‘áº§u ghi cÃ¡c lá»‡nh ghi vÃ o cuá»‘i tá»‡p AOF.</li>
</ul>
<p>Lá»‡nh thá»© hai Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ táº¯t chá»©c nÄƒng snapshot. BÆ°á»›c nÃ y lÃ  tÃ¹y chá»n, náº¿u báº¡n muá»‘n, báº¡n cÅ©ng cÃ³ thá»ƒ sá»­ dá»¥ng cáº£ snapshot vÃ  AOF cÃ¹ng má»™t lÃºc.</p>
<blockquote>
<p>ğŸ”” Quan trá»ng: Äá»«ng quÃªn má»Ÿ chá»©c nÄƒng AOF trong <code>redis.conf</code>! Náº¿u khÃ´ng, sau khi khá»Ÿi Ä‘á»™ng láº¡i mÃ¡y chá»§, cÃ¡c cáº¥u hÃ¬nh Ä‘Æ°á»£c thiáº¿t láº­p trÆ°á»›c Ä‘Ã³ thÃ´ng qua CONFIG SET sáº½ bá»‹ máº¥t vÃ  chÆ°Æ¡ng trÃ¬nh sáº½ khá»Ÿi Ä‘á»™ng mÃ¡y chá»§ theo cáº¥u hÃ¬nh ban Ä‘áº§u.</p>
</blockquote>
<h3>TÆ°Æ¡ng tÃ¡c giá»¯a AOF vÃ  RDB</h3>
<p>Lá»‡nh&nbsp;<code>BGSAVE</code>&nbsp;vÃ &nbsp;<code>BGREWRITEAOF</code>&nbsp;khÃ´ng thá»ƒ Ä‘Æ°á»£c thá»±c thi cÃ¹ng lÃºc. Äiá»u nÃ y nháº±m trÃ¡nh hai tiáº¿n trÃ¬nh Redis ná»n cÃ¹ng thá»±c hiá»‡n nhiá»u hoáº¡t Ä‘á»™ng I/O trÃªn Ä‘Ä©a cÃ¹ng má»™t lÃºc.</p>
<p>Náº¿u lá»‡nh&nbsp;<code>BGSAVE</code>&nbsp;Ä‘ang Ä‘Æ°á»£c thá»±c thi vÃ  ngÆ°á»i dÃ¹ng gá»i lá»‡nh&nbsp;<code>BGREWRITEAOF</code>&nbsp;má»™t cÃ¡ch rÃµ rÃ ng, mÃ¡y chá»§ sáº½ tráº£ lá»i ngÆ°á»i dÃ¹ng vá»›i tráº¡ng thÃ¡i OK vÃ  thÃ´ng bÃ¡o ráº±ng&nbsp;<code>BGREWRITEAOF</code>&nbsp;Ä‘Ã£ Ä‘Æ°á»£c Ä‘áº·t lá»‹ch Ä‘á»ƒ thá»±c thi. Sau khi&nbsp;<code>BGSAVE</code>&nbsp;hoÃ n thÃ nh,&nbsp;<code>BGREWRITEAOF</code>&nbsp;sáº½ báº¯t Ä‘áº§u chÃ­nh thá»©c.</p>
<h3>LÆ°u trá»¯ káº¿t há»£p</h3>
<p>Redis 4.0 Ä‘Æ°a ra <strong>lÆ°u trá»¯ káº¿t há»£p AOF vÃ  snapshot trong bá»™ nhá»›</strong>, hay cÃ²n gá»i lÃ  lÆ°u trá»¯ káº¿t há»£p, Ä‘á»ƒ cÃ¢n báº±ng tá»‘c Ä‘á»™ khá»Ÿi Ä‘á»™ng láº¡i Redis vÃ  giáº£m rá»§i ro máº¥t dá»¯ liá»‡u.</p>
<p>Trong lÆ°u trá»¯ káº¿t há»£p, trong quÃ¡ trÃ¬nh tÃ¡i viáº¿t AOF, tiáº¿n trÃ¬nh con tÃ¡i viáº¿t sáº½ Ä‘áº§u tiÃªn ghi dá»¯ liá»‡u bá»™ nhá»› chia sáº» vá»›i tiáº¿n trÃ¬nh chÃ­nh dÆ°á»›i dáº¡ng snapshot RDB vÃ o tá»‡p AOF. Sau Ä‘Ã³, cÃ¡c lá»‡nh hoáº¡t Ä‘á»™ng Ä‘Æ°á»£c ghi trong bá»™ Ä‘á»‡m tÃ¡i viáº¿t sáº½ Ä‘Æ°á»£c ghi vÃ o tá»‡p AOF dÆ°á»›i dáº¡ng tÄƒng dáº§n AOF. Khi viá»‡c ghi káº¿t thÃºc, tiáº¿n trÃ¬nh chÃ­nh sáº½ thay tháº¿ tá»‡p AOF cÅ© báº±ng tá»‡p AOF má»›i cÃ³ Ä‘á»‹nh dáº¡ng RDB vÃ  AOF.</p>
<p>NÃ³i cÃ¡ch khÃ¡c, khi sá»­ dá»¥ng lÆ°u trá»¯ káº¿t há»£p, <strong>pháº§n Ä‘áº§u cá»§a tá»‡p AOF lÃ  dá»¯ liá»‡u Ä‘áº§y Ä‘á»§ Ä‘á»‹nh dáº¡ng RDB vÃ  pháº§n cuá»‘i cÃ¹ng lÃ  dá»¯ liá»‡u tÄƒng dáº§n Ä‘á»‹nh dáº¡ng AOF</strong>.</p>
<h2>4. Sao lÆ°u Redis</h2>
<p>Äáº£m báº£o ráº±ng dá»¯ liá»‡u Redis Ä‘Æ°á»£c sao lÆ°u Ä‘áº§y Ä‘á»§ lÃ  ráº¥t quan trá»ng.</p>
<h3>Lá»i khuyÃªn vá» sao lÆ°u</h3>
<p>Äá» xuáº¥t sá»­ dá»¥ng RDB Ä‘á»ƒ sao lÆ°u dá»¯ liá»‡u Redis.</p>
<h3>Quy trÃ¬nh sao lÆ°u</h3>
<ol>
<li>
<p><strong>Thiáº¿t láº­p cÃ´ng viá»‡c Ä‘á»‹nh ká»³ (cron job)</strong>: Táº¡o má»™t cÃ´ng viá»‡c Ä‘á»‹nh ká»³, sao lÆ°u má»™t táº­p tin RDB vÃ o má»™t thÆ° má»¥c má»—i giá» vÃ  sao lÆ°u má»™t táº­p tin RDB vÃ o má»™t thÆ° má»¥c khÃ¡c má»—i ngÃ y.</p>
</li>
<li>
<p><strong>Giá»¯ láº¡i sao lÆ°u vÃ  thÃªm dáº¥u thá»i gian</strong>: Äáº£m báº£o ráº±ng cÃ¡c táº­p tin sao lÆ°u chá»©a thÃ´ng tin vá» ngÃ y vÃ  giá» tÆ°Æ¡ng á»©ng. Khi thá»±c hiá»‡n cÃ´ng viá»‡c Ä‘á»‹nh ká»³, sá»­ dá»¥ng lá»‡nh <code>find</code> Ä‘á»ƒ xÃ³a cÃ¡c báº£n sao lÆ°u cÅ©. VÃ­ dá»¥, cÃ³ thá»ƒ giá»¯ láº¡i cÃ¡c báº£n sao lÆ°u má»—i giá» trong vÃ²ng 48 giá» qua vÃ  giá»¯ láº¡i cÃ¡c báº£n sao lÆ°u má»—i ngÃ y trong vÃ²ng má»™t Ä‘áº¿n hai thÃ¡ng qua.</p>
</li>
<li>
<p><strong>Sao lÆ°u ngoáº¡i tuyáº¿n</strong>: Ãt nháº¥t má»—i ngÃ y má»™t láº§n, sao lÆ°u RDB ra khá»i trung tÃ¢m dá»¯ liá»‡u hoáº·c Ã­t nháº¥t lÃ  sao lÆ°u ra khá»i mÃ¡y chá»§ váº­t lÃ½ Ä‘ang cháº¡y Redis.</p>
</li>
</ol>
<h3>Sao lÆ°u phÃ²ng chá»‘ng tháº£m há»a</h3>
<p>Sao lÆ°u phÃ²ng chá»‘ng tháº£m há»a Redis chá»§ yáº¿u lÃ  sao lÆ°u dá»¯ liá»‡u vÃ  truyá»n sao lÆ°u Ä‘Ã³ Ä‘áº¿n nhiá»u trung tÃ¢m dá»¯ liá»‡u bÃªn ngoÃ i khÃ¡c nhau.</p>
<p>Sao lÆ°u phÃ²ng chá»‘ng tháº£m há»a cho phÃ©p dá»¯ liá»‡u váº«n an toÃ n khi trung tÃ¢m dá»¯ liá»‡u chÃ­nh sáº£n xuáº¥t váº¥n Ä‘á» nghiÃªm trá»ng.</p>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/redis-rdb-structure.png" type="image/png"/>
    </item>
    <item>
      <title>Redis Pipeline</title>
      <link>https://vanhung4499.github.io/database/redis/pipeline.html</link>
      <guid>https://vanhung4499.github.io/database/redis/pipeline.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Redis Pipeline</source>
      <description>Redis Pipeline Giá»›i thiá»‡u vá» Pipeline trong Redis Redis lÃ  má»™t dá»‹ch vá»¥ TCP dá»±a trÃªn mÃ´ hÃ¬nh Client/Server vÃ  giao thá»©c yÃªu cáº§u/Ä‘Ã¡p á»©ng. ThÃ´ng thÆ°á»ng, quÃ¡ trÃ¬nh yÃªu cáº§u vÃ  Ä‘Ã¡p á»©n...</description>
      <category>redis</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>Giá»›i thiá»‡u vá» Pipeline trong Redis</h2>
<p>Redis lÃ  má»™t dá»‹ch vá»¥ TCP dá»±a trÃªn mÃ´ hÃ¬nh Client/Server vÃ  giao thá»©c yÃªu cáº§u/Ä‘Ã¡p á»©ng. ThÃ´ng thÆ°á»ng, quÃ¡ trÃ¬nh yÃªu cáº§u vÃ  Ä‘Ã¡p á»©ng cá»§a má»—i lá»‡nh Redis diá»…n ra nhÆ° sau:</p>
<ul>
<li>KhÃ¡ch hÃ ng gá»­i yÃªu cáº§u truy váº¥n Ä‘áº¿n mÃ¡y chá»§ vÃ  láº¯ng nghe Socket Ä‘á»ƒ nháº­n pháº£n há»“i tá»« mÃ¡y chá»§ (thÆ°á»ng lÃ  á»Ÿ cháº¿ Ä‘á»™ cháº·n, chá» mÃ¡y chá»§ pháº£n há»“i).</li>
<li>MÃ¡y chá»§ xá»­ lÃ½ lá»‡nh vÃ  gá»­i káº¿t quáº£ tráº£ vá» cho khÃ¡ch hÃ ng.</li>
</ul>
<p>RÃµ rÃ ng, náº¿u má»—i lá»‡nh Redis pháº£i gá»­i yÃªu cáº§u vÃ  nháº­n pháº£n há»“i má»™t láº§n thÃ¬ sáº½ ráº¥t khÃ´ng hiá»‡u quáº£. Do Ä‘Ã³, Redis cung cáº¥p má»™t ká»¹ thuáº­t xá»­ lÃ½ hÃ ng loáº¡t, gá»i lÃ  <strong>Pipeline (ÄÆ°á»ng á»‘ng)</strong>. NguyÃªn lÃ½ hoáº¡t Ä‘á»™ng cá»§a Pipeline lÃ :</p>
<p><strong>Gá»­i Ä‘á»“ng thá»i nhiá»u lá»‡nh Redis Ä‘áº¿n mÃ¡y chá»§, mÃ¡y chá»§ xá»­ lÃ½ vÃ  tráº£ vá» táº¥t cáº£ káº¿t quáº£ má»™t láº§n cho khÃ¡ch hÃ ng.</strong> Nhá» vÃ o viá»‡c giáº£m sá»‘ láº§n giao tiáº¿p máº¡ng, Pipeline giÃºp cáº£i thiá»‡n Ä‘Ã¡ng ká»ƒ hiá»‡u suáº¥t xá»­ lÃ½.</p>
<figure><img src="https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/7268887661/p514690.jpg" alt="Redis Pipeline" tabindex="0" loading="lazy"><figcaption>Redis Pipeline</figcaption></figure>
<h2>Giá»›i háº¡n cá»§a Pipeline trong Redis</h2>
<p>Khi sá»­ dá»¥ng cÃ´ng nghá»‡ Pipeline trong Redis, cáº§n lÆ°u Ã½ nhá»¯ng giá»›i háº¡n sau Ä‘á»ƒ trÃ¡nh gáº·p pháº£i cÃ¡c váº¥n Ä‘á» khÃ´ng mong muá»‘n:</p>
<ul>
<li>
<p><strong>Pipeline khÃ´ng Ä‘áº£m báº£o tÃ­nh nguyÃªn tá»­</strong> - Pipeline chá»‰ lÃ  cÃ¡ch thá»©c cho phÃ©p khÃ¡ch hÃ ng gá»­i nhiá»u lá»‡nh cÃ¹ng lÃºc Ä‘áº¿n mÃ¡y chá»§, nhÆ°ng mÃ¡y chá»§ nháº­n Ä‘Æ°á»£c cÃ¡c lá»‡nh tá»« Pipeline sáº½ phÃ¢n tÃ­ch thÃ nh tá»«ng lá»‡nh riÃªng láº» vÃ  thá»±c thi chÃºng theo thá»© tá»± tuáº§n tá»±. Trong quÃ¡ trÃ¬nh thá»±c thi, mÃ¡y chá»§ cÃ³ thá»ƒ thá»±c hiá»‡n cÃ¡c lá»‡nh cá»§a cÃ¡c khÃ¡ch hÃ ng khÃ¡c, do Ä‘Ã³ khÃ´ng thá»ƒ Ä‘áº£m báº£o tÃ­nh nguyÃªn tá»­. Äá»ƒ Ä‘áº£m báº£o tÃ­nh nguyÃªn tá»­, báº¡n nÃªn sá»­ dá»¥ng giao dá»‹ch (transaction) hoáº·c ká»‹ch báº£n Lua.</p>
</li>
<li>
<p><strong>Pipeline khÃ´ng há»— trá»£ viá»‡c lÄƒn ngÆ°á»£c (rollback)</strong> - Pipeline khÃ´ng cÃ³ tÃ­nh nÄƒng giao dá»‹ch, vÃ¬ váº­y náº¿u cÃ¡c lá»‡nh trong Pipeline cÃ³ sá»± phá»¥ thuá»™c vÃ o nhau, báº¡n khÃ´ng nÃªn sá»­ dá»¥ng Pipeline.</p>
</li>
<li>
<p><strong>KhÃ´ng nÃªn gá»­i quÃ¡ nhiá»u lá»‡nh trong má»™t láº§n báº±ng Pipeline</strong> - Khi sá»­ dá»¥ng Pipeline Ä‘á»ƒ gá»­i lá»‡nh, Redis Server sáº½ Ä‘áº·t má»™t pháº§n yÃªu cáº§u vÃ o hÃ ng Ä‘á»£i bá»™ nhá»› Ä‘á»‡m vÃ  gá»­i káº¿t quáº£ má»™t láº§n sau khi thá»±c thi xong. Náº¿u gá»­i quÃ¡ nhiá»u lá»‡nh, sáº½ tá»‘n nhiá»u bá»™ nhá»›, do Ä‘Ã³ nÃªn chia thÃ nh cÃ¡c lÃ´ lá»‡nh há»£p lÃ½ Ä‘á»ƒ xá»­ lÃ½.</p>
</li>
<li>
<p><strong>Pipeline khÃ´ng há»— trá»£ truy cáº­p qua nhiá»u slot</strong> - Do Pipeline khÃ´ng há»— trá»£ truy cáº­p qua nhiá»u slot, nÃªn khi sá»­ dá»¥ng Redis Cluster vÃ  Pipeline, báº¡n cáº§n Ä‘áº£m báº£o ráº±ng cÃ¡c khÃ³a truy cáº­p Ä‘á»u thuá»™c cÃ¹ng má»™t slot.</p>
</li>
</ul>
<h2>VÃ­ dá»¥ pipeline</h2>
<p>CÃ¡c Redis Client chÃ­nh thá»‘ng thÆ°á»ng há»— trá»£ cÃ´ng nghá»‡ pipeline.</p>
<p>ÄÃ¢y lÃ  má»™t vÃ­ dá»¥ vá» viá»‡c sá»­ dá»¥ng pipeline trong Jedis Ä‘á»ƒ tÆ°Æ¡ng tÃ¡c vá»›i Redis:</p>
<div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">public</span><span style="color:#C678DD;--shiki-dark:#C678DD"> class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B"> Demo</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    public</span><span style="color:#C678DD;--shiki-dark:#C678DD"> static</span><span style="color:#C678DD;--shiki-dark:#C678DD"> void</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> main</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">String</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">[] </span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic">args</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">        String</span><span style="color:#E06C75;--shiki-dark:#E06C75"> host</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> =</span><span style="color:#98C379;--shiki-dark:#98C379"> "localhost"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">        int</span><span style="color:#E06C75;--shiki-dark:#E06C75"> port</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">        Jedis</span><span style="color:#E06C75;--shiki-dark:#E06C75"> jedis</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> =</span><span style="color:#C678DD;--shiki-dark:#C678DD"> new</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> Jedis</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(host, port);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">        String</span><span style="color:#E06C75;--shiki-dark:#E06C75"> key</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> =</span><span style="color:#98C379;--shiki-dark:#98C379"> "pipeline:test"</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">        jedis</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">del</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(key);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">        //</span></span></code></pre>
</div>]]></content:encoded>
      <enclosure url="https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/7268887661/p514690.jpg" type="image/jpeg"/>
    </item>
    <item>
      <title>Redis Publish and Subcribe</title>
      <link>https://vanhung4499.github.io/database/redis/pub-sub.html</link>
      <guid>https://vanhung4499.github.io/database/redis/pub-sub.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Redis Publish and Subcribe</source>
      <description>Redis Pub/Sub Redis Pub/Sub (PhÃ¡t hÃ nh/ÄÄƒng kÃ½) lÃ  má»™t mÃ´ hÃ¬nh truyá»n thÃ´ng tin: ngÆ°á»i gá»­i (pub) gá»­i thÃ´ng bÃ¡o, ngÆ°á»i nháº­n (sub) nháº­n thÃ´ng bÃ¡o. KhÃ¡ch hÃ ng Redis cÃ³ thá»ƒ Ä‘Äƒng kÃ½ ...</description>
      <category>redis</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>Redis Pub/Sub (PhÃ¡t hÃ nh/ÄÄƒng kÃ½) lÃ  má»™t mÃ´ hÃ¬nh truyá»n thÃ´ng tin: ngÆ°á»i gá»­i (pub) gá»­i thÃ´ng bÃ¡o, ngÆ°á»i nháº­n (sub) nháº­n thÃ´ng bÃ¡o. KhÃ¡ch hÃ ng Redis cÃ³ thá»ƒ Ä‘Äƒng kÃ½ báº¥t ká»³ sá»‘ lÆ°á»£ng kÃªnh nÃ o.</p>
<p>Redis cÃ³ hai cháº¿ Ä‘á»™ phÃ¡t hÃ nh/Ä‘Äƒng kÃ½:</p>
<ul>
<li>PhÃ¡t hÃ nh/Ä‘Äƒng kÃ½ dá»±a trÃªn kÃªnh (Channel-based)</li>
<li>PhÃ¡t hÃ nh/Ä‘Äƒng kÃ½ dá»±a trÃªn máº«u (Pattern-based)</li>
</ul>
</blockquote>
<h2>MÃ´ hÃ¬nh quan sÃ¡t viÃªn</h2>
<p>Redis Pub/Sub Ã¡p dá»¥ng mÃ´ hÃ¬nh thiáº¿t káº¿ kinh Ä‘iá»ƒn "mÃ´ hÃ¬nh quan sÃ¡t viÃªn" trong thiáº¿t káº¿ pháº§n má»m.</p>
<p><strong>MÃ´ hÃ¬nh quan sÃ¡t viÃªn</strong> (Observer) lÃ  má»™t mÃ´ hÃ¬nh thiáº¿t káº¿ hÃ nh vi, cho phÃ©p báº¡n Ä‘á»‹nh nghÄ©a má»™t cÆ¡ cháº¿ Ä‘Äƒng kÃ½ Ä‘á»ƒ thÃ´ng bÃ¡o cho nhiá»u Ä‘á»‘i tÆ°á»£ng khÃ¡c khi cÃ³ sá»± kiá»‡n xáº£y ra vá»›i Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c quan sÃ¡t.</p>
<ul>
<li>MÃ´ hÃ¬nh nÃ y Ä‘Æ°á»£c sá»­ dá»¥ng khi thay Ä‘á»•i tráº¡ng thÃ¡i cá»§a má»™t Ä‘á»‘i tÆ°á»£ng cáº§n thay Ä‘á»•i cÃ¡c Ä‘á»‘i tÆ°á»£ng khÃ¡c, hoáº·c cÃ¡c Ä‘á»‘i tÆ°á»£ng thá»±c táº¿ chÆ°a biáº¿t trÆ°á»›c hoáº·c thay Ä‘á»•i Ä‘á»™ng.</li>
<li>MÃ´ hÃ¬nh nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng khi má»™t sá»‘ Ä‘á»‘i tÆ°á»£ng trong á»©ng dá»¥ng pháº£i quan sÃ¡t cÃ¡c Ä‘á»‘i tÆ°á»£ng khÃ¡c, nhÆ°ng chá»‰ trong má»™t thá»i gian giá»›i háº¡n hoáº·c trong nhá»¯ng tÃ¬nh huá»‘ng cá»¥ thá»ƒ.</li>
</ul>
<figure><img src="https://d1.awsstatic.com/product-marketing/Messaging/sns_img_topic.e024462ec88e79ed63d690a2eed6e050e33fb36f.png" alt="MÃ´ hÃ¬nh quan sÃ¡t viÃªn" tabindex="0" loading="lazy"><figcaption>MÃ´ hÃ¬nh quan sÃ¡t viÃªn</figcaption></figure>
<h2>Cháº¿ Ä‘á»™ Ä‘Äƒng kÃ½ cá»§a Redis</h2>
<p>Redis cÃ³ hai cháº¿ Ä‘á»™ phÃ¡t hÃ nh/Ä‘Äƒng kÃ½:</p>
<ol>
<li><strong>PhÃ¡t hÃ nh/ÄÄƒng kÃ½ dá»±a trÃªn kÃªnh (Channel-based Pub/Sub)</strong></li>
</ol>
<p>Tráº¡ng thÃ¡i mÃ¡y chá»§ trong Redis lÆ°u giá»¯ má»‘i quan há»‡ Ä‘Äƒng kÃ½ cá»§a táº¥t cáº£ cÃ¡c kÃªnh trong tá»« Ä‘iá»ƒn <code>pubsub_channels</code>: Lá»‡nh <code>SUBSCRIBE</code> chá»‹u trÃ¡ch nhiá»‡m liÃªn káº¿t khÃ¡ch hÃ ng vá»›i kÃªnh Ä‘Ã£ Ä‘Äƒng kÃ½ trong tá»« Ä‘iá»ƒn nÃ y, vÃ  lá»‡nh <code>UNSUBSCRIBE</code> thÃ¬ chá»‹u trÃ¡ch nhiá»‡m há»§y liÃªn káº¿t giá»¯a khÃ¡ch hÃ ng vÃ  kÃªnh Ä‘Ã£ há»§y Ä‘Äƒng kÃ½.</p>
<h3>VÃ­ dá»¥: ÄÄƒng kÃ½ kÃªnh cá»¥ thá»ƒ</h3>
<p>Má»Ÿ khÃ¡ch hÃ ng thá»© nháº¥t vÃ  thá»±c hiá»‡n cÃ¡c lá»‡nh sau:</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&gt; SUBSCRIBE first second</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">Reading</span><span style="color:#98C379;--shiki-dark:#98C379"> messages...</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> (press </span><span style="color:#98C379;--shiki-dark:#98C379">Ctrl-C</span><span style="color:#98C379;--shiki-dark:#98C379"> to</span><span style="color:#98C379;--shiki-dark:#98C379"> quit</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#98C379;--shiki-dark:#98C379">"subscribe"</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#98C379;--shiki-dark:#98C379">"first"</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) (</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) 1</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#98C379;--shiki-dark:#98C379">"subscribe"</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#98C379;--shiki-dark:#98C379">"second"</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) (</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) 2</span></span></code></pre>
</div><p>Má»Ÿ khÃ¡ch hÃ ng thá»© hai vÃ  thá»±c hiá»‡n lá»‡nh sau:</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&gt; PUBLISH second Hello</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#98C379;--shiki-dark:#98C379">"1"</span></span></code></pre>
</div><p>LÃºc nÃ y, khÃ¡ch hÃ ng thá»© nháº¥t sáº½ nháº­n Ä‘Æ°á»£c thÃ´ng bÃ¡o sau:</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#98C379;--shiki-dark:#98C379">"message"</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#98C379;--shiki-dark:#98C379">"second"</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#98C379;--shiki-dark:#98C379">"Hello"</span></span></code></pre>
</div><ol start="2">
<li><strong>PhÃ¡t hÃ nh/ÄÄƒng kÃ½ dá»±a trÃªn máº«u (Pattern-based Pub/Sub)</strong></li>
</ol>
<p>Tráº¡ng thÃ¡i mÃ¡y chá»§ trong Redis lÆ°u giá»¯ má»‘i quan há»‡ Ä‘Äƒng kÃ½ cá»§a táº¥t cáº£ cÃ¡c máº«u trong danh sÃ¡ch <code>pubsub_patterns</code>: Lá»‡nh <code>PSUBSCRIBE</code> chá»‹u trÃ¡ch nhiá»‡m ghi láº¡i khÃ¡ch hÃ ng vÃ  máº«u Ä‘Ã£ Ä‘Äƒng kÃ½ trong danh sÃ¡ch nÃ y, vÃ  lá»‡nh <code>PUNSUBSCRIBE</code> thÃ¬ chá»‹u trÃ¡ch nhiá»‡m loáº¡i bá» ghi chÃ©p cá»§a khÃ¡ch hÃ ng vÃ  máº«u Ä‘Ã£ há»§y Ä‘Äƒng kÃ½ khá»i danh sÃ¡ch.</p>
<h3>VÃ­ dá»¥: ÄÄƒng kÃ½ cÃ¡c kÃªnh phÃ¹ há»£p vá»›i máº«u cá»¥ thá»ƒ</h3>
<p>Má»Ÿ khÃ¡ch hÃ ng thá»© nháº¥t vÃ  thá»±c hiá»‡n cÃ¡c lá»‡nh sau:</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&gt; PSUBSCRIBE news.*</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">Reading</span><span style="color:#98C379;--shiki-dark:#98C379"> messages...</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> (press </span><span style="color:#98C379;--shiki-dark:#98C379">Ctrl-C</span><span style="color:#98C379;--shiki-dark:#98C379"> to</span><span style="color:#98C379;--shiki-dark:#98C379"> quit</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#98C379;--shiki-dark:#98C379">"psubscribe"</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#98C379;--shiki-dark:#98C379">"news.*"</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) (</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) 1</span></span></code></pre>
</div><p>Má»Ÿ khÃ¡ch hÃ ng thá»© hai vÃ  thá»±c hiá»‡n lá»‡nh sau:</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&gt; PUBLISH news.A Hello</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#98C379;--shiki-dark:#98C379">"1"</span></span></code></pre>
</div><p>Má»Ÿ khÃ¡ch hÃ ng thá»© ba vÃ  thá»±c hiá»‡n lá»‡nh sau:</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&gt; PUBLISH news.B World</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#98C379;--shiki-dark:#98C379">"1"</span></span></code></pre>
</div><p>LÃºc nÃ y, khÃ¡ch hÃ ng thá»© nháº¥t sáº½ nháº­n Ä‘Æ°á»£c cÃ¡c thÃ´ng bÃ¡o sau:</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#98C379;--shiki-dark:#98C379">"pmessage"</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#98C379;--shiki-dark:#98C379">"news.*"</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#98C379;--shiki-dark:#98C379">"news.A"</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#98C379;--shiki-dark:#98C379">"Hello"</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#98C379;--shiki-dark:#98C379">"pmessage"</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#98C379;--shiki-dark:#98C379">"news.*"</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#98C379;--shiki-dark:#98C379">"news.B"</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#98C379;--shiki-dark:#98C379">"World"</span></span></code></pre>
</div><h2>CÃ¡c lá»‡nh PhÃ¡t hÃ nh/ÄÄƒng kÃ½</h2>
<p>Redis cung cáº¥p cÃ¡c lá»‡nh sau liÃªn quan Ä‘áº¿n phÃ¡t hÃ nh/Ä‘Äƒng kÃ½:</p>
<p>| Lá»‡nh                                                     | MÃ´ táº£                       |<br>
|</p>
]]></content:encoded>
      <enclosure url="https://d1.awsstatic.com/product-marketing/Messaging/sns_img_topic.e024462ec88e79ed63d690a2eed6e050e33fb36f.png" type="image/png"/>
    </item>
    <item>
      <title>Redis Replication</title>
      <link>https://vanhung4499.github.io/database/redis/replication.html</link>
      <guid>https://vanhung4499.github.io/database/redis/replication.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Redis Replication</source>
      <description>Redis Replication Trong Redis, cÃ³ thá»ƒ sá»­ dá»¥ng lá»‡nh SLAVEOF hoáº·c cÃ i Ä‘áº·t tÃ¹y chá»n slaveof Ä‘á»ƒ sao chÃ©p (replicate) má»™t mÃ¡y chá»§ tá»« má»™t mÃ¡y chá»§ khÃ¡c, trong Ä‘Ã³ mÃ¡y chá»§ sau Ä‘Æ°á»£c gá»i l...</description>
      <category>redis</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>Trong Redis,&nbsp;<strong>cÃ³ thá»ƒ sá»­ dá»¥ng lá»‡nh&nbsp;<code>SLAVEOF</code>&nbsp;hoáº·c cÃ i Ä‘áº·t tÃ¹y chá»n&nbsp;<code>slaveof</code>&nbsp;Ä‘á»ƒ sao chÃ©p (replicate) má»™t mÃ¡y chá»§ tá»« má»™t mÃ¡y chá»§ khÃ¡c</strong>, trong Ä‘Ã³ mÃ¡y chá»§ sau Ä‘Æ°á»£c gá»i lÃ  mÃ¡y chá»§ chÃ­nh (master) vÃ  mÃ¡y chá»§ trÆ°á»›c Ä‘Æ°á»£c gá»i lÃ  mÃ¡y chá»§ phá»¥ (slave).</p>
<p>Sao chÃ©p Redis trÆ°á»›c phiÃªn báº£n 2.8 khÃ´ng xá»­ lÃ½ hiá»‡u quáº£ viá»‡c sao chÃ©p láº¡i sau khi máº¥t káº¿t ná»‘i, vÃ  má»™t sá»‘ cáº­p nháº­t sau Ä‘Ã³ cá»§a Redis Ä‘Ã£ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y.</p>
</blockquote>
<h2>1. Giá»›i thiá»‡u vá» sao chÃ©p</h2>
<p>Redis sá»­ dá»¥ng lá»‡nh&nbsp;<code>slaveof host port</code>&nbsp;Ä‘á»ƒ biáº¿n má»™t mÃ¡y chá»§ thÃ nh mÃ¡y chá»§ phá»¥ (slave) cá»§a má»™t mÃ¡y chá»§ khÃ¡c (master).</p>
<p><strong>Má»™t mÃ¡y chá»§ chÃ­nh (master) cÃ³ thá»ƒ cÃ³ nhiá»u mÃ¡y chá»§ phá»¥ (slave)</strong>. KhÃ´ng chá»‰ mÃ¡y chá»§ chÃ­nh cÃ³ thá»ƒ cÃ³ mÃ¡y chá»§ phá»¥, mÃ  mÃ¡y chá»§ phá»¥ cÅ©ng cÃ³ thá»ƒ cÃ³ mÃ¡y chá»§ phá»¥ riÃªng cá»§a mÃ¬nh, vÃ  nhiá»u mÃ¡y chá»§ phá»¥ cÃ³ thá»ƒ táº¡o thÃ nh má»™t chuá»—i chÃ­nh-phá»¥.</p>
<p><strong>Má»™t mÃ¡y chá»§ chá»‰ cÃ³ thá»ƒ cÃ³ má»™t mÃ¡y chá»§ chÃ­nh vÃ  khÃ´ng há»— trá»£ sao chÃ©p giá»¯a cÃ¡c mÃ¡y chá»§ chÃ­nh.</strong>.</p>
<p>CÃ³ thá»ƒ sá»­ dá»¥ng chá»©c nÄƒng sao chÃ©p Ä‘á»ƒ giÃºp mÃ¡y chá»§ chÃ­nh khÃ´ng cáº§n thá»±c hiá»‡n hoáº¡t Ä‘á»™ng bá»n vá»¯ng: Chá»‰ cáº§n táº¯t chá»©c nÄƒng bá»n vá»¯ng trÃªn mÃ¡y chá»§ chÃ­nh, sau Ä‘Ã³ cho phÃ©p mÃ¡y chá»§ phá»¥ thá»±c hiá»‡n hoáº¡t Ä‘á»™ng bá»n vá»¯ng.</p>
<p>Trong cÃ i Ä‘áº·t sá»­ dá»¥ng chá»©c nÄƒng sao chÃ©p cá»§a Redis, ráº¥t khuyáº¿n nghá»‹ báº­t tÃ­nh bá»n vá»¯ng trÃªn cáº£ master vÃ  slave. Khi khÃ´ng báº­t tÃ­nh nÄƒng nÃ y, vÃ­ dá»¥ nhÆ° gáº·p váº¥n Ä‘á» trá»… do hiá»‡u suáº¥t á»• cá»©ng ráº¥t cháº­m, <strong>báº¡n nÃªn cáº¥u hÃ¬nh cÃ¡c phiÃªn báº£n Ä‘á»ƒ trÃ¡nh tá»± Ä‘á»™ng khá»Ÿi Ä‘á»™ng láº¡i sau khi thiáº¿t láº­p láº¡i</strong>.</p>
<p>Ká»ƒ tá»« phiÃªn báº£n Redis 2.6, mÃ¡y chá»§ phá»¥ há»— trá»£ cháº¿ Ä‘á»™ chá»‰ Ä‘á»c vÃ  cháº¿ Ä‘á»™ nÃ y lÃ  cháº¿ Ä‘á»™ máº·c Ä‘á»‹nh cá»§a mÃ¡y chá»§ phá»¥.</p>
<ul>
<li>Cháº¿ Ä‘á»™ chá»‰ Ä‘á»c Ä‘Æ°á»£c Ä‘iá»u khiá»ƒn báº±ng tÃ¹y chá»n&nbsp;<code>slave-read-only</code>&nbsp;trong tá»‡p&nbsp;<code>redis.conf</code>, vÃ  cÅ©ng cÃ³ thá»ƒ Ä‘Æ°á»£c báº­t hoáº·c táº¯t cháº¿ Ä‘á»™ nÃ y báº±ng lá»‡nh&nbsp;<a href="http://redisdoc.com/configure/config_set.html#config-set" target="_blank" rel="noopener noreferrer">CONFIG SET parameter value</a>.</li>
<li>MÃ¡y chá»§ phá»¥ chá»‰ Ä‘á»c sáº½ tá»« chá»‘i thá»±c hiá»‡n báº¥t ká»³ lá»‡nh ghi nÃ o, do Ä‘Ã³ khÃ´ng cÃ³ trÆ°á»ng há»£p dá»¯ liá»‡u Ä‘Æ°á»£c ghi vÃ o mÃ¡y chá»§ phá»¥ vÃ¬ lá»—i thao tÃ¡c.</li>
</ul>
<h2>2. Sao chÃ©p phiÃªn báº£n cÅ©</h2>
<blockquote>
<p>CÃ¡ch triá»ƒn khai sao chÃ©p trÆ°á»›c phiÃªn báº£n Redis 2.8: Lá»‡nh&nbsp;<code>SYNC</code></p>
</blockquote>
<p>Chá»©c nÄƒng sao chÃ©p Redis Ä‘Æ°á»£c chia thÃ nh hai hoáº¡t Ä‘á»™ng: Ä‘á»“ng bá»™ hÃ³a (sync) vÃ  truyá»n lá»‡nh (command propagate):</p>
<ul>
<li><strong><code>Äá»“ng bá»™ hÃ³a (sync)</code></strong>&nbsp;- ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ cáº­p nháº­t tráº¡ng thÃ¡i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a mÃ¡y chá»§ phá»¥ vá»›i tráº¡ng thÃ¡i cÆ¡ sá»Ÿ dá»¯ liá»‡u hiá»‡n táº¡i cá»§a mÃ¡y chá»§ chÃ­nh.</li>
<li><strong><code>Truyá»n lá»‡nh (command propagate)</code></strong>&nbsp;- Khi tráº¡ng thÃ¡i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a mÃ¡y chá»§ chÃ­nh Ä‘Æ°á»£c sá»­a Ä‘á»•i, dáº«n Ä‘áº¿n tráº¡ng thÃ¡i khÃ´ng nháº¥t quÃ¡n giá»¯a cÆ¡ sá»Ÿ dá»¯ liá»‡u chÃ­nh vÃ  phá»¥, cho phÃ©p cÆ¡ sá»Ÿ dá»¯ liá»‡u chÃ­nh vÃ  phá»¥ trá»Ÿ láº¡i tráº¡ng thÃ¡i nháº¥t quÃ¡n.</li>
</ul>
<h3>Äá»“ng bá»™ hÃ³a</h3>
<p>CÃ¡c bÆ°á»›c thá»±c hiá»‡n lá»‡nh&nbsp;<code>SYNC</code>:</p>
<ol>
<li>MÃ¡y chá»§ phá»¥ gá»­i lá»‡nh&nbsp;<code>SYNC</code>&nbsp;Ä‘áº¿n mÃ¡y chá»§ chÃ­nh.</li>
<li>MÃ¡y chá»§ chÃ­nh nháº­n lá»‡nh&nbsp;<code>SYNC</code>&nbsp;vÃ  thá»±c hiá»‡n lá»‡nh&nbsp;<code>BGSAVE</code>&nbsp;Ä‘á»ƒ táº¡o tá»‡p RDB trong ná»n vÃ  sá»­ dá»¥ng má»™t bá»™ Ä‘á»‡m Ä‘á»ƒ ghi láº¡i táº¥t cáº£ cÃ¡c lá»‡nh ghi Ä‘Æ°á»£c thá»±c hiá»‡n tá»« thá»i Ä‘iá»ƒm nÃ y trá»Ÿ Ä‘i.</li>
<li>Sau khi mÃ¡y chá»§ chÃ­nh hoÃ n thÃ nh lá»‡nh&nbsp;<code>BGSAVE</code>, mÃ¡y chá»§ chÃ­nh sáº½ gá»­i tá»‡p RDB Ä‘Ã£ táº¡o cho mÃ¡y chá»§ phá»¥. MÃ¡y chá»§ phá»¥ nháº­n vÃ  táº£i tá»‡p RDB, cáº­p nháº­t tráº¡ng thÃ¡i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a mÃ¬nh.</li>
<li>MÃ¡y chá»§ chÃ­nh gá»­i táº¥t cáº£ cÃ¡c lá»‡nh ghi Ä‘Æ°á»£c ghi láº¡i trong bá»™ Ä‘á»‡m cho mÃ¡y chá»§ phá»¥. MÃ¡y chá»§ phá»¥ thá»±c hiá»‡n cÃ¡c lá»‡nh ghi nÃ y, cáº­p nháº­t tráº¡ng thÃ¡i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a mÃ¬nh.</li>
</ol>
<h3>Truyá»n lá»‡nh</h3>
<p>Sau khi hoÃ n thÃ nh hoáº¡t Ä‘á»™ng Ä‘á»“ng bá»™ hÃ³a, tráº¡ng thÃ¡i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a mÃ¡y chá»§ chÃ­nh vÃ  phá»¥ sáº½ trá»Ÿ nÃªn nháº¥t quÃ¡n. Má»—i khi mÃ¡y chá»§ chÃ­nh thá»±c hiá»‡n má»™t lá»‡nh ghi Ä‘Æ°á»£c gá»­i tá»« khÃ¡ch hÃ ng, tráº¡ng thÃ¡i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a mÃ¡y chá»§ chÃ­nh vÃ  phá»¥ khÃ´ng cÃ²n nháº¥t quÃ¡n. Cáº§n gá»­i cÃ¡c lá»‡nh ghi cho mÃ¡y chá»§ phá»¥ Ä‘á»ƒ thá»±c hiá»‡n, Ä‘áº£m báº£o tráº¡ng thÃ¡i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a cáº£ hai trá»Ÿ láº¡i nháº¥t quÃ¡n.</p>
<h3>NhÆ°á»£c Ä‘iá»ƒm cá»§a sao chÃ©p phiÃªn báº£n cÅ©</h3>
<p>CÃ³ hai trÆ°á»ng há»£p khi sao chÃ©p tá»« mÃ¡y chá»§ chÃ­nh sang mÃ¡y chá»§ phá»¥:</p>
<ul>
<li><strong>Sao chÃ©p láº§n Ä‘áº§u</strong>&nbsp;- MÃ¡y chá»§ phá»¥ chÆ°a tá»«ng sao chÃ©p mÃ¡y chá»§ chÃ­nh trÆ°á»›c Ä‘Ã³.</li>
<li><strong>Sao chÃ©p sau khi máº¥t káº¿t ná»‘i</strong>&nbsp;- MÃ¡y chá»§ phá»¥ vÃ  mÃ¡y chá»§ chÃ­nh trong quÃ¡ trÃ¬nh truyá»n lá»‡nh bá»‹ máº¥t káº¿t ná»‘i do váº¥n Ä‘á» máº¡ng, sau khi mÃ¡y chá»§ phá»¥ káº¿t ná»‘i láº¡i vá»›i mÃ¡y chá»§ chÃ­nh, tiáº¿p tá»¥c sao chÃ©p tá»« mÃ¡y chá»§ chÃ­nh.</li>
</ul>
<p>Äá»‘i vá»›i sao chÃ©p láº§n Ä‘áº§u, chá»©c nÄƒng sao chÃ©p phiÃªn báº£n cÅ© hoáº¡t Ä‘á»™ng tá»‘t; tuy nhiÃªn,&nbsp;<strong>Ä‘á»‘i vá»›i sao chÃ©p sau khi máº¥t káº¿t ná»‘i, hiá»‡u suáº¥t ráº¥t tháº¥p do viá»‡c táº¡o vÃ  truyá»n RDB má»—i láº§n</strong>.</p>
<blockquote>
<p>ğŸ”” LÆ°u Ã½:&nbsp;<strong>Lá»‡nh SYNC lÃ  má»™t hoáº¡t Ä‘á»™ng tá»‘n nhiá»u tÃ i nguyÃªn</strong>.</p>
<ul>
<li>MÃ¡y chá»§ chÃ­nh thá»±c hiá»‡n lá»‡nh&nbsp;<code>BGSAVE</code>&nbsp;Ä‘á»ƒ táº¡o tá»‡p RDB, hoáº¡t Ä‘á»™ng nÃ y tá»‘n nhiá»u tÃ i nguyÃªn CPU, bá»™ nhá»› vÃ  I/O Ä‘Ä©a cá»§a mÃ¡y chá»§ chÃ­nh.</li>
<li>MÃ¡y chá»§ chÃ­nh truyá»n tá»‡p RDB cho mÃ¡y chá»§ phá»¥, hoáº¡t Ä‘á»™ng nÃ y tá»‘n nhiá»u tÃ i nguyÃªn máº¡ng cá»§a cáº£ mÃ¡y chá»§ chÃ­nh vÃ  phá»¥ vÃ  áº£nh hÆ°á»Ÿng Ä‘áº¿n thá»i gian pháº£n há»“i cá»§a mÃ¡y chá»§ chÃ­nh.</li>
<li>Trong quÃ¡ trÃ¬nh mÃ¡y chá»§ phá»¥ táº£i tá»‡p RDB, cÃ¡c lá»‡nh yÃªu cáº§u khÃ¡c bá»‹ cháº·n.</li>
</ul>
</blockquote>
<h2>3. Sao chÃ©p phiÃªn báº£n má»›i</h2>
<blockquote>
<p>CÃ¡ch triá»ƒn khai má»›i sau phiÃªn báº£n Redis 2.8: Sá»­ dá»¥ng lá»‡nh&nbsp;<code>PSYNC</code>&nbsp;thay tháº¿ lá»‡nh&nbsp;<code>SYNC</code>.</p>
</blockquote>
<p>Lá»‡nh&nbsp;<code>PSYNC</code>&nbsp;cÃ³ hai cháº¿ Ä‘á»™: Ä‘á»“ng bá»™ hoÃ n toÃ n (full resynchronization) vÃ  Ä‘á»“ng bá»™ má»™t pháº§n (partial resynchronization):</p>
<ul>
<li><strong><code>Äá»“ng bá»™ hoÃ n toÃ n (full resynchronization)</code></strong>&nbsp;- ÄÆ°á»£c sá»­ dá»¥ng cho sao chÃ©p láº§n Ä‘áº§u. CÃ¡c bÆ°á»›c thá»±c hiá»‡n tÆ°Æ¡ng tá»± nhÆ° lá»‡nh&nbsp;<code>SYNC</code>.</li>
<li><strong><code>Äá»“ng bá»™ má»™t pháº§n (partial resynchronization)</code></strong>&nbsp;- ÄÆ°á»£c sá»­ dá»¥ng cho sao chÃ©p sau khi máº¥t káº¿t ná»‘i.&nbsp;<strong>Náº¿u Ä‘iá»u kiá»‡n cho phÃ©p, mÃ¡y chá»§ chÃ­nh cÃ³ thá»ƒ gá»­i cÃ¡c lá»‡nh ghi Ä‘Æ°á»£c thá»±c hiá»‡n trong quÃ¡ trÃ¬nh ngáº¯t káº¿t ná»‘i cho mÃ¡y chá»§ phá»¥</strong>, mÃ¡y chá»§ phá»¥ chá»‰ cáº§n nháº­n vÃ  thá»±c hiá»‡n cÃ¡c lá»‡nh ghi nÃ y Ä‘á»ƒ duy trÃ¬ tráº¡ng thÃ¡i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a mÃ¡y chá»§ chÃ­nh vÃ  phá»¥ nháº¥t quÃ¡n.</li>
</ul>
<h3>Äá»“ng bá»™ má»™t pháº§n</h3>
<p>Chá»©c nÄƒng Ä‘á»“ng bá»™ má»™t pháº§n bao gá»“m ba pháº§n:</p>
<ul>
<li><strong>Offset sao chÃ©p</strong>&nbsp;cá»§a mÃ¡y chá»§ chÃ­nh vÃ  mÃ¡y chá»§ phá»¥.</li>
<li><strong>Bá»™ Ä‘á»‡m chá» sao chÃ©p</strong>&nbsp;cá»§a mÃ¡y chá»§ chÃ­nh.</li>
<li><strong>ID cháº¡y cá»§a mÃ¡y chá»§</strong>.</li>
</ul>
<h4>Offset sao chÃ©p</h4>
<p>MÃ¡y chá»§ chÃ­nh vÃ  mÃ¡y chá»§ phá»¥ sáº½ duy trÃ¬ má»™t offset sao chÃ©p riÃªng biá»‡t.</p>
<ul>
<li>Náº¿u offset sao chÃ©p cá»§a mÃ¡y chá»§ chÃ­nh vÃ  mÃ¡y chá»§ phá»¥ giá»‘ng nhau, Ä‘iá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ  tráº¡ng thÃ¡i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a hai mÃ¡y chá»§ lÃ  nháº¥t quÃ¡n;</li>
<li>NgÆ°á»£c láº¡i, náº¿u offset sao chÃ©p khÃ´ng giá»‘ng nhau, Ä‘iá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ  tráº¡ng thÃ¡i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a hai mÃ¡y chá»§ khÃ´ng nháº¥t quÃ¡n.</li>
</ul>
<h4>Bá»™ Ä‘á»‡m chá» sao chÃ©p</h4>
<p><strong>Bá»™ Ä‘á»‡m chá» sao chÃ©p lÃ  má»™t hÃ ng Ä‘á»£i FIFO cÃ³ Ä‘á»™ dÃ i cá»‘ Ä‘á»‹nh Ä‘Æ°á»£c duy trÃ¬ bá»Ÿi mÃ¡y chá»§ chÃ­nh</strong>, kÃ­ch thÆ°á»›c máº·c Ä‘á»‹nh lÃ &nbsp;<code>1MB</code>.</p>
<p>Bá»™ Ä‘á»‡m chá» sao chÃ©p sáº½ lÆ°u trá»¯ má»™t pháº§n lá»‡nh ghi gáº§n Ä‘Ã¢y Ä‘Ã£ truyá»n vÃ  bá»™ Ä‘á»‡m chá» sao chÃ©p sáº½ ghi láº¡i offset sao chÃ©p tÆ°Æ¡ng á»©ng cho má»—i byte trong hÃ ng Ä‘á»£i.</p>
<p>Khi mÃ¡y chá»§ phá»¥ káº¿t ná»‘i láº¡i vá»›i mÃ¡y chá»§ chÃ­nh sau khi máº¥t káº¿t ná»‘i, mÃ¡y chá»§ phá»¥ sáº½ gá»­i lá»‡nh&nbsp;<code>PSYNC</code>&nbsp;vá»›i offset sao chÃ©p cá»§a chÃ­nh nÃ³ cho mÃ¡y chá»§ chÃ­nh, mÃ¡y chá»§ chÃ­nh sáº½ dá»±a trÃªn offset nÃ y Ä‘á»ƒ quyáº¿t Ä‘á»‹nh thá»±c hiá»‡n hoáº¡t Ä‘á»™ng Ä‘á»“ng bá»™ nÃ o vá»›i mÃ¡y chá»§ phá»¥.</p>
<ul>
<li>Náº¿u dá»¯ liá»‡u sau offset váº«n cÃ²n trong bá»™ Ä‘á»‡m chá» sao chÃ©p, mÃ¡y chá»§ chÃ­nh sáº½ thá»±c hiá»‡n Ä‘á»“ng bá»™ má»™t pháº§n vá»›i mÃ¡y chá»§ phá»¥.</li>
<li>NgÆ°á»£c láº¡i, mÃ¡y chá»§ chÃ­nh sáº½ thá»±c hiá»‡n Ä‘á»“ng bá»™ hoÃ n toÃ n vá»›i mÃ¡y chá»§ phá»¥.</li>
</ul>
<blockquote>
<p>ğŸ”” LÆ°u Ã½:&nbsp;<strong>Äiá»u chá»‰nh kÃ­ch thÆ°á»›c bá»™ Ä‘á»‡m chá» sao chÃ©p má»™t cÃ¡ch há»£p lÃ½</strong></p>
<ul>
<li>
<p>KÃ­ch thÆ°á»›c máº·c Ä‘á»‹nh cá»§a bá»™ Ä‘á»‡m chá» sao chÃ©p Redis lÃ &nbsp;<code>1MB</code>.</p>
</li>
<li>
<p>KÃ­ch thÆ°á»›c tá»‘i thiá»ƒu cá»§a bá»™ Ä‘á»‡m chá» sao chÃ©p cÃ³ thá»ƒ Ä‘Æ°á»£c Æ°á»›c tÃ­nh báº±ng cÃ´ng thá»©c&nbsp;<code>second * write_size_per_second</code>.</p>
</li>
</ul>
</blockquote>
<h4>ID cháº¡y cá»§a mÃ¡y chá»§</h4>
<ul>
<li>Má»—i mÃ¡y chá»§ Redis cÃ³ má»™t ID cháº¡y Ä‘á»ƒ xÃ¡c Ä‘á»‹nh duy nháº¥t.</li>
<li>ID cháº¡y Ä‘Æ°á»£c táº¡o tá»± Ä‘á»™ng khi mÃ¡y chá»§ khá»Ÿi Ä‘á»™ng, bao gá»“m 40 kÃ½ tá»± tháº­p lá»¥c phÃ¢n ngáº«u nhiÃªn. VÃ­ dá»¥: 132e358005e29741f8d7b0a42d666aace286edda</li>
</ul>
<p>Khi mÃ¡y chá»§ phá»¥ sao chÃ©p láº§n Ä‘áº§u tá»« mÃ¡y chá»§ chÃ­nh, mÃ¡y chá»§ chÃ­nh sáº½ gá»­i ID cháº¡y cá»§a chÃ­nh nÃ³ cho mÃ¡y chá»§ phá»¥ vÃ  mÃ¡y chá»§ phá»¥ sáº½ lÆ°u trá»¯ ID cháº¡y nÃ y.</p>
<p>Khi mÃ¡y chá»§ phá»¥ káº¿t ná»‘i láº¡i vá»›i mÃ¡y chá»§ chÃ­nh, mÃ¡y chá»§ phá»¥ sáº½ gá»­i ID cháº¡y Ä‘Ã£ lÆ°u trá»¯ trÆ°á»›c Ä‘Ã³:</p>
<ul>
<li>Náº¿u ID cháº¡y Ä‘Ã£ lÆ°u trá»¯ vÃ  ID cháº¡y hiá»‡n táº¡i cá»§a mÃ¡y chá»§ chÃ­nh giá»‘ng nhau, Ä‘iá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ  mÃ¡y chá»§ phá»¥ Ä‘Ã£ káº¿t ná»‘i vá»›i mÃ¡y chá»§ chÃ­nh trÆ°á»›c Ä‘Ã³, mÃ¡y chá»§ chÃ­nh sáº½ tiáº¿p tá»¥c thá»­ nghiá»‡m Ä‘á»“ng bá»™ má»™t pháº§n;</li>
<li>NgÆ°á»£c láº¡i, náº¿u ID cháº¡y khÃ´ng khá»›p, Ä‘iá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ  mÃ¡y chá»§ phá»¥ khÃ´ng káº¿t ná»‘i vá»›i mÃ¡y chá»§ chÃ­nh trÆ°á»›c Ä‘Ã³, mÃ¡y chá»§ chÃ­nh sáº½ thá»±c hiá»‡n Ä‘á»“ng bá»™ hoÃ n toÃ n vá»›i mÃ¡y chá»§ phá»¥.</li>
</ul>
<h3>Lá»‡nh PSYNC</h3>
<p>Sau khi hiá»ƒu cÃ¡ch triá»ƒn khai Ä‘á»“ng bá»™ má»™t pháº§n, viá»‡c hiá»ƒu cÃ¡ch thá»±c hiá»‡n lá»‡nh PSYNC sáº½ dá»… dÃ ng hÆ¡n, nguyÃªn táº¯c hoáº¡t Ä‘á»™ng cÆ¡ báº£n cá»§a nÃ³ nhÆ° sau:</p>
<p>Khi mÃ¡y chá»§ phá»¥ nháº­n Ä‘Æ°á»£c lá»‡nh&nbsp;<code>SLAVEOF</code>, trÆ°á»›c tiÃªn kiá»ƒm tra xem mÃ¡y chá»§ phá»¥ Ä‘Ã£ sao chÃ©p tá»« mÃ¡y chá»§ trÆ°á»›c Ä‘Ã³ hay chÆ°a.</p>
<ul>
<li>Náº¿u mÃ¡y chá»§ phá»¥ chÆ°a sao chÃ©p tá»« báº¥t ká»³ mÃ¡y chá»§ chÃ­nh nÃ o trÆ°á»›c Ä‘Ã³, nÃ³ sáº½ gá»­i lá»‡nh&nbsp;<code>PSYNC ? -1</code>&nbsp;Ä‘áº¿n mÃ¡y chá»§ chÃ­nh, yÃªu cáº§u Ä‘á»“ng bá»™ hoÃ n toÃ n.</li>
<li>NgÆ°á»£c láº¡i, nÃ³ sáº½ gá»­i lá»‡nh&nbsp;<code>PSYNC &lt;runid&gt; &lt;offset&gt;</code>&nbsp;Ä‘áº¿n mÃ¡y chá»§ chÃ­nh.
<ul>
<li><code>runid</code>&nbsp;lÃ  ID cháº¡y cá»§a mÃ¡y chá»§ chÃ­nh trong láº§n sao chÃ©p trÆ°á»›c Ä‘Ã³.</li>
<li><code>offset</code>&nbsp;lÃ  offset sao chÃ©p.</li>
</ul>
</li>
</ul>
<p>MÃ¡y chá»§ chÃ­nh nháº­n Ä‘Æ°á»£c lá»‡nh&nbsp;<code>PSYNC &lt;runid&gt; &lt;offset&gt;</code>&nbsp;sáº½ thá»±c hiá»‡n phÃ¢n tÃ­ch:</p>
<ul>
<li>Náº¿u <strong>ID cháº¡y cá»§a mÃ¡y chá»§ chÃ­nh vÃ  mÃ¡y chá»§ phá»¥ giá»‘ng nhau vÃ  offset Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh váº«n cÃ²n hiá»‡u lá»±c trong bá»™ Ä‘á»‡m chá» sao chÃ©p</strong>, Ä‘iá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ  mÃ¡y chá»§ chÃ­nh sáº½ tiáº¿p tá»¥c thá»±c hiá»‡n Ä‘á»“ng bá»™ má»™t pháº§n vá»›i mÃ¡y chá»§ phá»¥.</li>
<li>Náº¿u khÃ´ng thá»a mÃ£n má»™t trong hai Ä‘iá»u kiá»‡n trÃªn, mÃ¡y chá»§ chÃ­nh sáº½ thá»±c hiá»‡n Ä‘á»“ng bá»™ toÃ n bá»™ vá»›i mÃ¡y chá»§ phá»¥.</li>
</ul>
<h2>4. Kiá»ƒm tra nhá»‹p tim</h2>
<p>Trong giai Ä‘oáº¡n <strong>truyá»n lá»‡nh</strong>, mÃ¡y chá»§ tá»« xa máº·c Ä‘á»‹nh sáº½ gá»­i lá»‡nh Ä‘áº¿n mÃ¡y chá»§ chÃ­nh má»™t láº§n má»—i giÃ¢y:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>REPLCONF ACK &lt;replication_offset&gt;</span></span></code></pre>
</div><p>Trong Ä‘Ã³, <code>replication_offset</code> lÃ  vá»‹ trÃ­ sao chÃ©p hiá»‡n táº¡i cá»§a mÃ¡y chá»§ tá»« xa.</p>
<p>Gá»­i lá»‡nh <code>REPLCONF ACK</code> cÃ³ ba tÃ¡c dá»¥ng Ä‘á»‘i vá»›i mÃ¡y chá»§ chÃ­nh vÃ  mÃ¡y chá»§ phá»¥:</p>
<ul>
<li>Kiá»ƒm tra tráº¡ng thÃ¡i káº¿t ná»‘i máº¡ng giá»¯a mÃ¡y chá»§ chÃ­nh vÃ  mÃ¡y chá»§ phá»¥.</li>
<li>Há»— trá»£ thá»±c hiá»‡n tÃ¹y chá»n min-slaves.</li>
<li>Kiá»ƒm tra viá»‡c máº¥t lá»‡nh.</li>
</ul>
<h3>Kiá»ƒm tra tráº¡ng thÃ¡i káº¿t ná»‘i giá»¯a mÃ¡y chá»§ chÃ­nh vÃ  mÃ¡y chá»§ phá»¥</h3>
<p><strong>CÃ³ thá»ƒ kiá»ƒm tra xem káº¿t ná»‘i máº¡ng giá»¯a mÃ¡y chá»§ chÃ­nh vÃ  mÃ¡y chá»§ phá»¥ cÃ³ bÃ¬nh thÆ°á»ng hay khÃ´ng</strong> báº±ng cÃ¡ch gá»­i vÃ  nháº­n lá»‡nh <code>REPLCONF ACK</code>: Náº¿u mÃ¡y chá»§ chÃ­nh khÃ´ng nháº­n Ä‘Æ°á»£c lá»‡nh <code>REPLCONF ACK</code> tá»« mÃ¡y chá»§ phá»¥ trong hÆ¡n má»™t giÃ¢y, mÃ¡y chá»§ chÃ­nh sáº½ biáº¿t ráº±ng cÃ³ váº¥n Ä‘á» vá» káº¿t ná»‘i giá»¯a mÃ¡y chá»§ chÃ­nh vÃ  mÃ¡y chá»§ phá»¥.</p>
<p>CÃ³ thá»ƒ sá»­ dá»¥ng lá»‡nh <code>INFO replication</code> Ä‘á»ƒ gá»­i Ä‘áº¿n mÃ¡y chá»§ chÃ­nh vÃ  xem trong cá»™t lag cá»§a danh sÃ¡ch mÃ¡y chá»§ phá»¥, thá»i gian Ä‘Ã£ trÃ´i qua ká»ƒ tá»« khi mÃ¡y chá»§ phá»¥ gá»­i lá»‡nh <code>REPLCONF ACK</code> Ä‘áº¿n mÃ¡y chá»§ chÃ­nh.</p>
<h3>Há»— trá»£ thá»±c hiá»‡n tÃ¹y chá»n min-slaves</h3>
<p>TÃ¹y chá»n <code>min-slaves-to-write</code> vÃ  <code>min-slaves-max-lag</code> trong Redis giÃºp ngÄƒn mÃ¡y chá»§ chÃ­nh thá»±c hiá»‡n lá»‡nh ghi trong trÆ°á»ng há»£p khÃ´ng an toÃ n.</p>
<p>ã€VÃ­ dá»¥ã€‘Cáº¥u hÃ¬nh min-slaves</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>min-slaves-to-write 3</span></span>
<span class="line"><span>min-slaves-max-lag 10</span></span></code></pre>
</div><p>Cáº¥u hÃ¬nh trÃªn Ä‘áº¡i diá»‡n cho: Náº¿u sá»‘ lÆ°á»£ng mÃ¡y chá»§ phá»¥ nhá» hÆ¡n 3 hoáº·c Ä‘á»™ trá»… cá»§a ba mÃ¡y chá»§ phá»¥ lá»›n hÆ¡n hoáº·c báº±ng 10 giÃ¢y, mÃ¡y chá»§ chÃ­nh sáº½ tá»« chá»‘i thá»±c hiá»‡n lá»‡nh ghi.</p>
<h3>Kiá»ƒm tra viá»‡c máº¥t lá»‡nh</h3>
<p>Náº¿u do sá»± cá»‘ máº¡ng, cÃ¡c lá»‡nh ghi mÃ  mÃ¡y chá»§ chÃ­nh truyá»n cho mÃ¡y chá»§ phá»¥ bá»‹ máº¥t, khi mÃ¡y chá»§ phá»¥ gá»­i lá»‡nh <code>REPLCONF ACK</code> Ä‘á»‹nh ká»³ Ä‘áº¿n mÃ¡y chá»§ chÃ­nh, mÃ¡y chá»§ chÃ­nh sáº½ nháº­n ra ráº±ng vá»‹ trÃ­ sao chÃ©p cá»§a mÃ¡y chá»§ phá»¥ Ã­t hÆ¡n cá»§a chÃ­nh nÃ³. Sau Ä‘Ã³, mÃ¡y chá»§ chÃ­nh sáº½ tÃ¬m cÃ¡c dá»¯ liá»‡u mÃ  mÃ¡y chá»§ phá»¥ thiáº¿u trong bá»™ Ä‘á»‡m sao chÃ©p vÃ  gá»­i láº¡i cho mÃ¡y chá»§ phá»¥ dá»±a trÃªn vá»‹ trÃ­ sao chÃ©p mÃ  mÃ¡y chá»§ phá»¥ Ä‘Ã£ gá»­i.</p>
<h2>5. Quy trÃ¬nh sao chÃ©p</h2>
<p>Báº±ng cÃ¡ch gá»­i lá»‡nh SLAVEOF nhÆ° sau Ä‘áº¿n mÃ¡y chá»§ phá»¥, báº¡n cÃ³ thá»ƒ sao chÃ©p mÃ¡y chá»§ chÃ­nh.</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>SLAVEOF &lt;master_ip&gt; &lt;master_port&gt;</span></span></code></pre>
</div><h3>BÆ°á»›c 1. Cáº¥u hÃ¬nh mÃ¡y chá»§ chÃ­nh vÃ  mÃ¡y chá»§ phá»¥</h3>
<p>Cáº¥u hÃ¬nh mÃ¡y chá»§ phá»¥ ráº¥t Ä‘Æ¡n giáº£n, chá»‰ cáº§n thÃªm dÃ²ng sau vÃ o tá»‡p cáº¥u hÃ¬nh:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>slaveof 127.0.0.1 6379</span></span></code></pre>
</div><p>Táº¥t nhiÃªn, báº¡n cáº§n thay tháº¿ <code>127.0.0.1</code> vÃ  <code>6379</code> trong mÃ£ báº±ng IP vÃ  cá»•ng cá»§a mÃ¡y chá»§ chÃ­nh cá»§a báº¡n.</p>
<p>Má»™t cÃ¡ch khÃ¡c lÃ  sá»­ dá»¥ng lá»‡nh <a href="https://redis.io/commands/slaveof/" target="_blank" rel="noopener noreferrer">SLAVEOF host port</a>, nháº­p IP vÃ  cá»•ng cá»§a mÃ¡y chá»§ chÃ­nh, sau Ä‘Ã³ Ä‘á»“ng bá»™ hÃ³a sáº½ báº¯t Ä‘áº§u:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>127.0.0.1:6379&gt; SLAVEOF 127.0.0.1 10086</span></span>
<span class="line"><span>OK</span></span></code></pre>
</div><h3>BÆ°á»›c 2. Thiáº¿t láº­p káº¿t ná»‘i TCP giá»¯a mÃ¡y chá»§ chÃ­nh vÃ  mÃ¡y chá»§ phá»¥.</h3>
<h3>BÆ°á»›c 3. Gá»­i PING Ä‘á»ƒ kiá»ƒm tra tráº¡ng thÃ¡i giao tiáº¿p.</h3>
<h3>BÆ°á»›c 4. XÃ¡c thá»±c.</h3>
<p>Náº¿u mÃ¡y chá»§ chÃ­nh khÃ´ng thiáº¿t láº­p <code>requirepass</code>, mÃ¡y chá»§ phá»¥ khÃ´ng thiáº¿t láº­p <code>masterauth</code>, thÃ¬ khÃ´ng cáº§n xÃ¡c thá»±c; ngÆ°á»£c láº¡i, cáº§n xÃ¡c thá»±c. Náº¿u xÃ¡c thá»±c khÃ´ng thÃ nh cÃ´ng, quÃ¡ trÃ¬nh sao chÃ©p sáº½ bá»‹ há»§y bá».</p>
<p>Náº¿u mÃ¡y chá»§ chÃ­nh Ä‘Ã£ Ä‘áº·t máº­t kháº©u thÃ´ng qua tÃ¹y chá»n <code>requirepass</code>, Ä‘á»ƒ Ä‘áº£m báº£o quÃ¡ trÃ¬nh Ä‘á»“ng bá»™ hÃ³a mÃ¡y chá»§ phá»¥ diá»…n ra suÃ´n sáº», chÃºng ta cÅ©ng pháº£i thiáº¿t láº­p xÃ¡c thá»±c tÆ°Æ¡ng á»©ng cho mÃ¡y chá»§ phá»¥.</p>
<p>Äá»‘i vá»›i má»™t mÃ¡y chá»§ Ä‘ang cháº¡y, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng lá»‡nh sau Ä‘Ã¢y trÃªn khÃ¡ch hÃ ng:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>config set masterauth &lt;password&gt;</span></span></code></pre>
</div><p>Äá»ƒ thiáº¿t láº­p máº­t kháº©u nÃ y vÄ©nh viá»…n, báº¡n cÃ³ thá»ƒ thÃªm nÃ³ vÃ o tá»‡p cáº¥u hÃ¬nh:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>masterauth &lt;password&gt;</span></span></code></pre>
</div><p>NgoÃ i ra, cÃ²n má»™t sá»‘ tÃ¹y chá»n khÃ¡c liÃªn quan Ä‘áº¿n bá»™ Ä‘á»‡m luá»“ng sao chÃ©p Ä‘Æ°á»£c sá»­ dá»¥ng khi mÃ¡y chá»§ chÃ­nh thá»±c hiá»‡n Ä‘á»“ng bá»™ hÃ³a má»™t pháº§n, chi tiáº¿t cÃ³ thá»ƒ tham kháº£o tá»‡p <code>redis.conf</code> Ä‘i kÃ¨m vá»›i mÃ£ nguá»“n Redis.</p>
<h3>BÆ°á»›c 5. Gá»­i thÃ´ng tin cá»•ng.</h3>
<p>mÃ¡y chá»§ phá»¥ thá»±c hiá»‡n <code>REPLCONF listening-port &lt;port-number&gt;</code>, gá»­i sá»‘ cá»•ng láº¯ng nghe cá»§a mÃ¡y chá»§ phá»¥ Ä‘áº¿n mÃ¡y chá»§ chÃ­nh.</p>
<h3>BÆ°á»›c 6. Äá»“ng bá»™ hÃ³a.</h3>
<p>ÄÃ£ Ä‘Æ°á»£c giá»›i thiá»‡u trÆ°á»›c Ä‘Ã³, khÃ´ng láº·p láº¡i á»Ÿ Ä‘Ã¢y.</p>
<h3>BÆ°á»›c 7. Truyá»n lá»‡nh.</h3>
<p>Trong giai Ä‘oáº¡n truyá»n lá»‡nh, mÃ¡y chá»§ phá»¥ máº·c Ä‘á»‹nh sáº½ gá»­i lá»‡nh Ä‘áº¿n mÃ¡y chá»§ chÃ­nh má»—i giÃ¢y má»™t láº§n:</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>REPLCONF ACK &lt;replication_coffset&gt;</span></span></code></pre>
</div><p>CÃ¡c lá»‡nh cÃ³ tÃ¡c dá»¥ng:</p>
<ul>
<li>Kiá»ƒm tra tráº¡ng thÃ¡i káº¿t ná»‘i máº¡ng giá»¯a mÃ¡y chá»§ chÃ­nh vÃ  mÃ¡y chá»§ phá»¥.</li>
<li>Há»— trá»£ thá»±c hiá»‡n tÃ¹y chá»n min-slave.</li>
<li>Kiá»ƒm tra viá»‡c máº¥t lá»‡nh.</li>
</ul>
<h2>6. CÃ¡c tÃ¹y chá»n cáº¥u hÃ¬nh sao chÃ©p</h2>
<p>Tá»« Redis 2.8 trá»Ÿ Ä‘i, Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh an toÃ n cá»§a dá»¯ liá»‡u, báº¡n cÃ³ thá»ƒ cáº¥u hÃ¬nh Ä‘á»ƒ mÃ¡y chá»§ chÃ­nh chá»‰ thá»±c hiá»‡n lá»‡nh ghi khi cÃ³ Ã­t nháº¥t N mÃ¡y chá»§ con Ä‘ang káº¿t ná»‘i.</p>
<p>Tuy nhiÃªn, vÃ¬ Redis sá»­ dá»¥ng sao chÃ©p báº¥t Ä‘á»“ng bá»™, nÃªn dá»¯ liá»‡u ghi mÃ  mÃ¡y chá»§ chÃ­nh gá»­i khÃ´ng nháº¥t thiáº¿t sáº½ Ä‘Æ°á»£c mÃ¡y chá»§ con nháº­n Ä‘Æ°á»£c, do Ä‘Ã³, kháº£ nÄƒng máº¥t dá»¯ liá»‡u váº«n tá»“n táº¡i.</p>
<p>DÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a tÃ­nh nÄƒng nÃ y:</p>
<ul>
<li>MÃ¡y chá»§ con gá»­i lá»‡nh PING Ä‘áº¿n mÃ¡y chá»§ chÃ­nh má»—i giÃ¢y má»™t láº§n vÃ  bÃ¡o cÃ¡o tÃ¬nh tráº¡ng xá»­ lÃ½ luá»“ng sao chÃ©p.</li>
<li>MÃ¡y chá»§ chÃ­nh ghi láº¡i thá»i gian mÃ¡y chá»§ con cuá»‘i cÃ¹ng gá»­i lá»‡nh PING Ä‘áº¿n nÃ³.</li>
<li>NgÆ°á»i dÃ¹ng cÃ³ thá»ƒ cáº¥u hÃ¬nh giÃ¡ trá»‹ tá»‘i Ä‘a cá»§a Ä‘á»™ trá»… máº¡ng <code>min-slaves-max-lag</code> vÃ  sá»‘ lÆ°á»£ng tá»‘i thiá»ƒu mÃ¡y chá»§ con cáº§n Ä‘á»ƒ thá»±c hiá»‡n lá»‡nh ghi <code>min-slaves-to-write</code>.</li>
</ul>
<p>Náº¿u cÃ³ Ã­t nháº¥t <code>min-slaves-to-write</code> mÃ¡y chá»§ con vÃ  táº¥t cáº£ cÃ¡c mÃ¡y chá»§ con nÃ y cÃ³ Ä‘á»™ trá»… nhá» hÆ¡n <code>min-slaves-max-lag</code> giÃ¢y, mÃ¡y chá»§ chÃ­nh sáº½ thá»±c hiá»‡n lá»‡nh ghi Ä‘Æ°á»£c yÃªu cáº§u tá»« khÃ¡ch hÃ ng.</p>
<p>Báº¡n cÃ³ thá»ƒ coi tÃ­nh nÄƒng nÃ y nhÆ° má»™t phiÃªn báº£n ná»›i lá»ng Ä‘iá»u kiá»‡n C trong lÃ½ thuyáº¿t CAP: Máº·c dÃ¹ khÃ´ng Ä‘áº£m báº£o tÃ­nh bá»n vá»¯ng cá»§a lá»‡nh ghi, nhÆ°ng Ã­t nháº¥t cá»­a sá»• máº¥t dá»¯ liá»‡u sáº½ Ä‘Æ°á»£c giá»›i háº¡n cháº·t cháº½ trong sá»‘ giÃ¢y Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh.</p>
<p>Máº·t khÃ¡c, náº¿u khÃ´ng Ä‘Ã¡p á»©ng Ä‘Æ°á»£c cÃ¡c Ä‘iá»u kiá»‡n Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh bá»Ÿi <code>min-slaves-to-write</code> vÃ  <code>min-slaves-max-lag</code>, lá»‡nh ghi sáº½ khÃ´ng Ä‘Æ°á»£c thá»±c hiá»‡n vÃ  mÃ¡y chá»§ chÃ­nh sáº½ tráº£ vá» má»™t lá»—i cho khÃ¡ch hÃ ng yÃªu cáº§u thá»±c hiá»‡n lá»‡nh ghi.</p>
<p>DÆ°á»›i Ä‘Ã¢y lÃ  hai tÃ¹y chá»n cá»§a tÃ­nh nÄƒng nÃ y vÃ  cÃ¡c tham sá»‘ cáº§n thiáº¿t cho chÃºng:</p>
<ul>
<li><code>min-slaves-to-write &lt;sá»‘ lÆ°á»£ng mÃ¡y chá»§ con&gt;</code></li>
<li><code>min-slaves-max-lag &lt;sá»‘ giÃ¢y&gt;</code></li>
</ul>
<p>ThÃ´ng tin chi tiáº¿t cÃ³ thá»ƒ Ä‘Æ°á»£c tham kháº£o trong tá»‡p <code>redis.conf</code> Ä‘i kÃ¨m vá»›i mÃ£ nguá»“n Redis.</p>
]]></content:encoded>
    </item>
    <item>
      <title>Redis Sentinel</title>
      <link>https://vanhung4499.github.io/database/redis/sentinel.html</link>
      <guid>https://vanhung4499.github.io/database/redis/sentinel.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Redis Sentinel</source>
      <description>Redis Sentinel Redis Sentinel lÃ  giáº£i phÃ¡p kháº£ dá»¥ng cao (High Availability) cho Redis. Redis Sentinel lÃ  viá»‡c triá»ƒn khai cá»¥ thá»ƒ cá»§a thuáº­t toÃ¡n Raft. 1. Giá»›i thiá»‡u vá» Sentinel Re...</description>
      <category>redis</category>
      <category>nosql</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>Redis Sentinel lÃ  giáº£i phÃ¡p&nbsp;<strong>kháº£ dá»¥ng cao</strong>&nbsp;(High Availability) cho Redis.</p>
<p>Redis Sentinel lÃ  viá»‡c triá»ƒn khai cá»¥ thá»ƒ cá»§a thuáº­t toÃ¡n Raft.</p>
</blockquote>
<h2>1. Giá»›i thiá»‡u vá» Sentinel</h2>
<p>Redis Sentinel lÃ  giáº£i phÃ¡p&nbsp;<strong>cao kháº£ dá»¥ng</strong>&nbsp;(High Availability) cho Redis: Há»‡ thá»‘ng Sentinel Ä‘Æ°á»£c táº¡o thÃ nh tá»« má»™t hoáº·c nhiá»u phiÃªn báº£n Sentinel cÃ³ thá»ƒ giÃ¡m sÃ¡t nhiá»u mÃ¡y chá»§ chÃ­nh vÃ  táº¥t cáº£ cÃ¡c mÃ¡y chá»§ con cá»§a chÃºng. Khi má»™t mÃ¡y chá»§ chÃ­nh Ä‘Æ°á»£c giÃ¡m sÃ¡t bá»‹ chuyá»ƒn sang tráº¡ng thÃ¡i offline, Sentinel sáº½ tá»± Ä‘á»™ng nÃ¢ng cáº¥p má»™t mÃ¡y chá»§ con thÃ nh mÃ¡y chá»§ chÃ­nh má»›i vÃ  mÃ¡y chá»§ chÃ­nh má»›i nÃ y sáº½ tiáº¿p tá»¥c xá»­ lÃ½ cÃ¡c yÃªu cáº§u lá»‡nh thay tháº¿ cho mÃ¡y chá»§ chÃ­nh Ä‘Ã£ offline.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200131135847.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>
<p>CÃ¡c chá»©c nÄƒng chÃ­nh cá»§a Sentinel bao gá»“m:</p>
<ul>
<li><strong>GiÃ¡m sÃ¡t (Monitoring)</strong>&nbsp;- Sentinel liÃªn tá»¥c kiá»ƒm tra xem cÃ¡c mÃ¡y chá»§ chÃ­nh vÃ  mÃ¡y chá»§ con cÃ³ hoáº¡t Ä‘á»™ng bÃ¬nh thÆ°á»ng hay khÃ´ng.</li>
<li><strong>ThÃ´ng bÃ¡o (Notification)</strong>&nbsp;- Sentinel cÃ³ thá»ƒ thÃ´ng bÃ¡o cho quáº£n trá»‹ viÃªn há»‡ thá»‘ng hoáº·c á»©ng dá»¥ng khÃ¡c ráº±ng cÃ¡c phiÃªn báº£n Redis Ä‘ang Ä‘Æ°á»£c giÃ¡m sÃ¡t gáº·p váº¥n Ä‘á».</li>
<li><strong>Tá»± Ä‘á»™ng chuyá»ƒn giao khi lá»—i (Automatic Failover)</strong>&nbsp;- Náº¿u má»™t mÃ¡y chá»§ chÃ­nh bá»‹ offline, Sentinel sáº½ báº¯t Ä‘áº§u quÃ¡ trÃ¬nh chuyá»ƒn giao tá»± Ä‘á»™ng: nÃ¢ng cáº¥p má»™t mÃ¡y chá»§ con thÃ nh mÃ¡y chá»§ chÃ­nh vÃ  cáº¥u hÃ¬nh láº¡i cÃ¡c mÃ¡y chá»§ con khÃ¡c Ä‘á»ƒ sá»­ dá»¥ng mÃ¡y chá»§ chÃ­nh má»›i. á»¨ng dá»¥ng sá»­ dá»¥ng dá»‹ch vá»¥ Redis cÅ©ng sáº½ Ä‘Æ°á»£c thÃ´ng bÃ¡o vá» Ä‘á»‹a chá»‰ má»›i.</li>
<li><strong>Cung cáº¥p cáº¥u hÃ¬nh (Configuration Provider)</strong>&nbsp;- Sentinel cung cáº¥p nguá»“n cáº¥u hÃ¬nh cho viá»‡c khÃ¡m phÃ¡ dá»‹ch vá»¥ cá»§a khÃ¡ch hÃ ng: Äá»‘i vá»›i má»™t dá»‹ch vá»¥ cá»¥ thá»ƒ, khÃ¡ch hÃ ng káº¿t ná»‘i Ä‘áº¿n cÃ¡c Sentinel Ä‘á»ƒ tÃ¬m Ä‘á»‹a chá»‰ mÃ¡y chá»§ chÃ­nh hiá»‡n táº¡i. Khi quÃ¡ trÃ¬nh chuyá»ƒn giao xáº£y ra, Sentinel sáº½ bÃ¡o cÃ¡o Ä‘á»‹a chá»‰ má»›i.</li>
</ul>
<h2>2. Khá»Ÿi Ä‘á»™ng Sentinel</h2>
<p>CÃ³ thá»ƒ khá»Ÿi Ä‘á»™ng má»™t Sentinel báº±ng báº¥t ká»³ lá»‡nh nÃ o dÆ°á»›i Ä‘Ã¢y, hai lá»‡nh nÃ y cÃ³ hiá»‡u quáº£ hoÃ n toÃ n giá»‘ng nhau.</p>
<div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">redis-sentinel</span><span style="color:#98C379;--shiki-dark:#98C379"> /path/to/sentinel.conf</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">redis-server</span><span style="color:#98C379;--shiki-dark:#98C379"> /path/to/sentinel.conf</span><span style="color:#D19A66;--shiki-dark:#D19A66"> --sentinel</span></span></code></pre>
</div><p>Khi má»™t Sentinel Ä‘Æ°á»£c khá»Ÿi Ä‘á»™ng, nÃ³ sáº½ thá»±c hiá»‡n cÃ¡c bÆ°á»›c sau:</p>
<ol>
<li>Khá»Ÿi táº¡o mÃ¡y chá»§.</li>
<li>Sá»­ dá»¥ng mÃ£ Ä‘áº·c biá»‡t cá»§a Sentinel.</li>
<li>Khá»Ÿi táº¡o tráº¡ng thÃ¡i cá»§a Sentinel.</li>
<li>Khá»Ÿi táº¡o danh sÃ¡ch mÃ¡y chá»§ chÃ­nh cá»§a Sentinel.</li>
<li>Táº¡o káº¿t ná»‘i máº¡ng Ä‘áº¿n mÃ¡y chá»§ chÃ­nh Ä‘Æ°á»£c giÃ¡m sÃ¡t.</li>
</ol>
<p><strong>Sentinel thá»±c cháº¥t lÃ  má»™t mÃ¡y chá»§ Redis hoáº¡t Ä‘á»™ng trong cháº¿ Ä‘á»™ Ä‘áº·c biá»‡t</strong>.</p>
<p>Trong cháº¿ Ä‘á»™ Sentinel, mÃ¡y chá»§ Redis chá»‰ há»— trá»£ báº£y lá»‡nh:&nbsp;<code>PING</code>,&nbsp;<code>SENTINEL</code>,&nbsp;<code>INFO</code>,&nbsp;<code>SUBSCRIBE</code>,&nbsp;<code>UNSUBSCRIBE</code>,&nbsp;<code>PSUBSCRIBE</code>,&nbsp;<code>PUNSUBSCRIBE</code>.</p>
<p>Khi táº¡o káº¿t ná»‘i máº¡ng Ä‘áº¿n mÃ¡y chá»§ chÃ­nh Ä‘Æ°á»£c giÃ¡m sÃ¡t, Sentinel sáº½ trá»Ÿ thÃ nh má»™t khÃ¡ch hÃ ng cá»§a mÃ¡y chá»§ chÃ­nh, nÃ³ cÃ³ thá»ƒ gá»­i lá»‡nh Ä‘áº¿n mÃ¡y chá»§ chÃ­nh vÃ  nháº­n thÃ´ng tin liÃªn quan tá»« pháº£n há»“i lá»‡nh. Äá»‘i vá»›i má»—i mÃ¡y chá»§ chÃ­nh Ä‘Æ°á»£c giÃ¡m sÃ¡t bá»Ÿi Sentinel, Sentinel sáº½ táº¡o hai káº¿t ná»‘i máº¡ng báº¥t Ä‘á»“ng bá»™ Ä‘áº¿n mÃ¡y chá»§ chÃ­nh:</p>
<ul>
<li>Káº¿t ná»‘i lá»‡nh: ÄÆ°á»£c sá»­ dá»¥ng Ä‘áº·c biá»‡t Ä‘á»ƒ gá»­i lá»‡nh Ä‘áº¿n mÃ¡y chá»§ chÃ­nh vÃ  nháº­n pháº£n há»“i lá»‡nh.</li>
<li>Káº¿t ná»‘i Ä‘Äƒng kÃ½: ÄÆ°á»£c sá»­ dá»¥ng Ä‘áº·c biá»‡t Ä‘á»ƒ Ä‘Äƒng kÃ½ kÃªnh&nbsp;<code>__sentinel__:hello</code>&nbsp;cá»§a mÃ¡y chá»§ chÃ­nh.</li>
</ul>
<h2>3. GiÃ¡m sÃ¡t</h2>
<h3>Kiá»ƒm tra tráº¡ng thÃ¡i mÃ¡y chá»§</h3>
<blockquote>
<p><strong>Sentinel gá»­i lá»‡nh <code>PING</code> tá»›i mÃ¡y chá»§ Redis Ä‘á»ƒ kiá»ƒm tra tráº¡ng thÃ¡i cá»§a nÃ³</strong>.</p>
</blockquote>
<p>Máº·c Ä‘á»‹nh, <strong>má»—i</strong> nÃºt <code>Sentinel</code> sáº½ gá»­i lá»‡nh <code>PING</code> tá»›i cÃ¡c nÃºt <code>Redis</code> vÃ  cÃ¡c nÃºt <code>Sentinel</code> <strong>khÃ¡c</strong> vá»›i táº§n suáº¥t lÃ  má»—i giÃ¢y vÃ  dá»±a vÃ o pháº£n há»“i tá»« cÃ¡c nÃºt Ä‘á»ƒ xÃ¡c Ä‘á»‹nh xem nÃºt Ä‘Ã³ cÃ³ trá»±c tuyáº¿n hay khÃ´ng.</p>
<ul>
<li><strong>Offline chá»§ quan</strong>: Offline chá»§ quan Ã¡p dá»¥ng cho cáº£ nÃºt chÃ­nh vÃ  nÃºt phá»¥. Náº¿u trong khoáº£ng thá»i gian <code>down-after-milliseconds</code>, <code>Sentinel</code> khÃ´ng nháº­n Ä‘Æ°á»£c pháº£n há»“i há»£p lá»‡ tá»« nÃºt má»¥c tiÃªu, nÃ³ sáº½ xem nÃºt Ä‘Ã³ lÃ  offline chá»§ quan.</li>
<li><strong>Offline khÃ¡ch quan</strong>: Offline khÃ¡ch quan chá»‰ Ã¡p dá»¥ng cho nÃºt chÃ­nh. Sau khi <code>Sentinel</code> xÃ¡c Ä‘á»‹nh má»™t mÃ¡y chá»§ chÃ­nh lÃ  offline chá»§ quan, Ä‘á»ƒ xÃ¡c nháº­n ráº±ng mÃ¡y chá»§ chÃ­nh thá»±c sá»± Ä‘Ã£ offline, nÃ³ sáº½ há»i cÃ¡c <code>Sentinel</code> khÃ¡c Ä‘ang theo dÃµi mÃ¡y chá»§ chÃ­nh Ä‘Ã³ xem há» cÃ³ Ä‘á»“ng Ã½ ráº±ng mÃ¡y chá»§ chÃ­nh Ä‘Ã£ offline hay khÃ´ng. Khi Ä‘á»§ sá»‘ lÆ°á»£ng <code>Sentinel</code> Ä‘á»“ng Ã½ ráº±ng mÃ¡y chá»§ chÃ­nh Ä‘Ã£ offline, nÃ³ sáº½ Ä‘Æ°á»£c xem lÃ  offline khÃ¡ch quan vÃ  thá»±c hiá»‡n hoáº¡t Ä‘á»™ng chuyá»ƒn giao lá»—i.
<ul>
<li>NÃºt <code>Sentinel</code> sá»­ dá»¥ng lá»‡nh <code>sentinel is-master-down-by-addr</code> Ä‘á»ƒ há»i cÃ¡c nÃºt <code>Sentinel</code> khÃ¡c vá» <strong>Ä‘Ã¡nh giÃ¡ tráº¡ng thÃ¡i</strong> cá»§a nÃºt Ä‘Ã³.</li>
</ul>
</li>
</ul>
<h3>Láº¥y thÃ´ng tin mÃ¡y chá»§</h3>
<blockquote>
<p><strong>Sentinel gá»­i lá»‡nh <code>INFO</code> tá»›i mÃ¡y chá»§ chÃ­nh Ä‘á»ƒ láº¥y thÃ´ng tin vá» mÃ¡y chá»§ chÃ­nh vÃ  cÃ¡c mÃ¡y chá»§ phá»¥ cá»§a nÃ³</strong>.</p>
</blockquote>
<ul>
<li><strong>Láº¥y thÃ´ng tin mÃ¡y chá»§ chÃ­nh</strong> - Sentinel máº·c Ä‘á»‹nh sáº½ gá»­i lá»‡nh <code>INFO</code> tá»›i mÃ¡y chá»§ chÃ­nh mÃ  nÃ³ Ä‘ang giÃ¡m sÃ¡t vá»›i táº§n suáº¥t lÃ  má»—i 10 giÃ¢y vÃ  dá»±a vÃ o pháº£n há»“i tá»« lá»‡nh <code>INFO</code> Ä‘á»ƒ láº¥y thÃ´ng tin hiá»‡n táº¡i cá»§a mÃ¡y chá»§ chÃ­nh.
<ul>
<li>ThÃ´ng tin vá» mÃ¡y chá»§ chÃ­nh: bao gá»“m ID cháº¡y cá»§a mÃ¡y chá»§ Ä‘Æ°á»£c ghi láº¡i trong trÆ°á»ng run_id vÃ  vai trÃ² cá»§a mÃ¡y chá»§ Ä‘Æ°á»£c ghi láº¡i trong trÆ°á»ng role.</li>
<li>ThÃ´ng tin vá» mÃ¡y chá»§ phá»¥ cá»§a mÃ¡y chá»§ chÃ­nh: bao gá»“m Ä‘á»‹a chá»‰ IP vÃ  cá»•ng.</li>
</ul>
</li>
<li><strong>Láº¥y thÃ´ng tin mÃ¡y chá»§ phá»¥</strong> - Khi Sentinel phÃ¡t hiá»‡n má»™t mÃ¡y chá»§ chÃ­nh cÃ³ mÃ¡y chá»§ phá»¥ má»›i xuáº¥t hiá»‡n, ngoÃ i viá»‡c táº¡o cáº¥u trÃºc thá»±c thá»ƒ tÆ°Æ¡ng á»©ng cho mÃ¡y chá»§ phá»¥ má»›i, Sentinel cÅ©ng sáº½ táº¡o káº¿t ná»‘i lá»‡nh vÃ  káº¿t ná»‘i Ä‘Äƒng kÃ½ tá»›i mÃ¡y chá»§ phá»¥.</li>
</ul>
<h2>4. ThÃ´ng bÃ¡o</h2>
<p>Äá»‘i vá»›i má»—i mÃ¡y chá»§ káº¿t ná»‘i vá»›i Sentinel, Sentinel sáº½ gá»­i tin nháº¯n Ä‘áº¿n kÃªnh&nbsp;<code>__sentinel__:hello</code>&nbsp;cá»§a mÃ¡y chá»§ vÃ  cÅ©ng Ä‘Äƒng kÃ½ nháº­n tin nháº¯n tá»« kÃªnh&nbsp;<code>__sentinel__:hello</code>&nbsp;cá»§a mÃ¡y chá»§.</p>
<h3>Gá»­i tin nháº¯n Ä‘áº¿n mÃ¡y chá»§</h3>
<p>Máº·c Ä‘á»‹nh, Sentinel sáº½ gá»­i lá»‡nh theo Ä‘á»‹nh dáº¡ng sau Ä‘áº¿n táº¥t cáº£ cÃ¡c mÃ¡y chá»§ chÃ­nh vÃ  mÃ¡y chá»§ phá»¥ Ä‘Æ°á»£c giÃ¡m sÃ¡t má»™t láº§n má»—i hai giÃ¢y.</p>
<div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>PUBLISH __sentinel__:hello "&lt;s_ip&gt;,&lt;s_port&gt;,&lt;s_runid&gt;,&lt;s_epoch&gt;,&lt;m_name&gt;,&lt;m_ip&gt;,&lt;m_port&gt;,&lt;m_epoch&gt;"</span></span></code></pre>
</div><p>Lá»‡nh nÃ y gá»­i má»™t tin nháº¯n Ä‘áº¿n kÃªnh&nbsp;<code>__sentinel__:hello</code>&nbsp;cá»§a mÃ¡y chá»§.</p>
<h3>Nháº­n tin nháº¯n tá»« mÃ¡y chá»§</h3>
<p>Khi Sentinel thiáº¿t láº­p káº¿t ná»‘i Ä‘Äƒng kÃ½ vá»›i má»™t mÃ¡y chá»§ chÃ­nh hoáº·c mÃ¡y chá»§ phá»¥, Sentinel sáº½ gá»­i lá»‡nh&nbsp;<code>SUBSCRIBE __sentinel__:hello</code>&nbsp;thÃ´ng qua káº¿t ná»‘i Ä‘Äƒng kÃ½.</p>
<p>Sentinel sáº½ tiáº¿p tá»¥c Ä‘Äƒng kÃ½ kÃªnh&nbsp;<code>__sentinel__:hello</code>&nbsp;cho Ä‘áº¿n khi Sentinel ngáº¯t káº¿t ná»‘i vá»›i mÃ¡y chá»§.</p>
<h2>5. Lá»±a chá»n Leader</h2>
<blockquote>
<p>Thuáº­t toÃ¡n lá»±a chá»n Leader trong há»‡ thá»‘ng Redis Sentinel Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng cÃ¡ch triá»ƒn khai&nbsp;<a href="https://ramcloud.atlassian.net/wiki/download/attachments/6586375/raft.pdf" target="_blank" rel="noopener noreferrer">Raft</a>.</p>
<p>Raft lÃ  má»™t thuáº­t toÃ¡n Ä‘á»“ng thuáº­n, Ä‘á»ƒ hiá»ƒu nguyÃªn lÃ½ hoáº¡t Ä‘á»™ng cá»§a nÃ³, báº¡n cÃ³ thá»ƒ tham kháº£o&nbsp;<a href="">PhÃ¢n tÃ­ch sÃ¢u vá» thuáº­t toÃ¡n Ä‘á»“ng thuáº­n Raft</a>.</p>
</blockquote>
<p><strong>Khi má»™t mÃ¡y chá»§ chÃ­nh Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh lÃ  offline khÃ¡ch quan, cÃ¡c Sentinel theo dÃµi mÃ¡y chá»§ chÃ­nh nÃ y sáº½ thá»±c hiá»‡n thá»a thuáº­n vÃ  lá»±a chá»n má»™t Sentinel Ä‘áº§u tiÃªn, sau Ä‘Ã³ Sentinel Ä‘áº§u tiÃªn nÃ y sáº½ thá»±c hiá»‡n hoáº¡t Ä‘á»™ng chuyá»ƒn giao lá»—i cho mÃ¡y chá»§ chÃ­nh offline</strong>.</p>
<p>Táº¥t cáº£ cÃ¡c Sentinel Ä‘ang hoáº¡t Ä‘á»™ng Ä‘á»u cÃ³ kháº£ nÄƒng Ä‘Æ°á»£c chá»n lÃ m Leader.</p>
<p>Má»—i nÃºt&nbsp;<code>Sentinel</code>&nbsp;cáº§n thá»±c hiá»‡n Ä‘á»‹nh ká»³ cÃ¡c nhiá»‡m vá»¥ sau Ä‘Ã¢y:</p>
<p>(1) Má»—i&nbsp;<code>Sentinel</code>&nbsp;gá»­i má»™t lá»‡nh&nbsp;<code>PING</code>&nbsp;tá»›i cÃ¡c mÃ¡y chá»§ chÃ­nh, mÃ¡y chá»§ phá»¥ vÃ  cÃ¡c phiÃªn báº£n&nbsp;<code>Sentinel</code>&nbsp;khÃ¡c mÃ  nÃ³ biáº¿t vá»›i táº§n suáº¥t lÃ  má»—i giÃ¢y.</p>
<p>(2) Náº¿u má»™t phiÃªn báº£n (instance) khÃ´ng nháº­n Ä‘Æ°á»£c pháº£n há»“i há»£p lá»‡ tá»« lá»‡nh&nbsp;<code>PING</code>&nbsp;trong khoáº£ng thá»i gian quy Ä‘á»‹nh bá»Ÿi&nbsp;<code>down-after-milliseconds</code>, phiÃªn báº£n nÃ y sáº½ Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u lÃ  offline chá»§ quan bá»Ÿi&nbsp;<code>Sentinel</code>.</p>
<p>(3) Náº¿u má»™t mÃ¡y chá»§ chÃ­nh Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u lÃ  offline chá»§ quan, táº¥t cáº£ cÃ¡c nÃºt&nbsp;<code>Sentinel</code>&nbsp;Ä‘ang theo dÃµi mÃ¡y chá»§ chÃ­nh nÃ y sáº½ xÃ¡c nháº­n ráº±ng mÃ¡y chá»§ chÃ­nh Ä‘Ã£ chÃ­nh thá»©c vÃ o tráº¡ng thÃ¡i offline chá»§ quan vá»›i táº§n suáº¥t lÃ  má»—i giÃ¢y.</p>
<p>(4) Náº¿u má»™t mÃ¡y chá»§ chÃ­nh Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u lÃ  offline chá»§ quan vÃ  cÃ³ Ä‘á»§ sá»‘ lÆ°á»£ng&nbsp;<code>Sentinel</code>&nbsp;(Ã­t nháº¥t lÃ  sá»‘ lÆ°á»£ng Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh trong tá»‡p cáº¥u hÃ¬nh) Ä‘á»“ng Ã½ vá»›i quyáº¿t Ä‘á»‹nh nÃ y trong khoáº£ng thá»i gian quy Ä‘á»‹nh, mÃ¡y chá»§ chÃ­nh nÃ y sáº½ Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u lÃ  offline khÃ¡ch quan.</p>
<p>(5) Trong trÆ°á»ng há»£p bÃ¬nh thÆ°á»ng, má»—i&nbsp;<code>Sentinel</code>&nbsp;sáº½ gá»­i lá»‡nh&nbsp;<code>INFO</code>&nbsp;tá»›i táº¥t cáº£ cÃ¡c mÃ¡y chá»§ chÃ­nh vÃ  phá»¥ mÃ  nÃ³ biáº¿t vá»›i táº§n suáº¥t lÃ  má»—i 10 giÃ¢y. Khi má»™t mÃ¡y chá»§ chÃ­nh Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u lÃ  offline khÃ¡ch quan bá»Ÿi&nbsp;<code>Sentinel</code>, táº§n suáº¥t gá»­i lá»‡nh&nbsp;<code>INFO</code>&nbsp;tá»«&nbsp;<code>Sentinel</code>&nbsp;tá»›i táº¥t cáº£ cÃ¡c mÃ¡y chá»§ phá»¥ cá»§a mÃ¡y chá»§ chÃ­nh offline sáº½ tÄƒng tá»« 10 giÃ¢y má»—i láº§n thÃ nh má»—i giÃ¢y.</p>
<p>(6)&nbsp;<code>Sentinel</code>&nbsp;vÃ  cÃ¡c&nbsp;<code>Sentinel</code>&nbsp;khÃ¡c thÆ°Æ¡ng lÆ°á»£ng vá» tráº¡ng thÃ¡i cá»§a nÃºt chÃ­nh, náº¿u nÃºt chÃ­nh á»Ÿ tráº¡ng thÃ¡i&nbsp;<code>SDOWN</code>, má»™t nÃºt chÃ­nh má»›i sáº½ Ä‘Æ°á»£c tá»± Ä‘á»™ng báº§u chá»n. CÃ¡c nÃºt phá»¥ cÃ²n láº¡i sáº½ Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh Ä‘áº¿n nÃºt chÃ­nh má»›i Ä‘á»ƒ sao chÃ©p dá»¯ liá»‡u.</p>
<p>(7) Khi khÃ´ng cÃ³ Ä‘á»§ sá»‘ lÆ°á»£ng&nbsp;<code>Sentinel</code>&nbsp;Ä‘á»“ng Ã½ vá»›i viá»‡c Ä‘Ã¡nh dáº¥u mÃ¡y chá»§ chÃ­nh lÃ  offline, tráº¡ng thÃ¡i offline khÃ¡ch quan cá»§a mÃ¡y chá»§ chÃ­nh sáº½ bá»‹ xÃ³a bá». Khi mÃ¡y chá»§ chÃ­nh tráº£ lá»i lá»‡nh&nbsp;<code>PING</code>&nbsp;cá»§a&nbsp;<code>Sentinel</code>&nbsp;vá»›i pháº£n há»“i há»£p lá»‡, tráº¡ng thÃ¡i offline chá»§ quan cá»§a mÃ¡y chá»§ chÃ­nh sáº½ bá»‹ xÃ³a bá».</p>
<blockquote>
<p>LÆ°u Ã½: Pháº£n há»“i há»£p lá»‡ cá»§a lá»‡nh&nbsp;<code>PING</code>&nbsp;cÃ³ thá»ƒ lÃ :&nbsp;<code>+PONG</code>,&nbsp;<code>-LOADING</code>&nbsp;hoáº·c&nbsp;<code>-MASTERDOWN</code>. Náº¿u mÃ¡y chá»§ tráº£ vá» pháº£n há»“i khÃ¡c ngoÃ i ba pháº£n há»“i trÃªn hoáº·c khÃ´ng tráº£ lá»i lá»‡nh&nbsp;<code>PING</code>&nbsp;trong khoáº£ng thá»i gian quy Ä‘á»‹nh,&nbsp;<code>Sentinel</code>&nbsp;sáº½ coi pháº£n há»“i tá»« mÃ¡y chá»§ lÃ  khÃ´ng há»£p lá»‡ (non-valid).</p>
</blockquote>
<h2>6. Chuyá»ƒn giao lá»—i</h2>
<p>Sau khi Sentinel Leader Ä‘Æ°á»£c báº§u chá»n, Sentinel Leader sáº½ thá»±c hiá»‡n hoáº¡t Ä‘á»™ng chuyá»ƒn giao lá»—i cho mÃ¡y chá»§ chÃ­nh Ä‘Ã£ offline. Hoáº¡t Ä‘á»™ng nÃ y bao gá»“m ba bÆ°á»›c sau:</p>
<p>(1)&nbsp;<strong>Chá»n ra mÃ¡y chá»§ chÃ­nh má»›i</strong></p>
<p>BÆ°á»›c Ä‘áº§u tiÃªn cá»§a hoáº¡t Ä‘á»™ng chuyá»ƒn giao lá»—i lÃ  Sentinel Leader chá»n ra má»™t mÃ¡y chá»§ phá»¥ trong táº¥t cáº£ cÃ¡c mÃ¡y chá»§ phá»¥ thuá»™c vÃ o mÃ¡y chá»§ chÃ­nh Ä‘Ã£ offline, mÃ  tráº¡ng thÃ¡i lÃ  tá»‘t vÃ  dá»¯ liá»‡u lÃ  hoÃ n chá»‰nh. Sau Ä‘Ã³, Sentinel Leader gá»­i lá»‡nh&nbsp;<code>SLAVEOF no one</code>&nbsp;tá»›i mÃ¡y chá»§ phá»¥ nÃ y Ä‘á»ƒ chuyá»ƒn Ä‘á»•i nÃ³ thÃ nh mÃ¡y chá»§ chÃ­nh.</p>
<p>CÃ¡ch Sentinel Leader chá»n ra mÃ¡y chá»§ chÃ­nh má»›i:</p>
<ul>
<li>XÃ³a táº¥t cáº£ cÃ¡c mÃ¡y chá»§ phá»¥ Ä‘ang offline hoáº·c bá»‹ ngáº¯t káº¿t ná»‘i khá»i danh sÃ¡ch.</li>
<li>XÃ³a táº¥t cáº£ cÃ¡c mÃ¡y chá»§ phá»¥ mÃ  trong vÃ²ng 5 giÃ¢y gáº§n Ä‘Ã¢y khÃ´ng pháº£n há»“i lá»‡nh INFO tá»« Sentinel Leader.</li>
<li>XÃ³a táº¥t cáº£ cÃ¡c mÃ¡y chá»§ phá»¥ mÃ  káº¿t ná»‘i vá»›i mÃ¡y chá»§ chÃ­nh Ä‘Ã£ offline bá»‹ ngáº¯t quÃ¡ thá»i gian&nbsp;<code>down-after-milliseconds</code>&nbsp;* 10 mili giÃ¢y (thá»i gian cáº§n Ä‘á»ƒ xÃ¡c Ä‘á»‹nh mÃ¡y chá»§ chÃ­nh Ä‘Ã£ offline).</li>
</ul>
<p>Sau Ä‘Ã³, Sentinel Leader chá»n ra mÃ¡y chá»§ phá»¥ cÃ³ Ä‘á»™ Æ°u tiÃªn cao nháº¥t. Náº¿u cÃ¡c mÃ¡y chá»§ phá»¥ cÃ³ cÃ¹ng Ä‘á»™ Æ°u tiÃªn, Sentinel Leader chá»n mÃ¡y chá»§ phá»¥ cÃ³ bá»™ nhá»› Ä‘á»‡m sao chÃ©p lá»›n nháº¥t. Náº¿u váº«n cÃ²n nhiá»u káº¿t quáº£, Sentinel Leader chá»n mÃ¡y chá»§ phá»¥ cÃ³ ID cháº¡y nhá» nháº¥t.</p>
<p>(2)&nbsp;<strong>Thay Ä‘á»•i má»¥c tiÃªu sao chÃ©p cho cÃ¡c mÃ¡y chá»§ phá»¥</strong></p>
<p>Sau khi chá»n ra mÃ¡y chá»§ chÃ­nh má»›i, Sentinel Leader gá»­i lá»‡nh&nbsp;<code>SLAVEOF</code>&nbsp;tá»›i táº¥t cáº£ cÃ¡c mÃ¡y chá»§ phá»¥ Ä‘á»ƒ yÃªu cáº§u chÃºng sao chÃ©p tá»« mÃ¡y chá»§ chÃ­nh má»›i.</p>
<p>(3)&nbsp;<strong>Biáº¿n mÃ¡y chá»§ chÃ­nh cÅ© thÃ nh mÃ¡y chá»§ phá»¥</strong></p>
<p>Sentinel Leader Ä‘Ã¡nh dáº¥u mÃ¡y chá»§ chÃ­nh cÅ© lÃ  mÃ¡y chá»§ phá»¥. Khi mÃ¡y chá»§ chÃ­nh cÅ© trá»Ÿ láº¡i hoáº¡t Ä‘á»™ng, Sentinel sáº½ gá»­i lá»‡nh SLAVEOF tá»›i nÃ³ Ä‘á»ƒ biáº¿n nÃ³ thÃ nh mÃ¡y chá»§ phá»¥.</p>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20200131135847.png" type="image/png"/>
    </item>
    <item>
      <title>Redis Transaction</title>
      <link>https://vanhung4499.github.io/database/redis/transaction.html</link>
      <guid>https://vanhung4499.github.io/database/redis/transaction.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Redis Transaction</source>
      <description>Redis Transaction Redis chá»‰ há»— trá»£ giao dá»‹ch &amp;quot;khÃ´ng nghiÃªm ngáº·t&amp;quot;. Gá»i lÃ  &amp;quot;khÃ´ng nghiÃªm ngáº·t&amp;quot; vÃ¬: Giao dá»‹ch Redis Ä‘áº£m báº£o &amp;quot;táº¥t cáº£ cÃ¡c lá»‡nh sáº½ Ä‘Æ°á»£c thá»±c thi&amp;quot;; nhÆ°ng, giao dá»‹ch Red...</description>
      <category>redis</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p><strong>Redis chá»‰ há»— trá»£ giao dá»‹ch "khÃ´ng nghiÃªm ngáº·t"</strong>. Gá»i lÃ  "khÃ´ng nghiÃªm ngáº·t" vÃ¬: Giao dá»‹ch Redis Ä‘áº£m báº£o "táº¥t cáº£ cÃ¡c lá»‡nh sáº½ Ä‘Æ°á»£c thá»±c thi"; nhÆ°ng, giao dá»‹ch Redis "khÃ´ng há»— trá»£ viá»‡c quay lui".</p>
</blockquote>
<h1>Redis Giao dá»‹ch</h1>
<blockquote>
<p><strong>Redis chá»‰ há»— trá»£ giao dá»‹ch "khÃ´ng nghiÃªm ngáº·t"</strong>. Gá»i lÃ  "khÃ´ng nghiÃªm ngáº·t" vÃ¬: Giao dá»‹ch Redis Ä‘áº£m báº£o "táº¥t cáº£ cÃ¡c lá»‡nh sáº½ Ä‘Æ°á»£c thá»±c thi"; nhÆ°ng, giao dá»‹ch Redis "khÃ´ng há»— trá»£ viá»‡c quay lui".</p>
<p>Tá»« khÃ³a: <code>giao dá»‹ch</code>, <code>ACID</code>, <code>MULTI</code>, <code>EXEC</code>, <code>DISCARD</code>, <code>WATCH</code></p>
</blockquote>
<h2>Giá»›i thiá»‡u vá» Giao dá»‹ch Redis</h2>
<h3>ACID lÃ  gÃ¬?</h3>
<p>ACID lÃ  bá»‘n yáº¿u tá»‘ cÆ¡ báº£n Ä‘á»ƒ Ä‘áº£m báº£o viá»‡c thá»±c thi Ä‘Ãºng cÃ¡c giao dá»‹ch trong cÆ¡ sá»Ÿ dá»¯ liá»‡u.</p>
<ul>
<li><strong>TÃ­nh nguyÃªn tá»­ (Atomicity)</strong>
<ul>
<li>Giao dá»‹ch Ä‘Æ°á»£c xem lÃ  Ä‘Æ¡n vá»‹ nhá» nháº¥t khÃ´ng thá»ƒ chia cáº¯t, cÃ¡c thao tÃ¡c trong giao dá»‹ch <strong>hoáº·c táº¥t cáº£ Ä‘á»u Ä‘Æ°á»£c cam káº¿t thÃ nh cÃ´ng, hoáº·c táº¥t cáº£ Ä‘á»u tháº¥t báº¡i vÃ  quay lui</strong>.</li>
<li>Viá»‡c quay lui cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n thÃ´ng qua nháº­t kÃ½, nháº­t kÃ½ ghi láº¡i cÃ¡c thao tÃ¡c sá»­a Ä‘á»•i mÃ  giao dá»‹ch Ä‘Ã£ thá»±c hiá»‡n, trong quÃ¡ trÃ¬nh quay lui sáº½ thá»±c hiá»‡n ngÆ°á»£c cÃ¡c thao tÃ¡c sá»­a Ä‘á»•i nÃ y.</li>
</ul>
</li>
<li><strong>TÃ­nh nháº¥t quÃ¡n (Consistency)</strong>
<ul>
<li>CÆ¡ sá»Ÿ dá»¯ liá»‡u giá»¯ tráº¡ng thÃ¡i nháº¥t quÃ¡n trÆ°á»›c vÃ  sau khi giao dá»‹ch thá»±c hiá»‡n.</li>
<li>Trong tráº¡ng thÃ¡i nháº¥t quÃ¡n, káº¿t quáº£ Ä‘á»c dá»¯ liá»‡u cá»§a táº¥t cáº£ cÃ¡c giao dá»‹ch Ä‘á»‘i vá»›i má»™t dá»¯ liá»‡u lÃ  giá»‘ng nhau.</li>
</ul>
</li>
<li><strong>TÃ­nh cÃ´ láº­p (Isolation)</strong>
<ul>
<li>CÃ¡c sá»­a Ä‘á»•i do má»™t giao dá»‹ch thá»±c hiá»‡n trÆ°á»›c khi Ä‘Æ°á»£c cam káº¿t cuá»‘i cÃ¹ng lÃ  khÃ´ng nhÃ¬n tháº¥y Ä‘á»‘i vá»›i cÃ¡c giao dá»‹ch khÃ¡c.</li>
</ul>
</li>
<li><strong>TÃ­nh bá»n vá»¯ng (Durability)</strong>
<ul>
<li>Má»™t khi giao dá»‹ch Ä‘Ã£ Ä‘Æ°á»£c cam káº¿t, cÃ¡c sá»­a Ä‘á»•i sáº½ Ä‘Æ°á»£c lÆ°u giá»¯ mÃ£i mÃ£i trong cÆ¡ sá»Ÿ dá»¯ liá»‡u. Ngay cáº£ khi há»‡ thá»‘ng gáº·p sá»± cá»‘, káº¿t quáº£ thá»±c hiá»‡n cá»§a giao dá»‹ch cÅ©ng khÃ´ng bá»‹ máº¥t.</li>
<li>CÃ³ thá»ƒ thá»±c hiá»‡n thÃ´ng qua viá»‡c sao lÆ°u vÃ  khÃ´i phá»¥c cÆ¡ sá»Ÿ dá»¯ liá»‡u, trong trÆ°á»ng há»£p há»‡ thá»‘ng gáº·p sá»± cá»‘, sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u sao lÆ°u Ä‘á»ƒ khÃ´i phá»¥c dá»¯ liá»‡u.</li>
</ul>
</li>
</ul>
<p><strong>Má»™t há»‡ thá»‘ng cÆ¡ sá»Ÿ dá»¯ liá»‡u há»— trá»£ giao dá»‹ch pháº£i cÃ³ bá»‘n Ä‘áº·c tÃ­nh nÃ y, náº¿u khÃ´ng trong quÃ¡ trÃ¬nh xá»­ lÃ½ giao dá»‹ch khÃ´ng thá»ƒ Ä‘áº£m báº£o tÃ­nh Ä‘Ãºng Ä‘áº¯n cá»§a dá»¯ liá»‡u, quÃ¡ trÃ¬nh giao dá»‹ch cÃ³ thá»ƒ khÃ´ng Ä‘áº¡t Ä‘Æ°á»£c má»¥c tiÃªu.</strong></p>
<ul>
<li>Chá»‰ khi Ä‘Ã¡p á»©ng tÃ­nh nháº¥t quÃ¡n, káº¿t quáº£ thá»±c hiá»‡n cá»§a giao dá»‹ch má»›i lÃ  Ä‘Ãºng.</li>
<li>Trong trÆ°á»ng há»£p khÃ´ng cÃ³ Ä‘á»“ng thá»i, giao dá»‹ch thá»±c hiá»‡n tuáº§n tá»±, tÃ­nh cÃ´ láº­p cháº¯c cháº¯n sáº½ Ä‘Æ°á»£c Ä‘áº£m báº£o. LÃºc nÃ y chá»‰ cáº§n Ä‘áº£m báº£o tÃ­nh nguyÃªn tá»­, nháº¥t Ä‘á»‹nh sáº½ Ä‘áº£m báº£o tÃ­nh nháº¥t quÃ¡n.</li>
<li>Trong trÆ°á»ng há»£p Ä‘á»“ng thá»i, nhiá»u giao dá»‹ch thá»±c hiá»‡n song song, giao dá»‹ch khÃ´ng chá»‰ pháº£i Ä‘áº£m báº£o tÃ­nh nguyÃªn tá»­, mÃ  cÃ²n pháº£i Ä‘áº£m báº£o tÃ­nh cÃ´ láº­p Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh nháº¥t quÃ¡n.</li>
<li>Äáº£m báº£o tÃ­nh bá»n vá»¯ng cá»§a giao dá»‹ch Ä‘á»ƒ Ä‘á»‘i phÃ³ vá»›i cÃ¡c tÃ¬nh huá»‘ng há»‡ thá»‘ng gáº·p sá»± cá»‘.</li>
</ul>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/acid.png" alt="ACID" tabindex="0" loading="lazy"><figcaption>ACID</figcaption></figure>
<h3>Äáº·c tÃ­nh cá»§a Giao dá»‹ch Redis</h3>
<p>Giao dá»‹ch Redis luÃ´n há»— trá»£ tÃ­nh nguyÃªn tá»­, tÃ­nh nháº¥t quÃ¡n vÃ  tÃ­nh cÃ´ láº­p cá»§a ACID. Khi mÃ¡y chá»§ cháº¡y á»Ÿ cháº¿ Ä‘á»™ lÆ°u trá»¯ bá»n vá»¯ng AOF vÃ  giÃ¡ trá»‹ cá»§a tÃ¹y chá»n <code>appendfsync</code> lÃ  <code>always</code>, giao dá»‹ch cÅ©ng cÃ³ tÃ­nh bá»n vá»¯ng.</p>
<p>Tuy nhiÃªn, cáº§n lÆ°u Ã½ ráº±ng: <strong>Redis chá»‰ há»— trá»£ giao dá»‹ch "khÃ´ng nghiÃªm ngáº·t"</strong>. "KhÃ´ng nghiÃªm ngáº·t" á»Ÿ Ä‘Ã¢y thá»±c cháº¥t lÃ  chá»‰ giao dá»‹ch Redis chá»‰ cÃ³ thá»ƒ Ä‘áº£m báº£o má»™t pháº§n tÃ­nh nguyÃªn tá»­ cá»§a ACID.</p>
<ul>
<li><strong>Giao dá»‹ch Redis Ä‘áº£m báº£o táº¥t cáº£ cÃ¡c lá»‡nh Ä‘Æ°á»£c thá»±c thi</strong> - Nhiá»u lá»‡nh trong giao dá»‹ch Redis sáº½ Ä‘Æ°á»£c Ä‘Ã³ng gÃ³i vÃ o hÃ ng Ä‘á»£i giao dá»‹ch, sau Ä‘Ã³ thá»±c hiá»‡n theo thá»© tá»± vÃ o trÆ°á»›c ra trÆ°á»›c (FIFO). Giao dá»‹ch sáº½ khÃ´ng bá»‹ giÃ¡n Ä‘oáº¡n trong quÃ¡ trÃ¬nh thá»±c hiá»‡n, khi táº¥t cáº£ cÃ¡c lá»‡nh trong hÃ ng Ä‘á»£i giao dá»‹ch Ä‘Ã£ Ä‘Æ°á»£c thá»±c hiá»‡n xong, giao dá»‹ch má»›i káº¿t thÃºc.</li>
<li><strong>Giao dá»‹ch Redis khÃ´ng há»— trá»£ quay lui</strong> - Náº¿u lá»‡nh thá»±c hiá»‡n tháº¥t báº¡i sáº½ khÃ´ng quay lui mÃ  sáº½ tiáº¿p tá»¥c thá»±c hiá»‡n.</li>
</ul>
<p>Theo tÃ i liá»‡u chÃ­nh thá»©c cá»§a Redis vá» Ä‘áº·c tÃ­nh giao dá»‹ch (transaction features documentation), lÃ½ do khÃ´ng há»— trá»£ quay lui lÃ :</p>
<ul>
<li>Lá»‡nh Redis chá»‰ tháº¥t báº¡i do lá»—i cÃº phÃ¡p, hoáº·c lá»‡nh Ä‘Æ°á»£c sá»­ dá»¥ng trÃªn loáº¡i khÃ³a khÃ´ng Ä‘Ãºng.</li>
<li>VÃ¬ khÃ´ng cáº§n há»— trá»£ quay lui, ná»™i bá»™ cá»§a Redis cÃ³ thá»ƒ giá»¯ Ä‘Æ¡n giáº£n vÃ  nhanh chÃ³ng.</li>
</ul>
<h2>á»¨ng dá»¥ng Transaction trong Redis</h2>
<p>CÃ¡c lá»‡nh <a href="https://redis.io/commands/multi" target="_blank" rel="noopener noreferrer"><code>MULTI</code></a>, <a href="https://redis.io/commands/exec" target="_blank" rel="noopener noreferrer"><code>EXEC</code></a>, <a href="https://redis.io/commands/discard" target="_blank" rel="noopener noreferrer"><code>DISCARD</code></a>, vÃ  <a href="https://redis.io/commands/watch" target="_blank" rel="noopener noreferrer"><code>WATCH</code></a> liÃªn quan Ä‘áº¿n giao dá»‹ch trong Redis.</p>
<p>Giao dá»‹ch cho phÃ©p thá»±c thi nhiá»u lá»‡nh cÃ¹ng má»™t lÃºc vÃ  cÃ³ hai cam káº¿t quan trá»ng sau Ä‘Ã¢y:</p>
<ul>
<li>
<p><strong>Giao dá»‹ch lÃ  má»™t hoáº¡t Ä‘á»™ng Ä‘Æ¡n láº» Ä‘á»™c láº­p:</strong> Táº¥t cáº£ cÃ¡c lá»‡nh trong giao dá»‹ch sáº½ Ä‘Æ°á»£c thá»±c thi tuáº§n tá»± theo thá»© tá»±. Trong quÃ¡ trÃ¬nh thá»±c thi giao dá»‹ch, khÃ´ng cÃ³ lá»‡nh tá»« cÃ¡c khÃ¡ch hÃ ng khÃ¡c cÃ³ thá»ƒ lÃ m giÃ¡n Ä‘oáº¡n.</p>
</li>
<li>
<p><strong>Giao dá»‹ch lÃ  má»™t hoáº¡t Ä‘á»™ng nguyÃªn tá»­:</strong> Táº¥t cáº£ cÃ¡c lá»‡nh trong giao dá»‹ch sáº½ Ä‘Æ°á»£c thá»±c thi hoÃ n toÃ n hoáº·c khÃ´ng thá»±c thi gÃ¬ cáº£.</p>
</li>
</ul>
<h3>MULTI</h3>
<p><strong>Lá»‡nh <a href="https://redis.io/commands/multi" target="_blank" rel="noopener noreferrer"><code>MULTI</code></a> Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ báº¯t Ä‘áº§u má»™t giao dá»‹ch vÃ  luÃ´n luÃ´n tráº£ vá» OK.</strong></p>
<p>Sau khi gá»i lá»‡nh <code>MULTI</code>, khÃ¡ch hÃ ng cÃ³ thá»ƒ tiáº¿p tá»¥c gá»­i báº¥t ká»³ sá»‘ lÆ°á»£ng lá»‡nh nÃ o Ä‘áº¿n mÃ¡y chá»§, cÃ¡c lá»‡nh nÃ y sáº½ khÃ´ng Ä‘Æ°á»£c thá»±c thi ngay láº­p tá»©c mÃ  sáº½ Ä‘Æ°á»£c Ä‘Æ°a vÃ o má»™t hÃ ng Ä‘á»£i. Khi lá»‡nh <code>EXEC</code> Ä‘Æ°á»£c gá»i, táº¥t cáº£ cÃ¡c lá»‡nh trong hÃ ng Ä‘á»£i sáº½ Ä‘Æ°á»£c thá»±c thi.</p>
<p>DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ vá» giao dá»‹ch, trong Ä‘Ã³ tÄƒng giÃ¡ trá»‹ cá»§a hai khÃ³a <code>foo</code> vÃ  <code>bar</code>:</p>
<div class="language-redis" data-ext="redis" data-title="redis"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>&gt; MULTI</span></span>
<span class="line"><span>OK</span></span>
<span class="line"><span>&gt; INCR foo</span></span>
<span class="line"><span>QUEUED</span></span>
<span class="line"><span>&gt; INCR bar</span></span>
<span class="line"><span>QUEUED</span></span>
<span class="line"><span>&gt; EXEC</span></span>
<span class="line"><span>1) (integer) 1</span></span>
<span class="line"><span>2) (integer) 1</span></span></code></pre>
</div><h3>EXEC</h3>
<p><strong>Lá»‡nh <a href="https://redis.io/commands/exec" target="_blank" rel="noopener noreferrer"><code>EXEC</code></a> Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ kÃ­ch hoáº¡t vÃ  thá»±c thi táº¥t cáº£ cÃ¡c lá»‡nh trong giao dá»‹ch.</strong></p>
<ul>
<li>Náº¿u khÃ¡ch hÃ ng Ä‘Ã£ sá»­ dá»¥ng lá»‡nh <code>MULTI</code> Ä‘á»ƒ báº¯t Ä‘áº§u má»™t giao dá»‹ch nhÆ°ng bá»‹ ngáº¯t káº¿t ná»‘i trÆ°á»›c khi gá»i <code>EXEC</code>, thÃ¬ táº¥t cáº£ cÃ¡c lá»‡nh trong giao dá»‹ch sáº½ khÃ´ng Ä‘Æ°á»£c thá»±c thi.</li>
<li>NgÆ°á»£c láº¡i, náº¿u khÃ¡ch hÃ ng thÃ nh cÃ´ng trong viá»‡c thá»±c thi lá»‡nh <code>EXEC</code> sau khi báº¯t Ä‘áº§u giao dá»‹ch báº±ng <code>MULTI</code>, thÃ¬ táº¥t cáº£ cÃ¡c lá»‡nh trong giao dá»‹ch sáº½ Ä‘Æ°á»£c thá»±c thi.</li>
</ul>
<p>CÃ¡c hoáº¡t Ä‘á»™ng trong <code>MULTI</code> vÃ  <code>EXEC</code> sáº½ Ä‘Æ°á»£c gá»­i Ä‘áº¿n mÃ¡y chá»§ má»™t láº§n duy nháº¥t thay vÃ¬ tá»«ng láº§n gá»­i lá»‡nh riÃªng láº», Ä‘iá»u nÃ y Ä‘Æ°á»£c gá»i lÃ  "Ä‘Æ°á»ng á»‘ng lá»‡nh" (pipeline), giÃºp giáº£m thiá»ƒu sá»‘ láº§n giao tiáº¿p máº¡ng giá»¯a khÃ¡ch hÃ ng vÃ  mÃ¡y chá»§, tá»« Ä‘Ã³ cáº£i thiá»‡n hiá»‡u suáº¥t.</p>
<h3>DISCARD</h3>
<p><strong>Khi thá»±c thi lá»‡nh <a href="https://redis.io/commands/discard" target="_blank" rel="noopener noreferrer"><code>DISCARD</code></a>, giao dá»‹ch sáº½ bá»‹ há»§y bá», hÃ ng Ä‘á»£i giao dá»‹ch sáº½ Ä‘Æ°á»£c xÃ³a vÃ  khÃ¡ch hÃ ng sáº½ thoÃ¡t khá»i tráº¡ng thÃ¡i giao dá»‹ch.</strong></p>
<p>VÃ­ dá»¥:</p>
<div class="language-redis" data-ext="redis" data-title="redis"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>&gt; SET foo 1</span></span>
<span class="line"><span>OK</span></span>
<span class="line"><span>&gt; MULTI</span></span>
<span class="line"><span>OK</span></span>
<span class="line"><span>&gt; INCR foo</span></span>
<span class="line"><span>QUEUED</span></span>
<span class="line"><span>&gt; DISCARD</span></span>
<span class="line"><span>OK</span></span>
<span class="line"><span>&gt; GET foo</span></span>
<span class="line"><span>"1"</span></span></code></pre>
</div><h3>WATCH</h3>
<p><strong>Lá»‡nh <a href="https://redis.io/commands/watch" target="_blank" rel="noopener noreferrer"><code>WATCH</code></a> trong Redis cung cáº¥p hÃ nh vi "check-and-set" (CAS) cho giao dá»‹ch.</strong></p>
<p>Khi má»™t hoáº·c nhiá»u khÃ³a Ä‘Æ°á»£c <code>WATCH</code>, Redis sáº½ theo dÃµi nhá»¯ng khÃ³a nÃ y vÃ  phÃ¡t hiá»‡n xem chÃºng cÃ³ bá»‹ thay Ä‘á»•i khÃ´ng. Náº¿u Ã­t nháº¥t má»™t khÃ³a Ä‘Ã£ Ä‘Æ°á»£c theo dÃµi bá»‹ thay Ä‘á»•i trÆ°á»›c khi <code>EXEC</code> Ä‘Æ°á»£c thá»±c thi, toÃ n bá»™ giao dá»‹ch sáº½ bá»‹ há»§y bá» vÃ  <code>EXEC</code> sáº½ tráº£ vá» <code>nil-reply</code> Ä‘á»ƒ bÃ¡o hiá»‡u ráº±ng giao dá»‹ch Ä‘Ã£ tháº¥t báº¡i.</p>
<div class="language-redis" data-ext="redis" data-title="redis"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>WATCH mykey</span></span>
<span class="line"><span>val = GET mykey</span></span>
<span class="line"><span>val = val + 1</span></span>
<span class="line"><span>MULTI</span></span>
<span class="line"><span>SET mykey $val</span></span>
<span class="line"><span>EXEC</span></span></code></pre>
</div><p>Trong Ä‘oáº¡n mÃ£ trÃªn, náº¿u sau khi thá»±c hiá»‡n <code>WATCH</code> vÃ  trÆ°á»›c khi thá»±c thi <code>EXEC</code>, cÃ³ má»™t khÃ¡ch hÃ ng khÃ¡c thay Ä‘á»•i giÃ¡ trá»‹ cá»§a <code>mykey</code>, thÃ¬ giao dá»‹ch cá»§a khÃ¡ch hÃ ng hiá»‡n táº¡i sáº½ tháº¥t báº¡i. Trong trÆ°á»ng há»£p nÃ y, chÆ°Æ¡ng trÃ¬nh cÃ³ thá»ƒ cáº§n thá»­ láº¡i hoáº¡t Ä‘á»™ng nÃ y, cho Ä‘áº¿n khi khÃ´ng cÃ³ xung Ä‘á»™t nÃ o xáº£y ra.</p>
<p>CÆ¡ cháº¿ khÃ³a nÃ y Ä‘Æ°á»£c gá»i lÃ  khÃ³a láº¡c quan (optimistic locking), lÃ  má»™t cÆ¡ cháº¿ khÃ³a máº¡nh máº½ vÃ¬ háº§u háº¿t cÃ¡c trÆ°á»ng há»£p, cÃ¡c khÃ¡ch hÃ ng khÃ¡c nhau sáº½ truy cáº­p vÃ o cÃ¡c khÃ³a khÃ¡c nhau, do Ä‘Ã³ Ã­t xáº£y ra xung Ä‘á»™t.</p>
<p><strong>ChÃº Ã½:</strong></p>
<ul>
<li><code>WATCH</code> lÃ m cho <code>EXEC</code> chá»‰ thá»±c thi náº¿u táº¥t cáº£ cÃ¡c khÃ³a Ä‘Ã£ theo dÃµi khÃ´ng bá»‹ thay Ä‘á»•i.</li>
<li><code>WATCH</code> cÃ³ thá»ƒ Ä‘Æ°á»£c gá»i nhiá»u láº§n. Viá»‡c theo dÃµi cÃ¡c khÃ³a báº¯t Ä‘áº§u tá»« khi <code>WATCH</code> Ä‘Æ°á»£c thá»±c thi cho Ä‘áº¿n khi <code>EXEC</code> Ä‘Æ°á»£c gá»i.</li>
<li>Khi <code>EXEC</code> Ä‘Æ°á»£c gá»i, viá»‡c theo dÃµi cÃ¡c khÃ³a sáº½ bá»‹ há»§y bá», dÃ¹ giao dá»‹ch cÃ³ thÃ nh cÃ´ng hay khÃ´ng. NgoÃ i ra, khi má»™t khÃ¡ch hÃ ng bá»‹ ngáº¯t káº¿t ná»‘i, viá»‡c theo dÃµi cÃ¡c khÃ³a cÅ©ng sáº½ bá»‹ há»§y bá».</li>
</ul>
<p><strong>Há»§y WATCH:</strong></p>
<ul>
<li>Sá»­ dá»¥ng lá»‡nh <code>UNWATCH</code> khÃ´ng cÃ³ tham sá»‘ Ä‘á»ƒ há»§y bá» theo dÃµi táº¥t cáº£ cÃ¡c khÃ³a. Äiá»u nÃ y cÃ³ thá»ƒ há»¯u Ã­ch khi má»™t giao dá»‹ch cáº§n há»§y bá» ngay láº­p tá»©c vÃ  chá» giao dá»‹ch thá»­ láº¡i sau.</li>
</ul>
<p><strong>Sá»­ dá»¥ng WATCH Ä‘á»ƒ táº¡o hÃ nh Ä‘á»™ng nguyÃªn tá»­:</strong></p>
<ul>
<li><code>WATCH</code> cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ táº¡o cÃ¡c hÃ nh Ä‘á»™ng nguyÃªn tá»­ mÃ  Redis khÃ´ng há»— trá»£ sáºµn.</li>
<li>VÃ­ dá»¥, Ä‘oáº¡n mÃ£ sau triá»ƒn khai lá»‡nh <code>ZPOP</code> tÃ¹y chá»‰nh Ä‘á»ƒ loáº¡i bá» pháº§n tá»­ cÃ³ giÃ¡ trá»‹ (score) nhá» nháº¥t trong má»™t táº­p há»£p cÃ³ thá»© tá»±:</li>
</ul>
<div class="language-redis" data-ext="redis" data-title="redis"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>WATCH zset</span></span>
<span class="line"><span>element = ZRANGE zset 0 0</span></span>
<span class="line"><span>MULTI</span></span>
<span class="line"><span>ZREM zset element</span></span>
<span class="line"><span>EXEC</span></span></code></pre>
</div>]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/acid.png" type="image/png"/>
    </item>
    <item>
      <title>SQL</title>
      <link>https://vanhung4499.github.io/database/sql/</link>
      <guid>https://vanhung4499.github.io/database/sql/</guid>
      <source url="https://vanhung4499.github.io/rss.xml">SQL</source>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
    </item>
    <item>
      <title>SQL Cheat Sheet</title>
      <link>https://vanhung4499.github.io/database/sql/cheat-sheet.html</link>
      <guid>https://vanhung4499.github.io/database/sql/cheat-sheet.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">SQL Cheat Sheet</source>
      <description>SQL Cheat Sheet CÃ¢u truy váº¥n Ä‘á»ƒ tÃ¬m kiáº¿m dá»¯ liá»‡u SELECT: ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ lá»±a chá»n dá»¯ liá»‡u tá»« cÆ¡ sá»Ÿ dá»¯ liá»‡u SELECT * FROM table_name; DISTINCT: ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ lá»c bá» cÃ¡c giÃ¡ trá»‹...</description>
      <category>sql</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>CÃ¢u truy váº¥n Ä‘á»ƒ tÃ¬m kiáº¿m dá»¯ liá»‡u</h2>
<h3><strong>SELECT</strong>: ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ lá»±a chá»n dá»¯ liá»‡u tá»« cÆ¡ sá»Ÿ dá»¯ liá»‡u</h3>
<ul>
<li><code>SELECT</code> * <code>FROM</code> table_name;</li>
</ul>
<h3><strong>DISTINCT</strong>: ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ lá»c bá» cÃ¡c giÃ¡ trá»‹ trÃ¹ng láº·p vÃ  tráº£ vá» cÃ¡c hÃ ng cá»§a cÃ¡c cá»™t Ä‘Ã£ chá»‰ Ä‘á»‹nh</h3>
<ul>
<li><code>SELECT DISTINCT</code> column_name;</li>
</ul>
<h3><strong>WHERE</strong>: ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ lá»c cÃ¡c báº£n ghi/hÃ ng</h3>
<ul>
<li><code>SELECT</code> column1, column2 <code>FROM</code> table_name <code>WHERE</code> condition;</li>
<li><code>SELECT</code> * <code>FROM</code> table_name <code>WHERE</code> condition1 <code>AND</code> condition2;</li>
<li><code>SELECT</code> * <code>FROM</code> table_name <code>WHERE</code> condition1 <code>OR</code> condition2;</li>
<li><code>SELECT</code> * <code>FROM</code> table_name <code>WHERE NOT</code> condition;</li>
<li><code>SELECT</code> * <code>FROM</code> table_name <code>WHERE</code> condition1 <code>AND</code> (condition2 <code>OR</code> condition3);</li>
<li><code>SELECT</code> * <code>FROM</code> table_name <code>WHERE EXISTS</code> (<code>SELECT</code> column_name <code>FROM</code> table_name <code>WHERE</code> condition);</li>
</ul>
<h3><strong>ORDER BY</strong>: ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ sáº¯p xáº¿p káº¿t quáº£ tráº£ vá», theo thá»© tá»± tÄƒng dáº§n (ASC) hoáº·c giáº£m dáº§n (DESC)</h3>
<ul>
<li><code>SELECT</code> * <code>FROM</code> table_name <code>ORDER BY</code> column;</li>
<li><code>SELECT</code> * <code>FROM</code> table_name <code>ORDER BY</code> column <code>DESC</code>;</li>
<li><code>SELECT</code> * <code>FROM</code> table_name <code>ORDER BY</code> column1 <code>ASC</code>, column2 <code>DESC</code>;</li>
</ul>
<h3><strong>SELECT TOP</strong>: ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ chá»‰ Ä‘á»‹nh sá»‘ lÆ°á»£ng báº£n ghi tráº£ vá» tá»« Ä‘áº§u báº£ng</h3>
<ul>
<li><code>SELECT TOP</code> number columns_names <code>FROM</code> table_name <code>WHERE</code> condition;</li>
<li><code>SELECT TOP</code> percent columns_names <code>FROM</code> table_name <code>WHERE</code> condition;</li>
<li>KhÃ´ng pháº£i táº¥t cáº£ cÃ¡c há»‡ thá»‘ng cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘á»u há»— trá»£ <code>SELECT TOP</code>. Trong MySQL, thay vÃ o Ä‘Ã³ sá»­ dá»¥ng <code>LIMIT</code> trong cÃ¢u truy váº¥n.</li>
<li><code>SELECT</code> column_names <code>FROM</code> table_name <code>LIMIT</code> offset, count;</li>
</ul>
<h3><strong>LIKE</strong>: ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ¬m kiáº¿m cÃ¡c máº«u cá»¥ thá»ƒ trong má»™t cá»™t, Ä‘Æ°á»£c sá»­ dá»¥ng trong má»‡nh Ä‘á» WHERE</h3>
<ul>
<li>% (dáº¥u pháº§n trÄƒm) lÃ  kÃ½ tá»± Ä‘áº¡i diá»‡n cho khÃ´ng, má»™t hoáº·c nhiá»u kÃ½ tá»±</li>
<li>_ (gáº¡ch dÆ°á»›i) lÃ  kÃ½ tá»± Ä‘áº¡i diá»‡n cho má»™t kÃ½ tá»± duy nháº¥t</li>
<li><code>SELECT</code> column_names <code>FROM</code> table_name <code>WHERE</code> column_name <code>LIKE</code> pattern;</li>
<li><code>LIKE</code> â€˜a%â€™ (tÃ¬m kiáº¿m báº¥t ká»³ giÃ¡ trá»‹ nÃ o báº¯t Ä‘áº§u báº±ng "a")</li>
<li><code>LIKE</code> â€˜%aâ€™ (tÃ¬m kiáº¿m báº¥t ká»³ giÃ¡ trá»‹ nÃ o káº¿t thÃºc báº±ng "a")</li>
<li><code>LIKE</code> â€˜%or%â€™ (tÃ¬m kiáº¿m báº¥t ká»³ giÃ¡ trá»‹ nÃ o chá»©a "or")</li>
<li><code>LIKE</code> â€˜_r%â€™ (tÃ¬m kiáº¿m báº¥t ká»³ giÃ¡ trá»‹ nÃ o cÃ³ kÃ½ tá»± thá»© hai lÃ  "r")</li>
<li><code>LIKE</code> â€˜a*%*%â€™ (tÃ¬m kiáº¿m báº¥t ká»³ giÃ¡ trá»‹ nÃ o báº¯t Ä‘áº§u báº±ng "a" vÃ  cÃ³ Ä‘á»™ dÃ i Ã­t nháº¥t lÃ  3)</li>
<li><code>LIKE</code> â€˜[a-c]%â€™ (tÃ¬m kiáº¿m báº¥t ká»³ giÃ¡ trá»‹ nÃ o báº¯t Ä‘áº§u báº±ng "a" hoáº·c "b" hoáº·c "c")</li>
</ul>
<h3><strong>IN</strong>: ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ chá»‰ Ä‘á»‹nh nhiá»u giÃ¡ trá»‹ trong má»‡nh Ä‘á» WHERE</h3>
<ul>
<li>Thá»±c cháº¥t, toÃ¡n tá»­ IN lÃ  viáº¿t táº¯t cá»§a nhiá»u Ä‘iá»u kiá»‡n OR</li>
<li><code>SELECT</code> column_names <code>FROM</code> table_name <code>WHERE</code> column_name <code>IN</code> (value1, value2, â€¦);</li>
<li><code>SELECT</code> column_names <code>FROM</code> table_name <code>WHERE</code> column_name <code>IN</code> (<code>SELECT STATEMENT</code>);</li>
</ul>
<h3><strong>BETWEEN</strong>: ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ lá»c cÃ¡c giÃ¡ trá»‹ trong má»™t pháº¡m vi Ä‘Ã£ cho</h3>
<ul>
<li><code>SELECT</code> column_names <code>FROM</code> table_name <code>WHERE</code> column_name <code>BETWEEN</code> value1 <code>AND</code> value2;</li>
<li><code>SELECT</code> * <code>FROM</code> Products <code>WHERE</code> (column_name <code>BETWEEN</code> value1 <code>AND</code> value2) <code>AND NOT</code> column_name2 <code>IN</code> (value3, value4);</li>
<li><code>SELECT</code> * <code>FROM</code> Products <code>WHERE</code> column_name <code>BETWEEN</code> #01/07/1999# AND #03/12/1999#;</li>
</ul>
<h3><strong>NULL</strong>: Äáº¡i diá»‡n cho má»™t trÆ°á»ng khÃ´ng cÃ³ giÃ¡ trá»‹</h3>
<ul>
<li><code>SELECT</code> * <code>FROM</code> table_name <code>WHERE</code> column_name <code>IS NULL</code>;</li>
<li><code>SELECT</code> * <code>FROM</code> table_name <code>WHERE</code> column_name <code>IS NOT NULL</code>;</li>
</ul>
<h3><strong>AS</strong>: ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘áº·t tÃªn bÃ­ danh cho báº£ng hoáº·c cá»™t</h3>
<ul>
<li><code>SELECT</code> column_name <code>AS</code> alias_name <code>FROM</code> table_name;</li>
<li><code>SELECT</code> column_name <code>FROM</code> table_name <code>AS</code> alias_name;</li>
<li><code>SELECT</code> column_name <code>AS</code> alias_name1, column_name2 <code>AS</code> alias_name2;</li>
<li><code>SELECT</code> column_name1, column_name2 + â€˜, â€˜ + column_name3 <code>AS</code> alias_name;</li>
</ul>
<h3><strong>UNION</strong>: ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ káº¿t há»£p káº¿t quáº£ cá»§a hai hoáº·c nhiá»u cÃ¢u truy váº¥n SELECT</h3>
<ul>
<li>Má»—i cÃ¢u truy váº¥n SELECT pháº£i cÃ³ cÃ¹ng sá»‘ cá»™t</li>
<li>CÃ¡c cá»™t pháº£i cÃ³ cÃ¹ng kiá»ƒu dá»¯ liá»‡u tÆ°Æ¡ng tá»±</li>
<li>CÃ¡c cá»™t trong má»—i cÃ¢u truy váº¥n SELECT cÅ©ng pháº£i cÃ³ cÃ¹ng thá»© tá»±</li>
<li><code>SELECT</code> columns_names <code>FROM</code> table1 <code>UNION SELECT</code> column_name <code>FROM</code> table2;</li>
<li><code>UNION</code> chá»‰ cho phÃ©p lá»±a chá»n cÃ¡c giÃ¡ trá»‹ khÃ¡c nhau, <code>UNION ALL</code> cho phÃ©p lá»±a chá»n trÃ¹ng láº·p</li>
</ul>
<h3><strong>ANY|ALL</strong>: ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ kiá»ƒm tra cÃ¡c Ä‘iá»u kiá»‡n cá»§a má»‡nh Ä‘á» con trong má»‡nh Ä‘á» WHERE hoáº·c HAVING</h3>
<ul>
<li><code>ANY</code> tráº£ vá» true náº¿u báº¥t ká»³ giÃ¡ trá»‹ con cá»§a cÃ¢u truy váº¥n thá»a mÃ£n Ä‘iá»u kiá»‡n.</li>
<li><code>ALL</code> tráº£ vá» true náº¿u táº¥t cáº£ cÃ¡c giÃ¡ trá»‹ con cá»§a cÃ¢u truy váº¥n Ä‘á»u thá»a mÃ£n Ä‘iá»u kiá»‡n.</li>
<li><code>SELECT</code> columns_names <code>FROM</code> table1 <code>WHERE</code> column_name operator (<code>ANY</code>|<code>ALL</code>) (<code>SELECT</code> column_name <code>FROM</code> table_name <code>WHERE</code> condition);</li>
</ul>
<h3><strong>GROUP BY</strong>: ThÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng cÃ¹ng vá»›i cÃ¡c hÃ m tá»•ng há»£p (COUNT, MAX, MIN, SUM, AVG), Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ nhÃ³m káº¿t quáº£ thÃ nh má»™t hoáº·c nhiá»u cá»™t</h3>
<ul>
<li><code>SELECT</code> column_name1, COUNT(column_name2) <code>FROM</code> table_name <code>WHERE</code> condition <code>GROUP BY</code> column_name1 <code>ORDER BY</code> COUNT(column_name2) DESC;</li>
</ul>
<h3><strong>HAVING</strong>: Má»‡nh Ä‘á» HAVING chá»‰ Ä‘á»‹nh ráº±ng cÃ¢u truy váº¥n SELECT chá»‰ nÃªn tráº£ vá» cÃ¡c giÃ¡ trá»‹ tá»•ng há»£p thá»a mÃ£n Ä‘iá»u kiá»‡n Ä‘Ã£ chá»‰ Ä‘á»‹nh. NÃ³ Ä‘Æ°á»£c thÃªm vÃ o SQL vÃ¬ tá»« khÃ³a WHERE khÃ´ng thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng vá»›i cÃ¡c hÃ m tá»•ng há»£p.</h3>
<ul>
<li><code>SELECT</code> <code>COUNT</code>(column_name1), column_name2 <code>FROM</code> table <code>GROUP BY</code> column_name2 <code>HAVING</code> <code>COUNT(</code>column_name1<code>)</code> &gt; 5;</li>
</ul>
<h2>CÃ¢u truy váº¥n Ä‘á»ƒ thay Ä‘á»•i dá»¯ liá»‡u</h2>
<h3><strong>INSERT INTO</strong>: ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ chÃ¨n báº£n ghi/hÃ ng má»›i vÃ o báº£ng</h3>
<ul>
<li><code>INSERT INTO</code> table_name (column1, column2) <code>VALUES</code> (value1, value2);</li>
<li><code>INSERT INTO</code> table_name <code>VALUES</code> (value1, value2 â€¦);</li>
</ul>
<h3><strong>UPDATE</strong>: ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ sá»­a Ä‘á»•i cÃ¡c báº£n ghi/hÃ ng hiá»‡n cÃ³ trong báº£ng</h3>
<ul>
<li><code>UPDATE</code> table_name <code>SET</code> column1 = value1, column2 = value2 <code>WHERE</code> condition;</li>
<li><code>UPDATE</code> table_name <code>SET</code> column_name = value;</li>
</ul>
<h3><strong>DELETE</strong>: ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ xÃ³a cÃ¡c báº£n ghi/hÃ ng hiá»‡n cÃ³ trong báº£ng</h3>
<ul>
<li><code>DELETE FROM</code> table_name <code>WHERE</code> condition;</li>
<li><code>DELETE</code> * <code>FROM</code> table_name;</li>
</ul>
<h2>CÃ¢u truy váº¥n tá»•ng há»£p</h2>
<h3><strong>COUNT</strong>: Tráº£ vá» sá»‘ láº§n xuáº¥t hiá»‡n</h3>
<ul>
<li><code>SELECT COUNT (DISTINCT</code> column_name<code>)</code>;</li>
</ul>
<h3><strong>MIN() vÃ  MAX()</strong>: Tráº£ vá» giÃ¡ trá»‹ nhá» nháº¥t/lá»›n nháº¥t cá»§a cá»™t Ä‘Ã£ chá»n</h3>
<ul>
<li><code>SELECT MIN (</code>column_names<code>) FROM</code> table_name <code>WHERE</code> condition;</li>
<li><code>SELECT MAX (</code>column_names<code>) FROM</code> table_name <code>WHERE</code> condition;</li>
</ul>
<h3><strong>AVG()</strong>: Tráº£ vá» giÃ¡ trá»‹ trung bÃ¬nh cá»§a cá»™t sá»‘</h3>
<ul>
<li><code>SELECT AVG (</code>column_name<code>) FROM</code> table_name <code>WHERE</code> condition;</li>
</ul>
<h3><strong>SUM()</strong>: Tráº£ vá» tá»•ng cÃ¡c giÃ¡ trá»‹ cá»§a cá»™t sá»‘</h3>
<ul>
<li><code>SELECT SUM (</code>column_name<code>) FROM</code> table_name <code>WHERE</code> condition;</li>
</ul>
<h2>CÃ¢u truy váº¥n káº¿t ná»‘i</h2>
<h3><strong>INNER JOIN</strong>: Káº¿t ná»‘i trong, tráº£ vá» cÃ¡c báº£n ghi cÃ³ giÃ¡ trá»‹ khá»›p trong hai báº£ng</h3>
<ul>
<li><code>SELECT</code> column_names <code>FROM</code> table1 <code>INNER JOIN</code> table2 <code>ON</code> table1.column_name=table2.column_name;</li>
<li><code>SELECT</code> table1.column_name1, table2.column_name2, table3.column_name3 <code>FROM</code> ((table1 <code>INNER JOIN</code> table2 <code>ON</code> relationship) <code>INNER JOIN</code> table3 <code>ON</code> relationship);</li>
</ul>
<h3><strong>LEFT (OUTER) JOIN</strong>: Káº¿t ná»‘i ngoÃ i trÃ¡i, tráº£ vá» táº¥t cáº£ cÃ¡c báº£n ghi trong báº£ng trÃ¡i (table1) vÃ  cÃ¡c báº£n ghi khá»›p trong báº£ng pháº£i (table2)</h3>
<ul>
<li><code>SELECT</code> column_names <code>FROM</code> table1 <code>LEFT JOIN</code> table2 <code>ON</code> table1.column_name=table2.column_name;</li>
</ul>
<h3><strong>RIGHT (OUTER) JOIN</strong>: Káº¿t ná»‘i ngoÃ i pháº£i, tráº£ vá» táº¥t cáº£ cÃ¡c báº£n ghi trong báº£ng pháº£i (table2) vÃ  cÃ¡c báº£n ghi khá»›p trong báº£ng trÃ¡i (table1)</h3>
<ul>
<li><code>SELECT</code> column_names <code>FROM</code> table1 <code>RIGHT JOIN</code> table2 <code>ON</code> table1.column_name=table2.column_name;</li>
</ul>
<h3><strong>FULL (OUTER) JOIN</strong>: Káº¿t ná»‘i ngoÃ i Ä‘áº§y Ä‘á»§, káº¿t há»£p cá»§a káº¿t ná»‘i ngoÃ i trÃ¡i vÃ  káº¿t ná»‘i ngoÃ i pháº£i. Báº£ng káº¿t ná»‘i bao gá»“m táº¥t cáº£ cÃ¡c báº£n ghi tá»« báº£ng Ä‘Æ°á»£c káº¿t ná»‘i, náº¿u thiáº¿u báº£n ghi khá»›p, sáº½ Ä‘Æ°á»£c Ä‘iá»n báº±ng NULL.</h3>
<ul>
<li><code>SELECT</code> column_names <code>FROM</code> table1 <code>FULL OUTER JOIN</code> table2 <code>ON</code> table1.column_name=table2.column_name;</li>
</ul>
<h3><strong>Self JOIN</strong>: Káº¿t ná»‘i tá»± thÃ¢n, káº¿t ná»‘i báº£ng vá»›i chÃ­nh nÃ³</h3>
<ul>
<li><code>SELECT</code> column_names <code>FROM</code> table1 T1, table1 T2 <code>WHERE</code> condition;</li>
</ul>
<h2>CÃ¢u truy váº¥n xem</h2>
<h3><strong>CREATE</strong>: Táº¡o xem</h3>
<ul>
<li><code>CREATE VIEW</code> view_name <code>AS SELECT</code> column1, column2 <code>FROM</code> table_name <code>WHERE</code> condition;</li>
</ul>
<h3><strong>SELECT</strong>: Truy xuáº¥t xem</h3>
<ul>
<li><code>SELECT</code> * <code>FROM</code> view_name;</li>
</ul>
<h3><strong>DROP</strong>: XÃ³a xem</h3>
<ul>
<li><code>DROP VIEW</code> view_name;</li>
</ul>
<h2>CÃ¢u truy váº¥n Ä‘á»ƒ sá»­a Ä‘á»•i báº£ng</h2>
<h3><strong>ADD</strong>: ThÃªm cá»™t</h3>
<ul>
<li><code>ALTER TABLE</code> table_name <code>ADD</code> column_name column_definition;</li>
</ul>
<h3><strong>MODIFY</strong>: Sá»­a Ä‘á»•i kiá»ƒu dá»¯ liá»‡u cá»™t</h3>
<ul>
<li><code>ALTER TABLE</code> table_name <code>MODIFY</code> column_name column_type;</li>
</ul>
<h3><strong>DROP</strong>: XÃ³a cá»™t</h3>
<ul>
<li><code>ALTER TABLE</code> table_name <code>DROP COLUMN</code> column_name;</li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>SQL DB Design Process</title>
      <link>https://vanhung4499.github.io/database/sql/db-design-process.html</link>
      <guid>https://vanhung4499.github.io/database/sql/db-design-process.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">SQL DB Design Process</source>
      <description>Todo</description>
      <category>db</category>
      <category>sql</category>
      <category>design</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
]]></content:encoded>
    </item>
    <item>
      <title>Extend SQL</title>
      <link>https://vanhung4499.github.io/database/sql/extend-sql.html</link>
      <guid>https://vanhung4499.github.io/database/sql/extend-sql.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Extend SQL</source>
      <description>Má»Ÿ rá»™ng SQL CÆ¡ sá»Ÿ dá»¯ liá»‡u Báº£ng Xem thÃ´ng tin cÆ¡ báº£n cá»§a báº£ng Xem thÃ´ng tin cá»™t cá»§a báº£ng LÃ m tháº¿ nÃ o Ä‘á»ƒ xÃ³a má»™t lÆ°á»£ng lá»›n dá»¯ liá»‡u Náº¿u báº¡n muá»‘n xÃ³a má»™t lÆ°á»£ng lá»›n dá»¯ liá»‡u dá»±a trÃªn ...</description>
      <category>db</category>
      <category>sql</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>CÆ¡ sá»Ÿ dá»¯ liá»‡u</h2>
<h2>Báº£ng</h2>
<h3>Xem thÃ´ng tin cÆ¡ báº£n cá»§a báº£ng</h3>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SELECT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> * </span><span style="color:#C678DD;--shiki-dark:#C678DD">FROM</span><span style="color:#D19A66;--shiki-dark:#D19A66"> information_schema</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">tables</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">WHERE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> table_schema </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379"> 'test'</span><span style="color:#C678DD;--shiki-dark:#C678DD"> AND</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> table_name </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379"> 'user'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span></code></pre>
</div><h3>Xem thÃ´ng tin cá»™t cá»§a báº£ng</h3>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SELECT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> * </span><span style="color:#C678DD;--shiki-dark:#C678DD">FROM</span><span style="color:#D19A66;--shiki-dark:#D19A66"> information_schema</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">columns</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">WHERE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> table_schema </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379"> 'test'</span><span style="color:#C678DD;--shiki-dark:#C678DD"> AND</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> table_name </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379"> 'user'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span></code></pre>
</div><h3>LÃ m tháº¿ nÃ o Ä‘á»ƒ xÃ³a má»™t lÆ°á»£ng lá»›n dá»¯ liá»‡u</h3>
<p>Náº¿u báº¡n muá»‘n xÃ³a má»™t lÆ°á»£ng lá»›n dá»¯ liá»‡u dá»±a trÃªn má»™t khoáº£ng thá»i gian, cÃ¢u lá»‡nh Ä‘Æ¡n giáº£n nhÆ° sau:</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">DELETE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> FROM</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> orders</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">WHERE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> timestamp</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> &lt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> SUBDATE(CURDATE(), INTERVAL </span><span style="color:#D19A66;--shiki-dark:#D19A66">3</span><span style="color:#C678DD;--shiki-dark:#C678DD"> month</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">);</span></span></code></pre>
</div><p>CÃ¢u lá»‡nh trÃªn cÃ³ kháº£ nÄƒng gÃ¢y lá»—i khi thá»±c thi, bÃ¡o lá»—i xÃ³a khÃ´ng thÃ nh cÃ´ng, vÃ¬ lÆ°á»£ng dá»¯ liá»‡u cáº§n xÃ³a quÃ¡ lá»›n, vÃ¬ váº­y cáº§n xÃ³a theo tá»«ng pháº§n.</p>
<p>Báº¡n cÃ³ thá»ƒ trÆ°á»›c tiÃªn tÃ¬m ra ID Ä‘Æ¡n hÃ ng cÅ© nháº¥t trong cÃ¡c Ä‘Æ¡n hÃ ng lá»‹ch sá»­ thá»a mÃ£n Ä‘iá»u kiá»‡n, sau Ä‘Ã³ chuyá»ƒn Ä‘iá»u kiá»‡n xÃ³a thÃ nh xÃ³a theo khÃ³a chÃ­nh.</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SELECT</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> MAX</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(id) </span><span style="color:#C678DD;--shiki-dark:#C678DD">FROM</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> orders</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">WHERE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> timestamp</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> &lt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> SUBDATE(CURDATE(), INTERVAL </span><span style="color:#D19A66;--shiki-dark:#D19A66">3</span><span style="color:#C678DD;--shiki-dark:#C678DD"> month</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- XÃ³a theo tá»«ng pháº§n, ? Ä‘iá»n vÃ o giÃ¡ trá»‹ ID lá»›n nháº¥t tÃ¬m Ä‘Æ°á»£c tá»« cÃ¢u lá»‡nh trÃªn</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">DELETE</span><span style="color:#C678DD;--shiki-dark:#C678DD"> FROM</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> orders</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">WHERE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> id </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&lt;=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> ?</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">ORDER BY</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> id </span><span style="color:#C678DD;--shiki-dark:#C678DD">LIMIT</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1000</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span></code></pre>
</div><h3>Thay Ä‘á»•i Ä‘á»‹nh dáº¡ng mÃ£ hÃ³a cá»§a báº£ng</h3>
<p>MÃ£ hÃ³a utf8mb4 lÃ  má»™t phiÃªn báº£n má»Ÿ rá»™ng cá»§a utf8, tÆ°Æ¡ng thÃ­ch vá»›i utf8 vÃ  cÃ³ thá»ƒ lÆ°u trá»¯ cÃ¡c kÃ½ tá»± biá»ƒu tÆ°á»£ng cáº£m xÃºc 4 byte. Náº¿u mÃ£ hÃ³a cá»§a báº£ng Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh lÃ  utf8, sáº½ xáº£y ra lá»—i khi lÆ°u trá»¯ trÆ°á»ng emoji.</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">ALTER</span><span style="color:#C678DD;--shiki-dark:#C678DD"> TABLE</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> &lt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">tableName</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> CONVERT </span><span style="color:#C678DD;--shiki-dark:#C678DD">TO</span><span style="color:#C678DD;--shiki-dark:#C678DD"> CHARACTER</span><span style="color:#C678DD;--shiki-dark:#C678DD"> SET</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> utf8mb4 </span><span style="color:#C678DD;--shiki-dark:#C678DD">COLLATE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> utf8mb4_general_ci;</span></span></code></pre>
</div><h2>KhÃ¡c</h2>
<h3>Hiá»ƒn thá»‹ cÃ¡c tiáº¿n trÃ¬nh Ä‘ang cháº¡y</h3>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">mysql</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> show processlist;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">+</span></span></code></pre>
</div>]]></content:encoded>
    </item>
    <item>
      <title>How SQL DB works?</title>
      <link>https://vanhung4499.github.io/database/sql/how-sql-db-works.html</link>
      <guid>https://vanhung4499.github.io/database/sql/how-sql-db-works.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">How SQL DB works?</source>
      <description>Báº¯t Ä‘áº§u vá»›i Data Structure &amp; Algorithm Äá»™ phá»©c táº¡p thá»i gian Äá»‘i vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, Ä‘iá»u quan trá»ng khÃ´ng pháº£i lÃ  khá»‘i lÆ°á»£ng dá»¯ liá»‡u, mÃ  lÃ  lÃ m tháº¿ nÃ o cÃ¡c hoáº¡t Ä‘á»™ng tÄƒng lÃªn kh...</description>
      <category>sql</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[<h2>Báº¯t Ä‘áº§u vá»›i Data Structure &amp; Algorithm</h2>
<h3>Äá»™ phá»©c táº¡p thá»i gian</h3>
<blockquote>
<p>Äá»‘i vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, Ä‘iá»u quan trá»ng khÃ´ng pháº£i lÃ  khá»‘i lÆ°á»£ng dá»¯ liá»‡u, mÃ  lÃ  lÃ m tháº¿ nÃ o cÃ¡c hoáº¡t Ä‘á»™ng tÄƒng lÃªn khi khá»‘i lÆ°á»£ng dá»¯ liá»‡u tÄƒng lÃªn.</p>
</blockquote>
<p>Äá»™ phá»©c táº¡p thuáº­t toÃ¡n kÃ©o theo Ä‘á»™ phá»©c táº¡p thá»i gian (time complexity) vÃ  Ä‘á»™ phá»©c táº¡p khÃ´ng gian (space complexity). Vui lÃ²ng Ä‘á»c [[Complexity Analysis]]</p>
<h3>[[Merge Sort]]</h3>
<blockquote>
<p>Äá»‘i vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, báº¡n cáº§n pháº£i hiá»ƒu cÃ¡ch thá»©c hoáº¡t Ä‘á»™ng cá»§a hÃ m sort() nÃ y.</p>
</blockquote>
<p>[[Merge Sort]] chia bÃ i toÃ¡n lá»›n thÃ nh cÃ¡c bÃ i toÃ¡n nhá», giáº£i quyáº¿t bÃ i toÃ¡n ban Ä‘áº§u báº±ng cÃ¡ch giáº£i quyáº¿t cÃ¡c bÃ i toÃ¡n nhá». Thuáº­t toÃ¡n nÃ y theo tÆ° tÆ°á»Ÿng chia Ä‘á»ƒ trá»‹ (deidve and conquer)</p>
<p><strong>Táº¡i sao láº¡i lÃ  Merge Sort?</strong></p>
<ul>
<li>Báº¡n cÃ³ thá»ƒ thay Ä‘á»•i thuáº­t toÃ¡n Ä‘á»ƒ tiáº¿t kiá»‡m khÃ´ng gian bá»™ nhá»› báº±ng cÃ¡ch khÃ´ng táº¡o chuá»—i má»›i mÃ  thay Ä‘á»•i trá»±c tiáº¿p chuá»—i Ä‘áº§u vÃ o. LÆ°u Ã½: Thuáº­t toÃ¡n nÃ y Ä‘Æ°á»£c gá»i lÃ  <strong>in-place algorithm</strong></li>
<li>Báº¡n cÃ³ thá»ƒ thay Ä‘á»•i thuáº­t toÃ¡n Ä‘á»ƒ báº¡n cÃ³ thá»ƒ trÃ¡nh Disk I/O khá»•ng lá»“ báº±ng cÃ¡ch sá»­ dá»¥ng cáº£ dung lÆ°á»£ng Ä‘Ä©a vÃ  má»™t lÆ°á»£ng nhá» bá»™ nhá»›. PhÆ°Æ¡ng phÃ¡p lÃ  chá»‰ táº£i cÃ¡c pháº§n hiá»‡n Ä‘ang Ä‘Æ°á»£c xá»­ lÃ½ vÃ o bá»™ nhá»›. ÄÃ¢y lÃ  má»™t ká»¹ thuáº­t quan trá»ng khi sáº¯p xáº¿p má»™t vÃ i GB báº£ng trong bá»™ Ä‘á»‡m bá»™ nhá»› chá»‰ 100MB. LÆ°u Ã½: Thuáº­t toÃ¡n nÃ y Ä‘Æ°á»£c gá»i lÃ  <strong>external sorting</strong>.</li>
<li>Báº¡n cÃ³ thá»ƒ thay Ä‘á»•i thuáº­t toÃ¡n Ä‘á»ƒ dá»… dÃ ng cháº¡y trÃªn Ä‘a nhÃ¢n / Ä‘a luá»“ng / Ä‘a mÃ¡y chá»§. VÃ­ dá»¥, sáº¯p xáº¿p há»£p nháº¥t phÃ¢n tÃ¡n lÃ  má»™t trong nhá»¯ng thÃ nh pháº§n quan trá»ng cá»§a <strong>Hadoop</strong>, má»™t big data framework ná»•i tiáº¿ng.</li>
</ul>
<h3>[[Binary Search Tree]]</h3>
<blockquote>
<p>Äá»™ phá»©c táº¡p thá»i gian cá»§a truy váº¥n trong cÆ¡ sá»Ÿ dá»¯ liá»‡u lÃ  khÃ´ng thá»ƒ sá»­ dá»¥ng ma tráº­n, thay vÃ o Ä‘Ã³ sá»­ dá»¥ng Binary Search Tree (BST), vui lÃ²ng xem [[Binary Search Tree]]</p>
</blockquote>
<ul>
<li>[[Binary Search Tree]] chá»‰ yÃªu cáº§u truy cáº¥n O(log(n)), trong khi náº¿u báº¡n sá»­ dá»¥ng máº£ng trá»±c tiáº¿p, báº¡n sáº½ cáº§n truy váº¥n O(n)</li>
</ul>
<h3>[[B Tree]]</h3>
<blockquote>
<p>Tree lÃ m viá»‡c tá»‘t vá»›i viá»‡c tÃ¬m má»™t giÃ¡ trá»‹ cá»¥ thá»ƒ, nhÆ°ng khi báº¡n cáº§n pháº£i <strong>tÃ¬m nhiá»u yáº¿u tá»‘ giá»¯a hai giÃ¡ trá»‹</strong>, báº¡n cÃ³ thá»ƒ gáº·p ráº¯c rá»‘i lá»›n. Chi phÃ­ cá»§a báº¡n sáº½ lÃ  O(N) vÃ¬ báº¡n pháº£i tÃ¬m má»—i nÃºt cá»§a cÃ¢y Ä‘á»ƒ xÃ¡c Ä‘á»‹nh xem nÃ³ cÃ³ náº±m giá»¯a 2 giÃ¡ trá»‹ Ä‘Ã³ hay khÃ´ng (vÃ­ dá»¥: sá»­ dá»¥ng inorder traversal trÃªn cÃ¢y). VÃ  thao tÃ¡c nÃ y khÃ´ng pháº£i lÃ  thuáº­n lá»£i cho Disk I/O, bá»Ÿi vÃ¬ báº¡n pháº£i Ä‘á»c toÃ n bá»™ cÃ¢y. ChÃºng ta cáº§n pháº£i tÃ¬m má»™t phÆ°Æ¡ng phÃ¡p truy váº¥n pháº¡m vi hiá»‡u quáº£.</p>
</blockquote>
<p><strong>Náº¿u báº¡n thÃªm hoáº·c xÃ³a má»™t hÃ ng trong cÆ¡ sá»Ÿ dá»¯ liá»‡u</strong>&nbsp;(do Ä‘Ã³ trong chá»‰ má»¥c cÃ¢y B + cÃ³ liÃªn quan):</p>
<ul>
<li>Báº¡n pháº£i duy trÃ¬ thá»© tá»± giá»¯a cÃ¡c nÃºt trong B+ Tree, náº¿u khÃ´ng cÃ¡c nÃºt sáº½ trá»Ÿ nÃªn lá»™n xá»™n vÃ  báº¡n khÃ´ng thá»ƒ tÃ¬m tháº¥y nÃºt báº¡n muá»‘n.</li>
<li>Báº¡n pháº£i giáº£m thiá»ƒu sá»‘ lá»›p cá»§a B+ Tree, náº¿u khÃ´ng Ä‘á»™ phá»©c táº¡p cá»§a O (log(N) sáº½ trá»Ÿ thÃ nh O (N</li>
</ul>
<p>NÃ³i cÃ¡ch khÃ¡c, [[B Tree]] cáº§n pháº£i tá»± sáº¯p xáº¿p vÃ  tá»± cÃ¢n báº±ng. Ráº¥t may, chÃºng cÃ³ xÃ³a vÃ  chÃ¨n thÃ´ng minh. NhÆ°ng Ä‘iá»u nÃ y cÅ©ng mang láº¡i chi phÃ­: trong B+ Tree, chÃ¨n vÃ  xÃ³a lÃ  Ä‘á»™ phá»©c táº¡p O(log(N). VÃ¬ váº­y, má»™t sá»‘ ngÆ°á»i Ä‘Ã£ nghe nÃ³i ráº±ng sá»­ dá»¥ng quÃ¡ nhiá»u Index khÃ´ng pháº£i lÃ  má»™t Ã½ tÆ°á»Ÿng tá»‘t nhÆ° váº­y. ÄÃºng váº­y, báº¡n Ä‘Ã£ lÃ m cháº­m hoáº¡t Ä‘á»™ng cá»§a má»™t hÃ ng trong báº£ng chÃ¨n/cáº­p nháº­t/xÃ³a nhanh chÃ³ng vÃ¬ cÆ¡ sá»Ÿ dá»¯ liá»‡u cáº§n pháº£i cáº­p nháº­t chá»‰ má»¥c cá»§a báº£ng vá»›i chi phÃ­ cao cho má»—i hoáº¡t Ä‘á»™ng O(log(N). HÆ¡n ná»¯a, tÄƒng chá»‰ má»¥c cÃ³ nghÄ©a lÃ  mang láº¡i nhiá»u khá»‘i lÆ°á»£ng cÃ´ng viá»‡c hÆ¡n cho Transaction Manager (sáº½ Ä‘Æ°á»£c Ä‘á» cáº­p phÃ­a dÆ°á»›i).</p>
<h3>Hash Table</h3>
<blockquote>
<p>[[Hash Table]] ráº¥t há»¯u Ã­ch khi báº¡n muá»‘n tÃ¬m cÃ¡c giÃ¡ trá»‹ má»™t cÃ¡ch nhanh chÃ³ng. HÆ¡n ná»¯a, sá»± hiá»ƒu biáº¿t vá» Hash Table sáº½ giÃºp chÃºng ta hiá»ƒu cÃ¡c hoáº¡t Ä‘á»™ng káº¿t ná»‘i phá»• biáº¿n tiáº¿p theo cá»§a má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘Æ°á»£c gá»i lÃ  "hash connection". <strong>Cáº¥u trÃºc dá»¯ liá»‡u nÃ y cÅ©ng Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘á»ƒ lÆ°u má»™t cÃ¡i gÃ¬ Ä‘Ã³ bÃªn trong</strong> (cháº³ng háº¡n nhÆ° <strong>báº£ng khÃ³a</strong> hoáº·c <strong>vÃ¹ng Ä‘á»‡m</strong>, mÃ  sáº½ nghiÃªn cá»©u dÆ°á»›i Ä‘Ã¢y)</p>
</blockquote>
<p><strong>Táº¡i sao khÃ´ng sá»­ dá»¥ng máº£ng</strong>?</p>
<ul>
<li>Náº¿u cÃ³ má»™t hash function tá»‘t, Ä‘á»™ phá»©c táº¡p thá»i gian tÃ¬m kiáº¿m trong [[Hash Table]] lÃ  O(1).</li>
<li><strong>Má»™t [[Hash Table]] cÃ³ thá»ƒ Ä‘Æ°á»£c náº¡p chá»‰ má»™t ná»­a vÃ o bá»™ nhá»›, vÃ  hash bucket cÃ²n láº¡i cÃ³ thá»ƒ Ä‘Æ°á»£c giá»¯ láº¡i trÃªn Ä‘Ä©a cá»©ng</strong>.</li>
<li>Vá»›i máº£ng, báº¡n cáº§n má»™t khÃ´ng gian bá»™ nhá»› liÃªn tá»¥c. Náº¿u báº¡n táº£i má»™t báº£ng lá»›n, tháº­t khÃ³ Ä‘á»ƒ phÃ¢n bá»• Ä‘á»§ khÃ´ng gian bá»™ nhá»› liÃªn tá»¥c.</li>
</ul>
<h2>Tá»•ng quan SQL DB</h2>
<p>CÆ¡ sá»Ÿ dá»¯ liá»‡u (database) thÆ°á»ng cÃ³ thá»ƒ Ä‘Æ°á»£c hiá»ƒu báº±ng cÃ¡ch sá»­ dá»¥ng Ä‘á»“ há»a sau:</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/Pasted image 20230604124944.png" alt="Pasted image 20230604124944" tabindex="0" loading="lazy"><figcaption>Pasted image 20230604124944</figcaption></figure>
<h3>CÃ¡c thÃ nh pháº§n cá»‘t lÃµi (Core Components)</h3>
<ul>
<li>
<p><strong>TrÃ¬nh quáº£n lÃ½ quy trÃ¬nh (process manager):</strong> Nhiá»u cÆ¡ sá»Ÿ dá»¯ liá»‡u cÃ³ process/thread pool cáº§n Ä‘Æ°á»£c quáº£n lÃ½ Ä‘Ãºng cÃ¡ch. HÆ¡n ná»¯a, Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c hoáº¡t Ä‘á»™ng trong nanosecond, má»™t sá»‘ cÆ¡ sá»Ÿ dá»¯ liá»‡u hiá»‡n Ä‘áº¡i sá»­ dá»¥ng thread riÃªng cá»§a há» thay vÃ¬ OS thread.</p>
</li>
<li>
<p><strong>Network manager</strong>: Internet I/O lÃ  má»™t váº¥n Ä‘á» lá»›n, Ä‘áº·c biá»‡t lÃ  Ä‘á»‘i vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u phÃ¢n tÃ¡n. VÃ¬ váº­y, má»™t sá»‘ cÆ¡ sá»Ÿ dá»¯ liá»‡u cÃ³ trÃ¬nh quáº£n lÃ½ máº¡ng riÃªng.</p>
</li>
<li>
<p>**TrÃ¬nh quáº£n lÃ½ há»‡ thá»‘ng tá»‡p (File system manager)ğŸ˜—*Disk I/O lÃ  nÃºt tháº¯t cá»• chai chÃ­nh cá»§a cÆ¡ sá»Ÿ dá»¯ liá»‡u. NÃ³ lÃ  ráº¥t quan trá»ng Ä‘á»ƒ cÃ³ má»™t trÃ¬nh quáº£n lÃ½ há»‡ thá»‘ng táº­p tin Ä‘á»ƒ xá»­ lÃ½ hoÃ n háº£o há»‡ thá»‘ng táº­p tin OS hoáº·c tháº­m chÃ­ thay tháº¿ há»‡ thá»‘ng táº­p tin OS.</p>
</li>
<li>
<p><strong>Memory manager</strong>: Äá»ƒ trÃ¡nh giáº£m hiá»‡u suáº¥t do disk I/O gÃ¢y ra, cáº§n ráº¥t nhiá»u bá»™ nhá»›. NhÆ°ng náº¿u báº¡n muá»‘n xá»­ lÃ½ bá»™ nhá»› dung lÆ°á»£ng lá»›n, báº¡n cáº§n trÃ¬nh quáº£n lÃ½ bá»™ nhá»› hiá»‡u quáº£, Ä‘áº·c biá»‡t lÃ  khi báº¡n cÃ³ ráº¥t nhiá»u truy váº¥n Ä‘á»ƒ sá»­ dá»¥ng bá»™ nhá»› cÃ¹ng má»™t lÃºc.</p>
</li>
<li>
<p><strong>Security Manager</strong>: ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ xÃ¡c thá»±c vÃ  phÃ¢n quyá»n ngÆ°á»i dÃ¹ng.</p>
</li>
<li>
<p><strong>TrÃ¬nh quáº£n lÃ½ khÃ¡ch hÃ ng (Client manager):</strong> ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ quáº£n lÃ½ káº¿t ná»‘i khÃ¡ch hÃ ng.</p>
</li>
<li>
<p>â€¦â€¦</p>
</li>
</ul>
<h3>CÃ´ng cá»¥ (Tools)</h3>
<ul>
<li>
<p><strong>TrÃ¬nh quáº£n lÃ½ sao lÆ°u (Backup manager):</strong> ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ lÆ°u vÃ  khÃ´i phá»¥c dá»¯ liá»‡u.</p>
</li>
<li>
<p><strong>TrÃ¬nh quáº£n lÃ½ phá»¥c há»“i (Recovery manager</strong>): ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ khá»Ÿi Ä‘á»™ng láº¡i cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘áº¿n tráº¡ng thÃ¡i nháº¥t quÃ¡n sau khi sá»± cá»‘.</p>
</li>
<li>
<p><strong>Monitor manager</strong>: CÃ´ng cá»¥ Ä‘á»ƒ ghi láº¡i hoáº¡t Ä‘á»™ng cÆ¡ sá»Ÿ dá»¯ liá»‡u vÃ  cung cáº¥p cÆ¡ sá»Ÿ dá»¯ liá»‡u giÃ¡m sÃ¡t.</p>
</li>
<li>
<p><strong>Administration manager</strong>: ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ lÆ°u siÃªu dá»¯ liá»‡u nhÆ° tÃªn vÃ  cáº¥u trÃºc cá»§a báº£ng, cung cáº¥p cÃ¡c cÃ´ng cá»¥ Ä‘á»ƒ quáº£n lÃ½ cÆ¡ sá»Ÿ dá»¯ liá»‡u, máº«u, khÃ´ng gian báº£ng.</p>
</li>
<li>
<p>â€¦â€¦</p>
</li>
</ul>
<h3>TrÃ¬nh quáº£n lÃ½ truy váº¥n (Query Manager)</h3>
<ul>
<li>
<p><strong>TrÃ¬nh phÃ¢n tÃ­ch cÃº phÃ¡p truy váº¥n (Query parser):</strong> ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ kiá»ƒm tra xem truy váº¥n cÃ³ há»£p phÃ¡p hay khÃ´ng</p>
</li>
<li>
<p><strong>TrÃ¬nh viáº¿t láº¡i truy váº¥n (Query Rewriter):</strong> Äá»ƒ tá»‘i Æ°u hÃ³a trÆ°á»›c truy váº¥n</p>
</li>
<li>
<p><strong>TrÃ¬nh tá»‘i Æ°u hÃ³a truy váº¥n (Query Optimizer):</strong> Äá»ƒ tá»‘i Æ°u hÃ³a truy váº¥n</p>
</li>
<li>
<p><strong>TrÃ¬nh thá»±c thi truy váº¥n (Query Executor):</strong> ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ biÃªn dá»‹ch vÃ  thá»±c thi truy váº¥n</p>
</li>
</ul>
<h3>TrÃ¬nh quáº£n lÃ½ dá»¯ liá»‡u (Data Manager)</h3>
<ul>
<li>
<p><strong>TrÃ¬nh quáº£n lÃ½ giao dá»‹ch (Transaction Manager):</strong> ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ xá»­ lÃ½ cÃ¡c giao dá»‹ch</p>
</li>
<li>
<p><strong>TrÃ¬nh quáº£n lÃ½ bá»™ nhá»› cache (Cache Manager)</strong>: Dá»¯ liá»‡u Ä‘Æ°á»£c Ä‘áº·t trong bá»™ nhá»› trÆ°á»›c khi nÃ³ Ä‘Æ°á»£c sá»­ dá»¥ng, hoáº·c trÆ°á»›c khi dá»¯ liá»‡u Ä‘Æ°á»£c ghi vÃ o Ä‘Ä©a</p>
</li>
<li>
<p><strong>TrÃ¬nh quáº£n lÃ½ truy cáº­p dá»¯ liá»‡u (Data Access Manager):</strong> Truy cáº­p dá»¯ liá»‡u trong Ä‘Ä©a</p>
</li>
</ul>
<h2>QuÃ¡ trÃ¬nh truy váº¥n dá»¯ liá»‡u</h2>
<p>ChÆ°Æ¡ng nÃ y táº­p trung vÃ o cÃ¡ch cÆ¡ sá»Ÿ dá»¯ liá»‡u cÃ³ thá»ƒ quáº£n lÃ½ truy váº¥n SQL thÃ´ng qua cÃ¡c quy trÃ¬nh sau:</p>
<ul>
<li>TrÃ¬nh quáº£n lÃ½ khÃ¡ch hÃ ng</li>
<li>TrÃ¬nh quáº£n lÃ½ truy váº¥n</li>
<li>TrÃ¬nh quáº£n lÃ½ dá»¯ liá»‡u (bao gá»“m trÃ¬nh quáº£n lÃ½ phá»¥c há»“i)</li>
<li>TrÃ¬nh quáº£n lÃ½ khÃ¡ch hÃ ng</li>
</ul>
<h2>TrÃ¬nh quáº£n lÃ½ khÃ¡ch hÃ ng (Client Manager)</h2>
<blockquote>
<p>TrÃ¬nh quáº£n lÃ½ khÃ¡ch hÃ ng xá»­ lÃ½ giao tiáº¿p khÃ¡ch hÃ ng. KhÃ¡ch hÃ ng cÃ³ thá»ƒ lÃ  má»™t mÃ¡y chá»§ (trang web) hoáº·c má»™t ngÆ°á»i dÃ¹ng cuá»‘i hoáº·c á»©ng dá»¥ng cuá»‘i cÃ¹ng. TrÃ¬nh quáº£n lÃ½ khÃ¡ch hÃ ng thÃ´ng qua má»™t loáº¡t cÃ¡c API ná»•i tiáº¿ng (JDBC, ODBC, OLE-DB â€¦ ) cung cáº¥p nhá»¯ng cÃ¡ch khÃ¡c nhau Ä‘á»ƒ truy cáº­p vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u. TrÃ¬nh quáº£n lÃ½ khÃ¡ch hÃ ng cÅ©ng cung cáº¥p API truy cáº­p cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘á»™c quyá»n.</p>
</blockquote>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/Pasted image 20230604125929.png" alt="Pasted image 20230604125929" tabindex="0" loading="lazy"><figcaption>Pasted image 20230604125929</figcaption></figure>
<p><strong>Khi báº¡n káº¿t ná»‘i vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u</strong>:</p>
<ul>
<li>TrÃ¬nh quáº£n lÃ½ báº¯t Ä‘áº§u báº±ng cÃ¡ch kiá»ƒm tra thÃ´ng tin xÃ¡c minh (tÃªn ngÆ°á»i dÃ¹ng vÃ  máº­t kháº©u) cá»§a báº¡n vÃ  sau Ä‘Ã³ kiá»ƒm tra xem báº¡n cÃ³ quyá»n truy cáº­p vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u hay khÃ´ng. CÃ¡c quyá»n nÃ y Ä‘Æ°á»£c gÃ¡n bá»Ÿi DBA.</li>
<li>TrÃ¬nh quáº£n lÃ½ sau Ä‘Ã³ kiá»ƒm tra xem cÃ³ má»™t tiáº¿n trÃ¬nh nhÃ n rá»—i (hoáº·c luá»“ng) Ä‘á»ƒ xá»­ lÃ½ truy váº¥n cá»§a báº¡n khÃ´ng?</li>
<li>TrÃ¬nh quáº£n lÃ½ cÅ©ng kiá»ƒm tra xem cÆ¡ sá»Ÿ dá»¯ liá»‡u cÃ³ táº£i náº·ng hay khÃ´ng?</li>
<li>TrÃ¬nh quáº£n lÃ½ cÃ³ thá»ƒ chá» má»™t lÃºc Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c tÃ i nguyÃªn cáº§n thiáº¿t. Náº¿u thá»i gian chá» Ä‘áº¡t Ä‘áº¿n thá»i gian chá», nÃ³ sáº½ Ä‘Ã³ng káº¿t ná»‘i vÃ  Ä‘Æ°a ra thÃ´ng bÃ¡o lá»—i cÃ³ thá»ƒ Ä‘á»c Ä‘Æ°á»£c.</li>
<li>TrÃ¬nh quáº£n lÃ½ sau Ä‘Ã³ sáº½ gá»­i truy váº¥n cá»§a báº¡n cho trÃ¬nh quáº£n lÃ½ truy váº¥n Ä‘á»ƒ xá»­ lÃ½.</li>
<li>Bá»Ÿi vÃ¬ quÃ¡ trÃ¬nh xá»­ lÃ½ truy váº¥n khÃ´ng pháº£i lÃ  'khÃ´ng Ä‘áº§y Ä‘á»§ thÃ¬ khÃ´ng cÃ³', má»™t khi nÃ³ nháº­n Ä‘Æ°á»£c dá»¯ liá»‡u tá»« trÃ¬nh quáº£n lÃ½ truy váº¥n, nÃ³ sáº½ lÆ°u má»™t pháº§n káº¿t quáº£ vÃ o bá»™ Ä‘á»‡m vÃ  báº¯t Ä‘áº§u gá»­i cho báº¡n.</li>
<li>Náº¿u báº¡n gáº·p sá»± cá»‘, TrÃ¬nh quáº£n lÃ½ Ä‘Ã³ng káº¿t ná»‘i, gá»­i cho báº¡n thÃ´ng tin giáº£i thÃ­ch cÃ³ thá»ƒ Ä‘á»c Ä‘Æ°á»£c vÃ  sau Ä‘Ã³ giáº£i phÃ³ng tÃ i nguyÃªn.</li>
</ul>
<h2>TrÃ¬nh quáº£n lÃ½ truy váº¥n</h2>
<blockquote>
<p>Pháº§n nÃ y lÃ  sá»©c máº¡nh cá»§a cÆ¡ sá»Ÿ dá»¯ liá»‡u, trong Ä‘Ã³ má»™t truy váº¥n Ä‘Æ°á»£c viáº¿t xáº¥u cÃ³ thá»ƒ Ä‘Æ°á»£c chuyá»ƒn Ä‘á»•i thÃ nh mÃ£ thá»±c thi nhanh chÃ³ng, vÃ  káº¿t quáº£ thá»±c thi mÃ£ Ä‘Æ°á»£c gá»­i Ä‘áº¿n trÃ¬nh quáº£n lÃ½ khÃ¡ch hÃ ng.</p>
</blockquote>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/Pasted image 20230604130525.png" alt="Pasted image 20230604130525" tabindex="0" loading="lazy"><figcaption>Pasted image 20230604130525</figcaption></figure>
<p>QuÃ¡ trÃ¬nh hoáº¡t Ä‘á»™ng nhiá»u bÆ°á»›c nÃ y nhÆ° sau:</p>
<ul>
<li>
<p>Truy váº¥n Ä‘áº§u tiÃªn Ä‘Æ°á»£c <strong>phÃ¢n tÃ­ch cÃº phÃ¡p (parser)</strong> vÃ  xÃ¡c Ä‘á»‹nh xem nÃ³ cÃ³ há»£p phÃ¡p hay khÃ´ng</p>
</li>
<li>
<p>Sau Ä‘Ã³ Ä‘Æ°á»£c <strong>viáº¿t láº¡i (rewrite)</strong>, loáº¡i bá» cÃ¡c hoáº¡t Ä‘á»™ng vÃ´ dá»¥ng vÃ  tham gia pháº§n <strong>tá»‘i Æ°u hÃ³a trÆ°á»›c (pre-optimized)</strong></p>
</li>
<li>
<p>Sau Ä‘Ã³ Ä‘Æ°á»£c <strong>tá»‘i Æ°u hÃ³a (optimized)</strong> Ä‘á»ƒ cáº£i thiá»‡n hiá»‡u suáº¥t vÃ  Ä‘Æ°á»£c <strong>chuyá»ƒn Ä‘á»•i thÃ nh mÃ£ thá»±c thi (translated into executable code)</strong> vÃ  <strong>káº¿ hoáº¡ch truy cáº­p dá»¯ liá»‡u (data access plans)</strong>.</p>
</li>
<li>
<p>Káº¿ hoáº¡ch sau Ä‘Ã³ Ä‘Æ°á»£c <strong>biÃªn dá»‹ch (compiled)</strong></p>
</li>
<li>
<p>Cuá»‘i cÃ¹ng, Ä‘Æ°á»£c <strong>thá»±c thi (excuted)</strong></p>
</li>
</ul>
<p>TÃ´i sáº½ khÃ´ng khÃ¡m phÃ¡ quÃ¡ nhiá»u hai bÆ°á»›c cuá»‘i cÃ¹ng á»Ÿ Ä‘Ã¢y, bá»Ÿi vÃ¬ há» khÃ´ng quÃ¡ quan trá»ng.</p>
<h3>TrÃ¬nh phÃ¢n tÃ­ch cÃº phÃ¡p truy váº¥n (Query Parser)</h3>
<blockquote>
<p>Má»—i cÃ¢u lá»‡nh SQL Ä‘Æ°á»£c gá»­i Ä‘áº¿n trÃ¬nh phÃ¢n tÃ­ch cÃº phÃ¡p Ä‘á»ƒ kiá»ƒm tra cÃº phÃ¡p vÃ  náº¿u truy váº¥n cá»§a báº¡n sai, trÃ¬nh phÃ¢n tÃ­ch cÃº phÃ¡p sáº½ tá»« chá»‘i truy váº¥n Ä‘Ã³. VÃ­ dá»¥, náº¿u báº¡n viáº¿t "SLECT â€¦" Thay vÃ¬ "SELECTâ€¦", thÃ¬ khÃ´ng cÃ³ gÃ¬ dÆ°á»›i Ä‘Ã¢y.</p>
</blockquote>
<p>NhÆ°ng Ä‘iá»u nÃ y khÃ´ng hoÃ n táº¥t, trÃ¬nh phÃ¢n tÃ­ch cÃº phÃ¡p cÅ©ng sáº½ kiá»ƒm tra xem tá»« khÃ³a cÃ³ sá»­ dá»¥ng Ä‘Ãºng thá»© tá»± hay khÃ´ng, cháº³ng háº¡n nhÆ° WHERE sáº½ bá»‹ tá»« chá»‘i trÆ°á»›c khi SELECT.</p>
<p>TrÃ¬nh phÃ¢n tÃ­ch cÃº phÃ¡p sau Ä‘Ã³ muá»‘n phÃ¢n tÃ­ch cÃ¡c báº£ng vÃ  trÆ°á»ng trong truy váº¥n, sá»­ dá»¥ng siÃªu dá»¯ liá»‡u cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘á»ƒ kiá»ƒm tra:</p>
<ul>
<li>Báº£ng cÃ³ tá»“n táº¡i hay khÃ´ng</li>
<li>TrÆ°á»ng cá»§a báº£ng cÃ³ tá»“n táº¡i hay khÃ´ng</li>
<li>TÃ­nh toÃ¡n cho má»™t loáº¡i trÆ°á»ng cÃ³ thá»ƒ khÃ´ng (vÃ­ dá»¥: báº¡n khÃ´ng thá»ƒ so sÃ¡nh sá»‘ nguyÃªn vá»›i chuá»—i, báº¡n khÃ´ng thá»ƒ sá»­ dá»¥ng hÃ m substring() cho má»™t sá»‘ nguyÃªn)</li>
</ul>
<p>Tiáº¿p theo, trÃ¬nh phÃ¢n tÃ­ch cÃº phÃ¡p kiá»ƒm tra xem báº¡n cÃ³ quyá»n Ä‘á»c (hoáº·c viáº¿t) báº£ng trong truy váº¥n hay khÃ´ng. Nháº¥n máº¡nh má»™t láº§n ná»¯a: cÃ¡c quyá»n nÃ y Ä‘Æ°á»£c cáº¥p phÃ¡t bá»Ÿi DBA.</p>
<p>Trong quÃ¡ trÃ¬nh phÃ¢n tÃ­ch cÃº phÃ¡p, truy váº¥n SQL Ä‘Æ°á»£c chuyá»ƒn Ä‘á»•i thÃ nh Ä‘áº¡i diá»‡n ná»™i bá»™ (internal representation) (thÆ°á»ng lÃ  má»™t cÃ¢y).</p>
<p>Náº¿u má»i thá»© Ä‘á»u á»•n, Ä‘áº¡i diá»‡n ná»™i bá»™ Ä‘Æ°á»£c gá»­i Ä‘áº¿n trÃ¬nh viáº¿t láº¡i truy váº¥n.</p>
<h3>TrÃ¬nh viáº¿t láº¡i truy váº¥n bá»™ (Query Rewriter)</h3>
<p>á» bÆ°á»›c nÃ y, tÃ´i Ä‘Ã£ cÃ³ má»™t Ä‘áº¡i diá»‡n ná»™i bá»™ cá»§a truy váº¥n, má»¥c tiÃªu cá»§a trÃ¬nh viáº¿t láº¡i lÃ :</p>
<ul>
<li>Truy váº¥n Ä‘Æ°á»£c tá»‘i Æ°u hÃ³a trÆ°á»›c</li>
<li>TrÃ¡nh cÃ¡c tÃ­nh toÃ¡n khÃ´ng cáº§n thiáº¿t</li>
<li>GiÃºp trÃ¬nh tá»‘i Æ°u hÃ³a tÃ¬m ra giáº£i phÃ¡p tá»‘t nháº¥t há»£p lÃ½</li>
</ul>
<p>TrÃ¬nh viáº¿t láº¡i thá»±c hiá»‡n kiá»ƒm tra truy váº¥n theo má»™t táº­p há»£p cÃ¡c quy táº¯c Ä‘Ã£ biáº¿t. Náº¿u truy váº¥n phÃ¹ há»£p vá»›i má»™t quy táº¯c cá»§a má»™t máº«u, truy váº¥n sáº½ Ä‘Æ°á»£c viáº¿t láº¡i theo quy táº¯c nÃ y. DÆ°á»›i Ä‘Ã¢y lÃ  danh sÃ¡ch khÃ´ng Ä‘áº§y Ä‘á»§ cÃ¡c quy táº¯c (tÃ¹y chá»n):</p>
<ul>
<li><strong>Há»£p nháº¥t view</strong>: Náº¿u báº¡n sá»­ dá»¥ng view trong truy váº¥n cá»§a mÃ¬nh, view sáº½ Ä‘Æ°á»£c chuyá»ƒn Ä‘á»•i thÃ nh mÃ£ SQL cá»§a nÃ³.</li>
<li><strong>LÃ m pháº³ng truy váº¥n con</strong>: Truy váº¥n con ráº¥t khÃ³ tá»‘i Æ°u hÃ³a, vÃ¬ váº­y trÃ¬nh viáº¿t láº¡i sáº½ cá»‘ gáº¯ng loáº¡i bá» truy váº¥n con
<ul>
<li>VÃ­ dá»¥:</li>
</ul>
</li>
</ul>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SELECT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> PERSON.*</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">FROM</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> PERSON</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">WHERE</span><span style="color:#D19A66;--shiki-dark:#D19A66"> PERSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">person_key</span><span style="color:#C678DD;--shiki-dark:#C678DD"> IN</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#C678DD;--shiki-dark:#C678DD">SELECT</span><span style="color:#D19A66;--shiki-dark:#D19A66"> MAILS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">person_key</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">FROM</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> MAILS</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">WHERE</span><span style="color:#D19A66;--shiki-dark:#D19A66"> MAILS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">mail</span><span style="color:#C678DD;--shiki-dark:#C678DD"> LIKE</span><span style="color:#98C379;--shiki-dark:#98C379"> 'christophe%'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">);</span></span></code></pre>
</div><p>sáº½ Ä‘Æ°á»£c chuyá»ƒn Ä‘á»•i thÃ nh:</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SELECT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> PERSON.*</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">FROM</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> PERSON, MAILS</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">WHERE</span><span style="color:#D19A66;--shiki-dark:#D19A66"> PERSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">person_key</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66"> MAILS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">person_key</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">and</span><span style="color:#D19A66;--shiki-dark:#D19A66"> MAILS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">mail</span><span style="color:#C678DD;--shiki-dark:#C678DD"> LIKE</span><span style="color:#98C379;--shiki-dark:#98C379"> 'christophe%'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span></code></pre>
</div><ul>
<li><strong>Loáº¡i bá» cÃ¡c toÃ¡n tá»­ khÃ´ng cáº§n thiáº¿t</strong>: VÃ­ dá»¥: náº¿u báº¡n sá»­ dá»¥ng DISTINCT vÃ  báº¡n thá»±c sá»± cÃ³ cÃ¡c rÃ ng buá»™c UNIQUE (Ä‘iá»u nÃ y ngÄƒn cháº·n sá»± trÃ¹ng láº·p dá»¯ liá»‡u), tá»« khÃ³a DISTINCT sáº½ bá»‹ xÃ³a.</li>
<li><strong>Loáº¡i trá»« cÃ¡c JOIN dÆ° thá»«a</strong>: Náº¿u cÃ¹ng má»™t Ä‘iá»u kiá»‡n JOIN xáº£y ra hai láº§n, cháº³ng háº¡n nhÆ° Ä‘iá»u kiá»‡n JOIN áº©n trong view hoáº·c JOIN vÃ´ dá»¥ng phÃ¡t sinh tá»« kháº£ nÄƒng truyá»n, chÃºng sáº½ bá»‹ loáº¡i bá».</li>
<li><strong>Háº±ng sá»‘ tÃ­nh toÃ¡n gÃ¡n</strong>: Náº¿u truy váº¥n cá»§a báº¡n cáº§n tÃ­nh toÃ¡n, tÃ­nh toÃ¡n Ä‘Æ°á»£c thá»±c hiá»‡n má»™t láº§n trong quÃ¡ trÃ¬nh viáº¿t láº¡i. VÃ­ dá»¥: WHERE AGE &gt; 10+2 Ä‘Æ°á»£c chuyá»ƒn Ä‘á»•i sang WHERE AGE &gt; 12 vÃ  TODATE ("date string") Ä‘Æ°á»£c chuyá»ƒn Ä‘á»•i sang giÃ¡ trá»‹ ngÃ y á»Ÿ Ä‘á»‹nh dáº¡ng datetime.</li>
<li><strong>(NÃ¢ng cao) Cáº¯t phÃ¢n vÃ¹ng (Partition Pruning):</strong> Náº¿u báº¡n sá»­ dá»¥ng báº£ng phÃ¢n vÃ¹ng, trÃ¬nh viáº¿t láº¡i cÃ³ thá»ƒ tÃ¬m tháº¥y phÃ¢n vÃ¹ng báº¡n cáº§n sá»­ dá»¥ng.</li>
<li><strong>(NÃ¢ng cao) view váº­t lÃ½ (Materialized view rewrite):</strong> Náº¿u báº¡n cÃ³ view váº­t lÃ½ phÃ¹ há»£p vá»›i má»™t táº­p há»£p con cá»§a vá»‹ ngá»¯ truy váº¥n, trÃ¬nh viáº¿t láº¡i sáº½ kiá»ƒm tra xem view cÃ³ Ä‘Æ°á»£c cáº­p nháº­t vÃ  sá»­a Ä‘á»•i truy váº¥n hay khÃ´ng, cho phÃ©p truy váº¥n sá»­ dá»¥ng view váº­t lÃ½ thay vÃ¬ báº£ng gá»‘c.</li>
<li><strong>(NÃ¢ng cao) Quy táº¯c tÃ¹y chá»‰nh:</strong> Náº¿u báº¡n cÃ³ cÃ¡c quy táº¯c tÃ¹y chá»‰nh Ä‘á»ƒ sá»­a Ä‘á»•i truy váº¥n (giá»‘ng nhÆ° Oracle policy), trÃ¬nh viáº¿t láº¡i sáº½ thá»±c hiá»‡n cÃ¡c quy táº¯c nÃ y.</li>
<li><strong>(NÃ¢ng cao) Chuyá»ƒn Ä‘á»•i OLAP:</strong> chá»©c nÄƒng phÃ¢n tÃ­ch / cá»­a sá»•, star join, chá»©c nÄƒng ROLLUP â€¦ Chuyá»ƒn Ä‘á»•i xáº£y ra (nhÆ°ng tÃ´i khÃ´ng cháº¯c cháº¯n Ä‘iá»u nÃ y Ä‘Æ°á»£c thá»±c hiá»‡n bá»Ÿi trÃ¬nh viáº¿t láº¡i hoáº·c trÃ¬nh tá»‘i Æ°u hÃ³a, vÃ¬ cáº£ hai quÃ¡ trÃ¬nh Ä‘Æ°á»£c liÃªn káº¿t cháº·t cháº½ vÃ  pháº£i xem cÆ¡ sá»Ÿ dá»¯ liá»‡u lÃ  gÃ¬).</li>
</ul>
<p>Truy váº¥n sau khi viáº¿t láº¡i tiáº¿p tá»¥c Ä‘Æ°á»£c gá»­i Ä‘áº¿n trÃ¬nh tá»‘i Æ°u hÃ³a, táº¡i thá»i Ä‘iá»ƒm nÃ y niá»m vui báº¯t Ä‘áº§u.</p>
<h3>Thá»‘ng kÃª</h3>
<blockquote>
<p>TrÆ°á»›c khi nghiÃªn cá»©u cÃ¡ch cÆ¡ sá»Ÿ dá»¯ liá»‡u tá»‘i Æ°u hÃ³a truy váº¥n. chÃºng ta cáº§n nÃ³i vá» thá»‘ng kÃª, vÃ¬ <strong>cÆ¡ sá»Ÿ dá»¯ liá»‡u khÃ´ng cÃ³ sá»‘ liá»‡u thá»‘ng kÃª lÃ  ngu ngá»‘c</strong>. CÆ¡ sá»Ÿ dá»¯ liá»‡u khÃ´ng phÃ¢n tÃ­ch dá»¯ liá»‡u cá»§a riÃªng báº¡n trá»« khi báº¡n nÃ³i ra rÃµ rÃ ng. KhÃ´ng cÃ³ phÃ¢n tÃ­ch nÃ o cÃ³ thá»ƒ khiáº¿n cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘Æ°a ra cÃ¡c giáº£ Ä‘á»‹nh (ráº¥t) kÃ©m.</p>
</blockquote>
<p>Tuy nhiÃªn, cÆ¡ sá»Ÿ dá»¯ liá»‡u cáº§n loáº¡i thÃ´ng tin nÃ o?</p>
<p>TÃ´i pháº£i nÃ³i (ngáº¯n gá»n) vá» cÃ¡ch cÆ¡ sá»Ÿ dá»¯ liá»‡u vÃ  há»‡ Ä‘iá»u hÃ nh lÆ°u dá»¯ liá»‡u. ÄÆ¡n vá»‹ nhá» nháº¥t Ä‘Æ°á»£c sá»­ dá»¥ng cho cáº£ hai Ä‘Æ°á»£c gá»i lÃ  trang hoáº·c khá»‘i (máº·c Ä‘á»‹nh 4 hoáº·c 8 KB). Äiá»u nÃ y cÃ³ nghÄ©a lÃ  náº¿u báº¡n chá»‰ cáº§n 1KB, báº¡n cÅ©ng sáº½ chiáº¿m má»™t trang. Náº¿u kÃ­ch thÆ°á»›c cá»§a trang lÃ  8KB, báº¡n lÃ£ng phÃ­ 7KB.</p>
<p>Quay láº¡i vÃ  tiáº¿p tá»¥c nÃ³i vá» thá»‘ng kÃª! Khi báº¡n yÃªu cáº§u cÆ¡ sá»Ÿ dá»¯ liá»‡u thu tháº­p sá»‘ liá»‡u thá»‘ng kÃª, cÆ¡ sá»Ÿ dá»¯ liá»‡u tÃ­nh toÃ¡n cÃ¡c giÃ¡ trá»‹ sau:</p>
<ul>
<li>Sá»‘ lÆ°á»£ng hÃ ng vÃ  trang trong báº£ng</li>
<li>Trong má»—i cá»™t trong báº£ng:
<ul>
<li>GiÃ¡ trá»‹ duy nháº¥t</li>
<li>Äá»™ dÃ i dá»¯ liá»‡u (tá»‘i thiá»ƒu, tá»‘i Ä‘a, trung bÃ¬nh)</li>
<li>Pháº¡m vi dá»¯ liá»‡u (tá»‘i thiá»ƒu, tá»‘i Ä‘a, trung bÃ¬nh)</li>
</ul>
</li>
<li>ThÃ´ng tin chá»‰ má»¥c cá»§a báº£ng</li>
</ul>
<p><strong>CÃ¡c sá»‘ liá»‡u thá»‘ng kÃª nÃ y giÃºp trÃ¬nh tá»‘i Æ°u hÃ³a Æ°á»›c tÃ­nh Disk I/O, CPU vÃ  sá»­ dá»¥ng bá»™ nhá»› cáº§n thiáº¿t cho truy váº¥n</strong></p>
<p>Thá»‘ng kÃª cho má»—i cá»™t lÃ  ráº¥t quan trá»ng. VÃ­ dá»¥: náº¿u má»™t báº£ng PERSON cáº§n pháº£i Ä‘Æ°á»£c JOIN vá»›i 2 cá»™t: LAST_NAME, FIRST_NAME. Theo thá»‘ng kÃª, cÆ¡ sá»Ÿ dá»¯ liá»‡u biáº¿t ráº±ng FIRST_NAME chá»‰ cÃ³ 1.000 giÃ¡ trá»‹ khÃ¡c nhau vÃ  LAST_NAME cÃ³ 1.000.000 giÃ¡ trá»‹ khÃ¡c nhau. VÃ¬ váº­y, cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘Æ°á»£c JOIN theo LAST_NAME, FIRST_NAME. Bá»Ÿi vÃ¬ LAST_NAME khÃ´ng cÃ³ kháº£ nÄƒng láº·p láº¡i, so sÃ¡nh 2, 3 kÃ½ tá»± Ä‘áº§u tiÃªn cá»§a LAST_NAME lÃ  Ä‘á»§ trong háº§u háº¿t cÃ¡c trÆ°á»ng há»£p, Ä‘iá»u nÃ y sáº½ lÃ m giáº£m Ä‘Ã¡ng ká»ƒ sá»‘ láº§n so sÃ¡nh.</p>
<p>Tuy nhiÃªn, Ä‘Ã¢y chá»‰ lÃ  nhá»¯ng sá»‘ liá»‡u thá»‘ng kÃª cÆ¡ báº£n. Báº¡n cÃ³ thá»ƒ yÃªu cáº§u cÆ¡ sá»Ÿ dá»¯ liá»‡u lÃ m má»™t sá»‘ liá»‡u thá»‘ng kÃª nÃ¢ng cao Ä‘Æ°á»£c gá»i lÃ  histogram. Histogram lÃ  sá»‘ liá»‡u thá»‘ng kÃª vá» phÃ¢n phá»‘i giÃ¡ trá»‹ cá»™t. VÃ­ dá»¥:</p>
<ul>
<li>CÃ¡c giÃ¡ trá»‹ xuáº¥t hiá»‡n thÆ°á»ng xuyÃªn nháº¥t</li>
<li>PhÃ¢n vá»‹ (quantiles)</li>
<li>â€¦</li>
</ul>
<p>CÃ¡c sá»‘ liá»‡u thá»‘ng kÃª bá»• sung nÃ y giÃºp cÆ¡ sá»Ÿ dá»¯ liá»‡u tÃ¬m tháº¥y káº¿ hoáº¡ch truy váº¥n tá»‘t hÆ¡n, Ä‘áº·c biá»‡t lÃ  Ä‘á»‘i vá»›i cÃ¡c vá»‹ ngá»¯ phÆ°Æ¡ng trÃ¬nh (vÃ­ dá»¥: WHERE AGE = 18) hoáº·c vá»‹ ngá»¯ pháº¡m vi (vÃ­ dá»¥: WHERE AGE &gt; 10 vÃ  AGE &lt; 40) vÃ¬ cÆ¡ sá»Ÿ dá»¯ liá»‡u cÃ³ thá»ƒ hiá»ƒu rÃµ hÆ¡n vá» cÃ¡c dÃ²ng dá»¯ liá»‡u loáº¡i sá»‘ liÃªn quan Ä‘áº¿n cÃ¡c vá»‹ ngá»¯ nÃ y (LÆ°u Ã½: TÃªn ká»¹ thuáº­t cá»§a khÃ¡i niá»‡m nÃ y Ä‘Æ°á»£c gá»i lÃ  tá»· lá»‡ chá»n).</p>
<p>Sá»‘ liá»‡u thá»‘ng kÃª Ä‘Æ°á»£c lÆ°u trá»¯ trong siÃªu dá»¯ liá»‡u cÆ¡ sá»Ÿ dá»¯ liá»‡u, cháº³ng háº¡n nhÆ° vá»‹ trÃ­ thá»‘ng kÃª cá»§a báº£ng (khÃ´ng phÃ¢n vÃ¹ng):</p>
<ul>
<li>Oracle: USER / ALL / DBA_TABLES vÃ  USER / ALL / DBA_TAB_COLUMNS</li>
<li>DB2ï¼š SYSCAT. TABLES vÃ  SYSCAT. COLUMNS</li>
</ul>
<p><strong>Sá»‘ liá»‡u thá»‘ng kÃª pháº£i Ä‘Æ°á»£c cáº­p nháº­t ká»‹p thá»i</strong>. Náº¿u má»™t báº£ng cÃ³ 1.000.000 hÃ ng vÃ  cÆ¡ sá»Ÿ dá»¯ liá»‡u nghÄ© ráº±ng nÃ³ chá»‰ cÃ³ 500 hÃ ng, khÃ´ng cÃ³ gÃ¬ tá»“i tá»‡ hÆ¡n tháº¿. NhÆ°á»£c Ä‘iá»ƒm duy nháº¥t cá»§a thá»‘ng kÃª lÃ  cáº§n cÃ³ thá»i gian Ä‘á»ƒ tÃ­nh toÃ¡n, Ä‘Ã³ lÃ  lÃ½ do táº¡i sao háº§u háº¿t cÃ¡c cÆ¡ sá»Ÿ dá»¯ liá»‡u khÃ´ng tá»± Ä‘á»™ng tÃ­nh toÃ¡n sá»‘ liá»‡u thá»‘ng kÃª theo máº·c Ä‘á»‹nh. Khi dá»¯ liá»‡u Ä‘áº¡t Ä‘áº¿n má»™t triá»‡u cáº¥p Ä‘á»™ thá»‘ng kÃª trá»Ÿ nÃªn khÃ³ khÄƒn, táº¡i thá»i Ä‘iá»ƒm nÃ y, báº¡n cÃ³ thá»ƒ chá»n chá»‰ lÃ m sá»‘ liá»‡u thá»‘ng kÃª cÆ¡ báº£n hoáº·c thá»±c hiá»‡n thá»‘ng kÃª trÃªn má»™t máº«u cÆ¡ sá»Ÿ dá»¯ liá»‡u.</p>
<p>VÃ­ dá»¥, má»™t dá»± Ã¡n mÃ  cáº§n pháº£i xá»­ lÃ½ hÃ ng trÄƒm triá»‡u dá»¯ liá»‡u trÃªn má»—i báº£ng vÃ  tÃ´i Ä‘Ã£ chá»n chá»‰ thá»‘ng kÃª 10%, dáº«n Ä‘áº¿n tiÃªu thá»¥ thá»i gian ráº¥t lá»›n. VÃ­ dá»¥ nÃ y chá»©ng minh ráº±ng Ä‘Ã¢y lÃ  má»™t quyáº¿t Ä‘á»‹nh tá»“i vÃ¬ Ä‘Ã´i khi 10% oracle 10G Ä‘Æ°á»£c chá»n tá»« má»™t cá»™t cá»¥ thá»ƒ cá»§a má»™t báº£ng cá»¥ thá»ƒ ráº¥t khÃ¡c so vá»›i táº¥t cáº£ 100% (Ä‘iá»u nÃ y hiáº¿m khi xáº£y ra Ä‘á»‘i vá»›i cÃ¡c báº£ng cÃ³ 100 triá»‡u hÃ ng dá»¯ liá»‡u). Sá»‘ liá»‡u thá»‘ng kÃª sai nÃ y Ä‘Ã£ dáº«n Ä‘áº¿n má»™t truy váº¥n Ä‘Æ°á»£c cho lÃ  30 giÃ¢y Ä‘á»ƒ hoÃ n thÃ nh cuá»‘i cÃ¹ng Ä‘Æ°á»£c thá»±c hiá»‡n trong tÃ¡m giá», quÃ¡ trÃ¬nh tÃ¬m kiáº¿m nguyÃªn nhÃ¢n gá»‘c rá»… cá»§a hiá»‡n tÆ°á»£ng nÃ y lÃ  má»™t cÆ¡n Ã¡c má»™ng. VÃ­ dá»¥ nÃ y cho tháº¥y táº§m quan trá»ng cá»§a thá»‘ng kÃª.</p>
<blockquote>
<p>LÆ°u Ã½: Táº¥t nhiÃªn, má»—i cÆ¡ sá»Ÿ dá»¯ liá»‡u cÃ³ sá»‘ liá»‡u thá»‘ng kÃª cá»¥ thá»ƒ vÃ  cao hÆ¡n. Náº¿u báº¡n muá»‘n biáº¿t thÃªm thÃ´ng tin, hÃ£y Ä‘á»c tÃ i liá»‡u vá» cÆ¡ sá»Ÿ dá»¯ liá»‡u. Máº·c dÃ¹ váº­y, tÃ´i Ä‘Ã£ cá»‘ gáº¯ng háº¿t sá»©c Ä‘á»ƒ hiá»ƒu lÃ m tháº¿ nÃ o sá»‘ liá»‡u thá»‘ng kÃª Ä‘Æ°á»£c sá»­ dá»¥ng, vÃ  tÃ i liá»‡u chÃ­nh thá»©c tá»‘t nháº¥t tÃ´i tÃ¬m tháº¥y Ä‘áº¿n tá»« PostgreSQL.</p>
</blockquote>
<h3>TrÃ¬nh tá»‘i Æ°u hÃ³a truy váº¥n (Query optimizer)</h3>
<blockquote>
<p>Táº¥t cáº£ cÃ¡c cÆ¡ sá»Ÿ dá»¯ liá»‡u hiá»‡n Ä‘áº¡i Ä‘ang <strong>tá»‘i Æ°u hÃ³a truy váº¥n vá»›i tá»‘i Æ°u hÃ³a dá»±a trÃªn chi phÃ­</strong>, tá»©c lÃ  <strong>cost-based optimization - CBO</strong>. Sá»± tháº­t lÃ  thiáº¿t láº­p má»™t chi phÃ­ cho má»—i tÃ­nh toÃ¡n, báº±ng cÃ¡ch Ã¡p dá»¥ng má»™t loáº¡t cÃ¡c tÃ­nh toÃ¡n chi phÃ­ tháº¥p nháº¥t, Ä‘á»ƒ tÃ¬m cÃ¡ch tá»‘t nháº¥t Ä‘á»ƒ giáº£m chi phÃ­ truy váº¥n.</p>
</blockquote>
<p>Äá»ƒ hiá»ƒu cÃ¡c nguyÃªn táº¯c cá»§a trÃ¬nh tá»‘i Æ°u hÃ³a chi phÃ­, tÃ´i nghÄ© ráº±ng nÃ³ lÃ  tá»‘t hÆ¡n Ä‘á»ƒ sá»­ dá»¥ng má»™t vÃ­ dá»¥ Ä‘á»ƒ "cáº£m nháº­n" sá»± phá»©c táº¡p Ä‘áº±ng sau nhiá»‡m vá»¥ nÃ y. á» Ä‘Ã¢y tÃ´i sáº½ Ä‘Æ°a ra 3 cÃ¡ch Ä‘á»ƒ káº¿t ná»‘i 2 báº£ng vÃ  chÃºng ta sáº½ sá»›m tháº¥y ráº±ng ngay cáº£ má»™t truy váº¥n ná»‘i Ä‘Æ¡n giáº£n lÃ  má»™t cÆ¡n Ã¡c má»™ng Ä‘á»‘i vá»›i trÃ¬nh tá»‘i Æ°u hÃ³a. Sau Ä‘Ã³, chÃºng ta sáº½ tÃ¬m hiá»ƒu cÃ¡ch trÃ¬nh tá»‘i Æ°u hÃ³a thá»±c sá»± hoáº¡t Ä‘á»™ng.</p>
<p><strong>Äá»‘i vá»›i cÃ¡c hoáº¡t Ä‘á»™ng JOIN, tÃ´i sáº½ táº­p trung vÃ o Ä‘á»™ phá»©c táº¡p thá»i gian cá»§a chÃºng, tuy nhiÃªn, trÃ¬nh tá»‘i Æ°u hÃ³a cÆ¡ sá»Ÿ dá»¯ liá»‡u tÃ­nh toÃ¡n chi phÃ­ CPU, chi phÃ­ Disk I/O vÃ  yÃªu cáº§u bá»™ nhá»› cá»§a chÃºng</strong>. Sá»± khÃ¡c biá»‡t giá»¯a Ä‘á»™ phá»©c táº¡p thá»i gian vÃ  chi phÃ­ CPU lÃ  chi phÃ­ thá»i gian lÃ  má»™t xáº¥p xá»‰ (Ä‘Æ°á»£c chuáº©n bá»‹ cho má»™t káº» lÆ°á»i biáº¿ng nhÆ° tÃ´i). VÃ  chi phÃ­ CPU, tÃ´i bao gá»“m táº¥t cáº£ cÃ¡c tÃ­nh toÃ¡n á»Ÿ Ä‘Ã¢y, cháº³ng háº¡n nhÆ°: cá»™ng, phÃ¡n Ä‘oÃ¡n Ä‘iá»u kiá»‡n, nhÃ¢n, láº·p láº¡i â€¦ NgoÃ i ra, nhá»¯ng gÃ¬ khÃ¡c:</p>
<p>Má»—i hoáº¡t Ä‘á»™ng high-level code yÃªu cáº§u má»™t sá»‘ lÆ°á»£ng cá»¥ thá»ƒ cá»§a cÃ¡c hoáº¡t Ä‘á»™ng CPU low-level.</p>
<p>Äá»‘i vá»›i Intel Core i7, Intel Pentium 4, AMD Opteronâ€¦ Vv, (xÃ©t chu ká»³ CPU), chi phÃ­ hoáº¡t Ä‘á»™ng cá»§a CPU lÃ  khÃ¡c nhau, cÃ³ nghÄ©a lÃ  nÃ³ phá»¥ thuá»™c vÃ o kiáº¿n trÃºc cá»§a CPU.</p>
<p>Sá»­ dá»¥ng Ä‘á»™ phá»©c táº¡p thá»i gian dá»… dÃ ng hÆ¡n nhiá»u (Ã­t nháº¥t lÃ  Ä‘á»‘i vá»›i tÃ´i), vÃ  sá»­ dá»¥ng nÃ³ tÃ´i cÅ©ng cÃ³ thá»ƒ tÃ¬m hiá»ƒu vá» khÃ¡i niá»‡m CBO. VÃ¬ Disk I/O lÃ  má»™t khÃ¡i niá»‡m quan trá»ng, thá»‰nh thoáº£ng tÃ´i cÅ©ng Ä‘á» cáº­p Ä‘áº¿n nÃ³. HÃ£y nhá»› ráº±ng <strong>háº§u háº¿t thá»i gian tháº¯t cá»• chai lÃ  Disk I/O thay vÃ¬ sá»­ dá»¥ng CPU</strong>.</p>
<h4>Chá»‰ má»¥c (Index)</h4>
<blockquote>
<p>Khi nghiÃªn cá»©u [[B Tree]], tÃ´i Ä‘Ã£ nÃ³i vá» Index, hÃ£y nhá»› ráº±ng cÃ¡c chá»‰ sá»‘ Ä‘Ã£ Ä‘Æ°á»£c sáº¯p xáº¿p.</p>
</blockquote>
<p>Chá»‰ Ä‘á»ƒ tham kháº£o: NgoÃ i ra cÃ²n cÃ³ cÃ¡c loáº¡i chá»‰ má»¥c khÃ¡c, cháº³ng háº¡n nhÆ° bitmap index, khÃ´ng giá»‘ng nhÆ° chi phÃ­ cá»§a chá»‰ má»¥c B+ Tree vá» CPU, Disk I/O vÃ  bá»™ nhá»›.</p>
<p>NgoÃ i ra, nhiá»u cÆ¡ sá»Ÿ dá»¯ liá»‡u hiá»‡n Ä‘áº¡i Ä‘á»ƒ cáº£i thiá»‡n chi phÃ­ thá»±c thi truy váº¥n, chá»‰ cÃ³ thá»ƒ tá»± Ä‘á»™ng táº¡o chá»‰ má»¥c táº¡m thá»i cho cÃ¡c truy váº¥n hiá»‡n táº¡i.</p>
<h4>ÄÆ°á»ng dáº«n truy cáº­p (access path)</h4>
<p>TrÆ°á»›c khi Ã¡p dá»¥ng toÃ¡n tá»­ liÃªn káº¿t (join), trÆ°á»›c tiÃªn báº¡n cáº§n láº¥y dá»¯ liá»‡u. DÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡ch Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c dá»¯ liá»‡u.</p>
<p>LÆ°u Ã½: VÃ¬ váº¥n Ä‘á» thá»±c sá»± vá»›i táº¥t cáº£ cÃ¡c Ä‘Æ°á»ng dáº«n truy cáº­p lÃ  Disk I/O, tÃ´i sáº½ khÃ´ng nÃ³i quÃ¡ nhiá»u vá» Ä‘á»™ phá»©c táº¡p thá»i gian.</p>
<ul>
<li>QuÃ©t Ä‘áº§y Ä‘á»§ (full scan)</li>
</ul>
<p>Náº¿u báº¡n Ä‘Ã£ Ä‘á»c káº¿ hoáº¡ch thá»±c thi, báº¡n cháº¯c cháº¯n Ä‘Ã£ tháº¥y tá»« "quÃ©t Ä‘áº§y Ä‘á»§" (hoáº·c chá»‰ quÃ©t'). NÃ³i má»™t cÃ¡ch Ä‘Æ¡n giáº£n, quÃ©t Ä‘áº§y Ä‘á»§ lÃ  cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘á»c Ä‘áº§y Ä‘á»§ má»™t báº£ng hoáº·c chá»‰ má»¥c. Äá»‘i vá»›i Disk I/O, rÃµ rÃ ng lÃ  quÃ©t báº£ng Ä‘áº§y Ä‘á»§ cÃ³ chi phÃ­ cao hÆ¡n so vá»›i quÃ©t Ä‘áº§y Ä‘á»§ chá»‰ má»¥c.</p>
<ul>
<li>QuÃ©t pháº¡m vi</li>
</ul>
<p>CÃ¡c loáº¡i quÃ©t khÃ¡c Ä‘Æ°á»£c quÃ©t theo chá»‰ má»¥c, cháº³ng háº¡n nhÆ° khi báº¡n sá»­ dá»¥ng vá»‹ ngá»¯ <code>WHERE AGE &gt; 20 AND AGE &lt; 40</code></p>
<p>Táº¥t nhiÃªn, báº¡n cáº§n pháº£i cÃ³ chá»‰ má»¥c trÃªn trÆ°á»ng <code>AGE</code> Ä‘á»ƒ quÃ©t pháº¡m vi chá»‰ má»¥c.</p>
<p>Trong pháº§n Ä‘áº§u tiÃªn, chÃºng ta Ä‘Ã£ biáº¿t ráº±ng chi phÃ­ thá»i gian cá»§a truy váº¥n pháº¡m vi lÃ  khoáº£ng <code>log(N) + M</code>, á»Ÿ Ä‘Ã¢y N lÃ  khá»‘i lÆ°á»£ng dá»¯ liá»‡u Ä‘Æ°á»£c chá»‰ má»¥c vÃ  M lÃ  sá»‘ dÃ²ng Ä‘Æ°á»£c Æ°á»›c tÃ­nh trong pháº¡m vi. Nhá» thá»‘ng kÃª, chÃºng ta má»›i cÃ³ thá»ƒ biáº¿t giÃ¡ trá»‹ cá»§a N vÃ  M (LÆ°u Ã½: M lÃ  vá»‹ ngá»¯ <code>AGE &gt; 20 AND AGE &lt; 40</code>). NgoÃ i ra, báº¡n khÃ´ng cáº§n pháº£i Ä‘á»c toÃ n bá»™ chá»‰ má»¥c khi quÃ©t pháº¡m vi, vÃ¬ váº­y nÃ³ khÃ´ng tá»‘n kÃ©m nhÆ° quÃ©t Ä‘áº§y Ä‘á»§ trÃªn Disk I/O.</p>
<ul>
<li>QuÃ©t duy nháº¥t</li>
</ul>
<p>Náº¿u báº¡n chá»‰ cáº§n láº¥y má»™t giÃ¡ trá»‹ tá»« chá»‰ má»¥c, báº¡n cÃ³ thá»ƒ quÃ©t duy nháº¥t.</p>
<ul>
<li>Truy cáº­p theo ROW ID</li>
</ul>
<p>Trong háº§u háº¿t cÃ¡c trÆ°á»ng há»£p, náº¿u cÆ¡ sá»Ÿ dá»¯ liá»‡u sá»­ dá»¥ng chá»‰ má»¥c, nÃ³ pháº£i tÃ¬m cÃ¡c hÃ ng liÃªn quan Ä‘áº¿n chá»‰ má»¥c, Ä‘iá»u nÃ y sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng theo cÃ¡ch truy cáº­p dá»±a trÃªn ROW ID.</p>
<p>VÃ­ dá»¥: náº¿u báº¡n cháº¡y:</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SELECT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> LASTNAME, FIRSTNAME </span><span style="color:#C678DD;--shiki-dark:#C678DD">from</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> PERSON </span><span style="color:#C678DD;--shiki-dark:#C678DD">WHERE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> AGE </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 28</span></span></code></pre>
</div><p>Náº¿u cá»™t <code>age</code> cá»§a báº£ng <code>person</code> cÃ³ chá»‰ má»¥c, trÃ¬nh tá»‘i Æ°u hÃ³a sáº½ sá»­ dá»¥ng chá»‰ má»¥c Ä‘á»ƒ tÃ¬m má»i ngÆ°á»i á»Ÿ táº¥t cáº£ cÃ¡c lá»©a tuá»•i 28, sau Ä‘Ã³ nÃ³ sáº½ Ä‘i vÃ o báº£ng Ä‘á»ƒ Ä‘á»c cÃ¡c hÃ ng cÃ³ liÃªn quan, Ä‘Ã³ lÃ  bá»Ÿi vÃ¬ chá»‰ cÃ³ thÃ´ng tin age trong chá»‰ má»¥c vÃ  báº¡n muá»‘n há» vÃ  tÃªn.</p>
<p>Tuy nhiÃªn, náº¿u báº¡n thá»±c hiá»‡n má»™t cÃ¡ch tiáº¿p cáº­n khÃ¡c:</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SELECT</span><span style="color:#D19A66;--shiki-dark:#D19A66"> TYPE_PERSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">CATEGORY</span><span style="color:#C678DD;--shiki-dark:#C678DD"> from</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> PERSON, TYPE_PERSON</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">WHERE</span><span style="color:#D19A66;--shiki-dark:#D19A66"> PERSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">AGE</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66"> TYPE_PERSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">AGE</span></span></code></pre>
</div><p>Chá»‰ má»¥c cá»§a báº£ng <code>PERSON</code> Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ káº¿t ná»‘i báº£ng <code>TYPE_PERSON</code>, nhÆ°ng báº£ng <code>PERSON</code> khÃ´ng Ä‘Æ°á»£c truy cáº­p dá»±a trÃªn ROW ID vÃ¬ báº¡n khÃ´ng yÃªu cáº§u thÃ´ng tin trong báº£ng Ä‘Ã³.</p>
<p>Máº·c dÃ¹ phÆ°Æ¡ng phÃ¡p nÃ y hoáº¡t Ä‘á»™ng tá»‘t á»Ÿ má»™t lÆ°á»£ng nhá» truy cáº­p, váº¥n Ä‘á» thá»±c sá»± vá»›i hoáº¡t Ä‘á»™ng nÃ y thá»±c sá»± lÃ  Disk I/O. Náº¿u cáº§n ráº¥t nhiá»u truy cáº­p dá»±a trÃªn ROW ID, cÆ¡ sá»Ÿ dá»¯ liá»‡u cÃ³ thá»ƒ chá»n quÃ©t Ä‘áº§y Ä‘á»§.</p>
<ul>
<li>ÄÆ°á»ng dáº«n khÃ¡c</li>
</ul>
<p>TÃ´i khÃ´ng liá»‡t kÃª táº¥t cáº£ cÃ¡c Ä‘Æ°á»ng dáº«n truy cáº­p vÃ  báº¡n cÃ³ thá»ƒ Ä‘á»c tÃ i liá»‡u Oracle náº¿u báº¡n quan tÃ¢m. CÃ¡c cÆ¡ sá»Ÿ dá»¯ liá»‡u khÃ¡c cÃ³ thá»ƒ Ä‘Æ°á»£c gá»i khÃ¡c nhau nhÆ°ng cÃ¡c khÃ¡i niá»‡m Ä‘áº±ng sau nÃ³ lÃ  nhÆ° nhau.</p>
<h4>PhÃ©p káº¿t ná»‘i (join)</h4>
<blockquote>
<p>BÃ¢y giá» chÃºng ta Ä‘Ã£ biáº¿t lÃ m tháº¿ nÃ o Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c dá»¯ liá»‡u, sau Ä‘Ã³ káº¿t ná»‘i chÃºng ngay !</p>
</blockquote>
<p>Nhá»¯ng gÃ¬ tÃ´i muá»‘n trÃ¬nh bÃ y lÃ  ba phÃ©p káº¿t ná»‘i phá»• biáº¿n: Merge Join, Hash Join vÃ  Nested Loop Join. NhÆ°ng trÆ°á»›c Ä‘Ã³, tÃ´i cáº§n pháº£i giá»›i thiá»‡u má»™t tá»« má»›i: quan há»‡ bÃªn trong vÃ  bÃªn ngoÃ i (inner relation and outer relation) cÃ³ thá»ƒ lÃ :</p>
<ul>
<li>Má»™t báº£ng</li>
<li>Má»™t chá»‰ má»¥c</li>
<li>Káº¿t quáº£ trung gian cá»§a phÃ©p tÃ­nh trÆ°á»›c Ä‘Ã³ (vÃ­ dá»¥: káº¿t quáº£ cá»§a cÃ¡c phÃ©p káº¿t ná»‘i trÆ°á»›c Ä‘Ã³)</li>
</ul>
<p>Khi báº¡n káº¿t ná»‘i hai quan há»‡, thuáº­t toÃ¡n káº¿t ná»‘i xá»­ lÃ½ hai quan há»‡ lÃ  khÃ¡c nhau. Trong pháº§n cÃ²n láº¡i cá»§a bÃ i viáº¿t nÃ y, tÃ´i sáº½ giáº£ Ä‘á»‹nh:</p>
<ul>
<li>Quan há»‡ bÃªn ngoÃ i lÃ  táº­p dá»¯ liá»‡u bÃªn trÃ¡i</li>
<li>Quan há»‡ bÃªn trong lÃ  táº­p dá»¯ liá»‡u bÃªn pháº£i</li>
</ul>
<p>VÃ­ dá»¥: A JOIN B lÃ  káº¿t ná»‘i giá»¯a A vÃ  B, á» Ä‘Ã¢y A lÃ  quan há»‡ bÃªn ngoÃ i vÃ  B lÃ  quan há»‡ bÃªn trong.</p>
<p>Trong háº§u háº¿t cÃ¡c trÆ°á»ng há»£p, <strong>chi phÃ­ cá»§a A JOIN B khÃ¡c vá»›i chi phÃ­ cá»§a B JOIN A</strong>.</p>
<p>Trong pháº§n nÃ y, tÃ´i cÅ©ng sáº½ giáº£ Ä‘á»‹nh ráº±ng quan há»‡ bÃªn ngoÃ i cÃ³ má»™t yáº¿u tá»‘ N vÃ  quan há»‡ bÃªn trong cÃ³ yáº¿u tá»‘ M. HÃ£y nhá»› ráº±ng trÃ¬nh tá»‘i Æ°u hÃ³a thá»±c sá»± biáº¿t giÃ¡ trá»‹ cá»§a N vÃ  M thÃ´ng qua thá»‘ng kÃª.</p>
<p>LÆ°u Ã½: N vÃ  M lÃ  lá»±c lÆ°á»£ng cá»§a quan há»‡.</p>
<h5>Nested Loop Join</h5>
<blockquote>
<p>Nested Loop Join lÃ  Ä‘Æ¡n giáº£n nháº¥t.</p>
</blockquote>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/Pasted image 20230604200445.png" alt="Pasted image 20230604200445" tabindex="0" loading="lazy"><figcaption>Pasted image 20230604200445</figcaption></figure>
<p>DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ lÃ½ do:</p>
<ul>
<li>Äá»‘i vá»›i má»—i dÃ²ng cá»§a quan há»‡ bÃªn ngoÃ i, xem táº¥t cáº£ cÃ¡c hÃ ng trong quan há»‡ bÃªn trong Ä‘á»ƒ tÃ¬m cÃ¡c hÃ ng phÃ¹ há»£p</li>
</ul>
<p>DÆ°á»›i Ä‘Ã¢y lÃ  mÃ£ giáº£:</p>
<div class="language-java" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">nested_loop_join</span><span style="color:#E06C75;--shiki-dark:#E06C75">(array outer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#E06C75;--shiki-dark:#E06C75"> array inner)</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">  for</span><span style="color:#E06C75;--shiki-dark:#E06C75"> each row a in outer</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    for</span><span style="color:#E06C75;--shiki-dark:#E06C75"> each row b in inner</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">      if</span><span style="color:#E06C75;--shiki-dark:#E06C75"> (</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">match_join_condition</span><span style="color:#E06C75;--shiki-dark:#E06C75">(a</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#E06C75;--shiki-dark:#E06C75">b))</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        write_result_in_output</span><span style="color:#E06C75;--shiki-dark:#E06C75">(a</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#E06C75;--shiki-dark:#E06C75">b)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">      end </span><span style="color:#C678DD;--shiki-dark:#C678DD">if</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    end </span><span style="color:#C678DD;--shiki-dark:#C678DD">for</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">   end </span><span style="color:#C678DD;--shiki-dark:#C678DD">for</span></span></code></pre>
</div><p>VÃ¬ Ä‘Ã¢y lÃ  má»™t láº§n láº·p kÃ©p, <strong>Ä‘á»™ phá»©c táº¡p thá»i gian lÃ  <code>O(N*M)</code></strong>.</p>
<p>Vá» phÃ­a Disk I/O, vÃ²ng láº·p bÃªn trong yÃªu cáº§u Ä‘á»c M hÃ ng tá»« quan há»‡ bÃªn trong vá»›i má»—i hÃ ng trong N hÃ ng cá»§a quan há»‡ bÃªn ngoÃ i. Thuáº­t toÃ¡n nÃ y yÃªu cáº§u Ä‘á»c <code>N + N * M</code> hÃ ng tá»« disk. Tuy nhiÃªn, náº¿u quan há»‡ bÃªn trong Ä‘á»§ nhá» Ä‘á»ƒ báº¡n cÃ³ thá»ƒ Ä‘á»c nÃ³ vÃ o bá»™ nhá»›, chá»‰ cÃ³ <code>M + N</code> láº§n Ä‘á»c. Sau khi sá»­a Ä‘á»•i nhÆ° váº­y, quan há»‡ bÃªn trong pháº£i lÃ  tá»‘i thiá»ƒu vÃ¬ nÃ³ cÃ³ nhiá»u cÆ¡ há»™i hÆ¡n Ä‘á»ƒ náº¡p vÃ o bá»™ nhá»›.</p>
<p>KhÃ´ng cÃ³ sá»± khÃ¡c biá»‡t vá» chi phÃ­ CPU, nhÆ°ng vá» Disk I/O thÃ¬ tá»‘t nháº¥t lÃ  má»—i quan há»‡ chá»‰ Ä‘á»c má»™t láº§n.</p>
<p>Táº¥t nhiÃªn, quan há»‡ bÃªn trong cÃ³ thá»ƒ Ä‘Æ°á»£c thay tháº¿ báº±ng chá»‰ má»¥c vÃ  thuáº­n lá»£i hÆ¡n cho Disk I/O.</p>
<p>VÃ¬ thuáº­t toÃ¡n nÃ y ráº¥t Ä‘Æ¡n giáº£n, phiÃªn báº£n sau Ä‘Ã¢y cÃ³ lá»£i hÆ¡n cho Disk I/O khi quan há»‡ bÃªn trong quÃ¡ lá»›n Ä‘á»ƒ náº¡p vÃ o bá»™ nhá»›. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ lÃ½ do:</p>
<ul>
<li>Äá»ƒ trÃ¡nh Ä‘á»c hai quan há»‡ tá»«ng dÃ²ng</li>
<li>Báº¡n cÃ³ thá»ƒ Ä‘á»c chÃºng, lÆ°u hai dÃ²ng dá»¯ liá»‡u (Ä‘Æ°á»£c Ä‘á»c trong hai quan há»‡) vÃ o bá»™ nhá»›,</li>
<li>So sÃ¡nh hai cá»¥m dá»¯ liá»‡u, giá»¯ láº¡i cÃ¡c cáº·p thoáº£ mÃ£n</li>
<li>Sau Ä‘Ã³ táº£i cÃ¡c cá»¥m dá»¯ liá»‡u má»›i tá»« Ä‘Ä©a Ä‘á»ƒ tiáº¿p tá»¥c so sÃ¡nh</li>
<li>Cho Ä‘áº¿n khi táº¥t cáº£ dá»¯ liá»‡u Ä‘Æ°á»£c náº¡p.</li>
</ul>
<p>Thuáº­t toÃ¡n cÃ³ thá»ƒ nhÆ° sau:</p>
<div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">// improved version to reduce the disk I/O.</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">nested_loop_join_v2</span><span style="color:#E06C75;--shiki-dark:#E06C75">(file outer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#E06C75;--shiki-dark:#E06C75"> file inner)</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">  for</span><span style="color:#E06C75;--shiki-dark:#E06C75"> each bunch ba in outer</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">  // ba is now in memory</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    for</span><span style="color:#E06C75;--shiki-dark:#E06C75"> each bunch bb in inner</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">        // bb is now in memory</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">        for</span><span style="color:#E06C75;--shiki-dark:#E06C75"> each row a in ba</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">          for</span><span style="color:#E06C75;--shiki-dark:#E06C75"> each row b in bb</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">            if</span><span style="color:#E06C75;--shiki-dark:#E06C75"> (</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">match_join_condition</span><span style="color:#E06C75;--shiki-dark:#E06C75">(a</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#E06C75;--shiki-dark:#E06C75">b))</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">              write_result_in_output</span><span style="color:#E06C75;--shiki-dark:#E06C75">(a</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#E06C75;--shiki-dark:#E06C75">b)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">            end </span><span style="color:#C678DD;--shiki-dark:#C678DD">if</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">          end </span><span style="color:#C678DD;--shiki-dark:#C678DD">for</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">       end </span><span style="color:#C678DD;--shiki-dark:#C678DD">for</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">    end </span><span style="color:#C678DD;--shiki-dark:#C678DD">for</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75">   end </span><span style="color:#C678DD;--shiki-dark:#C678DD">for</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Vá»›i phiÃªn báº£n nÃ y, Ä‘á»™ phá»©c táº¡p thá»i gian khÃ´ng thay Ä‘á»•i, nhÆ°ng truy cáº­p disk giáº£m</strong>:</p>
<ul>
<li>Vá»›i phiÃªn báº£n trÆ°á»›c, thuáº­t toÃ¡n yÃªu cáº§u truy cáº­p <code>N + N * M</code> láº§n (má»™t dÃ²ng cho má»—i truy cáº­p).</li>
<li>Vá»›i phiÃªn báº£n má»›i, truy cáº­p Ä‘Ä©a trá»Ÿ thÃ nh sá»‘ lÆ°á»£ng cá»¥m dá»¯ liá»‡u quan há»‡ bÃªn ngoÃ i + sá»‘ lÆ°á»£ng cá»¥m dá»¯ liá»‡u quan há»‡ bÃªn ngoÃ i * Sá»‘ lÆ°á»£ng cá»¥m dá»¯ liá»‡u cho quan há»‡ bÃªn trong.</li>
<li>TÄƒng kÃ­ch thÆ°á»›c cá»§a cÃ¡c cá»¥m dá»¯ liá»‡u cÃ³ thá»ƒ lÃ m giáº£m truy cáº­p disk.</li>
</ul>
<h5>Hash Join</h5>
<p>Hash Join phá»©c táº¡p hÆ¡n, nhÆ°ng trong nhiá»u trÆ°á»ng há»£p, chi phÃ­ tháº¥p hÆ¡n so vá»›i Nested Loop Join.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/Pasted image 20230604203453.png" alt="Pasted image 20230604203453" tabindex="0" loading="lazy"><figcaption>Pasted image 20230604203453</figcaption></figure>
<p>NguyÃªn táº¯c cá»§a Hash Join lÃ :</p>
<ul>
<li>Äá»c táº¥t cáº£ cÃ¡c hÃ ng cá»§a quan há»‡ bÃªn trong</li>
<li>XÃ¢y dá»±ng má»™t báº£ng bÄƒm (hash table) trong bá»™ nhá»›</li>
<li>Äá»c tá»«ng hÃ ng cá»§a quan há»‡ bÃªn ngoÃ i + (sá»­ dá»¥ng hÃ m bÄƒm (hash function) cá»§a báº£ng bÄƒm (hash table)) Ä‘á»ƒ tÃ­nh toÃ¡n giÃ¡ trá»‹ bÄƒm (hash value) cá»§a má»—i hÃ ng Ä‘á»ƒ tÃ¬m bÃªn trong thÃ¹ng bÄƒm (hash bucket) cÃ³ liÃªn quan trong quan há»‡ bÃªn trong</li>
<li>XÃ¡c Ä‘á»‹nh cÃ³ khá»›p vá»›i cÃ¡c hÃ ng cá»§a quan há»‡ bÃªn ngoÃ i hay khÃ´ng?</li>
</ul>
<p>Vá» Ä‘á»™ phá»©c táº¡p cá»§a thá»i gian, tÃ´i cáº§n pháº£i Ä‘Æ°a ra má»™t sá»‘ giáº£ Ä‘á»‹nh Ä‘á»ƒ Ä‘Æ¡n giáº£n hÃ³a váº¥n Ä‘á»:</p>
<ul>
<li>quan há»‡ bÃªn trong Ä‘Æ°á»£c chia thÃ nh X thÃ¹ng bÄƒm</li>
<li>HÃ m bÄƒm phÃ¢n phá»‘i gáº§n nhÆ° Ä‘á»“ng Ä‘á»u giÃ¡ trá»‹ bÄƒm cá»§a dá»¯ liá»‡u trong má»—i quan há»‡, cÃ³ nghÄ©a lÃ  kÃ­ch thÆ°á»›c thÃ¹ng bÄƒm lÃ  nhÆ° nhau.</li>
<li>CÃ¡c yáº¿u tá»‘ cá»§a quan há»‡ bÃªn ngoÃ i phÃ¹ há»£p vá»›i táº¥t cáº£ cÃ¡c yáº¿u tá»‘ trong thÃ¹ng bÄƒm, vá»›i chi phÃ­ lÃ  sá»‘ lÆ°á»£ng cÃ¡c hÃ ng trong thÃ¹ng bÄƒm.</li>
</ul>
<p>Äá»™ phá»©c táº¡p thá»i gian lÃ  <code>(M/X) * N + chi phÃ­ táº¡o báº£ng bÄƒm (M) + chi phÃ­ hÃ m bÄƒm * N</code>. Náº¿u hÃ m bÄƒm táº¡o ra thÃ¹ng bÄƒm Ä‘á»§ nhá», Ä‘á»™ phá»©c táº¡p lÃ  <code>O(M+N)</code>.</p>
<p>NgoÃ i ra cÃ²n cÃ³ má»™t phiÃªn báº£n Hash Join, cÃ³ lá»£i cho bá»™ nhá»› nhÆ°ng khÃ´ng Ä‘á»§ tá»‘t cho disk I/O. Láº§n nÃ y nÃ³ trÃ´ng nhÆ° tháº¿ nÃ y:</p>
<ul>
<li>TÃ­nh toÃ¡n báº£ng bÄƒm cá»§a cáº£ hai quan há»‡ bÃªn trong vÃ  bÃªn ngoÃ i</li>
<li>LÆ°u báº£ng bÄƒm vÃ o disk</li>
<li>Sau Ä‘Ã³ so sÃ¡nh tá»«ng thÃ¹ng bÄƒm (má»™t trong sá»‘ Ä‘Ã³ Ä‘Æ°á»£c Ä‘á»c vÃ o bá»™ nhá»› vÃ  Ä‘á»c tá»«ng dÃ²ng khÃ¡c).</li>
</ul>
<h5>Merge Join</h5>
<blockquote>
<p>Merge Join lÃ  thuáº­t toÃ¡n liÃªn káº¿t duy nháº¥t táº¡o ra sáº¯p xáº¿p.</p>
</blockquote>
<p>LÆ°u Ã½: Merge Join Ä‘Æ¡n giáº£n nÃ y khÃ´ng phÃ¢n biá»‡t giá»¯a báº£ng bÃªn trong hoáº·c bá» ngoÃ i. Hai báº£ng Ä‘Ã³ng cÃ¹ng má»™t vai trÃ². NhÆ°ng thá»±c sá»± thá»±c hiá»‡n theo nhá»¯ng cÃ¡ch khÃ¡c nhau, cháº³ng háº¡n nhÆ° khi xá»­ lÃ½ cÃ¡c giÃ¡ trá»‹ trÃ¹ng láº·p.</p>
<ul>
<li>
<ol>
<li>(TÃ¹y chá»n) Hoáº¡t Ä‘á»™ng sáº¯p xáº¿p cÃ¡c káº¿t há»£p (join): cáº£ hai nguá»“n Ä‘áº§u vÃ o Ä‘Æ°á»£c sáº¯p xáº¿p theo tá»« khÃ³a Ä‘Æ°á»£c liÃªn káº¿t.</li>
</ol>
</li>
<li>
<ol start="2">
<li>Hoáº¡t Ä‘á»™ng há»£p nháº¥t cÃ¡c káº¿t há»£p : cÃ¡c nguá»“n Ä‘áº§u vÃ o Ä‘Ã£ Ä‘Æ°á»£c sáº¯p xáº¿p Ä‘Æ°á»£c há»£p nháº¥t vá»›i nhau.</li>
</ol>
</li>
<li>
<p><strong>Sort</strong></p>
</li>
</ul>
<p>TÃ´i Ä‘Ã£ nÃ³i vá» [[Merge Sort]], lÃ  má»™t thuáº­t toÃ¡n sáº¯p xáº¿p tá»‘t (nhÆ°ng khÃ´ng pháº£i lÃ  tá»‘t nháº¥t, hoáº·c hash Join tá»‘t hÆ¡n náº¿u bá»™ nhá»› lÃ  Ä‘á»§).</p>
<p>Tuy nhiÃªn, Ä‘Ã´i khi táº­p dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c sáº¯p xáº¿p, cháº³ng háº¡n nhÆ°:</p>
<ul>
<li>
<p>Náº¿u bÃªn trong báº£ng cÃ³ thá»© tá»±, cháº³ng háº¡n nhÆ° má»™t báº£ng cÃ³ chá»‰ má»¥c trong Ä‘iá»u kiá»‡n ná»‘i (index-organized table)</p>
</li>
<li>
<p>Náº¿u quan há»‡ lÃ  má»™t chá»‰ má»¥c trong Ä‘iá»u kiá»‡n káº¿t ná»‘i</p>
</li>
<li>
<p>Náº¿u phÃ©p káº¿t ná»‘i Ã¡p dá»¥ng vá»›i káº¿t quáº£ trung gian mÃ  Ä‘Ã£ Ä‘Æ°á»£c sáº¯p xáº¿p trong má»™t truy váº¥n</p>
</li>
<li>
<p><strong>Merge Join</strong></p>
</li>
</ul>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/Pasted image 20230604205032.png" alt="Pasted image 20230604205032" tabindex="0" loading="lazy"><figcaption>Pasted image 20230604205032</figcaption></figure>
<p>Pháº§n nÃ y ráº¥t giá»‘ng vá»›i cÃ¡c hoáº¡t Ä‘á»™ng há»£p nháº¥t trong merge sort. NhÆ°ng láº§n nÃ y, tÃ´i khÃ´ng chá»n táº¥t cáº£ cÃ¡c yáº¿u tá»‘ tá»« hai quan há»‡, nhÆ°ng chá»‰ chá»n cÃ¹ng má»™t yáº¿u tá»‘. Sá»± tháº­t lÃ  nhÆ° sau:</p>
<ol>
<li>Trong hai quan há»‡, so sÃ¡nh cÃ¡c yáº¿u tá»‘ hiá»‡n táº¡i (hiá»‡n táº¡i = láº§n Ä‘áº§u tiÃªn xuáº¥t hiá»‡n)</li>
<li>Náº¿u giá»‘ng nhau, Ä‘Æ°a cáº£ hai yáº¿u tá»‘ vÃ o káº¿t quáº£ vÃ  so sÃ¡nh yáº¿u tá»‘ tiáº¿p theo trong cáº£ hai quan há»‡</li>
<li>Náº¿u khÃ¡c nhau, hÃ£y tÃ¬m yáº¿u tá»‘ tiáº¿p theo trong quan há»‡ vá»›i cÃ¡c yáº¿u tá»‘ nhá» nháº¥t (vÃ¬ yáº¿u tá»‘ tiáº¿p theo cÃ³ thá»ƒ phÃ¹ há»£p)</li>
<li>Láº·p láº¡i cÃ¡c bÆ°á»›c 1, 2, 3 cho Ä‘áº¿n khi yáº¿u tá»‘ cuá»‘i cÃ¹ng cá»§a má»™t trong cÃ¡c quan há»‡.</li>
</ol>
<p>Bá»Ÿi vÃ¬ cáº£ hai quan há»‡ Ä‘Ã£ Ä‘Æ°á»£c sáº¯p xáº¿p, báº¡n khÃ´ng cáº§n pháº£i "nhÃ¬n láº¡i", vÃ¬ váº­y phÆ°Æ¡ng phÃ¡p nÃ y cÃ³ hiá»‡u quáº£.</p>
<p>ÄÃ¢y Ä‘Æ¡n giáº£n lÃ  kÄ© thuáº­t two pointer, duyá»‡t trÃªn hai máº£ng Ä‘Ã£ sáº¯p xáº¿p.</p>
<p>Thuáº­t toÃ¡n lÃ  má»™t phiÃªn báº£n Ä‘Æ¡n giáº£n vÃ¬ nÃ³ khÃ´ng xá»­ lÃ½ cÃ¡c tÃ¬nh huá»‘ng xáº£y dá»¯ liá»‡u trÃ¹ng (tá»©c lÃ  nhiá»u káº¿t há»£p) trÃªn cÃ¹ng máº£ng trong cáº£ hai máº£ng. PhiÃªn báº£n thá»±c táº¿ phá»©c táº¡p hÆ¡n, vÃ¬ váº­y tÃ´i Ä‘Ã£ chá»n phiÃªn báº£n Ä‘Æ¡n giáº£n hÃ³a.</p>
<p>Náº¿u cáº£ hai quan há»‡ Ä‘Ã£ Ä‘Æ°á»£c sáº¯p xáº¿p, Ä‘á»™ phá»©c táº¡p cá»§a thá»i gian lÃ  <code>O(N+M)</code></p>
<p>Náº¿u hai quan há»‡ cáº§n Ä‘Æ°á»£c sáº¯p xáº¿p, Ä‘á»™ phá»©c táº¡p thá»i gian lÃ  chi phÃ­ sáº¯p xáº¿p hai quan há»‡: <code>O(N*Log(N) + M*Log(M))</code></p>
<h5>Thuáº­t toÃ¡n nÃ o lÃ  tá»‘t nháº¥t?</h5>
<p>Náº¿u cÃ³ tá»‘t nháº¥t, khÃ´ng cáº§n pháº£i lÃ m cho nhiá»u loáº¡i nhÆ° váº­y. CÃ¢u há»i nÃ y lÃ  khÃ³, bá»Ÿi vÃ¬ nhiá»u yáº¿u tá»‘ cáº§n xem xÃ©t, cháº³ng háº¡n nhÆ°:</p>
<ul>
<li><strong>Bá»™ nhá»› nhÃ n rá»—i</strong>: Náº¿u báº¡n khÃ´ng cÃ³ Ä‘á»§ bá»™ nhá»›, hÃ£y chá»n Hash Join (Ã­t nháº¥t lÃ  hoÃ n toÃ n trong bá»™ nhá»›).</li>
<li><strong>KÃ­ch thÆ°á»›c cá»§a cáº£ hai táº­p dá»¯ liá»‡u</strong>. VÃ­ dá»¥, náº¿u má»™t báº£ng lá»›n ná»‘i má»™t báº£ng nhá», thÃ¬ Nested Loop Join nhanh hÆ¡n so vá»›i Hash Join, vÃ¬ sau nÃ y cÃ³ chi phÃ­ cao Ä‘á»ƒ táº¡o ra báº£ng bÄƒm; Náº¿u cáº£ hai báº£ng Ä‘á»u ráº¥t lá»›n, Nested Loop Join cÃ³ chi phÃ­ cpu ráº¥t cao.</li>
<li><strong>Náº¿u cÃ³ chá»‰ má»¥c</strong>: Náº¿u cÃ³ hai chá»‰ má»¥c B+ Tree, lá»±a chá»n thÃ´ng minh dÆ°á»ng nhÆ° lÃ  Merge Join.</li>
<li><strong>Káº¿t quáº£ cÃ³ cáº§n pháº£i Ä‘Æ°á»£c sáº¯p xáº¿p hay khÃ´ng?</strong>: Ngay cáº£ khi báº¡n Ä‘ang sá»­ dá»¥ng má»™t táº­p dá»¯ liá»‡u chÆ°a Ä‘Æ°á»£c sáº¯p xáº¿p, máº·c dÃ¹ cÃ³ chi phÃ­ cao hÆ¡n (vÃ¬ pháº£i sáº¯p xáº¿p) nhÆ°ng báº¡n cÃ³ thá»ƒ váº«n muá»‘n sá»­ dá»¥ng Merge Join náº¿u sau khi cÃ³ Ä‘Æ°á»£c káº¿t quáº£ Ä‘Æ°á»£c sáº¯p xáº¿p, báº¡n cÃ³ thá»ƒ liÃªn káº¿t nÃ³ vá»›i má»™t Merge Join khÃ¡c (hoáº·c cÃ³ thá»ƒ vÃ¬ truy váº¥n yÃªu cáº§u káº¿t quáº£ sáº¯p xáº¿p ngáº§m hoáº·c rÃµ rÃ ng vá»›i cÃ¡c thao tÃ¡c nhÆ° ORDER BY/GROUP BY/DISTINCT).</li>
<li><strong>Quan há»‡ Ä‘Ã£ Ä‘Æ°á»£c sáº¯p xáº¿p:</strong> Táº¡i thá»i Ä‘iá»ƒm nÃ y, Merge Join lÃ  lá»±a chá»n tá»‘t nháº¥t.</li>
<li><strong>Loáº¡i káº¿t ná»‘i</strong>: LÃ  káº¿t ná»‘i tÆ°Æ¡ng Ä‘Æ°Æ¡ng (vÃ­ dá»¥: tableA.col1 = tableB.col2)? Hoáº·c Inner Join? Outer Join? Cartesian Join? Hoáº·c Self Join? Má»™t sá»‘ káº¿t ná»‘i khÃ´ng hoáº¡t Ä‘á»™ng trong má»™t mÃ´i trÆ°á»ng cá»¥ thá»ƒ.</li>
<li><strong>PhÃ¢n phá»‘i dá»¯ liá»‡u</strong>: Náº¿u dá»¯ liá»‡u vá» Ä‘iá»u kiá»‡n káº¿t ná»‘i lÃ  lá»‡ch (vÃ­ dá»¥: Ä‘á»ƒ káº¿t ná»‘i ngÆ°á»i vá»›i há» (lastname), nhÆ°ng nhiá»u ngÆ°á»i cÃ³ cÃ¹ng há»), Hash Join sáº½ lÃ  má»™t tháº£m há»a vÃ¬ hÃ m bÄƒm sáº½ táº¡o ra thÃ¹ng bÄƒm phÃ¢n bá»‘ ráº¥t khÃ´ng Ä‘á»“ng Ä‘á»u.</li>
<li>Náº¿u báº¡n muá»‘n cÃ¡c hoáº¡t Ä‘á»™ng káº¿t ná»‘i sá»­ dá»¥ng <strong>Ä‘a luá»“ng hoáº·c Ä‘a tiáº¿n trÃ¬nh</strong>.</li>
</ul>
<p>Äá»ƒ biáº¿t thÃªm thÃ´ng tin, báº¡n cÃ³ thá»ƒ Ä‘á»c tÃ i liá»‡u cho DB2, ORACLE hoáº·c SQL Server.</p>
<h4>VÃ­ dá»¥ Ä‘Æ¡n giáº£n</h4>
<p>ChÃºng tÃ´i Ä‘Ã£ nghiÃªn cá»©u 3 loáº¡i phÃ©p káº¿t ná»‘i. BÃ¢y giá», vÃ­ dá»¥, chÃºng ta sáº½ káº¿t ná»‘i 5 báº£ng Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c táº¥t cáº£ thÃ´ng tin cá»§a má»™t ngÆ°á»i. Má»™t ngÆ°á»i cÃ³ thá»ƒ cÃ³:</p>
<ul>
<li>Nhiá»u sá»‘ Ä‘iá»‡n thoáº¡i di Ä‘á»™ng (MOBILES)</li>
<li>Nhiá»u há»™p thÆ° (MAILS)</li>
<li>Nhiá»u Ä‘á»‹a chá»‰ (ADRESSES)</li>
<li>Nhiá»u tÃ i khoáº£n ngÃ¢n hÃ ng (BANK_ACCOUNTS)</li>
</ul>
<p>NÃ³i cÃ¡ch khÃ¡c, chÃºng ta cáº§n pháº£i nhanh chÃ³ng nháº­n Ä‘Æ°á»£c cÃ¢u tráº£ lá»i vá»›i truy váº¥n sau:</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SELECT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> * </span><span style="color:#C678DD;--shiki-dark:#C678DD">from</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> PERSON, MOBILES, MAILS, ADRESSES, BANK_ACCOUNTS</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">WHERE</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66">PERSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">PERSON_ID</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66"> MOBILES</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">PERSON_ID</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">AND</span><span style="color:#D19A66;--shiki-dark:#D19A66"> PERSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">PERSON_ID</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66"> MAILS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">PERSON_ID</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">AND</span><span style="color:#D19A66;--shiki-dark:#D19A66"> PERSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">PERSON_ID</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66"> ADRESSES</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">PERSON_ID</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">AND</span><span style="color:#D19A66;--shiki-dark:#D19A66"> PERSON</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">PERSON_ID</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66"> BANK_ACCOUNTS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">PERSON_ID</span></span></code></pre>
</div><p>LÃ  má»™t trÃ¬nh tá»‘i Æ°u hÃ³a truy váº¥n, tÃ´i pháº£i tÃ¬m cÃ¡ch tá»‘t nháº¥t Ä‘á»ƒ xá»­ lÃ½ dá»¯ liá»‡u. NhÆ°ng cÃ³ 2 cÃ¢u há»i:</p>
<ul>
<li>Loáº¡i nÃ o Ä‘Æ°á»£c sá»­ dá»¥ng cho má»—i káº¿t ná»‘i?
<ul>
<li>TÃ´i cÃ³ 3 lá»±a chá»n (hash, merge, nested loop) vÃ  cÃ³ thá»ƒ sá»­ dá»¥ng 0, 1 hoáº·c 2 chá»‰ má»¥c cÃ¹ng lÃºc (khÃ´ng cáº§n pháº£i nÃ³i ráº±ng cÃ³ nhiá»u loáº¡i chá»‰ má»¥c).</li>
</ul>
</li>
<li>Káº¿t ná»‘i Ä‘Æ°á»£c thá»±c hiá»‡n theo thá»© tá»± nÃ o?</li>
</ul>
<p>VÃ­ dá»¥: hÃ¬nh áº£nh sau Ä‘Ã¢y cho tháº¥y káº¿ hoáº¡ch thá»±c thi cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng cho 4 báº£ng chá»‰ 3 láº§n join:</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/Pasted image 20230604214715.png" alt="Pasted image 20230604214715" tabindex="0" loading="lazy"><figcaption>Pasted image 20230604214715</figcaption></figure>
<p>CÃ¡c truy váº¥n trong thá»±c táº¿ cÅ©ng cÃ³ cÃ¡c toÃ¡n tá»­ quan há»‡ khÃ¡c, cháº³ng háº¡n nhÆ° OUTER JOIN, CROSS JOIN, GROUP BY, ORDER BY, PROJECTION, UNION, INTERSECT, DISTINCT â€¦ Äiá»u nÃ y cÃ³ nghÄ©a lÃ  nhiá»u kháº£ nÄƒng hÆ¡n.</p>
<p><strong>VÃ¬ váº­y, lÃ m tháº¿ nÃ o Ä‘á»ƒ cÆ¡ sá»Ÿ dá»¯ liá»‡u xá»­ lÃ½</strong>?</p>
<p><code>Dynamic Programing</code>, <code>Greedy</code> <code>Heuristic</code></p>
<h4>Dynamic Programming, Greedy, and Heuristic Algorithm</h4>
<p>CÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡ sáº½ thá»­ má»™t sá»‘ phÆ°Æ¡ng phÃ¡p mÃ  tÃ´i vá»«a Ä‘á» cáº­p, <strong>vÃ  cÃ´ng viá»‡c thá»±c sá»± cá»§a trÃ¬nh tá»‘i Æ°u hÃ³a lÃ  tÃ¬m má»™t giáº£i phÃ¡p tá»‘t trong má»™t khoáº£ng thá»i gian giá»›i háº¡n</strong>.</p>
<p>Háº§u háº¿t thá»i gian, trÃ¬nh tá»‘i Æ°u hÃ³a khÃ´ng tÃ¬m tháº¥y giáº£i phÃ¡p tá»‘t nháº¥t, nhÆ°ng giáº£i phÃ¡p cÃ³ thá»ƒ xem lÃ  "tá»‘t" (Ä‘Æ°Æ¡ng nhiÃªn lÃ  cÅ©ng cÃ³ nhá»¯ng lÃºc tá»‘t trong ngoáº·c kÃ©p tháº­t)</p>
<ul>
<li><strong>Quy hoáº¡ch Ä‘á»™ng (Dynamic Programming)</strong></li>
</ul>
<blockquote>
<p>Äá»‘i vá»›i cÃ¡c truy váº¥n quy mÃ´ nhá», cÃ³ thá»ƒ Ã¡p dá»¥ng má»™t cÃ¡ch tiáº¿p cáº­n trÃ¢u (brute-force). NhÆ°ng Ä‘á»ƒ cÃ¡c truy váº¥n quy mÃ´ trung bÃ¬nh cÅ©ng cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n má»™t cÃ¡ch tiáº¿p cáº­n trÃ¢u, chÃºng tÃ´i cÃ³ má»™t cÃ¡ch Ä‘á»ƒ trÃ¡nh cÃ¡c tÃ­nh toÃ¡n khÃ´ng cáº§n thiáº¿t, Ä‘Ã³ lÃ  quy hoáº¡ch Ä‘á»™ng.</p>
</blockquote>
<p>Ã tÆ°á»Ÿng Ä‘áº±ng sau nhá»¯ng tá»« nÃ y lÃ  nhiá»u káº¿ hoáº¡ch thá»±c hiá»‡n ráº¥t giá»‘ng nhau. HÃ£y xem cÃ¡c káº¿ hoáº¡ch dÆ°á»›i Ä‘Ã¢y:</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/Pasted image 20230604215931.png" alt="Pasted image 20230604215931" tabindex="0" loading="lazy"><figcaption>Pasted image 20230604215931</figcaption></figure>
<p>Táº¥t cáº£ chÃºng Ä‘á»u cÃ³ cÃ¹ng má»™t cÃ¢y con (A JOIN B), vÃ¬ váº­y báº¡n khÃ´ng cáº§n pháº£i tÃ­nh toÃ¡n chi phÃ­ cá»§a cÃ¢y con nÃ y trong má»—i káº¿ hoáº¡ch, tÃ­nh toÃ¡n má»™t láº§n, lÆ°u káº¿t quáº£ vÃ  tÃ¡i sá»­ dá»¥ng khi gáº·p láº¡i cÃ¢y con nÃ y. Theo cÃ¡ch nÃ³i chÃ­nh thá»©c hÆ¡n, chÃºng ta Ä‘ang pháº£i Ä‘á»‘i máº·t vá»›i má»™t váº¥n Ä‘á» chá»“ng chÃ©o. Äá»ƒ trÃ¡nh tÃ­nh toÃ¡n trÃ¹ng láº·p má»™t sá»‘ káº¿t quáº£, chÃºng tÃ´i sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p ghi nhá»›.</p>
<p>Ãp dá»¥ng kÄ© thuáº­t nÃ y, chÃºng tÃ´i khÃ´ng cÃ²n Ä‘á»™ phá»©c táº¡p <code>(2*N)!/(N+1)!</code>, nhÆ°ng "chá»‰" <code>3^N</code>. Trong vÃ­ dá»¥ 4 JOIN trÃªn, Ä‘iá»u nÃ y cÃ³ nghÄ©a lÃ  giáº£m sá»‘ láº§n sáº¯p xáº¿p tá»« 336 xuá»‘ng cÃ²n 81 láº§n. Náº¿u Ä‘Ã³ lÃ  má»™t truy váº¥n lá»›n hÆ¡n, cháº³ng háº¡n nhÆ° 8 JOIN (thá»±c sá»± khÃ´ng pháº£i lÃ  ráº¥t lá»›n), giáº£m 57.657.600 xuá»‘ng cÃ²n 6.551.</p>
<p>Äá»‘i vá»›i cÃ¡c truy váº¥n quy mÃ´ lá»›n, báº¡n cÅ©ng cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c phÆ°Æ¡ng phÃ¡p quy hoáº¡ch Ä‘á»™ng, nhÆ°ng kÃ¨m vá»›i cÃ¡c quy táº¯c bá»• sung(hoáº·c thuáº­t toÃ¡n heuristics) Ä‘á»ƒ giáº£m kháº£ nÄƒng.</p>
<ul>
<li>Náº¿u chÃºng ta chá»‰ phÃ¢n tÃ­ch má»™t loáº¡i káº¿ hoáº¡ch cá»¥ thá»ƒ (vÃ­ dá»¥: cÃ¢y sÃ¢u bÃªn trÃ¡i left-deep tree), chÃºng ta sáº½ nháº­n Ä‘Æ°á»£c <code>n*2^n</code> thay vÃ¬ <code>3^n</code>.</li>
</ul>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/Pasted image 20230604220538.png" alt="Pasted image 20230604220538" tabindex="0" loading="lazy"><figcaption>Pasted image 20230604220538</figcaption></figure>
<ul>
<li>
<p>Náº¿u chÃºng ta thÃªm cÃ¡c quy táº¯c há»£p lÃ½ Ä‘á»ƒ trÃ¡nh káº¿ hoáº¡ch cho má»™t sá»‘ mÃ´ hÃ¬nh (vÃ­ dá»¥: 'náº¿u má»™t báº£ng cÃ³ chá»‰ má»¥c cho cÃ¡c vá»‹ ngá»¯ Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh, khÃ´ng cá»‘ gáº¯ng merge join vá»›i báº£ng, nhÆ°ng vá»›i chá»‰ má»¥c), chÃºng ta sáº½ giáº£m sá»‘ lÆ°á»£ng kháº£ nÄƒng mÃ  khÃ´ng gÃ¢y ra thiá»‡t háº¡i quÃ¡ má»©c cho ká»‹ch báº£n tá»‘t nháº¥t.</p>
</li>
<li>
<p>Náº¿u chÃºng ta thÃªm cÃ¡c quy táº¯c vÃ o quÃ¡ trÃ¬nh (cháº³ng háº¡n nhÆ° cÃ¡c hoáº¡t Ä‘á»™ng káº¿t ná»‘i trÆ°á»›c táº¥t cáº£ cÃ¡c tÃ­nh toÃ¡n quan há»‡ khÃ¡c), chÃºng ta cÅ©ng cÃ³ thá»ƒ giáº£m Ä‘Ã¡ng ká»ƒ kháº£ nÄƒng.</p>
</li>
<li>
<p>â€¦â€¦</p>
</li>
<li>
<p><strong>Thuáº­t toÃ¡n tham lam (Greed Alogrithm)</strong></p>
</li>
</ul>
<blockquote>
<p>Tuy nhiÃªn, trÃ¬nh tá»‘i Æ°u hÃ³a pháº£i Ä‘á»‘i máº·t vá»›i má»™t truy váº¥n ráº¥t lá»›n, hoáº·c Ä‘á»ƒ tÃ¬m cÃ¢u tráº£ lá»i cÃ ng sá»›m cÃ ng tá»‘t (tuy nhiÃªn tá»‘c Ä‘á»™ truy váº¥n khÃ´ng nhanh), má»™t thuáº­t toÃ¡n khÃ¡c, Ä‘Æ°á»£c gá»i lÃ  thuáº­t toÃ¡n tham lam.</p>
</blockquote>
<p>NguyÃªn táº¯c lÃ  láº­p káº¿ hoáº¡ch truy váº¥n theo má»™t quy táº¯c (hoáº·c heuristic) má»™t cÃ¡ch dáº§n dáº§n. Theo quy táº¯c nÃ y, cÃ¡c thuáº­t toÃ¡n tham lam dáº§n dáº§n tÃ¬m kiáº¿m cÃ¡c thuáº­t toÃ¡n tá»‘t nháº¥t, xá»­ lÃ½ má»™t JOIN Ä‘áº§u tiÃªn, sau Ä‘Ã³ thÃªm má»™t JOIN má»›i theo cÃ¹ng má»™t quy táº¯c cho má»—i bÆ°á»›c.</p>
<p>HÃ£y xem xÃ©t má»™t vÃ­ dá»¥ Ä‘Æ¡n giáº£n. VÃ­ dá»¥, má»™t truy váº¥n JOIN cho 5 báº£ng (A, B, C, D, E) 4 láº§n, Ä‘á»ƒ Ä‘Æ¡n giáº£n hÃ³a viá»‡c chÃºng tÃ´i sá»­ dá»¥ng JOIN lá»“ng nhau nhÆ° má»™t phÆ°Æ¡ng phÃ¡p káº¿t ná»‘i cÃ³ thá»ƒ, chÃºng tÃ´i lÃ m theo quy táº¯c "sá»­ dá»¥ng káº¿t ná»‘i chi phÃ­ tháº¥p nháº¥t".</p>
<ul>
<li>Chá»n má»™t báº¯t Ä‘áº§u trá»±c tiáº¿p tá»« 5 báº£ng (vÃ­ dá»¥: A)</li>
<li>TÃ­nh toÃ¡n má»—i káº¿t ná»‘i vá»›i A (A lÃ  má»™t quan há»‡ bÃªn trong hoáº·c bÃªn ngoÃ i)</li>
<li>KhÃ¡m phÃ¡ "A JOIN B" cÃ³ chi phÃ­ tháº¥p nháº¥t</li>
<li>TÃ­nh toÃ¡n chi phÃ­ cá»§a má»—i káº¿t quáº£ Ä‘Æ°á»£c káº¿t ná»‘i vá»›i <code>A JOIN B</code> (<code>A JOIN B</code> lÃ  quan há»‡ bÃªn trong hoáº·c bÃªn ngoÃ i)</li>
<li>KhÃ¡m phÃ¡ <code>(A JOIN B) JOIN C</code> cÃ³ chi phÃ­ tháº¥p nháº¥t</li>
<li>TÃ­nh toÃ¡n chi phÃ­ cá»§a má»—i káº¿t quáº£ Ä‘Æ°á»£c káº¿t há»£p vá»›i <code>(A JOIN B) JOIN C</code>.</li>
<li>â€¦â€¦</li>
<li>HoÃ n thiá»‡n káº¿ hoáº¡ch thá»±c hiá»‡n <code>((A JOIN B) JOIN C) JOIN D ) JOIN E)</code></li>
</ul>
<p>Bá»Ÿi vÃ¬ chÃºng tÃ´i báº¯t Ä‘áº§u má»™t cÃ¡ch tÃ¹y tiá»‡n vá»›i báº£ng A, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¹ng má»™t thuáº­t toÃ¡n trong B, sau Ä‘Ã³ C, sau Ä‘Ã³ D, sau Ä‘Ã³ E. Cuá»‘i cÃ¹ng giá»¯ láº¡i káº¿ hoáº¡ch thá»±c hiá»‡n vá»›i chi phÃ­ tháº¥p nháº¥t.</p>
<p>NhÃ¢n tiá»‡n, thuáº­t toÃ¡n nÃ y cÃ³ má»™t cÃ¡i tÃªn, Ä‘Æ°á»£c gá»i lÃ  "Nearest Neighbor Algorithm".</p>
<p>Bá» qua cÃ¡c chi tiáº¿t, chá»‰ cáº§n má»™t mÃ´ hÃ¬nh tá»‘t vÃ  sáº¯p xáº¿p Ä‘á»™ phá»©c táº¡p <code>Nlog(N)</code>, váº¥n Ä‘á» cÃ³ thá»ƒ dá»… dÃ ng Ä‘Æ°á»£c giáº£i quyáº¿t. Äá»™ phá»©c táº¡p cá»§a thuáº­t toÃ¡n nÃ y lÃ  <code>O(Nlog(N)</code>, so sÃ¡nh vá»›i <code>O(3^N)</code> cá»§a dynamic programming. Náº¿u báº¡n cÃ³ má»™t truy váº¥n lá»›n 20 JOIN, Ä‘iá»u nÃ y cÃ³ nghÄ©a lÃ  26 vs 3,486,784,401, má»™t sá»± khÃ¡c biá»‡t lá»›n!</p>
<p>Váº¥n Ä‘á» vá»›i thuáº­t toÃ¡n nÃ y lÃ  giáº£ Ä‘á»‹nh chÃºng tÃ´i thá»±c hiá»‡n lÃ  tÃ¬m cÃ¡ch tá»‘t nháº¥t Ä‘á»ƒ káº¿t ná»‘i 2 báº£ng, giá»¯ láº¡i káº¿t quáº£ káº¿t ná»‘i nÃ y vÃ  káº¿t ná»‘i báº£ng tiáº¿p theo Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c chi phÃ­ tháº¥p nháº¥t. Tuy nhiÃªn:</p>
<ul>
<li>Ngay cáº£ giá»¯a A, B, C, <code>A JOIN B</code> cÃ³ giÃ¡ tháº¥p nháº¥t</li>
<li><code>(A JOIN C) JOIN B</code> cÃ³ thá»ƒ tá»‘t hÆ¡n so vá»›i <code>(A JOIN B) JOIN C</code>.</li>
</ul>
<p>Äá»ƒ cáº£i thiá»‡n tÃ¬nh tráº¡ng nÃ y, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c thuáº­t toÃ¡n tham lam dá»±a trÃªn cÃ¡c quy táº¯c khÃ¡c nhau nhiá»u láº§n vÃ  giá»¯ láº¡i káº¿ hoáº¡ch thá»±c hiá»‡n tá»‘t nháº¥t.</p>
<h4>Bá»™ nhá»› cache káº¿ hoáº¡ch truy váº¥n (Query Plan Cache)</h4>
<p>VÃ¬ viá»‡c táº¡o káº¿ hoáº¡ch truy váº¥n tá»‘n thá»i gian, háº§u háº¿t cÃ¡c cÆ¡ sá»Ÿ dá»¯ liá»‡u lÆ°u káº¿ hoáº¡ch trong bá»™ nhá»› <code>query plan cache</code> Ä‘á»ƒ trÃ¡nh tÃ­nh toÃ¡n trÃ¹ng láº·p. Chá»§ Ä‘á» nÃ y lÃ  lá»›n hÆ¡n bá»Ÿi vÃ¬ cÆ¡ sá»Ÿ dá»¯ liá»‡u cáº§n pháº£i biáº¿t khi nÃ o Ä‘á»ƒ cáº­p nháº­t cÃ¡c káº¿ hoáº¡ch lá»—i thá»i. CÃ¡ch tiáº¿p cáº­n lÃ  Ä‘áº·t giá»›i háº¡n trÃªn vÃ  náº¿u má»™t báº£ng thay Ä‘á»•i thá»‘ng kÃª vÆ°á»£t quÃ¡ giá»›i háº¡n trÃªn, káº¿ hoáº¡ch truy váº¥n vá» báº£ng sáº½ bá»‹ xÃ³a khá»i bá»™ nhá»› cache.</p>
<h3>TrÃ¬nh thá»±c thi truy váº¥n (Query Excuter)</h3>
<p>á» giai Ä‘oáº¡n nÃ y, chÃºng tÃ´i cÃ³ má»™t káº¿ hoáº¡ch thá»±c hiá»‡n Ä‘Æ°á»£c tá»‘i Æ°u hÃ³a vÃ  biÃªn dá»‹ch thÃ nh mÃ£ thá»±c thi. Sau Ä‘Ã³, náº¿u cÃ³ Ä‘á»§ tÃ i nguyÃªn (bá»™ nhá»›, CPU), trÃ¬nh thá»±c thi truy váº¥n sáº½ thá»±c thi nÃ³. CÃ¡c toÃ¡n tá»­ (JOIN, SORT BY â€¦) trong káº¿ hoáº¡ch cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n theo thá»© tá»± hoáº·c song song, tÃ¹y thuá»™c vÃ o trÃ¬nh thá»±c thi. Äá»ƒ láº¥y vÃ  ghi dá»¯ liá»‡u, trÃ¬nh thá»±c thi truy váº¥n tÆ°Æ¡ng tÃ¡c vá»›i trÃ¬nh quáº£n lÃ½ dá»¯ liá»‡u, pháº§n tiáº¿p theo cá»§a bÃ i viáº¿t nÃ y tháº£o luáº­n vá» trÃ¬nh quáº£n lÃ½ dá»¯ liá»‡u.</p>
<h2>TrÃ¬nh quáº£n lÃ½ dá»¯ liá»‡u</h2>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/Pasted image 20230604232022.png" alt="Pasted image 20230604232022" tabindex="0" loading="lazy"><figcaption>Pasted image 20230604232022</figcaption></figure>
<p>á» bÆ°á»›c nÃ y, trÃ¬nh quáº£n lÃ½ truy váº¥n thá»±c hiá»‡n truy váº¥n vÃ  yÃªu cáº§u dá»¯ liá»‡u tá»« báº£ng vÃ  chá»‰ má»¥c. NhÆ°ng cÃ³ 2 cÃ¢u há»i:</p>
<ul>
<li>CÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡ sá»­ dá»¥ng mÃ´ hÃ¬nh giao dá»‹ch, vÃ¬ váº­y báº¡n khÃ´ng thá»ƒ cÃ³ Ä‘Æ°á»£c pháº§n dá»¯ liá»‡u nÃ y khi ngÆ°á»i khÃ¡c sá»­ dá»¥ng hoáº·c sá»­a Ä‘á»•i dá»¯ liá»‡u cÃ¹ng má»™t lÃºc.</li>
<li>TrÃ­ch xuáº¥t dá»¯ liá»‡u lÃ  hoáº¡t Ä‘á»™ng cháº­m nháº¥t trong cÆ¡ sá»Ÿ dá»¯ liá»‡u, vÃ¬ váº­y trÃ¬nh quáº£n lÃ½ dá»¯ liá»‡u cáº§n pháº£i Ä‘á»§ thÃ´ng minh Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c dá»¯ liá»‡u vÃ  lÆ°u nÃ³ trong bá»™ Ä‘á»‡m bá»™ nhá»›.</li>
</ul>
<p>Trong pháº§n nÃ y, chÃºng ta hÃ£y xem lÃ m tháº¿ nÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡ xá»­ lÃ½ cáº£ hai váº¥n Ä‘á».</p>
<h3>TrÃ¬nh quáº£n lÃ½ bá»™ nhá»› cache (Cache Manager)</h3>
<blockquote>
<p>NhÆ° Ä‘Ã£ Ä‘á» cáº­p trÆ°á»›c Ä‘Ã³, nÃºt tháº¯t chai chÃ­nh cá»§a cÆ¡ sá»Ÿ dá»¯ liá»‡u lÃ  Disk I/O. Äá»ƒ cáº£i thiá»‡n hiá»‡u suáº¥t, cÆ¡ sá»Ÿ dá»¯ liá»‡u hiá»‡n Ä‘áº¡i sá»­ dá»¥ng trÃ¬nh quáº£n lÃ½ bá»™ nhá»› cache.</p>
</blockquote>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/Pasted image 20230604232659.png" alt="Pasted image 20230604232659" tabindex="0" loading="lazy"><figcaption>Pasted image 20230604232659</figcaption></figure>
<p>TrÃ¬nh thá»±c thi truy váº¥n khÃ´ng láº¥y dá»¯ liá»‡u trá»±c tiáº¿p tá»« há»‡ thá»‘ng tá»‡p, nhÆ°ng tá»« trÃ¬nh quáº£n lÃ½ bá»™ nhá»› cache. TrÃ¬nh quáº£n lÃ½ bá»™ nhá»› cache cÃ³ má»™t khu vá»±c bá»™ nhá»› cache Ä‘Æ°á»£c gá»i lÃ  vÃ¹ng Ä‘á»‡m (buffer pool), Ä‘á»c dá»¯ liá»‡u tá»« bá»™ nhá»› cÃ³ thá»ƒ cáº£i thiá»‡n Ä‘Ã¡ng ká»ƒ hiá»‡u suáº¥t cÆ¡ sá»Ÿ dá»¯ liá»‡u. Tháº­t khÃ³ Ä‘á»ƒ Ä‘Æ°a ra má»™t má»©c Ä‘á»™ Ä‘á»‹nh lÆ°á»£ng cho Ä‘iá»u nÃ y, bá»Ÿi vÃ¬ nÃ³ phá»¥ thuá»™c vÃ o nhá»¯ng gÃ¬ báº¡n cáº§n:</p>
<ul>
<li>Truy cáº­p tuáº§n tá»± (vÃ­ dá»¥: quÃ©t Ä‘áº§y Ä‘á»§) vs truy cáº­p ngáº«u nhiÃªn (vÃ­ dá»¥: truy cáº­p theo row id)</li>
<li>Äá»c hay ghi</li>
</ul>
<p>VÃ  loáº¡i disk Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi cÆ¡ sá»Ÿ dá»¯ liá»‡u:</p>
<ul>
<li>7.2k/10k/15k rpm hard drive</li>
<li>SSD</li>
<li>RAID 1/5/â€¦</li>
</ul>
<p>Äá»ƒ tÃ´i nÃ³i, bá»™ nhá»› nhanh hÆ¡n 100 Ä‘áº¿n 100.000 láº§n so vá»›i disk. Tuy nhiÃªn, Ä‘iá»u nÃ y dáº«n Ä‘áº¿n má»™t váº¥n Ä‘á» khÃ¡c (cÆ¡ sá»Ÿ dá»¯ liá»‡u luÃ´n luÃ´n nhÆ° váº­y â€¦), trÃ¬nh quáº£n lÃ½ bá»™ nhá»› cache cáº§n pháº£i cÃ³ Ä‘Æ°á»£c dá»¯ liá»‡u trÆ°á»›c khi TrÃ¬nh thá»±c thi truy váº¥n sá»­ dá»¥ng dá»¯ liá»‡u, náº¿u khÃ´ng trÃ¬nh quáº£n lÃ½ truy váº¥n sáº½ pháº£i chá» Ä‘á»£i vÃ¬ Ä‘á»c dá»¯ liá»‡u tá»« disk cháº­m.</p>
<h4>Äá»c trÆ°á»›c (Pre-Reading)</h4>
<p>Váº¥n Ä‘á» nÃ y Ä‘Æ°á»£c gá»i <strong>Ä‘á»c trÆ°á»›c (pre-reading)</strong>. TrÃ¬nh thá»±c thi truy váº¥n biáº¿t dá»¯ liá»‡u nÃ o nÃ³ sáº½ cáº§n vÃ¬ nÃ³ hiá»ƒu toÃ n bá»™ luá»“ng truy váº¥n vÃ  dá»¯ liá»‡u trÃªn disk thÃ´ng qua thá»‘ng kÃª. QuÃ¡ trÃ¬nh nÃ y trÃ´ng nhÆ° tháº¿ nÃ y:</p>
<ul>
<li>Khi TrÃ¬nh thá»±c thi truy váº¥n xá»­ lÃ½ lÃ´ dá»¯ liá»‡u Ä‘áº§u tiÃªn cá»§a nÃ³, trÃ¬nh quáº£n lÃ½ bá»™ nhá»› cache Ä‘Æ°á»£c yÃªu cáº§u táº£i trÆ°á»›c lÃ´ dá»¯ liá»‡u thá»© hai</li>
<li>Khi báº¡n báº¯t Ä‘áº§u xá»­ lÃ½ lÃ´ dá»¯ liá»‡u thá»© hai, hÃ£y nÃ³i vá»›i trÃ¬nh quáº£n lÃ½ bá»™ nhá»› cache Ä‘á»ƒ táº£i trÆ°á»›c lÃ´ dá»¯ liá»‡u thá»© ba vÃ  nÃ³i vá»›i trÃ¬nh quáº£n lÃ½ bá»™ nhá»› cache ráº±ng lÃ´ Ä‘áº§u tiÃªn cÃ³ thá»ƒ Ä‘Æ°á»£c xÃ³a khá»i bá»™ nhá»› cache.</li>
<li>â€¦â€¦</li>
</ul>
<p>TrÃ¬nh quáº£n lÃ½ bá»™ nhá»› cache lÆ°u táº¥t cáº£ dá»¯ liá»‡u nÃ y trong vÃ¹ng Ä‘á»‡m. Äá»ƒ xÃ¡c Ä‘á»‹nh xem má»™t dá»¯ liá»‡u cÃ³ há»¯u Ã­ch hay khÃ´ng, trÃ¬nh quáº£n lÃ½ bá»™ nhá»› cache Ä‘Ã£ thÃªm thÃ´ng tin bá»• sung (Ä‘Æ°á»£c gá»i lÃ  chá»‘t (latch)) vÃ o dá»¯ liá»‡u Ä‘Æ°á»£c lÆ°u trong bá»™ nhá»› cache.</p>
<p>ÄÃ´i khi TrÃ¬nh thá»±c thi truy váº¥n khÃ´ng biáº¿t nhá»¯ng gÃ¬ vá» dá»¯ liá»‡u nÃ³ cáº§n vÃ  má»™t sá»‘ cÆ¡ sá»Ÿ dá»¯ liá»‡u khÃ´ng cung cáº¥p chá»©c nÄƒng nÃ y. Thay vÃ o Ä‘Ã³, há» sá»­ dá»¥ng má»™t phÆ°Æ¡ng phÃ¡p Ä‘á»c trÆ°á»›c suy Ä‘oÃ¡n (vÃ­ dá»¥: náº¿u TrÃ¬nh thá»±c thi truy váº¥n muá»‘n dá»¯ liá»‡u 1, 3, 5, nÃ³ cÃ³ thá»ƒ sáº½ Ä‘á»c trÆ°á»›c 7, 9, 11) hoáº·c Ä‘á»c trÆ°á»›c tuáº§n tá»± (táº¡i thá»i Ä‘iá»ƒm nÃ y trÃ¬nh quáº£n lÃ½ bá»™ nhá»› cache chá»‰ Ä‘Æ¡n giáº£n lÃ  táº£i dá»¯ liá»‡u liÃªn tá»¥c tiáº¿p theo tá»« Ä‘Ä©a sau khi Ä‘á»c má»™t loáº¡t dá»¯ liá»‡u).</p>
<p>Äá»ƒ theo dÃµi tÃ¬nh tráº¡ng hoáº¡t Ä‘á»™ng Ä‘á»c trÆ°á»›c, cÆ¡ sá»Ÿ dá»¯ liá»‡u hiá»‡n Ä‘áº¡i giá»›i thiá»‡u má»™t thÆ°á»›c Ä‘o Ä‘Æ°á»£c gá»i lÃ  <strong>(bá»™ Ä‘á»‡m / bá»™ nhá»› cache)</strong> hay <strong>(buffer / cache)</strong> Ä‘á»ƒ hiá»ƒn thá»‹ táº§n suáº¥t dá»¯ liá»‡u Ä‘Æ°á»£c yÃªu cáº§u Ä‘Æ°á»£c tÃ¬m tháº¥y trong bá»™ nhá»› cache thay vÃ¬ Ä‘á»c tá»« disk.</p>
<p>LÆ°u Ã½: Tá»· lá»‡ trÃºng bá»™ nhá»› cache (cache hit ratio) kÃ©m khÃ´ng pháº£i lÃºc nÃ o cÅ©ng cÃ³ nghÄ©a lÃ  bá»™ nhá»› cache hoáº¡t Ä‘á»™ng kÃ©m.</p>
<p>Bá»™ Ä‘á»‡m chá»‰ lÃ  dung lÆ°á»£ng háº¡n cháº¿ cá»§a bá»™ nhá»›, vÃ¬ váº­y Ä‘á»ƒ táº£i dá»¯ liá»‡u má»›i khi Ä‘Ã£ Ä‘áº§y, nÃ³ cáº§n pháº£i loáº¡i bá» má»™t sá»‘ dá»¯ liá»‡u. Táº£i vÃ  xÃ³a bá»™ nhá»› cache Ä‘Ã²i há»i má»™t sá»‘ chi phÃ­ disk vÃ  network I/O. Náº¿u báº¡n cÃ³ má»™t truy váº¥n Ä‘Æ°á»£c thá»±c hiá»‡n thÆ°á»ng xuyÃªn, sau Ä‘Ã³ táº£i káº¿t quáº£ truy váº¥n má»—i láº§n vÃ  xÃ³a nÃ³, hiá»‡u quáº£ lÃ  quÃ¡ tháº¥p. CÆ¡ sá»Ÿ dá»¯ liá»‡u hiá»‡n Ä‘áº¡i giáº£i quyáº¿t váº¥n Ä‘á» nÃ y vá»›i chÃ­nh sÃ¡ch thay tháº¿ bá»™ Ä‘á»‡m.</p>
<h4>ChÃ­nh sÃ¡ch thay tháº¿ bá»™ Ä‘á»‡m</h4>
<blockquote>
<p>Háº§u háº¿t cÃ¡c cÆ¡ sá»Ÿ dá»¯ liá»‡u hiá»‡n Ä‘áº¡i (Ã­t nháº¥t lÃ  SQL Server, MySQL, Oracle vÃ  DB2) sá»­ dá»¥ng thuáº­t toÃ¡n LRU.</p>
</blockquote>
<h5>LRU</h5>
<p>LRU (Least Recently Used) : bá» Ä‘i pháº§n tá»­ Ã­t Ä‘Æ°á»£c sá»­ dá»¥ng gáº§n Ä‘Ã¢y nháº¥t. NguyÃªn táº¯c Ä‘áº±ng sau nÃ³: dá»¯ liá»‡u Ä‘Æ°á»£c giá»¯ láº¡i trong bá»™ nhá»› cache Ä‘Æ°á»£c sá»­ dá»¥ng gáº§n Ä‘Ã¢y nháº¥t, cÃ³ nhiá»u kháº£ nÄƒng sáº½ Ä‘Æ°á»£c tÃ¡i sá»­ dá»¥ng.</p>
<p>HÃ¬nh minh há»a:</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/Pasted image 20230604234649.png" alt="Pasted image 20230604234649" tabindex="0" loading="lazy"><figcaption>Pasted image 20230604234649</figcaption></figure>
<p>Äá»ƒ hiá»ƒu rÃµ hÆ¡n, tÃ´i giáº£ Ä‘á»‹nh ráº±ng dá»¯ liá»‡u trong bá»™ Ä‘á»‡m khÃ´ng bá»‹ khÃ³a bá»Ÿi chá»‘t (cÃ³ nghÄ©a lÃ  nÃ³ cÃ³ nghÄ©a lÃ  nÃ³ cÃ³ thá»ƒ Ä‘Æ°á»£c gá»¡ bá»). Trong vÃ­ dá»¥ Ä‘Æ¡n giáº£n nÃ y, bá»™ Ä‘á»‡m cÃ³ thá»ƒ lÆ°u 3 thÃ nh viÃªn:</p>
<ul>
<li>1: TrÃ¬nh quáº£n lÃ½ bá»™ nhá»› cache (CM) sá»­ dá»¥ng dá»¯ liá»‡u 1 vÃ  Ä‘áº·t nÃ³ vÃ o bá»™ Ä‘á»‡m trá»‘ng</li>
<li>2: CM sá»­ dá»¥ng dá»¯ liá»‡u 4 vÃ  Ä‘áº·t nÃ³ vÃ o bá»™ Ä‘á»‡m</li>
<li>3: CM sá»­ dá»¥ng dá»¯ liá»‡u 3 vÃ  Ä‘áº·t nÃ³ vÃ o bá»™ Ä‘á»‡m</li>
<li>4: CM sá»­ dá»¥ng dá»¯ liá»‡u 9, bá»™ Ä‘á»‡m Ä‘Ã£ Ä‘áº§y, vÃ¬ váº­y dá»¯ liá»‡u 1 Ä‘Ã£ bá»‹ xÃ³a vÃ¬ lÃ  láº§n cuá»‘i cÃ¹ng nÃ³ Ä‘Æ°á»£c sá»­ dá»¥ng gáº§n Ä‘Ã¢y lÃ  xa nháº¥t vÃ  dá»¯ liá»‡u 9 Ä‘Æ°á»£c thÃªm vÃ o bá»™ Ä‘á»‡m</li>
<li>5: CM sá»­ dá»¥ng dá»¯ liá»‡u 4, dá»¯ liá»‡u 4 Ä‘Ã£ á»Ÿ trong bá»™ Ä‘á»‡m, vÃ¬ váº­y nÃ³ má»™t láº§n ná»¯a trá»Ÿ thÃ nh pháº§n tá»­ Ä‘Æ°á»£c sá»­ dá»¥ng gáº§n Ä‘Ã¢y.</li>
<li>6: CM sá»­ dá»¥ng dá»¯ liá»‡u 1, bá»™ Ä‘á»‡m Ä‘áº§y Ä‘á»§, vÃ¬ váº­y dá»¯ liá»‡u 9 Ä‘Ã£ bá»‹ xÃ³a vÃ¬ lÃ  láº§n gáº§n Ä‘Ã¢y nháº¥t nÃ³ Ä‘Æ°á»£c sá»­ dá»¥ng lÃ  xa nháº¥t vÃ  dá»¯ liá»‡u 1 Ä‘Æ°á»£c thÃªm vÃ o bá»™ Ä‘á»‡m</li>
<li>â€¦â€¦</li>
</ul>
<p>Thuáº­t toÃ¡n nÃ y hoáº¡t Ä‘á»™ng tá»‘t, nhÆ°ng cÃ³ má»™t sá»‘ háº¡n cháº¿. <strong>Äiá»u gÃ¬ sáº½ xáº£y ra náº¿u báº¡n thá»±c hiá»‡n quÃ©t toÃ n bá»™ trÃªn má»™t báº£ng lá»›n</strong>? NÃ³i cÃ¡ch khÃ¡c, Ä‘iá»u gÃ¬ sáº½ xáº£y ra khi kÃ­ch thÆ°á»›c cá»§a báº£ng/chá»‰ má»¥c vÆ°á»£t quÃ¡ bá»™ Ä‘á»‡m? Sá»­ dá»¥ng thuáº­t toÃ¡n nÃ y sáº½ xÃ³a táº¥t cáº£ dá»¯ liá»‡u trong bá»™ nhá»› cache trÆ°á»›c Ä‘Ã³ vÃ  dá»¯ liá»‡u Ä‘Æ°á»£c quÃ©t Ä‘áº§y Ä‘á»§ cÃ³ kháº£ nÄƒng chá»‰ Ä‘Æ°á»£c sá»­ dá»¥ng má»™t láº§n.</p>
<h5>Cáº£i thiá»‡n</h5>
<p>Äá»ƒ ngÄƒn cháº·n hiá»‡n tÆ°á»£ng nÃ y, má»™t sá»‘ cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘Ã£ thÃªm cÃ¡c quy táº¯c Ä‘áº·c biá»‡t, cháº³ng háº¡n nhÆ° mÃ´ táº£ trong tÃ i liá»‡u Oracle:</p>
<blockquote>
<p>ã€ Äá»‘i vá»›i cÃ¡c báº£ng ráº¥t lá»›n, cÆ¡ sá»Ÿ dá»¯ liá»‡u thÆ°á»ng sá»­ dá»¥ng Ä‘Æ°á»ng dáº«n trá»±c tiáº¿p Ä‘á»ƒ Ä‘á»c, tá»©c lÃ  táº£i trá»±c tiáº¿p cÃ¡c khá»‘i [â€¦] Ä‘á»ƒ trÃ¡nh láº¥p Ä‘áº§y bá»™ Ä‘á»‡m. Äá»‘i vá»›i cÃ¡c báº£ng cÃ³ kÃ­ch thÆ°á»›c trung bÃ¬nh, cÆ¡ sá»Ÿ dá»¯ liá»‡u cÃ³ thá»ƒ Ä‘Æ°á»£c Ä‘á»c trá»±c tiáº¿p hoáº·c cache dá»¯ liá»‡u Ä‘Ã£ Ä‘á»c. Náº¿u báº¡n chá»n Ä‘á»c bá»™ nhá»› cache, cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘áº·t khá»‘i á»Ÿ Ä‘uÃ´i LRU Ä‘á»ƒ ngÄƒn cháº·n bá»™ Ä‘á»‡m hiá»‡n táº¡i bá»‹ xÃ³a.ã€</p>
</blockquote>
<p>NgoÃ i ra cÃ²n cÃ³ má»™t sá»‘ kháº£ nÄƒng, cháº³ng háº¡n nhÆ° sá»­ dá»¥ng phiÃªn báº£n cao cáº¥p cá»§a LRU, Ä‘Æ°á»£c gá»i lÃ  LRU-K. VÃ­ dá»¥, SQL Server sá»­ dá»¥ng LRU-2ã€‚</p>
<p>NguyÃªn táº¯c cá»§a thuáº­t toÃ¡n nÃ y lÃ  xem xÃ©t nhiá»u lá»‹ch sá»­ hÆ¡n. LRU Ä‘Æ¡n giáº£n (tá»©c lÃ  LRU-1) chá»‰ xem xÃ©t dá»¯ liá»‡u Ä‘Æ°á»£c sá»­ dá»¥ng láº§n cuá»‘i. CÃ²n LRU-K:</p>
<ul>
<li>HÃ£y xem xÃ©t dá»¯ liá»‡u Ä‘Æ°á»£c sá»­ dá»¥ng K láº§n cuá»‘i cÃ¹ng</li>
<li>Sá»‘ láº§n dá»¯ liá»‡u Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘Æ°á»£c thÃªm vÃ o trá»ng lÆ°á»£ng</li>
<li>Má»™t loáº¡t dá»¯ liá»‡u má»›i Ä‘Æ°á»£c táº£i vÃ o bá»™ nhá»› cache vÃ  dá»¯ liá»‡u cÅ© nhÆ°ng thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng sáº½ khÃ´ng bá»‹ xÃ³a (vÃ¬ trá»ng lÆ°á»£ng cao hÆ¡n)</li>
<li>Tuy nhiÃªn, thuáº­t toÃ¡n nÃ y khÃ´ng giá»¯ láº¡i dá»¯ liá»‡u khÃ´ng cÃ²n Ä‘Æ°á»£c sá»­ dá»¥ng trong bá»™ nhá»› cache</li>
<li>VÃ¬ váº­y, náº¿u dá»¯ liá»‡u khÃ´ng cÃ²n Ä‘Æ°á»£c sá»­ dá»¥ng, giÃ¡ trá»‹ trá»ng lÆ°á»£ng giáº£m theo thá»i gian</li>
</ul>
<p>TÃ­nh toÃ¡n trá»ng lÆ°á»£ng lÃ  tá»‘n kÃ©m, vÃ¬ váº­y SQL Server chá»‰ sá»­ dá»¥ng K = 2, hiá»‡u suáº¥t giÃ¡ trá»‹ tá»‘t vÃ  chi phÃ­ bá»• sung Ä‘Æ°á»£c cháº¥p nháº­n.</p>
<h5>CÃ¡c thuáº­t toÃ¡n khÃ¡c</h5>
<p>Táº¥t nhiÃªn cÃ³ cÃ¡c thuáº­t toÃ¡n khÃ¡c Ä‘á»ƒ quáº£n lÃ½ bá»™ nhá»› cache, cháº³ng háº¡n nhÆ°:</p>
<ul>
<li>2Q (giá»‘ng thuáº­t toÃ¡n LRU-K)</li>
<li>CLOCK (giá»‘ng thuáº­t toÃ¡n LRU-K)</li>
<li>MRU (thuáº­t toÃ¡n má»›i nháº¥t Ä‘Æ°á»£c sá»­ dá»¥ng, cÃ¹ng má»™t logic nhÆ°ng cÃ¡c quy táº¯c khÃ¡c nhau vá»›i LRU)</li>
<li>LRFU(Least Recently and Frequently Used)</li>
<li>â€¦â€¦</li>
</ul>
<h4>Bá»™ Ä‘á»‡m ghi (Write Buffer)</h4>
<p>TÃ´i chá»‰ tÃ¬m hiá»ƒu bá»™ nhá»› cache Ä‘á»c - táº£i trÆ°á»›c dá»¯ liá»‡u trÆ°á»›c khi sá»­ dá»¥ng. Bá»™ Ä‘á»‡m ghi Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ lÆ°u dá»¯ liá»‡u, ghi hÃ ng loáº¡t vÃ o disk, thay vÃ¬ ghi dá»¯ liá»‡u tá»«ng cÃ¡i má»™t, dáº«n Ä‘áº¿n nhiá»u truy cáº­p disk duy nháº¥t.</p>
<p>HÃ£y nhá»› ráº±ng <strong>bá»™ Ä‘á»‡m lÆ°u cÃ¡c trang (Ä‘Æ¡n vá»‹ dá»¯ liá»‡u nhá» nháº¥t) chá»© khÃ´ng pháº£i lÃ  hÃ ng (row) (Ä‘Æ¡n vá»‹ logic mÃ  ngÆ°á»i nhÃ¬n vÃ o dá»¯ liá»‡u).</strong> Náº¿u cÃ¡c trang trong vÃ¹ng Ä‘á»‡m Ä‘Æ°á»£c sá»­a Ä‘á»•i nhÆ°ng chÆ°a Ä‘Æ°á»£c ghi vÃ o disk, Ä‘Ã³ lÃ  má»™t trang báº©n. CÃ³ ráº¥t nhiá»u thuáº­t toÃ¡n Ä‘á»ƒ quyáº¿t Ä‘á»‹nh thá»i Ä‘iá»ƒm tá»‘t nháº¥t Ä‘á»ƒ ghi cÃ¡c trang báº©n, nhÆ°ng váº¥n Ä‘á» nÃ y cÃ³ liÃªn quan cao Ä‘áº¿n khÃ¡i niá»‡m giao dá»‹ch (transaction), vÃ  bÃ¢y giá» chÃºng ta sáº½ nÃ³i vá» cÃ¡c giao dá»‹ch (transaction).</p>
<h3>TrÃ¬nh quáº£n lÃ½ giao dá»‹ch (Transaction Manager)</h3>
<blockquote>
<p>Cuá»‘i cÃ¹ng nhÆ°ng khÃ´ng kÃ©m pháº§n quan trá»ng, lÃ  trÃ¬nh quáº£n lÃ½ giao dá»‹ch, vÃ  chÃºng ta sáº½ tháº¥y quÃ¡ trÃ¬nh nÃ y Ä‘áº£m báº£o ráº±ng má»—i truy váº¥n Ä‘Æ°á»£c thá»±c hiá»‡n trong giao dá»‹ch cá»§a riÃªng nÃ³. NhÆ°ng trÆ°á»›c khi chÃºng ta báº¯t Ä‘áº§u, chÃºng ta cáº§n pháº£i hiá»ƒu khÃ¡i niá»‡m vá» cÃ¡c giao dá»‹ch ACID.</p>
</blockquote>
<p>â€œIâ€™m on acidâ€</p>
<p>Má»™t giao dá»‹ch ACID lÃ  má»™t Ä‘Æ¡n vá»‹ lÃ m viá»‡c Ä‘áº£m báº£o bá»‘n tÃ­nh cháº¥t:</p>
<ul>
<li>NguyÃªn tá»­ (Atomicity): Giao dá»‹ch Ä‘Æ°á»£c thá»±c hiá»‡n Ä‘áº§y Ä‘á»§ hoáº·c há»§y bá» hoÃ n toÃ n, ngay cáº£ khi nÃ³ cháº¡y liÃªn tá»¥c trong 10 giá». Náº¿u giao dá»‹ch sá»¥p Ä‘á»•, tráº¡ng thÃ¡i trá»Ÿ láº¡i trÆ°á»›c khi giao dá»‹ch (transaction rollback).</li>
<li>TÃ­nh nháº¥t quÃ¡n (Consistency): Chá»‰ dá»¯ liá»‡u há»£p phÃ¡p (tÃ¹y thuá»™c vÃ o cÃ¡c rÃ ng buá»™c quan há»‡ vÃ  chá»©c nÄƒng) má»›i cÃ³ thá»ƒ Ä‘Æ°á»£c ghi vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u vÃ  tÃ­nh nháº¥t quÃ¡n cÃ³ liÃªn quan Ä‘áº¿n nguyÃªn tá»­ vÃ  cÃ¡ch ly.</li>
<li>Äá»™c láº­p (Isolation): Náº¿u 2 giao dá»‹ch A vÃ  B cháº¡y cÃ¹ng má»™t lÃºc, káº¿t quáº£ cuá»‘i cÃ¹ng cá»§a giao dá»‹ch A vÃ  B lÃ  nhÆ° nhau, cho dÃ¹ A káº¿t thÃºc trÆ°á»›c/sau/trong khi B cháº¡y.</li>
<li>Bá»n vá»¯ng (Durability): Má»™t khi giao dá»‹ch Ä‘Æ°á»£c cam káº¿t (cÃ³ nghÄ©a lÃ  thá»±c hiá»‡n thÃ nh cÃ´ng), báº¥t cá»© Ä‘iá»u gÃ¬ xáº£y ra (sá»± cá»‘ hoáº·c lá»—i), dá»¯ liá»‡u Ä‘Æ°á»£c lÆ°u trá»¯ trong cÆ¡ sá»Ÿ dá»¯ liá»‡u.</li>
</ul>
<p>Trong cÃ¹ng má»™t giao dá»‹ch, báº¡n cÃ³ thá»ƒ cháº¡y nhiá»u truy váº¥n SQL Ä‘á»ƒ Ä‘á»c, táº¡o, cáº­p nháº­t vÃ  xÃ³a dá»¯ liá»‡u. Khi hai giao dá»‹ch sá»­ dá»¥ng cÃ¹ng má»™t dá»¯ liá»‡u, ráº¯c rá»‘i Ä‘áº¿n. VÃ­ dá»¥ Ä‘iá»ƒn hÃ¬nh lÃ  chuyá»ƒn tiá»n tá»« tÃ i khoáº£n A Ä‘áº¿n tÃ i khoáº£n B. Giáº£ sá»­ cÃ³ 2 giao dá»‹ch:</p>
<ul>
<li>Giao dá»‹ch 1 (T1) rÃºt $100 tá»« tÃ i khoáº£n A vÃ o tÃ i khoáº£n B</li>
<li>Giao dá»‹ch 2 (T2) rÃºt $ 50 tá»« tÃ i khoáº£n A cho tÃ i khoáº£n B</li>
</ul>
<p>HÃ£y trá»Ÿ láº¡i Ä‘á»ƒ xem cÃ¡c thuá»™c tÃ­nh ACID:</p>
<ul>
<li>Atomicity Ä‘áº£m báº£o ráº±ng báº¥t cá»© Ä‘iá»u gÃ¬ xáº£y ra trong T1 (sá»± cá»‘ mÃ¡y chá»§, giÃ¡n Ä‘oáº¡n máº¡ng â€¦ ), khÃ´ng thá»ƒ xuáº¥t hiá»‡n hiá»‡n tÆ°á»£ng tÃ i khoáº£n A Ä‘Ã£ bá»‹ rÃºt 100$ nhÆ°ng khÃ´ng gá»­i cho tÃ i khoáº£n B (Ä‘Ã¢y lÃ  tráº¡ng thÃ¡i khÃ´ng nháº¥t quÃ¡n cá»§a dá»¯ liá»‡u).</li>
<li>Isolation Ä‘áº£m báº£o ráº±ng náº¿u T1 vÃ  T2 xáº£y ra cÃ¹ng má»™t lÃºc, cuá»‘i cÃ¹ng A sáº½ giáº£m $ 150 vÃ  B sáº½ nháº­n Ä‘Æ°á»£c $150 thay vÃ¬ cÃ¡c káº¿t quáº£ khÃ¡c, cháº³ng háº¡n nhÆ° vÃ¬ pháº§n T2 xÃ³a hÃ nh vi cá»§a T1, A giáº£m $150 vÃ  B chá»‰ nháº­n Ä‘Æ°á»£c $50 (Ä‘Ã¢y cÅ©ng lÃ  tráº¡ng thÃ¡i khÃ´ng nháº¥t quÃ¡n).</li>
<li>Durability Ä‘áº£m báº£o ráº±ng náº¿u T1 vá»«a Ä‘Æ°á»£c cam káº¿t, cÆ¡ sá»Ÿ dá»¯ liá»‡u sá»¥p Ä‘á»• vÃ  T1 sáº½ khÃ´ng biáº¿n máº¥t mÃ  khÃ´ng cÃ³ dáº¥u váº¿t.</li>
<li>Consistency Ä‘áº£m báº£o ráº±ng tiá»n khÃ´ng Ä‘Æ°á»£c táº¡o ra hoáº·c máº¥t mÃ¡t trong há»‡ thá»‘ng.</li>
</ul>
<h3>Kiá»ƒm soÃ¡t Ä‘á»“ng thá»i (Concurrency Control)</h3>
<p>Váº¥n Ä‘á» thá»±c sá»± vá»›i viá»‡c Ä‘áº£m báº£o isolation, consistency, and atomicity lÃ  <strong>write operation (add, update, delete) Ä‘á»‘i vá»›i cÃ¹ng má»™t dá»¯ liá»‡u</strong>:</p>
<ul>
<li>Náº¿u táº¥t cáº£ cÃ¡c giao dá»‹ch chá»‰ Ä‘á»c dá»¯ liá»‡u, chÃºng cÃ³ thá»ƒ hoáº¡t Ä‘á»™ng cÃ¹ng má»™t lÃºc vÃ  khÃ´ng thay Ä‘á»•i hÃ nh vi cá»§a má»™t giao dá»‹ch khÃ¡c.</li>
<li>Náº¿u (Ã­t nháº¥t) cÃ³ má»™t giao dá»‹ch sá»­a Ä‘á»•i dá»¯ liá»‡u Ä‘Æ°á»£c Ä‘á»c bá»Ÿi cÃ¡c giao dá»‹ch khÃ¡c, cÆ¡ sá»Ÿ dá»¯ liá»‡u cáº§n pháº£i tÃ¬m má»™t cÃ¡ch Ä‘á»ƒ áº©n nhá»¯ng thay Ä‘á»•i nhÆ° váº­y cho cÃ¡c giao dá»‹ch khÃ¡c. NgoÃ i ra, nÃ³ cÅ©ng cáº§n pháº£i Ä‘áº£m báº£o ráº±ng sá»­a Ä‘á»•i nÃ y sáº½ khÃ´ng bá»‹ xÃ³a bá»Ÿi má»™t giao dá»‹ch khÃ¡c mÃ  báº¡n khÃ´ng tháº¥y dá»¯ liá»‡u nÃ y sá»­a Ä‘á»•i.</li>
</ul>
<p>Váº¥n Ä‘á» nÃ y Ä‘Æ°á»£c gá»i lÃ  <strong>kiá»ƒm soÃ¡t Ä‘á»“ng thá»i (concurency control)</strong>.</p>
<p>Giáº£i phÃ¡p Ä‘Æ¡n giáº£n nháº¥t lÃ  thá»±c hiá»‡n láº§n lÆ°á»£t tá»«ng giao dá»‹ch (tá»©c lÃ  thá»±c hiá»‡n theo thá»© tá»±), nhÆ°ng Ä‘iá»u nÃ y hoÃ n toÃ n khÃ´ng cÃ³ kháº£ nÄƒng má»Ÿ rá»™ng, chá»‰ cÃ³ má»™t nhÃ¢n hoáº¡t Ä‘á»™ng trÃªn má»™t mÃ¡y chá»§ Ä‘a nhÃ¢n / Ä‘a luá»“ng vÃ  khÃ´ng hiá»‡u quáº£.</p>
<ul>
<li>LÃ½ tÆ°á»Ÿng nháº¥t lÃ  má»—i khi má»™t giao dá»‹ch Ä‘Æ°á»£c táº¡o hoáº·c há»§y bá»:</li>
<li>GiÃ¡m sÃ¡t táº¥t cáº£ cÃ¡c hoáº¡t Ä‘á»™ng cá»§a táº¥t cáº£ cÃ¡c giao dá»‹ch</li>
<li>Kiá»ƒm tra xem cÃ¡c pháº§n cá»§a 2 (hoáº·c nhiá»u) giao dá»‹ch xung Ä‘á»™t do Ä‘á»c/sá»­a cÃ¹ng má»™t dá»¯ liá»‡u hay khÃ´ng?</li>
<li>Sáº¯p xáº¿p láº¡i cÃ¡c hoáº¡t Ä‘á»™ng trong cÃ¡c giao dá»‹ch xung Ä‘á»™t Ä‘á»ƒ giáº£m cÃ¡c pháº§n xung Ä‘á»™t</li>
<li>Thá»±c hiá»‡n cÃ¡c pháº§n xung Ä‘á»™t theo má»™t thá»© tá»± nháº¥t Ä‘á»‹nh (trong khi cÃ¡c giao dá»‹ch khÃ´ng xung Ä‘á»™t váº«n Ä‘ang cháº¡y Ä‘á»“ng thá»i)</li>
<li>Xem xÃ©t ráº±ng giao dá»‹ch cÃ³ thá»ƒ bá»‹ há»§y bá»</li>
</ul>
<p>Theo cÃ¡ch nÃ³i chÃ­nh thá»©c hÆ¡n, Ä‘Ã¢y lÃ  má»™t váº¥n Ä‘á» láº­p lá»‹ch cho xung Ä‘á»™t. Cá»¥ thá»ƒ hÆ¡n, Ä‘Ã¢y lÃ  má»™t váº¥n Ä‘á» tá»‘i Æ°u hÃ³a ráº¥t khÃ³ khÄƒn vÃ  chi phÃ­ CPU ráº¥t lá»›n. CÆ¡ sá»Ÿ dá»¯ liá»‡u cáº¥p doanh nghiá»‡p khÃ´ng thá»ƒ chá»‹u Ä‘á»±ng Ä‘Æ°á»£c viá»‡c chá» Ä‘á»£i hÃ ng giá» Ä‘á»ƒ tÃ¬m lá»‹ch trÃ¬nh tá»‘t nháº¥t cho má»—i hoáº¡t Ä‘á»™ng giao dá»‹ch má»›i, vÃ¬ váº­y hÃ£y sá»­ dá»¥ng má»™t cÃ¡ch Ã­t lÃ½ tÆ°á»Ÿng hÆ¡n Ä‘á»ƒ trÃ¡nh lÃ£ng phÃ­ nhiá»u thá»i gian hÆ¡n Ä‘á»ƒ giáº£i quyáº¿t xung Ä‘á»™t.</p>
<h3>TrÃ¬nh quáº£n lÃ½ khÃ³a (Lock Manager)</h3>
<blockquote>
<p>Äá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y, háº§u háº¿t cÃ¡c cÆ¡ sá»Ÿ dá»¯ liá»‡u sá»­ dá»¥ng <strong>khÃ³a</strong> vÃ  / hoáº·c <strong>kiá»ƒm soÃ¡t phiÃªn báº£n dá»¯ liá»‡u</strong>. ÄÃ¢y lÃ  má»™t chá»§ Ä‘á» lá»›n, tÃ´i sáº½ táº­p trung vÃ o khÃ³a, vÃ  má»™t chÃºt kiá»ƒm soÃ¡t phiÃªn báº£n dá»¯ liá»‡u.</p>
</blockquote>
<h4>KhÃ³a bi quan (pessimistic lock)</h4>
<p>NguyÃªn táº¯c lÃ :</p>
<ul>
<li>Náº¿u má»™t giao dá»‹ch yÃªu cáº§u má»™t dá»¯ liá»‡u, nÃ³ khÃ³a dá»¯ liá»‡u</li>
<li>Náº¿u má»™t giao dá»‹ch khÃ¡c cÅ©ng cáº§n dá»¯ liá»‡u nÃ y, nÃ³ pháº£i chá» giao dá»‹ch Ä‘áº§u tiÃªn tá»« bá» dá»¯ liá»‡u Ä‘Ã³</li>
</ul>
<p>á»” khÃ³a nÃ y gá»i lÃ  <strong>khÃ³a Ä‘á»™c quyá»n</strong>.</p>
<p>NhÆ°ng viá»‡c sá»­ dá»¥ng khÃ³a Ä‘á»™c quyá»n cho má»™t giao dá»‹ch chá»‰ Ä‘á»c dá»¯ liá»‡u lÃ  tá»‘n kÃ©m, bá»Ÿi vÃ¬ nÃ³ sáº½ buá»™c cÃ¡c giao dá»‹ch khÃ¡c chá»‰ cáº§n Ä‘á»c cÃ¹ng má»™t dá»¯ liá»‡u chá» Ä‘á»£i. VÃ¬ váº­y, cÃ³ má»™t loáº¡i khÃ³a khÃ¡c, <strong>khÃ³a chia sáº» (shared lock)</strong>.</p>
<p><strong>KhÃ³a chia sáº» trÃ´ng nhÆ° tháº¿ nÃ y</strong>:</p>
<ul>
<li>Náº¿u má»™t giao dá»‹ch chá»‰ cáº§n Ä‘á»c dá»¯ liá»‡u A, nÃ³ sáº½ thÃªm "khÃ³a chia sáº»" vÃ o dá»¯ liá»‡u A vÃ  Ä‘á»c</li>
<li>Náº¿u giao dá»‹ch thá»© hai cÅ©ng cáº§n chá»‰ Ä‘á»c dá»¯ liá»‡u A, nÃ³ sáº½ thÃªm "khÃ³a chia sáº»" dá»¯ liá»‡u A vÃ  Ä‘á»c</li>
<li>Náº¿u giao dá»‹ch thá»© ba cáº§n pháº£i sá»­a Ä‘á»•i dá»¯ liá»‡u A, nÃ³ sáº½ thÃªm "khÃ³a Ä‘á»™c quyá»n" vÃ o dá»¯ liá»‡u A, nhÆ°ng pháº£i chá» Ä‘á»£i cho hai giao dá»‹ch khÃ¡c tá»« bá» khÃ³a chia sáº» cá»§a há».</li>
</ul>
<p>TÆ°Æ¡ng tá»± nhÆ° váº­y, náº¿u khÃ³a Ä‘á»™c quyá»n Ä‘Æ°á»£c thÃªm má»™t khá»‘i dá»¯ liá»‡u, má»™t giao dá»‹ch mÃ  chá»‰ cáº§n Ä‘á»c dá»¯ liá»‡u Ä‘Ã³ thÃ¬ pháº£i chá» khÃ³a Ä‘á»™c quyá»n tá»« bá» trÆ°á»›c khi thÃªm khÃ³a chia sáº» cho dá»¯ liá»‡u Ä‘Ã³.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/Pasted image 20230605010909.png" alt="Pasted image 20230605010909" tabindex="0" loading="lazy"><figcaption>Pasted image 20230605010909</figcaption></figure>
<p>TrÃ¬nh quáº£n lÃ½ khÃ³a lÃ  quÃ¡ trÃ¬nh thÃªm vÃ  giáº£i phÃ³ng khÃ³a, lÆ°u thÃ´ng tin khÃ³a trong ná»™i bá»™ vá»›i má»™t báº£ng bÄƒm (vá»›i key lÃ  dá»¯ liá»‡u bá»‹ khÃ³a) vÃ  hiá»ƒu ráº±ng má»—i khá»‘i dá»¯ liá»‡u lÃ :</p>
<ul>
<li>Bá»‹ khÃ³a bá»Ÿi giao dá»‹ch nÃ o</li>
<li>Giao dá»‹ch nÃ o Ä‘ang chá» dá»¯ liá»‡u Ä‘Æ°á»£c má»Ÿ khÃ³a</li>
</ul>
<h4>Báº¿ táº¯c (Deadlock)</h4>
<p>NhÆ°ng sá»­ dá»¥ng khÃ³a cÃ³ thá»ƒ dáº«n Ä‘áº¿n má»™t tÃ¬nh huá»‘ng mÃ  2 giao dá»‹ch luÃ´n chá» Ä‘á»£i má»™t máº£nh dá»¯ liá»‡u:</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/Pasted image 20230605011404.png" alt="Pasted image 20230605011404" tabindex="0" loading="lazy"><figcaption>Pasted image 20230605011404</figcaption></figure>
<p>Trong hÃ¬nh nÃ y:</p>
<ul>
<li>Giao dá»‹ch A thÃªm khÃ³a Ä‘á»™c quyá»n vÃ o dá»¯ liá»‡u 1 vÃ  chá» Ä‘á»£i Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c dá»¯ liá»‡u 2</li>
<li>Giao dá»‹ch B thÃªm khÃ³a Ä‘á»™c quyá»n cho dá»¯ liá»‡u 2 vÃ  chá» Ä‘á»£i Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c dá»¯ liá»‡u 1</li>
</ul>
<p>NÃ³ Ä‘Æ°á»£c gá»i lÃ  <strong>báº¿ táº¯c (deadlock)</strong>.</p>
<p>Khi báº¿ táº¯c xáº£y ra, trÃ¬nh quáº£n lÃ½ khÃ³a sáº½ chá»n há»§y bá» (rollback) má»™t giao dá»‹ch Ä‘á»ƒ loáº¡i bá» báº¿ táº¯c. ÄÃ¢y lÃ  má»™t quyáº¿t Ä‘á»‹nh khÃ³ khÄƒn:</p>
<ul>
<li>Huá»· cÃ¡c giao dá»‹ch cÃ³ Ã­t sá»­a Ä‘á»•i dá»¯ liá»‡u nháº¥t (Ä‘iá»u nÃ y lÃ m giáº£m chi phÃ­ rollback)?</li>
<li>Huá»· cÃ¡c giao dá»‹ch cÃ³ thá»i gian ngáº¯n nháº¥t vÃ¬ ngÆ°á»i dÃ¹ng cá»§a cÃ¡c giao dá»‹ch khÃ¡c chá» Ä‘á»£i lÃ¢u hÆ¡n?</li>
<li>Huá»· cÃ¡c giao dá»‹ch tá»‘n Ã­t thá»i gian Ä‘á»ƒ káº¿t thÃºc hÆ¡n(trÃ¡nh Ä‘Ã³i tÃ i nguyÃªn)?</li>
<li>Má»™t khi rollback xáº£y ra, cÃ³ bao nhiÃªu giao dá»‹ch sáº½ bá»‹ áº£nh hÆ°á»Ÿng bá»Ÿi rollback?</li>
</ul>
<p>TrÆ°á»›c khi thá»±c hiá»‡n lá»±a chá»n, trÃ¬nh quáº£n lÃ½ khÃ³a cáº§n kiá»ƒm tra xem cÃ³ báº¿ táº¯c hay khÃ´ng.</p>
<p>Báº£ng bÄƒm cÃ³ thá»ƒ Ä‘Æ°á»£c coi lÃ  má»™t Ä‘á»“ thá»‹ (xem Ä‘á»“ thá»‹ á»Ÿ trÃªn), trong Ä‘Ã³ náº¿u chu trÃ¬nh xuáº¥t hiá»‡n cho tháº¥y báº¿ táº¯c. VÃ¬ vÃ²ng láº·p kiá»ƒm tra lÃ  tá»‘n kÃ©m (Ä‘á»“ thá»‹ bao gá»“m táº¥t cáº£ cÃ¡c á»• khÃ³a lÃ  ráº¥t lá»›n), nÃ³ thÆ°á»ng Ä‘Æ°á»£c giáº£i quyáº¿t theo nhá»¯ng cÃ¡ch Ä‘Æ¡n giáº£n: <strong>sá»­ dá»¥ng thá»i gian chá» (timeout)</strong>. Náº¿u má»™t khÃ³a khÃ´ng Ä‘Æ°á»£c thÃªm vÃ o trong thá»i gian chá», sau Ä‘Ã³ giao dá»‹ch sáº½ Ä‘i vÃ o tráº¡ng thÃ¡i báº¿ táº¯c.</p>
<p>TrÃ¬nh quáº£n lÃ½ khÃ³a cÅ©ng cÃ³ thá»ƒ kiá»ƒm tra xem khÃ³a cÃ³ trá»Ÿ thÃ nh báº¿ táº¯c hay khÃ´ng trÆ°á»›c khi thÃªm khÃ³a Ä‘Ã³, nhÆ°ng nÃ³ váº«n tá»‘n kÃ©m Ä‘á»ƒ lÃ m Ä‘iá»u Ä‘Ã³ má»™t cÃ¡ch hoÃ n háº£o. Do Ä‘Ã³, cÃ¡c tiá»n kiá»ƒm thá»­ (preflight) nÃ y thÆ°á»ng thiáº¿t láº­p má»™t sá»‘ quy táº¯c cÆ¡ báº£n.</p>
<h4>Two-Phase Locking Protocol</h4>
<blockquote>
<p>CÃ¡ch dá»… nháº¥t Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c sá»± Ä‘á»™c láº­p thuáº§n tÃºy lÃ  Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c má»™t khÃ³a khi báº¯t Ä‘áº§u giao dá»‹ch vÃ  giáº£i phÃ³ng nÃ³ khi káº¿t thÃºc. Äiá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ , trÆ°á»›c khi giao dá»‹ch báº¯t Ä‘áº§u, báº¡n pháº£i chá» Ä‘á»£i Ä‘á»ƒ Ä‘áº£m báº£o ráº±ng báº¡n cÃ³ thá»ƒ thÃªm táº¥t cáº£ cÃ¡c khÃ³a vÃ  giáº£i phÃ³ng khÃ³a mÃ  báº¡n giá»¯ khi giao dá»‹ch káº¿t thÃºc. Äiá»u nÃ y lÃ  ok, nhÆ°ng ráº¥t nhiá»u thá»i gian Ä‘Ã£ bá»‹ lÃ£ng phÃ­ Ä‘á»ƒ chá» Ä‘á»£i cho táº¥t cáº£ cÃ¡c á»• khÃ³a.</p>
</blockquote>
<p>CÃ¡ch nhanh hÆ¡n lÃ  <strong>giao thá»©c khÃ³a hai giai Ä‘oáº¡n</strong> (Two-Phase Locking Protocol, Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi DB2 vÃ  SQL Server), nÆ¡i cÃ¡c giao dá»‹ch Ä‘Æ°á»£c chia thÃ nh hai giai Ä‘oáº¡n:</p>
<ul>
<li><strong>Giai Ä‘oáº¡n tÄƒng trÆ°á»Ÿng</strong>: Giao dá»‹ch cÃ³ thá»ƒ nháº­n Ä‘Æ°á»£c khÃ³a, nhÆ°ng khÃ´ng thá»ƒ giáº£i phÃ³ng khÃ³a.</li>
<li><strong>Giai Ä‘oáº¡n thu háº¹p</strong>: Giao dá»‹ch cÃ³ thá»ƒ giáº£i phÃ³ng khÃ³a (Ä‘á»‘i vá»›i dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c xá»­ lÃ½ vÃ  khÃ´ng Ä‘Æ°á»£c xá»­ lÃ½ láº¡i), nhÆ°ng khÃ´ng thá»ƒ cÃ³ Ä‘Æ°á»£c khÃ³a má»›i.</li>
</ul>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/Pasted image 20230605013007.png" alt="Pasted image 20230605013007" tabindex="0" loading="lazy"><figcaption>Pasted image 20230605013007</figcaption></figure>
<p>QuÃ¡ trÃ¬nh Ä‘áº±ng sau hai quy táº¯c Ä‘Æ¡n giáº£n nÃ y lÃ :</p>
<ul>
<li>Giáº£i phÃ³ng khÃ³a khÃ´ng cÃ²n Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ giáº£m thá»i gian chá» Ä‘á»£i cho cÃ¡c giao dá»‹ch khÃ¡c</li>
<li>NgÄƒn cháº·n tÃ¬nh huá»‘ng sau xáº£y ra: dá»¯ liá»‡u thu Ä‘Æ°á»£c ban Ä‘áº§u tá»« giao dá»‹ch, Ä‘Æ°á»£c sá»­a Ä‘á»•i sau khi giao dá»‹ch báº¯t Ä‘áº§u, vÃ  sá»± khÃ´ng nháº¥t quÃ¡n xáº£y ra khi giao dá»‹ch Ä‘á»c láº¡i dá»¯ liá»‡u.</li>
</ul>
<p>Quy táº¯c nÃ y hoáº¡t Ä‘á»™ng tá»‘t, vá»›i má»™t ngoáº¡i lá»‡: náº¿u má»™t máº£nh dá»¯ liá»‡u bá»‹ sá»­a Ä‘á»•i, cÃ¡c khÃ³a liÃªn quan bá»‹ giáº£i phÃ³ng, giao dá»‹ch bá»‹ há»§y bá» (rollback), trong khi giao dá»‹ch khÃ¡c Ä‘á»c giÃ¡ trá»‹ Ä‘Ã£ bá»‹ sá»­a Ä‘á»•i, nhÆ°ng giÃ¡ trá»‹ cuá»‘i cÃ¹ng nÃ y Ä‘Ã£ Ä‘Æ°á»£c rollback. Äá»ƒ trÃ¡nh váº¥n Ä‘á» nÃ y, <strong>táº¥t cáº£ cÃ¡c khÃ³a Ä‘á»™c quyá»n pháº£i Ä‘Æ°á»£c giáº£i phÃ³ng vÃ o cuá»‘i giao dá»‹ch</strong>.</p>
<h4>Nhiá»u hÆ¡n ná»¯a</h4>
<blockquote>
<p>Táº¥t nhiÃªn, cÆ¡ sá»Ÿ dá»¯ liá»‡u thá»±c táº¿ sá»­ dá»¥ng cÃ¡c há»‡ thá»‘ng phá»©c táº¡p hÆ¡n liÃªn quan Ä‘áº¿n nhiá»u loáº¡i khÃ³a hÆ¡n (vÃ­ dá»¥: khÃ³a Ã½ Ä‘á»‹nh, intention lock) vÃ  nhiá»u chi tiáº¿t hÆ¡n (krow-level lock, page-level lock, partition lock, table lock, table space lock), nhÆ°ng Ã½ tÆ°á»Ÿng lÃ  nhÆ° nhau.</p>
</blockquote>
<p>TÃ´i chá»‰ tÃ¬m hiá»ƒu cÃ¡c phÆ°Æ¡ng phÃ¡p hoÃ n toÃ n dá»±a trÃªn khÃ³a vÃ  <strong>kiá»ƒm soÃ¡t phiÃªn báº£n dá»¯ liá»‡u lÃ  má»™t cÃ¡ch khÃ¡c Ä‘á»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y</strong>.</p>
<p>Kiá»ƒm soÃ¡t phiÃªn báº£n (version control) trÃ´ng nhÆ° tháº¿ nÃ y:</p>
<ul>
<li>Má»—i giao dá»‹ch cÃ³ thá»ƒ sá»­a Ä‘á»•i cÃ¹ng má»™t dá»¯ liá»‡u táº¡i cÃ¹ng má»™t thá»i Ä‘iá»ƒm</li>
<li>Má»—i giao dá»‹ch cÃ³ báº£n sao riÃªng (hoáº·c phiÃªn báº£n) cá»§a dá»¯ liá»‡u</li>
<li>Náº¿u 2 giao dá»‹ch sá»­a Ä‘á»•i cÃ¹ng má»™t dá»¯ liá»‡u, chá»‰ cháº¥p nháº­n má»™t sá»­a Ä‘á»•i, cÃ²n láº¡i sáº½ bá»‹ tá»« chá»‘i vÃ  cÃ¡c giao dá»‹ch liÃªn quan rollback (hoáº·c cháº¡y láº¡i)</li>
</ul>
<p>Äiá»u nÃ y sáº½ cáº£i thiá»‡n hiá»‡u suáº¥t vÃ¬:</p>
<ul>
<li>Giao dá»‹ch Ä‘á»c khÃ´ng cháº·n giao dá»‹ch viáº¿t</li>
<li>Giao dá»‹ch viáº¿t khÃ´ng cháº·n Ä‘á»c</li>
<li>KhÃ´ng cÃ³ chi phÃ­ bá»• sung cho trÃ¬nh quáº£n lÃ½ khÃ³a "cá»“ng ká»nh vÃ  cháº­m"</li>
</ul>
<p>Ngoáº¡i trá»« khi hai giao dá»‹ch viáº¿t cÃ¹ng má»™t dá»¯ liá»‡u, kiá»ƒm soÃ¡t phiÃªn báº£n dá»¯ liá»‡u hoáº¡t Ä‘á»™ng tá»‘t hÆ¡n so vá»›i khÃ³a trong táº¥t cáº£ cÃ¡c khÃ­a cáº¡nh. Chá»‰ cÃ³ Ä‘iá»u, báº¡n sáº½ sá»›m phÃ¡t hiá»‡n ra ráº±ng sá»± tiÃªu thá»¥ khÃ´ng gian disk lÃ  ráº¥t lá»›n.</p>
<p><strong>Kiá»ƒm soÃ¡t phiÃªn báº£n dá»¯ liá»‡u vÃ  cÆ¡ cháº¿ khÃ³a lÃ  hai hiá»ƒu biáº¿t khÃ¡c nhau</strong>: khÃ³a láº¡c quan vÃ  khÃ³a bi quan. Cáº£ hai Ä‘á»u cÃ³ Æ°u vÃ  nhÆ°á»£c Ä‘iá»ƒm, hoÃ n toÃ n phá»¥ thuá»™c vÃ o viá»‡c ká»‹ch báº£n sá»­ dá»¥ng (Ä‘á»c nhiá»u hÆ¡n hoáº·c viáº¿t nhiá»u hÆ¡n).</p>
<blockquote>
<p>Má»™t sá»‘ cÆ¡ sá»Ÿ dá»¯ liá»‡u, cháº³ng háº¡n nhÆ° DB2 (cho Ä‘áº¿n phiÃªn báº£n 9.7) vÃ  SQL Server (khÃ´ng cÃ³ isolation snapshot), chá»‰ sá»­ dá»¥ng cÆ¡ cháº¿ khÃ³a. Nhá»¯ng cÆ¡ sá»Ÿ dá»¯ liá»‡u khÃ¡c nhÆ° PostgreSQL, MySQL vÃ  Oracle sá»­ dá»¥ng cÆ¡ cháº¿ káº¿t há»£p khÃ³a vÃ  phiÃªn báº£n chuá»™t.</p>
</blockquote>
<h3>TrÃ¬nh quáº£n lÃ½ nháº­t kÃ½ (Log Manager)</h3>
<p>NhÆ° chÃºng ta Ä‘Ã£ biáº¿t, Ä‘á»ƒ cáº£i thiá»‡n hiá»‡u suáº¥t, cÆ¡ sá»Ÿ dá»¯ liá»‡u lÆ°u dá»¯ liá»‡u trong bá»™ Ä‘á»‡m bá»™ nhá»›. NhÆ°ng náº¿u mÃ¡y chá»§ sá»¥p Ä‘á»• khi giao dá»‹ch Ä‘Æ°á»£c cam káº¿t, dá»¯ liá»‡u váº«n cÃ²n trong bá»™ nhá»› bá»‹ máº¥t, lÃ m suy yáº¿u tÃ­nh bá»n vá»¯ng (durability) cá»§a giao dá»‹ch. Báº¡n cÃ³ thá»ƒ ghi táº¥t cáº£ dá»¯ liá»‡u trÃªn disk, nhÆ°ng náº¿u mÃ¡y chá»§ sá»¥p Ä‘á»•, dá»¯ liá»‡u cuá»‘i cÃ¹ng cÃ³ thá»ƒ chá»‰ Ä‘Æ°á»£c ghi má»™t pháº§n vÃ o disk, lÃ m há»ng tÃ­nh nguyÃªn tá»­ (atomicity) cá»§a giao dá»‹ch.</p>
<p><strong>Báº¥t ká»³ sá»­a Ä‘á»•i nÃ o Ä‘Æ°á»£c thá»±c hiá»‡n bá»Ÿi giao dá»‹ch pháº£i bá»‹ há»§y bá» hoáº·c hoÃ n thÃ nh</strong>.</p>
<p>CÃ³ 2 cÃ¡ch Ä‘á»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y:</p>
<ul>
<li>
<p><strong>Báº£n sao/Trang bÃ³ng (Shadow copies/pages)</strong>: &nbsp;Má»—i giao dá»‹ch táº¡o ra má»™t báº£n sao cá»§a cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a riÃªng nÃ³ (hoáº·c má»™t pháº§n cá»§a cÆ¡ sá»Ÿ dá»¯ liá»‡u), vÃ  lÃ m viá»‡c trÃªn báº£n sao nÃ y. Khi xáº£y ra lá»—i, báº£n sao nÃ y sáº½ Ä‘Æ°á»£c loáº¡i bá»; khi thÃ nh cÃ´ng, cÆ¡ sá»Ÿ dá»¯ liá»‡u ngay láº­p tá»©c sá»­ dá»¥ng má»™t thá»§ thuáº­t tá»« há»‡ thá»‘ng tá»‡p tin Ä‘á»ƒ thay tháº¿ báº£n sao vÃ o trong dá»¯ liá»‡u, sau Ä‘Ã³ xÃ³a Ä‘i cÃ¡c "dá»¯ liá»‡u cÅ©".</p>
</li>
<li>
<p><strong>Nháº­t kÃ½ giao dá»‹ch (Transaction log)</strong>: Nháº­t kÃ½ giao dá»‹ch lÃ  má»™t khÃ´ng gian lÆ°u trá»¯, trÆ°á»›c khi ghi vÃ o Ä‘Ä©a má»—i láº§n, cÆ¡ sá»Ÿ dá»¯ liá»‡u sáº½ viáº¿t thÃ´ng tin vÃ o nháº­t kÃ½ giao dá»‹ch. Äiá»u nÃ y giÃºp cÆ¡ sá»Ÿ dá»¯ liá»‡u biáº¿t cÃ¡ch loáº¡i bá» hoáº·c hoÃ n thÃ nh cÃ¡c giao dá»‹ch chÆ°a hoÃ n thÃ nh khi xáº£y ra sá»± cá»‘ hoáº·c rollback cá»§a giao dá»‹ch.</p>
</li>
</ul>
<h4>WAL (Write-Ahead Logging)</h4>
<blockquote>
<p>Shadow copies/pages táº¡o ra ráº¥t nhiá»u chi phÃ­ disk khi cháº¡y má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u lá»›n vá»›i nhiá»u giao dá»‹ch hÆ¡n, vÃ¬ váº­y cÆ¡ sá»Ÿ dá»¯ liá»‡u hiá»‡n Ä‘áº¡i sá»­ dá»¥ng <strong>transaction log</strong>. Nháº­t kÃ½ giao dá»‹ch pháº£i Ä‘Æ°á»£c <strong>lÆ°u trá»¯ á»•n Ä‘á»‹nh</strong> vÃ  tÃ´i sáº½ khÃ´ng Ä‘Ã o sÃ¢u vÃ o cÃ´ng nghá»‡ lÆ°u trá»¯, nhÆ°ng Ã­t nháº¥t Disk RAID lÃ  báº¯t buá»™c trong trÆ°á»ng há»£p disk lá»—i.</p>
</blockquote>
<p>Háº§u háº¿t cÃ¡c cÆ¡ sá»Ÿ dá»¯ liá»‡u (Ã­t nháº¥t lÃ  Oracle, SQL Server, DB2, PostgreSQL, MySQL vÃ  SQLite) xá»­ lÃ½ nháº­t kÃ½ giao dá»‹ch báº±ng cÃ¡ch sá»­ dá»¥ng giao thá»©c nháº­t kÃ½ ghi trÆ°á»›c (Write-Ahead Logging protocol, WAL). Giao thá»©c WAL cÃ³ 3 quy táº¯c:</p>
<ul>
<li>Má»—i sá»­a Ä‘á»•i cÆ¡ sá»Ÿ dá»¯ liá»‡u táº¡o ra má»™t báº£n ghi nháº­t kÃ½, vÃ  trÆ°á»›c khi dá»¯ liá»‡u Ä‘Æ°á»£c ghi vÃ o disk, báº£n ghi nháº­t kÃ½ pháº£i Ä‘Æ°á»£c ghi vÃ o nháº­t kÃ½ giao dá»‹ch.</li>
<li>Ghi nháº­t kÃ½ pháº£i Ä‘Æ°á»£c viáº¿t theo thá»© tá»±; Báº£n ghi A xáº£y ra trÆ°á»›c khi báº£n ghi B thÃ¬ A pháº£i Ä‘Æ°á»£c viáº¿t trÆ°á»›c B.</li>
<li>Khi má»™t giao dá»‹ch Ä‘Æ°á»£c cam káº¿t, trÃ¬nh tá»± cam káº¿t pháº£i Ä‘Æ°á»£c ghi vÃ o nháº­t kÃ½ giao dá»‹ch trÆ°á»›c khi giao dá»‹ch thÃ nh cÃ´ng.</li>
</ul>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/Pasted image 20230605020105.png" alt="Pasted image 20230605020105" tabindex="0" loading="lazy"><figcaption>Pasted image 20230605020105</figcaption></figure>
<p>CÃ´ng viá»‡c nÃ y Ä‘Æ°á»£c thá»±c hiá»‡n bá»Ÿi trÃ¬nh quáº£n lÃ½ nháº­t kÃ½. Sá»± hiá»ƒu biáº¿t Ä‘Æ¡n giáº£n lÃ  trÃ¬nh quáº£n lÃ½ nháº­t kÃ½ náº±m giá»¯a trÃ¬nh quáº£n lÃ½ bá»™ nhá»› cache (cache manager) vÃ  trÃ¬nh quáº£n lÃ½ truy cáº­p dá»¯ liá»‡u (data access manager, chá»‹u trÃ¡ch nhiá»‡m ghi dá»¯ liá»‡u vÃ o disk), má»—i thao tÃ¡c update / delete / create / commit / rollback ghi vÃ o nháº­t kÃ½ giao dá»‹ch trÆ°á»›c khi ghi vÃ o disk. QuÃ¡ trÃ¬nh nÃ y lÃ  Ä‘Æ¡n giáº£n, lÃ½ do lÃ  <strong>lÃ m tháº¿ nÃ o Ä‘á»ƒ tÃ¬m má»™t cÃ¡ch Ä‘á»ƒ viáº¿t nháº­t kÃ½ trong khi váº«n duy trÃ¬ hiá»‡u suáº¥t tá»‘t</strong>, náº¿u nháº­t kÃ½ giao dá»‹ch Ä‘Æ°á»£c viáº¿t quÃ¡ cháº­m, toÃ n bá»™ sáº½ cháº­m láº¡i.</p>
<h4>ARIES</h4>
<blockquote>
<p>NÄƒm 1992, cÃ¡c nhÃ  nghiÃªn cá»©u IBM Ä‘Ã£ phÃ¡t minh ra má»™t phiÃªn báº£n nÃ¢ng cao cá»§a WAL, Ä‘Æ°á»£c gá»i lÃ  ARIES. ARIES Ã­t nhiá»u Ä‘Æ°á»£c sá»­ dá»¥ng trong cÆ¡ sá»Ÿ dá»¯ liá»‡u hiá»‡n Ä‘áº¡i, logic khÃ´ng nháº¥t thiáº¿t pháº£i giá»‘ng nhau, nhÆ°ng cÃ¡c khÃ¡i niá»‡m Ä‘áº±ng sau AIRES cÃ³ á»Ÿ kháº¯p má»i nÆ¡i. ARIES viáº¿t táº¯t cá»§a Algorithms for Recovery and Isolation Exploiting Semantics.</p>
</blockquote>
<p>CÃ´ng nghá»‡ nÃ y Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c má»™t má»¥c tiÃªu kÃ©p:</p>
<ul>
<li>Ghi nháº­t kÃ½ trong khi váº«n duy trÃ¬ hiá»‡u suáº¥t tá»‘t</li>
<li>Phá»¥c há»“i dá»¯ liá»‡u nhanh chÃ³ng vÃ  Ä‘Ã¡ng tin cáº­y</li>
</ul>
<p>CÃ³ má»™t sá»‘ lÃ½ do khiáº¿n cÆ¡ sá»Ÿ dá»¯ liá»‡u pháº£i rollback giao dá»‹ch:</p>
<ul>
<li>Bá»Ÿi vÃ¬ ngÆ°á»i dÃ¹ng há»§y bá»</li>
<li>Bá»Ÿi vÃ¬ mÃ¡y chá»§ hoáº·c máº¡ng tháº¥t báº¡i</li>
<li>Bá»Ÿi vÃ¬ cÃ¡c giao dá»‹ch phÃ¡ há»§y tÃ­nh toÃ n váº¹n cá»§a cÆ¡ sá»Ÿ dá»¯ liá»‡u (cháº³ng háº¡n nhÆ° má»™t cá»™t vá»›i cÃ¡c rÃ ng buá»™c duy nháº¥t vÃ  cÃ¡c giao dá»‹ch thÃªm cÃ¡c giÃ¡ trá»‹ trÃ¹ng láº·p)</li>
<li>Bá»Ÿi vÃ¬ báº¿ táº¯c</li>
</ul>
<h4>Nháº­t kÃ½ (Log)</h4>
<blockquote>
<p>ÄÃ´i khi (cháº³ng háº¡n nhÆ° lá»—i máº¡ng), cÆ¡ sá»Ÿ dá»¯ liá»‡u cÃ³ thá»ƒ khÃ´i phá»¥c giao dá»‹ch. LÃ m tháº¿ nÃ o Ä‘iá»u nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c? Äá»ƒ tráº£ lá»i cÃ¢u há»i nÃ y, chÃºng ta cáº§n pháº£i hiá»ƒu thÃ´ng tin Ä‘Æ°á»£c lÆ°u trong nháº­t kÃ½.</p>
</blockquote>
<p><strong>Má»—i hÃ nh Ä‘á»™ng (add/delete/modify) cá»§a giao dá»‹ch táº¡o ra má»™t log</strong> bao gá»“m:</p>
<ul>
<li>LSN: Má»™t sá»‘ sÃª-ri nháº­t kÃ½ duy nháº¥t (Log Sequence Number). LSN Ä‘Æ°á»£c phÃ¢n bá»• theo thá»© tá»± thá»i gian, cÃ³ nghÄ©a lÃ  náº¿u A hoáº¡t Ä‘á»™ng trÆ°á»›c B, LSN cá»§a log A nhá» hÆ¡n LSN cá»§a log B.</li>
<li>TransID: ID giao dá»‹ch táº¡o ra hÃ nh Ä‘á»™ng.</li>
<li>PageID: Vá»‹ trÃ­ cá»§a dá»¯ liá»‡u sá»­a Ä‘á»•i trÃªn disk. ÄÆ¡n vá»‹ nhá» nháº¥t cá»§a dá»¯ liá»‡u disk lÃ  má»™t trang, vÃ¬ váº­y vá»‹ trÃ­ cá»§a dá»¯ liá»‡u lÃ  nÆ¡i nÃ³ Ä‘ang á»Ÿ.</li>
<li>PrevLSN: LiÃªn káº¿t cuá»‘i cÃ¹ng Ä‘Æ°á»£c ghi láº¡i nháº­t kÃ½ Ä‘Æ°á»£c táº¡o ra bá»Ÿi cÃ¹ng má»™t giao dá»‹ch.</li>
<li>UNDO: PhÆ°Æ¡ng phÃ¡p há»§y bá» thao tÃ¡c nÃ y. VÃ­ dá»¥: náº¿u hÃ nh Ä‘á»™ng lÃ  cáº­p nháº­t, UNDO sáº½ hoáº·c lÆ°u cÃ¡c giÃ¡ trá»‹/tráº¡ng thÃ¡i pháº§n tá»­ trÆ°á»›c khi cáº­p nháº­t (physical UNDO), hoáº·c trá»Ÿ láº¡i hoáº¡t Ä‘á»™ng Ä‘áº£o ngÆ°á»£c cá»§a tráº¡ng thÃ¡i ban Ä‘áº§u (logical UNDO, chá»‰ sá»­ dá»¥ng UNDO logic vÃ¬ xá»­ lÃ½ physical UNDO quÃ¡ lá»™n xá»™n).</li>
<li>REDO: PhÆ°Æ¡ng phÃ¡p láº·p láº¡i hoáº¡t Ä‘á»™ng nÃ y. TÆ°Æ¡ng tá»± nhÆ° váº­y, cÃ³ 2 cÃ¡ch: hoáº·c lÆ°u giÃ¡ trá»‹ pháº§n tá»­ / tráº¡ng thÃ¡i sau khi hoáº¡t Ä‘á»™ng hoáº·c lÆ°u chÃ­nh hÃ nh Ä‘á»™ng Ä‘á»ƒ láº·p láº¡i.</li>
<li>â€¦ ğŸ˜¦ Ä‘á»ƒ báº¡n tham kháº£o, má»™t nháº­t kÃ½ ARIES cÅ©ng cÃ³ 2 trÆ°á»ng: UndoNxtLSN vÃ  Type).</li>
</ul>
<p>Má»—i trang trÃªn Ä‘Ä©a (lÆ°u dá»¯ liá»‡u, khÃ´ng pháº£i nháº­t kÃ½ Ä‘Æ°á»£c lÆ°u) ghi láº¡i LSN cuá»‘i cÃ¹ng sá»­a Ä‘á»•i hoáº¡t Ä‘á»™ng dá»¯ liá»‡u Ä‘Ã³.</p>
<blockquote>
<p>LÆ°u Ã½: Theo nhÆ° tÃ´i biáº¿t, chá»‰ PostgreSQL khÃ´ng sá»­ dá»¥ng UNDO mÃ  thay vÃ o Ä‘Ã³ sá»­ dá»¥ng dá»‹ch vá»¥ thu gom rÃ¡c Ä‘á»ƒ xÃ³a cÃ¡c phiÃªn báº£n cÅ© hÆ¡n cá»§a dá»¯ liá»‡u. Äiá»u nÃ y cÃ³ liÃªn quan Ä‘áº¿n viá»‡c thá»±c hiá»‡n kiá»ƒm soÃ¡t phiÃªn báº£n dá»¯ liá»‡u cá»§a PostgreSQL.</p>
</blockquote>
<p>Äá»ƒ minh há»a tá»‘t hÆ¡n Ä‘iá»u nÃ y, Ä‘iá»u nÃ y cÃ³ má»™t báº£n trÃ¬nh bÃ y ghi nháº­t kÃ½ Ä‘Æ¡n giáº£n Ä‘Æ°á»£c thá»±c hiá»‡n bá»Ÿi truy váº¥n "<code>UPDATE FROM PERSON SET AGE = 18;</code>" Káº¿t quáº£:</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/Pasted image 20230605200014.png" alt="Pasted image 20230605200014" tabindex="0" loading="lazy"><figcaption>Pasted image 20230605200014</figcaption></figure>
<p>Má»—i nháº­t kÃ½ cÃ³ má»™t LSN duy nháº¥t, vÃ  cÃ¡c báº£n ghi Ä‘Æ°á»£c liÃªn káº¿t vá»›i nhau thuá»™c vá» cÃ¹ng má»™t giao dá»‹ch. Nháº­t kÃ½ Ä‘Æ°á»£c liÃªn káº¿t theo thá»© tá»± thá»i gian (nháº­t kÃ½ cuá»‘i cÃ¹ng cá»§a danh sÃ¡ch liÃªn káº¿t Ä‘Æ°á»£c táº¡o ra bá»Ÿi hÃ nh Ä‘á»™ng cuá»‘i cÃ¹ng).</p>
<h4>Bá»™ Ä‘á»‡m nháº­t kÃ½ (log buffer)</h4>
<blockquote>
<p>Äá»ƒ ngÄƒn cháº·n ghi nháº­t kÃ½ trá»Ÿ thÃ nh nÃºt tháº¯t cá»• chai chÃ­nh, cÆ¡ sá»Ÿ dá»¯ liá»‡u sá»­ dá»¥ng bá»™ Ä‘á»‡m nháº­t kÃ½.</p>
</blockquote>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/Pasted image 20230605200118.png" alt="Pasted image 20230605200118" tabindex="0" loading="lazy"><figcaption>Pasted image 20230605200118</figcaption></figure>
<p>Khi trÃ¬nh thá»±c thi truy váº¥n yÃªu cáº§u sá»­a Ä‘á»•i má»™t láº§n:</p>
<ol>
<li>TrÃ¬nh quáº£n lÃ½ bá»™ nhá»› cache sáº½ sá»­a Ä‘á»•i Ä‘á»ƒ lÆ°u trá»¯ bá»™ Ä‘á»‡m cá»§a riÃªng mÃ¬nh</li>
<li>TrÃ¬nh quáº£n lÃ½ nháº­t kÃ½ lÆ°u trá»¯ cÃ¡c báº£n ghi cÃ³ liÃªn quan vÃ o bá»™ Ä‘á»‡m cá»§a riÃªng há»</li>
<li>Äáº¿n bÆ°á»›c nÃ y, trÃ¬nh thá»±c thi truy váº¥n tin ráº±ng thao tÃ¡c Ä‘Ã£ hoÃ n táº¥t (vÃ¬ váº­y báº¡n cÃ³ thá»ƒ yÃªu cáº§u sá»­a Ä‘á»•i khÃ¡c);</li>
<li>Sau Ä‘Ã³ (ngay sau Ä‘Ã³) trÃ¬nh quáº£n lÃ½ nháº­t kÃ½ ghi nháº­t kÃ½ vÃ o nháº­t kÃ½ giao dá»‹ch, thá»i Ä‘iá»ƒm ghinháº­t kÃ½ Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh bá»Ÿi má»™t thuáº­t toÃ¡n.</li>
<li>Sau Ä‘Ã³ (ngay sau Ä‘Ã³) trÃ¬nh quáº£n lÃ½ bá»™ nhá»› cache ghi cÃ¡c sá»­a Ä‘á»•i vÃ o disk vÃ  thá»i Ä‘iá»ƒm ghi vÃ o disk Ä‘Æ°á»£c Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh bá»Ÿi má»™t thuáº­t toÃ¡n.</li>
</ol>
<p><strong>Khi giao dá»‹ch Ä‘Æ°á»£c cam káº¿t, Ä‘iá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ  5 bÆ°á»›c cá»§a má»—i hoáº¡t Ä‘á»™ng cá»§a giao dá»‹ch Ä‘Ã£ Ä‘Æ°á»£c hoÃ n thÃ nh</strong>. Viáº¿t nháº­t kÃ½ giao dá»‹ch ráº¥t nhanh vÃ¬ nÃ³ chá»‰ Ä‘Æ¡n giáº£n lÃ  "thÃªm má»™t báº£n ghi á»Ÿ Ä‘Ã¢u Ä‘Ã³ trong nháº­t kÃ½ giao dá»‹ch"; VÃ  ghi dá»¯ liá»‡u vÃ o disk phá»©c táº¡p hÆ¡n, bá»Ÿi vÃ¬ nÃ³ cáº§n pháº£i "ghi dá»¯ liá»‡u báº±ng má»™t cÃ¡ch Ä‘á»ƒ cÃ³ thá»ƒ Ä‘á»c nhanh chÃ³ng".</p>
<h4>STEAL and FORCE strategies</h4>
<blockquote>
<p>VÃ¬ lÃ½ do hiá»‡u suáº¥t, <strong>BÆ°á»›c 5 cÃ³ thá»ƒ Ä‘Æ°á»£c hoÃ n thÃ nh sau khi cam káº¿t</strong>, bá»Ÿi vÃ¬ trong trÆ°á»ng há»£p xáº£y ra sá»± cá»‘, cÅ©ng cÃ³ thá»ƒ khÃ´i phá»¥c giao dá»‹ch vá»›i nháº­t kÃ½ REDO. Äiá»u nÃ y Ä‘Æ°á»£c gá»i lÃ  <strong>chÃ­nh sÃ¡ch NO-FORCE</strong>.</p>
</blockquote>
<p>CÆ¡ sá»Ÿ dá»¯ liá»‡u cÃ³ thá»ƒ chá»n chÃ­nh sÃ¡ch FORCE, cháº³ng háº¡n nhÆ° bÆ°á»›c 5 pháº£i Ä‘Æ°á»£c hoÃ n thÃ nh trÆ°á»›c khi cam káº¿t, Ä‘á»ƒ giáº£m táº£i khi phá»¥c há»“i.</p>
<p>Má»™t cÃ¢u há»i khÃ¡c lÃ  <strong>Ä‘á»ƒ chá»n xem dá»¯ liá»‡u lÃ  ghi tá»«ng bÆ°á»›c (chÃ­nh sÃ¡ch STEAL) hoáº·c ngÆ°á»i quáº£n lÃ½ bá»™ Ä‘á»‡m cáº§n pháº£i chá» Ä‘á»£i cho cÃ¡c lá»‡nh cam káº¿t Ä‘á»ƒ ghi táº¥t cáº£ cÃ¹ng má»™t lÃºc (chÃ­nh sÃ¡ch NO-STEAL</strong>). Chá»n STEAL hay NO-STEAL phá»¥ thuá»™c vÃ o nhá»¯ng gÃ¬ báº¡n muá»‘n: viáº¿t nhanh nhÆ°ng phá»¥c há»“i cháº­m tá»« nháº­t kÃ½ UNDO hoáº·c khÃ´i phá»¥c nhanh chÃ³ng.</p>
<p>DÆ°á»›i Ä‘Ã¢y lÃ  tÃ¡c Ä‘á»™ng cá»§a cÃ¡c chÃ­nh sÃ¡ch nÃ y Ä‘á»‘i vá»›i phá»¥c há»“i:</p>
<ul>
<li><strong>STEAL/NO-FORCE yÃªu cáº§u UNDO vÃ  REDO: hiá»‡u suáº¥t cao</strong>, nhÆ°ng cÃ¡c quy trÃ¬nh nháº­t kÃ½ vÃ  phá»¥c há»“i phá»©c táº¡p hÆ¡n (vÃ­ dá»¥: ARIES). Háº§u háº¿t cÃ¡c cÆ¡ sá»Ÿ dá»¯ liá»‡u chá»n chÃ­nh sÃ¡ch nÃ y. LÆ°u Ã½: ÄÃ¢y lÃ  nhá»¯ng gÃ¬ tÃ´i tháº¥y tá»« nhiá»u bÃ i bÃ¡o há»c thuáº­t vÃ  hÆ°á»›ng dáº«n, nhÆ°ng tÃ´i khÃ´ng tháº¥y Ä‘iá»u nÃ y rÃµ rÃ ng trong tÃ i liá»‡u chÃ­nh thá»©c.</li>
<li>STEAL/ FORCE chá»‰ cáº§n UNDO.</li>
<li>NO-STEAL/NO-FORCE chá»‰ cáº§n REDO.</li>
<li>NO-STEAL/FORCE khÃ´ng cáº§n báº¥t cá»© Ä‘iá»u gÃ¬: hiá»‡u suáº¥t tá»“i tá»‡ nháº¥t vÃ  yÃªu cáº§u bá»™ nhá»› ráº¥t lá»›n.</li>
</ul>
<h4>Vá» phá»¥c há»“i (recovery)</h4>
<blockquote>
<p>Ok, vá»›i nháº­t kÃ½ tá»‘t, chÃºng ta hÃ£y sá»­ dá»¥ng chÃºng!</p>
</blockquote>
<p>Giáº£ sá»­ thá»±c táº­p sinh má»›i lÃ m cho cÆ¡ sá»Ÿ dá»¯ liá»‡u sá»¥p Ä‘á»•, báº¡n khá»Ÿi Ä‘á»™ng láº¡i cÆ¡ sá»Ÿ dá»¯ liá»‡u vÃ  quÃ¡ trÃ¬nh phá»¥c há»“i báº¯t Ä‘áº§u.</p>
<p>ARIES phá»¥c há»“i tá»« sá»± cá»‘ cÃ³ ba giai Ä‘oáº¡n:</p>
<ul>
<li>
<ol>
<li><strong>Giai Ä‘oáº¡n phÃ¢n tÃ­ch</strong>: QuÃ¡ trÃ¬nh phá»¥c há»“i Ä‘á»c táº¥t cáº£ cÃ¡c báº£n ghi giao dá»‹ch Ä‘á»ƒ xÃ¢y dá»±ng láº¡i dÃ²ng thá»i gian cá»§a nhá»¯ng gÃ¬ Ä‘Ã£ xáº£y ra trong quÃ¡ trÃ¬nh sá»¥p Ä‘á»•, quyáº¿t Ä‘á»‹nh giao dá»‹ch nÃ o sáº½ rollback (táº¥t cáº£ cÃ¡c giao dá»‹ch chÆ°a Ä‘Æ°á»£c gá»­i pháº£i rollback), dá»¯ liá»‡u nÃ o cáº§n pháº£i Ä‘Æ°á»£c viáº¿t khi tai náº¡n.</li>
</ol>
</li>
<li>
<ol start="2">
<li><strong>Giai Ä‘oáº¡n Redo</strong>: Cáº¥p Ä‘á»™ nÃ y báº¯t Ä‘áº§u vá»›i má»™t báº£n ghi nháº­t kÃ½ Ä‘Æ°á»£c chá»n trong phÃ¢n tÃ­ch, sá»­ dá»¥ng REDO Ä‘á»ƒ khÃ´i phá»¥c cÆ¡ sá»Ÿ dá»¯ liá»‡u vá» tráº¡ng thÃ¡i trÆ°á»›c khi sá»¥p Ä‘á»•.</li>
</ol>
<ul>
<li>Trong giai Ä‘oáº¡n REDO, nháº­t kÃ½ REDO Ä‘Æ°á»£c xá»­ lÃ½ theo thá»© tá»± thá»i gian (sá»­ dá»¥ng LSN).</li>
<li>Äá»‘i vá»›i má»—i nháº­t kÃ½, quÃ¡ trÃ¬nh phá»¥c há»“i Ä‘Ã²i há»i pháº£i Ä‘á»c LSN trang Ä‘Ä©a cÃ³ chá»©a dá»¯ liá»‡u.</li>
<li>Náº¿u LSN (trang Ä‘Ä©a) &gt; = LSN (ghi nháº­t kÃ½), dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c ghi vÃ o Ä‘Ä©a trÆ°á»›c khi sá»¥p Ä‘á»• (nhÆ°ng giÃ¡ trá»‹ Ä‘Ã£ Ä‘Æ°á»£c ghi Ä‘Ã¨ bá»Ÿi má»™t hÃ nh Ä‘á»™ng sau nháº­t kÃ½ vÃ  trÆ°á»›c khi sá»¥p Ä‘á»•), vÃ¬ váº­y khÃ´ng cáº§n pháº£i lÃ m gÃ¬.</li>
<li>Náº¿u LSN (trang Ä‘Ä©a) &lt; LSN (ghi nháº­t kÃ½), cÃ¡c trang trÃªn Ä‘Ä©a sáº½ Ä‘Æ°á»£c cáº­p nháº­t.</li>
<li>Ngay cáº£ khi cÃ¡c giao dá»‹ch Ä‘Æ°á»£c rollback, REDO sáº½ lÃ m Ä‘iá»u Ä‘Ã³ vÃ¬ nÃ³ Ä‘Æ¡n giáº£n hÃ³a quÃ¡ trÃ¬nh phá»¥c há»“i (nhÆ°ng tÃ´i tin ráº±ng cÆ¡ sá»Ÿ dá»¯ liá»‡u hiá»‡n Ä‘áº¡i sáº½ khÃ´ng lÃ m Ä‘iá»u Ä‘Ã³).</li>
</ul>
</li>
<li>
<ol start="3">
<li><strong>Giai Ä‘oáº¡n Undo</strong>: Giai Ä‘oáº¡n nÃ y rollback táº¥t cáº£ cÃ¡c giao dá»‹ch chÆ°a hoÃ n thÃ nh khi tai náº¡n. rollback báº¯t Ä‘áº§u vá»›i nháº­t kÃ½ cuá»‘i cÃ¹ng cá»§a má»—i giao dá»‹ch vÃ  xá»­ lÃ½ nháº­t kÃ½ UNSO theo thá»© tá»± Ä‘áº£o ngÆ°á»£c thá»i gian (prevLSN Ä‘Æ°á»£c ghi láº¡i báº±ng nháº­t kÃ½).</li>
</ol>
</li>
</ul>
<p>Trong quÃ¡ trÃ¬nh phá»¥c há»“i, nháº­t kÃ½ giao dá»‹ch pháº£i chÃº Ã½ Ä‘áº¿n cÃ¡c hoáº¡t Ä‘á»™ng cá»§a quÃ¡ trÃ¬nh phá»¥c há»“i Ä‘á»ƒ dá»¯ liá»‡u ghi vÃ o Ä‘Ä©a phÃ¹ há»£p vá»›i nháº­t kÃ½ giao dá»‹ch. Má»™t giáº£i phÃ¡p lÃ  loáº¡i bá» cÃ¡c báº£n ghi nháº­t kÃ½ Ä‘Æ°á»£c táº¡o ra bá»Ÿi cÃ¡c giao dá»‹ch bá»‹ há»§y bá», nhÆ°ng Ä‘iá»u nÃ y lÃ  quÃ¡ khÃ³ khÄƒn. Thay vÃ o Ä‘Ã³, ARIES ghi láº¡i nháº­t kÃ½ bÃ¹ trong nháº­t kÃ½ giao dá»‹ch Ä‘á»ƒ loáº¡i bá» há»£p lÃ½ cÃ¡c báº£n ghi nháº­t kÃ½ cho cÃ¡c giao dá»‹ch bá»‹ há»§y bá».</p>
<p>Khi giao dá»‹ch bá»‹ há»§y bá» báº±ng tay hoáº·c bá»‹ há»§y bá» bá»Ÿi ngÆ°á»i quáº£n lÃ½ khÃ³a (Ä‘á»ƒ loáº¡i bá» báº¿ táº¯c), hoáº·c chá»‰ vÃ¬ lá»—i máº¡ng, giai Ä‘oáº¡n phÃ¢n tÃ­ch khÃ´ng cáº§n thiáº¿t. Äá»‘i vá»›i nhá»¯ng gÃ¬ cáº§n REDO cáº§n thÃ´ng tin UNDO trong 2 báº£ng bá»™ nhá»›:</p>
<ul>
<li>Báº£ng giao dá»‹ch (lÆ°u tráº¡ng thÃ¡i cá»§a táº¥t cáº£ cÃ¡c giao dá»‹ch hiá»‡n táº¡i)</li>
<li>Báº£ng trang báº©n (dá»¯ liá»‡u nÃ o cáº§n Ä‘Æ°á»£c ghi vÃ o Ä‘Ä©a)</li>
</ul>
<p>Khi má»™t giao dá»‹ch má»›i Ä‘Æ°á»£c táº¡o ra, cáº£ hai báº£ng Ä‘Æ°á»£c cáº­p nháº­t bá»Ÿi trÃ¬nh quáº£n lÃ½ bá»™ nhá»› cache vÃ  trÃ¬nh quáº£n lÃ½ giao dá»‹ch. Bá»Ÿi vÃ¬ nÃ³ náº±m trong bá»™ nhá»›, chÃºng cÅ©ng bá»‹ phÃ¡ há»§y khi cÆ¡ sá»Ÿ dá»¯ liá»‡u sá»¥p Ä‘á»•.</p>
<p>Nhiá»‡m vá»¥ cá»§a giai Ä‘oáº¡n phÃ¢n tÃ­ch lÃ  xÃ¢y dá»±ng láº¡i hai báº£ng trÃªn vá»›i thÃ´ng tin trong nháº­t kÃ½ giao dá»‹ch sau khi sá»¥p Ä‘á»•. Äá»ƒ Ä‘áº©y nhanh giai Ä‘oáº¡n phÃ¢n tÃ­ch, ARIES Ä‘Æ°a ra má»™t khÃ¡i niá»‡m: <strong>check point</strong>, thá»‰nh thoáº£ng ghi ná»™i dung cá»§a báº£ng giao dá»‹ch vÃ  báº£ng trang báº©n vÃ  LSN cuá»‘i cÃ¹ng vÃ o Ä‘Ä©a. VÃ¬ váº­y, trong giai Ä‘oáº¡n phÃ¢n tÃ­ch, chá»‰ cáº§n phÃ¢n tÃ­ch nháº­t kÃ½ sau LSN nÃ y.</p>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/Pasted%20image%2020230604124944.png" type="image/png"/>
    </item>
    <item>
      <title>SQL DB Interview</title>
      <link>https://vanhung4499.github.io/database/sql/interview.html</link>
      <guid>https://vanhung4499.github.io/database/sql/interview.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">SQL DB Interview</source>
      <description>Phá»ng váº¥n vá» CÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡ Chá»‰ má»¥c vÃ  RÃ ng buá»™c Chá»‰ má»¥c lÃ  gÃ¬? Chá»‰ má»¥c (Index) lÃ  má»™t cáº¥u trÃºc Ä‘Æ°á»£c sáº¯p xáº¿p cá»§a má»™t hoáº·c nhiá»u cá»™t trong báº£ng cÆ¡ sá»Ÿ dá»¯ liá»‡u, Ä‘Æ°á»£c sá»­ dá»¥ng...</description>
      <category>db</category>
      <category>sql</category>
      <category>interview</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>Chá»‰ má»¥c vÃ  RÃ ng buá»™c</h2>
<h3>Chá»‰ má»¥c lÃ  gÃ¬?</h3>
<p>Chá»‰ má»¥c (Index) lÃ  má»™t cáº¥u trÃºc Ä‘Æ°á»£c sáº¯p xáº¿p cá»§a má»™t hoáº·c nhiá»u cá»™t trong báº£ng cÆ¡ sá»Ÿ dá»¯ liá»‡u, Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ¬m kiáº¿m dá»¯ liá»‡u má»™t cÃ¡ch hiá»‡u quáº£.</p>
<h3>Æ¯u Ä‘iá»ƒm vÃ  nhÆ°á»£c Ä‘iá»ƒm cá»§a chá»‰ má»¥c</h3>
<p>âœ” Æ¯u Ä‘iá»ƒm cá»§a chá»‰ má»¥c:</p>
<ul>
<li>Chá»‰ má»¥c giÃºp giáº£m lÆ°á»£ng dá»¯ liá»‡u mÃ  mÃ¡y chá»§ cáº§n quÃ©t, tá»« Ä‘Ã³ tÄƒng tá»‘c Ä‘á»™ truy váº¥n dá»¯ liá»‡u.</li>
<li>Trong cÃ¡c cÆ¡ sá»Ÿ dá»¯ liá»‡u há»— trá»£ khÃ³a hÃ ng (nhÆ° InnoDB), khi truy cáº­p vÃ o hÃ ng, khÃ³a hÃ ng sáº½ Ä‘Æ°á»£c Ã¡p dá»¥ng. Sá»­ dá»¥ng chá»‰ má»¥c cÃ³ thá»ƒ giáº£m sá»‘ lÆ°á»£ng hÃ ng truy cáº­p, tá»« Ä‘Ã³ giáº£m sá»± cáº¡nh tranh khÃ³a vÃ  tÄƒng kháº£ nÄƒng Ä‘á»“ng thá»i.</li>
<li>Chá»‰ má»¥c cÃ³ thá»ƒ giÃºp mÃ¡y chá»§ trÃ¡nh sáº¯p xáº¿p vÃ  báº£ng táº¡m thá»i.</li>
<li>Chá»‰ má»¥c cÃ³ thá»ƒ biáº¿n I/O ngáº«u nhiÃªn thÃ nh I/O tuáº§n tá»±.</li>
<li>Chá»‰ má»¥c duy nháº¥t Ä‘áº£m báº£o tÃ­nh duy nháº¥t cá»§a má»—i hÃ ng dá»¯ liá»‡u. Báº±ng cÃ¡ch sá»­ dá»¥ng chá»‰ má»¥c, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng trÃ¬nh tá»‘i Æ°u hÃ³a truy váº¥n Ä‘á»ƒ tÄƒng hiá»‡u suáº¥t há»‡ thá»‘ng.</li>
</ul>
<p>âŒ NhÆ°á»£c Ä‘iá»ƒm cá»§a chá»‰ má»¥c:</p>
<ul>
<li>Táº¡o vÃ  duy trÃ¬ chá»‰ má»¥c máº¥t thá»i gian, vÃ  thá»i gian nÃ y tÄƒng lÃªn khi dá»¯ liá»‡u tÄƒng.</li>
<li>Chá»‰ má»¥c chiáº¿m khÃ´ng gian lÆ°u trá»¯ bá»• sung, ngoÃ i khÃ´ng gian dá»¯ liá»‡u cá»§a báº£ng. Náº¿u táº¡o chá»‰ má»¥c káº¿t há»£p, khÃ´ng gian cáº§n thiáº¿t sáº½ lá»›n hÆ¡n.</li>
<li>CÃ¡c hoáº¡t Ä‘á»™ng ghi (<code>INSERT</code>/<code>UPDATE</code>/<code>DELETE</code>) cÃ³ thá»ƒ cáº§n cáº­p nháº­t chá»‰ má»¥c, lÃ m giáº£m hiá»‡u suáº¥t ghi cá»§a cÆ¡ sá»Ÿ dá»¯ liá»‡u.</li>
</ul>
<h3>Khi nÃ o sá»­ dá»¥ng chá»‰ má»¥c</h3>
<p>Chá»‰ má»¥c cÃ³ thá»ƒ cáº£i thiá»‡n hiá»‡u suáº¥t truy váº¥n má»™t cÃ¡ch Ä‘Ã¡ng ká»ƒ.</p>
<p>âœ” Khi nÃ o thÃ¬ nÃªn sá»­ dá»¥ng chá»‰ má»¥c:</p>
<ul>
<li>Báº£ng thÆ°á»ng xuyÃªn thá»±c hiá»‡n cÃ¡c truy váº¥n <code>SELECT</code>.</li>
<li>Dá»¯ liá»‡u trong báº£ng lá»›n.</li>
<li>CÃ¡c cá»™t thÆ°á»ng xuyÃªn xuáº¥t hiá»‡n trong Ä‘iá»u kiá»‡n <code>WHERE</code> hoáº·c Ä‘iá»u kiá»‡n káº¿t ná»‘i (<code>JOIN</code>).</li>
</ul>
<p>âŒ Khi nÃ o khÃ´ng nÃªn sá»­ dá»¥ng chá»‰ má»¥c:</p>
<ul>
<li>Hoáº¡t Ä‘á»™ng ghi thÆ°á»ng xuyÃªn (<code>INSERT</code>/<code>UPDATE</code>/<code>DELETE</code>) - cáº§n cáº­p nháº­t khÃ´ng gian chá»‰ má»¥c.</li>
<li>Báº£ng ráº¥t nhá» - trong háº§u háº¿t cÃ¡c trÆ°á»ng há»£p, quÃ©t toÃ n bá»™ báº£ng Ä‘Æ¡n giáº£n hÆ¡n.</li>
<li>Cá»™t khÃ´ng xuáº¥t hiá»‡n thÆ°á»ng xuyÃªn trong Ä‘iá»u kiá»‡n <code>WHERE</code> hoáº·c Ä‘iá»u kiá»‡n káº¿t ná»‘i (<code>JOIN</code>) - chá»‰ má»¥c sáº½ khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng vÃ  táº¡o thÃªm chi phÃ­ khÃ´ng gian.</li>
</ul>
<h3>CÃ¡c loáº¡i chá»‰ má»¥c</h3>
<p>CÃ¡c há»‡ thá»‘ng cÆ¡ sá»Ÿ dá»¯ liá»‡u phá»• biáº¿n thÆ°á»ng há»— trá»£ cÃ¡c loáº¡i chá»‰ má»¥c sau:</p>
<p>Dá»±a trÃªn loáº¡i logic (thÆ°á»ng Ä‘Æ°á»£c Ä‘áº·t khi táº¡o báº£ng):</p>
<ul>
<li>Chá»‰ má»¥c duy nháº¥t (<code>UNIQUE</code>) - giÃ¡ trá»‹ cá»§a cá»™t chá»‰ má»¥c pháº£i lÃ  duy nháº¥t, nhÆ°ng cÃ³ thá»ƒ chá»©a giÃ¡ trá»‹ NULL. Náº¿u lÃ  chá»‰ má»¥c káº¿t há»£p, sá»± káº¿t há»£p cá»§a cÃ¡c giÃ¡ trá»‹ cá»™t pháº£i lÃ  duy nháº¥t.</li>
<li>Chá»‰ má»¥c chÃ­nh (<code>PRIMARY</code>) - má»™t loáº¡i Ä‘áº·c biá»‡t cá»§a chá»‰ má»¥c duy nháº¥t, má»™t báº£ng chá»‰ cÃ³ thá»ƒ cÃ³ má»™t chá»‰ má»¥c chÃ­nh vÃ  khÃ´ng cho phÃ©p giÃ¡ trá»‹ NULL. ThÆ°á»ng Ä‘Æ°á»£c táº¡o cÃ¹ng vá»›i viá»‡c táº¡o báº£ng.</li>
<li>Chá»‰ má»¥c thÃ´ng thÆ°á»ng (<code>INDEX</code>) - chá»‰ má»¥c cÆ¡ báº£n nháº¥t, khÃ´ng cÃ³ rÃ ng buá»™c Ä‘áº·c biá»‡t.</li>
<li>Chá»‰ má»¥c káº¿t há»£p - chá»‰ má»¥c Ä‘Æ°á»£c táº¡o trÃªn nhiá»u cá»™t, chá»‰ khi Ä‘iá»u kiá»‡n truy váº¥n sá»­ dá»¥ng cá»™t Ä‘áº§u tiÃªn trong chá»‰ má»¥c, chá»‰ má»¥c má»›i Ä‘Æ°á»£c sá»­ dá»¥ng. Sá»­ dá»¥ng nguyÃªn táº¯c táº­p con trÃ¡i nháº¥t.</li>
</ul>
<p>Dá»±a trÃªn cáº¥u trÃºc lÆ°u trá»¯:</p>
<ul>
<li>Chá»‰ má»¥c gom cá»¥m (<code>Clustered</code>) - cÃ¡c hÃ ng dá»¯ liá»‡u vÃ  cÃ¡c giÃ¡ trá»‹ khÃ³a Ä‘Æ°á»£c lÆ°u trá»¯ theo cÃ¹ng má»™t thá»© tá»± váº­t lÃ½, má»—i báº£ng chá»‰ cÃ³ thá»ƒ cÃ³ má»™t chá»‰ má»¥c gom cá»¥m.</li>
<li>Chá»‰ má»¥c khÃ´ng gom cá»¥m (<code>Non-clustered</code>) - chá»‰ má»¥c chá»‰ Ä‘á»‹nh thá»© tá»± logic cá»§a cÃ¡c giÃ¡ trá»‹ khÃ³a, dá»¯ liá»‡u Ä‘Æ°á»£c lÆ°u trá»¯ á»Ÿ má»™t vá»‹ trÃ­ vÃ  chá»‰ má»¥c Ä‘Æ°á»£c lÆ°u trá»¯ á»Ÿ má»™t vá»‹ trÃ­ khÃ¡c, chá»‰ má»¥c chá»©a con trá» Ä‘áº¿n vá»‹ trÃ­ lÆ°u trá»¯ dá»¯ liá»‡u. CÃ³ thá»ƒ cÃ³ nhiá»u chá»‰ má»¥c khÃ´ng gom cá»¥m, nhÆ°ng sá»‘ lÆ°á»£ng cÃ³ giá»›i háº¡n (thÆ°á»ng nhá» hÆ¡n 249).</li>
</ul>
<h3>Cáº¥u trÃºc dá»¯ liá»‡u cá»§a chá»‰ má»¥c</h3>
<p>CÃ¡c cÆ¡ sá»Ÿ dá»¯ liá»‡u phá»• biáº¿n thÆ°á»ng sá»­ dá»¥ng cáº¥u trÃºc dá»¯ liá»‡u B-Tree hoáº·c B+Tree cho chá»‰ má»¥c.</p>
<h4>B-Tree</h4>
<p>B-Tree báº­c M lÃ  cÃ¢y cÃ³ cÃ¡c thuá»™c tÃ­nh sau:</p>
<ul>
<li>Má»—i nÃºt cÃ³ tá»‘i Ä‘a M con.</li>
<li>Ngoáº¡i trá»« nÃºt gá»‘c vÃ  nÃºt lÃ¡, má»—i nÃºt cÃ³ Ã­t nháº¥t M/2 con.</li>
<li>NÃºt gá»‘c cÃ³ Ã­t nháº¥t hai con (trá»« khi cÃ¢y chá»‰ chá»©a má»™t nÃºt).</li>
<li>Táº¥t cáº£ cÃ¡c nÃºt lÃ¡ náº±m á»Ÿ cÃ¹ng má»™t má»©c, khÃ´ng chá»©a báº¥t ká»³ thÃ´ng tin khÃ³a nÃ o.</li>
<li>NÃºt khÃ´ng pháº£i lÃ¡ chá»©a Ã­t nháº¥t M/2-1 vÃ  tá»‘i Ä‘a M-1 khÃ³a.</li>
<li>CÃ¡c khÃ³a bÃªn trong má»—i nÃºt Ä‘Æ°á»£c sáº¯p xáº¿p theo thá»© tá»± tÄƒng dáº§n.</li>
<li>Äá»‘i vá»›i má»—i nÃºt, cÃ³ má»™t máº£ng khÃ³a <code>Key[]</code> vÃ  má»™t máº£ng con trá» (trá» Ä‘áº¿n cÃ¡c con) <code>Son[]</code>.</li>
</ul>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230721113211.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure>
<p>Trong cÃ¢y B-Tree, quÃ¡ trÃ¬nh tÃ¬m kiáº¿m diá»…n ra nhÆ° sau:</p>
<ol>
<li>TÃ¬m kiáº¿m trong máº£ng khÃ³a <code>Key[]</code> báº±ng phÆ°Æ¡ng phÃ¡p tÃ¬m kiáº¿m tuáº§n tá»± (khi Ä‘á»™ dÃ i máº£ng nhá») hoáº·c tÃ¬m kiáº¿m nhá»‹ phÃ¢n (khi Ä‘á»™ dÃ i máº£ng lá»›n), náº¿u tÃ¬m tháº¥y khÃ³a K, tráº£ vá» Ä‘á»‹a chá»‰ cá»§a nÃºt vÃ  vá»‹ trÃ­ cá»§a K trong <code>Key[]</code>.</li>
<li>Náº¿u khÃ´ng tÃ¬m tháº¥y, cÃ³ thá»ƒ xÃ¡c Ä‘á»‹nh K náº±m giá»¯a Key[i] vÃ  Key[i+1] cá»§a má»™t nÃºt, tiáº¿p tá»¥c tÃ¬m kiáº¿m tá»« con trá» Son[i] trá» Ä‘áº¿n con trá» con, cho Ä‘áº¿n khi tÃ¬m tháº¥y nÃºt chá»©a thÃ nh cÃ´ng.</li>
<li>Hoáº·c tÃ¬m kiáº¿m khÃ´ng thÃ nh cÃ´ng khi tÃ¬m tháº¥y má»™t nÃºt lÃ¡ vÃ  tÃ¬m kiáº¿m trong nÃºt lÃ¡ khÃ´ng thÃ nh cÃ´ng.</li>
</ol>
<h4>B+Tree</h4>
<p>B+Tree lÃ  biáº¿n thá»ƒ cá»§a cÃ¢y B-Tree:</p>
<ul>
<li>Sá»‘ lÆ°á»£ng con cá»§a má»—i nÃºt giá»›i háº¡n lÃ  2d thay vÃ¬ 2d+1 (d lÃ  báº­c ra cá»§a nÃºt).</li>
<li>NÃºt khÃ´ng pháº£i lÃ¡ khÃ´ng chá»©a dá»¯ liá»‡u, chá»‰ chá»©a khÃ³a.</li>
<li>NÃºt lÃ¡ khÃ´ng chá»©a con trá».</li>
</ul>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230721113624.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure>
<p>Trong B+Tree, nÃºt lÃ¡ vÃ  nÃºt khÃ´ng pháº£i lÃ¡ cÃ³ kÃ­ch thÆ°á»›c khÃ¡c nhau. Äiá»u nÃ y khÃ¡c vá»›i cÃ¢y B-Tree, trong Ä‘Ã³ cÃ¡c nÃºt khÃ¡c nhau chá»©a cÃ¹ng sá»‘ lÆ°á»£ng khÃ³a vÃ  con trá».</p>
<p><strong>CÃ¢y B+Tree vá»›i con trá» truy cáº­p tuáº§n tá»±</strong></p>
<p>NÃ³i chung, cáº¥u trÃºc B+Tree Ä‘Æ°á»£c sá»­ dá»¥ng trong há»‡ thá»‘ng cÆ¡ sá»Ÿ dá»¯ liá»‡u hoáº·c há»‡ thá»‘ng tá»‡p Ä‘Ã£ Ä‘Æ°á»£c tá»‘i Æ°u hÃ³a trÃªn cÆ¡ sá»Ÿ B+Tree cá»• Ä‘iá»ƒn báº±ng viá»‡c thÃªm cÃ¡c con trá» truy cáº­p tuáº§n tá»±.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230721113644.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure>
<p>Trong B+Tree vá»›i con trá» truy cáº­p tuáº§n tá»±, má»—i nÃºt lÃ¡ Ä‘Æ°á»£c thÃªm má»™t con trá» trá» Ä‘áº¿n nÃºt lÃ¡ káº¿ tiáº¿p, táº¡o thÃ nh má»™t chuá»—i con trá».</p>
<p>Tá»‘i Æ°u hÃ³a nÃ y nháº±m má»¥c Ä‘Ã­ch cáº£i thiá»‡n hiá»‡u suáº¥t truy váº¥n pháº¡m vi, vÃ­ dá»¥: náº¿u muá»‘n truy váº¥n táº¥t cáº£ cÃ¡c báº£n ghi cÃ³ giÃ¡ trá»‹ khÃ³a tá»« 18 Ä‘áº¿n 49, sau khi tÃ¬m tháº¥y 18, chá»‰ cáº§n duyá»‡t theo thá»© tá»± nÃºt vÃ  con trá» Ä‘á»ƒ truy cáº­p táº¥t cáº£ cÃ¡c báº£n ghi, tÄƒng Ä‘Ã¡ng ká»ƒ hiá»‡u suáº¥t truy váº¥n pháº¡m vi.</p>
<h4>B-Tree vs B+Tree</h4>
<ul>
<li>B+Tree phÃ¹ há»£p hÆ¡n cho lÆ°u trá»¯ bÃªn ngoÃ i (thÆ°á»ng lÃ  lÆ°u trá»¯ Ä‘Ä©a), vÃ¬ cÃ¡c nÃºt khÃ´ng pháº£i lÃ¡ khÃ´ng chá»©a dá»¯ liá»‡u, vÃ¬ váº­y má»—i nÃºt cÃ³ thá»ƒ chá»©a nhiá»u nÃºt hÆ¡n, má»—i nÃºt cÃ³ thá»ƒ chá»©a nhiá»u giÃ¡ trá»‹ hÆ¡n. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  má»—i láº§n I/O Ä‘Ä©a, lÆ°á»£ng thÃ´ng tin Ä‘Æ°á»£c truy cáº­p báº±ng chá»‰ má»¥c B+Tree lá»›n hÆ¡n, tÄƒng hiá»‡u suáº¥t I/O.</li>
<li>MySQL lÃ  há»‡ thá»‘ng cÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡ (RDBMS), thÆ°á»ng sáº½ truy váº¥n theo pháº¡m vi trÃªn cá»™t chá»‰ má»¥c, B+Tree cÃ³ cÃ¡c nÃºt lÃ¡ Ä‘Æ°á»£c sáº¯p xáº¿p theo thá»© tá»±, giÃºp tá»‘i Æ°u hÃ³a truy váº¥n pháº¡m vi trÃªn cá»™t chá»‰ má»¥c. CÃ²n B-Tree khÃ´ng thá»ƒ thá»±c hiá»‡n truy váº¥n pháº¡m vi trÃªn cá»™t chá»‰ má»¥c.</li>
</ul>
<h4>Hash</h4>
<blockquote>
<p>Hash chá»‰ cÃ³ hiá»‡u lá»±c Ä‘á»‘i vá»›i cÃ¡c truy váº¥n khá»›p chÃ­nh xÃ¡c táº¥t cáº£ cÃ¡c cá»™t trong chá»‰ má»¥c.</p>
</blockquote>
<p>Äá»‘i vá»›i má»—i hÃ ng dá»¯ liá»‡u, tÃ­nh toÃ¡n má»™t <code>hashcode</code> cho táº¥t cáº£ cÃ¡c cá»™t chá»‰ má»¥c. Chá»‰ má»¥c hash lÆ°u trá»¯ táº¥t cáº£ cÃ¡c <code>hashcode</code> trong chá»‰ má»¥c vÃ  sá»­ dá»¥ng báº£ng bÄƒm Ä‘á»ƒ lÆ°u trá»¯ con trá» Ä‘áº¿n hÃ ng dá»¯ liá»‡u.</p>
<p>Lá»£i Ã­ch cá»§a chá»‰ má»¥c bÄƒm:</p>
<ul>
<li>VÃ¬ cáº¥u trÃºc dá»¯ liá»‡u chá»‰ má»¥c ráº¥t gá»n nháº¹, nÃªn tá»‘c Ä‘á»™ truy váº¥n ráº¥t nhanh.</li>
<li>Má»™t sá»‘ há»‡ thá»‘ng cÆ¡ sá»Ÿ dá»¯ liá»‡u (nhÆ° MyISAM) chá»‰ lÆ°u trá»¯ chá»‰ má»¥c trong bá»™ nhá»›, trong khi dá»¯ liá»‡u phá»¥ thuá»™c vÃ o há»‡ Ä‘iá»u hÃ nh Ä‘á»ƒ lÆ°u trá»¯. Do Ä‘Ã³, chá»‰ truy cáº­p chá»‰ má»¥c khÃ´ng sá»­ dá»¥ng cuá»™c gá»i há»‡ thá»‘ng (thÆ°á»ng tá»‘n thá»i gian).</li>
</ul>
<p>NhÆ°á»£c Ä‘iá»ƒm cá»§a chá»‰ má»¥c bÄƒm:</p>
<ul>
<li>Dá»¯ liá»‡u khÃ´ng Ä‘Æ°á»£c lÆ°u trá»¯ theo thá»© tá»± chá»‰ má»¥c, do Ä‘Ã³ khÃ´ng thá»ƒ sá»­ dá»¥ng Ä‘á»ƒ sáº¯p xáº¿p.</li>
<li>Chá»‰ má»¥c bÄƒm khÃ´ng há»— trá»£ truy váº¥n pháº¡m vi. Chá»‰ cÃ³ thá»ƒ sá»­ dá»¥ng cho truy váº¥n khá»›p chÃ­nh xÃ¡c.</li>
<li>Chá»‰ má»¥c bÄƒm khÃ´ng há»— trá»£ truy váº¥n pháº§n cá»§a chá»‰ má»¥c. VÃ­ dá»¥: náº¿u chá»‰ má»¥c bÄƒm Ä‘Æ°á»£c táº¡o trÃªn cá»™t (A, B), vÃ  truy váº¥n chá»‰ cÃ³ cá»™t A, thÃ¬ khÃ´ng thá»ƒ sá»­ dá»¥ng chá»‰ má»¥c nÃ y.</li>
<li>Chá»‰ má»¥c bÄƒm chá»‰ há»— trá»£ truy váº¥n so sÃ¡nh báº±ng, khÃ´ng há»— trá»£ truy váº¥n pháº¡m vi. VÃ­ dá»¥: <code>WHERE price &gt; 100</code> khÃ´ng thá»ƒ sá»­ dá»¥ng chá»‰ má»¥c bÄƒm.</li>
<li>Chá»‰ má»¥c bÄƒm cÃ³ thá»ƒ gáº·p xung Ä‘á»™t bÄƒm, khi Ä‘Ã³ pháº£i duyá»‡t qua táº¥t cáº£ cÃ¡c con trá» hÃ ng trong danh sÃ¡ch liÃªn káº¿t, so sÃ¡nh tá»«ng hÃ ng Ä‘á»ƒ tÃ¬m hÃ ng phÃ¹ há»£p.</li>
</ul>
<h3>Chiáº¿n lÆ°á»£c láº­p chá»‰ má»¥c</h3>
<h4>NguyÃªn táº¯c cÆ¡ báº£n cá»§a chá»‰ má»¥c</h4>
<ul>
<li>KhÃ´ng pháº£i cÃ ng nhiá»u chá»‰ má»¥c cÃ ng tá»‘t, khÃ´ng nÃªn táº¡o chá»‰ má»¥c cho táº¥t cáº£ cÃ¡c cá»™t.</li>
<li>TrÃ¡nh sá»± trÃ¹ng láº·p vÃ  chá»‰ má»¥c khÃ´ng cáº§n thiáº¿t.</li>
<li>XÃ³a cÃ¡c chá»‰ má»¥c khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng.</li>
<li>Má»Ÿ rá»™ng cÃ¡c chá»‰ má»¥c hiá»‡n cÃ³ thay vÃ¬ táº¡o má»›i.</li>
<li>CÃ¢n nháº¯c thÃªm chá»‰ má»¥c cho cÃ¡c cá»™t Ä‘Æ°á»£c sá»­ dá»¥ng thÆ°á»ng xuyÃªn trong Ä‘iá»u kiá»‡n lá»c <code>WHERE</code>.</li>
</ul>
<h4>Cá»™t Ä‘á»™c láº­p</h4>
<p><strong>Náº¿u cá»™t trong cÃ¢u truy váº¥n khÃ´ng pháº£i lÃ  cá»™t Ä‘á»™c láº­p, cÆ¡ sá»Ÿ dá»¯ liá»‡u sáº½ khÃ´ng sá»­ dá»¥ng chá»‰ má»¥c</strong>.</p>
<p>"Cá»™t Ä‘á»™c láº­p" cÃ³ nghÄ©a lÃ  cá»™t chá»‰ má»¥c khÃ´ng Ä‘Æ°á»£c táº¡o thÃ nh tá»« má»™t pháº§n cá»§a biá»ƒu thá»©c hoáº·c lÃ  Ä‘á»‘i sá»‘ cá»§a má»™t hÃ m.</p>
<p>VÃ­ dá»¥ sai:</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SELECT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> actor_id </span><span style="color:#C678DD;--shiki-dark:#C678DD">FROM</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> actor </span><span style="color:#C678DD;--shiki-dark:#C678DD">WHERE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> actor_id + </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SELECT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> ... </span><span style="color:#C678DD;--shiki-dark:#C678DD">WHERE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> TO_DAYS(current_date) - TO_DAYS(date_col) </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&lt;=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span></code></pre>
</div><h4>Chá»‰ má»¥c tiá»n tá»‘ vÃ  tÃ­nh chá»n lá»c cá»§a chá»‰ má»¥c</h4>
<p>ÄÃ´i khi cáº§n táº¡o chá»‰ má»¥c cho cÃ¡c cá»™t cÃ³ Ä‘á»™ dÃ i lá»›n, Ä‘iá»u nÃ y lÃ m cho chá»‰ má»¥c trá»Ÿ nÃªn lá»›n vÃ  cháº­m.</p>
<p>Giáº£i phÃ¡p lÃ : chá»‰ cáº§n táº¡o chá»‰ má»¥c cho má»™t pháº§n Ä‘áº§u cá»§a chuá»—i, Ä‘iá»u nÃ y giÃºp tiáº¿t kiá»‡m khÃ´ng gian chá»‰ má»¥c vÃ  tÄƒng hiá»‡u suáº¥t chá»‰ má»¥c. Tuy nhiÃªn, Ä‘iá»u nÃ y cÅ©ng lÃ m giáº£m tÃ­nh chá»n lá»c cá»§a chá»‰ má»¥c.</p>
<p>TÃ­nh chá»n lá»c cá»§a chá»‰ má»¥c lÃ  tá»· lá»‡ giá»¯a sá»‘ giÃ¡ trá»‹ chá»‰ má»¥c khÃ´ng trÃ¹ng láº·p vÃ  tá»•ng sá»‘ báº£n ghi trong báº£ng. GiÃ¡ trá»‹ tá»‘i Ä‘a lÃ  1, khi má»—i báº£n ghi cÃ³ má»™t chá»‰ má»¥c duy nháº¥t. TÃ­nh chá»n lá»c cÃ ng cao, hiá»‡u suáº¥t truy váº¥n cÃ ng cao.</p>
<p>Äá»‘i vá»›i cÃ¡c cá»™t kiá»ƒu BLOB/TEXT/VARCHAR, pháº£i sá»­ dá»¥ng chá»‰ má»¥c tiá»n tá»‘ vÃ¬ cÆ¡ sá»Ÿ dá»¯ liá»‡u thÆ°á»ng khÃ´ng cho phÃ©p chá»‰ má»¥c Ä‘áº§y Ä‘á»§ cho cÃ¡c cá»™t nÃ y.</p>
<p>Cáº§n chá»n tiá»n tá»‘ Ä‘á»§ dÃ i Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh chá»n lá»c cao, Ä‘á»“ng thá»i khÃ´ng quÃ¡ dÃ i (tiáº¿t kiá»‡m khÃ´ng gian).</p>
<p>VÃ­ dá»¥ khÃ´ng hiá»‡u quáº£:</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SELECT</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> COUNT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(*) </span><span style="color:#C678DD;--shiki-dark:#C678DD">AS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> cnt, city </span><span style="color:#C678DD;--shiki-dark:#C678DD">FROM</span><span style="color:#D19A66;--shiki-dark:#D19A66"> sakila</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">city_demo</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">GROUP BY</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> city </span><span style="color:#C678DD;--shiki-dark:#C678DD">ORDER BY</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> cnt </span><span style="color:#C678DD;--shiki-dark:#C678DD">DESC</span><span style="color:#C678DD;--shiki-dark:#C678DD"> LIMIT</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span></code></pre>
</div><p>VÃ­ dá»¥ hiá»‡u quáº£:</p>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SELECT</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> COUNT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(*) </span><span style="color:#C678DD;--shiki-dark:#C678DD">AS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> cnt, </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">LEFT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(city, </span><span style="color:#D19A66;--shiki-dark:#D19A66">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#C678DD;--shiki-dark:#C678DD">AS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> pref </span><span style="color:#C678DD;--shiki-dark:#C678DD">FROM</span><span style="color:#D19A66;--shiki-dark:#D19A66"> sakila</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#D19A66;--shiki-dark:#D19A66">city_demo</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">GROUP BY</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> city </span><span style="color:#C678DD;--shiki-dark:#C678DD">ORDER BY</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> cnt </span><span style="color:#C678DD;--shiki-dark:#C678DD">DESC</span><span style="color:#C678DD;--shiki-dark:#C678DD"> LIMIT</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span></code></pre>
</div><h4>Chá»‰ má»¥c Ä‘a cá»™t</h4>
<p><strong>KhÃ´ng nÃªn táº¡o chá»‰ má»¥c riÃªng cho tá»«ng cá»™t</strong>.</p>
<p><strong>Æ¯u tiÃªn Ä‘áº·t cÃ¡c cá»™t cÃ³ tÃ­nh chá»n lá»c cao hoáº·c sá»‘ lÆ°á»£ng giÃ¡ trá»‹ duy nháº¥t lá»›n á»Ÿ Ä‘áº§u chá»‰ má»¥c Ä‘a cá»™t</strong>. Tuy nhiÃªn, Ä‘Ã´i khi cÅ©ng cáº§n xem xÃ©t cÃ¡c yáº¿u tá»‘ khÃ¡c nhÆ° sáº¯p xáº¿p, nhÃ³m vÃ  Ä‘iá»u kiá»‡n pháº¡m vi trong má»‡nh Ä‘á» WHERE, vÃ¬ nhá»¯ng yáº¿u tá»‘ nÃ y cÅ©ng áº£nh hÆ°á»Ÿng Ä‘Ã¡ng ká»ƒ Ä‘áº¿n hiá»‡u suáº¥t truy váº¥n.</p>
<p>VÃ­ dá»¥:</p>
<p>Giáº£ sá»­ cÃ³ báº£ng user vá»›i cÃ¡c cá»™t name, sex, age. Náº¿u táº¡o chá»‰ má»¥c Ä‘a cá»™t cho ba cá»™t nÃ y, thÃ¬ thá»© tá»± tá»‘t nháº¥t lÃ : <code>name &gt; age &gt; sex</code>.</p>
<h4>Chá»‰ má»¥c gom nhÃ³m</h4>
<p>Chá»‰ má»¥c gom nhÃ³m khÃ´ng pháº£i lÃ  má»™t loáº¡i chá»‰ má»¥c Ä‘á»™c láº­p, mÃ  lÃ  má»™t cÃ¡ch lÆ°u trá»¯ dá»¯ liá»‡u. Chi tiáº¿t cá»¥ thá»ƒ phá»¥ thuá»™c vÃ o cÃ¡ch triá»ƒn khai. VÃ­ dá»¥, chá»‰ má»¥c gom nhÃ³m cá»§a InnoDB thá»±c táº¿ lÃ  lÆ°u trá»¯ cÃ¹ng má»™t cáº¥u trÃºc B-tree cá»§a chá»‰ má»¥c vÃ  dÃ²ng dá»¯ liá»‡u.</p>
<p><strong>Chá»‰ má»¥c gom nhÃ³m Ä‘áº¡i diá»‡n cho viá»‡c lÆ°u trá»¯ dÃ²ng dá»¯ liá»‡u vÃ  cÃ¡c giÃ¡ trá»‹ khÃ³a liá»n ká», do Ä‘Ã³ truy cáº­p nhanh</strong>. VÃ¬ khÃ´ng thá»ƒ lÆ°u trá»¯ dÃ²ng dá»¯ liá»‡u trong hai vá»‹ trÃ­ khÃ¡c nhau cÃ¹ng má»™t lÃºc, nÃªn <strong>má»™t báº£ng chá»‰ cÃ³ thá»ƒ cÃ³ má»™t chá»‰ má»¥c gom nhÃ³m</strong>.</p>
<p>Náº¿u khÃ´ng xÃ¡c Ä‘á»‹nh khÃ³a chÃ­nh, InnoDB sáº½ tá»± Ä‘á»™ng xÃ¡c Ä‘á»‹nh má»™t khÃ³a chÃ­nh Ä‘á»ƒ sá»­ dá»¥ng lÃ m chá»‰ má»¥c gom nhÃ³m.</p>
<h4>Chá»‰ má»¥c che phá»§</h4>
<p>Chá»‰ má»¥c chá»©a táº¥t cáº£ cÃ¡c giÃ¡ trá»‹ cáº§n truy váº¥n.</p>
<p>CÃ³ cÃ¡c lá»£i Ã­ch sau:</p>
<ul>
<li>VÃ¬ cÃ¡c má»¥c chá»‰ má»¥c thÆ°á»ng nhá» hÆ¡n nhiá»u so vá»›i kÃ­ch thÆ°á»›c dÃ²ng dá»¯ liá»‡u, nÃªn chá»‰ Ä‘á»c chá»‰ má»¥c cÃ³ thá»ƒ giáº£m lÆ°á»£ng truy cáº­p dá»¯ liá»‡u.</li>
<li>Má»™t sá»‘ cÆ¡ sá»Ÿ dá»¯ liá»‡u (vÃ­ dá»¥: MyISAM) chá»‰ lÆ°u trá»¯ chá»‰ má»¥c trong bá»™ nhá»›, trong khi dá»¯ liá»‡u phá»¥ thuá»™c vÃ o há»‡ Ä‘iá»u hÃ nh Ä‘á»ƒ lÆ°u trá»¯. Do Ä‘Ã³, chá»‰ Ä‘á»c chá»‰ má»¥c cÃ³ thá»ƒ trÃ¡nh sá»­ dá»¥ng cuá»™c gá»i há»‡ thá»‘ng (thÆ°á»ng tá»‘n thá»i gian).</li>
<li>Äá»‘i vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u InnoDB, náº¿u chá»‰ má»¥c phá»¥ cÃ³ thá»ƒ che phá»§ truy váº¥n, khÃ´ng cáº§n truy cáº­p chá»‰ má»¥c chÃ­nh.</li>
</ul>
<h4>Sá»­ dá»¥ng quÃ©t chá»‰ má»¥c Ä‘á»ƒ sáº¯p xáº¿p</h4>
<p>MySQL cÃ³ hai cÃ¡ch Ä‘á»ƒ táº¡o káº¿t quáº£ sáº¯p xáº¿p: thÃ´ng qua hoáº¡t Ä‘á»™ng sáº¯p xáº¿p; hoáº·c quÃ©t chá»‰ má»¥c theo thá»© tá»±.</p>
<p><strong>Chá»‰ má»¥c tá»‘t lÃ  chá»‰ má»¥c cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ sáº¯p xáº¿p káº¿t quáº£</strong>. Äiá»u nÃ y cho phÃ©p sá»­ dá»¥ng chá»‰ má»¥c Ä‘á»ƒ sáº¯p xáº¿p thay vÃ¬ sáº¯p xáº¿p trá»±c tiáº¿p.</p>
<h4>NguyÃªn táº¯c phÃ¹ há»£p nháº¥t bÃªn trÃ¡i</h4>
<p>MySQL sáº½ tiáº¿p tá»¥c khá»›p vá» bÃªn pháº£i cho Ä‘áº¿n khi gáº·p cÃ¡c truy váº¥n pháº¡m vi <code>(&gt;, &lt;, BETWEEN, LIKE)</code>.</p>
<ul>
<li>Chá»‰ má»¥c cÃ³ thá»ƒ Ä‘Æ¡n giáº£n nhÆ° má»™t cá»™t (a), hoáº·c phá»©c táº¡p nhÆ° nhiá»u cá»™t (a, b, c, d), Ä‘Æ°á»£c gá»i lÃ  chá»‰ má»¥c káº¿t há»£p.</li>
<li>Náº¿u lÃ  chá»‰ má»¥c káº¿t há»£p, thÃ¬ khÃ³a cÅ©ng bao gá»“m nhiá»u cá»™t. Äá»“ng thá»i, chá»‰ cÃ³ thá»ƒ sá»­ dá»¥ng chá»‰ má»¥c Ä‘á»ƒ kiá»ƒm tra xem khÃ³a cÃ³ tá»“n táº¡i hay khÃ´ng (tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i báº±ng nhau), vÃ  khÃ´ng thá»ƒ khá»›p vá»›i cÃ¡c truy váº¥n pháº¡m vi (&gt;, &lt;, between, like).</li>
<li>Do Ä‘Ã³, <strong>thá»© tá»± cá»™t quyáº¿t Ä‘á»‹nh sá»‘ lÆ°á»£ng cá»™t chá»‰ má»¥c cÃ³ thá»ƒ khá»›p</strong>.</li>
</ul>
<p>VÃ­ dá»¥:</p>
<ul>
<li>Náº¿u cÃ³ chá»‰ má»¥c (a, b, c, d) vÃ  Ä‘iá»u kiá»‡n truy váº¥n lÃ  a = 1 vÃ  b = 2 vÃ  c &gt; 3 vÃ  d = 4, thÃ¬ chá»‰ cÃ³ thá»ƒ khá»›p vá»›i a, b, c vÃ  khÃ´ng thá»ƒ khá»›p vá»›i d. (ÄÆ¡n giáº£n: chá»‰ cÃ³ thá»ƒ khá»›p vá»›i cÃ¡c trÆ°á»ng há»£p <strong>báº±ng nhau</strong>, khÃ´ng thá»ƒ khá»›p vá»›i pháº¡m vi)</li>
</ul>
<h3>RÃ ng buá»™c</h3>
<p>CÃ³ nhá»¯ng rÃ ng buá»™c nÃ o trong cÆ¡ sá»Ÿ dá»¯ liá»‡u:</p>
<ul>
<li><code>NOT NULL</code> - ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘áº£m báº£o ráº±ng ná»™i dung cá»§a trÆ°á»ng khÃ´ng thá»ƒ lÃ  giÃ¡ trá»‹ rá»—ng (NULL).</li>
<li><code>UNIQUE</code> - Ná»™i dung cá»§a trÆ°á»ng khÃ´ng Ä‘Æ°á»£c láº·p láº¡i, má»™t báº£ng cÃ³ thá»ƒ cÃ³ nhiá»u rÃ ng buá»™c <code>UNIQUE</code>.</li>
<li><code>PRIMARY KEY</code> - Káº¿t há»£p cÃ¡c cá»™t hoáº·c thuá»™c tÃ­nh trong báº£ng dá»¯ liá»‡u Ä‘á»ƒ Ä‘á»‹nh danh duy nháº¥t vÃ  hoÃ n chá»‰nh cho cÃ¡c Ä‘á»‘i tÆ°á»£ng dá»¯ liá»‡u. Má»™t báº£ng chá»‰ Ä‘Æ°á»£c phÃ©p cÃ³ má»™t khÃ³a chÃ­nh. GiÃ¡ trá»‹ cá»§a khÃ³a chÃ­nh khÃ´ng thá»ƒ lÃ  giÃ¡ trá»‹ rá»—ng (NULL).</li>
<li><code>FOREIGN KEY</code> - KhÃ³a ngoáº¡i trong má»™t báº£ng lÃ  khÃ³a chÃ­nh cá»§a má»™t báº£ng khÃ¡c. NÃ³ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ ngÄƒn cháº·n cÃ¡c hÃ nh Ä‘á»™ng phÃ¡ vá»¡ káº¿t ná»‘i giá»¯a cÃ¡c báº£ng vÃ  ngÄƒn cháº·n viá»‡c chÃ¨n dá»¯ liá»‡u khÃ´ng há»£p lá»‡ vÃ o cá»™t khÃ³a ngoáº¡i, vÃ¬ nÃ³ pháº£i lÃ  má»™t trong cÃ¡c giÃ¡ trá»‹ trong báº£ng Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh.</li>
<li><code>CHECK</code> - Sá»­ dá»¥ng Ä‘á»ƒ kiá»ƒm soÃ¡t pháº¡m vi giÃ¡ trá»‹ cá»§a trÆ°á»ng.</li>
</ul>
<h2>Kiá»ƒm soÃ¡t Ä‘á»“ng thá»i</h2>
<h3>KhÃ³a láº¡c quan vÃ  khÃ³a bi quan</h3>
<blockquote>
<ul>
<li>KhÃ³a láº¡c quan vÃ  khÃ³a bi quan trong cÆ¡ sá»Ÿ dá»¯ liá»‡u lÃ  gÃ¬?</li>
<li>LÃ m tháº¿ nÃ o Ä‘á»ƒ thá»±c hiá»‡n khÃ³a láº¡c quan vÃ  khÃ³a bi quan trong cÆ¡ sá»Ÿ dá»¯ liá»‡u?</li>
</ul>
</blockquote>
<p>Äá»ƒ Ä‘áº£m báº£o khÃ´ng xáº£y ra xung Ä‘á»™t khi nhiá»u giao dá»‹ch truy cáº­p cÃ¹ng má»™t dá»¯ liá»‡u trong cÆ¡ sá»Ÿ dá»¯ liá»‡u vÃ  Ä‘áº£m báº£o tÃ­nh nháº¥t quÃ¡n cá»§a giao dá»‹ch, <strong>khÃ³a láº¡c quan vÃ  khÃ³a bi quan lÃ  cÃ¡c ká»¹ thuáº­t chÃ­nh Ä‘Æ°á»£c sá»­ dá»¥ng trong kiá»ƒm soÃ¡t Ä‘á»“ng thá»i</strong>.</p>
<ul>
<li><strong>KhÃ³a bi quan</strong> - Giáº£ Ä‘á»‹nh ráº±ng xung Ä‘á»™t sáº½ xáº£y ra vÃ  ngÄƒn cháº·n má»i hoáº¡t Ä‘á»™ng cÃ³ thá»ƒ vi pháº¡m tÃ­nh toÃ n váº¹n dá»¯ liá»‡u.
<ul>
<li><strong>KhÃ³a ghi trÆ°á»›c khi truy váº¥n dá»¯ liá»‡u vÃ  giá»¯ khÃ³a cho Ä‘áº¿n khi giao dá»‹ch Ä‘Æ°á»£c ghi (COMMIT)</strong>.</li>
<li>CÃ¡ch thá»±c hiá»‡n: Sá»­ dá»¥ng cÆ¡ cháº¿ khÃ³a trong cÆ¡ sá»Ÿ dá»¯ liá»‡u.</li>
</ul>
</li>
<li><strong>KhÃ³a láº¡c quan</strong> - Giáº£ Ä‘á»‹nh ráº±ng khÃ´ng cÃ³ xung Ä‘á»™t vÃ  chá»‰ kiá»ƒm tra tÃ­nh toÃ n váº¹n dá»¯ liá»‡u khi thá»±c hiá»‡n thao tÃ¡c ghi.
<ul>
<li><strong>KhÃ³a khi thay Ä‘á»•i dá»¯ liá»‡u vÃ  kiá»ƒm tra xem cÃ³ vi pháº¡m tÃ­nh toÃ n váº¹n dá»¯ liá»‡u khi ghi (COMMIT)</strong>.</li>
<li>CÃ¡ch thá»±c hiá»‡n: Sá»­ dá»¥ng phiÃªn báº£n hoáº·c dáº¥u thá»i gian.</li>
</ul>
</li>
</ul>
<h3>KhÃ³a hÃ ng vÃ  khÃ³a báº£ng</h3>
<blockquote>
<ul>
<li>KhÃ³a hÃ ng vÃ  khÃ³a báº£ng lÃ  gÃ¬?</li>
<li>Khi nÃ o sá»­ dá»¥ng khÃ³a hÃ ng? Khi nÃ o sá»­ dá»¥ng khÃ³a báº£ng?</li>
</ul>
</blockquote>
<p>Tá»« quan Ä‘iá»ƒm vá» má»©c Ä‘á»™ chi tiáº¿t cá»§a khÃ³a, MySQL cung cáº¥p hai cáº¥p Ä‘á»™ khÃ³a: khÃ³a hÃ ng vÃ  khÃ³a báº£ng.</p>
<ul>
<li><strong>KhÃ³a báº£ng (table lock)</strong> - KhÃ³a toÃ n bá»™ báº£ng. TrÆ°á»›c khi ngÆ°á»i dÃ¹ng thá»±c hiá»‡n thao tÃ¡c ghi trÃªn báº£ng, há» pháº£i láº¥y khÃ³a ghi trÆ°á»›c, Ä‘iá»u nÃ y sáº½ cháº·n táº¥t cáº£ cÃ¡c hoáº¡t Ä‘á»™ng Ä‘á»c vÃ  ghi cá»§a ngÆ°á»i dÃ¹ng khÃ¡c trÃªn báº£ng Ä‘Ã³. Chá»‰ khi khÃ´ng cÃ³ khÃ³a ghi, ngÆ°á»i dÃ¹ng khÃ¡c má»›i cÃ³ thá»ƒ láº¥y khÃ³a Ä‘á»c, cÃ¡c khÃ³a Ä‘á»c khÃ´ng tÆ°Æ¡ng tÃ¡c láº«n nhau.</li>
<li><strong>KhÃ³a hÃ ng (row lock)</strong> - Chá»‰ khÃ³a cÃ¡c báº£n ghi hÃ ng cá»¥ thá»ƒ, Ä‘iá»u nÃ y cho phÃ©p cÃ¡c quÃ¡ trÃ¬nh khÃ¡c váº«n cÃ³ thá»ƒ thao tÃ¡c trÃªn cÃ¡c báº£n ghi khÃ¡c trong cÃ¹ng má»™t báº£ng.</li>
</ul>
<p>Hai yáº¿u tá»‘ cáº§n cÃ¢n nháº¯c:</p>
<ul>
<li><strong>LÆ°á»£ng dá»¯ liá»‡u bá»‹ khÃ³a cÃ ng nhá», táº§n suáº¥t cáº¡nh tranh khÃ³a cÃ ng Ã­t vÃ  má»©c Ä‘á»™ Ä‘á»“ng thá»i cá»§a há»‡ thá»‘ng cÃ ng cao</strong>.</li>
<li><strong>Äá»™ chi tiáº¿t cá»§a khÃ³a cÃ ng nhá» thÃ¬ chi phÃ­ hoáº¡t Ä‘á»™ng cá»§a há»‡ thá»‘ng cÃ ng lá»›n</strong>&nbsp;.</li>
</ul>
<p>Trong <code>InnoDB</code>, khÃ³a hÃ ng Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng cÃ¡ch khÃ³a cÃ¡c má»¥c chá»‰ má»¥c trÃªn chá»‰ má»¥c. <strong>Náº¿u khÃ´ng cÃ³ chá»‰ má»¥c, <code>InnoDB</code> sáº½ khÃ³a báº£n ghi thÃ´ng qua chá»‰ má»¥c gom nhÃ³m áº©n.</strong></p>
<h3>KhÃ³a Ä‘á»c vÃ  khÃ³a ghi</h3>
<blockquote>
<ul>
<li>KhÃ³a Ä‘á»c vÃ  khÃ³a ghi lÃ  gÃ¬?</li>
</ul>
</blockquote>
<ul>
<li>KhÃ³a ghi (Exclusive Lock), viáº¿t táº¯t lÃ  X Lock, cÃ²n Ä‘Æ°á»£c gá»i lÃ  khÃ³a viáº¿t. CÃ¡ch sá»­ dá»¥ng: <code>SELECT â€¦ FOR UPDATE;</code></li>
<li>KhÃ³a Ä‘á»c (Shared Lock), viáº¿t táº¯t lÃ  S Lock, cÃ²n Ä‘Æ°á»£c gá»i lÃ  khÃ³a Ä‘á»c. CÃ¡ch sá»­ dá»¥ng: <code>SELECT â€¦ LOCK IN SHARE MODE;</code></li>
</ul>
<p>Má»‘i quan há»‡ giá»¯a khÃ³a ghi vÃ  khÃ³a Ä‘á»c, nÃ³i má»™t cÃ¡ch Ä‘Æ¡n giáº£n: <strong>Khi cÃ³ khÃ³a ghi, cÃ¡c giao dá»‹ch khÃ¡c khÃ´ng thá»ƒ thá»±c hiá»‡n báº¥t ká»³ hoáº¡t Ä‘á»™ng nÃ o</strong>.</p>
<p><strong>Trong <code>InnoDB</code>, khÃ³a hÃ ng, khÃ³a khoáº£ng trá»‘ng vÃ  khÃ³a next-key Ä‘á»u thuá»™c loáº¡i khÃ³a ghi</strong>.</p>
<h3>KhÃ³a Ã½ chÃ­</h3>
<blockquote>
<ul>
<li>KhÃ³a Ã½ chÃ­ lÃ  gÃ¬?</li>
<li>KhÃ³a Ã½ chÃ­ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ lÃ m gÃ¬?</li>
</ul>
</blockquote>
<p>KhÃ³a Ã½ chÃ­ (Intention Lock) Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ há»— trá»£ viá»‡c khÃ³a hÃ ng vÃ  khÃ³a báº£ng Ä‘á»“ng thá»i khi cáº§n thiáº¿t. Sá»­ dá»¥ng khÃ³a Ã½ chÃ­ (Intention Lock) giÃºp dá»… dÃ ng hÆ¡n trong viá»‡c há»— trá»£ nhiá»u cáº¥p Ä‘á»™ khÃ³a.</p>
<p><strong>KhÃ³a Ã½ chÃ­ Ä‘Æ°á»£c <code>InnoDB</code> tá»± Ä‘á»™ng thÃªm vÃ o, khÃ´ng cáº§n sá»± can thiá»‡p cá»§a ngÆ°á»i dÃ¹ng</strong>.</p>
<h3>MVCC</h3>
<blockquote>
<p>MVCC lÃ  gÃ¬?</p>
<p>MVCC Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ lÃ m gÃ¬? Giáº£i quyáº¿t váº¥n Ä‘á» gÃ¬?</p>
<p>NguyÃªn táº¯c cá»§a MVCC lÃ  gÃ¬?</p>
</blockquote>
<p>Kiá»ƒm soÃ¡t Ä‘á»“ng thá»i nhiá»u phiÃªn báº£n (Multi-Version Concurrency Control, MVCC) lÃ  má»™t cÃ¡ch cá»¥ thá»ƒ mÃ  <code>InnoDB</code> sá»­ dá»¥ng Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c cáº¥p Ä‘á»™ cÃ´ láº­p, bao gá»“m Ä‘á»c Ä‘Ã£ xÃ¡c nháº­n vÃ  Ä‘á»c láº·p láº¡i. Äá»“ng thá»i, nÃ³ giáº£i quyáº¿t váº¥n Ä‘á» Ä‘á»c báº©n vÃ  Ä‘á»c khÃ´ng láº·p láº¡i.</p>
<p>NguyÃªn táº¯c cá»§a MVCC lÃ :</p>
<ul>
<li>LÆ°u trá»¯ báº£n chá»¥p cá»§a dá»¯ liá»‡u táº¡i má»™t thá»i Ä‘iá»ƒm nháº¥t Ä‘á»‹nh. <strong>CÃ¡c hoáº¡t Ä‘á»™ng ghi (DELETE, INSERT, UPDATE) cáº­p nháº­t báº£n chá»¥p phiÃªn báº£n má»›i nháº¥t, trong khi cÃ¡c hoáº¡t Ä‘á»™ng Ä‘á»c láº¥y báº£n chá»¥p phiÃªn báº£n cÅ©, khÃ´ng cÃ³ sá»± tÆ°Æ¡ng tÃ¡c</strong>. Äiá»u nÃ y tÆ°Æ¡ng tá»± nhÆ° cÆ¡ cháº¿ CopyOnWrite.</li>
<li>Äá»c báº©n vÃ  Ä‘á»c khÃ´ng láº·p láº¡i lÃ  do giao dá»‹ch Ä‘á»c dá»¯ liá»‡u chÆ°a Ä‘Æ°á»£c xÃ¡c nháº­n tá»« cÃ¡c giao dá»‹ch khÃ¡c. Äá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y, <strong>MVCC quy Ä‘á»‹nh chá»‰ cÃ³ thá»ƒ Ä‘á»c cÃ¡c báº£n chá»¥p Ä‘Ã£ xÃ¡c nháº­n</strong>. Má»™t giao dá»‹ch cÃ³ thá»ƒ Ä‘á»c báº£n chá»¥p chÆ°a xÃ¡c nháº­n cá»§a chÃ­nh nÃ³, Ä‘iá»u nÃ y khÃ´ng Ä‘Æ°á»£c coi lÃ  Ä‘á»c báº©n.</li>
</ul>
<h3>KhÃ³a Next-key</h3>
<p>KhÃ³a Next-key (Next-Key Lock) lÃ  má»™t cÃ¡ch thá»©c khÃ³a Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi <code>InnoDB</code> trong viá»‡c triá»ƒn khai khÃ³a.</p>
<p>MVCC khÃ´ng thá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» Ä‘á»c khÃ´ng Ä‘á»“ng nháº¥t, <strong>khÃ³a Next-key Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ giáº£i quyáº¿t váº¥n Ä‘á» Ä‘á»c khÃ´ng Ä‘á»“ng nháº¥t</strong>. Trong cáº¥p Ä‘á»™ cÃ´ láº­p Ä‘á»c láº·p láº¡i (REPEATABLE READ), sá»­ dá»¥ng <code>MVCC + Next-Key Lock</code> cÃ³ thá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» Ä‘á»c khÃ´ng Ä‘á»“ng nháº¥t.</p>
<p>NgoÃ i ra, dá»±a trÃªn Ä‘iá»u kiá»‡n truy váº¥n SQL khÃ¡c nhau, cÅ©ng cÃ³ ba trÆ°á»ng há»£p khÃ³a cáº§n chÃº Ã½.</p>
<ul>
<li>KhÃ³a báº£n ghi (<code>Record Lock</code>) - <strong>KhÃ³a cÃ¡c má»¥c chá»‰ má»¥c trÃªn báº£n ghi, náº¿u khÃ´ng cÃ³ chá»‰ má»¥c, sá»­ dá»¥ng khÃ³a báº£ng</strong>.</li>
<li>KhÃ³a khoáº£ng trá»‘ng (<code>Gap Lock</code>) - KhÃ³a khoáº£ng trá»‘ng giá»¯a cÃ¡c má»¥c chá»‰ má»¥c. KhÃ³a cÃ¡c khoáº£ng trá»‘ng giá»¯a cÃ¡c má»¥c chá»‰ má»¥c, nhÆ°ng khÃ´ng bao gá»“m má»¥c chá»‰ má»¥c chÃ­nh nÃ³. VÃ­ dá»¥, khi má»™t giao dá»‹ch thá»±c hiá»‡n cÃ¢u lá»‡nh sau, cÃ¡c giao dá»‹ch khÃ¡c khÃ´ng thá»ƒ chÃ¨n giÃ¡ trá»‹ 15 vÃ o cá»™t c trong báº£ng t. <code>SELECT c FROM t WHERE c BETWEEN 10 and 20 FOR UPDATE;</code></li>
<li>KhÃ³a Next-key (<code>Next-Key Lock</code>) - Káº¿t há»£p giá»¯a <code>Record Lock</code> vÃ  <code>Gap Lock</code>, khÃ³a káº¿t há»£p giá»¯a khÃ³a báº£n ghi trÃªn má»™t khoáº£ng trá»‘ng. NÃ³ khÃ³a má»™t khoáº£ng trá»‘ng má»Ÿ phÃ­a trÆ°á»›c vÃ  Ä‘Ã³ng phÃ­a sau.</li>
</ul>
<p>Chá»‰ má»¥c Ä‘Æ°á»£c chia thÃ nh hai loáº¡i: chá»‰ má»¥c khÃ³a chÃ­nh (primary key index) vÃ  chá»‰ má»¥c khÃ´ng pháº£i khÃ³a chÃ­nh (non-primary key index). Náº¿u má»™t cÃ¢u lá»‡nh SQL thao tÃ¡c trÃªn chá»‰ má»¥c khÃ³a chÃ­nh, MySQL sáº½ khÃ³a chá»‰ má»¥c khÃ³a chÃ­nh Ä‘Ã³. Náº¿u má»™t cÃ¢u lá»‡nh thao tÃ¡c trÃªn chá»‰ má»¥c khÃ´ng pháº£i khÃ³a chÃ­nh, MySQL sáº½ khÃ³a chá»‰ má»¥c khÃ´ng pháº£i khÃ³a chÃ­nh Ä‘Ã³ trÆ°á»›c, sau Ä‘Ã³ khÃ³a chá»‰ má»¥c khÃ³a chÃ­nh liÃªn quan. Trong cÃ¡c hoáº¡t Ä‘á»™ng <code>UPDATE</code> vÃ  <code>DELETE</code>, MySQL khÃ´ng chá»‰ khÃ³a táº¥t cáº£ cÃ¡c báº£n ghi chá»‰ má»¥c Ä‘Æ°á»£c quÃ©t bá»Ÿi Ä‘iá»u kiá»‡n <code>WHERE</code>, mÃ  cÃ²n khÃ³a cÃ¡c giÃ¡ trá»‹ khÃ³a liá»n ká», cÃ²n Ä‘Æ°á»£c gá»i lÃ  khÃ³a káº¿ tiáº¿p (next-key lock).</p>
<p>Khi hai giao dá»‹ch Ä‘Æ°á»£c thá»±c hiá»‡n cÃ¹ng má»™t lÃºc, má»™t giao dá»‹ch khÃ³a chá»‰ má»¥c khÃ³a chÃ­nh vÃ  Ä‘á»£i cÃ¡c chá»‰ má»¥c liÃªn quan. Giao dá»‹ch khÃ¡c khÃ³a chá»‰ má»¥c khÃ´ng pháº£i khÃ³a chÃ­nh vÃ  Ä‘á»£i chá»‰ má»¥c khÃ³a chÃ­nh. Äiá»u nÃ y dáº«n Ä‘áº¿n tÃ¬nh tráº¡ng xáº£y ra deadlock. Sau khi xáº£y ra deadlock, <code>InnoDB</code> thÆ°á»ng cÃ³ thá»ƒ phÃ¡t hiá»‡n vÃ  giáº£i phÃ³ng khÃ³a cá»§a má»™t giao dá»‹ch Ä‘á»ƒ quay trá»Ÿ láº¡i tráº¡ng thÃ¡i ban Ä‘áº§u, cho phÃ©p giao dá»‹ch khÃ¡c láº¥y khÃ³a vÃ  hoÃ n thÃ nh giao dá»‹ch.</p>
<h2>Giao dá»‹ch</h2>
<blockquote>
<p>Giao dá»‹ch Ä‘Æ¡n giáº£n lÃ  táº¥t cáº£ cÃ¡c hoáº¡t Ä‘á»™ng Ä‘Æ°á»£c thá»±c hiá»‡n trong má»™t phiÃªn lÃ m viá»‡c (session) pháº£i cÃ¹ng thÃ nh cÃ´ng hoáº·c cÃ¹ng tháº¥t báº¡i. Cá»¥ thá»ƒ, giao dá»‹ch lÃ  má»™t táº­p há»£p cÃ¡c hoáº¡t Ä‘á»™ng thá»a mÃ£n cÃ¡c Ä‘áº·c Ä‘iá»ƒm ACID, cÃ³ thá»ƒ Ä‘Æ°á»£c gá»­i Ä‘i báº±ng cÃ¡ch sá»­ dá»¥ng&nbsp;<code>Commit</code>&nbsp;Ä‘á»ƒ xÃ¡c nháº­n giao dá»‹ch hoáº·c sá»­ dá»¥ng&nbsp;<code>Rollback</code>&nbsp;Ä‘á»ƒ hoÃ n tÃ¡c.</p>
</blockquote>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/185b9c49-4c13-4241-a848-fbff85c03a64.png" alt="185b9c49-4c13-4241-a848-fbff85c03a64.png" tabindex="0" loading="lazy"><figcaption>185b9c49-4c13-4241-a848-fbff85c03a64.png</figcaption></figure>
<h3>ACID</h3>
<p>ACID - Bá»‘n yáº¿u tá»‘ cÆ¡ báº£n Ä‘á»ƒ thá»±c hiá»‡n giao dá»‹ch cÆ¡ sá»Ÿ dá»¯ liá»‡u má»™t cÃ¡ch chÃ­nh xÃ¡c:</p>
<ul>
<li><strong>TÃ­nh nguyÃªn tá»­ (Atomicity)</strong></li>
<li><strong>TÃ­nh nháº¥t quÃ¡n (Consistency)</strong></li>
<li><strong>TÃ­nh cÃ´ láº­p (Isolation)</strong></li>
<li><strong>TÃ­nh bá»n vá»¯ng (Durability)</strong></li>
</ul>
<p><strong>Há»‡ thá»‘ng cÆ¡ sá»Ÿ dá»¯ liá»‡u há»— trá»£ giao dá»‹ch pháº£i cÃ³ bá»‘n tÃ­nh cháº¥t nÃ y, náº¿u khÃ´ng, khÃ´ng thá»ƒ Ä‘áº£m báº£o tÃ­nh chÃ­nh xÃ¡c cá»§a dá»¯ liá»‡u trong quÃ¡ trÃ¬nh giao dá»‹ch.</strong></p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/acid.png" alt="acid.png" tabindex="0" loading="lazy"><figcaption>acid.png</figcaption></figure>
<h3>Váº¥n Ä‘á» nháº¥t quÃ¡n trong mÃ´i trÆ°á»ng Ä‘á»“ng thá»i</h3>
<p>Trong mÃ´i trÆ°á»ng Ä‘á»“ng thá»i, ráº¥t khÃ³ Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh cÃ´ láº­p cá»§a giao dá»‹ch, do Ä‘Ã³ cÃ³ nhiá»u váº¥n Ä‘á» vá» nháº¥t quÃ¡n trong mÃ´i trÆ°á»ng Ä‘á»“ng thá»i.</p>
<ul>
<li><strong>Máº¥t mÃ¡t thay Ä‘á»•i</strong></li>
</ul>
<p>Hai giao dá»‹ch T1&nbsp;vÃ  T2&nbsp;cÃ¹ng sá»­a Ä‘á»•i má»™t dá»¯ liá»‡u, T1&nbsp;sá»­a Ä‘á»•i trÆ°á»›c, T2&nbsp;sá»­a Ä‘á»•i sau, sá»­a Ä‘á»•i cá»§a T2&nbsp;ghi Ä‘Ã¨ lÃªn sá»­a Ä‘á»•i cá»§a T1.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230721002023.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure>
<ul>
<li><strong>Äá»c dá»¯ liá»‡u báº©n (dirty read)</strong></li>
</ul>
<p>T1&nbsp;sá»­a Ä‘á»•i má»™t dá»¯ liá»‡u, T2&nbsp;Ä‘á»c dá»¯ liá»‡u nÃ y sau Ä‘Ã³. Náº¿u T1&nbsp;há»§y bá» sá»­a Ä‘á»•i nÃ y, dá»¯ liá»‡u mÃ  T2&nbsp;Ä‘á»c lÃ  dá»¯ liá»‡u báº©n.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/202307210021321.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure>
<ul>
<li><strong>Äá»c khÃ´ng nháº¥t quÃ¡n (un-repeatable read)</strong></li>
</ul>
<p>T2&nbsp;Ä‘á»c má»™t dá»¯ liá»‡u, T1&nbsp;sá»­a Ä‘á»•i dá»¯ liá»‡u nÃ y. Náº¿u T2&nbsp;Ä‘á»c láº¡i dá»¯ liá»‡u nÃ y, káº¿t quáº£ Ä‘á»c sáº½ khÃ¡c vá»›i láº§n Ä‘á»c trÆ°á»›c.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230721002326.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure>
<ul>
<li><strong>Äá»c dá»¯ liá»‡u áº£o (phantom read)</strong></li>
</ul>
<p>T1&nbsp;Ä‘á»c má»™t pháº¡m vi dá»¯ liá»‡u, T2&nbsp;chÃ¨n dá»¯ liá»‡u má»›i vÃ o pháº¡m vi nÃ y, T1&nbsp;Ä‘á»c láº¡i pháº¡m vi dá»¯ liá»‡u nÃ y, káº¿t quáº£ Ä‘á»c sáº½ khÃ¡c vá»›i láº§n Ä‘á»c trÆ°á»›c.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230721002333.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure>
<p>Giáº£i phÃ¡p cho váº¥n Ä‘á» nháº¥t quÃ¡n trong mÃ´i trÆ°á»ng Ä‘á»“ng thá»i:</p>
<p>Váº¥n Ä‘á» nháº¥t quÃ¡n trong mÃ´i trÆ°á»ng Ä‘á»“ng thá»i chá»§ yáº¿u xuáº¥t phÃ¡t tá»« viá»‡c vi pháº¡m tÃ­nh cÃ´ láº­p cá»§a giao dá»‹ch. Giáº£i phÃ¡p lÃ  sá»­ dá»¥ng kiá»ƒm soÃ¡t Ä‘á»“ng thá»i Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh cÃ´ láº­p.</p>
<p>Kiá»ƒm soÃ¡t Ä‘á»“ng thá»i cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng cÃ¡ch sá»­ dá»¥ng khÃ³a, nhÆ°ng thao tÃ¡c khÃ³a phá»©c táº¡p vÃ  phá»¥ thuá»™c vÃ o ngÆ°á»i dÃ¹ng tá»± Ä‘iá»u khiá»ƒn. Há»‡ quáº£n trá»‹ cÆ¡ sá»Ÿ dá»¯ liá»‡u cung cáº¥p cÃ¡c cáº¥p Ä‘á»™ cÃ´ láº­p giao dá»‹ch Ä‘á»ƒ ngÆ°á»i dÃ¹ng xá»­ lÃ½ váº¥n Ä‘á» nháº¥t quÃ¡n trong mÃ´i trÆ°á»ng Ä‘á»“ng thá»i má»™t cÃ¡ch dá»… dÃ ng hÆ¡n.</p>
<h3>Má»©c Ä‘á»™ cá»™ lÃ¢p (Isolation Level)</h3>
<p>Cáº¥p Ä‘á»™ cÃ´ láº­p cÆ¡ sá»Ÿ dá»¯ liá»‡u:</p>
<ul>
<li><strong><code>Äá»c chÆ°a cam káº¿t</code>&nbsp;(READ UNCOMMITTED)</strong>&nbsp;- CÃ¡c sá»­a Ä‘á»•i trong giao dá»‹ch, ngay cáº£ khi chÆ°a Ä‘Æ°á»£c xÃ¡c nháº­n, cÅ©ng cÃ³ thá»ƒ nhÃ¬n tháº¥y bá»Ÿi cÃ¡c giao dá»‹ch khÃ¡c.</li>
<li><strong><code>Äá»c Ä‘Ã£ cam káº¿t</code>&nbsp;(READ COMMITTED)</strong>&nbsp;- Má»™t giao dá»‹ch chá»‰ cÃ³ thá»ƒ Ä‘á»c cÃ¡c sá»­a Ä‘á»•i Ä‘Ã£ Ä‘Æ°á»£c xÃ¡c nháº­n cá»§a cÃ¡c giao dá»‹ch khÃ¡c. NghÄ©a lÃ  cÃ¡c sá»­a Ä‘á»•i cá»§a má»™t giao dá»‹ch trong quÃ¡ trÃ¬nh thá»±c hiá»‡n chÆ°a Ä‘Æ°á»£c nhÃ¬n tháº¥y bá»Ÿi cÃ¡c giao dá»‹ch khÃ¡c.</li>
<li><strong><code>Äá»c láº·p láº¡i</code>&nbsp;(REPEATABLE READ)</strong>&nbsp;- Äáº£m báº£o káº¿t quáº£ Ä‘á»c cá»§a cÃ¹ng má»™t dá»¯ liá»‡u trong má»™t giao dá»‹ch lÃ  nhÆ° nhau.</li>
<li><strong><code>Tuáº§n tá»± hoÃ¡</code>&nbsp;(SERIALIZABLE)</strong>&nbsp;- Buá»™c cÃ¡c giao dá»‹ch thá»±c hiá»‡n tuáº§n tá»±.</li>
</ul>
<p>Cáº¥p Ä‘á»™ cÃ´ láº­p giáº£i quyáº¿t cÃ¡c váº¥n Ä‘á» nháº¥t quÃ¡n:</p>
<table>
<thead>
<tr>
<th style="text-align:center">Cáº¥p Ä‘á»™ cÃ´ láº­p</th>
<th style="text-align:center">Äá»c báº©n</th>
<th style="text-align:center">Äá»c khÃ´ng nháº¥t quÃ¡n</th>
<th style="text-align:center">Äá»c dá»¯ liá»‡u áº£o</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Äá»c chÆ°a cam káº¿t</td>
<td style="text-align:center">âŒ</td>
<td style="text-align:center">âŒ</td>
<td style="text-align:center">âŒ</td>
</tr>
<tr>
<td style="text-align:center">ÄÃ£ Ä‘Ã£ cam káº¿t</td>
<td style="text-align:center">âœ”ï¸</td>
<td style="text-align:center">âŒ</td>
<td style="text-align:center">âŒ</td>
</tr>
<tr>
<td style="text-align:center">Äá»c láº·p láº¡i</td>
<td style="text-align:center">âœ”ï¸</td>
<td style="text-align:center">âœ”ï¸</td>
<td style="text-align:center">âŒ</td>
</tr>
<tr>
<td style="text-align:center">Tuáº§n tá»± hoÃ¡</td>
<td style="text-align:center">âœ”ï¸</td>
<td style="text-align:center">âœ”ï¸</td>
<td style="text-align:center">âœ”ï¸</td>
</tr>
</tbody>
</table>
<h3>Giao dá»‹ch phÃ¢n tÃ¡n</h3>
<p>Trong má»™t nÃºt dá»¯ liá»‡u duy nháº¥t, giao dá»‹ch chá»‰ giá»›i háº¡n trong viá»‡c kiá»ƒm soÃ¡t truy cáº­p vÃ o tÃ i nguyÃªn cÆ¡ sá»Ÿ dá»¯ liá»‡u duy nháº¥t, Ä‘Æ°á»£c gá»i lÃ &nbsp;<strong>giao dá»‹ch cá»¥c bá»™</strong>. Háº§u háº¿t cÃ¡c há»‡ quáº£n trá»‹ cÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡ Ä‘Ã£ Ä‘Æ°á»£c phÃ¡t triá»ƒn cung cáº¥p há»— trá»£ gá»‘c cho giao dá»‹ch cá»¥c bá»™.</p>
<p><strong>Giao dá»‹ch phÃ¢n tÃ¡n</strong>&nbsp;lÃ  khi cÃ¡c bÃªn tham gia giao dá»‹ch, mÃ¡y chá»§ há»— trá»£ giao dá»‹ch, mÃ¡y chá»§ tÃ i nguyÃªn vÃ  trÃ¬nh quáº£n lÃ½ giao dá»‹ch náº±m trÃªn cÃ¡c nÃºt khÃ¡c nhau cá»§a há»‡ thá»‘ng phÃ¢n tÃ¡n.</p>
<h4>Cam káº¿t hai giai Ä‘oáº¡n</h4>
<p>Cam káº¿t hai giai Ä‘oáº¡n (XA) cÃ³ Ã­ch cho cÃ¡c giao dá»‹ch phÃ¢n tÃ¡n. Lá»£i tháº¿ lá»›n nháº¥t cá»§a nÃ³ lÃ  khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n ngÆ°á»i dÃ¹ng, ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ sá»­ dá»¥ng giao dá»‹ch phÃ¢n tÃ¡n dá»±a trÃªn giao thá»©c XA nhÆ° sá»­ dá»¥ng giao dá»‹ch cá»¥c bá»™. Giao thá»©c XA Ä‘áº£m báº£o tÃ­nh&nbsp;<code>ACID</code>&nbsp;cá»§a giao dá»‹ch.</p>
<p>Äáº£m báº£o tÃ­nh&nbsp;<code>ACID</code>&nbsp;cá»§a giao dá»‹ch lÃ  má»™t con dao hai lÆ°á»¡i. Trong quÃ¡ trÃ¬nh thá»±c hiá»‡n giao dá»‹ch, táº¥t cáº£ cÃ¡c tÃ i nguyÃªn cáº§n Ä‘Æ°á»£c khÃ³a, Ä‘iá»u nÃ y phÃ¹ há»£p vá»›i giao dá»‹ch ngáº¯n thá»i gian xÃ¡c Ä‘á»‹nh. Äá»‘i vá»›i giao dá»‹ch dÃ i, viá»‡c chiáº¿m giá»¯ tÃ i nguyÃªn trong suá»‘t quÃ¡ trÃ¬nh giao dá»‹ch sáº½ lÃ m giáº£m hiá»‡u suáº¥t Ä‘Ã¡ng ká»ƒ Ä‘á»‘i vá»›i há»‡ thá»‘ng kinh doanh phá»¥ thuá»™c vÃ o dá»¯ liá»‡u táº­p trung. Do Ä‘Ã³, trong cÃ¡c tÃ¬nh huá»‘ng nÆ¡i hiá»‡u suáº¥t Ä‘á»“ng thá»i lÃ  quan trá»ng nháº¥t, giao dá»‹ch phÃ¢n tÃ¡n dá»±a trÃªn giao thá»©c XA khÃ´ng pháº£i lÃ  lá»±a chá»n tá»‘t nháº¥t.</p>
<h4>Giao dá»‹ch má»m</h4>
<p>Náº¿u giao dá»‹ch thá»a mÃ£n cÃ¡c yáº¿u tá»‘&nbsp;<code>ACID</code>, nÃ³ Ä‘Æ°á»£c gá»i lÃ  giao dá»‹ch cá»©ng. Náº¿u giao dá»‹ch dá»±a trÃªn yáº¿u tá»‘&nbsp;<code>BASE</code>, nÃ³ Ä‘Æ°á»£c gá»i lÃ  giao dá»‹ch má»m.&nbsp;<code>BASE</code>&nbsp;lÃ  viáº¿t táº¯t cá»§a <strong>Basic Availability</strong>, <strong>Soft state</strong> vÃ  <strong>Eventual consistency</strong>.</p>
<ul>
<li>Basic Availability Ä‘áº£m báº£o cÃ¡c bÃªn tham gia giao dá»‹ch khÃ´ng cáº§n pháº£i cÃ¹ng online.</li>
<li>Soft state cho phÃ©p cáº­p nháº­t tráº¡ng thÃ¡i cá»§a há»‡ thá»‘ng cÃ³ má»™t Ä‘á»™ trá»… nháº¥t Ä‘á»‹nh, Ä‘á»™ trá»… nÃ y cÃ³ thá»ƒ khÃ´ng thá»ƒ nháº­n tháº¥y Ä‘Æ°á»£c bá»Ÿi khÃ¡ch hÃ ng.</li>
<li>Eventual consistency thÆ°á»ng Ä‘Æ°á»£c Ä‘áº£m báº£o báº±ng cÃ¡ch truyá»n tin nháº¯n Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh nháº¥t quÃ¡n cá»§a há»‡ thá»‘ng.</li>
</ul>
<p>Giao dá»‹ch má»m dá»±a trÃªn yáº¿u tá»‘&nbsp;<code>BASE</code>&nbsp;khÃ´ng pháº£i lÃ  giáº£i phÃ¡p tá»‘i Æ°u cho táº¥t cáº£ cÃ¡c tÃ¬nh huá»‘ng. Chá»‰ khi nÃ³ phÃ¹ há»£p nháº¥t vá»›i tÃ¬nh huá»‘ng cá»¥ thá»ƒ, giao dá»‹ch cá»©ng dá»±a trÃªn yáº¿u tá»‘&nbsp;<code>ACID</code>&nbsp;vÃ  giao dá»‹ch má»m dá»±a trÃªn yáº¿u tá»‘&nbsp;<code>BASE</code>&nbsp;má»›i cÃ³ thá»ƒ phÃ¡t huy tá»‘i Ä‘a Æ°u Ä‘iá»ƒm cá»§a chÃºng. Báº£ng dÆ°á»›i Ä‘Ã¢y so sÃ¡nh chi tiáº¿t giá»¯a cÃ¡c giáº£i phÃ¡p giao dá»‹ch.</p>
<h4>So sÃ¡nh cÃ¡c giáº£i phÃ¡p giao dá»‹ch</h4>
<p>||Giao dá»‹ch cá»¥c bá»™|Hai giai Ä‘oáº¡n giao dá»‹ch|Giao dá»‹ch má»m|<br>
|:</p>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/20230721113211.png" type="image/png"/>
    </item>
    <item>
      <title>SQL Overview</title>
      <link>https://vanhung4499.github.io/database/sql/overview.html</link>
      <guid>https://vanhung4499.github.io/database/sql/overview.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">SQL Overview</source>
      <description>SQL Overview Basic How SQL DB works SQL DB Theory SQL DB Concept SQL DB Design Process SQL Language SQL Syntax Foudation Features Extend SQL SQL Cheat Sheet Interview SQL DB Int...</description>
      <category>db</category>
      <category>sql</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>Basic</h2>
<ul>
<li><a href="how-sql-db-works">How SQL DB works</a></li>
<li><a href="theory">SQL DB Theory</a></li>
<li><a href="concept">SQL DB Concept</a></li>
<li><a href="db-design-process">SQL DB Design Process</a></li>
</ul>
<h2>SQL Language</h2>
<ul>
<li><a href="syntax-features">SQL Syntax Foudation Features</a></li>
<li><a href="extend-sql">Extend SQL</a></li>
<li><a href="cheat-sheet">SQL Cheat Sheet</a></li>
</ul>
<h2>Interview</h2>
<ul>
<li><a href="interview">SQL DB Interview</a></li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>SQL Syntax Foudation Features</title>
      <link>https://vanhung4499.github.io/database/sql/syntax-features.html</link>
      <guid>https://vanhung4499.github.io/database/sql/syntax-features.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">SQL Syntax Foudation Features</source>
      <description>CÃ¡c tÃ­nh nÄƒng cÆ¡ báº£n cá»§a cÃº phÃ¡p SQL BÃ i viáº¿t nÃ y táº­p trung vÃ o cÃº phÃ¡p cÆ¡ báº£n cá»§a ngÃ´n ngá»¯ truy váº¥n SQL cho cÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡. VÃ¬ giá»›i háº¡n bÃ i viáº¿t, chÃºng tÃ´i táº­p trung vÃ o...</description>
      <category>db</category>
      <category>sql</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>BÃ i viáº¿t nÃ y táº­p trung vÃ o cÃº phÃ¡p cÆ¡ báº£n cá»§a ngÃ´n ngá»¯ truy váº¥n SQL cho cÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡. VÃ¬ giá»›i háº¡n bÃ i viáº¿t, chÃºng tÃ´i táº­p trung vÃ o cÃ¡ch sá»­ dá»¥ng, khÃ´ng Ä‘i sÃ¢u vÃ o cÃ¡c tÃ­nh nÄƒng vÃ  nguyÃªn lÃ½.</p>
</blockquote>
<h2>Giá»›i thiá»‡u vá» SQL</h2>
<h3>Thuáº­t ngá»¯ cÆ¡ sá»Ÿ dá»¯ liá»‡u</h3>
<ul>
<li><code>CÆ¡ sá»Ÿ dá»¯ liá»‡u (database)</code> - LÃ  má»™t nÆ¡i lÆ°u trá»¯ dá»¯ liá»‡u cÃ³ tá»• chá»©c (thÆ°á»ng lÃ  má»™t táº­p tin hoáº·c má»™t nhÃ³m táº­p tin).</li>
<li><code>Báº£ng dá»¯ liá»‡u (table)</code> - LÃ  má»™t danh sÃ¡ch cÃ³ cáº¥u trÃºc cá»§a má»™t loáº¡i dá»¯ liá»‡u cá»¥ thá»ƒ.</li>
<li><code>MÃ´ hÃ¬nh (schema)</code> - LÃ  thÃ´ng tin vá» cÃ¡ch dá»¯ liá»‡u Ä‘Æ°á»£c tá»• chá»©c trong cÆ¡ sá»Ÿ dá»¯ liá»‡u vÃ  báº£ng. MÃ´ hÃ¬nh xÃ¡c Ä‘á»‹nh cÃ¡ch dá»¯ liá»‡u Ä‘Æ°á»£c lÆ°u trá»¯ trong báº£ng, bao gá»“m viá»‡c lÆ°u trá»¯ loáº¡i dá»¯ liá»‡u nÃ o, cÃ¡ch dá»¯ liá»‡u Ä‘Æ°á»£c phÃ¢n tÃ¡ch, cÃ¡ch Ä‘áº·t tÃªn thÃ´ng tin vÃ  nhiá»u thÃ´ng tin khÃ¡c. Cáº£ cÆ¡ sá»Ÿ dá»¯ liá»‡u vÃ  báº£ng Ä‘á»u cÃ³ mÃ´ hÃ¬nh.</li>
<li><code>Cá»™t (column)</code> - LÃ  má»™t trÆ°á»ng trong báº£ng. Táº¥t cáº£ cÃ¡c báº£ng Ä‘á»u Ä‘Æ°á»£c táº¡o thÃ nh tá»« má»™t hoáº·c nhiá»u cá»™t.</li>
<li><code>HÃ ng (row)</code> - LÃ  má»™t báº£n ghi trong báº£ng.</li>
<li><code>KhÃ³a chÃ­nh (primary key)</code> - LÃ  má»™t cá»™t (hoáº·c má»™t nhÃ³m cá»™t) cÃ³ giÃ¡ trá»‹ duy nháº¥t Ä‘á»ƒ xÃ¡c Ä‘á»‹nh má»—i hÃ ng trong báº£ng.</li>
</ul>
<h3>CÃº phÃ¡p SQL</h3>
<blockquote>
<p>SQL (Structured Query Language) lÃ  má»™t ngÃ´n ngá»¯ truy váº¥n cÃ³ tiÃªu chuáº©n do á»¦y ban TiÃªu chuáº©n ANSI quáº£n lÃ½, do Ä‘Ã³ Ä‘Æ°á»£c gá»i lÃ  ANSI SQL. Má»—i há»‡ quáº£n trá»‹ cÆ¡ sá»Ÿ dá»¯ liá»‡u (DBMS) cÃ³ cÃ i Ä‘áº·t riÃªng cá»§a nÃ³, cháº³ng háº¡n nhÆ° PL/SQL, Transact-SQL, v.v.</p>
</blockquote>
<h4>Cáº¥u trÃºc cÃº phÃ¡p SQL</h4>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/sql-syntax.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>
<p>Cáº¥u trÃºc cÃº phÃ¡p SQL bao gá»“m:</p>
<ul>
<li><strong><code>Má»‡nh Ä‘á» (clause)</code></strong> - LÃ  thÃ nh pháº§n cáº¥u thÃ nh cá»§a cÃ¢u lá»‡nh vÃ  truy váº¥n. (Trong má»™t sá»‘ trÆ°á»ng há»£p, chÃºng lÃ  tÃ¹y chá»n.)</li>
<li><strong><code>Biá»ƒu thá»©c (expression)</code></strong> - CÃ³ thá»ƒ táº¡o ra má»™t giÃ¡ trá»‹ cá»‘ Ä‘á»‹nh hoáº·c má»™t báº£ng dá»¯ liá»‡u tá»« cÃ¡c cá»™t vÃ  hÃ ng trong cÆ¡ sá»Ÿ dá»¯ liá»‡u.</li>
<li><strong><code>TiÃªn Ä‘á» (predicate)</code></strong> - XÃ¡c Ä‘á»‹nh Ä‘iá»u kiá»‡n logic ba giÃ¡ trá»‹ (true/false/unknown) hoáº·c giÃ¡ trá»‹ boolean Ä‘á»ƒ giá»›i háº¡n hiá»‡u quáº£ cá»§a cÃ¢u lá»‡nh vÃ  truy váº¥n, hoáº·c thay Ä‘á»•i luá»“ng chÆ°Æ¡ng trÃ¬nh.</li>
<li><strong><code>Truy váº¥n (query)</code></strong> - Truy xuáº¥t dá»¯ liá»‡u dá»±a trÃªn Ä‘iá»u kiá»‡n cá»¥ thá»ƒ. ÄÃ¢y lÃ  má»™t pháº§n quan trá»ng cá»§a SQL.</li>
<li><strong><code>CÃ¢u lá»‡nh (statement)</code></strong> - CÃ³ thá»ƒ áº£nh hÆ°á»Ÿng lÃ¢u dÃ i Ä‘áº¿n cáº¥u trÃºc vÃ  dá»¯ liá»‡u, hoáº·c Ä‘iá»u khiá»ƒn giao dá»‹ch cÆ¡ sá»Ÿ dá»¯ liá»‡u, luá»“ng chÆ°Æ¡ng trÃ¬nh, káº¿t ná»‘i, phiÃªn hoáº·c cháº©n Ä‘oÃ¡n.</li>
</ul>
<h4>Äiá»ƒm chÃ­nh cá»§a cÃº phÃ¡p SQL</h4>
<ul>
<li><strong>CÃ¢u lá»‡nh SQL khÃ´ng phÃ¢n biá»‡t chá»¯ hoa chá»¯ thÆ°á»ng</strong>, nhÆ°ng tÃªn báº£ng, tÃªn cá»™t vÃ  giÃ¡ trá»‹ cÃ³ thá»ƒ phÃ¢n biá»‡t tÃ¹y thuá»™c vÃ o DBMS cá»¥ thá»ƒ vÃ  cáº¥u hÃ¬nh.</li>
</ul>
<p>VÃ­ dá»¥: <code>SELECT</code> vÃ  <code>select</code>, <code>Select</code> lÃ  nhÆ° nhau.</p>
<ul>
<li><strong>Nhiá»u cÃ¢u lá»‡nh SQL pháº£i Ä‘Æ°á»£c phÃ¢n tÃ¡ch báº±ng dáº¥u cháº¥m pháº©y (<code>;</code>)</strong>.</li>
<li>Khi xá»­ lÃ½ cÃ¢u lá»‡nh SQL, <strong>táº¥t cáº£ cÃ¡c khoáº£ng tráº¯ng Ä‘á»u bá»‹ bá» qua</strong>. CÃ¢u lá»‡nh SQL cÃ³ thá»ƒ Ä‘Æ°á»£c viáº¿t trÃªn má»™t dÃ²ng hoáº·c Ä‘Æ°á»£c chia thÃ nh nhiá»u dÃ²ng.</li>
</ul>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- CÃ¢u lá»‡nh SQL trÃªn má»™t dÃ²ng</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">UPDATE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> user </span><span style="color:#C678DD;--shiki-dark:#C678DD">SET</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> username</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379">'robot'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#C678DD;--shiki-dark:#C678DD">password</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379">'robot'</span><span style="color:#C678DD;--shiki-dark:#C678DD"> WHERE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> username </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379"> 'root'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- CÃ¢u lá»‡nh SQL trÃªn nhiá»u dÃ²ng</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">UPDATE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> user</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">SET</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> username</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379">'robot'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#C678DD;--shiki-dark:#C678DD">password</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379">'robot'</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">WHERE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> username </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#98C379;--shiki-dark:#98C379"> 'root'</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span></code></pre>
</div><ul>
<li>SQL há»— trá»£ ba cÃ¡ch chÃº thÃ­ch</li>
</ul>
<div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">## ChÃº thÃ­ch </span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">-- ChÃº thÃ­ch 2</span></span>
<span class="line"><span style="color:#7F848E;--shiki-dark:#7F848E;font-style:italic;--shiki-dark-font-style:italic">/* ChÃº thÃ­ch 3 */</span></span></code></pre>
</div><h4>PhÃ¢n loáº¡i SQL</h4>
<h4>NgÃ´n ngá»¯ Ä‘á»‹nh nghÄ©a dá»¯ liá»‡u (DDL)</h4>
<p>NgÃ´n ngá»¯ Ä‘á»‹nh nghÄ©a dá»¯ liá»‡u (Data Definition Language, DDL) lÃ  má»™t táº­p há»£p cÃ¡c ngÃ´n ngá»¯ SQL chá»‹u trÃ¡ch nhiá»‡m Ä‘á»‹nh nghÄ©a cáº¥u trÃºc dá»¯ liá»‡u vÃ  Ä‘á»‘i tÆ°á»£ng cÆ¡ sá»Ÿ dá»¯ liá»‡u.</p>
<p>DDL cÃ³ chá»©c nÄƒng chÃ­nh lÃ  <strong>Ä‘á»‹nh nghÄ©a Ä‘á»‘i tÆ°á»£ng cÆ¡ sá»Ÿ dá»¯ liá»‡u</strong>.</p>
<p>CÃ¡c chá»‰ thá»‹ cá»‘t lÃµi cá»§a DDL lÃ  <code>CREATE</code>, <code>ALTER</code>, <code>DROP</code>.</p>
<h4>NgÃ´n ngá»¯ Ä‘iá»u khiá»ƒn dá»¯ liá»‡u (DML)</h4>
<p>NgÃ´n ngá»¯ Ä‘iá»u khiá»ƒn dá»¯ liá»‡u (Data Manipulation Language, DML) Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thao tÃ¡c dá»¯ liá»‡u trong cÆ¡ sá»Ÿ dá»¯ liá»‡u, truy cáº­p cÃ¡c Ä‘á»‘i tÆ°á»£ng vÃ  dá»¯ liá»‡u trong cÆ¡ sá»Ÿ dá»¯ liá»‡u.</p>
<p>DML cÃ³ chá»©c nÄƒng chÃ­nh lÃ  <strong>truy cáº­p dá»¯ liá»‡u</strong>, do Ä‘Ã³ cÃº phÃ¡p cá»§a nÃ³ táº­p trung vÃ o viá»‡c <strong>Ä‘á»c vÃ  ghi cÆ¡ sá»Ÿ dá»¯ liá»‡u</strong>.</p>
<p>CÃ¡c chá»‰ thá»‹ cá»‘t lÃµi cá»§a DML lÃ  <code>INSERT</code>, <code>UPDATE</code>, <code>DELETE</code>, <code>SELECT</code>. Bá»‘n chá»‰ thá»‹ nÃ y Ä‘Æ°á»£c gá»i chung lÃ  CRUD (Create, Read, Update, Delete), tá»©c lÃ  táº¡o, Ä‘á»c, cáº­p nháº­t, xÃ³a.</p>
<h4>NgÃ´n ngá»¯ Ä‘iá»u khiá»ƒn giao dá»‹ch (TCL)</h4>
<p>NgÃ´n ngá»¯ Ä‘iá»u khiá»ƒn giao dá»‹ch (Transaction Control Language, TCL) Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ <strong>quáº£n lÃ½ cÃ¡c giao dá»‹ch trong cÆ¡ sá»Ÿ dá»¯ liá»‡u</strong>. NÃ³ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ quáº£n lÃ½ cÃ¡c thay Ä‘á»•i Ä‘Æ°á»£c thá»±c hiá»‡n bá»Ÿi cÃ¡c cÃ¢u lá»‡nh DML. NÃ³ cÅ©ng cho phÃ©p nhÃ³m cÃ¡c cÃ¢u lá»‡nh thÃ nh cÃ¡c giao dá»‹ch logic.</p>
<p>CÃ¡c chá»‰ thá»‹ cá»‘t lÃµi cá»§a TCL lÃ  <code>COMMIT</code>, <code>ROLLBACK</code>.</p>
<h4>NgÃ´n ngá»¯ Ä‘iá»u khiá»ƒn dá»¯ liá»‡u (DCL)</h4>
<p>NgÃ´n ngá»¯ Ä‘iá»u khiá»ƒn dá»¯ liá»‡u (Data Control Language, DCL) lÃ  má»™t ngÃ´n ngá»¯ truy váº¥n cho phÃ©p <strong>kiá»ƒm soÃ¡t quyá»n truy cáº­p cá»§a ngÆ°á»i dÃ¹ng vÃ o cÃ¡c Ä‘á»‘i tÆ°á»£ng cÆ¡ sá»Ÿ dá»¯ liá»‡u</strong> nhÆ° báº£ng, xem, thá»§ tá»¥c lÆ°u trá»¯, hÃ m ngÆ°á»i dÃ¹ng vÃ  nhiá»u Ä‘á»‘i tÆ°á»£ng cÆ¡ sá»Ÿ dá»¯ liá»‡u khÃ¡c.</p>
<p>DCL cÃ³ chá»©c nÄƒng chÃ­nh lÃ  <strong>kiá»ƒm soÃ¡t quyá»n truy cáº­p cá»§a ngÆ°á»i dÃ¹ng</strong>, do Ä‘Ã³ cÃº phÃ¡p cá»§a nÃ³ khÃ´ng phá»©c táº¡p, quyá»n kiá»ƒm soÃ¡t cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng bao gá»“m: <code>CONNECT</code>, <code>SELECT</code>, <code>INSERT</code>, <code>UPDATE</code>, <code>DELETE</code>, <code>EXECUTE</code>, <code>USAGE</code>, <code>REFERENCES</code>.</p>
<p>TÃ¹y thuá»™c vÃ o DBMS cá»¥ thá»ƒ vÃ  thá»±c thá»ƒ báº£o máº­t khÃ¡c nhau, cÃ¡c quyá»n kiá»ƒm soÃ¡t Ä‘Æ°á»£c há»— trá»£ cÅ©ng khÃ¡c nhau.</p>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/sql-syntax.png" type="image/png"/>
    </item>
    <item>
      <title>SQL DB Theory</title>
      <link>https://vanhung4499.github.io/database/sql/theory.html</link>
      <guid>https://vanhung4499.github.io/database/sql/theory.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">SQL DB Theory</source>
      <description>Nhá»¯ng Ä‘iá»ƒm cá»‘t lÃµi vá» há»‡ thá»‘ng cÆ¡ sá»Ÿ dá»¯ liá»‡u Giao dá»‹ch (Transaction) KhÃ¡i niá»‡m Giao dá»‹ch lÃ  má»™t táº­p há»£p cÃ¡c hoáº¡t Ä‘á»™ng thá»a mÃ£n cÃ¡c Ä‘áº·c tÃ­nh ACID, cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng cÃ¡ch...</description>
      <category>db</category>
      <category>sql</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>Giao dá»‹ch (Transaction)</h2>
<h3>KhÃ¡i niá»‡m</h3>
<p>Giao dá»‹ch lÃ  má»™t táº­p há»£p cÃ¡c hoáº¡t Ä‘á»™ng thá»a mÃ£n cÃ¡c Ä‘áº·c tÃ­nh ACID, cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng cÃ¡ch Commit Ä‘á»ƒ xÃ¡c nháº­n má»™t giao dá»‹ch hoáº·c sá»­ dá»¥ng Rollback Ä‘á»ƒ hoÃ n tÃ¡c.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/185b9c49-4c13-4241-a848-fbff85c03a64.png" alt="185b9c49-4c13-4241-a848-fbff85c03a64.png" tabindex="0" loading="lazy"><figcaption>185b9c49-4c13-4241-a848-fbff85c03a64.png</figcaption></figure>
<h3>ACID</h3>
<h4>1. TÃ­nh nguyÃªn tá»­ (Atomicity)</h4>
<p>Giao dá»‹ch Ä‘Æ°á»£c coi lÃ  má»™t Ä‘Æ¡n vá»‹ khÃ´ng thá»ƒ chia tÃ¡ch, táº¥t cáº£ cÃ¡c hoáº¡t Ä‘á»™ng trong giao dá»‹ch pháº£i Ä‘Æ°á»£c hoáº·c hoÃ n táº¥t thÃ nh cÃ´ng hoáº·c hoÃ n tÃ¡c hoÃ n toÃ n.</p>
<p>HoÃ n tÃ¡c cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng cÃ¡ch sá»­ dá»¥ng nháº­t kÃ½, ghi láº¡i cÃ¡c hoáº¡t Ä‘á»™ng sá»­a Ä‘á»•i Ä‘Æ°á»£c thá»±c hiá»‡n trong giao dá»‹ch vÃ  thá»±c hiá»‡n ngÆ°á»£c láº¡i cÃ¡c hoáº¡t Ä‘á»™ng nÃ y khi hoÃ n tÃ¡c.</p>
<h4>2. TÃ­nh nháº¥t quÃ¡n (Consistency)</h4>
<p>CÆ¡ sá»Ÿ dá»¯ liá»‡u duy trÃ¬ tráº¡ng thÃ¡i nháº¥t quÃ¡n trÆ°á»›c vÃ  sau khi giao dá»‹ch Ä‘Æ°á»£c thá»±c hiá»‡n. Trong tráº¡ng thÃ¡i nháº¥t quÃ¡n, káº¿t quáº£ Ä‘á»c dá»¯ liá»‡u tá»« má»i giao dá»‹ch Ä‘á»‘i vá»›i má»™t dá»¯ liá»‡u cá»¥ thá»ƒ lÃ  nhÆ° nhau.</p>
<h4>3. TÃ­nh cÃ´ láº­p (Isolation)</h4>
<p>CÃ¡c sá»­a Ä‘á»•i Ä‘Æ°á»£c thá»±c hiá»‡n bá»Ÿi má»™t giao dá»‹ch khÃ´ng Ä‘Æ°á»£c nhÃ¬n tháº¥y bá»Ÿi cÃ¡c giao dá»‹ch khÃ¡c cho Ä‘áº¿n khi giao dá»‹ch Ä‘Ã³ Ä‘Æ°á»£c xÃ¡c nháº­n.</p>
<h4>4. TÃ­nh bá»n vá»¯ng (Durability)</h4>
<p>Má»™t khi giao dá»‹ch Ä‘Æ°á»£c xÃ¡c nháº­n, cÃ¡c sá»­a Ä‘á»•i Ä‘Æ°á»£c thá»±c hiá»‡n trong giao dá»‹ch sáº½ Ä‘Æ°á»£c lÆ°u trá»¯ vÄ©nh viá»…n trong cÆ¡ sá»Ÿ dá»¯ liá»‡u. Ngay cáº£ khi há»‡ thá»‘ng gáº·p sá»± cá»‘, káº¿t quáº£ cá»§a giao dá»‹ch váº«n khÃ´ng bá»‹ máº¥t.</p>
<p>CÃ³ thá»ƒ thá»±c hiá»‡n sao lÆ°u vÃ  khÃ´i phá»¥c cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c tÃ­nh bá»n vá»¯ng. Khi há»‡ thá»‘ng gáº·p sá»± cá»‘, cÃ³ thá»ƒ sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘Ã£ sao lÆ°u Ä‘á»ƒ khÃ´i phá»¥c dá»¯ liá»‡u.</p>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/185b9c49-4c13-4241-a848-fbff85c03a64.png" type="image/png"/>
    </item>
    <item>
      <title>Design Pattern</title>
      <link>https://vanhung4499.github.io/design/design-pattern/</link>
      <guid>https://vanhung4499.github.io/design/design-pattern/</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Design Pattern</source>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
    </item>
    <item>
      <title>Overview</title>
      <link>https://vanhung4499.github.io/design/design-pattern/overview.html</link>
      <guid>https://vanhung4499.github.io/design/design-pattern/overview.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Overview</source>
      <description>Tá»•ng quan vá» máº«u thiáº¿t káº¿ Máº«u thiáº¿t káº¿ (Design Pattern) Ä‘áº¡i diá»‡n cho cÃ¡c phÆ°Æ¡ng phÃ¡p tá»‘t nháº¥t thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi cÃ¡c nhÃ  phÃ¡t triá»ƒn pháº§n má»m cÃ³ kinh nghiá»‡m. Máº«u thiáº¿t káº¿ lÃ ...</description>
      <category>design-pattern</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>Máº«u thiáº¿t káº¿ (Design Pattern) Ä‘áº¡i diá»‡n cho cÃ¡c phÆ°Æ¡ng phÃ¡p tá»‘t nháº¥t thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi cÃ¡c nhÃ  phÃ¡t triá»ƒn pháº§n má»m cÃ³ kinh nghiá»‡m. Máº«u thiáº¿t káº¿ lÃ  cÃ¡c giáº£i phÃ¡p cho cÃ¡c váº¥n Ä‘á» chung mÃ  cÃ¡c nhÃ  phÃ¡t triá»ƒn pháº§n má»m gáº·p pháº£i trong quÃ¡ trÃ¬nh phÃ¡t triá»ƒn pháº§n má»m. Nhá»¯ng giáº£i phÃ¡p nÃ y Ä‘Æ°á»£c rÃºt ra tá»« thá»i gian dÃ i thá»­ nghiá»‡m vÃ  lá»—i cá»§a nhiá»u nhÃ  phÃ¡t triá»ƒn pháº§n má»m.</p>
</blockquote>
<h2>ğŸ“– Ná»™i dung</h2>
<p>Trong tÃ i liá»‡u nÃ y, gá»“m cÃ³ 2 pháº§n chÃ­nh:</p>
<ul>
<li>Patterns: Tá»•ng há»£p vá» Design Pattern, lÃ½ thuyáº¿t vÃ  cÃ¡ch triá»ƒn khai.</li>
<li>Practical: Ãp dá»¥ng Design Pattern vÃ o thá»±c táº¿, má»™t sá»‘ vÃ­ dá»¥ cá»¥ thá»ƒ cho tá»«ng máº«u thiáº¿t káº¿. Sá»­ dá»¥ng Java Ä‘á»ƒ triá»ƒn khai cÃ¡c máº«u thiáº¿t káº¿.</li>
</ul>
<p>Báº¡n cÃ³ thá»ƒ xem chi tiáº¿t tá»«ng máº«u thiáº¿t káº¿ á»Ÿ pháº§n Patterns.</p>
<h2>ğŸ“– Patterns</h2>
<h3>Creational Patterns</h3>
<blockquote>
<p>Máº«u thiáº¿t káº¿ táº¡o Ä‘á»‘i tÆ°á»£ng cung cáº¥p cÆ¡ cháº¿ táº¡o Ä‘á»‘i tÆ°á»£ng, giÃºp tÄƒng tÃ­nh linh hoáº¡t vÃ  kháº£ nÄƒng tÃ¡i sá»­ dá»¥ng cá»§a mÃ£ hiá»‡n cÃ³.</p>
</blockquote>
<ul>
<li><a href="patterns/creational/simple-factory">Simple Factory Pattern</a></li>
<li><a href="patterns/creational/factory-method">Factory Method Pattern</a></li>
<li><a href="patterns/creational/abstract-factory">Abstract Factory Pattern</a></li>
<li><a href="patterns/creational/builder">Builder Pattern</a></li>
<li><a href="patterns/creational/prototype">Prototype Pattern</a></li>
<li><a href="patterns/creational/singleton">Singleton Pattern</a></li>
</ul>
<h3>Structural Patterns</h3>
<blockquote>
<p>Máº«u thiáº¿t káº¿ cáº¥u trÃºc giÃºp tá»• chá»©c cÃ¡c Ä‘á»‘i tÆ°á»£ng vÃ  lá»›p thÃ nh cÃ¡c cáº¥u trÃºc lá»›n hÆ¡n, Ä‘á»“ng thá»i duy trÃ¬ tÃ­nh linh hoáº¡t vÃ  hiá»‡u suáº¥t cá»§a cáº¥u trÃºc Ä‘Ã³.</p>
</blockquote>
<ul>
<li><a href="patterns/structural/adapter">Adapter Pattern</a></li>
<li><a href="patterns/structural/bridge">Bridge Pattern</a></li>
<li><a href="patterns/structural/composite">Composite Pattern</a></li>
<li><a href="patterns/structural/decorator">Decorator Pattern</a></li>
<li><a href="patterns/structural/facade">Facade Pattern</a></li>
<li><a href="patterns/structural/flyweight">Flyweight Pattern</a></li>
<li><a href="patterns/structural/proxy">Proxy Pattern</a></li>
</ul>
<h3>Behavioral patterns</h3>
<blockquote>
<p>Máº«u thiáº¿t káº¿ hÃ nh vi Ä‘áº£m nháº­n trÃ¡ch nhiá»‡m giao tiáº¿p hiá»‡u quáº£ giá»¯a cÃ¡c Ä‘á»‘i tÆ°á»£ng vÃ  phÃ¢n phá»‘i trÃ¡ch nhiá»‡m.</p>
</blockquote>
<ul>
<li><a href="patterns/behavioral/template-method">Template Method Pattern</a></li>
<li><a href="patterns/behavioral/command">Command Pattern</a></li>
<li><a href="patterns/behavioral/iterator">Iterator Pattern</a></li>
<li><a href="patterns/behavioral/observer">Observer Pattern</a></li>
<li><a href="patterns/interpreter">Interpreter Pattern</a> Updating!</li>
<li><a href="patterns/behavioral/mediator">Mediator Pattern</a></li>
<li><a href="patterns/behavioral/chain-of-responsibility">Chain Of Responsibility Pattern</a></li>
<li><a href="patterns/behavioral/memento">Memento Pattern</a></li>
<li><a href="patterns/behavioral/strategy">Strategy Pattern</a></li>
<li><a href="patterns/behavioral/visitor">Visitor Pattern</a></li>
<li><a href="patterns/behavioral/state">State Pattern</a></li>
</ul>
<h2>ğŸšš Thá»±c chiáº¿n</h2>
<h3>Creational Patterns</h3>
<blockquote>
<p>Máº«u thiáº¿t káº¿ táº¡o Ä‘á»‘i tÆ°á»£ng cung cáº¥p cÆ¡ cháº¿ táº¡o Ä‘á»‘i tÆ°á»£ng, giÃºp tÄƒng tÃ­nh linh hoáº¡t vÃ  kháº£ nÄƒng tÃ¡i sá»­ dá»¥ng cá»§a mÃ£ hiá»‡n cÃ³.</p>
</blockquote>
<ul>
<li><a href="practical/creational/simple-factory">Simple Factory Pattern</a></li>
<li><a href="practical/creational/factory-method">Factory Method Pattern</a></li>
<li><a href="practical/creational/abstract-factory">Abstract Factory Pattern</a></li>
<li><a href="practical/creational/builder">Builder Pattern</a></li>
<li><a href="practical/creational/prototype">Prototype Pattern</a></li>
<li><a href="practical/creational/singleton">Singleton Pattern</a></li>
</ul>
<h3>Structural Patters</h3>
<blockquote>
<p>Máº«u thiáº¿t káº¿ cáº¥u trÃºc giÃºp tá»• chá»©c cÃ¡c Ä‘á»‘i tÆ°á»£ng vÃ  lá»›p thÃ nh cÃ¡c cáº¥u trÃºc lá»›n hÆ¡n, Ä‘á»“ng thá»i duy trÃ¬ tÃ­nh linh hoáº¡t vÃ  hiá»‡u suáº¥t cá»§a cáº¥u trÃºc Ä‘Ã³.</p>
</blockquote>
<ul>
<li><a href="practical/structural/adapter">Adapter Pattern</a></li>
<li><a href="practical/structural/bridge">Bridge Pattern</a></li>
<li><a href="practical/structural/composite">Composite Pattern</a></li>
<li><a href="practical/structural/decorator">Decorator Pattern</a></li>
<li><a href="practical/structural/facade">Facade Pattern</a></li>
<li><a href="practical/structural/flyweight">Flyweight Pattern</a></li>
<li><a href="practical/structural/proxy">Proxy Pattern</a></li>
</ul>
<h3>Behavioral patterns</h3>
<blockquote>
<p>Máº«u thiáº¿t káº¿ hÃ nh vi Ä‘áº£m nháº­n trÃ¡ch nhiá»‡m giao tiáº¿p hiá»‡u quáº£ giá»¯a cÃ¡c Ä‘á»‘i tÆ°á»£ng vÃ  phÃ¢n phá»‘i trÃ¡ch nhiá»‡m.</p>
</blockquote>
<ul>
<li><a href="practical/behavioral/template-method">Template Method Pattern</a></li>
<li><a href="practical/behavioral/command">Command Pattern</a></li>
<li><a href="practical/behavioral/iterator">Iterator Pattern</a></li>
<li><a href="practical/behavioral/observer">Observer Pattern</a></li>
<li><a href="practical/interpreter">Interpreter Pattern</a> Updating!</li>
<li><a href="practical/behavioral/mediator">Mediator Pattern</a></li>
<li><a href="practical/behavioral/chain-of-responsibility">Chain Of Responsibility Pattern</a></li>
<li><a href="practical/behavioral/memento">Memento Pattern</a></li>
<li><a href="practical/behavioral/strategy">Strategy Pattern</a></li>
<li><a href="practical/behavioral/visitor">Visitor Pattern</a></li>
<li><a href="practical/behavioral/state">State Pattern</a></li>
</ul>
<h2>ğŸ“š TÃ i liá»‡u</h2>
<ul>
<li><a href="https://www.amazon.com/Head-First-Design-Patterns-Brain-Friendly/dp/0596007124" target="_blank" rel="noopener noreferrer">Head First Design Patterns</a></li>
<li><a href="https://refactoring.guru/design-patterns" target="_blank" rel="noopener noreferrer">Design Patterns</a></li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>Docker</title>
      <link>https://vanhung4499.github.io/devops/docker/</link>
      <guid>https://vanhung4499.github.io/devops/docker/</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Docker</source>
      <category>Docker</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
    </item>
    <item>
      <title>Git</title>
      <link>https://vanhung4499.github.io/devops/git/</link>
      <guid>https://vanhung4499.github.io/devops/git/</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Git</source>
      <category>git</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
    </item>
    <item>
      <title>Kubernetes</title>
      <link>https://vanhung4499.github.io/devops/k8s/</link>
      <guid>https://vanhung4499.github.io/devops/k8s/</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Kubernetes</source>
      <category>kubernetes</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
    </item>
    <item>
      <title>Linux</title>
      <link>https://vanhung4499.github.io/devops/linux/</link>
      <guid>https://vanhung4499.github.io/devops/linux/</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Linux</source>
      <category>linux</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
    </item>
    <item>
      <title>Algorithm</title>
      <link>https://vanhung4499.github.io/dsa/algo/</link>
      <guid>https://vanhung4499.github.io/dsa/algo/</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Algorithm</source>
      <description>Algorithm Info Tá»•ng há»£p cÃ¡c thuáº­t toÃ¡n, chiáº¿n lÆ°á»£c, suy luáº­n, giáº£i thÃ­ch vÃ  Ã¡p dá»¥ng giáº£i quyáº¿t cÃ¡c vÃ­ dá»¥ cá»¥ thá»ƒ trÃªn LeeCode! CÃ¡c chá»§ Ä‘á» Ä‘Æ°á»£c chia rÃµ, báº¡n cÃ³ thá»ƒ tÃ¬m Ä‘áº¿n chá»§ Ä‘á» ...</description>
      <category>dsa</category>
      <category>algorithm</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<div class="hint-container info">
<p class="hint-container-title">Info</p>
<ul>
<li>Tá»•ng há»£p cÃ¡c thuáº­t toÃ¡n, chiáº¿n lÆ°á»£c, suy luáº­n, giáº£i thÃ­ch vÃ  Ã¡p dá»¥ng giáº£i quyáº¿t cÃ¡c vÃ­ dá»¥ cá»¥ thá»ƒ trÃªn LeeCode!</li>
<li>CÃ¡c chá»§ Ä‘á» Ä‘Æ°á»£c chia rÃµ, báº¡n cÃ³ thá»ƒ tÃ¬m Ä‘áº¿n chá»§ Ä‘á» báº¡n quan tÃ¢m, khÃ´ng cáº§n pháº£i Ä‘á»c tá»« trÃªn xuá»‘ng dÆ°á»›i!</li>
</ul>
</div>
]]></content:encoded>
    </item>
    <item>
      <title>Data Structure</title>
      <link>https://vanhung4499.github.io/dsa/ds/</link>
      <guid>https://vanhung4499.github.io/dsa/ds/</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Data Structure</source>
      <description>Data Structures Info Tá»•ng há»£p kiáº¿n thá»©c vÃ  thá»±c hÃ nh vá»›i cÃ¡c cáº¥u trÃºc dá»¯ liá»‡u cÆ¡ báº£n vÃ  nÃ¢ng cao. Hiá»ƒu vÃ  Ã¡p dá»¥ng cÃ¡c cáº¥u trÃºc dá»¯ liá»‡u vÃ o cÃ¡c thuáº­t toÃ¡n Ä‘á»ƒ giáº£i quyáº¿t cÃ¡c bÃ i t...</description>
      <category>data-structure</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<div class="hint-container info">
<p class="hint-container-title">Info</p>
<ul>
<li>Tá»•ng há»£p kiáº¿n thá»©c vÃ  thá»±c hÃ nh vá»›i cÃ¡c cáº¥u trÃºc dá»¯ liá»‡u cÆ¡ báº£n vÃ  nÃ¢ng cao.</li>
<li>Hiá»ƒu vÃ  Ã¡p dá»¥ng cÃ¡c cáº¥u trÃºc dá»¯ liá»‡u vÃ o cÃ¡c thuáº­t toÃ¡n Ä‘á»ƒ giáº£i quyáº¿t cÃ¡c bÃ i toÃ¡n.</li>
</ul>
</div>
]]></content:encoded>
    </item>
    <item>
      <title>Introduction</title>
      <link>https://vanhung4499.github.io/dsa/intro/</link>
      <guid>https://vanhung4499.github.io/dsa/intro/</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Introduction</source>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
    </item>
    <item>
      <title>Algorithm Complexity</title>
      <link>https://vanhung4499.github.io/dsa/intro/complexity.html</link>
      <guid>https://vanhung4499.github.io/dsa/intro/complexity.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Algorithm Complexity</source>
      <description>Äá»™ phá»©c táº¡p cá»§a thuáº­t toÃ¡n 1. Giá»›i thiá»‡u vá» Ä‘á»™ phá»©c táº¡p cá»§a thuáº­t toÃ¡n Äá»™ phá»©c táº¡p cá»§a thuáº­t toÃ¡n (Algorithm complexity): LÃ  cÃ¡ch sá»­ dá»¥ng thá»i gian vÃ  khÃ´ng gian cá»§a chÆ°Æ¡ng trÃ¬n...</description>
      <category>dsa</category>
      <category>algorithm</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>1. Giá»›i thiá»‡u vá» Ä‘á»™ phá»©c táº¡p cá»§a thuáº­t toÃ¡n</h2>
<blockquote>
<p><strong>Äá»™ phá»©c táº¡p cá»§a thuáº­t toÃ¡n (Algorithm complexity)</strong>: LÃ  cÃ¡ch sá»­ dá»¥ng thá»i gian vÃ  khÃ´ng gian cá»§a chÆ°Æ¡ng trÃ¬nh trong Ä‘iá»u kiá»‡n Ä‘áº§u vÃ o cá»§a váº¥n Ä‘á» cÃ³ kÃ­ch thÆ°á»›c lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>.</p>
</blockquote>
<p>Má»¥c Ä‘Ã­ch cá»§a "phÃ¢n tÃ­ch thuáº­t toÃ¡n" lÃ  cáº£i tiáº¿n thuáº­t toÃ¡n. NhÆ° Ä‘Ã£ Ä‘á» cáº­p á»Ÿ trÃªn: Má»¥c tiÃªu cá»§a thuáº­t toÃ¡n lÃ  tá»‘i Æ°u hÃ³a <strong>thá»i gian cháº¡y (Äá»™ phá»©c táº¡p thá»i gian tháº¥p hÆ¡n)</strong> vÃ  <strong>khÃ´ng gian sá»­ dá»¥ng (khÃ´ng gian phá»©c táº¡p tháº¥p hÆ¡n)</strong>. VÃ¬ váº­y, viá»‡c thá»±c hiá»‡n "phÃ¢n tÃ­ch thuáº­t toÃ¡n" lÃ  phÃ¢n tÃ­ch thuáº­t toÃ¡n tá»« hai khÃ­a cáº¡nh sá»­ dá»¥ng thá»i gian vÃ  sá»­ dá»¥ng khÃ´ng gian.</p>
<p>So sÃ¡nh sá»± Æ°u vÃ  nhÆ°á»£c Ä‘iá»ƒm cá»§a hai thuáº­t toÃ¡n thÆ°á»ng cÃ³ hai phÆ°Æ¡ng phÃ¡p:</p>
<ul>
<li><strong>Thá»‘ng kÃª sau khi thá»±c hiá»‡n</strong>: Viáº¿t hai chÆ°Æ¡ng trÃ¬nh thá»±c thi cho hai thuáº­t toÃ¡n, ghi láº¡i thá»i gian cháº¡y vÃ  kÃ­ch thÆ°á»›c khÃ´ng gian sá»­ dá»¥ng thá»±c táº¿ cá»§a má»—i thuáº­t toÃ¡n, sau Ä‘Ã³ chá»n thuáº­t toÃ¡n tá»‘t nháº¥t.</li>
<li><strong>Æ¯á»›c tÃ­nh trÆ°á»›c</strong>: Sau khi thiáº¿t káº¿ thuáº­t toÃ¡n, dá»±a trÃªn cÃ¡c bÆ°á»›c trong thuáº­t toÃ¡n, Æ°á»›c tÃ­nh thá»i gian cháº¡y vÃ  khÃ´ng gian sá»­ dá»¥ng cá»§a thuáº­t toÃ¡n. So sÃ¡nh giÃ¡ trá»‹ Æ°á»›c tÃ­nh cá»§a hai thuáº­t toÃ¡n vÃ  chá»n thuáº­t toÃ¡n tá»‘t nháº¥t.</li>
</ul>
<p>Trong háº§u háº¿t cÃ¡c trÆ°á»ng há»£p, chÃºng ta sáº½ chá»n phÆ°Æ¡ng phÃ¡p thá»© hai. VÃ¬ cÃ´ng viá»‡c cá»§a phÆ°Æ¡ng phÃ¡p thá»© nháº¥t quÃ¡ lá»›n vÃ  khÃ´ng Ä‘Ã¡ng ká»ƒ. NgoÃ i ra, ngay cáº£ khi cÃ¹ng má»™t thuáº­t toÃ¡n Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng cÃ¡c ngÃ´n ngá»¯ khÃ¡c nhau, trÃªn cÃ¡c mÃ¡y tÃ­nh khÃ¡c nhau, thá»i gian cháº¡y cÅ©ng khÃ´ng giá»‘ng nhau. VÃ¬ váº­y, chÃºng ta thÆ°á»ng sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p Æ°á»›c tÃ­nh trÆ°á»›c Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ thuáº­t toÃ¡n.</p>
<p>Trong phÆ°Æ¡ng phÃ¡p Æ°á»›c tÃ­nh trÆ°á»›c, ngÃ´n ngá»¯ biÃªn dá»‹ch vÃ  tá»‘c Ä‘á»™ cháº¡y mÃ¡y tÃ­nh khÃ´ng pháº£i lÃ  nhá»¯ng yáº¿u tá»‘ chÃºng ta quan tÃ¢m. ChÃºng ta chá»‰ quan tÃ¢m Ä‘áº¿n viá»‡c tÄƒng kÃ­ch thÆ°á»›c cá»§a váº¥n Ä‘á» <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>, thá»i gian vÃ  khÃ´ng gian sá»­ dá»¥ng tÆ°Æ¡ng á»©ng cÅ©ng tÄƒng theo cÃ¡ch nÃ o.</p>
<p>á» Ä‘Ã¢y, <strong>"kÃ­ch thÆ°á»›c váº¥n Ä‘á» <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>"</strong> cÃ³ nghÄ©a lÃ : sá»‘ lÆ°á»£ng dá»¯ liá»‡u Ä‘áº§u vÃ o cá»§a váº¥n Ä‘á» thuáº­t toÃ¡n. Äá»‹nh nghÄ©a cÅ©ng khÃ´ng giá»‘ng nhau cho cÃ¡c thuáº­t toÃ¡n khÃ¡c nhau.</p>
<ul>
<li>Trong thuáº­t toÃ¡n sáº¯p xáº¿p: <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> Ä‘áº¡i diá»‡n cho sá»‘ lÆ°á»£ng pháº§n tá»­ cáº§n sáº¯p xáº¿p.</li>
<li>Trong thuáº­t toÃ¡n tÃ¬m kiáº¿m: <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> Ä‘áº¡i diá»‡n cho tá»•ng sá»‘ pháº§n tá»­ trong pháº¡m vi tÃ¬m kiáº¿m: vÃ­ dá»¥ nhÆ° kÃ­ch thÆ°á»›c máº£ng, kÃ­ch thÆ°á»›c ma tráº­n 2D, Ä‘á»™ dÃ i chuá»—i, sá»‘ lÆ°á»£ng nÃºt trong cÃ¢y nhá»‹ phÃ¢n, sá»‘ lÆ°á»£ng nÃºt vÃ  cáº¡nh trong Ä‘á»“ thá»‹, v.v.</li>
<li>Trong thuáº­t toÃ¡n liÃªn quan Ä‘áº¿n tÃ­nh toÃ¡n nhá»‹ phÃ¢n: <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> Ä‘áº¡i diá»‡n cho chiá»u rá»™ng cá»§a biá»ƒu diá»…n nhá»‹ phÃ¢n.</li>
</ul>
<p>NÃ³i chung, kÃ­ch thÆ°á»›c cá»§a váº¥n Ä‘á» cÃ ng gáº§n nhau, chi phÃ­ tÃ­nh toÃ¡n tÆ°Æ¡ng á»©ng cÅ©ng cÃ ng gáº§n nhau. VÃ  khi kÃ­ch thÆ°á»›c cá»§a váº¥n Ä‘á» má»Ÿ rá»™ng, chi phÃ­ tÃ­nh toÃ¡n cÅ©ng tÄƒng theo xu hÆ°á»›ng tÄƒng. Tiáº¿p theo, chÃºng ta sáº½ giáº£i thÃ­ch cá»¥ thá»ƒ vá» "Ä‘á»™ phá»©c táº¡p thá»i gian" vÃ  "Ä‘á»™ phá»©c táº¡p khÃ´ng gian".</p>
<h2>2. Äá»™ phá»©c táº¡p thá»i gian</h2>
<h3>2.1 Giá»›i thiá»‡u vá» Ä‘á»™ phá»©c táº¡p thá»i gian</h3>
<blockquote>
<p><strong>Äá»™ phá»©c táº¡p thá»i gian (Time Complexity)</strong>: LÃ  thá»i gian mÃ  thuáº­t toÃ¡n cáº§n Ä‘á»ƒ cháº¡y trong Ä‘iá»u kiá»‡n Ä‘áº§u vÃ o cá»§a váº¥n Ä‘á» cÃ³ kÃ­ch thÆ°á»›c lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>, cÃ³ thá»ƒ Ä‘Æ°á»£c kÃ½ hiá»‡u lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>.</p>
</blockquote>
<p>ChÃºng ta sá»­ dá»¥ng <strong>sá»‘ láº§n thá»±c hiá»‡n cÃ¡c thao tÃ¡c cÆ¡ báº£n</strong> lÃ m Ä‘Æ¡n vá»‹ Ä‘o lÆ°á»ng cho Ä‘á»™ phá»©c táº¡p thá»i gian. NÃ³i cÃ¡ch khÃ¡c, Ä‘á»™ phá»©c táº¡p thá»i gian tÆ°Æ¡ng quan vá»›i sá»‘ láº§n thá»±c hiá»‡n cÃ¡c thao tÃ¡c cÆ¡ báº£n trong thuáº­t toÃ¡n.</p>
<ul>
<li><strong>Thao tÃ¡c cÆ¡ báº£n</strong>: Má»—i cÃ¢u lá»‡nh trong thuáº­t toÃ¡n. Má»—i thao tÃ¡c cÆ¡ báº£n cÃ³ thá»ƒ hoÃ n thÃ nh trong thá»i gian háº±ng sá»‘.</li>
</ul>
<p>Thao tÃ¡c cÆ¡ báº£n lÃ  má»™t thao tÃ¡c mÃ  thá»i gian thá»±c hiá»‡n khÃ´ng phá»¥ thuá»™c vÃ o sá»‘ lÆ°á»£ng pháº§n tá»­ cá»§a dá»¯ liá»‡u Ä‘áº§u vÃ o.</p>
<p>VÃ­ dá»¥, thao tÃ¡c cá»™ng hai sá»‘ nguyÃªn lÃ  má»™t thao tÃ¡c cÆ¡ báº£n. Náº¿u kÃ­ch thÆ°á»›c cá»§a hai sá»‘ khÃ´ng lá»›n, thá»i gian thá»±c hiá»‡n khÃ´ng phá»¥ thuá»™c vÃ o sá»‘ lÆ°á»£ng chá»¯ sá»‘ cá»§a sá»‘ nguyÃªn, vÃ¬ váº­y thao tÃ¡c cá»™ng cÃ³ thá»ƒ coi lÃ  má»™t thao tÃ¡c cÆ¡ báº£n.</p>
<p>NgÆ°á»£c láº¡i, náº¿u kÃ­ch thÆ°á»›c cá»§a hai sá»‘ ráº¥t lá»›n, thao tÃ¡c cá»™ng phá»¥ thuá»™c vÃ o sá»‘ lÆ°á»£ng chá»¯ sá»‘ cá»§a hai sá»‘, do Ä‘Ã³ thao tÃ¡c cá»™ng hai sá»‘ khÃ´ng pháº£i lÃ  má»™t thao tÃ¡c cÆ¡ báº£n, mÃ  má»—i thao tÃ¡c cá»™ng má»™t chá»¯ sá»‘ má»›i lÃ  má»™t thao tÃ¡c cÆ¡ báº£n.</p>
<p>DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ cá»¥ thá»ƒ Ä‘á»ƒ giáº£i thÃ­ch cÃ¡ch tÃ­nh Ä‘á»™ phá»©c táº¡p thá»i gian.</p>
<div class="language-python" data-ext="python" data-title="python"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">def</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> algorithm</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#D19A66;--shiki-dark:#D19A66;font-style:italic;--shiki-dark-font-style:italic">n</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    fact </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    for</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> i </span><span style="color:#C678DD;--shiki-dark:#C678DD">in</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> range</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, n </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">+</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        fact </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">*=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> i</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    return</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> fact</span></span></code></pre>
</div><p>Tá»•ng sá»‘ láº§n thá»±c hiá»‡n cÃ¡c cÃ¢u lá»‡nh trong thuáº­t toÃ¡n trÃªn lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>+</mo><mi>n</mi><mo>+</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo>=</mo><mn>2</mn><mi>n</mi><mo>+</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">1 + n + n + 1 = 2n + 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>, cÃ³ thá»ƒ sá»­ dá»¥ng hÃ m <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> Ä‘á»ƒ biá»ƒu thá»‹ sá»‘ láº§n thá»±c hiá»‡n cÃ¡c cÃ¢u lá»‡nh: <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><mi>n</mi><mo>+</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">f(n) = 2n + 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>.</p>
<p>Do Ä‘Ã³, hÃ m Ä‘á»™ phá»©c táº¡p thá»i gian cÃ³ thá»ƒ Ä‘Æ°á»£c biá»ƒu thá»‹ lÃ : <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n) = O(f(n))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span></span></span></span>. NÃ³ biá»ƒu thá»‹ xu hÆ°á»›ng tÄƒng cá»§a thá»i gian thá»±c hiá»‡n thuáº­t toÃ¡n khi kÃ­ch thÆ°á»›c cá»§a váº¥n Ä‘á» <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> tÄƒng lÃªn. <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi></mrow><annotation encoding="application/x-tex">O</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span></span></span></span> lÃ  má»™t kÃ½ hiá»‡u tiá»‡m cáº­n, <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> Ä‘Æ°á»£c gá»i lÃ  <strong>Ä‘á»™ phá»©c táº¡p thá»i gian tiá»‡m cáº­n (Asymptotic Time Complexity)</strong>, viáº¿t táº¯t lÃ  <strong>Ä‘á»™ phá»©c táº¡p thá»i gian</strong>.</p>
<p>KhÃ¡i niá»‡m "xu hÆ°á»›ng tÄƒng cá»§a thá»i gian thá»±c hiá»‡n thuáº­t toÃ¡n" lÃ  má»™t khÃ¡i niá»‡m mÆ¡ há»“, thÆ°á»ng chÃºng ta sá»­ dá»¥ng cÃ¡c kÃ½ hiá»‡u nhÆ° <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi></mrow><annotation encoding="application/x-tex">O</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span></span></span></span> Ä‘á»ƒ biá»ƒu thá»‹ Ä‘á»™ phá»©c táº¡p thá»i gian.</p>
<h3>2.2 KÃ½ hiá»‡u tiá»‡m cáº­n</h3>
<blockquote>
<p><strong>KÃ½ hiá»‡u tiá»‡m cáº­n (Asymptotic Symbol)</strong>: ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ mÃ´ táº£ tá»‘c Ä‘á»™ tÄƒng cá»§a má»™t hÃ m. ÄÆ¡n giáº£n nÃ³i, kÃ½ hiá»‡u tiá»‡m cáº­n chá»‰ giá»¯ láº¡i <strong>báº­c cao nháº¥t</strong> cá»§a hÃ m, bá» qua cÃ¡c pháº§n tÄƒng trÆ°á»Ÿng cháº­m hÆ¡n cá»§a hÃ m, cháº³ng háº¡n nhÆ° <strong>báº­c tháº¥p</strong>, <strong>há»‡ sá»‘</strong>, <strong>háº±ng sá»‘</strong>. VÃ¬ khi kÃ­ch thÆ°á»›c cá»§a váº¥n Ä‘á» trá»Ÿ nÃªn ráº¥t lá»›n, cÃ¡c pháº§n nÃ y khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n xu hÆ°á»›ng tÄƒng, nÃªn cÃ³ thá»ƒ bá» qua.</p>
</blockquote>
<p>CÃ³ ba kÃ½ hiá»‡u tiá»‡m cáº­n thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng: KÃ½ hiá»‡u tiá»‡m cáº­n cháº·t cháº½ <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Î˜</mi></mrow><annotation encoding="application/x-tex">\Theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Î˜</span></span></span></span>, kÃ½ hiá»‡u tiá»‡m cáº­n trÃªn <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi></mrow><annotation encoding="application/x-tex">O</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span></span></span></span>, kÃ½ hiá»‡u tiá»‡m cáº­n dÆ°á»›i <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Î©</mi></mrow><annotation encoding="application/x-tex">\Omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Î©</span></span></span></span>ã€‚Tiáº¿p theo chÃºng ta sáº½ giáº£i thÃ­ch tá»«ng kÃ½ hiá»‡u.</p>
<h4>2.2.1 KÃ½ hiá»‡u tiá»‡m cáº­n cháº·t cháº½ <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Î˜</mi></mrow><annotation encoding="application/x-tex">\Theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Î˜</span></span></span></span></h4>
<blockquote>
<p><strong>KÃ½ hiá»‡u tiá»‡m cáº­n cháº·t cháº½ <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Î˜</mi></mrow><annotation encoding="application/x-tex">\Theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Î˜</span></span></span></span></strong>: Äá»‘i vá»›i hai hÃ m <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> vÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>, <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">Î˜</mi><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(n) = \Theta(g(n))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Î˜</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span></span></span></span>. Tá»“n táº¡i cÃ¡c háº±ng sá»‘ dÆ°Æ¡ng <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">c_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">c_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> vÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">n_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> sao cho Ä‘á»‘i vá»›i táº¥t cáº£ cÃ¡c <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>â‰¥</mo><msub><mi>n</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">n \ge n_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼ŒcÃ³ <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>â‰¤</mo><msub><mi>c</mi><mn>1</mn></msub><mo>â‹…</mo><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>â‰¤</mo><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>â‰¤</mo><msub><mi>c</mi><mn>2</mn></msub><mo>â‹…</mo><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">0 \le c_1 \cdot g(n) \le f(n) \le c_2 \cdot g(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5945em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5945em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>ã€‚</p>
</blockquote>
<p>NghÄ©a lÃ , náº¿u hÃ m <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">Î˜</mi><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(n) = \Theta(g(n))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Î˜</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span></span></span></span>ï¼ŒchÃºng ta cÃ³ thá»ƒ tÃ¬m tháº¥y hai sá»‘ dÆ°Æ¡ng <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">c_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">c_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> sao cho <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> náº±m giá»¯a <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mn>1</mn></msub><mo>â‹…</mo><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c_1 \cdot g(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5945em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> vÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mn>2</mn></msub><mo>â‹…</mo><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c_2 \cdot g(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5945em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>.</p>
<p>VÃ­ dá»¥: <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mn>3</mn><msup><mi>n</mi><mn>2</mn></msup><mo>+</mo><mn>4</mn><mi>n</mi><mo>+</mo><mn>5</mn><mo>=</mo><mi mathvariant="normal">Î˜</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n) = 3n^2 + 4n + 5 = \Theta(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord">3</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">4</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord">Î˜</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼ŒchÃºng ta cÃ³ thá»ƒ tÃ¬m tháº¥y <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">c_1 = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>, <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mn>2</mn></msub><mo>=</mo><mn>12</mn></mrow><annotation encoding="application/x-tex">c_2 = 12</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">12</span></span></span></span>, <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>0</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n_0 = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> sao cho vá»›i táº¥t cáº£ <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>â‰¥</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n \ge 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼ŒÄ‘á»u cÃ³ <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>n</mi><mn>2</mn></msup><mo>â‰¤</mo><mn>3</mn><msup><mi>n</mi><mn>2</mn></msup><mo>+</mo><mn>4</mn><mi>n</mi><mo>+</mo><mn>5</mn><mo>â‰¤</mo><mn>12</mn><msup><mi>n</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">n^2 \le 3n^2 + 4n + 5 \le 12n^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9501em;vertical-align:-0.136em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord">3</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">4</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">5</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">12</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>ã€‚</p>
<h4>2.2.2 KÃ½ hiá»‡u tiá»‡m cáº­n trÃªn <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi></mrow><annotation encoding="application/x-tex">O</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span></span></span></span></h4>
<blockquote>
<p><strong>KÃ½ hiá»‡u tiá»‡m cáº­n trÃªn <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi></mrow><annotation encoding="application/x-tex">O</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span></span></span></span></strong>: Äá»‘i vá»›i hai hÃ m <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> vÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>, <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(n) = O(g(n))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span></span></span></span>ã€‚Tá»“n táº¡i má»™t háº±ng sá»‘ dÆ°Æ¡ng <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span> vÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">n_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> sao cho khi <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>&gt;</mo><msub><mi>n</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">n &gt; n_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼ŒcÃ³ <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>â‰¤</mo><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>â‰¤</mo><mi>c</mi><mo>â‹…</mo><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">0 \le f(n) \le c \cdot g(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>ã€‚</p>
</blockquote>
<p>KÃ½ hiá»‡u <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi></mrow><annotation encoding="application/x-tex">O</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span></span></span></span> chá»‰ cho ta biáº¿t má»™t hÃ m lÃ  má»™t giá»›i háº¡n trÃªn cá»§a hÃ m khÃ¡c.</p>
<h4>2.2.3 KÃ½ hiá»‡u tiá»‡m cáº­n dÆ°á»›i <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Î©</mi></mrow><annotation encoding="application/x-tex">\Omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Î©</span></span></span></span></h4>
<blockquote>
<p><strong>KÃ½ hiá»‡u tiá»‡m cáº­n dÆ°á»›i <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Î©</mi></mrow><annotation encoding="application/x-tex">\Omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Î©</span></span></span></span></strong>: Äá»‘i vá»›i hai hÃ m <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> vÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>, <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">Î©</mi><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(n) = \Omega(g(n))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Î©</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span></span></span></span>ã€‚Tá»“n táº¡i má»™t háº±ng sá»‘ dÆ°Æ¡ng <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span> vÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">n_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> sao cho khi <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>&gt;</mo><msub><mi>n</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">n &gt; n_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼ŒcÃ³ <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>â‰¤</mo><mi>c</mi><mo>â‹…</mo><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>â‰¤</mo><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">0 \le c \cdot g(n) \le f(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>ã€‚</p>
</blockquote>
<p>TÆ°Æ¡ng tá»±, náº¿u chÃºng ta chá»‰ biáº¿t giá»›i háº¡n dÆ°á»›i cá»§a má»™t hÃ m, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng kÃ½ hiá»‡u <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Î©</mi></mrow><annotation encoding="application/x-tex">\Omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Î©</span></span></span></span>.</p>
<figure><img src="https://raw.githubusercontent.com/vanhung4499/images/master/snap/202309240915919.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<h3>2.3 TÃ­nh toÃ¡n Ä‘á»™ phá»©c táº¡p thá»i gian</h3>
<p>CÃ¡c kÃ½ hiá»‡u tiá»‡m cáº­n cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ mÃ´ táº£ giá»›i háº¡n trÃªn vÃ  giá»›i háº¡n dÆ°á»›i cá»§a má»™t hÃ m, Ä‘á»“ng thá»i cÅ©ng cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ mÃ´ táº£ xu hÆ°á»›ng tÄƒng cá»§a thá»i gian thá»±c hiá»‡n cá»§a thuáº­t toÃ¡n.</p>
<p>Khi tÃ­nh toÃ¡n Ä‘á»™ phá»©c táº¡p thá»i gian, chÃºng ta thÆ°á»ng sá»­ dá»¥ng kÃ½ hiá»‡u tiá»‡m cáº­n trÃªn <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi></mrow><annotation encoding="application/x-tex">O</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span></span></span></span>. Bá»Ÿi vÃ¬ chÃºng ta thÆ°á»ng quan tÃ¢m Ä‘áº¿n giá»›i háº¡n trÃªn cá»§a thá»i gian thá»±c hiá»‡n thuáº­t toÃ¡n, khÃ´ng quan tÃ¢m Ä‘áº¿n giá»›i háº¡n dÆ°á»›i cá»§a nÃ³.</p>
<p>Váº­y lÃ m tháº¿ nÃ o Ä‘á»ƒ tÃ­nh toÃ¡n Ä‘á»™ phá»©c táº¡p thá»i gian?</p>
<p>QuÃ¡ trÃ¬nh tÃ­nh toÃ¡n Ä‘á»™ phá»©c táº¡p thá»i gian thÆ°á»ng bao gá»“m cÃ¡c bÆ°á»›c sau:</p>
<ul>
<li><strong>XÃ¡c Ä‘á»‹nh cÃ¡c thao tÃ¡c cÆ¡ báº£n trong thuáº­t toÃ¡n</strong>: CÃ¡c thao tÃ¡c cÆ¡ báº£n lÃ  cÃ¡c cÃ¢u lá»‡nh trong thuáº­t toÃ¡n Ä‘Æ°á»£c thá»±c hiá»‡n nhiá»u nháº¥t, thÆ°á»ng lÃ  pháº§n thÃ¢n cá»§a vÃ²ng láº·p á»Ÿ cáº¥p Ä‘á»™ lá»“ng nhau sÃ¢u nháº¥t.</li>
<li><strong>TÃ­nh toÃ¡n thá»© tá»± cá»§a sá»‘ láº§n thá»±c hiá»‡n cÃ¡c thao tÃ¡c cÆ¡ báº£n</strong>: Chá»‰ cáº§n tÃ­nh toÃ¡n thá»© tá»± cá»§a sá»‘ láº§n thá»±c hiá»‡n cÃ¡c thao tÃ¡c cÆ¡ báº£n, Ä‘áº£m báº£o ráº±ng báº­c cao nháº¥t cá»§a hÃ m lÃ  chÃ­nh xÃ¡c. CÃ¡c há»‡ sá»‘ cá»§a báº­c cao nháº¥t vÃ  cÃ¡c báº­c tháº¥p hÆ¡n cÃ³ thá»ƒ bá»‹ bá» qua.</li>
<li><strong>Sá»­ dá»¥ng kÃ½ hiá»‡u Big O Ä‘á»ƒ biá»ƒu thá»‹ Ä‘á»™ phá»©c táº¡p thá»i gian</strong>: Äáº·t thá»© tá»± tÃ­nh toÃ¡n tá»« bÆ°á»›c trÆ°á»›c vÃ o kÃ½ hiá»‡u O tiá»‡m cáº­n trÃªn.</li>
</ul>
<p>Äá»“ng thá»i, khi tÃ­nh toÃ¡n Ä‘á»™ phá»©c táº¡p thá»i gian, cÅ©ng cáº§n lÆ°u Ã½ má»™t sá»‘ nguyÃªn táº¯c:</p>
<ul>
<li><strong>NguyÃªn táº¯c cá»™ng</strong>: Äá»™ phá»©c táº¡p thá»i gian tá»•ng cá»™ng báº±ng Ä‘á»™ phá»©c táº¡p thá»i gian cá»§a thao tÃ¡c cÆ¡ báº£n cÃ³ thá»© tá»± lá»›n nháº¥t.</li>
</ul>
<p>Náº¿u <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><msub><mi>f</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T_1(n) = O(f_1(n))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span></span></span></span>ï¼Œ<span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><msub><mi>f</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T_2(n) = O(f_2(n))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span></span></span></span>ï¼Œ<span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>T</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi>T</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n) = T_1(n) + T_2(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>ï¼ŒthÃ¬ <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>max</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>O</mi><mo stretchy="false">(</mo><msub><mi>f</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>O</mi><mo stretchy="false">(</mo><msub><mi>f</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>max</mi><mo>â¡</mo><mo stretchy="false">(</mo><msub><mi>f</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>f</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n) = O(f(n)) = \max(O(f_1(n)), O(f_2(n))) = O(\max(f_1(n), f_2(n)))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)))</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">max</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)))</span></span></span></span>.</p>
<ul>
<li><strong>NguyÃªn táº¯c nhÃ¢n</strong>: Äá»™ phá»©c táº¡p thá»i gian cá»§a Ä‘oáº¡n mÃ£ láº·p lá»“ng nhau báº±ng tÃ­ch cá»§a Ä‘á»™ phá»©c táº¡p thá»i gian cá»§a cÃ¡c thao tÃ¡c cÆ¡ báº£n lá»“ng nhau.</li>
</ul>
<p>Náº¿u <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><msub><mi>f</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T_1 = O(f_1(n))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span></span></span></span>ï¼Œ<span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><msub><mi>f</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T_2 = O(f_2(n))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span></span></span></span>ï¼Œ<span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>T</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>â‹…</mo><msub><mi>T</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n) = T_1(n) \cdot T_2(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>ï¼ŒthÃ¬ <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><msub><mi>f</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>â‹…</mo><mi>O</mi><mo stretchy="false">(</mo><msub><mi>f</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><msub><mi>f</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>â‹…</mo><msub><mi>f</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n) = O(f(n)) = O(f_1(n)) \cdot O(f_2(n)) = O(f_1(n) \cdot f_2(n))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span></span></span></span>.</p>
<p>DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ cá»¥ thá»ƒ Ä‘á»ƒ giáº£i thÃ­ch cÃ¡ch tÃ­nh toÃ¡n Ä‘á»™ phá»©c táº¡p thá»i gian.</p>
<h4>2.3.1 Háº±ng sá»‘ <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></h4>
<p>Trong háº§u háº¿t cÃ¡c trÆ°á»ng há»£p, náº¿u thuáº­t toÃ¡n khÃ´ng cÃ³ vÃ²ng láº·p, khÃ´ng cÃ³ Ä‘á»‡ quy, thÃ¬ Ä‘á»™ phá»©c táº¡p thá»i gian cá»§a nÃ³ lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>.</p>
<p><span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> chá»‰ lÃ  má»™t cÃ¡ch biá»ƒu thá»‹ cho Ä‘á»™ phá»©c táº¡p thá»i gian cá»§a háº±ng sá»‘, khÃ´ng pháº£i chá»‰ cÃ³ má»™t dÃ²ng mÃ£ Ä‘Æ°á»£c thá»±c thi. Miá»…n lÃ  thá»i gian thá»±c hiá»‡n mÃ£ khÃ´ng tÄƒng lÃªn theo kÃ­ch thÆ°á»›c cá»§a váº¥n Ä‘á» <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> tÄƒng lÃªn, thuáº­t toÃ¡n Ä‘Ã³ sáº½ cÃ³ Ä‘á»™ phá»©c táº¡p thá»i gian lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>.</p>
<div class="language-python" data-ext="python" data-title="python"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">def</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> algorithm</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#D19A66;--shiki-dark:#D19A66;font-style:italic;--shiki-dark-font-style:italic">n</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    a </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    b </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 2</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    res </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> a </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">*</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> b </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">+</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> n</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    return</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> res</span></span></code></pre>
</div><p>MÃ£ trÃªn máº·c dÃ¹ cÃ³ <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn></mrow><annotation encoding="application/x-tex">4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span></span></span></span> dÃ²ng mÃ£, nhÆ°ng Ä‘á»™ phá»©c táº¡p thá»i gian cá»§a nÃ³ váº«n lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>, khÃ´ng pháº£i lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">3</span><span class="mclose">)</span></span></span></span>.</p>
<h4>2.3.2 Tuyáº¿n tÃ­nh <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></h4>
<p>Trong háº§u háº¿t cÃ¡c trÆ°á»ng há»£p, náº¿u cÃ³ vÃ²ng láº·p khÃ´ng lá»“ng nhau vÃ  sá»‘ láº§n thá»±c hiá»‡n cÃ¡c cÃ¢u lá»‡nh trong vÃ²ng láº·p lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> thÃ¬ thuáº­t toÃ¡n cÃ³ Ä‘á»™ phá»©c táº¡p thá»i gian tuyáº¿n tÃ­nh. Loáº¡i thuáº­t toÃ¡n nÃ y cÃ³ thá»i gian thá»±c hiá»‡n tÄƒng tuyáº¿n tÃ­nh theo kÃ­ch thÆ°á»›c cá»§a váº¥n Ä‘á» <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>.</p>
<div class="language-python" data-ext="python" data-title="python"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">def</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> algorithm</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#D19A66;--shiki-dark:#D19A66;font-style:italic;--shiki-dark-font-style:italic">n</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2">    sum</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 0</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    for</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> i </span><span style="color:#C678DD;--shiki-dark:#C678DD">in</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> range</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(n):</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2">        sum</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> +=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    return</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> sum</span></span></code></pre>
</div><p>Trong Ä‘oáº¡n mÃ£ trÃªn, sá»‘ láº§n thá»±c hiá»‡n cÃ¢u lá»‡nh <code>sum += 1</code> lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> láº§n, vÃ¬ váº­y Ä‘á»™ phá»©c táº¡p thá»i gian cá»§a Ä‘oáº¡n mÃ£ nÃ y lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>.</p>
<h4>2.3.3 Báº­c hai <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></h4>
<p>CÃ¡c thuáº­t toÃ¡n cÃ³ hai lá»›p lá»“ng nhau vÃ  sá»‘ láº§n thá»±c hiá»‡n cÃ¢u lá»‡nh trong má»—i lá»›p vÃ²ng láº·p lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> cÃ³ thá»i gian cháº¡y báº­c hai. Loáº¡i thuáº­t toÃ¡n nÃ y tÄƒng theo báº­c hai khi kÃ­ch thÆ°á»›c cá»§a váº¥n Ä‘á» <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> tÄƒng lÃªn.</p>
<div class="language-python" data-ext="python" data-title="python"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">def</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> algorithm</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#D19A66;--shiki-dark:#D19A66;font-style:italic;--shiki-dark-font-style:italic">n</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    res </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 0</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    for</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> i </span><span style="color:#C678DD;--shiki-dark:#C678DD">in</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> range</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(n):</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">        for</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> j </span><span style="color:#C678DD;--shiki-dark:#C678DD">in</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> range</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(n):</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">            res </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">+=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    return</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> res</span></span></code></pre>
</div><p>Trong Ä‘oáº¡n mÃ£ trÃªn, cÃ¢u lá»‡nh <code>res += 1</code> Ä‘Æ°á»£c thá»±c hiá»‡n trong hai vÃ²ng láº·p lá»“ng nhau, theo nguyÃªn táº¯c nhÃ¢n cá»§a Ä‘á»™ phá»©c táº¡p thá»i gian, sá»‘ láº§n thá»±c hiá»‡n Ä‘oáº¡n mÃ£ nÃ y lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>n</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">n^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> láº§n, vÃ¬ váº­y Ä‘á»™ phá»©c táº¡p thá»i gian cá»§a nÃ³ lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>.</p>
<h4>2.3.4 Giai thá»«a <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">!</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n!)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">!)</span></span></span></span></h4>
<p>Äá»™ phá»©c táº¡p thá»i gian giai thá»«a thÆ°á»ng xuáº¥t hiá»‡n trong cÃ¡c thuáº­t toÃ¡n liÃªn quan Ä‘áº¿n "sáº¯p xáº¿p hoÃ n toÃ n" hoáº·c "giáº£i quyáº¿t bÃ i toÃ¡n ngÆ°á»i du lá»‹ch theo cÃ¡ch tÃ¬m kiáº¿m vÃ©t cáº¡n". Loáº¡i thuáº­t toÃ¡n nÃ y tÄƒng theo giai thá»«a khi kÃ­ch thÆ°á»›c cá»§a váº¥n Ä‘á» <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> tÄƒng lÃªn.</p>
<div class="language-python" data-ext="python" data-title="python"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">def</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> permutations</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#D19A66;--shiki-dark:#D19A66;font-style:italic;--shiki-dark-font-style:italic">arr</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;font-style:italic;--shiki-dark-font-style:italic">start</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;font-style:italic;--shiki-dark-font-style:italic">end</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> start </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">==</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> end:</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2">        print</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(arr)</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">        return</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    for</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> i </span><span style="color:#C678DD;--shiki-dark:#C678DD">in</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> range</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(start, end):</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        arr[i], arr[start] </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> arr[start], arr[i]</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF">        permutations</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(arr, start </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">+</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, end)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        arr[i], arr[start] </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> arr[start], arr[i]</span></span></code></pre>
</div><p>Trong Ä‘oáº¡n mÃ£ trÃªn, thuáº­t toÃ¡n "sáº¯p xáº¿p Ä‘áº§y Ä‘á»§" Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng phÆ°Æ¡ng phÃ¡p Ä‘á»‡ quy. Giáº£ sá»­ Ä‘á»™ dÃ i cá»§a máº£ng <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>r</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">arr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">rr</span></span></span></span> lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>, vÃ²ng láº·p <code>for</code> á»Ÿ táº§ng thá»© nháº¥t thá»±c hiá»‡n <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> láº§n, vÃ²ng láº·p <code>for</code> á»Ÿ táº§ng thá»© hai thá»±c hiá»‡n <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> láº§n. Tiáº¿p tá»¥c nhÆ° váº­y, vÃ²ng láº·p <code>for</code> á»Ÿ táº§ng cuá»‘i cÃ¹ng thá»±c hiá»‡n 1 láº§n. Tá»•ng sá»‘ láº§n thá»±c hiá»‡n cá»§a táº¥t cáº£ cÃ¡c vÃ²ng láº·p lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>Ã—</mo><mo stretchy="false">(</mo><mi>n</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo><mo>Ã—</mo><mo stretchy="false">(</mo><mi>n</mi><mo>âˆ’</mo><mn>2</mn><mo stretchy="false">)</mo><mo>Ã—</mo><mo>â€¦</mo><mo>Ã—</mo><mn>2</mn><mo>Ã—</mo><mn>1</mn><mo>=</mo><mi>n</mi><mo stretchy="false">!</mo></mrow><annotation encoding="application/x-tex">n \times (n - 1) \times (n - 2) \times â€¦ \times 2 \times 1 = n!</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">n</span><span class="mclose">!</span></span></span></span> láº§n. Do Ä‘Ã³, sá»‘ láº§n thá»±c hiá»‡n cá»§a cÃ¢u lá»‡nh cÆ¡ báº£n trong vÃ²ng láº·p <code>for</code> lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo stretchy="false">!</mo></mrow><annotation encoding="application/x-tex">n!</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">n</span><span class="mclose">!</span></span></span></span> láº§n, vÃ¬ váº­y Ä‘á»™ phá»©c táº¡p thá»i gian tÆ°Æ¡ng á»©ng lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">!</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n!)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">!)</span></span></span></span>.</p>
<h4>2.3.5 Logarithm <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></h4>
<p>Thá»i gian cháº¡y theo Ä‘á»™ phá»©c táº¡p logarithm thÆ°á»ng xuáº¥t hiá»‡n trong cÃ¡c thuáº­t toÃ¡n "tÃ¬m kiáº¿m nhá»‹ phÃ¢n" hoáº·c "chia Ä‘á»ƒ trá»‹" khi chia má»™t váº¥n Ä‘á» thÃ nh hai pháº§n. Loáº¡i thuáº­t toÃ¡n nÃ y tÄƒng theo Ä‘á»™ phá»©c táº¡p logarithm khi kÃ­ch thÆ°á»›c cá»§a váº¥n Ä‘á» <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> tÄƒng lÃªn.</p>
<div class="language-python" data-ext="python" data-title="python"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">def</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> algorithm</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#D19A66;--shiki-dark:#D19A66;font-style:italic;--shiki-dark-font-style:italic">n</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    cnt </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    while</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> cnt </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&lt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> n:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        cnt </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">*=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 2</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    return</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> cnt</span></span></code></pre>
</div><p>Trong Ä‘oáº¡n mÃ£ trÃªn, thá»i gian cháº¡y cá»§a <code>cnt = 1</code> lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> vÃ  cÃ³ thá»ƒ bá» qua. Trong vÃ²ng láº·p <code>while</code>, biáº¿n <code>cnt</code> báº¯t Ä‘áº§u tá»« <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> vÃ  nhÃ¢n vá»›i <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span> sau má»—i vÃ²ng láº·p. Khi <code>cnt</code> lá»›n hÆ¡n hoáº·c báº±ng <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>, vÃ²ng láº·p káº¿t thÃºc. GiÃ¡ trá»‹ cá»§a biáº¿n <code>cnt</code> táº¡o thÃ nh má»™t dÃ£y sá»‘ há»c: <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>0</mn></msup><mo separator="true">,</mo><msup><mn>2</mn><mn>1</mn></msup><mo separator="true">,</mo><msup><mn>2</mn><mn>2</mn></msup><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><msup><mn>2</mn><mi>x</mi></msup></mrow><annotation encoding="application/x-tex">2^0, 2^1, 2^2, â€¦, 2^x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span>, dá»±a trÃªn phÆ°Æ¡ng trÃ¬nh <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>x</mi></msup><mo>=</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">2^x = n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6644em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>, ta cÃ³ thá»ƒ suy ra sá»‘ láº§n thá»±c hiá»‡n vÃ²ng láº·p nÃ y lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi>log</mi><mo>â¡</mo></mrow><mn>2</mn></msub><mi>n</mi></mrow><annotation encoding="application/x-tex">\log_2n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9386em;vertical-align:-0.2441em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span></span></span></span> láº§n, do Ä‘Ã³ Ä‘á»™ phá»©c táº¡p thá»i gian cá»§a Ä‘oáº¡n mÃ£ nÃ y lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msub><mrow><mi>log</mi><mo>â¡</mo></mrow><mn>2</mn></msub><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log_2n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>.</p>
<p>VÃ¬ <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>log</mi><mo>â¡</mo><mi>n</mi><mo>=</mo><mi>k</mi><mo>Ã—</mo><msub><mrow><mi>log</mi><mo>â¡</mo></mrow><mn>2</mn></msub><mi>n</mi></mrow><annotation encoding="application/x-tex">\log n = k \times \log_2 n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9386em;vertical-align:-0.2441em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span></span></span></span>, vá»›i <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>3.322</mn></mrow><annotation encoding="application/x-tex">k = 3.322</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3.322</span></span></span></span>, nÃªn sá»± khÃ¡c biá»‡t giá»¯a <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>log</mi><mo>â¡</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">\log n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span></span></span></span> vÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi>log</mi><mo>â¡</mo></mrow><mn>2</mn></msub><mi>n</mi></mrow><annotation encoding="application/x-tex">\log_2 n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9386em;vertical-align:-0.2441em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span></span></span></span> khÃ¡ nhá». Äá»ƒ tiá»‡n viáº¿t, thÆ°á»ng ta viáº¿t Ä‘á»™ phá»©c táº¡p thá»i gian theo dáº¡ng <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>.</p>
<h4>2.3.6 Linearithmic <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>Ã—</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n \times \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></h4>
<p>Äá»™ phá»©c táº¡p thá»i gian linearithmic thÆ°á»ng xuáº¥t hiá»‡n trong cÃ¡c thuáº­t toÃ¡n sáº¯p xáº¿p nhÆ° "quick sort", "merge sort", "heap sort", v.v. Loáº¡i thuáº­t toÃ¡n nÃ y tÄƒng theo Ä‘á»™ phá»©c táº¡p linearithmic khi kÃ­ch thÆ°á»›c cá»§a váº¥n Ä‘á» <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> tÄƒng lÃªn.</p>
<div class="language-python" data-ext="python" data-title="python"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">def</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> algorithm</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#D19A66;--shiki-dark:#D19A66;font-style:italic;--shiki-dark-font-style:italic">n</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    cnt </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    res </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 0</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    while</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> cnt </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&lt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> n:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        cnt </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">*=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 2</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">        for</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> i </span><span style="color:#C678DD;--shiki-dark:#C678DD">in</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> range</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(n):</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">            res </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">+=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    return</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> res</span></span></code></pre>
</div><p>Trong Ä‘oáº¡n mÃ£ trÃªn, Ä‘á»™ phá»©c táº¡p thá»i gian cá»§a vÃ²ng láº·p bÃªn ngoÃ i lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>, Ä‘á»™ phá»©c táº¡p thá»i gian cá»§a vÃ²ng láº·p bÃªn trong lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>, vÃ  hai vÃ²ng láº·p nÃ y Ä‘á»™c láº­p vá»›i nhau. Do Ä‘Ã³, Ä‘á»™ phá»©c táº¡p thá»i gian tá»•ng thá»ƒ lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>Ã—</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n \times \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>.</p>
<h4>2.3.7 CÃ¡c má»‘i quan há»‡ Äá»™ phá»©c táº¡p thá»i gian thÆ°á»ng gáº·p</h4>
<p>Sáº¯p xáº¿p theo thá»© tá»± tÄƒng dáº§n, cÃ¡c Äá»™ phá»©c táº¡p thá»i gian thÆ°á»ng gáº·p lÃ : <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> &lt; <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> &lt; <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> &lt; <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>Ã—</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n \times \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> &lt; <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> &lt; <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> &lt; <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mi>n</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(2^n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> &lt; <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">!</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n!)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">!)</span></span></span></span> &lt; <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mi>n</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>.</p>
<h3>2.4 Äá»™ phá»©c táº¡p thá»i gian tá»‘t nháº¥t, tá»‡ nháº¥t vÃ  trung bÃ¬nh</h3>
<p>Äá»™ phá»©c táº¡p thá»i gian lÃ  má»™t hÃ m phá»¥ thuá»™c vÃ o kÃ­ch thÆ°á»›c cá»§a váº¥n Ä‘á» Ä‘áº§u vÃ o <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>. Tuy nhiÃªn, do ná»™i dung cá»§a váº¥n Ä‘á» Ä‘áº§u vÃ o cÃ³ thá»ƒ khÃ¡c nhau, chÃºng ta thÆ°á»ng chia "Äá»™ phá»©c táº¡p thá»i gian" thÃ nh ba trÆ°á»ng há»£p: "tá»‘t nháº¥t", "xáº¥u nháº¥t" vÃ  "trung bÃ¬nh". Ã nghÄ©a cá»¥ thá»ƒ cá»§a ba trÆ°á»ng há»£p nÃ y nhÆ° sau:</p>
<ul>
<li><strong>Äá»™ phá»©c táº¡p thá»i gian tá»‘t nháº¥t</strong>: Äá»™ phá»©c táº¡p thá»i gian cá»§a Ä‘áº§u vÃ o mÃ  cÃ³ thá»i gian thá»±c thi ngáº¯n nháº¥t trong táº¥t cáº£ cÃ¡c kÃ­ch thÆ°á»›c Ä‘áº§u vÃ o.</li>
<li><strong>Äá»™ phá»©c táº¡p thá»i gian xáº¥u nháº¥t</strong>: Äá»™ phá»©c táº¡p thá»i gian cá»§a Ä‘áº§u vÃ o mÃ  cÃ³ thá»i gian thá»±c thi dÃ i nháº¥t trong táº¥t cáº£ cÃ¡c kÃ­ch thÆ°á»›c Ä‘áº§u vÃ o.</li>
<li><strong>Äá»™ phá»©c táº¡p thá»i gian trung bÃ¬nh</strong>: Äá»™ phá»©c táº¡p thá»i gian trung bÃ¬nh cá»§a táº¥t cáº£ cÃ¡c Ä‘áº§u vÃ o cÃ³ thá»ƒ cÃ³ (Äá»™ phá»©c táº¡p thá»i gian trung bÃ¬nh theo ká»³ vá»ng trong trÆ°á»ng há»£p Ä‘áº§u vÃ o ngáº«u nhiÃªn).</li>
</ul>
<p>ChÃºng ta sáº½ phÃ¢n tÃ­ch vÃ­ dá»¥ sau Ä‘á»ƒ hiá»ƒu rÃµ hÆ¡n vá» Äá»™ phá»©c táº¡p thá»i gian tá»‘t nháº¥t, xáº¥u nháº¥t vÃ  trung bÃ¬nh.</p>
<div class="language-python" data-ext="python" data-title="python"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">def</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> find</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#D19A66;--shiki-dark:#D19A66;font-style:italic;--shiki-dark-font-style:italic">nums</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;font-style:italic;--shiki-dark-font-style:italic">val</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    pos </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> -</span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    for</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> i </span><span style="color:#C678DD;--shiki-dark:#C678DD">in</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> range</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(n):</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">        if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> nums[i] </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">==</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> val:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">            pos </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> i</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">            break</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    return</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> pos</span></span></code></pre>
</div><p>Äoáº¡n mÃ£ trÃªn Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ¬m vá»‹ trÃ­ cá»§a biáº¿n cÃ³ giÃ¡ trá»‹ <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mi>a</mi><mi>l</mi></mrow><annotation encoding="application/x-tex">val</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span> trong má»™t máº£ng sá»‘ nguyÃªn <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>u</mi><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">nums</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span>. Náº¿u khÃ´ng xÃ©t Ä‘áº¿n cÃ¢u lá»‡nh <code>break</code>, theo phÃ¢n tÃ­ch trong pháº§n "2.3 Äá»™ phá»©c táº¡p thá»i gian", thÃ¬ Äá»™ phá»©c táº¡p thá»i gian cá»§a thuáº­t toÃ¡n nÃ y lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>, trong Ä‘Ã³ <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> lÃ  Ä‘á»™ dÃ i cá»§a máº£ng.</p>
<p>Tuy nhiÃªn, náº¿u xÃ©t Ä‘áº¿n cÃ¢u lá»‡nh <code>break</code>, chÃºng ta cáº§n xem xÃ©t ná»™i dung Ä‘áº§u vÃ o. Náº¿u giÃ¡ trá»‹ cá»§a pháº§n tá»­ Ä‘áº§u tiÃªn trong máº£ng <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>u</mi><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">nums</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span> chÃ­nh lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mi>a</mi><mi>l</mi></mrow><annotation encoding="application/x-tex">val</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span>, thÃ¬ khÃ´ng cáº§n duyá»‡t qua cÃ¡c pháº§n tá»­ cÃ²n láº¡i, Äá»™ phá»©c táº¡p thá»i gian sáº½ lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>, tá»©c lÃ  Äá»™ phá»©c táº¡p thá»i gian tá»‘t nháº¥t lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>. Náº¿u máº£ng khÃ´ng chá»©a biáº¿n cÃ³ giÃ¡ trá»‹ <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mi>a</mi><mi>l</mi></mrow><annotation encoding="application/x-tex">val</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span>, thÃ¬ cáº§n duyá»‡t qua toÃ n bá»™ máº£ng, Äá»™ phá»©c táº¡p thá»i gian sáº½ lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>, tá»©c lÃ  Äá»™ phá»©c táº¡p thá»i gian xáº¥u nháº¥t lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>.</p>
<p>NhÆ° váº­y, Äá»™ phá»©c táº¡p thá»i gian khÃ´ng cÃ²n lÃ  duy nháº¥t. LÃ m tháº¿ nÃ o Ä‘á»ƒ giáº£i quyáº¿t?</p>
<p>ChÃºng ta Ä‘á»u biáº¿t ráº±ng, Ä‘á»™ phá»©c táº¡p thá»i gian tá»‘t nháº¥t vÃ  Ä‘á»™ phá»©c táº¡p thá»i gian xáº¥u nháº¥t chá»‰ xáº£y ra trong cÃ¡c trÆ°á»ng há»£p cá»±c Ä‘oan, vÃ  xÃ¡c suáº¥t xáº£y ra thá»±c sá»± ráº¥t nhá». Äá»ƒ cÃ³ thá»ƒ mÃ´ táº£ tá»‘t hÆ¡n Ä‘á»™ phá»©c táº¡p thá»i gian trong Ä‘iá»u kiá»‡n bÃ¬nh thÆ°á»ng, chÃºng ta thÆ°á»ng sá»­ dá»¥ng Ä‘á»™ phá»©c táº¡p thá»i gian trung bÃ¬nh lÃ m cÃ¡ch tÃ­nh Ä‘á»™ phá»©c táº¡p thá»i gian.</p>
<p>Trong vÃ­ dá»¥ trÃªn, Ä‘á»ƒ tÃ¬m vá»‹ trÃ­ cá»§a biáº¿n cÃ³ giÃ¡ trá»‹ <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mi>a</mi><mi>l</mi></mrow><annotation encoding="application/x-tex">val</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span> trong máº£ng <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>u</mi><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">nums</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span>, cÃ³ tá»•ng cá»™ng <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> trÆ°á»ng há»£p: "cÃ³ trong máº£ng tá»« vá»‹ trÃ­ <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> Ä‘áº¿n <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>" vÃ  "khÃ´ng cÃ³ trong máº£ng". ChÃºng ta tÃ­nh tá»•ng sá»‘ láº§n thá»±c hiá»‡n cÃ¢u lá»‡nh trong táº¥t cáº£ cÃ¡c trÆ°á»ng há»£p, sau Ä‘Ã³ chia cho <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>, sáº½ thu Ä‘Æ°á»£c sá»‘ láº§n thá»±c hiá»‡n trung bÃ¬nh, tá»©c lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mn>1</mn><mo>+</mo><mn>2</mn><mo>+</mo><mn>3</mn><mo>+</mo><mo>â€¦</mo><mo>+</mo><mi>n</mi><mo>+</mo><mi>n</mi></mrow><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>n</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>3</mn><mo stretchy="false">)</mo></mrow><mrow><mn>2</mn><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{1 + 2 + 3 + â€¦ + n + n}{n + 1} = \frac{n(n + 3)}{2(n + 1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2484em;vertical-align:-0.4033em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord mtight">2</span><span class="mbin mtight">+</span><span class="mord mtight">3</span><span class="mbin mtight">+</span><span class="minner mtight">â€¦</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">3</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>. Sau khi rÃºt gá»n biá»ƒu thá»©c, ta thu Ä‘Æ°á»£c Ä‘á»™ phá»©c táº¡p thá»i gian trung bÃ¬nh lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>.</p>
<p>ThÆ°á»ng thÃ¬ chá»‰ khi cÃ¹ng má»™t thuáº­t toÃ¡n cÃ³ sá»± khÃ¡c biá»‡t vá» Ä‘á»™ phá»©c táº¡p thá»i gian Ä‘Ã¡ng ká»ƒ giá»¯a cÃ¡c trÆ°á»ng há»£p Ä‘áº§u vÃ o khÃ¡c nhau, chÃºng ta má»›i sá»­ dá»¥ng ba cÃ¡ch tÃ­nh Ä‘á»™ phá»©c táº¡p thá»i gian nÃ y Ä‘á»ƒ phÃ¢n biá»‡t. Trong háº§u háº¿t cÃ¡c trÆ°á»ng há»£p, chá»‰ cáº§n sá»­ dá»¥ng má»™t trong ba cÃ¡ch tÃ­nh Ä‘á»™ phá»©c táº¡p thá»i gian lÃ  Ä‘á»§.</p>
<h2>3. Äá»™ phá»©c táº¡p khÃ´ng gian</h2>
<h3>3.1 Giá»›i thiá»‡u vá» Ä‘á»™ phá»©c táº¡p khÃ´ng gian</h3>
<blockquote>
<p><strong>Äá»™ phá»©c táº¡p khÃ´ng gian (Space Complexity)</strong>: LÃ  kÃ­ch thÆ°á»›c khÃ´ng gian mÃ  thuáº­t toÃ¡n sá»­ dá»¥ng dá»±a trÃªn kÃ­ch thÆ°á»›c Ä‘áº§u vÃ o <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> cá»§a váº¥n Ä‘á». Äá»™ phá»©c táº¡p khÃ´ng gian thÆ°á»ng Ä‘Æ°á»£c kÃ½ hiá»‡u lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">S(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>. ThÃ´ng thÆ°á»ng, <strong>khÃ´ng gian phá»¥ trá»£ cá»§a thuáº­t toÃ¡n</strong> Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘o lÆ°á»ng Ä‘á»™ phá»©c táº¡p khÃ´ng gian.</p>
</blockquote>
<p>NgoÃ i thá»i gian thá»±c thi, sá»‘ lÆ°á»£ng khÃ´ng gian lÆ°u trá»¯ mÃ  thuáº­t toÃ¡n sá»­ dá»¥ng cÅ©ng lÃ  má»™t yáº¿u tá»‘ quan trá»ng Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ hiá»‡u suáº¥t. CÃ¡c biá»ƒu thá»©c Ä‘Ã¡nh giÃ¡ Ä‘á»™ phá»©c táº¡p khÃ´ng gian cÅ©ng Ã¡p dá»¥ng cÃ¡c biá»ƒu tÆ°á»£ng tÄƒng trÆ°á»Ÿng tÆ°Æ¡ng tá»± nhÆ° Ä‘á»™ phá»©c táº¡p thá»i gian. Äá»™ phá»©c táº¡p khÃ´ng gian cÃ³ thá»ƒ Ä‘Æ°á»£c biá»ƒu diá»…n dÆ°á»›i dáº¡ng <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">S(n) = O(f(n))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span></span></span></span>, trong Ä‘Ã³ Ä‘á»™ phá»©c táº¡p khÃ´ng gian tÄƒng theo cÃ¹ng má»™t xu hÆ°á»›ng vá»›i hÃ m <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> khi kÃ­ch thÆ°á»›c váº¥n Ä‘á» <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> tÄƒng lÃªn.</p>
<p>So vá»›i viá»‡c tÃ­nh toÃ¡n Ä‘á»™ phá»©c táº¡p thá»i gian cá»§a thuáº­t toÃ¡n, tÃ­nh toÃ¡n Ä‘á»™ phá»©c táº¡p khÃ´ng gian dá»… hÆ¡n vÃ  chá»§ yáº¿u bao gá»“m hai pháº§n: "khÃ´ng gian lÆ°u trá»¯ mÃ  biáº¿n cá»¥c bá»™ (biáº¿n Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong pháº¡m vi thuáº­t toÃ¡n) chiáº¿m" vÃ  "khÃ´ng gian ngÄƒn xáº¿p mÃ  há»‡ thá»‘ng sá»­ dá»¥ng Ä‘á»ƒ thá»±c hiá»‡n Ä‘á»‡ quy (náº¿u thuáº­t toÃ¡n lÃ  Ä‘á»‡ quy)".</p>
<p>DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ Ä‘á»ƒ minh há»a cÃ¡ch tÃ­nh toÃ¡n Ä‘á»™ phá»©c táº¡p khÃ´ng gian.</p>
<h3>3.1 TÃ­nh toÃ¡n Ä‘á»™ phá»©c táº¡p khÃ´ng gian</h3>
<h4>3.1.1 Háº±ng sá»‘ <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></h4>
<div class="language-python" data-ext="python" data-title="python"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">def</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> algorithm</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#D19A66;--shiki-dark:#D19A66;font-style:italic;--shiki-dark-font-style:italic">n</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    a </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    b </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 2</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    res </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> a </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">*</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> b </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">+</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> n</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    return</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> res</span></span></code></pre>
</div><p>Trong Ä‘oáº¡n mÃ£ trÃªn, chÃºng ta sá»­ dá»¥ng <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>,<span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>, vÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>e</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">res</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">res</span></span></span></span> lÃ  ba biáº¿n cá»¥c bá»™. KÃ­ch thÆ°á»›c khÃ´ng gian mÃ  chÃºng chiáº¿m giá»¯ lÃ  háº±ng sá»‘ vÃ  khÃ´ng tÄƒng theo kÃ­ch thÆ°á»›c váº¥n Ä‘á» <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>. Do Ä‘Ã³, Ä‘á»™ phá»©c táº¡p khÃ´ng gian cá»§a thuáº­t toÃ¡n nÃ y lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>.</p>
<h4>3.1.2 Tuyáº¿n tÃ­nh <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></h4>
<div class="language-python" data-ext="python" data-title="python"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">def</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> algorithm</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#D19A66;--shiki-dark:#D19A66;font-style:italic;--shiki-dark-font-style:italic">n</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> n </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&lt;=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">        return</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    return</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> n </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">*</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> algorithm</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(n </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)</span></span></code></pre>
</div><p>Trong Ä‘oáº¡n mÃ£ trÃªn, chÃºng ta sá»­ dá»¥ng Ä‘á»‡ quy. Má»—i láº§n gá»i Ä‘á»‡ quy chiáº¿m má»™t khung ngÄƒn xáº¿p, vÃ  tá»•ng cá»™ng cÃ³ <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> láº§n gá»i Ä‘á»‡ quy. Do Ä‘Ã³, Ä‘á»™ phá»©c táº¡p khÃ´ng gian cá»§a thuáº­t toÃ¡n nÃ y lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>.</p>
<h4>3.1.3 Má»‘i quan há»‡ Ä‘á»™ phá»©c táº¡p khÃ´ng gian thÃ´ng thÆ°á»ng</h4>
<p>Sáº¯p xáº¿p theo thá»© tá»± tÄƒng dáº§n, cÃ¡c Ä‘á»™ phá»©c táº¡p khÃ´ng gian thÃ´ng thÆ°á»ng lÃ : <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> &lt; <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> &lt; <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> &lt; <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> &lt; <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mi>n</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(2^n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> vÃ  cÃ¡c giÃ¡ trá»‹ tÆ°Æ¡ng tá»±.</p>
<h2>Tá»•ng káº¿t vá» Ä‘á»™ phá»©c táº¡p cá»§a thuáº­t toÃ¡n</h2>
<p><strong>"Äá»™ phá»©c táº¡p cá»§a thuáº­t toÃ¡n"</strong> bao gá»“m <strong>"Ä‘á»™ phá»©c táº¡p thá»i gian"</strong> vÃ  <strong>"Ä‘á»™ phá»©c táº¡p khÃ´ng gian"</strong>, Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ phÃ¢n tÃ­ch má»‘i quan há»‡ giá»¯a hiá»‡u suáº¥t thá»±c thi cá»§a thuáº­t toÃ¡n vÃ  kÃ­ch thÆ°á»›c Ä‘áº§u vÃ o <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>. ThÃ´ng thÆ°á»ng, chÃºng Ä‘Æ°á»£c biá»ƒu diá»…n báº±ng <strong>"biá»ƒu tÆ°á»£ng tiá»‡m cáº­n"</strong>.</p>
<p>CÃ¡c Ä‘á»™ phá»©c táº¡p thá»i gian phá»• biáº¿n bao gá»“m: <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>, <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>, <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>, <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>Ã—</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n \times \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>, <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mi>n</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(2^n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">!</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n!)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">!)</span></span></span></span>.</p>
<p>CÃ¡c Ä‘á»™ phá»©c táº¡p khÃ´ng gian phá»• biáº¿n bao gá»“m: <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>Ã¥, <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>, <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>, <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>.<br>
Ï€</p>
]]></content:encoded>
      <enclosure url="https://raw.githubusercontent.com/vanhung4499/images/master/snap/202309240915919.png" type="image/png"/>
    </item>
    <item>
      <title>Introduction</title>
      <link>https://vanhung4499.github.io/dsa/intro/introduction.html</link>
      <guid>https://vanhung4499.github.io/dsa/intro/introduction.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">Introduction</source>
      <description>Cáº¥u trÃºc dá»¯ liá»‡u vÃ  giáº£i thuáº­t Giáº£i thuáº­t lÃ  cá»‘t lÃµi cá»§a chÆ°Æ¡ng trÃ¬nh, trong khi cáº¥u trÃºc dá»¯ liá»‡u lÃ  linh há»“n cá»§a chÆ°Æ¡ng trÃ¬nh. Algorithm + Data Structure = Program lÃ  má»™t cuá»‘n ...</description>
      <category>dsa</category>
      <category>algorithm</category>
      <category>data-structure</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>Giáº£i thuáº­t lÃ  cá»‘t lÃµi cá»§a chÆ°Æ¡ng trÃ¬nh, trong khi cáº¥u trÃºc dá»¯ liá»‡u lÃ  linh há»“n cá»§a chÆ°Æ¡ng trÃ¬nh.</p>
</blockquote>
<p><strong>Algorithm + Data Structure = Program</strong> lÃ  má»™t cuá»‘n sÃ¡ch ráº¥t ná»•i tiáº¿ng do <a href="https://vi.wikipedia.org/wiki/Niklaus_Wirth" target="_blank" rel="noopener noreferrer">Niklaus Wirth</a>, cha Ä‘áº» cá»§a ngÃ´n ngá»¯ Pascal, viáº¿t. CÃ¢u nÃ y cÅ©ng trá»Ÿ thÃ nh má»™t cÃ¢u nÃ³i kinh Ä‘iá»ƒn trong lÄ©nh vá»±c khoa há»c mÃ¡y tÃ­nh. Äiá»u nÃ y cho tháº¥y má»‘i quan há»‡ máº­t thiáº¿t giá»¯a giáº£i thuáº­t vÃ  cáº¥u trÃºc dá»¯ liá»‡u trong láº­p trÃ¬nh.</p>
<p>TrÆ°á»›c khi há»c, chÃºng ta cáº§n hiá»ƒu rÃµ giáº£i thuáº­t lÃ  gÃ¬ vÃ  cáº¥u trÃºc dá»¯ liá»‡u lÃ  gÃ¬? Táº¡i sao chÃºng ta cáº§n há»c giáº£i thuáº­t vÃ  cáº¥u trÃºc dá»¯ liá»‡u?</p>
<p>ÄÆ¡n giáº£n, <strong>giáº£i thuáº­t</strong> lÃ  phÆ°Æ¡ng phÃ¡p hoáº·c quy trÃ¬nh Ä‘á»ƒ giáº£i quyáº¿t váº¥n Ä‘á». Náº¿u chÃºng ta coi váº¥n Ä‘á» nhÆ° má»™t hÃ m, thÃ¬ giáº£i thuáº­t lÃ  quÃ¡ trÃ¬nh chuyá»ƒn Ä‘á»•i Ä‘áº§u vÃ o thÃ nh Ä‘áº§u ra. <strong>Cáº¥u trÃºc dá»¯ liá»‡u</strong> lÃ  cÃ¡ch biá»ƒu diá»…n dá»¯ liá»‡u vÃ  táº­p há»£p cÃ¡c hoáº¡t Ä‘á»™ng tÆ°Æ¡ng á»©ng. <strong>ChÆ°Æ¡ng trÃ¬nh</strong> lÃ  sá»± thá»±c hiá»‡n cá»¥ thá»ƒ cá»§a giáº£i thuáº­t vÃ  cáº¥u trÃºc dá»¯ liá»‡u.</p>
<p>Náº¿u chÃºng ta so sÃ¡nh <strong>thiáº¿t káº¿ chÆ°Æ¡ng trÃ¬nh</strong> vá»›i viá»‡c náº¥u Äƒn, thÃ¬ <strong>cáº¥u trÃºc dá»¯ liá»‡u</strong> tÆ°Æ¡ng á»©ng vá»›i nguyÃªn liá»‡u vÃ  gia vá»‹, trong khi <strong>giáº£i thuáº­t</strong> tÆ°Æ¡ng á»©ng vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p náº¥u Äƒn khÃ¡c nhau, hoáº·c cÃ³ thá»ƒ coi lÃ  cÃ´ng thá»©c náº¥u Äƒn. CÃ¹ng má»™t nguyÃªn liá»‡u vÃ  gia vá»‹, nhÆ°ng khi Ä‘Æ°á»£c náº¥u bá»Ÿi cÃ¡c ngÆ°á»i khÃ¡c nhau, hÆ°Æ¡ng vá»‹ sáº½ khÃ¡c nhau.</p>
<p>Váº­y táº¡i sao chÃºng ta cáº§n há»c giáº£i thuáº­t vÃ  cáº¥u trÃºc dá»¯ liá»‡u?</p>
<p>Tiáº¿p tá»¥c vá»›i vÃ­ dá»¥ náº¥u Äƒn. ChÃºng ta muá»‘n mÃ³n Äƒn cá»§a mÃ¬nh cÃ³ <strong>mÃ u sáº¯c, mÃ¹i thÆ¡m vÃ  hÆ°Æ¡ng vá»‹ Ä‘áº§y Ä‘á»§</strong>. Trong láº­p trÃ¬nh, chÃºng ta cÅ©ng tÃ¬m kiáº¿m: lá»±a chá»n cáº¥u trÃºc dá»¯ liá»‡u phÃ¹ há»£p hÆ¡n, sá»­ dá»¥ng giáº£i thuáº­t tá»‘n Ã­t thá»i gian vÃ  chiáº¿m Ã­t khÃ´ng gian.</p>
<p>ChÃºng ta há»c giáº£i thuáº­t vÃ  cáº¥u trÃºc dá»¯ liá»‡u Ä‘á»ƒ cÃ³ thá»ƒ suy nghÄ© vá» giáº£i phÃ¡p tá»« khÃ­a cáº¡nh Ä‘á»™ phá»©c táº¡p vá» thá»i gian vÃ  khÃ´ng gian, rÃ¨n luyá»‡n tÆ° duy logic cá»§a mÃ¬nh, tá»« Ä‘Ã³ viáº¿t ra mÃ£ nguá»“n cháº¥t lÆ°á»£ng cao, tá»« Ä‘Ã³ nÃ¢ng cao ká»¹ nÄƒng láº­p trÃ¬nh cá»§a mÃ¬nh vÃ  Ä‘áº¡t Ä‘Æ°á»£c pháº§n thÆ°á»Ÿng cÃ´ng viá»‡c cao hÆ¡n.</p>
<p>Táº¥t nhiÃªn, Ä‘iá»u nÃ y giá»‘ng nhÆ° viá»‡c náº¥u Äƒn, náº¯m vá»¯ng nguyÃªn liá»‡u vÃ  gia vá»‹, há»c cÃ¡ch náº¥u Äƒn, khÃ´ng cÃ³ nghÄ©a lÃ  báº¡n sáº½ náº¥u ra má»™t mÃ³n Äƒn ngon. TÆ°Æ¡ng tá»±, viá»‡c náº¯m vá»¯ng giáº£i thuáº­t vÃ  cáº¥u trÃºc dá»¯ liá»‡u khÃ´ng cÃ³ nghÄ©a lÃ  báº¡n sáº½ biáº¿t viáº¿t chÆ°Æ¡ng trÃ¬nh. Äiá»u nÃ y Ä‘Ã²i há»i sá»± suy nghÄ© vÃ  há»c há»i liÃªn tá»¥c, Ä‘á»ƒ trá»Ÿ thÃ nh má»™t láº­p trÃ¬nh viÃªn xuáº¥t sáº¯c.</p>
<h2>1. Cáº¥u trÃºc dá»¯ liá»‡u</h2>
<blockquote>
<p><strong>Cáº¥u trÃºc dá»¯ liá»‡u (Data Structure)</strong>: Táº­p há»£p cÃ¡c pháº§n tá»­ dá»¯ liá»‡u cÃ³ tÃ­nh cháº¥t cáº¥u trÃºc.</p>
</blockquote>
<p>ÄÆ¡n giáº£n mÃ  nÃ³i, <strong>"cáº¥u trÃºc dá»¯ liá»‡u"</strong> lÃ  cÃ¡ch tá»• chá»©c vÃ  lÆ°u trá»¯ dá»¯ liá»‡u.</p>
<p>Cá»¥ thá»ƒ hÆ¡n, cáº¥u trÃºc dá»¯ liá»‡u nghiÃªn cá»©u vá» cáº¥u trÃºc logic vÃ  cáº¥u trÃºc váº­t lÃ½ cá»§a dá»¯ liá»‡u, cÅ©ng nhÆ° má»‘i quan há»‡ giá»¯a chÃºng. NÃ³ Ä‘á»‹nh nghÄ©a cÃ¡c phÃ©p toÃ¡n tÆ°Æ¡ng á»©ng vÃ  thiáº¿t káº¿ cÃ¡c thuáº­t toÃ¡n tÆ°Æ¡ng á»©ng, Ä‘á»“ng thá»i Ä‘áº£m báº£o ráº±ng cáº¥u trÃºc má»›i sau cÃ¡c phÃ©p toÃ¡n váº«n giá»¯ nguyÃªn loáº¡i cáº¥u trÃºc ban Ä‘áº§u.</p>
<p>Cáº¥u trÃºc dá»¯ liá»‡u cÃ³ vai trÃ² quan trá»ng trong viá»‡c tá»‘i Æ°u hÃ³a viá»‡c sá»­ dá»¥ng pháº§n cá»©ng mÃ¡y tÃ­nh. VÃ­ dá»¥, há»‡ Ä‘iá»u hÃ nh muá»‘n tÃ¬m vá»‹ trÃ­ lÆ°u trá»¯ cá»§a á»©ng dá»¥ng <code>Microsoft Word</code> trÃªn Ä‘Ä©a cá»©ng. Náº¿u quÃ©t toÃ n bá»™ Ä‘Ä©a cá»©ng, hiá»‡u suáº¥t sáº½ ráº¥t kÃ©m. Tuy nhiÃªn, náº¿u sá»­ dá»¥ng cÃ¢y B+ lÃ m chá»‰ má»¥c, viá»‡c tÃ¬m kiáº¿m tá»« <code>Microsoft Word</code> sáº½ dá»… dÃ ng hÆ¡n vÃ  sau Ä‘Ã³ chá»‰ cáº§n tÃ¬m vá»‹ trÃ­ cá»§a á»©ng dá»¥ng trong thÃ´ng tin tá»‡p Ä‘á»ƒ xÃ¡c Ä‘á»‹nh vá»‹ trÃ­ trÃªn Ä‘Ä©a cá»©ng.</p>
<p>Há»c cáº¥u trÃºc dá»¯ liá»‡u giÃºp chÃºng ta hiá»ƒu vÃ  náº¯m vá»¯ng cÃ¡ch dá»¯ liá»‡u Ä‘Æ°á»£c tá»• chá»©c vÃ  lÆ°u trá»¯ trong mÃ¡y tÃ­nh.</p>
]]></content:encoded>
    </item>
    <item>
      <title>LeetCode 0034</title>
      <link>https://vanhung4499.github.io/dsa/leetcode/LeetCode%200034.html</link>
      <guid>https://vanhung4499.github.io/dsa/leetcode/LeetCode%200034.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">LeetCode 0034</source>
      <description>0034. TÃ¬m vá»‹ trÃ­ Ä‘áº§u tiÃªn vÃ  cuá»‘i cÃ¹ng cá»§a pháº§n tá»­ trong máº£ng Ä‘Ã£ sáº¯p xáº¿p Tháº»: Máº£ng, TÃ¬m kiáº¿m nhá»‹ phÃ¢n Äá»™ khÃ³: Trung bÃ¬nh TÃ³m táº¯t Ä‘á» bÃ i MÃ´ táº£: Cho má»™t máº£ng sá»‘ nguyÃªn nums Ä‘Ã£ Ä‘Æ°á»£...</description>
      <category>dsa</category>
      <category>leetcode</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<ul>
<li>Tháº»: Máº£ng, TÃ¬m kiáº¿m nhá»‹ phÃ¢n</li>
<li>Äá»™ khÃ³: Trung bÃ¬nh</li>
</ul>
<h2>TÃ³m táº¯t Ä‘á» bÃ i</h2>
<p><strong>MÃ´ táº£</strong>: Cho má»™t máº£ng sá»‘ nguyÃªn <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>u</mi><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">nums</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span> Ä‘Ã£ Ä‘Æ°á»£c sáº¯p xáº¿p theo thá»© tá»± khÃ´ng giáº£m vÃ  má»™t giÃ¡ trá»‹ má»¥c tiÃªu <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">target</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span></span></span></span>.</p>
<p><strong>YÃªu cáº§u</strong>: TÃ¬m vá»‹ trÃ­ báº¯t Ä‘áº§u vÃ  káº¿t thÃºc cá»§a giÃ¡ trá»‹ má»¥c tiÃªu trong máº£ng.</p>
<p><strong>Giáº£i thÃ­ch</strong>:</p>
<ul>
<li>YÃªu cáº§u sá»­ dá»¥ng thuáº­t toÃ¡n cÃ³ Ä‘á»™ phá»©c táº¡p thá»i gian lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>.</li>
</ul>
<p><strong>VÃ­ dá»¥</strong>:</p>
<ul>
<li>VÃ­ dá»¥ 1:</li>
</ul>
<div class="language-python" data-ext="python" data-title="python"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">Input: nums </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span><span style="color:#D19A66;--shiki-dark:#D19A66">5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#D19A66;--shiki-dark:#D19A66">7</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#D19A66;--shiki-dark:#D19A66">7</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#D19A66;--shiki-dark:#D19A66">8</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#D19A66;--shiki-dark:#D19A66">8</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#D19A66;--shiki-dark:#D19A66">10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">], target </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 8</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">Output: [</span><span style="color:#D19A66;--shiki-dark:#D19A66">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#D19A66;--shiki-dark:#D19A66">4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">]</span></span></code></pre>
</div><ul>
<li>VÃ­ dá»¥ 2:</li>
</ul>
<div class="language-python" data-ext="python" data-title="python"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">Input: nums </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span><span style="color:#D19A66;--shiki-dark:#D19A66">5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#D19A66;--shiki-dark:#D19A66">7</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#D19A66;--shiki-dark:#D19A66">7</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#D19A66;--shiki-dark:#D19A66">8</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#D19A66;--shiki-dark:#D19A66">8</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#D19A66;--shiki-dark:#D19A66">10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">], target </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 6</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">Output: [</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">]</span></span></code></pre>
</div><h2>Ã tÆ°á»Ÿng</h2>
<h3>Ã tÆ°á»Ÿng 1: TÃ¬m kiáº¿m nhá»‹ phÃ¢n</h3>
<p>Thá»±c hiá»‡n hai láº§n tÃ¬m kiáº¿m nhá»‹ phÃ¢n, láº§n Ä‘áº§u tiÃªn tÃ¬m kiáº¿m sang trÃ¡i cÃ ng xa cÃ ng tá»‘t. Láº§n thá»© hai tÃ¬m kiáº¿m sang pháº£i cÃ ng xa cÃ ng tá»‘t.</p>
<h3>Ã tÆ°á»Ÿng 1: Code</h3>
<div class="language-python line-numbers-mode" data-ext="python" data-title="python"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B"> Solution</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    def</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> searchRange</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;font-style:italic;--shiki-dark-font-style:italic">self</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;font-style:italic;--shiki-dark-font-style:italic">nums</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: List[</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">int</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">], </span><span style="color:#D19A66;--shiki-dark:#D19A66;font-style:italic;--shiki-dark-font-style:italic">target</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">int</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) -&gt; List[</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">int</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">]:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        ans </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">]</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        n </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> len</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(nums)</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">        if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> n </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">==</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">            return</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> ans</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        left </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 0</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        right </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> n </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">        while</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> left </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&lt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> right:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">            mid </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> left </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">+</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> (right </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> left) </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">//</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 2</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">            if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> nums[mid] </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&lt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> target:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">                left </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> mid </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">+</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">            else</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">                right </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> mid</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">        if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> nums[left] </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">!=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> target:</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">            return</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> ans</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        ans[</span><span style="color:#D19A66;--shiki-dark:#D19A66">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">] </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> left</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        left </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 0</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        right </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> n </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">        while</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> left </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&lt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> right:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">            mid </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> left </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">+</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> (right </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> left </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">+</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">//</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 2</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">            if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> nums[mid] </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> target:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">                right </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> mid </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">            else</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">                left </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> mid</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">        if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> nums[left] </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">==</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> target:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">            ans[</span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">] </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> left</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">        return</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> ans</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>Ã tÆ°á»Ÿng 1: Äá»™ phá»©c táº¡p</h3>
<ul>
<li><strong>Äá»™ phá»©c táº¡p thá»i gian</strong>: <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>.</li>
<li><strong>Äá»™ phá»©c táº¡p khÃ´ng gian</strong>: <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>.</li>
</ul>
<h3>Ã tÆ°á»Ÿng 2: Sá»­ dá»¥ng thÆ° viá»‡n</h3>
<p>Báº£n cháº¥t thÃ¬ viá»‡c sá»­ dá»¥ng thÆ° viá»‡n cÅ©ng lÃ  tÃ¬m kiáº¿m nhá»‹ phÃ¢n nhÆ°ng chÃºng ta cÃ³ thá»ƒ viáº¿t code ngáº¯n gá»n hÆ¡n nhÆ°ng váº«n khuyáº¿n khÃ­ch cÃ¡c báº¡n tá»± triá»ƒn khai Ä‘á»ƒ hiá»ƒu hÆ¡n vá» tÃ¬m kiáº¿m nhá»‹ phÃ¢n. Trong Python, ta dÃ¹ng <code>bisect.bisect_left</code>, trong C++ ta dÃ¹ng hÃ m <code>lower_bound</code> vÃ  <code>upper_bound</code>. CÃ¡c ngÃ´n ngá»¯ tÃ´i khÃ´ng náº¯m rÃµ nÃªn khÃ´ng trÃ¬nh bÃ y.</p>
<h3>Ã tÆ°á»Ÿng 2: Code</h3>
<div class="language-python" data-ext="python" data-title="python"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B"> Solution</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    def</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> searchRange</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;font-style:italic;--shiki-dark-font-style:italic">self</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;font-style:italic;--shiki-dark-font-style:italic">nums</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: List[</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">int</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">], </span><span style="color:#D19A66;--shiki-dark:#D19A66;font-style:italic;--shiki-dark-font-style:italic">target</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">int</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) -&gt; List[</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">int</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">]:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        l </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> bisect_left</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(nums, target)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        r </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> bisect_left</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(nums, target </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">+</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">        return</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">] </span><span style="color:#C678DD;--shiki-dark:#C678DD">if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> l </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">==</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> len</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(nums) </span><span style="color:#C678DD;--shiki-dark:#C678DD">or</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> l </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&gt;=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> r </span><span style="color:#C678DD;--shiki-dark:#C678DD">else</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [l, r </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">]</span></span></code></pre>
</div><div class="language-c++" data-ext="c++" data-title="c++"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B"> Solution</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">public:</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B">    vector</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&lt;</span><span style="color:#C678DD;--shiki-dark:#C678DD">int</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&gt; </span><span style="color:#61AFEF;--shiki-dark:#61AFEF">searchRange</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">vector</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&lt;</span><span style="color:#C678DD;--shiki-dark:#C678DD">int</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">&gt;</span><span style="color:#C678DD;--shiki-dark:#C678DD">&amp;</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic"> nums</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#C678DD;--shiki-dark:#C678DD">int</span><span style="color:#E06C75;--shiki-dark:#E06C75;font-style:italic;--shiki-dark-font-style:italic"> target</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">        int</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> l </span><span style="color:#C678DD;--shiki-dark:#C678DD">=</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> lower_bound</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">nums</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">begin</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(), </span><span style="color:#E5C07B;--shiki-dark:#E5C07B">nums</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">end</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(), target) </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#E5C07B;--shiki-dark:#E5C07B"> nums</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">begin</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">        if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> (l </span><span style="color:#C678DD;--shiki-dark:#C678DD">==</span><span style="color:#E5C07B;--shiki-dark:#E5C07B"> nums</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">size</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">() </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">||</span><span style="color:#E5C07B;--shiki-dark:#E5C07B"> nums</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">[l] </span><span style="color:#C678DD;--shiki-dark:#C678DD">!=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> target) </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">            return</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> {</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">};</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">        int</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> r </span><span style="color:#C678DD;--shiki-dark:#C678DD">=</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> upper_bound</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B">nums</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">begin</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(), </span><span style="color:#E5C07B;--shiki-dark:#E5C07B">nums</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">end</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(), target) </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#E5C07B;--shiki-dark:#E5C07B"> nums</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">.</span><span style="color:#61AFEF;--shiki-dark:#61AFEF">begin</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">() </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">        return</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> {l, r};</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">};</span></span></code></pre>
</div><h3>Ã tÆ°á»Ÿng 2: Äá»™ phá»©c táº¡p</h3>
<ul>
<li><strong>Äá»™ phá»©c táº¡p thá»i gian</strong>: <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>.</li>
<li><strong>Äá»™ phá»©c táº¡p khÃ´ng gian</strong>: <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>.</li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>LeetCode 0035</title>
      <link>https://vanhung4499.github.io/dsa/leetcode/LeetCode%200035.html</link>
      <guid>https://vanhung4499.github.io/dsa/leetcode/LeetCode%200035.html</guid>
      <source url="https://vanhung4499.github.io/rss.xml">LeetCode 0035</source>
      <description>0035. TÃ¬m vá»‹ trÃ­ chÃ¨n Tháº»: Máº£ng, TÃ¬m kiáº¿m nhá»‹ phÃ¢n Äá»™ khÃ³: Dá»… Ã tÆ°á»Ÿng MÃ´ táº£: Cho má»™t máº£ng Ä‘Ã£ Ä‘Æ°á»£c sáº¯p xáº¿p nums vÃ  má»™t giÃ¡ trá»‹ má»¥c tiÃªu target. YÃªu cáº§u: TÃ¬m vá»‹ trÃ­ cá»§a giÃ¡ trá»‹ má»¥...</description>
      <category>dsa</category>
      <category>leetcode</category>
      <pubDate>Fri, 28 Jun 2024 15:54:38 GMT</pubDate>
      <content:encoded><![CDATA[
<ul>
<li>Tháº»: Máº£ng, TÃ¬m kiáº¿m nhá»‹ phÃ¢n</li>
<li>Äá»™ khÃ³: Dá»…</li>
</ul>
<h2>Ã tÆ°á»Ÿng</h2>
<p><strong>MÃ´ táº£</strong>: Cho má»™t máº£ng Ä‘Ã£ Ä‘Æ°á»£c sáº¯p xáº¿p <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>u</mi><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">nums</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span> vÃ  má»™t giÃ¡ trá»‹ má»¥c tiÃªu <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">target</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span></span></span></span>.</p>
<p><strong>YÃªu cáº§u</strong>: TÃ¬m vá»‹ trÃ­ cá»§a giÃ¡ trá»‹ má»¥c tiÃªu trong máº£ng vÃ  tráº£ vá» chá»‰ sá»‘ tÆ°Æ¡ng á»©ng. Náº¿u khÃ´ng tÃ¬m tháº¥y, tráº£ vá» vá»‹ trÃ­ mÃ  giÃ¡ trá»‹ má»¥c tiÃªu sáº½ Ä‘Æ°á»£c chÃ¨n vÃ o máº£ng theo thá»© tá»±.</p>
<p><strong>Giáº£i thÃ­ch</strong>:</p>
<ul>
<li><span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mtext>nums.length</mtext><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>4</mn></msup></mrow><annotation encoding="application/x-tex">1 \le \text{{nums.length}} \le 10^4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord"><span class="mord">nums.length</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span>.</li>
<li><span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ’</mo><mn>1</mn><msup><mn>0</mn><mn>4</mn></msup><mo>â‰¤</mo><mtext>nums[i]</mtext><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>4</mn></msup></mrow><annotation encoding="application/x-tex">-10^4 \le \text{{nums[i]}} \le 10^4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9501em;vertical-align:-0.136em;"></span><span class="mord">âˆ’</span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord"><span class="mord">nums[i]</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span>.</li>
<li><span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>u</mi><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">nums</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span> lÃ  má»™t máº£ng Ä‘Ã£ Ä‘Æ°á»£c sáº¯p xáº¿p theo thá»© tá»± tÄƒng dáº§n vÃ  khÃ´ng cÃ³ pháº§n tá»­ trÃ¹ng láº·p.</li>
<li><span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ’</mo><mn>1</mn><msup><mn>0</mn><mn>4</mn></msup><mo>â‰¤</mo><mtext>target</mtext><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>4</mn></msup></mrow><annotation encoding="application/x-tex">-10^4 \le \text{{target}} \le 10^4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9501em;vertical-align:-0.136em;"></span><span class="mord">âˆ’</span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord"><span class="mord">target</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span>.</li>
</ul>
<p><strong>VÃ­ dá»¥</strong>:</p>
<ul>
<li>VÃ­ dá»¥ 1:</li>
</ul>
<div class="language-python" data-ext="python" data-title="python"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">Input: nums </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> [</span><span style="color:#D19A66;--shiki-dark:#D19A66">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#D19A66;--shiki-dark:#D19A66">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#D19A66;--shiki-dark:#D19A66">5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">,</span><span style="color:#D19A66;--shiki-dark:#D19A66">6</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">], target </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 5</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">Output: </span><span style="color:#D19A66;--shiki-dark:#D19A66">2</span></span></code></pre>
</div><h2>Ã tÆ°á»Ÿng</h2>
<h3>Ã tÆ°á»Ÿng 1: TÃ¬m kiáº¿m nhá»‹ phÃ¢n</h3>
<p>Äáº·t hai con trá» á»Ÿ hai Ä‘áº§u máº£ng, tá»©c lÃ  <code>left = 0</code>, <code>right = len(nums) - 1</code>, Ä‘áº¡i diá»‡n cho pháº¡m vi tÃ¬m kiáº¿m lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo separator="true">,</mo><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[left, right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span><span class="mclose">]</span></span></span></span> (Ä‘Ã³ng bÃªn trÃ¡i vÃ  bÃªn pháº£i).</p>
<p>Láº¥y vá»‹ trÃ­ trung tÃ¢m <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>i</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">mid</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">mi</span><span class="mord mathnormal">d</span></span></span></span> cá»§a hai con trá» vÃ  so sÃ¡nh giÃ¡ trá»‹ táº¡i vá»‹ trÃ­ trung tÃ¢m <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>u</mi><mi>m</mi><mi>s</mi><mo stretchy="false">[</mo><mi>m</mi><mi>i</mi><mi>d</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">nums[mid]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span><span class="mopen">[</span><span class="mord mathnormal">mi</span><span class="mord mathnormal">d</span><span class="mclose">]</span></span></span></span> vá»›i giÃ¡ trá»‹ má»¥c tiÃªu <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">target</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span></span></span></span>.</p>
<ul>
<li>Náº¿u <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>t</mi><mo>=</mo><mo>=</mo><mi>n</mi><mi>u</mi><mi>m</mi><mi>s</mi><mo stretchy="false">[</mo><mi>m</mi><mi>i</mi><mi>d</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">target == nums[mid]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">==</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span><span class="mopen">[</span><span class="mord mathnormal">mi</span><span class="mord mathnormal">d</span><span class="mclose">]</span></span></span></span>, thÃ¬ vá»‹ trÃ­ trung tÃ¢m hiá»‡n táº¡i lÃ  vá»‹ trÃ­ má»¥c tiÃªu cáº§n chÃ¨n vÃ o máº£ng.</li>
<li>Náº¿u <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>t</mi><mo>&gt;</mo><mi>n</mi><mi>u</mi><mi>m</mi><mi>s</mi><mo stretchy="false">[</mo><mi>m</mi><mi>i</mi><mi>d</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">target &gt; nums[mid]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span><span class="mopen">[</span><span class="mord mathnormal">mi</span><span class="mord mathnormal">d</span><span class="mclose">]</span></span></span></span>, thÃ¬ Ä‘áº·t con trá» bÃªn trÃ¡i lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>i</mi><mi>d</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">mid + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">mi</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>, sau Ä‘Ã³ tiáº¿p tá»¥c tÃ¬m kiáº¿m trong pháº¡m vi bÃªn pháº£i <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>m</mi><mi>i</mi><mi>d</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[mid + 1, right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">mi</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span><span class="mclose">]</span></span></span></span>.</li>
<li>Náº¿u <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>t</mi><mo>&lt;</mo><mi>n</mi><mi>u</mi><mi>m</mi><mi>s</mi><mo stretchy="false">[</mo><mi>m</mi><mi>i</mi><mi>d</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">target &lt; nums[mid]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span><span class="mopen">[</span><span class="mord mathnormal">mi</span><span class="mord mathnormal">d</span><span class="mclose">]</span></span></span></span>, thÃ¬ Ä‘áº·t con trá» bÃªn pháº£i lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>i</mi><mi>d</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">mid - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">mi</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>, sau Ä‘Ã³ tiáº¿p tá»¥c tÃ¬m kiáº¿m trong pháº¡m vi bÃªn trÃ¡i <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo separator="true">,</mo><mi>m</mi><mi>i</mi><mi>d</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[left, mid - 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">mi</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>.</li>
</ul>
<p>Tiáº¿p tá»¥c tÃ¬m kiáº¿m cho Ä‘áº¿n khi tÃ¬m tháº¥y giÃ¡ trá»‹ má»¥c tiÃªu vÃ  tráº£ vá» vá»‹ trÃ­ cáº§n chÃ¨n vÃ o máº£ng, hoáº·c dá»«ng tÃ¬m kiáº¿m khi <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo>&gt;</mo><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">left &gt; right</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span></span></span></span>, lÃºc nÃ y vá»‹ trÃ­ cá»§a <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">left</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">t</span></span></span></span> chÃ­nh lÃ  vá»‹ trÃ­ cáº§n chÃ¨n vÃ o máº£ng.</p>
<h3>Ã tÆ°á»Ÿng 1: Code TÃ¬m kiáº¿m nhá»‹ phÃ¢n</h3>
<div class="language-python line-numbers-mode" data-ext="python" data-title="python"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B"> Solution</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">    def</span><span style="color:#61AFEF;--shiki-dark:#61AFEF"> searchInsert</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;font-style:italic;--shiki-dark-font-style:italic">self</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;font-style:italic;--shiki-dark-font-style:italic">nums</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: List[</span><span style="color:#56B6C2;--shiki-dark:#56B6C2">int</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">], </span><span style="color:#D19A66;--shiki-dark:#D19A66;font-style:italic;--shiki-dark-font-style:italic">target</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">: </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">int</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">) -&gt; </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">int</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        size </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#56B6C2;--shiki-dark:#56B6C2"> len</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">(nums)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">        left, right </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">, size </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">        while</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> left </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&lt;=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> right:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">            mid </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> left </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">+</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> (right </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> left) </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">//</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 2</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">            if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> nums[mid] </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">==</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> target:</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">                return</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> mid</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">            elif</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> nums[mid] </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">&lt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> target:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">                left </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> mid </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">+</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">            else</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF">                right </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> mid </span><span style="color:#56B6C2;--shiki-dark:#56B6C2">-</span><span style="color:#D19A66;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD">        return</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF"> left</span></span></code></pre>
<div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>Ã tÆ°á»Ÿng 1: Äá»™ phá»©c táº¡p</h3>
<ul>
<li><strong>Äá»™ phá»©c táº¡p thá»i gian</strong>: <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>. Äá»™ phá»©c táº¡p thá»i gian cá»§a thuáº­t toÃ¡n tÃ¬m kiáº¿m nhá»‹ phÃ¢n lÃ  <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>.</li>
<li><strong>Äá»™ phá»©c táº¡p khÃ´ng gian</strong>: <span v-pre="" class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>. Chá»‰ sá»­ dá»¥ng má»™t sá»‘ biáº¿n háº±ng sá»‘ Ä‘á»ƒ lÆ°u trá»¯.</li>
</ul>
]]></content:encoded>
    </item>
  </channel>
</rss>